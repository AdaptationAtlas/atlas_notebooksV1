<!doctype html><html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head><meta charset="utf-8"><meta name="generator" content="quarto-1.8.26"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=yes"><title>notebook</title><style>code{white-space:pre-wrap}span.smallcaps{font-variant:small-caps}div.columns{display:flex;gap:min(4vw,1.5em)}div.column{flex:auto;overflow-x:auto}div.hanging-indent{margin-left:1.5em;text-indent:-1.5em}ul.task-list{list-style:none}ul.task-list li input[type=checkbox]{width:.8em;margin:0 .8em .2em -1em;vertical-align:middle}html{-webkit-text-size-adjust:100%}pre>code.sourceCode{white-space:pre;position:relative}pre>code.sourceCode>span{display:inline-block;line-height:1.25}pre>code.sourceCode>span:empty{height:1.2em}.sourceCode{overflow:visible}code.sourceCode>span{color:inherit;text-decoration:inherit}div.sourceCode{margin:1em 0}pre.sourceCode{margin:0}@media screen{div.sourceCode{overflow:auto}}@media print{pre>code.sourceCode{white-space:pre-wrap}pre>code.sourceCode>span{text-indent:-5em;padding-left:5em}}pre.numberSource code{counter-reset:source-line 0}pre.numberSource code>span{position:relative;left:-4em;counter-increment:source-line}pre.numberSource code>span>a:first-child::before{content:counter(source-line);position:relative;left:-1em;text-align:right;vertical-align:baseline;border:none;display:inline-block;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;padding:0 4px;width:4em}pre.numberSource{margin-left:3em;padding-left:4px}@media screen{pre>code.sourceCode>span>a:first-child::before{text-decoration:underline}}</style><script src="../../site_libs/quarto-nav/quarto-nav.js"></script><script src="../../site_libs/quarto-nav/headroom.min.js"></script><link href="../../images/atlas-icon.svg" rel="icon" type="image/svg+xml"><script src="../../site_libs/clipboard/clipboard.min.js"></script><script src="../../site_libs/quarto-html/quarto.js" type="module"></script><script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script><script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script><script src="../../site_libs/quarto-html/popper.min.js"></script><script src="../../site_libs/quarto-html/tippy.umd.min.js"></script><link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet"><link href="../../site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles"><script src="../../site_libs/bootstrap/bootstrap.min.js"></script><link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet"><link href="../../site_libs/bootstrap/bootstrap-730ea3c3007e3756c9d7af36786c00c3.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans&amp;display=swap" rel="stylesheet"><script type="module" src="../../site_libs/quarto-ojs/quarto-ojs-runtime.js"></script><link href="../../site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet"><link rel="stylesheet" href="../../styles.css"></head><body class="nav-fixed fullcontent quarto-light"><div id="quarto-search-results"></div><header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg" data-bs-theme="dark"><div class="navbar-container container-fluid"><div class="navbar-brand-container mx-auto"><a href="https://adaptationatlas.cgiar.org" class="navbar-brand navbar-brand-logo"><img src="../../images/atlas-logo.svg" alt="The Africa Agriculture Adaptation Atlas" class="navbar-logo light-content"> <img src="../../images/atlas-logo.svg" alt="The Africa Agriculture Adaptation Atlas" class="navbar-logo dark-content"></a></div><button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="window.quartoToggleHeadroom&&window.quartoToggleHeadroom()"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarCollapse"><ul class="navbar-nav navbar-nav-scroll ms-auto"><li class="nav-item"><a class="nav-link" href="../../docs/doc_index.html"><i class="bi bi-info-circle" role="img" aria-label="More Information"></i> <span class="menu-text">Documentation</span></a></li><li class="nav-item"><a class="nav-link" href="https://github.com/AdaptationAtlas/atlas_notebooks/issues/new"><span class="menu-text">Report an Issue</span></a></li><li class="nav-item compact"><a class="nav-link" href="https://github.com/AdaptationAtlas/atlas_notebooks"><i class="bi bi-github" role="img" aria-label="GitHub"></i> <span class="menu-text"></span></a></li></ul></div><div class="quarto-navbar-tools"></div></div></nav></header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar"><main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"></header><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb1" data-startfrom="9" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 8"><span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { heroImage } <span class="im">from</span> <span class="st">"/helpers/hero.js"</span><span class="op">;</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>hero_url <span class="op">=</span> <span class="st">"./../../images/projectedImpacts.webp"</span><span class="op">;</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>hero <span class="op">=</span> <span class="fu">heroImage</span>(notebookTitle<span class="op">,</span> hero_url)<span class="op">;</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`</span><span class="sc">${</span>hero<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-1-1" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-1-2" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-1-3" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-1-4" data-nodetype="expression"></div></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb2" data-startfrom="17" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 16"><span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { atlasTOC } <span class="im">from</span> <span class="st">'/helpers/toc.ojs'</span> </span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">await</span> nbText <span class="co">// force wait/reload with nbText to load so headings have correct labels/languages</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="fu">atlasTOC</span>({</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>      <span class="dt">heading</span><span class="op">:</span> <span class="vs">`&lt;b&gt;</span><span class="sc">${</span><span class="fu">_lang</span>({<span class="dt">en</span><span class="op">:</span><span class="st">"In this notebook"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span><span class="st">"Dans ce notebook"</span>})<span class="sc">}</span><span class="vs">&lt;/b&gt;`</span><span class="op">,</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>      <span class="dt">skip</span><span class="op">:</span> [notebookTitle<span class="op">,</span> <span class="st">"notebook-title"</span><span class="op">,</span> <span class="st">"Appendix"</span><span class="op">,</span> <span class="st">"source-code"</span>]</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>      })</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-2-1" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-2-2" data-nodetype="expression"></div></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb3" data-startfrom="27" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 26"><span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>viewof prettyLanguageView <span class="op">=</span> {</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> Inputs<span class="op">.</span><span class="fu">bind</span>(</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>    Inputs<span class="op">.</span><span class="fu">radio</span>(languages<span class="op">,</span> {</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>      <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>({<span class="dt">en</span><span class="op">:</span> <span class="st">"Language"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Langue"</span>})<span class="op">,</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>      <span class="dt">format</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">label</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>    })<span class="op">,</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>    viewof language</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-3" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb4" data-startfrom="39" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 38"><span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`# </span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">overview</span><span class="op">.</span><span class="at">title</span>)<span class="sc">}</span></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">overview</span><span class="op">.</span><span class="at">text</span>)<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-4" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb5" data-startfrom="45" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 44"><span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`# </span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">regionalPicture</span><span class="op">.</span><span class="at">title</span>)<span class="sc">}</span></span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">regionalPicture</span><span class="op">.</span><span class="at">text</span>)<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-5" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb6" data-startfrom="51" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 50"><span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> form <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">form</span>(</span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>    [</span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a>      Inputs<span class="op">.</span><span class="fu">bind</span>(</span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a>        Inputs<span class="op">.</span><span class="fu">select</span>(</span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a>          [<span class="st">"maize"</span><span class="op">,</span> <span class="st">"rice"</span><span class="op">,</span> <span class="st">"wheat"</span>]<span class="op">,</span></span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a>          {<span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">crop</span>)<span class="op">,</span></span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a>          <span class="dt">format</span><span class="op">:</span> c <span class="kw">=&gt;</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">crops</span>[c])}</span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a>        )<span class="op">,</span></span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a>      viewof crop_selector_yield)<span class="op">,</span></span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a>      Inputs<span class="op">.</span><span class="fu">bind</span>(</span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a>        Inputs<span class="op">.</span><span class="fu">select</span>(</span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true" tabindex="-1"></a>          avaliable_unRegions<span class="op">,</span></span>
<span id="cb6-64"><a href="#cb6-64" aria-hidden="true" tabindex="-1"></a>          {<span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">regionalPicture</span><span class="op">.</span><span class="at">beeswarm</span><span class="op">.</span><span class="at">yAxis</span>)<span class="op">,</span></span>
<span id="cb6-65"><a href="#cb6-65" aria-hidden="true" tabindex="-1"></a>          <span class="dt">format</span><span class="op">:</span> d <span class="kw">=&gt;</span>  <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">regionalPicture</span><span class="op">.</span><span class="at">beeswarm</span><span class="op">.</span><span class="at">regions</span>[d <span class="op">||</span> <span class="st">"all"</span>])} <span class="co">// No region is NULL so add a label</span></span>
<span id="cb6-66"><a href="#cb6-66" aria-hidden="true" tabindex="-1"></a>        )<span class="op">,</span></span>
<span id="cb6-67"><a href="#cb6-67" aria-hidden="true" tabindex="-1"></a>      viewof sel_region)<span class="op">,</span></span>
<span id="cb6-68"><a href="#cb6-68" aria-hidden="true" tabindex="-1"></a>    ]<span class="op">,</span></span>
<span id="cb6-69"><a href="#cb6-69" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb6-70"><a href="#cb6-70" aria-hidden="true" tabindex="-1"></a>      <span class="dt">template</span><span class="op">:</span> <span class="fu">formTemplate</span>()</span>
<span id="cb6-71"><a href="#cb6-71" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb6-72"><a href="#cb6-72" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-73"><a href="#cb6-73" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> form</span>
<span id="cb6-74"><a href="#cb6-74" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-6" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb7" data-startfrom="78" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 77"><span id="cb7-78"><a href="#cb7-78" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb7-79"><a href="#cb7-79" aria-hidden="true" tabindex="-1"></a>  <span class="co">// ============================================================================</span></span>
<span id="cb7-80"><a href="#cb7-80" aria-hidden="true" tabindex="-1"></a>  <span class="co">// DATA PREPARATION</span></span>
<span id="cb7-81"><a href="#cb7-81" aria-hidden="true" tabindex="-1"></a>  <span class="co">// ============================================================================</span></span>
<span id="cb7-82"><a href="#cb7-82" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-83"><a href="#cb7-83" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> cleanData <span class="op">=</span> impacts_metaanalysis_data</span>
<span id="cb7-84"><a href="#cb7-84" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> </span>
<span id="cb7-85"><a href="#cb7-85" aria-hidden="true" tabindex="-1"></a>      <span class="op">!</span>sel_region <span class="op">||</span> d<span class="op">?.</span><span class="at">UNRegion</span> <span class="op">===</span> sel_region</span>
<span id="cb7-86"><a href="#cb7-86" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb7-87"><a href="#cb7-87" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> ({</span>
<span id="cb7-88"><a href="#cb7-88" aria-hidden="true" tabindex="-1"></a>      <span class="op">...</span>d<span class="op">,</span></span>
<span id="cb7-89"><a href="#cb7-89" aria-hidden="true" tabindex="-1"></a>      <span class="dt">temp_band</span><span class="op">:</span> <span class="fu">classifyTempBand</span>(d<span class="op">.</span><span class="at">preindustrial_temp_delta</span>)</span>
<span id="cb7-90"><a href="#cb7-90" aria-hidden="true" tabindex="-1"></a>    }))<span class="op">;</span></span>
<span id="cb7-91"><a href="#cb7-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-92"><a href="#cb7-92" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> violin_tt_html <span class="op">=</span> (temp<span class="op">,</span> adaptation<span class="op">,</span> mean<span class="op">,</span> min<span class="op">,</span> max<span class="op">,</span> sd<span class="op">,</span> n_obs) <span class="kw">=&gt;</span> {</span>
<span id="cb7-93"><a href="#cb7-93" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> <span class="vs">`&lt;strong&gt;With Adaptatation:&lt;/strong&gt; </span><span class="sc">${</span>adaptation<span class="sc">}</span><span class="vs">&lt;br/&gt;</span></span>
<span id="cb7-94"><a href="#cb7-94" aria-hidden="true" tabindex="-1"></a><span class="vs">              &lt;strong&gt;Temperature:&lt;/strong&gt; </span><span class="sc">${</span>temp<span class="sc">}</span><span class="vs">&lt;br/&gt;</span></span>
<span id="cb7-95"><a href="#cb7-95" aria-hidden="true" tabindex="-1"></a><span class="vs">              &lt;strong&gt;Yield loss (%):&lt;/strong&gt;&lt;br/&gt;</span></span>
<span id="cb7-96"><a href="#cb7-96" aria-hidden="true" tabindex="-1"></a><span class="vs">              &lt;strong&gt;Mean:&lt;/strong&gt; </span><span class="sc">${</span>mean<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">2</span>)<span class="sc">}</span><span class="vs">&lt;br/&gt;</span></span>
<span id="cb7-97"><a href="#cb7-97" aria-hidden="true" tabindex="-1"></a><span class="vs">              &lt;strong&gt;Min:&lt;/strong&gt; </span><span class="sc">${</span>min<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">2</span>)<span class="sc">}</span><span class="vs">&lt;br/&gt;</span></span>
<span id="cb7-98"><a href="#cb7-98" aria-hidden="true" tabindex="-1"></a><span class="vs">              &lt;strong&gt;Max:&lt;/strong&gt; </span><span class="sc">${</span>max<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">2</span>)<span class="sc">}</span><span class="vs">&lt;br/&gt;</span></span>
<span id="cb7-99"><a href="#cb7-99" aria-hidden="true" tabindex="-1"></a><span class="vs">              &lt;strong&gt;Std Dev:&lt;/strong&gt; </span><span class="sc">${</span>sd<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">2</span>)<span class="sc">}</span><span class="vs">&lt;br/&gt;</span></span>
<span id="cb7-100"><a href="#cb7-100" aria-hidden="true" tabindex="-1"></a><span class="vs">              &lt;strong&gt;Observations:&lt;/strong&gt; </span><span class="sc">${</span>n_obs<span class="sc">}</span><span class="vs">&lt;br/&gt;`</span></span>
<span id="cb7-101"><a href="#cb7-101" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb7-102"><a href="#cb7-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-103"><a href="#cb7-103" aria-hidden="true" tabindex="-1"></a>  <span class="co">// ============================================================================</span></span>
<span id="cb7-104"><a href="#cb7-104" aria-hidden="true" tabindex="-1"></a>  <span class="co">// HELPER FUNCTIONS</span></span>
<span id="cb7-105"><a href="#cb7-105" aria-hidden="true" tabindex="-1"></a>  <span class="co">// ============================================================================</span></span>
<span id="cb7-106"><a href="#cb7-106" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-107"><a href="#cb7-107" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">classifyTempBand</span>(temp) {</span>
<span id="cb7-108"><a href="#cb7-108" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (temp <span class="op">&lt;=</span> <span class="dv">2</span>) <span class="cf">return</span> <span class="st">"≤ 2°C"</span> <span class="co">// return "≤ 1.5°C";</span></span>
<span id="cb7-109"><a href="#cb7-109" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (temp <span class="op">&lt;=</span> <span class="dv">3</span>) <span class="cf">return</span> <span class="st">"2-3°C"</span><span class="co">// return "1.5–2.5°C";</span></span>
<span id="cb7-110"><a href="#cb7-110" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">"&gt; 3°C"</span><span class="op">;</span> <span class="co">// "&gt; 2.5°C"</span></span>
<span id="cb7-111"><a href="#cb7-111" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-112"><a href="#cb7-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-113"><a href="#cb7-113" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">gaussianKernel</span>(u) {</span>
<span id="cb7-114"><a href="#cb7-114" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">exp</span>(<span class="op">-</span><span class="fl">0.5</span> <span class="op">*</span> u <span class="op">*</span> u) <span class="op">/</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sqrt</span>(<span class="dv">2</span> <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span>)<span class="op">;</span></span>
<span id="cb7-115"><a href="#cb7-115" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-116"><a href="#cb7-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-117"><a href="#cb7-117" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">silvermanBandwidth</span>(values) {</span>
<span id="cb7-118"><a href="#cb7-118" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> n <span class="op">=</span> values<span class="op">.</span><span class="at">length</span><span class="op">;</span></span>
<span id="cb7-119"><a href="#cb7-119" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (n <span class="op">&lt;</span> <span class="dv">2</span>) <span class="cf">return</span> <span class="fl">1.5</span><span class="op">;</span></span>
<span id="cb7-120"><a href="#cb7-120" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> sd <span class="op">=</span> d3<span class="op">.</span><span class="fu">deviation</span>(values) <span class="op">||</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb7-121"><a href="#cb7-121" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(<span class="dv">1</span><span class="op">,</span> <span class="fl">1.06</span> <span class="op">*</span> sd <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">pow</span>(n<span class="op">,</span> <span class="op">-</span><span class="fl">0.2</span>))<span class="op">;</span></span>
<span id="cb7-122"><a href="#cb7-122" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-123"><a href="#cb7-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-124"><a href="#cb7-124" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">computeKDE</span>(grid<span class="op">,</span> samples<span class="op">,</span> bandwidth) {</span>
<span id="cb7-125"><a href="#cb7-125" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> invBw <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> bandwidth<span class="op">;</span></span>
<span id="cb7-126"><a href="#cb7-126" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> grid<span class="op">.</span><span class="fu">map</span>(gridPoint <span class="kw">=&gt;</span> {</span>
<span id="cb7-127"><a href="#cb7-127" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> density <span class="op">=</span> d3<span class="op">.</span><span class="fu">mean</span>(samples<span class="op">,</span> v <span class="kw">=&gt;</span> </span>
<span id="cb7-128"><a href="#cb7-128" aria-hidden="true" tabindex="-1"></a>        <span class="fu">gaussianKernel</span>((gridPoint <span class="op">-</span> v) <span class="op">*</span> invBw)</span>
<span id="cb7-129"><a href="#cb7-129" aria-hidden="true" tabindex="-1"></a>      ) <span class="op">*</span> invBw<span class="op">;</span></span>
<span id="cb7-130"><a href="#cb7-130" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> [gridPoint<span class="op">,</span> density <span class="op">||</span> <span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb7-131"><a href="#cb7-131" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb7-132"><a href="#cb7-132" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-133"><a href="#cb7-133" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-134"><a href="#cb7-134" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">kdeWithinExtent</span>(samples<span class="op">,</span> step<span class="op">=</span><span class="fl">0.25</span>) { <span class="co">// Clamp the tails of the violin to min and max</span></span>
<span id="cb7-135"><a href="#cb7-135" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> [lo<span class="op">,</span> hi] <span class="op">=</span> d3<span class="op">.</span><span class="fu">extent</span>(samples)<span class="op">;</span></span>
<span id="cb7-136"><a href="#cb7-136" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> bw <span class="op">=</span> <span class="fu">silvermanBandwidth</span>(samples)<span class="op">;</span></span>
<span id="cb7-137"><a href="#cb7-137" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> grid <span class="op">=</span> d3<span class="op">.</span><span class="fu">range</span>(lo<span class="op">,</span> hi <span class="op">+</span> step<span class="op">,</span> step)<span class="op">;</span></span>
<span id="cb7-138"><a href="#cb7-138" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> density <span class="op">=</span> <span class="fu">computeKDE</span>(grid<span class="op">,</span> samples<span class="op">,</span> bw)<span class="op">;</span></span>
<span id="cb7-139"><a href="#cb7-139" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> maxDensity <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(density<span class="op">,</span> d <span class="kw">=&gt;</span> d[<span class="dv">1</span>]) <span class="op">||</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb7-140"><a href="#cb7-140" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> { density<span class="op">,</span> maxDensity<span class="op">,</span> lo<span class="op">,</span> hi }<span class="op">;</span></span>
<span id="cb7-141"><a href="#cb7-141" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-142"><a href="#cb7-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-143"><a href="#cb7-143" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">computeDensitiesPerAdaptation</span>(dataSubset) {</span>
<span id="cb7-144"><a href="#cb7-144" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> d3<span class="op">.</span><span class="fu">groups</span>(dataSubset<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">Adaptation</span>)</span>
<span id="cb7-145"><a href="#cb7-145" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">map</span>(([adaptation<span class="op">,</span> records]) <span class="kw">=&gt;</span> {</span>
<span id="cb7-146"><a href="#cb7-146" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> values <span class="op">=</span> records<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">yield_impact_pct</span>)<span class="op">;</span></span>
<span id="cb7-147"><a href="#cb7-147" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> { density<span class="op">,</span> maxDensity<span class="op">,</span> lo<span class="op">,</span> hi } <span class="op">=</span> <span class="fu">kdeWithinExtent</span>(values)<span class="op">;</span></span>
<span id="cb7-148"><a href="#cb7-148" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> { adaptation<span class="op">,</span> records<span class="op">,</span> density<span class="op">,</span> maxDensity<span class="op">,</span> lo<span class="op">,</span> hi }<span class="op">;</span></span>
<span id="cb7-149"><a href="#cb7-149" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb7-150"><a href="#cb7-150" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-151"><a href="#cb7-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-152"><a href="#cb7-152" aria-hidden="true" tabindex="-1"></a>  <span class="co">// ============================================================================</span></span>
<span id="cb7-153"><a href="#cb7-153" aria-hidden="true" tabindex="-1"></a>  <span class="co">// SCALES AND DIMENSIONS</span></span>
<span id="cb7-154"><a href="#cb7-154" aria-hidden="true" tabindex="-1"></a>  <span class="co">// ============================================================================</span></span>
<span id="cb7-155"><a href="#cb7-155" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-156"><a href="#cb7-156" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> margin <span class="op">=</span> { <span class="dt">top</span><span class="op">:</span> <span class="dv">60</span><span class="op">,</span> <span class="dt">right</span><span class="op">:</span> <span class="dv">30</span><span class="op">,</span> <span class="dt">bottom</span><span class="op">:</span> <span class="dv">30</span><span class="op">,</span> <span class="dt">left</span><span class="op">:</span> <span class="dv">80</span> }<span class="op">;</span></span>
<span id="cb7-157"><a href="#cb7-157" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> width <span class="op">=</span> <span class="dv">1000</span><span class="op">;</span></span>
<span id="cb7-158"><a href="#cb7-158" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> height <span class="op">=</span> <span class="dv">600</span><span class="op">;</span></span>
<span id="cb7-159"><a href="#cb7-159" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> innerW <span class="op">=</span> width <span class="op">-</span> margin<span class="op">.</span><span class="at">left</span> <span class="op">-</span> margin<span class="op">.</span><span class="at">right</span><span class="op">;</span></span>
<span id="cb7-160"><a href="#cb7-160" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> innerH <span class="op">=</span> height <span class="op">-</span> margin<span class="op">.</span><span class="at">top</span> <span class="op">-</span> margin<span class="op">.</span><span class="at">bottom</span><span class="op">;</span></span>
<span id="cb7-161"><a href="#cb7-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-162"><a href="#cb7-162" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Y scale (yield impact)</span></span>
<span id="cb7-163"><a href="#cb7-163" aria-hidden="true" tabindex="-1"></a>  <span class="co">// const yExtent = d3.extent(cleanData, d =&gt; d.yield_impact_pct);</span></span>
<span id="cb7-164"><a href="#cb7-164" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> yExtent <span class="op">=</span> [<span class="op">-</span><span class="dv">100</span><span class="op">,</span> <span class="dv">100</span>]</span>
<span id="cb7-165"><a href="#cb7-165" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> padding <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb7-166"><a href="#cb7-166" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> yMin <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>((yExtent[<span class="dv">0</span>] <span class="op">??</span> <span class="op">-</span><span class="dv">10</span>) <span class="op">-</span> padding<span class="op">,</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb7-167"><a href="#cb7-167" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> yMax <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>((yExtent[<span class="dv">1</span>] <span class="op">??</span> <span class="dv">10</span>) <span class="op">+</span> padding<span class="op">,</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb7-168"><a href="#cb7-168" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-169"><a href="#cb7-169" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> yScale <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb7-170"><a href="#cb7-170" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([yMin<span class="op">,</span> yMax])</span>
<span id="cb7-171"><a href="#cb7-171" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">nice</span>()</span>
<span id="cb7-172"><a href="#cb7-172" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>([innerH<span class="op">,</span> <span class="dv">0</span>])<span class="op">;</span></span>
<span id="cb7-173"><a href="#cb7-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-174"><a href="#cb7-174" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> yGrid <span class="op">=</span> d3<span class="op">.</span><span class="fu">range</span>(</span>
<span id="cb7-175"><a href="#cb7-175" aria-hidden="true" tabindex="-1"></a>    yScale<span class="op">.</span><span class="fu">domain</span>()[<span class="dv">0</span>]<span class="op">,</span> </span>
<span id="cb7-176"><a href="#cb7-176" aria-hidden="true" tabindex="-1"></a>    yScale<span class="op">.</span><span class="fu">domain</span>()[<span class="dv">1</span>] <span class="op">+</span> <span class="fl">1e-9</span><span class="op">,</span> </span>
<span id="cb7-177"><a href="#cb7-177" aria-hidden="true" tabindex="-1"></a>    (yScale<span class="op">.</span><span class="fu">domain</span>()[<span class="dv">1</span>] <span class="op">-</span> yScale<span class="op">.</span><span class="fu">domain</span>()[<span class="dv">0</span>]) <span class="op">/</span> <span class="dv">100</span></span>
<span id="cb7-178"><a href="#cb7-178" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb7-179"><a href="#cb7-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-180"><a href="#cb7-180" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Temperature band columns</span></span>
<span id="cb7-181"><a href="#cb7-181" aria-hidden="true" tabindex="-1"></a>  <span class="co">// const tempBands = ["≤ 1.5°C", "1.5–2.5°C", "&gt; 2.5°C"];</span></span>
<span id="cb7-182"><a href="#cb7-182" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> tempBands <span class="op">=</span> [<span class="st">"≤ 2°C"</span><span class="op">,</span> <span class="st">"2-3°C"</span><span class="op">,</span> <span class="st">"&gt; 3°C"</span>]</span>
<span id="cb7-183"><a href="#cb7-183" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> xBandScale <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleBand</span>()</span>
<span id="cb7-184"><a href="#cb7-184" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>(tempBands)</span>
<span id="cb7-185"><a href="#cb7-185" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> innerW])</span>
<span id="cb7-186"><a href="#cb7-186" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">padding</span>(<span class="fl">0.15</span>)<span class="op">;</span></span>
<span id="cb7-187"><a href="#cb7-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-188"><a href="#cb7-188" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Adaptation categories within each column</span></span>
<span id="cb7-189"><a href="#cb7-189" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> adaptationTypes <span class="op">=</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">from</span>(</span>
<span id="cb7-190"><a href="#cb7-190" aria-hidden="true" tabindex="-1"></a>    <span class="kw">new</span> <span class="bu">Set</span>(cleanData<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">Adaptation</span>))</span>
<span id="cb7-191"><a href="#cb7-191" aria-hidden="true" tabindex="-1"></a>  )<span class="op">.</span><span class="fu">sort</span>(d3<span class="op">.</span><span class="at">ascending</span>)<span class="op">;</span></span>
<span id="cb7-192"><a href="#cb7-192" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-193"><a href="#cb7-193" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> xInnerScale <span class="op">=</span> d3<span class="op">.</span><span class="fu">scalePoint</span>()</span>
<span id="cb7-194"><a href="#cb7-194" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>(adaptationTypes)</span>
<span id="cb7-195"><a href="#cb7-195" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> xBandScale<span class="op">.</span><span class="fu">bandwidth</span>()])</span>
<span id="cb7-196"><a href="#cb7-196" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">padding</span>(<span class="fl">0.6</span>)<span class="op">;</span></span>
<span id="cb7-197"><a href="#cb7-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-198"><a href="#cb7-198" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Color scale</span></span>
<span id="cb7-199"><a href="#cb7-199" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> colorScale <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleOrdinal</span>()</span>
<span id="cb7-200"><a href="#cb7-200" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>(adaptationTypes)</span>
<span id="cb7-201"><a href="#cb7-201" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>(d3<span class="op">.</span><span class="at">schemeTableau10</span>)<span class="op">;</span></span>
<span id="cb7-202"><a href="#cb7-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-203"><a href="#cb7-203" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Violin width scale (shared across all columns)</span></span>
<span id="cb7-204"><a href="#cb7-204" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> maxDensityGlobal <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(</span>
<span id="cb7-205"><a href="#cb7-205" aria-hidden="true" tabindex="-1"></a>    tempBands<span class="op">.</span><span class="fu">map</span>(band <span class="kw">=&gt;</span> {</span>
<span id="cb7-206"><a href="#cb7-206" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> subset <span class="op">=</span> cleanData<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">temp_band</span> <span class="op">===</span> band)<span class="op">;</span></span>
<span id="cb7-207"><a href="#cb7-207" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> d3<span class="op">.</span><span class="fu">max</span>(<span class="fu">computeDensitiesPerAdaptation</span>(subset)<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">maxDensity</span>)<span class="op">;</span></span>
<span id="cb7-208"><a href="#cb7-208" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb7-209"><a href="#cb7-209" aria-hidden="true" tabindex="-1"></a>  ) <span class="op">||</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb7-210"><a href="#cb7-210" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-211"><a href="#cb7-211" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> maxViolinHalfWidth <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(<span class="dv">45</span><span class="op">,</span> (xBandScale<span class="op">.</span><span class="fu">bandwidth</span>() <span class="op">/</span> adaptationTypes<span class="op">.</span><span class="at">length</span>) <span class="op">*</span> <span class="fl">0.35</span>)<span class="op">;</span></span>
<span id="cb7-212"><a href="#cb7-212" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> widthScale <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb7-213"><a href="#cb7-213" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="dv">0</span><span class="op">,</span> maxDensityGlobal])</span>
<span id="cb7-214"><a href="#cb7-214" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> maxViolinHalfWidth])<span class="op">;</span></span>
<span id="cb7-215"><a href="#cb7-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-216"><a href="#cb7-216" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Violin area generator</span></span>
<span id="cb7-217"><a href="#cb7-217" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> areaGenerator <span class="op">=</span> d3<span class="op">.</span><span class="fu">area</span>()</span>
<span id="cb7-218"><a href="#cb7-218" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">curve</span>(d3<span class="op">.</span><span class="at">curveCatmullRom</span>)</span>
<span id="cb7-219"><a href="#cb7-219" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">x0</span>(d <span class="kw">=&gt;</span> <span class="op">-</span><span class="fu">widthScale</span>(d[<span class="dv">1</span>]))</span>
<span id="cb7-220"><a href="#cb7-220" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">x1</span>(d <span class="kw">=&gt;</span> <span class="op">+</span><span class="fu">widthScale</span>(d[<span class="dv">1</span>]))</span>
<span id="cb7-221"><a href="#cb7-221" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">y</span>(d <span class="kw">=&gt;</span> <span class="fu">yScale</span>(d[<span class="dv">0</span>]))<span class="op">;</span></span>
<span id="cb7-222"><a href="#cb7-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-223"><a href="#cb7-223" aria-hidden="true" tabindex="-1"></a>  <span class="co">// ============================================================================</span></span>
<span id="cb7-224"><a href="#cb7-224" aria-hidden="true" tabindex="-1"></a>  <span class="co">// SVG SETUP</span></span>
<span id="cb7-225"><a href="#cb7-225" aria-hidden="true" tabindex="-1"></a>  <span class="co">// ============================================================================</span></span>
<span id="cb7-226"><a href="#cb7-226" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> id <span class="op">=</span> <span class="st">"impactfulViolin"</span></span>
<span id="cb7-227"><a href="#cb7-227" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> svg <span class="op">=</span> d3<span class="op">.</span><span class="fu">create</span>(<span class="st">"svg"</span>)</span>
<span id="cb7-228"><a href="#cb7-228" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> width)</span>
<span id="cb7-229"><a href="#cb7-229" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> height)</span>
<span id="cb7-230"><a href="#cb7-230" aria-hidden="true" tabindex="-1"></a>    <span class="co">// .style("background", "#fafafa")</span></span>
<span id="cb7-231"><a href="#cb7-231" aria-hidden="true" tabindex="-1"></a>    <span class="co">// .style("font-family", "'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif");</span></span>
<span id="cb7-232"><a href="#cb7-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-233"><a href="#cb7-233" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> chartArea <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb7-234"><a href="#cb7-234" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>margin<span class="op">.</span><span class="at">left</span><span class="sc">}</span><span class="vs">,</span><span class="sc">${</span>margin<span class="op">.</span><span class="at">top</span><span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb7-235"><a href="#cb7-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-236"><a href="#cb7-236" aria-hidden="true" tabindex="-1"></a>  d3<span class="op">.</span><span class="fu">selectAll</span>(<span class="vs">`#</span><span class="sc">${</span>id<span class="sc">}</span><span class="vs">-tooltip`</span>)<span class="op">.</span><span class="fu">remove</span>()<span class="op">;</span></span>
<span id="cb7-237"><a href="#cb7-237" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> tooltip <span class="op">=</span> d3</span>
<span id="cb7-238"><a href="#cb7-238" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">select</span>(<span class="st">"body"</span>)</span>
<span id="cb7-239"><a href="#cb7-239" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"div"</span>)</span>
<span id="cb7-240"><a href="#cb7-240" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="vs">`</span><span class="sc">${</span>id<span class="sc">}</span><span class="vs">-tooltip`</span>)</span>
<span id="cb7-241"><a href="#cb7-241" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"plotTooltip hazardTip"</span>)</span>
<span id="cb7-242"><a href="#cb7-242" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"position"</span><span class="op">,</span> <span class="st">"absolute"</span>)<span class="op">;</span></span>
<span id="cb7-243"><a href="#cb7-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-244"><a href="#cb7-244" aria-hidden="true" tabindex="-1"></a>  <span class="co">// ============================================================================</span></span>
<span id="cb7-245"><a href="#cb7-245" aria-hidden="true" tabindex="-1"></a>  <span class="co">// DRAW COLUMNS (TEMPERATURE BANDS)</span></span>
<span id="cb7-246"><a href="#cb7-246" aria-hidden="true" tabindex="-1"></a>  <span class="co">// ============================================================================</span></span>
<span id="cb7-247"><a href="#cb7-247" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-248"><a href="#cb7-248" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> columnsGroup <span class="op">=</span> chartArea<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"columns"</span>)<span class="op">;</span></span>
<span id="cb7-249"><a href="#cb7-249" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> jitterGenerator <span class="op">=</span> d3<span class="op">.</span><span class="at">randomUniform</span><span class="op">.</span><span class="fu">source</span>(d3<span class="op">.</span><span class="fu">randomLcg</span>(<span class="dv">42</span>))(</span>
<span id="cb7-250"><a href="#cb7-250" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span>maxViolinHalfWidth <span class="op">*</span> <span class="fl">0.85</span><span class="op">,</span> </span>
<span id="cb7-251"><a href="#cb7-251" aria-hidden="true" tabindex="-1"></a>    maxViolinHalfWidth <span class="op">*</span> <span class="fl">0.85</span></span>
<span id="cb7-252"><a href="#cb7-252" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb7-253"><a href="#cb7-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-254"><a href="#cb7-254" aria-hidden="true" tabindex="-1"></a>  tempBands<span class="op">.</span><span class="fu">forEach</span>(band <span class="kw">=&gt;</span> {</span>
<span id="cb7-255"><a href="#cb7-255" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> columnGroup <span class="op">=</span> columnsGroup<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb7-256"><a href="#cb7-256" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span><span class="fu">xBandScale</span>(band)<span class="sc">}</span><span class="vs">,0)`</span>)<span class="op">;</span></span>
<span id="cb7-257"><a href="#cb7-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-258"><a href="#cb7-258" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Column header</span></span>
<span id="cb7-259"><a href="#cb7-259" aria-hidden="true" tabindex="-1"></a>    columnGroup<span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb7-260"><a href="#cb7-260" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> xBandScale<span class="op">.</span><span class="fu">bandwidth</span>() <span class="op">/</span> <span class="dv">2</span>)</span>
<span id="cb7-261"><a href="#cb7-261" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> <span class="op">-</span><span class="dv">12</span>)</span>
<span id="cb7-262"><a href="#cb7-262" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb7-263"><a href="#cb7-263" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-weight"</span><span class="op">,</span> <span class="dv">700</span>)</span>
<span id="cb7-264"><a href="#cb7-264" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="dv">14</span>)</span>
<span id="cb7-265"><a href="#cb7-265" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"#1a1a1a"</span>)</span>
<span id="cb7-266"><a href="#cb7-266" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">text</span>(band)<span class="op">;</span></span>
<span id="cb7-267"><a href="#cb7-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-268"><a href="#cb7-268" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Compute densities for this temperature band</span></span>
<span id="cb7-269"><a href="#cb7-269" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> bandData <span class="op">=</span> cleanData<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">temp_band</span> <span class="op">===</span> band)<span class="op">;</span></span>
<span id="cb7-270"><a href="#cb7-270" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> densities <span class="op">=</span> <span class="fu">computeDensitiesPerAdaptation</span>(bandData)<span class="op">;</span></span>
<span id="cb7-271"><a href="#cb7-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-272"><a href="#cb7-272" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Draw violins</span></span>
<span id="cb7-273"><a href="#cb7-273" aria-hidden="true" tabindex="-1"></a>    densities<span class="op">.</span><span class="fu">forEach</span>(({ adaptation<span class="op">,</span> density<span class="op">,</span> records }) <span class="kw">=&gt;</span> {</span>
<span id="cb7-274"><a href="#cb7-274" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> cx <span class="op">=</span> <span class="fu">xInnerScale</span>(adaptation)<span class="op">;</span></span>
<span id="cb7-275"><a href="#cb7-275" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (cx <span class="op">==</span> <span class="kw">null</span>) <span class="cf">return</span><span class="op">;</span></span>
<span id="cb7-276"><a href="#cb7-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-277"><a href="#cb7-277" aria-hidden="true" tabindex="-1"></a>      <span class="co">// Calc group stats for the tooltip and mean lines</span></span>
<span id="cb7-278"><a href="#cb7-278" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> meanYield <span class="op">=</span> d3<span class="op">.</span><span class="fu">mean</span>(records<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">yield_impact_pct</span>)<span class="op">;</span></span>
<span id="cb7-279"><a href="#cb7-279" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> sdYield <span class="op">=</span> d3<span class="op">.</span><span class="fu">deviation</span>(records<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">yield_impact_pct</span>)<span class="op">;</span></span>
<span id="cb7-280"><a href="#cb7-280" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> minYield <span class="op">=</span> d3<span class="op">.</span><span class="fu">min</span>(records<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">yield_impact_pct</span>)<span class="op">;</span></span>
<span id="cb7-281"><a href="#cb7-281" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> maxYield <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(records<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">yield_impact_pct</span>)<span class="op">;</span></span>
<span id="cb7-282"><a href="#cb7-282" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> n_obs <span class="op">=</span> records<span class="op">.</span><span class="at">length</span></span>
<span id="cb7-283"><a href="#cb7-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-284"><a href="#cb7-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-285"><a href="#cb7-285" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> violinGroup <span class="op">=</span> columnGroup<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb7-286"><a href="#cb7-286" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>cx<span class="sc">}</span><span class="vs">,0)`</span>)<span class="op">;</span></span>
<span id="cb7-287"><a href="#cb7-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-288"><a href="#cb7-288" aria-hidden="true" tabindex="-1"></a>      violinGroup<span class="op">.</span><span class="fu">append</span>(<span class="st">"path"</span>)</span>
<span id="cb7-289"><a href="#cb7-289" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"d"</span><span class="op">,</span> <span class="fu">areaGenerator</span>(density))</span>
<span id="cb7-290"><a href="#cb7-290" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="fu">colorScale</span>(adaptation))</span>
<span id="cb7-291"><a href="#cb7-291" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill-opacity"</span><span class="op">,</span> <span class="fl">0.2</span>)</span>
<span id="cb7-292"><a href="#cb7-292" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="fu">colorScale</span>(adaptation))</span>
<span id="cb7-293"><a href="#cb7-293" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="fl">1.5</span>)</span>
<span id="cb7-294"><a href="#cb7-294" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"filter"</span><span class="op">,</span> <span class="st">"drop-shadow(0 1px 2px rgba(0,0,0,0.05))"</span>)<span class="op">;</span></span>
<span id="cb7-295"><a href="#cb7-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-296"><a href="#cb7-296" aria-hidden="true" tabindex="-1"></a>      violinGroup</span>
<span id="cb7-297"><a href="#cb7-297" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">on</span>(<span class="st">"mousemove"</span><span class="op">,</span> (<span class="bu">event</span><span class="op">,</span> d) <span class="kw">=&gt;</span> {</span>
<span id="cb7-298"><a href="#cb7-298" aria-hidden="true" tabindex="-1"></a>          tooltip</span>
<span id="cb7-299"><a href="#cb7-299" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">style</span>(<span class="st">"top"</span><span class="op">,</span> <span class="bu">event</span><span class="op">.</span><span class="at">pageY</span> <span class="op">-</span> <span class="dv">10</span> <span class="op">+</span> <span class="st">"px"</span>)</span>
<span id="cb7-300"><a href="#cb7-300" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">style</span>(<span class="st">"left"</span><span class="op">,</span> <span class="bu">event</span><span class="op">.</span><span class="at">pageX</span> <span class="op">+</span> <span class="dv">10</span> <span class="op">+</span> <span class="st">"px"</span>)</span>
<span id="cb7-301"><a href="#cb7-301" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">style</span>(<span class="st">"opacity"</span><span class="op">,</span> <span class="dv">1</span>)</span>
<span id="cb7-302"><a href="#cb7-302" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">style</span>(<span class="st">"display"</span><span class="op">,</span> <span class="st">"block"</span>)</span>
<span id="cb7-303"><a href="#cb7-303" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">html</span>(<span class="fu">violin_tt_html</span>(band<span class="op">,</span> adaptation<span class="op">,</span> meanYield<span class="op">,</span> minYield<span class="op">,</span> maxYield<span class="op">,</span> sdYield<span class="op">,</span> n_obs))<span class="op">;</span></span>
<span id="cb7-304"><a href="#cb7-304" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb7-305"><a href="#cb7-305" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">on</span>(<span class="st">"mouseout"</span><span class="op">,</span> <span class="kw">function</span> (<span class="bu">event</span><span class="op">,</span> d) {</span>
<span id="cb7-306"><a href="#cb7-306" aria-hidden="true" tabindex="-1"></a>            d3<span class="op">.</span><span class="fu">select</span>(<span class="vs">`#</span><span class="sc">${</span>id<span class="sc">}</span><span class="vs">-tooltip`</span>)<span class="op">.</span><span class="fu">style</span>(<span class="st">"display"</span><span class="op">,</span> <span class="st">"none"</span>)<span class="op">;</span></span>
<span id="cb7-307"><a href="#cb7-307" aria-hidden="true" tabindex="-1"></a>        })<span class="op">;</span></span>
<span id="cb7-308"><a href="#cb7-308" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb7-309"><a href="#cb7-309" aria-hidden="true" tabindex="-1"></a>      <span class="co">// Mean line</span></span>
<span id="cb7-310"><a href="#cb7-310" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> meanY <span class="op">=</span> <span class="fu">yScale</span>(meanYield)<span class="op">;</span></span>
<span id="cb7-311"><a href="#cb7-311" aria-hidden="true" tabindex="-1"></a>      violinGroup<span class="op">.</span><span class="fu">append</span>(<span class="st">"line"</span>)</span>
<span id="cb7-312"><a href="#cb7-312" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> <span class="op">-</span>maxViolinHalfWidth <span class="op">*</span> <span class="fl">0.4</span>)</span>
<span id="cb7-313"><a href="#cb7-313" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> maxViolinHalfWidth <span class="op">*</span> <span class="fl">0.4</span>)</span>
<span id="cb7-314"><a href="#cb7-314" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> meanY)</span>
<span id="cb7-315"><a href="#cb7-315" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> meanY)</span>
<span id="cb7-316"><a href="#cb7-316" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="fu">colorScale</span>(adaptation))</span>
<span id="cb7-317"><a href="#cb7-317" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="fl">2.5</span>)</span>
<span id="cb7-318"><a href="#cb7-318" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-opacity"</span><span class="op">,</span> <span class="fl">0.9</span>)<span class="op">;</span></span>
<span id="cb7-319"><a href="#cb7-319" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb7-320"><a href="#cb7-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-321"><a href="#cb7-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-322"><a href="#cb7-322" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Draw data points</span></span>
<span id="cb7-323"><a href="#cb7-323" aria-hidden="true" tabindex="-1"></a>    columnGroup<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb7-324"><a href="#cb7-324" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"circle"</span>)</span>
<span id="cb7-325"><a href="#cb7-325" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(bandData)</span>
<span id="cb7-326"><a href="#cb7-326" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">join</span>(<span class="st">"circle"</span>)</span>
<span id="cb7-327"><a href="#cb7-327" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cx"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">xInnerScale</span>(d<span class="op">.</span><span class="at">Adaptation</span>) <span class="op">+</span> <span class="fu">jitterGenerator</span>())</span>
<span id="cb7-328"><a href="#cb7-328" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cy"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">yScale</span>(d<span class="op">.</span><span class="at">yield_impact_pct</span>))</span>
<span id="cb7-329"><a href="#cb7-329" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"r"</span><span class="op">,</span> <span class="fl">2.5</span>)</span>
<span id="cb7-330"><a href="#cb7-330" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">colorScale</span>(d<span class="op">.</span><span class="at">Adaptation</span>))</span>
<span id="cb7-331"><a href="#cb7-331" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill-opacity"</span><span class="op">,</span> <span class="fl">0.1</span>)</span>
<span id="cb7-332"><a href="#cb7-332" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="fu">colorScale</span>(d<span class="op">.</span><span class="at">Adaptation</span>))</span>
<span id="cb7-333"><a href="#cb7-333" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="fl">0.15</span>)</span>
<span id="cb7-334"><a href="#cb7-334" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"cursor"</span><span class="op">,</span> <span class="st">"pointer"</span>)</span>
<span id="cb7-335"><a href="#cb7-335" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"title"</span>)</span>
<span id="cb7-336"><a href="#cb7-336" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">text</span>(d <span class="kw">=&gt;</span> <span class="vs">`</span><span class="sc">${</span>d<span class="op">.</span><span class="at">Crop</span><span class="sc">}</span><span class="vs"> • </span><span class="sc">${</span>d<span class="op">.</span><span class="at">Country</span><span class="sc">}</span></span>
<span id="cb7-337"><a href="#cb7-337" aria-hidden="true" tabindex="-1"></a><span class="vs">Temperature: </span><span class="sc">${</span>d<span class="op">.</span><span class="at">preindustrial_temp_delta</span><span class="sc">}</span><span class="vs">°C</span></span>
<span id="cb7-338"><a href="#cb7-338" aria-hidden="true" tabindex="-1"></a><span class="vs">Yield Impact: </span><span class="sc">${</span>d<span class="op">.</span><span class="at">yield_impact_pct</span><span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">2</span>)<span class="sc">}</span><span class="vs">%</span></span>
<span id="cb7-339"><a href="#cb7-339" aria-hidden="true" tabindex="-1"></a><span class="vs">Adaptation: </span><span class="sc">${</span>d<span class="op">.</span><span class="at">Adaptation</span><span class="sc">}</span></span>
<span id="cb7-340"><a href="#cb7-340" aria-hidden="true" tabindex="-1"></a><span class="vs">Reference: </span><span class="sc">${</span>d<span class="op">.</span><span class="at">Reference</span><span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span></span>
<span id="cb7-341"><a href="#cb7-341" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb7-342"><a href="#cb7-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-343"><a href="#cb7-343" aria-hidden="true" tabindex="-1"></a>  <span class="co">// ============================================================================</span></span>
<span id="cb7-344"><a href="#cb7-344" aria-hidden="true" tabindex="-1"></a>  <span class="co">// AXES AND GRIDLINES</span></span>
<span id="cb7-345"><a href="#cb7-345" aria-hidden="true" tabindex="-1"></a>  <span class="co">// ============================================================================</span></span>
<span id="cb7-346"><a href="#cb7-346" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-347"><a href="#cb7-347" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Y-axis</span></span>
<span id="cb7-348"><a href="#cb7-348" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> yAxis <span class="op">=</span> chartArea<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb7-349"><a href="#cb7-349" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"y-axis"</span>)</span>
<span id="cb7-350"><a href="#cb7-350" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>(d3<span class="op">.</span><span class="fu">axisLeft</span>(yScale)<span class="op">.</span><span class="fu">ticks</span>(<span class="dv">8</span>)<span class="op">.</span><span class="fu">tickSize</span>(<span class="op">-</span>innerW))</span>
<span id="cb7-351"><a href="#cb7-351" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>(g <span class="kw">=&gt;</span> g<span class="op">.</span><span class="fu">select</span>(<span class="st">".domain"</span>)<span class="op">.</span><span class="fu">remove</span>())</span>
<span id="cb7-352"><a href="#cb7-352" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>(g <span class="kw">=&gt;</span> g<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".tick line"</span>)</span>
<span id="cb7-353"><a href="#cb7-353" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"#e0e0e0"</span>)</span>
<span id="cb7-354"><a href="#cb7-354" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-dasharray"</span><span class="op">,</span> <span class="st">"2,2"</span>))</span>
<span id="cb7-355"><a href="#cb7-355" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>(g <span class="kw">=&gt;</span> g<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".tick text"</span>)</span>
<span id="cb7-356"><a href="#cb7-356" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"#666"</span>)</span>
<span id="cb7-357"><a href="#cb7-357" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="dv">11</span>))<span class="op">;</span></span>
<span id="cb7-358"><a href="#cb7-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-359"><a href="#cb7-359" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Zero reference line</span></span>
<span id="cb7-360"><a href="#cb7-360" aria-hidden="true" tabindex="-1"></a>  chartArea<span class="op">.</span><span class="fu">append</span>(<span class="st">"line"</span>)</span>
<span id="cb7-361"><a href="#cb7-361" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb7-362"><a href="#cb7-362" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> innerW)</span>
<span id="cb7-363"><a href="#cb7-363" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> <span class="fu">yScale</span>(<span class="dv">0</span>))</span>
<span id="cb7-364"><a href="#cb7-364" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> <span class="fu">yScale</span>(<span class="dv">0</span>))</span>
<span id="cb7-365"><a href="#cb7-365" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"#333"</span>)</span>
<span id="cb7-366"><a href="#cb7-366" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="fl">1.5</span>)</span>
<span id="cb7-367"><a href="#cb7-367" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-dasharray"</span><span class="op">,</span> <span class="st">"4,4"</span>)<span class="op">;</span></span>
<span id="cb7-368"><a href="#cb7-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-369"><a href="#cb7-369" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Adaptation category ticks (within each column)</span></span>
<span id="cb7-370"><a href="#cb7-370" aria-hidden="true" tabindex="-1"></a>  <span class="co">// const innerAxisGenerator = d3.axisBottom(xInnerScale).tickSize(0);</span></span>
<span id="cb7-371"><a href="#cb7-371" aria-hidden="true" tabindex="-1"></a>  <span class="co">// tempBands.forEach(band =&gt; {</span></span>
<span id="cb7-372"><a href="#cb7-372" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   chartArea.append("g")</span></span>
<span id="cb7-373"><a href="#cb7-373" aria-hidden="true" tabindex="-1"></a>  <span class="co">//     .attr("transform", `translate(${xBandScale(band)},${innerH})`)</span></span>
<span id="cb7-374"><a href="#cb7-374" aria-hidden="true" tabindex="-1"></a>  <span class="co">//     .call(innerAxisGenerator)</span></span>
<span id="cb7-375"><a href="#cb7-375" aria-hidden="true" tabindex="-1"></a>  <span class="co">//     .call(g =&gt; g.select(".domain").remove())</span></span>
<span id="cb7-376"><a href="#cb7-376" aria-hidden="true" tabindex="-1"></a>  <span class="co">//     .call(g =&gt; g.selectAll("text")</span></span>
<span id="cb7-377"><a href="#cb7-377" aria-hidden="true" tabindex="-1"></a>  <span class="co">//       .attr("dy", "1em")</span></span>
<span id="cb7-378"><a href="#cb7-378" aria-hidden="true" tabindex="-1"></a>  <span class="co">//       .attr("font-size", 10)</span></span>
<span id="cb7-379"><a href="#cb7-379" aria-hidden="true" tabindex="-1"></a>  <span class="co">//       .attr("fill", "#666")</span></span>
<span id="cb7-380"><a href="#cb7-380" aria-hidden="true" tabindex="-1"></a>  <span class="co">//       .text(d =&gt; _lang(nbText.regionalPicture.beeswarm.legend[d])));</span></span>
<span id="cb7-381"><a href="#cb7-381" aria-hidden="true" tabindex="-1"></a>  <span class="co">// });</span></span>
<span id="cb7-382"><a href="#cb7-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-383"><a href="#cb7-383" aria-hidden="true" tabindex="-1"></a>  <span class="co">// ============================================================================</span></span>
<span id="cb7-384"><a href="#cb7-384" aria-hidden="true" tabindex="-1"></a>  <span class="co">// LABELS</span></span>
<span id="cb7-385"><a href="#cb7-385" aria-hidden="true" tabindex="-1"></a>  <span class="co">// ============================================================================</span></span>
<span id="cb7-386"><a href="#cb7-386" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-387"><a href="#cb7-387" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Y-axis label</span></span>
<span id="cb7-388"><a href="#cb7-388" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb7-389"><a href="#cb7-389" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(20,</span><span class="sc">${</span>height<span class="op">/</span><span class="dv">2</span><span class="sc">}</span><span class="vs">) rotate(-90)`</span>)</span>
<span id="cb7-390"><a href="#cb7-390" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb7-391"><a href="#cb7-391" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-weight"</span><span class="op">,</span> <span class="dv">600</span>)</span>
<span id="cb7-392"><a href="#cb7-392" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="dv">13</span>)</span>
<span id="cb7-393"><a href="#cb7-393" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"#333"</span>)</span>
<span id="cb7-394"><a href="#cb7-394" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(<span class="st">"Yield Impact (%)"</span>)<span class="op">;</span></span>
<span id="cb7-395"><a href="#cb7-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-396"><a href="#cb7-396" aria-hidden="true" tabindex="-1"></a>  <span class="co">// X-axis label</span></span>
<span id="cb7-397"><a href="#cb7-397" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb7-398"><a href="#cb7-398" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> width <span class="op">/</span> <span class="dv">2</span>)</span>
<span id="cb7-399"><a href="#cb7-399" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> <span class="dv">10</span>)</span>
<span id="cb7-400"><a href="#cb7-400" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb7-401"><a href="#cb7-401" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-weight"</span><span class="op">,</span> <span class="dv">600</span>)</span>
<span id="cb7-402"><a href="#cb7-402" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="dv">13</span>)</span>
<span id="cb7-403"><a href="#cb7-403" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"#333"</span>)</span>
<span id="cb7-404"><a href="#cb7-404" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(<span class="st">"Temperature Increase from Pre-Industrial Levels"</span>)<span class="op">;</span></span>
<span id="cb7-405"><a href="#cb7-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-406"><a href="#cb7-406" aria-hidden="true" tabindex="-1"></a>  <span class="co">// ============================================================================</span></span>
<span id="cb7-407"><a href="#cb7-407" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Legend</span></span>
<span id="cb7-408"><a href="#cb7-408" aria-hidden="true" tabindex="-1"></a>  <span class="co">// ============================================================================</span></span>
<span id="cb7-409"><a href="#cb7-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-410"><a href="#cb7-410" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> legendItems <span class="op">=</span> adaptationTypes<span class="op">.</span><span class="fu">map</span>(a <span class="kw">=&gt;</span> ({</span>
<span id="cb7-411"><a href="#cb7-411" aria-hidden="true" tabindex="-1"></a>    <span class="dt">key</span><span class="op">:</span> a<span class="op">,</span></span>
<span id="cb7-412"><a href="#cb7-412" aria-hidden="true" tabindex="-1"></a>    <span class="co">// use your localized label if available; else fall back to the raw key</span></span>
<span id="cb7-413"><a href="#cb7-413" aria-hidden="true" tabindex="-1"></a>    <span class="dt">label</span><span class="op">:</span> (_lang<span class="op">?.</span>(nbText<span class="op">?.</span><span class="at">regionalPicture</span><span class="op">?.</span><span class="at">beeswarm</span><span class="op">?.</span><span class="at">legend</span><span class="op">?.</span>[a])) <span class="op">??</span> a<span class="op">,</span></span>
<span id="cb7-414"><a href="#cb7-414" aria-hidden="true" tabindex="-1"></a>    <span class="dt">color</span><span class="op">:</span> <span class="fu">colorScale</span>(a)</span>
<span id="cb7-415"><a href="#cb7-415" aria-hidden="true" tabindex="-1"></a>  }))<span class="op">;</span></span>
<span id="cb7-416"><a href="#cb7-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-417"><a href="#cb7-417" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> sw <span class="op">=</span> <span class="dv">12</span><span class="op">;</span>            <span class="co">// swatch size</span></span>
<span id="cb7-418"><a href="#cb7-418" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> rowH <span class="op">=</span> <span class="dv">20</span><span class="op">;</span>          <span class="co">// row height</span></span>
<span id="cb7-419"><a href="#cb7-419" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> gap <span class="op">=</span> <span class="dv">8</span><span class="op">;</span>            <span class="co">// gap between swatch and text</span></span>
<span id="cb7-420"><a href="#cb7-420" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> colWidth <span class="op">=</span> <span class="dv">170</span><span class="op">;</span>     <span class="co">// width per legend column</span></span>
<span id="cb7-421"><a href="#cb7-421" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> cols <span class="op">=</span> legendItems<span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="dv">6</span> <span class="op">?</span> <span class="dv">2</span> <span class="op">:</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb7-422"><a href="#cb7-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-423"><a href="#cb7-423" aria-hidden="true" tabindex="-1"></a>  <span class="co">// position top-right inside the chart area</span></span>
<span id="cb7-424"><a href="#cb7-424" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> legendX <span class="op">=</span> margin<span class="op">.</span><span class="at">left</span> <span class="op">+</span> <span class="dv">5</span><span class="op">;</span></span>
<span id="cb7-425"><a href="#cb7-425" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> legendY <span class="op">=</span> margin<span class="op">.</span><span class="at">top</span> <span class="op">+</span> <span class="dv">8</span><span class="op">;</span></span>
<span id="cb7-426"><a href="#cb7-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-427"><a href="#cb7-427" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> legend <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb7-428"><a href="#cb7-428" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"legend"</span>)</span>
<span id="cb7-429"><a href="#cb7-429" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>legendX<span class="sc">}</span><span class="vs">, </span><span class="sc">${</span>legendY<span class="sc">}</span><span class="vs">)`</span>)</span>
<span id="cb7-430"><a href="#cb7-430" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"aria-label"</span><span class="op">,</span> <span class="st">"Legend"</span>)<span class="op">;</span></span>
<span id="cb7-431"><a href="#cb7-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-432"><a href="#cb7-432" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> items <span class="op">=</span> legend<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)<span class="op">;</span></span>
<span id="cb7-433"><a href="#cb7-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-434"><a href="#cb7-434" aria-hidden="true" tabindex="-1"></a>  items<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"g.item"</span>)</span>
<span id="cb7-435"><a href="#cb7-435" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(legendItems)</span>
<span id="cb7-436"><a href="#cb7-436" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">join</span>(<span class="st">"g"</span>)</span>
<span id="cb7-437"><a href="#cb7-437" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"item"</span>)</span>
<span id="cb7-438"><a href="#cb7-438" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> (d<span class="op">,</span> i) <span class="kw">=&gt;</span> {</span>
<span id="cb7-439"><a href="#cb7-439" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> col <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(i <span class="op">/</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">ceil</span>(legendItems<span class="op">.</span><span class="at">length</span> <span class="op">/</span> cols))<span class="op">;</span></span>
<span id="cb7-440"><a href="#cb7-440" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> row <span class="op">=</span> i <span class="op">%</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">ceil</span>(legendItems<span class="op">.</span><span class="at">length</span> <span class="op">/</span> cols)<span class="op">;</span></span>
<span id="cb7-441"><a href="#cb7-441" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="vs">`translate(</span><span class="sc">${</span>col <span class="op">*</span> colWidth<span class="sc">}</span><span class="vs">, </span><span class="sc">${</span>row <span class="op">*</span> rowH<span class="sc">}</span><span class="vs">)`</span><span class="op">;</span></span>
<span id="cb7-442"><a href="#cb7-442" aria-hidden="true" tabindex="-1"></a>      })</span>
<span id="cb7-443"><a href="#cb7-443" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">each</span>(<span class="kw">function</span>(d) {</span>
<span id="cb7-444"><a href="#cb7-444" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> g <span class="op">=</span> d3<span class="op">.</span><span class="fu">select</span>(<span class="kw">this</span>)<span class="op">;</span></span>
<span id="cb7-445"><a href="#cb7-445" aria-hidden="true" tabindex="-1"></a>        g<span class="op">.</span><span class="fu">append</span>(<span class="st">"rect"</span>)</span>
<span id="cb7-446"><a href="#cb7-446" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> sw)</span>
<span id="cb7-447"><a href="#cb7-447" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> sw)</span>
<span id="cb7-448"><a href="#cb7-448" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"rx"</span><span class="op">,</span> <span class="dv">2</span>)</span>
<span id="cb7-449"><a href="#cb7-449" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"ry"</span><span class="op">,</span> <span class="dv">2</span>)</span>
<span id="cb7-450"><a href="#cb7-450" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb7-451"><a href="#cb7-451" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> d<span class="op">.</span><span class="at">color</span>)</span>
<span id="cb7-452"><a href="#cb7-452" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill-opacity"</span><span class="op">,</span> <span class="fl">0.2</span>)</span>
<span id="cb7-453"><a href="#cb7-453" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> d<span class="op">.</span><span class="at">color</span>)</span>
<span id="cb7-454"><a href="#cb7-454" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="fl">1.5</span>)<span class="op">;</span></span>
<span id="cb7-455"><a href="#cb7-455" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb7-456"><a href="#cb7-456" aria-hidden="true" tabindex="-1"></a>        g<span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb7-457"><a href="#cb7-457" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> sw <span class="op">+</span> gap)</span>
<span id="cb7-458"><a href="#cb7-458" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> sw<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb7-459"><a href="#cb7-459" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dominant-baseline"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb7-460"><a href="#cb7-460" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="dv">11</span>)</span>
<span id="cb7-461"><a href="#cb7-461" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"#333"</span>)</span>
<span id="cb7-462"><a href="#cb7-462" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">text</span>(d<span class="op">.</span><span class="at">label</span>)<span class="op">;</span></span>
<span id="cb7-463"><a href="#cb7-463" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb7-464"><a href="#cb7-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-465"><a href="#cb7-465" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> svg<span class="op">.</span><span class="fu">node</span>()<span class="op">;</span></span>
<span id="cb7-466"><a href="#cb7-466" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-7" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb8" data-startfrom="470" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 469"><span id="cb8-470"><a href="#cb8-470" aria-hidden="true" tabindex="-1"></a>beeswarm_insight_title <span class="op">=</span> {</span>
<span id="cb8-471"><a href="#cb8-471" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> template <span class="op">=</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">regionalPicture</span><span class="op">.</span><span class="at">beeswarmInsight</span><span class="op">.</span><span class="at">title</span>)</span>
<span id="cb8-472"><a href="#cb8-472" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> items <span class="op">=</span> [</span>
<span id="cb8-473"><a href="#cb8-473" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">name</span><span class="op">:</span> <span class="st">"SelectedCrop"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> selected_crop_global<span class="op">.</span><span class="fu">map</span>((c) <span class="kw">=&gt;</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">crops</span>[c]))}<span class="op">,</span></span>
<span id="cb8-474"><a href="#cb8-474" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">name</span><span class="op">:</span> <span class="st">"warmingLevel"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> warming_level}<span class="op">,</span></span>
<span id="cb8-475"><a href="#cb8-475" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb8-476"><a href="#cb8-476" aria-hidden="true" tabindex="-1"></a><span class="cf">return</span> <span class="fu">md</span><span class="vs">`### </span><span class="sc">${</span>Lang<span class="op">.</span><span class="fu">reduceReplaceTemplateItems</span>(template<span class="op">,</span> items)<span class="sc">}</span><span class="vs">`</span></span>
<span id="cb8-477"><a href="#cb8-477" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-8" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb9" data-startfrom="481" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 480"><span id="cb9-481"><a href="#cb9-481" aria-hidden="true" tabindex="-1"></a>viewof warming_level <span class="op">=</span> {</span>
<span id="cb9-482"><a href="#cb9-482" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> Inputs<span class="op">.</span><span class="fu">select</span>(</span>
<span id="cb9-483"><a href="#cb9-483" aria-hidden="true" tabindex="-1"></a>      temp_opts<span class="op">,</span></span>
<span id="cb9-484"><a href="#cb9-484" aria-hidden="true" tabindex="-1"></a>      {<span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">regionalPicture</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">warmingLevel</span><span class="op">.</span><span class="at">title</span>) }</span>
<span id="cb9-485"><a href="#cb9-485" aria-hidden="true" tabindex="-1"></a>  )  </span>
<span id="cb9-486"><a href="#cb9-486" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-9" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb10" data-startfrom="490" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 489"><span id="cb10-490"><a href="#cb10-490" aria-hidden="true" tabindex="-1"></a>violin_insight <span class="op">=</span> {</span>
<span id="cb10-491"><a href="#cb10-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-492"><a href="#cb10-492" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> band_sel <span class="op">=</span> warming_level</span>
<span id="cb10-493"><a href="#cb10-493" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> tempBand_data <span class="op">=</span> {</span>
<span id="cb10-494"><a href="#cb10-494" aria-hidden="true" tabindex="-1"></a>    <span class="dt">temp_band</span><span class="op">:</span> band_sel<span class="op">,</span></span>
<span id="cb10-495"><a href="#cb10-495" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span>violin_insight_data<span class="op">.</span><span class="at">median_yields</span>[band_sel]<span class="op">,</span></span>
<span id="cb10-496"><a href="#cb10-496" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span>violin_insight_data<span class="op">.</span><span class="at">worst_region</span>[band_sel]</span>
<span id="cb10-497"><a href="#cb10-497" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb10-498"><a href="#cb10-498" aria-hidden="true" tabindex="-1"></a><span class="co">// return tempBand_data</span></span>
<span id="cb10-499"><a href="#cb10-499" aria-hidden="true" tabindex="-1"></a>  <span class="co">//Point 1</span></span>
<span id="cb10-500"><a href="#cb10-500" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> template_insight1 <span class="op">=</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">regionalPicture</span><span class="op">.</span><span class="at">beeswarmInsight</span><span class="op">.</span><span class="at">text</span><span class="op">.</span><span class="at">insight1</span>)</span>
<span id="cb10-501"><a href="#cb10-501" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> values_insight1 <span class="op">=</span> [</span>
<span id="cb10-502"><a href="#cb10-502" aria-hidden="true" tabindex="-1"></a>        {<span class="dt">name</span><span class="op">:</span> <span class="st">"warmingLevel"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> band_sel}<span class="op">,</span></span>
<span id="cb10-503"><a href="#cb10-503" aria-hidden="true" tabindex="-1"></a>        {<span class="dt">name</span><span class="op">:</span> <span class="st">"crops"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> selected_crop_global<span class="op">.</span><span class="fu">map</span>((c) <span class="kw">=&gt;</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">crops</span>[c]))}<span class="op">,</span></span>
<span id="cb10-504"><a href="#cb10-504" aria-hidden="true" tabindex="-1"></a>        {<span class="dt">name</span><span class="op">:</span> <span class="st">"yieldReduction"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> tempBand_data<span class="op">.</span><span class="at">median_without_adaptation</span><span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">2</span>)}</span>
<span id="cb10-505"><a href="#cb10-505" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb10-506"><a href="#cb10-506" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> insight1 <span class="op">=</span> Lang<span class="op">.</span><span class="fu">reduceReplaceTemplateItems</span>(template_insight1<span class="op">,</span> values_insight1)</span>
<span id="cb10-507"><a href="#cb10-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-508"><a href="#cb10-508" aria-hidden="true" tabindex="-1"></a>  <span class="co">//Point 2</span></span>
<span id="cb10-509"><a href="#cb10-509" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> template_insight2 <span class="op">=</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">regionalPicture</span><span class="op">.</span><span class="at">beeswarmInsight</span><span class="op">.</span><span class="at">text</span><span class="op">.</span><span class="at">insight2</span><span class="op">.</span><span class="at">mostAffected</span>)</span>
<span id="cb10-510"><a href="#cb10-510" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> values_insight2 <span class="op">=</span> [</span>
<span id="cb10-511"><a href="#cb10-511" aria-hidden="true" tabindex="-1"></a>      {<span class="dt">name</span><span class="op">:</span> <span class="st">"mostAffected_adaptation"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> tempBand_data<span class="op">.</span><span class="at">worst_region_with_adaptation</span><span class="op">.</span><span class="at">region</span>}<span class="op">,</span></span>
<span id="cb10-512"><a href="#cb10-512" aria-hidden="true" tabindex="-1"></a>      {<span class="dt">name</span><span class="op">:</span> <span class="st">"mostAffected_noadaptation"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> tempBand_data<span class="op">.</span><span class="at">worst_region_without_adaptation</span><span class="op">.</span><span class="at">region</span>}<span class="op">,</span></span>
<span id="cb10-513"><a href="#cb10-513" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb10-514"><a href="#cb10-514" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> insight2 <span class="op">=</span> Lang<span class="op">.</span><span class="fu">reduceReplaceTemplateItems</span>(template_insight2<span class="op">,</span> values_insight2)</span>
<span id="cb10-515"><a href="#cb10-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-516"><a href="#cb10-516" aria-hidden="true" tabindex="-1"></a>  <span class="co">//Point 3</span></span>
<span id="cb10-517"><a href="#cb10-517" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> insight3<span class="op">;</span></span>
<span id="cb10-518"><a href="#cb10-518" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="op">!!</span>tempBand_data<span class="op">.</span><span class="at">median_with_adaptation</span>) {</span>
<span id="cb10-519"><a href="#cb10-519" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> template_insight3 <span class="op">=</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">regionalPicture</span><span class="op">.</span><span class="at">beeswarmInsight</span><span class="op">.</span><span class="at">text</span><span class="op">.</span><span class="at">insight3</span><span class="op">.</span><span class="at">compelling</span>)<span class="op">;</span></span>
<span id="cb10-520"><a href="#cb10-520" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> values_insight3 <span class="op">=</span> [</span>
<span id="cb10-521"><a href="#cb10-521" aria-hidden="true" tabindex="-1"></a>      {<span class="dt">name</span><span class="op">:</span> <span class="st">"loss_gain"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="st">"losses"</span>}<span class="op">,</span> <span class="co">// Hard coded for now as all data is better with adaptation</span></span>
<span id="cb10-522"><a href="#cb10-522" aria-hidden="true" tabindex="-1"></a>      {<span class="dt">name</span><span class="op">:</span> <span class="st">"withAdaptation"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> tempBand_data<span class="op">.</span><span class="at">median_with_adaptation</span><span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">2</span>)}<span class="op">,</span></span>
<span id="cb10-523"><a href="#cb10-523" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb10-524"><a href="#cb10-524" aria-hidden="true" tabindex="-1"></a>    insight3 <span class="op">=</span> Lang<span class="op">.</span><span class="fu">reduceReplaceTemplateItems</span>(template_insight3<span class="op">,</span> values_insight3)</span>
<span id="cb10-525"><a href="#cb10-525" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb10-526"><a href="#cb10-526" aria-hidden="true" tabindex="-1"></a>    insight3 <span class="op">=</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">regionalPicture</span><span class="op">.</span><span class="at">beeswarmInsight</span><span class="op">.</span><span class="at">text</span><span class="op">.</span><span class="at">insight3</span><span class="op">.</span><span class="at">notCompelling</span>)<span class="op">;</span></span>
<span id="cb10-527"><a href="#cb10-527" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb10-528"><a href="#cb10-528" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-529"><a href="#cb10-529" aria-hidden="true" tabindex="-1"></a><span class="cf">return</span> <span class="fu">md</span><span class="vs">`</span></span>
<span id="cb10-530"><a href="#cb10-530" aria-hidden="true" tabindex="-1"></a><span class="vs">* </span><span class="sc">${</span>insight2<span class="sc">}</span></span>
<span id="cb10-531"><a href="#cb10-531" aria-hidden="true" tabindex="-1"></a><span class="vs">* </span><span class="sc">${</span>insight1<span class="sc">}</span></span>
<span id="cb10-532"><a href="#cb10-532" aria-hidden="true" tabindex="-1"></a><span class="vs">* </span><span class="sc">${</span>insight3<span class="sc">}</span><span class="vs">`</span></span>
<span id="cb10-533"><a href="#cb10-533" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-10" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb11" data-startfrom="537" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 536"><span id="cb11-537"><a href="#cb11-537" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`# </span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">zoomToStable</span><span class="op">.</span><span class="at">title</span>)<span class="sc">}</span></span>
<span id="cb11-538"><a href="#cb11-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-539"><a href="#cb11-539" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">zoomToStable</span><span class="op">.</span><span class="at">text</span>)<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-11" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb12" data-startfrom="543" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 542"><span id="cb12-543"><a href="#cb12-543" aria-hidden="true" tabindex="-1"></a>zoom_in_selectors <span class="op">=</span> {</span>
<span id="cb12-544"><a href="#cb12-544" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> form <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">form</span>(zoom_in_elements<span class="op">,</span> {<span class="dt">template</span><span class="op">:</span> <span class="fu">formTemplate</span>()})</span>
<span id="cb12-545"><a href="#cb12-545" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> form</span>
<span id="cb12-546"><a href="#cb12-546" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-12" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb13" data-startfrom="550" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 549"><span id="cb13-550"><a href="#cb13-550" aria-hidden="true" tabindex="-1"></a><span class="co">// format admin selections</span></span>
<span id="cb13-551"><a href="#cb13-551" aria-hidden="true" tabindex="-1"></a><span class="co">// bind to appendix inputs, add template to format</span></span>
<span id="cb13-552"><a href="#cb13-552" aria-hidden="true" tabindex="-1"></a>geoImpactAdminSelectors <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">form</span>(</span>
<span id="cb13-553"><a href="#cb13-553" aria-hidden="true" tabindex="-1"></a>  [</span>
<span id="cb13-554"><a href="#cb13-554" aria-hidden="true" tabindex="-1"></a>    Inputs<span class="op">.</span><span class="fu">bind</span>(</span>
<span id="cb13-555"><a href="#cb13-555" aria-hidden="true" tabindex="-1"></a>      Inputs<span class="op">.</span><span class="fu">select</span>(dataAdmin0<span class="op">,</span> { <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">country</span>)<span class="op">,</span> <span class="dt">format</span><span class="op">:</span> x <span class="kw">=&gt;</span> x <span class="op">==</span> <span class="kw">null</span> <span class="op">?</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">adminNames</span>[<span class="st">'SSA'</span>])<span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">adminNames</span>[x])})<span class="op">,</span></span>
<span id="cb13-556"><a href="#cb13-556" aria-hidden="true" tabindex="-1"></a>      viewof selectAdmin0</span>
<span id="cb13-557"><a href="#cb13-557" aria-hidden="true" tabindex="-1"></a>    )<span class="op">,</span></span>
<span id="cb13-558"><a href="#cb13-558" aria-hidden="true" tabindex="-1"></a>    Inputs<span class="op">.</span><span class="fu">bind</span>(</span>
<span id="cb13-559"><a href="#cb13-559" aria-hidden="true" tabindex="-1"></a>      Inputs<span class="op">.</span><span class="fu">select</span>(dataAdmin1<span class="op">,</span> { <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">region</span>) })<span class="op">,</span></span>
<span id="cb13-560"><a href="#cb13-560" aria-hidden="true" tabindex="-1"></a>      viewof selectAdmin1</span>
<span id="cb13-561"><a href="#cb13-561" aria-hidden="true" tabindex="-1"></a>    )<span class="op">,</span></span>
<span id="cb13-562"><a href="#cb13-562" aria-hidden="true" tabindex="-1"></a>    Inputs<span class="op">.</span><span class="fu">bind</span>(</span>
<span id="cb13-563"><a href="#cb13-563" aria-hidden="true" tabindex="-1"></a>      Inputs<span class="op">.</span><span class="fu">select</span>(dataAdmin2<span class="op">,</span> { <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">subRegion</span>) })<span class="op">,</span></span>
<span id="cb13-564"><a href="#cb13-564" aria-hidden="true" tabindex="-1"></a>      viewof selectAdmin2</span>
<span id="cb13-565"><a href="#cb13-565" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb13-566"><a href="#cb13-566" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">,</span></span>
<span id="cb13-567"><a href="#cb13-567" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb13-568"><a href="#cb13-568" aria-hidden="true" tabindex="-1"></a>    <span class="dt">template</span><span class="op">:</span> <span class="fu">formTemplate</span>()</span>
<span id="cb13-569"><a href="#cb13-569" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb13-570"><a href="#cb13-570" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-13" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb14" data-startfrom="574" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 573"><span id="cb14-574"><a href="#cb14-574" aria-hidden="true" tabindex="-1"></a><span class="co">// define choices for the data value</span></span>
<span id="cb14-575"><a href="#cb14-575" aria-hidden="true" tabindex="-1"></a>viewof selectGeoDataType <span class="op">=</span> {</span>
<span id="cb14-576"><a href="#cb14-576" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> options <span class="op">=</span> [</span>
<span id="cb14-577"><a href="#cb14-577" aria-hidden="true" tabindex="-1"></a><span class="co">/*    </span></span>
<span id="cb14-578"><a href="#cb14-578" aria-hidden="true" tabindex="-1"></a><span class="co">    {</span></span>
<span id="cb14-579"><a href="#cb14-579" aria-hidden="true" tabindex="-1"></a><span class="co">      key: "population", // lookup id for data option</span></span>
<span id="cb14-580"><a href="#cb14-580" aria-hidden="true" tabindex="-1"></a><span class="co">      dataColumn: "rural_pop", // data column</span></span>
<span id="cb14-581"><a href="#cb14-581" aria-hidden="true" tabindex="-1"></a><span class="co">      label: "Rural population", // label</span></span>
<span id="cb14-582"><a href="#cb14-582" aria-hidden="true" tabindex="-1"></a><span class="co">      labelTip: "Rural population", // label for tooltip</span></span>
<span id="cb14-583"><a href="#cb14-583" aria-hidden="true" tabindex="-1"></a><span class="co">      labelLegend: "Rural population", // label for legend</span></span>
<span id="cb14-584"><a href="#cb14-584" aria-hidden="true" tabindex="-1"></a><span class="co">      formatFunc: formatNumCompactShort, // formatting function for raw data value</span></span>
<span id="cb14-585"><a href="#cb14-585" aria-hidden="true" tabindex="-1"></a><span class="co">      colorRange: colorScales.range.yellowGreen, // color range</span></span>
<span id="cb14-586"><a href="#cb14-586" aria-hidden="true" tabindex="-1"></a><span class="co">      colorUnknown: colorScales.unknown, // unknown fill color </span></span>
<span id="cb14-587"><a href="#cb14-587" aria-hidden="true" tabindex="-1"></a><span class="co">    },</span></span>
<span id="cb14-588"><a href="#cb14-588" aria-hidden="true" tabindex="-1"></a><span class="co">    {</span></span>
<span id="cb14-589"><a href="#cb14-589" aria-hidden="true" tabindex="-1"></a><span class="co">      key: "vop",</span></span>
<span id="cb14-590"><a href="#cb14-590" aria-hidden="true" tabindex="-1"></a><span class="co">      dataColumn: "vop_total",</span></span>
<span id="cb14-591"><a href="#cb14-591" aria-hidden="true" tabindex="-1"></a><span class="co">      label: "Total Value of Production (VoP)",</span></span>
<span id="cb14-592"><a href="#cb14-592" aria-hidden="true" tabindex="-1"></a><span class="co">      labelTip: "VoP",</span></span>
<span id="cb14-593"><a href="#cb14-593" aria-hidden="true" tabindex="-1"></a><span class="co">      labelLegend: "Value of Production ($)",</span></span>
<span id="cb14-594"><a href="#cb14-594" aria-hidden="true" tabindex="-1"></a><span class="co">      formatFunc: formatUSD,</span></span>
<span id="cb14-595"><a href="#cb14-595" aria-hidden="true" tabindex="-1"></a><span class="co">      colorRange: colorScales.range.yellowGreen,</span></span>
<span id="cb14-596"><a href="#cb14-596" aria-hidden="true" tabindex="-1"></a><span class="co">      colorUnknown: colorScales.unknown,</span></span>
<span id="cb14-597"><a href="#cb14-597" aria-hidden="true" tabindex="-1"></a><span class="co">    },</span></span>
<span id="cb14-598"><a href="#cb14-598" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb14-599"><a href="#cb14-599" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb14-600"><a href="#cb14-600" aria-hidden="true" tabindex="-1"></a>      <span class="dt">key</span><span class="op">:</span> <span class="st">"wmean_yield_rfd"</span><span class="op">,</span></span>
<span id="cb14-601"><a href="#cb14-601" aria-hidden="true" tabindex="-1"></a>      <span class="dt">dataColumn</span><span class="op">:</span> <span class="st">"wmean_yield_rfd"</span><span class="op">,</span></span>
<span id="cb14-602"><a href="#cb14-602" aria-hidden="true" tabindex="-1"></a>      <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">zoomToStable</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">layer</span><span class="op">.</span><span class="at">values</span><span class="op">.</span><span class="at">rainfed</span>)<span class="op">,</span><span class="co">//"Mean rainfed potential yield", </span></span>
<span id="cb14-603"><a href="#cb14-603" aria-hidden="true" tabindex="-1"></a>      <span class="dt">labelTip</span><span class="op">:</span> <span class="st">"rfd"</span><span class="op">,</span></span>
<span id="cb14-604"><a href="#cb14-604" aria-hidden="true" tabindex="-1"></a>      <span class="dt">labelLegend</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">zoomToStable</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">layer</span><span class="op">.</span><span class="at">values</span><span class="op">.</span><span class="at">rainfed</span>)<span class="op">,</span></span>
<span id="cb14-605"><a href="#cb14-605" aria-hidden="true" tabindex="-1"></a>      <span class="dt">formatFunc</span><span class="op">:</span> formatNumCompactShort<span class="op">,</span></span>
<span id="cb14-606"><a href="#cb14-606" aria-hidden="true" tabindex="-1"></a>      <span class="dt">colorRange</span><span class="op">:</span> colorScales<span class="op">.</span><span class="at">range</span><span class="op">.</span><span class="at">yellowGreen</span><span class="op">,</span></span>
<span id="cb14-607"><a href="#cb14-607" aria-hidden="true" tabindex="-1"></a>      <span class="dt">colorUnknown</span><span class="op">:</span> colorScales<span class="op">.</span><span class="at">unknown</span><span class="op">,</span></span>
<span id="cb14-608"><a href="#cb14-608" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb14-609"><a href="#cb14-609" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb14-610"><a href="#cb14-610" aria-hidden="true" tabindex="-1"></a>      <span class="dt">key</span><span class="op">:</span> <span class="st">"wmean_yield_irr"</span><span class="op">,</span></span>
<span id="cb14-611"><a href="#cb14-611" aria-hidden="true" tabindex="-1"></a>      <span class="dt">dataColumn</span><span class="op">:</span> <span class="st">"wmean_yield_irr"</span><span class="op">,</span></span>
<span id="cb14-612"><a href="#cb14-612" aria-hidden="true" tabindex="-1"></a>      <span class="dt">label</span><span class="op">:</span>  <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">zoomToStable</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">layer</span><span class="op">.</span><span class="at">values</span><span class="op">.</span><span class="at">irrigated</span>)<span class="op">,</span></span>
<span id="cb14-613"><a href="#cb14-613" aria-hidden="true" tabindex="-1"></a>      <span class="dt">labelTip</span><span class="op">:</span> <span class="st">"irr"</span><span class="op">,</span></span>
<span id="cb14-614"><a href="#cb14-614" aria-hidden="true" tabindex="-1"></a>      <span class="dt">labelLegend</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">zoomToStable</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">layer</span><span class="op">.</span><span class="at">values</span><span class="op">.</span><span class="at">irrigated</span>)<span class="op">,</span></span>
<span id="cb14-615"><a href="#cb14-615" aria-hidden="true" tabindex="-1"></a>      <span class="dt">formatFunc</span><span class="op">:</span> formatNumCompactShort<span class="op">,</span></span>
<span id="cb14-616"><a href="#cb14-616" aria-hidden="true" tabindex="-1"></a>      <span class="dt">colorRange</span><span class="op">:</span> colorScales<span class="op">.</span><span class="at">range</span><span class="op">.</span><span class="at">yellowGreen</span><span class="op">,</span></span>
<span id="cb14-617"><a href="#cb14-617" aria-hidden="true" tabindex="-1"></a>      <span class="dt">colorUnknown</span><span class="op">:</span> colorScales<span class="op">.</span><span class="at">unknown</span><span class="op">,</span></span>
<span id="cb14-618"><a href="#cb14-618" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb14-619"><a href="#cb14-619" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">;</span></span>
<span id="cb14-620"><a href="#cb14-620" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> Inputs<span class="op">.</span><span class="fu">radio</span>(options<span class="op">.</span><span class="fu">sort</span>((a<span class="op">,</span>b) <span class="kw">=&gt;</span> b<span class="op">.</span><span class="at">key</span><span class="op">.</span><span class="fu">localeCompare</span>(a<span class="op">.</span><span class="at">key</span>))<span class="op">,</span> {</span>
<span id="cb14-621"><a href="#cb14-621" aria-hidden="true" tabindex="-1"></a>    <span class="dt">width</span><span class="op">:</span> <span class="dv">300</span><span class="op">,</span></span>
<span id="cb14-622"><a href="#cb14-622" aria-hidden="true" tabindex="-1"></a>    <span class="dt">label</span><span class="op">:</span>  <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">zoomToStable</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">layer</span><span class="op">.</span><span class="at">title</span>)<span class="op">,</span></span>
<span id="cb14-623"><a href="#cb14-623" aria-hidden="true" tabindex="-1"></a>    <span class="dt">format</span><span class="op">:</span> (x) <span class="kw">=&gt;</span> x<span class="op">.</span><span class="at">label</span><span class="op">,</span></span>
<span id="cb14-624"><a href="#cb14-624" aria-hidden="true" tabindex="-1"></a>    <span class="dt">value</span><span class="op">:</span> options<span class="op">.</span><span class="fu">find</span>((t) <span class="kw">=&gt;</span> t<span class="op">.</span><span class="at">key</span> <span class="op">===</span> <span class="st">"wmean_yield_rfd"</span>)</span>
<span id="cb14-625"><a href="#cb14-625" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb14-626"><a href="#cb14-626" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-14" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb15" data-startfrom="630" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 629"><span id="cb15-630"><a href="#cb15-630" aria-hidden="true" tabindex="-1"></a>plotChoroplethGeoImpact <span class="op">=</span> {</span>
<span id="cb15-631"><a href="#cb15-631" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> data <span class="op">=</span> mapDataGeoImpact</span>
<span id="cb15-632"><a href="#cb15-632" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> selector <span class="op">=</span> selectGeoDataType</span>
<span id="cb15-633"><a href="#cb15-633" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dataColumn <span class="op">=</span> mapDataColumn<span class="op">;</span></span>
<span id="cb15-634"><a href="#cb15-634" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-635"><a href="#cb15-635" aria-hidden="true" tabindex="-1"></a>  <span class="co">// return plot</span></span>
<span id="cb15-636"><a href="#cb15-636" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb15-637"><a href="#cb15-637" aria-hidden="true" tabindex="-1"></a>    <span class="dt">width</span><span class="op">:</span> mapWidth<span class="op">,</span></span>
<span id="cb15-638"><a href="#cb15-638" aria-hidden="true" tabindex="-1"></a>    <span class="dt">height</span><span class="op">:</span> <span class="dv">550</span><span class="op">,</span></span>
<span id="cb15-639"><a href="#cb15-639" aria-hidden="true" tabindex="-1"></a>    <span class="dt">caption</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">greyNoData</span>)<span class="op">,</span></span>
<span id="cb15-640"><a href="#cb15-640" aria-hidden="true" tabindex="-1"></a>    <span class="dt">projection</span><span class="op">:</span> {</span>
<span id="cb15-641"><a href="#cb15-641" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">"azimuthal-equal-area"</span><span class="op">,</span></span>
<span id="cb15-642"><a href="#cb15-642" aria-hidden="true" tabindex="-1"></a>      <span class="dt">domain</span><span class="op">:</span> data</span>
<span id="cb15-643"><a href="#cb15-643" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb15-644"><a href="#cb15-644" aria-hidden="true" tabindex="-1"></a>    <span class="dt">color</span><span class="op">:</span> {</span>
<span id="cb15-645"><a href="#cb15-645" aria-hidden="true" tabindex="-1"></a>      <span class="dt">legend</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb15-646"><a href="#cb15-646" aria-hidden="true" tabindex="-1"></a>      <span class="dt">label</span><span class="op">:</span> selector<span class="op">.</span><span class="at">labelLegend</span><span class="op">,</span></span>
<span id="cb15-647"><a href="#cb15-647" aria-hidden="true" tabindex="-1"></a>      <span class="dt">range</span><span class="op">:</span> selector<span class="op">.</span><span class="at">colorRange</span><span class="op">,</span></span>
<span id="cb15-648"><a href="#cb15-648" aria-hidden="true" tabindex="-1"></a>      <span class="dt">unknown</span><span class="op">:</span> selector<span class="op">.</span><span class="at">colorUnknown</span><span class="op">,</span></span>
<span id="cb15-649"><a href="#cb15-649" aria-hidden="true" tabindex="-1"></a>      <span class="dt">tickFormat</span><span class="op">:</span> selector<span class="op">.</span><span class="at">formatFunc</span><span class="op">,</span></span>
<span id="cb15-650"><a href="#cb15-650" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb15-651"><a href="#cb15-651" aria-hidden="true" tabindex="-1"></a>    <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb15-652"><a href="#cb15-652" aria-hidden="true" tabindex="-1"></a>      <span class="co">// geo data</span></span>
<span id="cb15-653"><a href="#cb15-653" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">geo</span>(data<span class="op">.</span><span class="at">features</span><span class="op">,</span> {</span>
<span id="cb15-654"><a href="#cb15-654" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fill</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> {</span>
<span id="cb15-655"><a href="#cb15-655" aria-hidden="true" tabindex="-1"></a>          <span class="kw">const</span> fillValue <span class="op">=</span> d<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">data</span> <span class="op">?</span> d<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">data</span>[dataColumn] <span class="op">:</span> <span class="kw">null</span><span class="op">;</span> <span class="co">// handle missing data</span></span>
<span id="cb15-656"><a href="#cb15-656" aria-hidden="true" tabindex="-1"></a>          <span class="cf">return</span> fillValue</span>
<span id="cb15-657"><a href="#cb15-657" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb15-658"><a href="#cb15-658" aria-hidden="true" tabindex="-1"></a>        <span class="dt">stroke</span><span class="op">:</span> <span class="st">"#fff"</span><span class="op">,</span></span>
<span id="cb15-659"><a href="#cb15-659" aria-hidden="true" tabindex="-1"></a>        <span class="dt">strokeWidth</span><span class="op">:</span> <span class="fl">0.5</span></span>
<span id="cb15-660"><a href="#cb15-660" aria-hidden="true" tabindex="-1"></a>      })<span class="op">,</span></span>
<span id="cb15-661"><a href="#cb15-661" aria-hidden="true" tabindex="-1"></a>      <span class="co">// admin2 highlight </span></span>
<span id="cb15-662"><a href="#cb15-662" aria-hidden="true" tabindex="-1"></a>      <span class="co">// if Admin selection includes admin2, highlight section</span></span>
<span id="cb15-663"><a href="#cb15-663" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">geo</span>(adminSelections<span class="op">.</span><span class="at">selectAdmin2</span> </span>
<span id="cb15-664"><a href="#cb15-664" aria-hidden="true" tabindex="-1"></a>               <span class="op">?</span> data<span class="op">.</span><span class="at">features</span><span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">admin2_name</span> <span class="op">==</span> adminSelections<span class="op">.</span><span class="at">selectAdmin2</span>)</span>
<span id="cb15-665"><a href="#cb15-665" aria-hidden="true" tabindex="-1"></a>               <span class="op">:</span> []<span class="op">,</span> {</span>
<span id="cb15-666"><a href="#cb15-666" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fill</span><span class="op">:</span> <span class="kw">null</span><span class="op">,</span></span>
<span id="cb15-667"><a href="#cb15-667" aria-hidden="true" tabindex="-1"></a>        <span class="dt">stroke</span><span class="op">:</span> <span class="st">"#333"</span><span class="op">,</span></span>
<span id="cb15-668"><a href="#cb15-668" aria-hidden="true" tabindex="-1"></a>        <span class="dt">strokeWidth</span><span class="op">:</span> <span class="fl">1.5</span></span>
<span id="cb15-669"><a href="#cb15-669" aria-hidden="true" tabindex="-1"></a>      })<span class="op">,</span></span>
<span id="cb15-670"><a href="#cb15-670" aria-hidden="true" tabindex="-1"></a>      <span class="co">// geo pointer</span></span>
<span id="cb15-671"><a href="#cb15-671" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">geo</span>(data<span class="op">,</span> Plot<span class="op">.</span><span class="fu">pointer</span>(</span>
<span id="cb15-672"><a href="#cb15-672" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">centroid</span>({</span>
<span id="cb15-673"><a href="#cb15-673" aria-hidden="true" tabindex="-1"></a>        <span class="dt">stroke</span><span class="op">:</span> <span class="st">"#333"</span><span class="op">,</span></span>
<span id="cb15-674"><a href="#cb15-674" aria-hidden="true" tabindex="-1"></a>        <span class="dt">strokeWidth</span><span class="op">:</span> <span class="fl">1.5</span><span class="op">,</span></span>
<span id="cb15-675"><a href="#cb15-675" aria-hidden="true" tabindex="-1"></a>      })))<span class="op">,</span></span>
<span id="cb15-676"><a href="#cb15-676" aria-hidden="true" tabindex="-1"></a>      <span class="co">// tooltip</span></span>
<span id="cb15-677"><a href="#cb15-677" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">tip</span>(</span>
<span id="cb15-678"><a href="#cb15-678" aria-hidden="true" tabindex="-1"></a>        data<span class="op">.</span><span class="at">features</span><span class="op">,</span></span>
<span id="cb15-679"><a href="#cb15-679" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">pointer</span>(</span>
<span id="cb15-680"><a href="#cb15-680" aria-hidden="true" tabindex="-1"></a>          Plot<span class="op">.</span><span class="fu">centroid</span>({</span>
<span id="cb15-681"><a href="#cb15-681" aria-hidden="true" tabindex="-1"></a>            <span class="dt">channels</span><span class="op">:</span> {</span>
<span id="cb15-682"><a href="#cb15-682" aria-hidden="true" tabindex="-1"></a>              <span class="dt">name</span><span class="op">:</span> {</span>
<span id="cb15-683"><a href="#cb15-683" aria-hidden="true" tabindex="-1"></a>                <span class="co">// region label, based on selection</span></span>
<span id="cb15-684"><a href="#cb15-684" aria-hidden="true" tabindex="-1"></a>                <span class="dt">label</span><span class="op">:</span> <span class="fu">getLowerLevelAdminLabel</span>()<span class="op">,</span> <span class="co">// plot-level so inputs don't reload</span></span>
<span id="cb15-685"><a href="#cb15-685" aria-hidden="true" tabindex="-1"></a>                <span class="dt">value</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">admin_name</span></span>
<span id="cb15-686"><a href="#cb15-686" aria-hidden="true" tabindex="-1"></a>              }<span class="op">,</span></span>
<span id="cb15-687"><a href="#cb15-687" aria-hidden="true" tabindex="-1"></a>              <span class="dt">country</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">admin0_name</span><span class="op">,</span></span>
<span id="cb15-688"><a href="#cb15-688" aria-hidden="true" tabindex="-1"></a>              <span class="dt">data</span><span class="op">:</span> {</span>
<span id="cb15-689"><a href="#cb15-689" aria-hidden="true" tabindex="-1"></a>                <span class="dt">label</span><span class="op">:</span> selector<span class="op">.</span><span class="at">labelTip</span><span class="op">,</span></span>
<span id="cb15-690"><a href="#cb15-690" aria-hidden="true" tabindex="-1"></a>                <span class="dt">value</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> {</span>
<span id="cb15-691"><a href="#cb15-691" aria-hidden="true" tabindex="-1"></a>                <span class="kw">const</span> data <span class="op">=</span> d<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">data</span> <span class="op">?</span> d<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">data</span>[dataColumn] <span class="op">:</span> <span class="kw">undefined</span></span>
<span id="cb15-692"><a href="#cb15-692" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> data</span>
<span id="cb15-693"><a href="#cb15-693" aria-hidden="true" tabindex="-1"></a>              }<span class="op">,</span></span>
<span id="cb15-694"><a href="#cb15-694" aria-hidden="true" tabindex="-1"></a>              }</span>
<span id="cb15-695"><a href="#cb15-695" aria-hidden="true" tabindex="-1"></a>            }<span class="op">,</span></span>
<span id="cb15-696"><a href="#cb15-696" aria-hidden="true" tabindex="-1"></a>            <span class="dt">format</span><span class="op">:</span> {</span>
<span id="cb15-697"><a href="#cb15-697" aria-hidden="true" tabindex="-1"></a>              <span class="dt">name</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb15-698"><a href="#cb15-698" aria-hidden="true" tabindex="-1"></a>              <span class="dt">country</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb15-699"><a href="#cb15-699" aria-hidden="true" tabindex="-1"></a>              <span class="dt">data</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> selector<span class="op">.</span><span class="fu">formatFunc</span>(d)</span>
<span id="cb15-700"><a href="#cb15-700" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb15-701"><a href="#cb15-701" aria-hidden="true" tabindex="-1"></a>          })</span>
<span id="cb15-702"><a href="#cb15-702" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb15-703"><a href="#cb15-703" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb15-704"><a href="#cb15-704" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb15-705"><a href="#cb15-705" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb15-706"><a href="#cb15-706" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-15" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb16" data-startfrom="710" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 709"><span id="cb16-710"><a href="#cb16-710" aria-hidden="true" tabindex="-1"></a>map_insights <span class="op">=</span> {</span>
<span id="cb16-711"><a href="#cb16-711" aria-hidden="true" tabindex="-1"></a>  <span class="kw">async</span> <span class="kw">function</span> <span class="fu">quick_insight_map_admin_rank</span>(data_column){</span>
<span id="cb16-712"><a href="#cb16-712" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> none_admins_for_same_level <span class="op">=</span> <span class="fu">getAdminsNoneForSameLevel</span>()</span>
<span id="cb16-713"><a href="#cb16-713" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> query <span class="op">=</span> <span class="vs">`</span></span>
<span id="cb16-714"><a href="#cb16-714" aria-hidden="true" tabindex="-1"></a><span class="vs">        SELECT *</span></span>
<span id="cb16-715"><a href="#cb16-715" aria-hidden="true" tabindex="-1"></a><span class="vs">        FROM aggregated</span></span>
<span id="cb16-716"><a href="#cb16-716" aria-hidden="true" tabindex="-1"></a><span class="vs">        WHERE cycle = '</span><span class="sc">${</span>selected_cycle_options<span class="op">.</span><span class="at">cycle</span><span class="sc">}</span><span class="vs">'</span></span>
<span id="cb16-717"><a href="#cb16-717" aria-hidden="true" tabindex="-1"></a><span class="vs">        AND crop = '</span><span class="sc">${</span>crop_selector_dynamic_insights<span class="sc">}</span><span class="vs">'</span></span>
<span id="cb16-718"><a href="#cb16-718" aria-hidden="true" tabindex="-1"></a><span class="vs">        AND cultivar = '</span><span class="sc">${</span>selected_cultivar<span class="op">.</span><span class="at">value</span><span class="sc">}</span><span class="vs">'`</span></span>
<span id="cb16-719"><a href="#cb16-719" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (none_admins_for_same_level<span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb16-720"><a href="#cb16-720" aria-hidden="true" tabindex="-1"></a>      query <span class="op">+=</span> <span class="vs">` AND </span><span class="sc">${</span>none_admins_for_same_level<span class="op">.</span><span class="fu">map</span>(col <span class="kw">=&gt;</span> <span class="vs">`</span><span class="sc">${</span>col<span class="sc">}</span><span class="vs"> IS NULL`</span>)<span class="op">.</span><span class="fu">join</span>(<span class="st">' AND '</span>)<span class="sc">}</span><span class="vs">`</span></span>
<span id="cb16-721"><a href="#cb16-721" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb16-722"><a href="#cb16-722" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> same_level <span class="op">=</span> <span class="cf">await</span> db<span class="op">.</span><span class="fu">query</span>(query)</span>
<span id="cb16-723"><a href="#cb16-723" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">then</span>((r) <span class="kw">=&gt;</span> r<span class="op">.</span><span class="fu">toArray</span>())</span>
<span id="cb16-724"><a href="#cb16-724" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Sort by absolute yield changes, descending order</span></span>
<span id="cb16-725"><a href="#cb16-725" aria-hidden="true" tabindex="-1"></a>    <span class="co">// </span><span class="al">TODO</span><span class="co">: absolute value?</span></span>
<span id="cb16-726"><a href="#cb16-726" aria-hidden="true" tabindex="-1"></a>    same_level<span class="op">.</span><span class="fu">sort</span>((a<span class="op">,</span> b) <span class="kw">=&gt;</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">abs</span>(a[data_column]) <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">abs</span>(b[data_column]))<span class="op">.</span><span class="fu">reverse</span>()<span class="op">;</span></span>
<span id="cb16-727"><a href="#cb16-727" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-728"><a href="#cb16-728" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> ranking <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb16-729"><a href="#cb16-729" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> selected_admin <span class="op">=</span> <span class="fu">get_selected_admin_atfc</span>()<span class="op">;</span></span>
<span id="cb16-730"><a href="#cb16-730" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> admins_to_names <span class="op">=</span> {</span>
<span id="cb16-731"><a href="#cb16-731" aria-hidden="true" tabindex="-1"></a>      <span class="dt">admin0_name</span><span class="op">:</span> <span class="st">"countries"</span><span class="op">,</span></span>
<span id="cb16-732"><a href="#cb16-732" aria-hidden="true" tabindex="-1"></a>      <span class="dt">admin1_name</span><span class="op">:</span> <span class="st">"regions"</span><span class="op">,</span></span>
<span id="cb16-733"><a href="#cb16-733" aria-hidden="true" tabindex="-1"></a>      <span class="dt">admin2_name</span><span class="op">:</span> <span class="st">"subregions"</span><span class="op">,</span></span>
<span id="cb16-734"><a href="#cb16-734" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb16-735"><a href="#cb16-735" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> same_level<span class="op">.</span><span class="at">length</span><span class="op">;</span> i<span class="op">++</span>){</span>
<span id="cb16-736"><a href="#cb16-736" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> obj <span class="op">=</span> same_level[i]<span class="op">;</span></span>
<span id="cb16-737"><a href="#cb16-737" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (obj[selected_admin<span class="op">.</span><span class="at">admin</span>] <span class="op">!=</span> selected_admin<span class="op">.</span><span class="at">highlight</span>)</span>
<span id="cb16-738"><a href="#cb16-738" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb16-739"><a href="#cb16-739" aria-hidden="true" tabindex="-1"></a>      ranking <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb16-740"><a href="#cb16-740" aria-hidden="true" tabindex="-1"></a>      <span class="cf">break</span></span>
<span id="cb16-741"><a href="#cb16-741" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb16-742"><a href="#cb16-742" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-743"><a href="#cb16-743" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {</span>
<span id="cb16-744"><a href="#cb16-744" aria-hidden="true" tabindex="-1"></a>      <span class="dt">data</span><span class="op">:</span> same_level<span class="op">,</span></span>
<span id="cb16-745"><a href="#cb16-745" aria-hidden="true" tabindex="-1"></a>      <span class="dt">ranking</span><span class="op">:</span> ranking<span class="op">,</span></span>
<span id="cb16-746"><a href="#cb16-746" aria-hidden="true" tabindex="-1"></a>      <span class="dt">selected_geo</span><span class="op">:</span> selected_admin<span class="op">.</span><span class="at">highlight</span><span class="op">,</span></span>
<span id="cb16-747"><a href="#cb16-747" aria-hidden="true" tabindex="-1"></a>      <span class="dt">admin_name</span><span class="op">:</span> admins_to_names[selected_admin<span class="op">.</span><span class="at">admin</span>]<span class="op">,</span></span>
<span id="cb16-748"><a href="#cb16-748" aria-hidden="true" tabindex="-1"></a>      <span class="dt">out_of</span><span class="op">:</span> same_level<span class="op">.</span><span class="at">length</span><span class="op">,</span></span>
<span id="cb16-749"><a href="#cb16-749" aria-hidden="true" tabindex="-1"></a>    }<span class="op">;</span></span>
<span id="cb16-750"><a href="#cb16-750" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-751"><a href="#cb16-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-752"><a href="#cb16-752" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">average_first_insight_for_all_subsaharan_africa</span>(filtered) {</span>
<span id="cb16-753"><a href="#cb16-753" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> yield_in_selected_geo <span class="op">=</span> filtered<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">admin1_name</span> <span class="op">==</span> <span class="kw">null</span>)</span>
<span id="cb16-754"><a href="#cb16-754" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> colname <span class="op">=</span> <span class="fu">get_yield_column</span>(selected_yield_output<span class="op">.</span><span class="at">label</span><span class="op">,</span> selectGeoDataType<span class="op">.</span><span class="at">labelTip</span>)<span class="op">;</span></span>
<span id="cb16-755"><a href="#cb16-755" aria-hidden="true" tabindex="-1"></a>    <span class="co">//const colname = "yield_"+selectGeoDataType.labelTip+"_avg";</span></span>
<span id="cb16-756"><a href="#cb16-756" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> values <span class="op">=</span> yield_in_selected_geo<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> d[mapDataColumn])<span class="op">;</span></span>
<span id="cb16-757"><a href="#cb16-757" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> obj <span class="op">=</span> {}</span>
<span id="cb16-758"><a href="#cb16-758" aria-hidden="true" tabindex="-1"></a>    obj[colname] <span class="op">=</span> <span class="fu">average</span>(values)</span>
<span id="cb16-759"><a href="#cb16-759" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [obj]</span>
<span id="cb16-760"><a href="#cb16-760" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-761"><a href="#cb16-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-762"><a href="#cb16-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-763"><a href="#cb16-763" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Title</span></span>
<span id="cb16-764"><a href="#cb16-764" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> geogs <span class="op">=</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">values</span>(adminSelections)<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d <span class="op">!==</span> <span class="kw">null</span>)</span>
<span id="cb16-765"><a href="#cb16-765" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (geogs<span class="op">.</span><span class="at">length</span> <span class="op">==</span> <span class="dv">0</span>){ </span>
<span id="cb16-766"><a href="#cb16-766" aria-hidden="true" tabindex="-1"></a>    <span class="co">// geogs = _lang(nbText.general.country_article2.SSA);  </span></span>
<span id="cb16-767"><a href="#cb16-767" aria-hidden="true" tabindex="-1"></a>    geogs <span class="op">=</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">adminNames</span><span class="op">.</span><span class="at">SSA</span>)<span class="op">;</span>  </span>
<span id="cb16-768"><a href="#cb16-768" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb16-769"><a href="#cb16-769" aria-hidden="true" tabindex="-1"></a>    geogs <span class="op">=</span> geogs<span class="op">.</span><span class="fu">map</span>(val <span class="kw">=&gt;</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">adminNames</span>[val]) <span class="op">||</span> val)<span class="op">.</span><span class="fu">join</span>(<span class="st">", "</span>)</span>
<span id="cb16-770"><a href="#cb16-770" aria-hidden="true" tabindex="-1"></a>    <span class="co">// geogs = geogs.map(val =&gt; _lang(nbText.general.country_article2[val]) || val).join(", ")</span></span>
<span id="cb16-771"><a href="#cb16-771" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-772"><a href="#cb16-772" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> yield_in_selected_geo <span class="op">=</span> dataYield<span class="op">.</span><span class="fu">filter</span>(filterYieldDataByAdmins)<span class="op">;</span></span>
<span id="cb16-773"><a href="#cb16-773" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (selectAdmin0 <span class="op">==</span> <span class="kw">null</span>){</span>
<span id="cb16-774"><a href="#cb16-774" aria-hidden="true" tabindex="-1"></a>    yield_in_selected_geo <span class="op">=</span> <span class="fu">average_first_insight_for_all_subsaharan_africa</span>(yield_in_selected_geo) </span>
<span id="cb16-775"><a href="#cb16-775" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-776"><a href="#cb16-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-777"><a href="#cb16-777" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> title_template <span class="op">=</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">zoomToStable</span><span class="op">.</span><span class="at">MapInsight</span><span class="op">.</span><span class="at">title</span>)</span>
<span id="cb16-778"><a href="#cb16-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-779"><a href="#cb16-779" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> title_values <span class="op">=</span> [</span>
<span id="cb16-780"><a href="#cb16-780" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">name</span><span class="op">:</span><span class="st">"geography"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> geogs}<span class="op">,</span></span>
<span id="cb16-781"><a href="#cb16-781" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">name</span><span class="op">:</span><span class="st">"scenario_selection"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> selected_scenario<span class="op">.</span><span class="at">label</span><span class="op">.</span><span class="fu">toLowerCase</span>()}<span class="op">,</span></span>
<span id="cb16-782"><a href="#cb16-782" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">name</span><span class="op">:</span><span class="st">"crop_selection"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">crops</span>[crop_selector_dynamic_insights<span class="op">.</span><span class="fu">toLowerCase</span>()])}</span>
<span id="cb16-783"><a href="#cb16-783" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb16-784"><a href="#cb16-784" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-785"><a href="#cb16-785" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> title <span class="op">=</span> Lang<span class="op">.</span><span class="fu">reduceReplaceTemplateItems</span>(title_template<span class="op">,</span> title_values)</span>
<span id="cb16-786"><a href="#cb16-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-787"><a href="#cb16-787" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Globals</span></span>
<span id="cb16-788"><a href="#cb16-788" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> _outputName <span class="op">=</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">zoomToStable</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">YieldOutput</span><span class="op">.</span><span class="at">values</span>[selected_yield_output<span class="op">.</span><span class="at">label</span>])<span class="op">.</span><span class="fu">toLowerCase</span>()</span>
<span id="cb16-789"><a href="#cb16-789" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> _outputUnit <span class="op">=</span> _outputName<span class="op">.</span><span class="fu">match</span>(<span class="ss">/</span><span class="sc">\(([^)]+)\)</span><span class="ss">/g</span>)<span class="op">;</span></span>
<span id="cb16-790"><a href="#cb16-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-791"><a href="#cb16-791" aria-hidden="true" tabindex="-1"></a>  <span class="co">//Insight 1</span></span>
<span id="cb16-792"><a href="#cb16-792" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> insight1 <span class="op">=</span> <span class="st">""</span></span>
<span id="cb16-793"><a href="#cb16-793" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Rainfed yield</span></span>
<span id="cb16-794"><a href="#cb16-794" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (yield_in_selected_geo <span class="op">!==</span> <span class="kw">null</span> <span class="op">&amp;&amp;</span> yield_in_selected_geo<span class="op">.</span><span class="at">length</span> <span class="op">==</span> <span class="dv">1</span>){</span>
<span id="cb16-795"><a href="#cb16-795" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> yield_in_selected_geo_obj <span class="op">=</span> yield_in_selected_geo[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb16-796"><a href="#cb16-796" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (yield_in_selected_geo_obj[mapDataColumn] <span class="op">!=</span> <span class="kw">null</span>){</span>
<span id="cb16-797"><a href="#cb16-797" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> rounded <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">round</span>(yield_in_selected_geo_obj[mapDataColumn] <span class="op">*</span> <span class="dv">100</span>) <span class="op">/</span> <span class="dv">100</span><span class="op">;</span></span>
<span id="cb16-798"><a href="#cb16-798" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb16-799"><a href="#cb16-799" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> insight1_template <span class="op">=</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">zoomToStable</span><span class="op">.</span><span class="at">MapInsight</span><span class="op">.</span><span class="at">insight1</span>)</span>
<span id="cb16-800"><a href="#cb16-800" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb16-801"><a href="#cb16-801" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> insight1_values <span class="op">=</span> [</span>
<span id="cb16-802"><a href="#cb16-802" aria-hidden="true" tabindex="-1"></a>        {<span class="dt">name</span><span class="op">:</span><span class="st">"geography"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> geogs}<span class="op">,</span></span>
<span id="cb16-803"><a href="#cb16-803" aria-hidden="true" tabindex="-1"></a>        {<span class="dt">name</span><span class="op">:</span><span class="st">"scenario_selection"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> selected_scenario<span class="op">.</span><span class="at">label</span><span class="op">.</span><span class="fu">toLowerCase</span>()}<span class="op">,</span></span>
<span id="cb16-804"><a href="#cb16-804" aria-hidden="true" tabindex="-1"></a>        {<span class="dt">name</span><span class="op">:</span><span class="st">"crop_selection"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> crop_selector_dynamic_insights}<span class="op">,</span></span>
<span id="cb16-805"><a href="#cb16-805" aria-hidden="true" tabindex="-1"></a>        {<span class="dt">name</span><span class="op">:</span><span class="st">"yield_selection"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> _outputName}<span class="op">,</span></span>
<span id="cb16-806"><a href="#cb16-806" aria-hidden="true" tabindex="-1"></a>        {<span class="dt">name</span><span class="op">:</span><span class="st">"value"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> rounded}</span>
<span id="cb16-807"><a href="#cb16-807" aria-hidden="true" tabindex="-1"></a>      ]</span>
<span id="cb16-808"><a href="#cb16-808" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb16-809"><a href="#cb16-809" aria-hidden="true" tabindex="-1"></a>      insight1 <span class="op">=</span> <span class="vs">`* </span><span class="sc">${</span>Lang<span class="op">.</span><span class="fu">reduceReplaceTemplateItems</span>(insight1_template<span class="op">,</span> insight1_values)<span class="sc">}</span><span class="vs">`</span>  </span>
<span id="cb16-810"><a href="#cb16-810" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb16-811"><a href="#cb16-811" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-812"><a href="#cb16-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-813"><a href="#cb16-813" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Insight 2</span></span>
<span id="cb16-814"><a href="#cb16-814" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> insight2 <span class="op">=</span> <span class="st">""</span></span>
<span id="cb16-815"><a href="#cb16-815" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> pre_filtered <span class="op">=</span> <span class="cf">await</span> db<span class="op">.</span><span class="fu">query</span>(<span class="vs">`</span></span>
<span id="cb16-816"><a href="#cb16-816" aria-hidden="true" tabindex="-1"></a><span class="vs">  SELECT *</span></span>
<span id="cb16-817"><a href="#cb16-817" aria-hidden="true" tabindex="-1"></a><span class="vs">  FROM aggregated </span></span>
<span id="cb16-818"><a href="#cb16-818" aria-hidden="true" tabindex="-1"></a><span class="vs">  WHERE cycle = '</span><span class="sc">${</span>selected_cycle_options<span class="op">.</span><span class="at">cycle</span><span class="sc">}</span><span class="vs">'</span></span>
<span id="cb16-819"><a href="#cb16-819" aria-hidden="true" tabindex="-1"></a><span class="vs">  AND crop = '</span><span class="sc">${</span>crop_selector_dynamic_insights<span class="op">.</span><span class="fu">toLowerCase</span>()<span class="sc">}</span><span class="vs">'</span></span>
<span id="cb16-820"><a href="#cb16-820" aria-hidden="true" tabindex="-1"></a><span class="vs">  AND cultivar = '</span><span class="sc">${</span>selected_cultivar<span class="op">.</span><span class="at">value</span><span class="sc">}</span><span class="vs">'</span></span>
<span id="cb16-821"><a href="#cb16-821" aria-hidden="true" tabindex="-1"></a><span class="vs">`</span>)<span class="op">.</span><span class="fu">then</span>((r) <span class="kw">=&gt;</span> r<span class="op">.</span><span class="fu">toArray</span>())</span>
<span id="cb16-822"><a href="#cb16-822" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-823"><a href="#cb16-823" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (adminSelections<span class="op">.</span><span class="at">selectAdmin0</span> <span class="op">!=</span> <span class="kw">null</span>){</span>
<span id="cb16-824"><a href="#cb16-824" aria-hidden="true" tabindex="-1"></a>   pre_filtered <span class="op">=</span> pre_filtered<span class="op">.</span><span class="fu">filter</span>(filterYieldDataByAdmins)<span class="op">;</span></span>
<span id="cb16-825"><a href="#cb16-825" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-826"><a href="#cb16-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-827"><a href="#cb16-827" aria-hidden="true" tabindex="-1"></a>  <span class="co">// A climate change scenario ...</span></span>
<span id="cb16-828"><a href="#cb16-828" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (selected_scenario<span class="op">.</span><span class="at">label</span><span class="op">.</span><span class="fu">toLowerCase</span>() <span class="op">!=</span> <span class="st">"historical"</span>){</span>
<span id="cb16-829"><a href="#cb16-829" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> climate_change_scenarios<span class="op">;</span></span>
<span id="cb16-830"><a href="#cb16-830" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (adminSelections<span class="op">.</span><span class="at">selectAdmin0</span> <span class="op">==</span> <span class="kw">null</span>){</span>
<span id="cb16-831"><a href="#cb16-831" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> africa_pre_filtered <span class="op">=</span> pre_filtered<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">admin1_name</span> <span class="op">==</span> <span class="kw">null</span> <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">ssp</span> <span class="op">==</span> selected_scenario<span class="op">.</span><span class="at">ssp</span>)<span class="op">;</span></span>
<span id="cb16-832"><a href="#cb16-832" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> horizons <span class="op">=</span> [<span class="dv">2030</span><span class="op">,</span> <span class="dv">2050</span>]<span class="op">;</span></span>
<span id="cb16-833"><a href="#cb16-833" aria-hidden="true" tabindex="-1"></a>      climate_change_scenarios <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb16-834"><a href="#cb16-834" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> horizons<span class="op">.</span><span class="at">length</span><span class="op">;</span> i<span class="op">++</span>){</span>
<span id="cb16-835"><a href="#cb16-835" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> temp_h <span class="op">=</span> horizons[i]<span class="op">;</span></span>
<span id="cb16-836"><a href="#cb16-836" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> averaged_horizon <span class="op">=</span> <span class="fu">average_first_insight_for_all_subsaharan_africa</span>(</span>
<span id="cb16-837"><a href="#cb16-837" aria-hidden="true" tabindex="-1"></a>          africa_pre_filtered<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">horizon</span> <span class="op">==</span> temp_h)</span>
<span id="cb16-838"><a href="#cb16-838" aria-hidden="true" tabindex="-1"></a>        )<span class="op">;</span></span>
<span id="cb16-839"><a href="#cb16-839" aria-hidden="true" tabindex="-1"></a>        averaged_horizon[<span class="dv">0</span>][<span class="st">"horizon"</span>] <span class="op">=</span> temp_h<span class="op">;</span></span>
<span id="cb16-840"><a href="#cb16-840" aria-hidden="true" tabindex="-1"></a>        averaged_horizon[<span class="dv">0</span>][<span class="st">"ssp"</span>] <span class="op">=</span> selected_scenario<span class="op">.</span><span class="at">ssp</span><span class="op">;</span> </span>
<span id="cb16-841"><a href="#cb16-841" aria-hidden="true" tabindex="-1"></a>        climate_change_scenarios<span class="op">.</span><span class="fu">push</span>(<span class="op">...</span>averaged_horizon)</span>
<span id="cb16-842"><a href="#cb16-842" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb16-843"><a href="#cb16-843" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb16-844"><a href="#cb16-844" aria-hidden="true" tabindex="-1"></a>      climate_change_scenarios <span class="op">=</span> pre_filtered<span class="op">.</span><span class="fu">filter</span>((d) <span class="kw">=&gt;</span> (</span>
<span id="cb16-845"><a href="#cb16-845" aria-hidden="true" tabindex="-1"></a>        (d<span class="op">.</span><span class="at">ssp</span> <span class="op">==</span> selected_scenario<span class="op">.</span><span class="at">ssp</span>)</span>
<span id="cb16-846"><a href="#cb16-846" aria-hidden="true" tabindex="-1"></a>      ))<span class="op">;</span></span>
<span id="cb16-847"><a href="#cb16-847" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb16-848"><a href="#cb16-848" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> climate_change_scenarios<span class="op">.</span><span class="at">length</span><span class="op">;</span> i<span class="op">++</span>){</span>
<span id="cb16-849"><a href="#cb16-849" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> emissions <span class="op">=</span> climate_change_scenarios[i]<span class="op">.</span><span class="at">ssp</span> <span class="op">==</span> <span class="st">"SSP370"</span> <span class="op">?</span> <span class="st">"moderate "</span><span class="op">:</span> <span class="st">"high "</span><span class="op">;</span></span>
<span id="cb16-850"><a href="#cb16-850" aria-hidden="true" tabindex="-1"></a>      emissions <span class="op">+=</span> climate_change_scenarios[i]<span class="op">.</span><span class="at">ssp</span></span>
<span id="cb16-851"><a href="#cb16-851" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> impact <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">round</span>(climate_change_scenarios[i][mapDataColumn] <span class="op">*</span> <span class="dv">100</span>) <span class="op">/</span> <span class="dv">100</span><span class="op">;</span></span>
<span id="cb16-852"><a href="#cb16-852" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> horizon <span class="op">=</span> climate_change_scenarios[i]<span class="op">.</span><span class="at">horizon</span></span>
<span id="cb16-853"><a href="#cb16-853" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (horizon <span class="op">==</span> <span class="dv">2005</span>)</span>
<span id="cb16-854"><a href="#cb16-854" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb16-855"><a href="#cb16-855" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> change<span class="op">;</span></span>
<span id="cb16-856"><a href="#cb16-856" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (impact <span class="op">==</span> <span class="dv">0</span>)</span>
<span id="cb16-857"><a href="#cb16-857" aria-hidden="true" tabindex="-1"></a>        change <span class="op">=</span> <span class="st">"neutral"</span></span>
<span id="cb16-858"><a href="#cb16-858" aria-hidden="true" tabindex="-1"></a>      <span class="cf">else</span></span>
<span id="cb16-859"><a href="#cb16-859" aria-hidden="true" tabindex="-1"></a>        change <span class="op">=</span> impact <span class="op">&gt;</span> <span class="dv">0</span> <span class="op">?</span> <span class="st">"positive"</span> <span class="op">:</span> <span class="st">"negative"</span><span class="op">;</span></span>
<span id="cb16-860"><a href="#cb16-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-861"><a href="#cb16-861" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> insight2_template <span class="op">=</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">zoomToStable</span><span class="op">.</span><span class="at">MapInsight</span><span class="op">.</span><span class="at">insight2</span>)</span>
<span id="cb16-862"><a href="#cb16-862" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb16-863"><a href="#cb16-863" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> insight2_values <span class="op">=</span> [</span>
<span id="cb16-864"><a href="#cb16-864" aria-hidden="true" tabindex="-1"></a>        {<span class="dt">name</span><span class="op">:</span><span class="st">"emission_level"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> emissions}<span class="op">,</span></span>
<span id="cb16-865"><a href="#cb16-865" aria-hidden="true" tabindex="-1"></a>        {<span class="dt">name</span><span class="op">:</span><span class="st">"horizon"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> horizon}<span class="op">,</span></span>
<span id="cb16-866"><a href="#cb16-866" aria-hidden="true" tabindex="-1"></a>        {<span class="dt">name</span><span class="op">:</span><span class="st">"change_type"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span>[change])}<span class="op">,</span></span>
<span id="cb16-867"><a href="#cb16-867" aria-hidden="true" tabindex="-1"></a>        {<span class="dt">name</span><span class="op">:</span><span class="st">"impact_pct"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> impact}<span class="op">,</span></span>
<span id="cb16-868"><a href="#cb16-868" aria-hidden="true" tabindex="-1"></a>        {<span class="dt">name</span><span class="op">:</span><span class="st">"change_unit"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> _outputUnit}</span>
<span id="cb16-869"><a href="#cb16-869" aria-hidden="true" tabindex="-1"></a>      ]</span>
<span id="cb16-870"><a href="#cb16-870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-871"><a href="#cb16-871" aria-hidden="true" tabindex="-1"></a>      insight2 <span class="op">+=</span> <span class="vs">`* </span><span class="sc">${</span>Lang<span class="op">.</span><span class="fu">reduceReplaceTemplateItems</span>(insight2_template<span class="op">,</span> insight2_values)<span class="sc">}\n</span><span class="vs">`</span></span>
<span id="cb16-872"><a href="#cb16-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-873"><a href="#cb16-873" aria-hidden="true" tabindex="-1"></a>      <span class="co">// insights += `* A climate change scenario with ${emissions} emissions by **${horizon}** has a **${change}** impact on yield of ${impact}%. \n`</span></span>
<span id="cb16-874"><a href="#cb16-874" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb16-875"><a href="#cb16-875" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-876"><a href="#cb16-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-877"><a href="#cb16-877" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> insight3 <span class="op">=</span> <span class="st">""</span></span>
<span id="cb16-878"><a href="#cb16-878" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (selected_yield_output<span class="op">.</span><span class="at">label</span> <span class="op">==</span> <span class="st">"Yield change (%)"</span>){</span>
<span id="cb16-879"><a href="#cb16-879" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> values_col <span class="op">=</span> <span class="fu">get_yield_column</span>(<span class="st">"Yield change (%)"</span><span class="op">,</span> selectGeoDataType<span class="op">.</span><span class="at">labelTip</span>)<span class="op">;</span></span>
<span id="cb16-880"><a href="#cb16-880" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> change_values <span class="op">=</span> pre_filtered</span>
<span id="cb16-881"><a href="#cb16-881" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> ((d[values_col] <span class="op">!==</span> <span class="kw">null</span>)))</span>
<span id="cb16-882"><a href="#cb16-882" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> d[values_col])<span class="op">;</span></span>
<span id="cb16-883"><a href="#cb16-883" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> max_change <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">round</span>(<span class="fu">arrayMax</span>(change_values) <span class="op">*</span> <span class="dv">100</span>) <span class="op">/</span> <span class="dv">100</span><span class="op">;</span></span>
<span id="cb16-884"><a href="#cb16-884" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> min_change <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">round</span>(<span class="fu">arrayMin</span>(change_values) <span class="op">*</span> <span class="dv">100</span>) <span class="op">/</span> <span class="dv">100</span><span class="op">;</span></span>
<span id="cb16-885"><a href="#cb16-885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-886"><a href="#cb16-886" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> insight3_template <span class="op">=</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">zoomToStable</span><span class="op">.</span><span class="at">MapInsight</span><span class="op">.</span><span class="at">insight3</span>)</span>
<span id="cb16-887"><a href="#cb16-887" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-888"><a href="#cb16-888" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> insight3_values <span class="op">=</span> [</span>
<span id="cb16-889"><a href="#cb16-889" aria-hidden="true" tabindex="-1"></a>      {<span class="dt">name</span><span class="op">:</span><span class="st">"minChange"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> min_change}<span class="op">,</span></span>
<span id="cb16-890"><a href="#cb16-890" aria-hidden="true" tabindex="-1"></a>      {<span class="dt">name</span><span class="op">:</span><span class="st">"maxChange"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> max_change}<span class="op">,</span></span>
<span id="cb16-891"><a href="#cb16-891" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb16-892"><a href="#cb16-892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-893"><a href="#cb16-893" aria-hidden="true" tabindex="-1"></a>    insight3 <span class="op">=</span> <span class="vs">`* </span><span class="sc">${</span>Lang<span class="op">.</span><span class="fu">reduceReplaceTemplateItems</span>(insight3_template<span class="op">,</span> insight3_values)<span class="sc">}</span><span class="vs">`</span></span>
<span id="cb16-894"><a href="#cb16-894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-895"><a href="#cb16-895" aria-hidden="true" tabindex="-1"></a><span class="co">//     insights += `* The projected yield changes arise from simulating yield under various plausible futures, which implies uncertainty. Accordingly, the range of projected changes is **${min_change}%** to **${max_change}%** across the climate models used.</span></span>
<span id="cb16-896"><a href="#cb16-896" aria-hidden="true" tabindex="-1"></a><span class="co">// `</span></span>
<span id="cb16-897"><a href="#cb16-897" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-898"><a href="#cb16-898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-899"><a href="#cb16-899" aria-hidden="true" tabindex="-1"></a>  <span class="co">//insight 4</span></span>
<span id="cb16-900"><a href="#cb16-900" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> insight4 <span class="op">=</span> <span class="st">""</span></span>
<span id="cb16-901"><a href="#cb16-901" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (adminSelections<span class="op">.</span><span class="at">selectAdmin0</span> <span class="op">!=</span> <span class="kw">null</span>){</span>
<span id="cb16-902"><a href="#cb16-902" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Absolute yield changes</span></span>
<span id="cb16-903"><a href="#cb16-903" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> data_column <span class="op">=</span> <span class="fu">get_yield_column</span>(<span class="st">"Yield change (ton/ha)"</span><span class="op">,</span> selectGeoDataType<span class="op">.</span><span class="at">labelTip</span>)<span class="op">;</span></span>
<span id="cb16-904"><a href="#cb16-904" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> result <span class="op">=</span> <span class="cf">await</span> <span class="fu">quick_insight_map_admin_rank</span>(data_column)<span class="op">;</span></span>
<span id="cb16-905"><a href="#cb16-905" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-906"><a href="#cb16-906" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> insight4_template <span class="op">=</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">zoomToStable</span><span class="op">.</span><span class="at">MapInsight</span><span class="op">.</span><span class="at">insight4</span>)</span>
<span id="cb16-907"><a href="#cb16-907" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> insight4_values <span class="op">=</span> [</span>
<span id="cb16-908"><a href="#cb16-908" aria-hidden="true" tabindex="-1"></a>      {<span class="dt">name</span><span class="op">:</span><span class="st">"geography"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> result<span class="op">.</span><span class="at">selected_geo</span>}<span class="op">,</span></span>
<span id="cb16-909"><a href="#cb16-909" aria-hidden="true" tabindex="-1"></a>      {<span class="dt">name</span><span class="op">:</span><span class="st">"rank"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> result<span class="op">.</span><span class="at">ranking</span>}<span class="op">,</span></span>
<span id="cb16-910"><a href="#cb16-910" aria-hidden="true" tabindex="-1"></a>      {<span class="dt">name</span><span class="op">:</span><span class="st">"num"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> result<span class="op">.</span><span class="at">out_of</span>}<span class="op">,</span></span>
<span id="cb16-911"><a href="#cb16-911" aria-hidden="true" tabindex="-1"></a>      {<span class="dt">name</span><span class="op">:</span><span class="st">"adminLvl"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> result<span class="op">.</span><span class="at">admin_name</span>}<span class="op">,</span></span>
<span id="cb16-912"><a href="#cb16-912" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb16-913"><a href="#cb16-913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-914"><a href="#cb16-914" aria-hidden="true" tabindex="-1"></a>    insight4 <span class="op">=</span> <span class="vs">`* </span><span class="sc">${</span>Lang<span class="op">.</span><span class="fu">reduceReplaceTemplateItems</span>(insight4_template<span class="op">,</span> insight4_values)<span class="sc">}</span><span class="vs">`</span></span>
<span id="cb16-915"><a href="#cb16-915" aria-hidden="true" tabindex="-1"></a>    <span class="co">// insights += `* Across all of Sub-Saharan Africa, ${result.selected_geo} ranks ${result.ranking} out of ${result.out_of} ${result.admin_name} at the same level, with regard to absolute yield changes.\n`</span></span>
<span id="cb16-916"><a href="#cb16-916" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-917"><a href="#cb16-917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-918"><a href="#cb16-918" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-919"><a href="#cb16-919" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="fu">md</span><span class="vs">`</span></span>
<span id="cb16-920"><a href="#cb16-920" aria-hidden="true" tabindex="-1"></a><span class="vs">### </span><span class="sc">${</span>title<span class="sc">}</span></span>
<span id="cb16-921"><a href="#cb16-921" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span>insight1<span class="sc">}</span></span>
<span id="cb16-922"><a href="#cb16-922" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span>insight2<span class="sc">}</span></span>
<span id="cb16-923"><a href="#cb16-923" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span>insight3<span class="sc">}</span></span>
<span id="cb16-924"><a href="#cb16-924" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span>insight4<span class="sc">}</span><span class="vs">`</span></span>
<span id="cb16-925"><a href="#cb16-925" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-926"><a href="#cb16-926" aria-hidden="true" tabindex="-1"></a><span class="co">// ${insights}`</span></span>
<span id="cb16-927"><a href="#cb16-927" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-16" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb17" data-startfrom="931" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 930"><span id="cb17-931"><a href="#cb17-931" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`# </span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">adaptFutureChange</span><span class="op">.</span><span class="at">title</span>)<span class="sc">}</span></span>
<span id="cb17-932"><a href="#cb17-932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-933"><a href="#cb17-933" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">adaptFutureChange</span><span class="op">.</span><span class="at">text</span>)<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-17" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb18" data-startfrom="937" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 936"><span id="cb18-937"><a href="#cb18-937" aria-hidden="true" tabindex="-1"></a>atfc_form <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">form</span>([</span>
<span id="cb18-938"><a href="#cb18-938" aria-hidden="true" tabindex="-1"></a>    viewof atfc_crop_selector<span class="op">,</span></span>
<span id="cb18-939"><a href="#cb18-939" aria-hidden="true" tabindex="-1"></a>    viewof atfc_cycle_selector<span class="op">,</span></span>
<span id="cb18-940"><a href="#cb18-940" aria-hidden="true" tabindex="-1"></a>    viewof atfc_scenario_selector</span>
<span id="cb18-941"><a href="#cb18-941" aria-hidden="true" tabindex="-1"></a>]<span class="op">,</span> {<span class="dt">template</span><span class="op">:</span> <span class="fu">formTemplate</span>()})</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-18" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb19" data-startfrom="945" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 944"><span id="cb19-945"><a href="#cb19-945" aria-hidden="true" tabindex="-1"></a>geoImpactAdminSelectorsAFC <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">form</span>(</span>
<span id="cb19-946"><a href="#cb19-946" aria-hidden="true" tabindex="-1"></a>  [</span>
<span id="cb19-947"><a href="#cb19-947" aria-hidden="true" tabindex="-1"></a>    Inputs<span class="op">.</span><span class="fu">bind</span>(</span>
<span id="cb19-948"><a href="#cb19-948" aria-hidden="true" tabindex="-1"></a>      Inputs<span class="op">.</span><span class="fu">select</span>(dataAdmin0<span class="op">,</span> { <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">country</span>)<span class="op">,</span> <span class="dt">format</span><span class="op">:</span> x <span class="kw">=&gt;</span> x <span class="op">==</span> <span class="kw">null</span> <span class="op">?</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">adminNames</span>[<span class="st">'SSA'</span>])<span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">adminNames</span>[x])})<span class="op">,</span></span>
<span id="cb19-949"><a href="#cb19-949" aria-hidden="true" tabindex="-1"></a>      viewof selectAdmin0</span>
<span id="cb19-950"><a href="#cb19-950" aria-hidden="true" tabindex="-1"></a>    )<span class="op">,</span></span>
<span id="cb19-951"><a href="#cb19-951" aria-hidden="true" tabindex="-1"></a>    Inputs<span class="op">.</span><span class="fu">bind</span>(</span>
<span id="cb19-952"><a href="#cb19-952" aria-hidden="true" tabindex="-1"></a>      Inputs<span class="op">.</span><span class="fu">select</span>(dataAdmin1<span class="op">,</span> { <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">region</span>) })<span class="op">,</span></span>
<span id="cb19-953"><a href="#cb19-953" aria-hidden="true" tabindex="-1"></a>      viewof selectAdmin1</span>
<span id="cb19-954"><a href="#cb19-954" aria-hidden="true" tabindex="-1"></a>    )<span class="op">,</span></span>
<span id="cb19-955"><a href="#cb19-955" aria-hidden="true" tabindex="-1"></a>    Inputs<span class="op">.</span><span class="fu">bind</span>(</span>
<span id="cb19-956"><a href="#cb19-956" aria-hidden="true" tabindex="-1"></a>      Inputs<span class="op">.</span><span class="fu">select</span>(dataAdmin2<span class="op">,</span> { <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">subRegion</span>) })<span class="op">,</span></span>
<span id="cb19-957"><a href="#cb19-957" aria-hidden="true" tabindex="-1"></a>      viewof selectAdmin2</span>
<span id="cb19-958"><a href="#cb19-958" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb19-959"><a href="#cb19-959" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">,</span></span>
<span id="cb19-960"><a href="#cb19-960" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb19-961"><a href="#cb19-961" aria-hidden="true" tabindex="-1"></a>    <span class="dt">template</span><span class="op">:</span> <span class="fu">formTemplate</span>()</span>
<span id="cb19-962"><a href="#cb19-962" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb19-963"><a href="#cb19-963" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-19" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb20" data-startfrom="967" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 966"><span id="cb20-967"><a href="#cb20-967" aria-hidden="true" tabindex="-1"></a>viewof radioSortDotPlotCrop <span class="op">=</span> {</span>
<span id="cb20-968"><a href="#cb20-968" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> data <span class="op">=</span> [</span>
<span id="cb20-969"><a href="#cb20-969" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb20-970"><a href="#cb20-970" aria-hidden="true" tabindex="-1"></a>      <span class="dt">key</span><span class="op">:</span> <span class="st">"observations"</span><span class="op">,</span></span>
<span id="cb20-971"><a href="#cb20-971" aria-hidden="true" tabindex="-1"></a>      <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">adaptFutureChange</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">sort</span><span class="op">.</span><span class="at">values</span><span class="op">.</span><span class="at">noAdapt</span>)<span class="op">,</span></span>
<span id="cb20-972"><a href="#cb20-972" aria-hidden="true" tabindex="-1"></a>      <span class="dt">channel</span><span class="op">:</span> <span class="st">"nObs"</span><span class="op">,</span></span>
<span id="cb20-973"><a href="#cb20-973" aria-hidden="true" tabindex="-1"></a>      <span class="dt">reverse</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb20-974"><a href="#cb20-974" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb20-975"><a href="#cb20-975" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb20-976"><a href="#cb20-976" aria-hidden="true" tabindex="-1"></a>      <span class="dt">key</span><span class="op">:</span> <span class="st">"mean"</span><span class="op">,</span></span>
<span id="cb20-977"><a href="#cb20-977" aria-hidden="true" tabindex="-1"></a>      <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">adaptFutureChange</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">sort</span><span class="op">.</span><span class="at">values</span><span class="op">.</span><span class="at">meanDiff</span>)<span class="op">,</span></span>
<span id="cb20-978"><a href="#cb20-978" aria-hidden="true" tabindex="-1"></a>      <span class="dt">channel</span><span class="op">:</span> <span class="st">"x"</span><span class="op">,</span></span>
<span id="cb20-979"><a href="#cb20-979" aria-hidden="true" tabindex="-1"></a>      <span class="dt">reverse</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb20-980"><a href="#cb20-980" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb20-981"><a href="#cb20-981" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb20-982"><a href="#cb20-982" aria-hidden="true" tabindex="-1"></a>      <span class="dt">key</span><span class="op">:</span> <span class="st">"alpha"</span><span class="op">,</span></span>
<span id="cb20-983"><a href="#cb20-983" aria-hidden="true" tabindex="-1"></a>      <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">adaptFutureChange</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">sort</span><span class="op">.</span><span class="at">values</span><span class="op">.</span><span class="at">alphabet</span>)<span class="op">,</span></span>
<span id="cb20-984"><a href="#cb20-984" aria-hidden="true" tabindex="-1"></a>      <span class="dt">channel</span><span class="op">:</span> <span class="st">"y"</span><span class="op">,</span></span>
<span id="cb20-985"><a href="#cb20-985" aria-hidden="true" tabindex="-1"></a>      <span class="dt">reverse</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb20-986"><a href="#cb20-986" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb20-987"><a href="#cb20-987" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb20-988"><a href="#cb20-988" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> Inputs<span class="op">.</span><span class="fu">radio</span>(data<span class="op">,</span> { <span class="dt">label</span><span class="op">:</span> <span class="st">"Sort"</span><span class="op">,</span> <span class="dt">format</span><span class="op">:</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">label</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> data<span class="op">.</span><span class="fu">find</span>(x <span class="kw">=&gt;</span> x<span class="op">.</span><span class="at">key</span> <span class="op">===</span> <span class="st">'mean'</span>) })<span class="op">;</span></span>
<span id="cb20-989"><a href="#cb20-989" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-20" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb21" data-startfrom="993" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 992"><span id="cb21-993"><a href="#cb21-993" aria-hidden="true" tabindex="-1"></a>plotDotAEZ <span class="op">=</span> {</span>
<span id="cb21-994"><a href="#cb21-994" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> baseData <span class="op">=</span> dataYieldATFC<span class="op">;</span></span>
<span id="cb21-995"><a href="#cb21-995" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> plotData <span class="op">=</span> baseData<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> (</span>
<span id="cb21-996"><a href="#cb21-996" aria-hidden="true" tabindex="-1"></a>      (d<span class="op">.</span><span class="at">crop</span><span class="op">.</span><span class="fu">toLowerCase</span>()<span class="op">.</span><span class="fu">trim</span>() <span class="op">==</span> selected_crop_atfc<span class="op">.</span><span class="fu">toLowerCase</span>()<span class="op">.</span><span class="fu">trim</span>())</span>
<span id="cb21-997"><a href="#cb21-997" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb21-998"><a href="#cb21-998" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb21-999"><a href="#cb21-999" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> toHiglight <span class="op">=</span> <span class="fu">get_selected_admin_atfc</span>()<span class="op">;</span></span>
<span id="cb21-1000"><a href="#cb21-1000" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (selectAdmin0 <span class="op">==</span> <span class="kw">null</span>){</span>
<span id="cb21-1001"><a href="#cb21-1001" aria-hidden="true" tabindex="-1"></a>    toHiglight <span class="op">=</span> {</span>
<span id="cb21-1002"><a href="#cb21-1002" aria-hidden="true" tabindex="-1"></a>      <span class="dt">admin</span><span class="op">:</span> <span class="st">"admin0_name"</span><span class="op">,</span></span>
<span id="cb21-1003"><a href="#cb21-1003" aria-hidden="true" tabindex="-1"></a>      <span class="dt">highlight</span><span class="op">:</span> <span class="st">""</span></span>
<span id="cb21-1004"><a href="#cb21-1004" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb21-1005"><a href="#cb21-1005" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb21-1006"><a href="#cb21-1006" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> aezColor <span class="op">=</span> {</span>
<span id="cb21-1007"><a href="#cb21-1007" aria-hidden="true" tabindex="-1"></a>    <span class="dt">domain</span><span class="op">:</span> [</span>
<span id="cb21-1008"><a href="#cb21-1008" aria-hidden="true" tabindex="-1"></a>      <span class="st">"historical"</span><span class="op">,</span></span>
<span id="cb21-1009"><a href="#cb21-1009" aria-hidden="true" tabindex="-1"></a>      <span class="st">"2030"</span><span class="op">,</span></span>
<span id="cb21-1010"><a href="#cb21-1010" aria-hidden="true" tabindex="-1"></a>      <span class="st">"2050"</span><span class="op">,</span></span>
<span id="cb21-1011"><a href="#cb21-1011" aria-hidden="true" tabindex="-1"></a>    ]<span class="op">,</span></span>
<span id="cb21-1012"><a href="#cb21-1012" aria-hidden="true" tabindex="-1"></a>    <span class="dt">range</span><span class="op">:</span> [</span>
<span id="cb21-1013"><a href="#cb21-1013" aria-hidden="true" tabindex="-1"></a>      <span class="st">"#74B95A"</span><span class="op">,</span></span>
<span id="cb21-1014"><a href="#cb21-1014" aria-hidden="true" tabindex="-1"></a>      <span class="st">"#F3D6B0"</span><span class="op">,</span></span>
<span id="cb21-1015"><a href="#cb21-1015" aria-hidden="true" tabindex="-1"></a>      <span class="st">"#B02B19"</span><span class="op">,</span></span>
<span id="cb21-1016"><a href="#cb21-1016" aria-hidden="true" tabindex="-1"></a>    ]<span class="op">,</span></span>
<span id="cb21-1017"><a href="#cb21-1017" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb21-1018"><a href="#cb21-1018" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> aezData <span class="op">=</span> T<span class="op">.</span><span class="fu">tidy</span>(</span>
<span id="cb21-1019"><a href="#cb21-1019" aria-hidden="true" tabindex="-1"></a>    plotData<span class="op">,</span></span>
<span id="cb21-1020"><a href="#cb21-1020" aria-hidden="true" tabindex="-1"></a>    T<span class="op">.</span><span class="fu">filter</span>((d) <span class="kw">=&gt;</span> {</span>
<span id="cb21-1021"><a href="#cb21-1021" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (toHiglight<span class="op">.</span><span class="at">highlight</span> <span class="op">==</span> <span class="kw">null</span>) <span class="cf">return</span> d<span class="op">;</span></span>
<span id="cb21-1022"><a href="#cb21-1022" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> d[toHiglight<span class="op">.</span><span class="at">admin</span>] <span class="op">==</span> toHiglight<span class="op">.</span><span class="at">highlight</span><span class="op">;</span></span>
<span id="cb21-1023"><a href="#cb21-1023" aria-hidden="true" tabindex="-1"></a>    })<span class="op">,</span></span>
<span id="cb21-1024"><a href="#cb21-1024" aria-hidden="true" tabindex="-1"></a>    T<span class="op">.</span><span class="fu">arrange</span>(<span class="st">"mean_difference"</span>)</span>
<span id="cb21-1025"><a href="#cb21-1025" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb21-1026"><a href="#cb21-1026" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-1027"><a href="#cb21-1027" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> colorDomain <span class="op">=</span> aezColor<span class="op">.</span><span class="at">domain</span><span class="op">;</span></span>
<span id="cb21-1028"><a href="#cb21-1028" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> colorRange <span class="op">=</span> aezColor<span class="op">.</span><span class="at">range</span><span class="op">;</span></span>
<span id="cb21-1029"><a href="#cb21-1029" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> marginBottom <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb21-1030"><a href="#cb21-1030" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> marginTop <span class="op">=</span> <span class="dv">50</span><span class="op">;</span></span>
<span id="cb21-1031"><a href="#cb21-1031" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> yHeight <span class="op">=</span> <span class="dv">35</span><span class="op">;</span></span>
<span id="cb21-1032"><a href="#cb21-1032" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> height <span class="op">=</span></span>
<span id="cb21-1033"><a href="#cb21-1033" aria-hidden="true" tabindex="-1"></a>    marginTop <span class="op">+</span></span>
<span id="cb21-1034"><a href="#cb21-1034" aria-hidden="true" tabindex="-1"></a>    marginBottom <span class="op">+</span></span>
<span id="cb21-1035"><a href="#cb21-1035" aria-hidden="true" tabindex="-1"></a>    d3<span class="op">.</span><span class="fu">group</span>(plotData<span class="op">,</span> (d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">adaptation</span>)<span class="op">.</span><span class="at">size</span> <span class="op">*</span> yHeight<span class="op">;</span></span>
<span id="cb21-1036"><a href="#cb21-1036" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> _formatNum <span class="op">=</span> formatNum<span class="op">;</span></span>
<span id="cb21-1037"><a href="#cb21-1037" aria-hidden="true" tabindex="-1"></a>  <span class="co">// const _toggleCIs = toggleCIsCrop[0]; // Remove as CI are too small to see on plot</span></span>
<span id="cb21-1038"><a href="#cb21-1038" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> _radioSort <span class="op">=</span> radioSortDotPlotCrop<span class="op">;</span></span>
<span id="cb21-1039"><a href="#cb21-1039" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-1040"><a href="#cb21-1040" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb21-1041"><a href="#cb21-1041" aria-hidden="true" tabindex="-1"></a>    height<span class="op">,</span></span>
<span id="cb21-1042"><a href="#cb21-1042" aria-hidden="true" tabindex="-1"></a>    marginBottom<span class="op">,</span></span>
<span id="cb21-1043"><a href="#cb21-1043" aria-hidden="true" tabindex="-1"></a>    marginTop<span class="op">,</span></span>
<span id="cb21-1044"><a href="#cb21-1044" aria-hidden="true" tabindex="-1"></a>    <span class="dt">marginLeft</span><span class="op">:</span> <span class="dv">160</span><span class="op">,</span></span>
<span id="cb21-1045"><a href="#cb21-1045" aria-hidden="true" tabindex="-1"></a>    <span class="dt">marginRight</span><span class="op">:</span> <span class="dv">50</span><span class="op">,</span></span>
<span id="cb21-1046"><a href="#cb21-1046" aria-hidden="true" tabindex="-1"></a>    <span class="dt">width</span><span class="op">:</span> <span class="dv">1000</span><span class="op">,</span></span>
<span id="cb21-1047"><a href="#cb21-1047" aria-hidden="true" tabindex="-1"></a>    <span class="dt">x</span><span class="op">:</span> {</span>
<span id="cb21-1048"><a href="#cb21-1048" aria-hidden="true" tabindex="-1"></a>      <span class="dt">axis</span><span class="op">:</span> <span class="st">"top"</span><span class="op">,</span></span>
<span id="cb21-1049"><a href="#cb21-1049" aria-hidden="true" tabindex="-1"></a>      <span class="dt">nice</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb21-1050"><a href="#cb21-1050" aria-hidden="true" tabindex="-1"></a>      <span class="dt">grid</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb21-1051"><a href="#cb21-1051" aria-hidden="true" tabindex="-1"></a>      <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">adaptFutureChange</span><span class="op">.</span><span class="at">plot</span><span class="op">.</span><span class="at">xAxis</span><span class="op">.</span><span class="at">title</span>)<span class="op">,</span></span>
<span id="cb21-1052"><a href="#cb21-1052" aria-hidden="true" tabindex="-1"></a>      <span class="dt">labelAnchor</span><span class="op">:</span> <span class="st">"center"</span><span class="op">,</span></span>
<span id="cb21-1053"><a href="#cb21-1053" aria-hidden="true" tabindex="-1"></a>      <span class="dt">labelOffset</span><span class="op">:</span> <span class="dv">40</span><span class="op">,</span></span>
<span id="cb21-1054"><a href="#cb21-1054" aria-hidden="true" tabindex="-1"></a>      <span class="dt">labelArrow</span><span class="op">:</span> <span class="st">"none"</span></span>
<span id="cb21-1055"><a href="#cb21-1055" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb21-1056"><a href="#cb21-1056" aria-hidden="true" tabindex="-1"></a>    <span class="dt">y</span><span class="op">:</span> {</span>
<span id="cb21-1057"><a href="#cb21-1057" aria-hidden="true" tabindex="-1"></a>      <span class="dt">tickSize</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb21-1058"><a href="#cb21-1058" aria-hidden="true" tabindex="-1"></a>      <span class="dt">label</span><span class="op">:</span> <span class="kw">null</span></span>
<span id="cb21-1059"><a href="#cb21-1059" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb21-1060"><a href="#cb21-1060" aria-hidden="true" tabindex="-1"></a>    <span class="dt">color</span><span class="op">:</span> {</span>
<span id="cb21-1061"><a href="#cb21-1061" aria-hidden="true" tabindex="-1"></a>      <span class="dt">domain</span><span class="op">:</span> colorDomain<span class="op">,</span></span>
<span id="cb21-1062"><a href="#cb21-1062" aria-hidden="true" tabindex="-1"></a>      <span class="dt">range</span><span class="op">:</span> colorRange<span class="op">,</span></span>
<span id="cb21-1063"><a href="#cb21-1063" aria-hidden="true" tabindex="-1"></a>      <span class="dt">tickFormat</span><span class="op">:</span> l <span class="kw">=&gt;</span> l <span class="op">===</span> <span class="st">"historical"</span><span class="op">?</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">historical</span>) <span class="op">:</span> l<span class="op">,</span></span>
<span id="cb21-1064"><a href="#cb21-1064" aria-hidden="true" tabindex="-1"></a>      <span class="dt">legend</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb21-1065"><a href="#cb21-1065" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb21-1066"><a href="#cb21-1066" aria-hidden="true" tabindex="-1"></a>    <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb21-1067"><a href="#cb21-1067" aria-hidden="true" tabindex="-1"></a>      <span class="co">// main y-axis</span></span>
<span id="cb21-1068"><a href="#cb21-1068" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">axisY</span>({</span>
<span id="cb21-1069"><a href="#cb21-1069" aria-hidden="true" tabindex="-1"></a>        <span class="dt">tickSize</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb21-1070"><a href="#cb21-1070" aria-hidden="true" tabindex="-1"></a>        <span class="dt">tickFormat</span><span class="op">:</span> d <span class="kw">=&gt;</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">adaptFutureChange</span><span class="op">.</span><span class="at">plot</span><span class="op">.</span><span class="at">yAxis</span>[d])</span>
<span id="cb21-1071"><a href="#cb21-1071" aria-hidden="true" tabindex="-1"></a>      })<span class="op">,</span></span>
<span id="cb21-1072"><a href="#cb21-1072" aria-hidden="true" tabindex="-1"></a>      <span class="co">// pointer white-out</span></span>
<span id="cb21-1073"><a href="#cb21-1073" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">axisY</span>(</span>
<span id="cb21-1074"><a href="#cb21-1074" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">pointerY</span>({</span>
<span id="cb21-1075"><a href="#cb21-1075" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fill</span><span class="op">:</span> <span class="st">"white"</span><span class="op">,</span></span>
<span id="cb21-1076"><a href="#cb21-1076" aria-hidden="true" tabindex="-1"></a>          <span class="dt">textStroke</span><span class="op">:</span> <span class="st">"white"</span><span class="op">,</span></span>
<span id="cb21-1077"><a href="#cb21-1077" aria-hidden="true" tabindex="-1"></a>          <span class="dt">textStrokeWidth</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb21-1078"><a href="#cb21-1078" aria-hidden="true" tabindex="-1"></a>          <span class="dt">tickSize</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb21-1079"><a href="#cb21-1079" aria-hidden="true" tabindex="-1"></a>          <span class="dt">tickFormat</span><span class="op">:</span> d <span class="kw">=&gt;</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">adaptFutureChange</span><span class="op">.</span><span class="at">plot</span><span class="op">.</span><span class="at">yAxis</span>[d])</span>
<span id="cb21-1080"><a href="#cb21-1080" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb21-1081"><a href="#cb21-1081" aria-hidden="true" tabindex="-1"></a>      )<span class="op">,</span></span>
<span id="cb21-1082"><a href="#cb21-1082" aria-hidden="true" tabindex="-1"></a>      <span class="co">// bold pointer</span></span>
<span id="cb21-1083"><a href="#cb21-1083" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">axisY</span>(</span>
<span id="cb21-1084"><a href="#cb21-1084" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">pointerY</span>({</span>
<span id="cb21-1085"><a href="#cb21-1085" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fontWeight</span><span class="op">:</span> <span class="st">"bold"</span><span class="op">,</span></span>
<span id="cb21-1086"><a href="#cb21-1086" aria-hidden="true" tabindex="-1"></a>          <span class="dt">tickSize</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb21-1087"><a href="#cb21-1087" aria-hidden="true" tabindex="-1"></a>          <span class="dt">tickFormat</span><span class="op">:</span> d <span class="kw">=&gt;</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">adaptFutureChange</span><span class="op">.</span><span class="at">plot</span><span class="op">.</span><span class="at">yAxis</span>[d])</span>
<span id="cb21-1088"><a href="#cb21-1088" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb21-1089"><a href="#cb21-1089" aria-hidden="true" tabindex="-1"></a>      )<span class="op">,</span></span>
<span id="cb21-1090"><a href="#cb21-1090" aria-hidden="true" tabindex="-1"></a>      <span class="co">// zero point</span></span>
<span id="cb21-1091"><a href="#cb21-1091" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">ruleX</span>([<span class="dv">0</span>]<span class="op">,</span> { <span class="dt">stroke</span><span class="op">:</span> <span class="st">"#333"</span><span class="op">,</span> <span class="dt">strokeDasharray</span><span class="op">:</span> [<span class="dv">4</span>] })<span class="op">,</span></span>
<span id="cb21-1092"><a href="#cb21-1092" aria-hidden="true" tabindex="-1"></a>      <span class="co">// base dots</span></span>
<span id="cb21-1093"><a href="#cb21-1093" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">dot</span>(plotData<span class="op">,</span> {</span>
<span id="cb21-1094"><a href="#cb21-1094" aria-hidden="true" tabindex="-1"></a>        <span class="dt">x</span><span class="op">:</span> <span class="st">"mean_difference"</span><span class="op">,</span></span>
<span id="cb21-1095"><a href="#cb21-1095" aria-hidden="true" tabindex="-1"></a>        <span class="dt">y</span><span class="op">:</span> <span class="st">"adaptation"</span><span class="op">,</span></span>
<span id="cb21-1096"><a href="#cb21-1096" aria-hidden="true" tabindex="-1"></a>        <span class="dt">sort</span><span class="op">:</span> { <span class="dt">y</span><span class="op">:</span> _radioSort<span class="op">.</span><span class="at">channel</span><span class="op">,</span> <span class="dt">reverse</span><span class="op">:</span> _radioSort<span class="op">.</span><span class="at">reverse</span> }<span class="op">,</span></span>
<span id="cb21-1097"><a href="#cb21-1097" aria-hidden="true" tabindex="-1"></a>        <span class="dt">r</span><span class="op">:</span> <span class="dv">8</span><span class="op">,</span></span>
<span id="cb21-1098"><a href="#cb21-1098" aria-hidden="true" tabindex="-1"></a>        <span class="dt">stroke</span><span class="op">:</span> <span class="st">"#fff"</span><span class="op">,</span></span>
<span id="cb21-1099"><a href="#cb21-1099" aria-hidden="true" tabindex="-1"></a>        <span class="dt">strokeWidth</span><span class="op">:</span> <span class="fl">0.7</span><span class="op">,</span></span>
<span id="cb21-1100"><a href="#cb21-1100" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fill</span><span class="op">:</span> <span class="st">"#efefef"</span><span class="op">,</span></span>
<span id="cb21-1101"><a href="#cb21-1101" aria-hidden="true" tabindex="-1"></a>        <span class="dt">channels</span><span class="op">:</span> {</span>
<span id="cb21-1102"><a href="#cb21-1102" aria-hidden="true" tabindex="-1"></a>          <span class="dt">nObs</span><span class="op">:</span> {</span>
<span id="cb21-1103"><a href="#cb21-1103" aria-hidden="true" tabindex="-1"></a>            <span class="dt">label</span><span class="op">:</span> <span class="st">"# Observations"</span><span class="op">,</span></span>
<span id="cb21-1104"><a href="#cb21-1104" aria-hidden="true" tabindex="-1"></a>            <span class="dt">value</span><span class="op">:</span> <span class="st">"N_Obs"</span></span>
<span id="cb21-1105"><a href="#cb21-1105" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb21-1106"><a href="#cb21-1106" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb21-1107"><a href="#cb21-1107" aria-hidden="true" tabindex="-1"></a>      })<span class="op">,</span></span>
<span id="cb21-1108"><a href="#cb21-1108" aria-hidden="true" tabindex="-1"></a>      <span class="co">// selection: span lines: CI - Removed as the CI are so small they do not apperar</span></span>
<span id="cb21-1109"><a href="#cb21-1109" aria-hidden="true" tabindex="-1"></a>      <span class="co">// Plot.ruleY(_toggleCIs == "Visible" ? aezData : [], {</span></span>
<span id="cb21-1110"><a href="#cb21-1110" aria-hidden="true" tabindex="-1"></a>      <span class="co">//   y: "adaptation",</span></span>
<span id="cb21-1111"><a href="#cb21-1111" aria-hidden="true" tabindex="-1"></a>      <span class="co">//   x1: (d) =&gt; (d.ci_upper == null ? null : d.ci_upper),</span></span>
<span id="cb21-1112"><a href="#cb21-1112" aria-hidden="true" tabindex="-1"></a>      <span class="co">//   x2: (d) =&gt; (d.ci_lower  == null ? null : d.ci_lower),</span></span>
<span id="cb21-1113"><a href="#cb21-1113" aria-hidden="true" tabindex="-1"></a>      <span class="co">//   stroke: "#333"</span></span>
<span id="cb21-1114"><a href="#cb21-1114" aria-hidden="true" tabindex="-1"></a>      <span class="co">// }),</span></span>
<span id="cb21-1115"><a href="#cb21-1115" aria-hidden="true" tabindex="-1"></a>      <span class="co">// selection: mean diff dots</span></span>
<span id="cb21-1116"><a href="#cb21-1116" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">dot</span>(aezData<span class="op">,</span> {</span>
<span id="cb21-1117"><a href="#cb21-1117" aria-hidden="true" tabindex="-1"></a>        <span class="dt">x</span><span class="op">:</span> <span class="st">"mean_difference"</span><span class="op">,</span></span>
<span id="cb21-1118"><a href="#cb21-1118" aria-hidden="true" tabindex="-1"></a>        <span class="dt">y</span><span class="op">:</span> <span class="st">"adaptation"</span><span class="op">,</span></span>
<span id="cb21-1119"><a href="#cb21-1119" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fill</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> {</span>
<span id="cb21-1120"><a href="#cb21-1120" aria-hidden="true" tabindex="-1"></a>          <span class="cf">return</span> d<span class="op">.</span><span class="at">horizon</span><span class="op">;</span></span>
<span id="cb21-1121"><a href="#cb21-1121" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb21-1122"><a href="#cb21-1122" aria-hidden="true" tabindex="-1"></a>        <span class="dt">r</span><span class="op">:</span> <span class="dv">8</span><span class="op">,</span></span>
<span id="cb21-1123"><a href="#cb21-1123" aria-hidden="true" tabindex="-1"></a>        <span class="dt">stroke</span><span class="op">:</span> <span class="st">"#fff"</span><span class="op">,</span></span>
<span id="cb21-1124"><a href="#cb21-1124" aria-hidden="true" tabindex="-1"></a>        <span class="dt">strokeWidth</span><span class="op">:</span> <span class="fl">0.7</span><span class="op">,</span></span>
<span id="cb21-1125"><a href="#cb21-1125" aria-hidden="true" tabindex="-1"></a>        <span class="dt">channels</span><span class="op">:</span> {</span>
<span id="cb21-1126"><a href="#cb21-1126" aria-hidden="true" tabindex="-1"></a>          <span class="dt">aez</span><span class="op">:</span> {</span>
<span id="cb21-1127"><a href="#cb21-1127" aria-hidden="true" tabindex="-1"></a>            <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">adaptFutureChange</span><span class="op">.</span><span class="at">plot</span><span class="op">.</span><span class="at">channels</span><span class="op">.</span><span class="at">aez</span>)<span class="op">,</span></span>
<span id="cb21-1128"><a href="#cb21-1128" aria-hidden="true" tabindex="-1"></a>            <span class="dt">value</span><span class="op">:</span> <span class="st">"horizon"</span></span>
<span id="cb21-1129"><a href="#cb21-1129" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb21-1130"><a href="#cb21-1130" aria-hidden="true" tabindex="-1"></a>          <span class="co">// nObs: {</span></span>
<span id="cb21-1131"><a href="#cb21-1131" aria-hidden="true" tabindex="-1"></a>          <span class="co">//   label: _lang(nbText.adaptFutureChange.plot.channels.nObs),</span></span>
<span id="cb21-1132"><a href="#cb21-1132" aria-hidden="true" tabindex="-1"></a>          <span class="co">//   value: "N_Obs"</span></span>
<span id="cb21-1133"><a href="#cb21-1133" aria-hidden="true" tabindex="-1"></a>          <span class="co">// },</span></span>
<span id="cb21-1134"><a href="#cb21-1134" aria-hidden="true" tabindex="-1"></a>          <span class="dt">diff</span><span class="op">:</span> {</span>
<span id="cb21-1135"><a href="#cb21-1135" aria-hidden="true" tabindex="-1"></a>            <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">adaptFutureChange</span><span class="op">.</span><span class="at">plot</span><span class="op">.</span><span class="at">channels</span><span class="op">.</span><span class="at">diff</span>)<span class="op">,</span></span>
<span id="cb21-1136"><a href="#cb21-1136" aria-hidden="true" tabindex="-1"></a>            <span class="dt">value</span><span class="op">:</span> <span class="st">"mean_difference"</span></span>
<span id="cb21-1137"><a href="#cb21-1137" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb21-1138"><a href="#cb21-1138" aria-hidden="true" tabindex="-1"></a>          <span class="dt">control</span><span class="op">:</span> {</span>
<span id="cb21-1139"><a href="#cb21-1139" aria-hidden="true" tabindex="-1"></a>            <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">adaptFutureChange</span><span class="op">.</span><span class="at">plot</span><span class="op">.</span><span class="at">channels</span><span class="op">.</span><span class="at">control</span>)<span class="op">,</span></span>
<span id="cb21-1140"><a href="#cb21-1140" aria-hidden="true" tabindex="-1"></a>            <span class="dt">value</span><span class="op">:</span> <span class="st">"Mean_Control"</span></span>
<span id="cb21-1141"><a href="#cb21-1141" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb21-1142"><a href="#cb21-1142" aria-hidden="true" tabindex="-1"></a>          <span class="dt">prac</span><span class="op">:</span> {</span>
<span id="cb21-1143"><a href="#cb21-1143" aria-hidden="true" tabindex="-1"></a>            <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">adaptFutureChange</span><span class="op">.</span><span class="at">plot</span><span class="op">.</span><span class="at">channels</span><span class="op">.</span><span class="at">prac</span>)<span class="op">,</span></span>
<span id="cb21-1144"><a href="#cb21-1144" aria-hidden="true" tabindex="-1"></a>            <span class="dt">value</span><span class="op">:</span> <span class="st">"adaptation"</span></span>
<span id="cb21-1145"><a href="#cb21-1145" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb21-1146"><a href="#cb21-1146" aria-hidden="true" tabindex="-1"></a>          <span class="dt">crop</span><span class="op">:</span> {</span>
<span id="cb21-1147"><a href="#cb21-1147" aria-hidden="true" tabindex="-1"></a>            <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">crop</span>)<span class="op">,</span></span>
<span id="cb21-1148"><a href="#cb21-1148" aria-hidden="true" tabindex="-1"></a>            <span class="dt">value</span><span class="op">:</span> <span class="st">"Crop"</span></span>
<span id="cb21-1149"><a href="#cb21-1149" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb21-1150"><a href="#cb21-1150" aria-hidden="true" tabindex="-1"></a>          <span class="dt">ciLow</span><span class="op">:</span> {</span>
<span id="cb21-1151"><a href="#cb21-1151" aria-hidden="true" tabindex="-1"></a>            <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">adaptFutureChange</span><span class="op">.</span><span class="at">plot</span><span class="op">.</span><span class="at">channels</span><span class="op">.</span><span class="at">ciLow</span>)<span class="op">,</span></span>
<span id="cb21-1152"><a href="#cb21-1152" aria-hidden="true" tabindex="-1"></a>            <span class="dt">value</span><span class="op">:</span> <span class="st">"Lower"</span></span>
<span id="cb21-1153"><a href="#cb21-1153" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb21-1154"><a href="#cb21-1154" aria-hidden="true" tabindex="-1"></a>          <span class="dt">ciHigh</span><span class="op">:</span> {</span>
<span id="cb21-1155"><a href="#cb21-1155" aria-hidden="true" tabindex="-1"></a>            <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">adaptFutureChange</span><span class="op">.</span><span class="at">plot</span><span class="op">.</span><span class="at">channels</span><span class="op">.</span><span class="at">ciHigh</span>)<span class="op">,</span></span>
<span id="cb21-1156"><a href="#cb21-1156" aria-hidden="true" tabindex="-1"></a>            <span class="dt">value</span><span class="op">:</span> <span class="st">"Upper"</span></span>
<span id="cb21-1157"><a href="#cb21-1157" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb21-1158"><a href="#cb21-1158" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb21-1159"><a href="#cb21-1159" aria-hidden="true" tabindex="-1"></a>        <span class="dt">tip</span><span class="op">:</span> {</span>
<span id="cb21-1160"><a href="#cb21-1160" aria-hidden="true" tabindex="-1"></a>          <span class="dt">format</span><span class="op">:</span> {</span>
<span id="cb21-1161"><a href="#cb21-1161" aria-hidden="true" tabindex="-1"></a>            <span class="dt">x</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb21-1162"><a href="#cb21-1162" aria-hidden="true" tabindex="-1"></a>            <span class="dt">y</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb21-1163"><a href="#cb21-1163" aria-hidden="true" tabindex="-1"></a>            <span class="dt">fill</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb21-1164"><a href="#cb21-1164" aria-hidden="true" tabindex="-1"></a>            <span class="dt">prac</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb21-1165"><a href="#cb21-1165" aria-hidden="true" tabindex="-1"></a>            <span class="dt">crop</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb21-1166"><a href="#cb21-1166" aria-hidden="true" tabindex="-1"></a>            <span class="dt">aez</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> d <span class="op">===</span> <span class="st">"historical"</span><span class="op">?</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">historical</span>) <span class="op">:</span> d<span class="op">,</span></span>
<span id="cb21-1167"><a href="#cb21-1167" aria-hidden="true" tabindex="-1"></a>            <span class="dt">diff</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="fu">_formatNum</span>(d)<span class="op">,</span></span>
<span id="cb21-1168"><a href="#cb21-1168" aria-hidden="true" tabindex="-1"></a>            <span class="dt">control</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="fu">_formatNum</span>(d)<span class="op">,</span></span>
<span id="cb21-1169"><a href="#cb21-1169" aria-hidden="true" tabindex="-1"></a>            <span class="dt">ciLow</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="fu">_formatNum</span>(d)<span class="op">,</span></span>
<span id="cb21-1170"><a href="#cb21-1170" aria-hidden="true" tabindex="-1"></a>            <span class="dt">ciHigh</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> <span class="fu">_formatNum</span>(d)<span class="op">,</span></span>
<span id="cb21-1171"><a href="#cb21-1171" aria-hidden="true" tabindex="-1"></a>            <span class="dt">nObs</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb21-1172"><a href="#cb21-1172" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb21-1173"><a href="#cb21-1173" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb21-1174"><a href="#cb21-1174" aria-hidden="true" tabindex="-1"></a>      })<span class="op">,</span></span>
<span id="cb21-1175"><a href="#cb21-1175" aria-hidden="true" tabindex="-1"></a>      <span class="co">// dot highlight on hover</span></span>
<span id="cb21-1176"><a href="#cb21-1176" aria-hidden="true" tabindex="-1"></a>      Plot<span class="op">.</span><span class="fu">dot</span>(</span>
<span id="cb21-1177"><a href="#cb21-1177" aria-hidden="true" tabindex="-1"></a>        aezData<span class="op">,</span></span>
<span id="cb21-1178"><a href="#cb21-1178" aria-hidden="true" tabindex="-1"></a>        Plot<span class="op">.</span><span class="fu">pointer</span>({</span>
<span id="cb21-1179"><a href="#cb21-1179" aria-hidden="true" tabindex="-1"></a>          <span class="dt">x</span><span class="op">:</span> <span class="st">"mean_difference"</span><span class="op">,</span></span>
<span id="cb21-1180"><a href="#cb21-1180" aria-hidden="true" tabindex="-1"></a>          <span class="dt">y</span><span class="op">:</span> <span class="st">"adaptation"</span><span class="op">,</span></span>
<span id="cb21-1181"><a href="#cb21-1181" aria-hidden="true" tabindex="-1"></a>          <span class="dt">r</span><span class="op">:</span> <span class="dv">8</span><span class="op">,</span></span>
<span id="cb21-1182"><a href="#cb21-1182" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fill</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> {</span>
<span id="cb21-1183"><a href="#cb21-1183" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> d<span class="op">.</span><span class="at">horizon</span><span class="op">;</span></span>
<span id="cb21-1184"><a href="#cb21-1184" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb21-1185"><a href="#cb21-1185" aria-hidden="true" tabindex="-1"></a>          <span class="dt">stroke</span><span class="op">:</span> <span class="st">"#333"</span><span class="op">,</span></span>
<span id="cb21-1186"><a href="#cb21-1186" aria-hidden="true" tabindex="-1"></a>          <span class="dt">strokeWidth</span><span class="op">:</span> <span class="fl">0.7</span><span class="op">,</span></span>
<span id="cb21-1187"><a href="#cb21-1187" aria-hidden="true" tabindex="-1"></a>          <span class="dt">channels</span><span class="op">:</span> {</span>
<span id="cb21-1188"><a href="#cb21-1188" aria-hidden="true" tabindex="-1"></a>            <span class="dt">nObs</span><span class="op">:</span> {</span>
<span id="cb21-1189"><a href="#cb21-1189" aria-hidden="true" tabindex="-1"></a>              <span class="dt">label</span><span class="op">:</span> <span class="st">"# Observations"</span><span class="op">,</span></span>
<span id="cb21-1190"><a href="#cb21-1190" aria-hidden="true" tabindex="-1"></a>              <span class="dt">value</span><span class="op">:</span> <span class="st">"N_Obs"</span></span>
<span id="cb21-1191"><a href="#cb21-1191" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb21-1192"><a href="#cb21-1192" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb21-1193"><a href="#cb21-1193" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb21-1194"><a href="#cb21-1194" aria-hidden="true" tabindex="-1"></a>      )<span class="op">,</span></span>
<span id="cb21-1195"><a href="#cb21-1195" aria-hidden="true" tabindex="-1"></a>      <span class="co">// observation counts</span></span>
<span id="cb21-1196"><a href="#cb21-1196" aria-hidden="true" tabindex="-1"></a>      <span class="co">// Plot.textY(</span></span>
<span id="cb21-1197"><a href="#cb21-1197" aria-hidden="true" tabindex="-1"></a>      <span class="co">//   aezData,</span></span>
<span id="cb21-1198"><a href="#cb21-1198" aria-hidden="true" tabindex="-1"></a>      <span class="co">//   Plot.map(</span></span>
<span id="cb21-1199"><a href="#cb21-1199" aria-hidden="true" tabindex="-1"></a>      <span class="co">//     { text: (values) =&gt; values.map((d) =&gt; d + " obs.") },</span></span>
<span id="cb21-1200"><a href="#cb21-1200" aria-hidden="true" tabindex="-1"></a>      <span class="co">//     Plot.groupY(</span></span>
<span id="cb21-1201"><a href="#cb21-1201" aria-hidden="true" tabindex="-1"></a>      <span class="co">//       { text: "sum" },</span></span>
<span id="cb21-1202"><a href="#cb21-1202" aria-hidden="true" tabindex="-1"></a>      <span class="co">//       {</span></span>
<span id="cb21-1203"><a href="#cb21-1203" aria-hidden="true" tabindex="-1"></a>      <span class="co">//         y: "adaptation",</span></span>
<span id="cb21-1204"><a href="#cb21-1204" aria-hidden="true" tabindex="-1"></a>      <span class="co">//         text: "N_Obs",</span></span>
<span id="cb21-1205"><a href="#cb21-1205" aria-hidden="true" tabindex="-1"></a>      <span class="co">//         frameAnchor: "right",</span></span>
<span id="cb21-1206"><a href="#cb21-1206" aria-hidden="true" tabindex="-1"></a>      <span class="co">//         textAnchor: "start",</span></span>
<span id="cb21-1207"><a href="#cb21-1207" aria-hidden="true" tabindex="-1"></a>      <span class="co">//         dx: 16</span></span>
<span id="cb21-1208"><a href="#cb21-1208" aria-hidden="true" tabindex="-1"></a>      <span class="co">//       }</span></span>
<span id="cb21-1209"><a href="#cb21-1209" aria-hidden="true" tabindex="-1"></a>      <span class="co">//     )</span></span>
<span id="cb21-1210"><a href="#cb21-1210" aria-hidden="true" tabindex="-1"></a>      <span class="co">//   )</span></span>
<span id="cb21-1211"><a href="#cb21-1211" aria-hidden="true" tabindex="-1"></a>      <span class="co">// ),</span></span>
<span id="cb21-1212"><a href="#cb21-1212" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb21-1213"><a href="#cb21-1213" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb21-1214"><a href="#cb21-1214" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-21" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb22" data-startfrom="1218" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1217"><span id="cb22-1218"><a href="#cb22-1218" aria-hidden="true" tabindex="-1"></a>adaptation_insights <span class="op">=</span> {</span>
<span id="cb22-1219"><a href="#cb22-1219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1220"><a href="#cb22-1220" aria-hidden="true" tabindex="-1"></a>  <span class="co">//Title Processing</span></span>
<span id="cb22-1221"><a href="#cb22-1221" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> geogs <span class="op">=</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">values</span>(adminSelections)<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d <span class="op">!==</span> <span class="kw">null</span>)</span>
<span id="cb22-1222"><a href="#cb22-1222" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (geogs<span class="op">.</span><span class="at">length</span> <span class="op">==</span> <span class="dv">0</span>){ <span class="co">// renamed to avaoid future name issues if using geos-wasm</span></span>
<span id="cb22-1223"><a href="#cb22-1223" aria-hidden="true" tabindex="-1"></a>    <span class="co">// geogs = _lang(nbText.general.country_article2.SSA);  </span></span>
<span id="cb22-1224"><a href="#cb22-1224" aria-hidden="true" tabindex="-1"></a>    geogs <span class="op">=</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">adminNames</span><span class="op">.</span><span class="at">SSA</span>)<span class="op">;</span>  </span>
<span id="cb22-1225"><a href="#cb22-1225" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb22-1226"><a href="#cb22-1226" aria-hidden="true" tabindex="-1"></a>    <span class="co">// geogs = geogs.map(val =&gt; _lang(nbText.general.country_article2[val]) || val).join(", ")</span></span>
<span id="cb22-1227"><a href="#cb22-1227" aria-hidden="true" tabindex="-1"></a>    geogs <span class="op">=</span> geogs<span class="op">.</span><span class="fu">map</span>(val <span class="kw">=&gt;</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">adminNames</span>[val]) <span class="op">||</span> val)<span class="op">.</span><span class="fu">join</span>(<span class="st">", "</span>)</span>
<span id="cb22-1228"><a href="#cb22-1228" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb22-1229"><a href="#cb22-1229" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> title_template <span class="op">=</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">adaptFutureChange</span><span class="op">.</span><span class="at">insight</span><span class="op">.</span><span class="at">title</span>)</span>
<span id="cb22-1230"><a href="#cb22-1230" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> title_values <span class="op">=</span> [</span>
<span id="cb22-1231"><a href="#cb22-1231" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">name</span><span class="op">:</span><span class="st">"geography"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> geogs}<span class="op">,</span></span>
<span id="cb22-1232"><a href="#cb22-1232" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">name</span><span class="op">:</span><span class="st">"scenario_name"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> atfc_scenario_selector<span class="op">.</span><span class="fu">toLowerCase</span>()}<span class="op">,</span></span>
<span id="cb22-1233"><a href="#cb22-1233" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">name</span><span class="op">:</span><span class="st">"crop_name"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> selected_crop_atfc}</span>
<span id="cb22-1234"><a href="#cb22-1234" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb22-1235"><a href="#cb22-1235" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> title <span class="op">=</span> Lang<span class="op">.</span><span class="fu">reduceReplaceTemplateItems</span>(title_template<span class="op">,</span> title_values)</span>
<span id="cb22-1236"><a href="#cb22-1236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1237"><a href="#cb22-1237" aria-hidden="true" tabindex="-1"></a>  <span class="co">//Conditionals for insight 1 and 2</span></span>
<span id="cb22-1238"><a href="#cb22-1238" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> insight1 <span class="op">=</span> <span class="st">''</span></span>
<span id="cb22-1239"><a href="#cb22-1239" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> insight2 <span class="op">=</span> <span class="st">''</span></span>
<span id="cb22-1240"><a href="#cb22-1240" aria-hidden="true" tabindex="-1"></a>  <span class="co">//Insight 1 processing</span></span>
<span id="cb22-1241"><a href="#cb22-1241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1242"><a href="#cb22-1242" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> selected_geo <span class="op">=</span> <span class="fu">get_selected_admin_atfc</span>()<span class="op">;</span></span>
<span id="cb22-1243"><a href="#cb22-1243" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (selectAdmin0 <span class="op">==</span> <span class="kw">null</span>){</span>
<span id="cb22-1244"><a href="#cb22-1244" aria-hidden="true" tabindex="-1"></a>    selected_geo <span class="op">=</span> {</span>
<span id="cb22-1245"><a href="#cb22-1245" aria-hidden="true" tabindex="-1"></a>      <span class="dt">admin</span><span class="op">:</span> <span class="st">"admin0_name"</span><span class="op">,</span></span>
<span id="cb22-1246"><a href="#cb22-1246" aria-hidden="true" tabindex="-1"></a>      <span class="dt">highlight</span><span class="op">:</span> <span class="st">"SSA"</span></span>
<span id="cb22-1247"><a href="#cb22-1247" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb22-1248"><a href="#cb22-1248" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb22-1249"><a href="#cb22-1249" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (highlighted_data<span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="dv">0</span>){</span>
<span id="cb22-1250"><a href="#cb22-1250" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> better_than_no_adpt <span class="op">=</span> <span class="fu">get_adpt_options_higher_yield_than_no_adaptation</span>(highlighted_data)<span class="op">;</span></span>
<span id="cb22-1251"><a href="#cb22-1251" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> num_options_better_than_no_apt <span class="op">=</span> better_than_no_adpt<span class="op">.</span><span class="at">length</span><span class="op">;</span></span>
<span id="cb22-1252"><a href="#cb22-1252" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> lower_best <span class="op">=</span> <span class="fu">round</span>(<span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(<span class="op">...</span>better_than_no_adpt<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> d[<span class="st">"2050"</span>]))<span class="op">,</span> <span class="dv">2</span>)<span class="op">;</span></span>
<span id="cb22-1253"><a href="#cb22-1253" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> upper_best <span class="op">=</span> <span class="fu">round</span>(<span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(<span class="op">...</span>better_than_no_adpt<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> d[<span class="st">"historical"</span>]))<span class="op">,</span> <span class="dv">2</span>)<span class="op">;</span></span>
<span id="cb22-1254"><a href="#cb22-1254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1255"><a href="#cb22-1255" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> insight1_template <span class="op">=</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">adaptFutureChange</span><span class="op">.</span><span class="at">insight</span><span class="op">.</span><span class="at">insight1</span>)</span>
<span id="cb22-1256"><a href="#cb22-1256" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-1257"><a href="#cb22-1257" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> insight1_values <span class="op">=</span> [</span>
<span id="cb22-1258"><a href="#cb22-1258" aria-hidden="true" tabindex="-1"></a>      {<span class="dt">name</span><span class="op">:</span><span class="st">"selected_geo"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">countries_article</span>[selected_geo<span class="op">.</span><span class="at">highlight</span>])}<span class="op">,</span></span>
<span id="cb22-1259"><a href="#cb22-1259" aria-hidden="true" tabindex="-1"></a>      {<span class="dt">name</span><span class="op">:</span><span class="st">"numBetter"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> num_options_better_than_no_apt}<span class="op">,</span></span>
<span id="cb22-1260"><a href="#cb22-1260" aria-hidden="true" tabindex="-1"></a>      {<span class="dt">name</span><span class="op">:</span><span class="st">"lowerBest"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> lower_best}<span class="op">,</span></span>
<span id="cb22-1261"><a href="#cb22-1261" aria-hidden="true" tabindex="-1"></a>      {<span class="dt">name</span><span class="op">:</span><span class="st">"upperBest"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> upper_best}</span>
<span id="cb22-1262"><a href="#cb22-1262" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb22-1263"><a href="#cb22-1263" aria-hidden="true" tabindex="-1"></a>    insight1 <span class="op">=</span> <span class="vs">`* </span><span class="sc">${</span>Lang<span class="op">.</span><span class="fu">reduceReplaceTemplateItems</span>(insight1_template<span class="op">,</span> insight1_values)<span class="sc">}</span><span class="vs">`</span></span>
<span id="cb22-1264"><a href="#cb22-1264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1265"><a href="#cb22-1265" aria-hidden="true" tabindex="-1"></a>    <span class="co">//Insight 2 processing</span></span>
<span id="cb22-1266"><a href="#cb22-1266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1267"><a href="#cb22-1267" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Select top 3 or less</span></span>
<span id="cb22-1268"><a href="#cb22-1268" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> top <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(<span class="op">...</span>[<span class="dv">3</span><span class="op">,</span> better_than_no_adpt<span class="op">.</span><span class="at">length</span>])<span class="op">;</span></span>
<span id="cb22-1269"><a href="#cb22-1269" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> best_options <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb22-1270"><a href="#cb22-1270" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> max_improvement <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb22-1271"><a href="#cb22-1271" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(<span class="kw">let</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> top<span class="op">;</span> j <span class="op">++</span>){</span>
<span id="cb22-1272"><a href="#cb22-1272" aria-hidden="true" tabindex="-1"></a>      best_options<span class="op">.</span><span class="fu">push</span>(better_than_no_adpt[j]<span class="op">.</span><span class="at">option</span>)<span class="op">;</span></span>
<span id="cb22-1273"><a href="#cb22-1273" aria-hidden="true" tabindex="-1"></a>      max_improvement <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(better_than_no_adpt[j]<span class="op">.</span><span class="at">historical</span><span class="op">,</span> max_improvement)<span class="op">;</span></span>
<span id="cb22-1274"><a href="#cb22-1274" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb22-1275"><a href="#cb22-1275" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> insight2_template <span class="op">=</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">adaptFutureChange</span><span class="op">.</span><span class="at">insight</span><span class="op">.</span><span class="at">insight2</span>)</span>
<span id="cb22-1276"><a href="#cb22-1276" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> insight2_values <span class="op">=</span> [</span>
<span id="cb22-1277"><a href="#cb22-1277" aria-hidden="true" tabindex="-1"></a>      {<span class="dt">name</span><span class="op">:</span><span class="st">"bestOptions"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> best_options<span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">summary</span><span class="op">.</span><span class="at">adaptationOptions</span>[d]))<span class="op">.</span><span class="fu">join</span>(<span class="st">", "</span>)}<span class="op">,</span></span>
<span id="cb22-1278"><a href="#cb22-1278" aria-hidden="true" tabindex="-1"></a>      {<span class="dt">name</span><span class="op">:</span><span class="st">"maxImprovement"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="fu">round</span>(max_improvement<span class="op">,</span> <span class="dv">2</span>)}</span>
<span id="cb22-1279"><a href="#cb22-1279" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb22-1280"><a href="#cb22-1280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1281"><a href="#cb22-1281" aria-hidden="true" tabindex="-1"></a>    insight2 <span class="op">=</span> <span class="vs">`* </span><span class="sc">${</span>Lang<span class="op">.</span><span class="fu">reduceReplaceTemplateItems</span>(insight2_template<span class="op">,</span> insight2_values)<span class="sc">}</span><span class="vs">`</span></span>
<span id="cb22-1282"><a href="#cb22-1282" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb22-1283"><a href="#cb22-1283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1284"><a href="#cb22-1284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-1285"><a href="#cb22-1285" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> insight3 <span class="op">=</span> <span class="vs">`* </span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">adaptFutureChange</span><span class="op">.</span><span class="at">insight</span><span class="op">.</span><span class="at">insight3</span>)<span class="sc">}</span><span class="vs">`</span></span>
<span id="cb22-1286"><a href="#cb22-1286" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-1287"><a href="#cb22-1287" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="fu">md</span><span class="vs">`</span></span>
<span id="cb22-1288"><a href="#cb22-1288" aria-hidden="true" tabindex="-1"></a><span class="vs">### </span><span class="sc">${</span>title<span class="sc">}</span></span>
<span id="cb22-1289"><a href="#cb22-1289" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span>insight1<span class="sc">}</span></span>
<span id="cb22-1290"><a href="#cb22-1290" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span>insight2<span class="sc">}</span></span>
<span id="cb22-1291"><a href="#cb22-1291" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span>insight3<span class="sc">}</span><span class="vs">`</span></span>
<span id="cb22-1292"><a href="#cb22-1292" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-22" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb23" data-startfrom="1296" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1295"><span id="cb23-1296"><a href="#cb23-1296" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`# </span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">summary</span><span class="op">.</span><span class="at">title</span>)<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-23" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb24" data-startfrom="1300" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1299"><span id="cb24-1300"><a href="#cb24-1300" aria-hidden="true" tabindex="-1"></a>summary_text <span class="op">=</span> {</span>
<span id="cb24-1301"><a href="#cb24-1301" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> vals_without_adapt <span class="op">=</span> quick_insights_projected_2<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">crops</span><span class="op">.</span><span class="at">length</span> <span class="op">==</span> <span class="dv">4</span>)<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">without_adaptation</span>)<span class="op">;</span></span>
<span id="cb24-1302"><a href="#cb24-1302" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> avg <span class="op">=</span> <span class="fu">average</span>(vals_without_adapt)<span class="op">;</span></span>
<span id="cb24-1303"><a href="#cb24-1303" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> template_insight1 <span class="op">=</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">summary</span><span class="op">.</span><span class="at">text1</span>)</span>
<span id="cb24-1304"><a href="#cb24-1304" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> insight1 <span class="op">=</span> Lang<span class="op">.</span><span class="fu">reduceReplaceTemplateItems</span>(template_insight1<span class="op">,</span> [{<span class="dt">name</span><span class="op">:</span><span class="st">"avg_loss"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="fu">round</span>(avg<span class="op">,</span> <span class="dv">2</span>)}])</span>
<span id="cb24-1305"><a href="#cb24-1305" aria-hidden="true" tabindex="-1"></a>  <span class="co">// let insights = `Climate change without adaptation implies a reduction of ${round(avg, 2)}% in the supply of cereal grains in Sub-Saharan Africa.`</span></span>
<span id="cb24-1306"><a href="#cb24-1306" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> insight2 <span class="op">=</span> <span class="st">''</span></span>
<span id="cb24-1307"><a href="#cb24-1307" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (adminSelections<span class="op">.</span><span class="at">selectAdmin0</span> <span class="op">!=</span> <span class="kw">null</span> <span class="op">&amp;&amp;</span> highlighted_data<span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="dv">0</span>){</span>
<span id="cb24-1308"><a href="#cb24-1308" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> selected_geo <span class="op">=</span> <span class="fu">get_selected_admin_atfc</span>()<span class="op">;</span></span>
<span id="cb24-1309"><a href="#cb24-1309" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> better_than_no_adpt <span class="op">=</span> <span class="fu">get_adpt_options_higher_yield_than_no_adaptation</span>(highlighted_data)<span class="op">;</span></span>
<span id="cb24-1310"><a href="#cb24-1310" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> num_options_better_than_no_apt <span class="op">=</span> better_than_no_adpt<span class="op">.</span><span class="at">length</span><span class="op">;</span></span>
<span id="cb24-1311"><a href="#cb24-1311" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> lower_best <span class="op">=</span> <span class="fu">round</span>(<span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(<span class="op">...</span>better_than_no_adpt<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> d[<span class="st">"2050"</span>]))<span class="op">,</span> <span class="dv">2</span>)<span class="op">;</span></span>
<span id="cb24-1312"><a href="#cb24-1312" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> upper_best <span class="op">=</span> <span class="fu">round</span>(<span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(<span class="op">...</span>better_than_no_adpt<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> d[<span class="st">"historical"</span>]))<span class="op">,</span> <span class="dv">2</span>)<span class="op">;</span></span>
<span id="cb24-1313"><a href="#cb24-1313" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-1314"><a href="#cb24-1314" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Select top 3 or less</span></span>
<span id="cb24-1315"><a href="#cb24-1315" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> top <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">min</span>(<span class="op">...</span>[<span class="dv">3</span><span class="op">,</span> better_than_no_adpt<span class="op">.</span><span class="at">length</span>])<span class="op">;</span></span>
<span id="cb24-1316"><a href="#cb24-1316" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> best_options <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb24-1317"><a href="#cb24-1317" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> max_improvement <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb24-1318"><a href="#cb24-1318" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(<span class="kw">let</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> top<span class="op">;</span> j <span class="op">++</span>){</span>
<span id="cb24-1319"><a href="#cb24-1319" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> option <span class="op">=</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">summary</span><span class="op">.</span><span class="at">adaptationOptions</span>[better_than_no_adpt[j]<span class="op">.</span><span class="at">option</span>])</span>
<span id="cb24-1320"><a href="#cb24-1320" aria-hidden="true" tabindex="-1"></a>      best_options<span class="op">.</span><span class="fu">push</span>(option)<span class="op">;</span></span>
<span id="cb24-1321"><a href="#cb24-1321" aria-hidden="true" tabindex="-1"></a>      max_improvement <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(better_than_no_adpt[j]<span class="op">.</span><span class="at">historical</span><span class="op">,</span> max_improvement)<span class="op">;</span></span>
<span id="cb24-1322"><a href="#cb24-1322" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb24-1323"><a href="#cb24-1323" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> template_insight2 <span class="op">=</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">summary</span><span class="op">.</span><span class="at">text2</span>)</span>
<span id="cb24-1324"><a href="#cb24-1324" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> values_insight2 <span class="op">=</span> [</span>
<span id="cb24-1325"><a href="#cb24-1325" aria-hidden="true" tabindex="-1"></a>      {<span class="dt">name</span><span class="op">:</span><span class="st">"selectedGeo"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">countries_article</span>[selected_geo<span class="op">.</span><span class="at">highlight</span>])}<span class="op">,</span></span>
<span id="cb24-1326"><a href="#cb24-1326" aria-hidden="true" tabindex="-1"></a>      {<span class="dt">name</span><span class="op">:</span><span class="st">"bestOptions"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> best_options<span class="op">.</span><span class="fu">join</span>(<span class="st">", "</span>)}</span>
<span id="cb24-1327"><a href="#cb24-1327" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb24-1328"><a href="#cb24-1328" aria-hidden="true" tabindex="-1"></a>    insight2 <span class="op">=</span> Lang<span class="op">.</span><span class="fu">reduceReplaceTemplateItems</span>(template_insight2<span class="op">,</span> values_insight2)</span>
<span id="cb24-1329"><a href="#cb24-1329" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb24-1330"><a href="#cb24-1330" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="fu">md</span><span class="vs">`</span></span>
<span id="cb24-1331"><a href="#cb24-1331" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span>insight1<span class="sc">}</span></span>
<span id="cb24-1332"><a href="#cb24-1332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-1333"><a href="#cb24-1333" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span>insight2<span class="sc">}</span><span class="vs">`</span> </span>
<span id="cb24-1334"><a href="#cb24-1334" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-1335"><a href="#cb24-1335" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-24" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb25" data-startfrom="1339" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1338"><span id="cb25-1339"><a href="#cb25-1339" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`# </span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">MethodsSources</span><span class="op">.</span><span class="at">title</span>)<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-25" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb26" data-startfrom="1343" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1342"><span id="cb26-1343"><a href="#cb26-1343" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`## </span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">MethodsSources</span><span class="op">.</span><span class="at">sources</span><span class="op">.</span><span class="at">title</span>)<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-26" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb27" data-startfrom="1347" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1346"><span id="cb27-1347"><a href="#cb27-1347" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`### </span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">MethodsSources</span><span class="op">.</span><span class="at">sources</span><span class="op">.</span><span class="at">cropYieldDB</span><span class="op">.</span><span class="at">title</span>)<span class="sc">}</span></span>
<span id="cb27-1348"><a href="#cb27-1348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-1349"><a href="#cb27-1349" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">MethodsSources</span><span class="op">.</span><span class="at">sources</span><span class="op">.</span><span class="at">cropYieldDB</span><span class="op">.</span><span class="at">text</span>)<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-27" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb28" data-startfrom="1353" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1352"><span id="cb28-1353"><a href="#cb28-1353" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`### </span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">MethodsSources</span><span class="op">.</span><span class="at">sources</span><span class="op">.</span><span class="at">cropYieldProjections</span><span class="op">.</span><span class="at">title</span>)<span class="sc">}</span></span>
<span id="cb28-1354"><a href="#cb28-1354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1355"><a href="#cb28-1355" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">MethodsSources</span><span class="op">.</span><span class="at">sources</span><span class="op">.</span><span class="at">cropYieldProjections</span><span class="op">.</span><span class="at">text</span>)<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-28" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb29" data-startfrom="1359" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1358"><span id="cb29-1359"><a href="#cb29-1359" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`### </span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">MethodsSources</span><span class="op">.</span><span class="at">sources</span><span class="op">.</span><span class="at">harvestedArea</span><span class="op">.</span><span class="at">title</span>)<span class="sc">}</span></span>
<span id="cb29-1360"><a href="#cb29-1360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-1361"><a href="#cb29-1361" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">MethodsSources</span><span class="op">.</span><span class="at">sources</span><span class="op">.</span><span class="at">harvestedArea</span><span class="op">.</span><span class="at">text</span>)<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-29" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb30" data-startfrom="1365" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1364"><span id="cb30-1365"><a href="#cb30-1365" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`### </span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">MethodsSources</span><span class="op">.</span><span class="at">sources</span><span class="op">.</span><span class="at">boundaries</span><span class="op">.</span><span class="at">title</span>)<span class="sc">}</span></span>
<span id="cb30-1366"><a href="#cb30-1366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-1367"><a href="#cb30-1367" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">MethodsSources</span><span class="op">.</span><span class="at">sources</span><span class="op">.</span><span class="at">boundaries</span><span class="op">.</span><span class="at">text</span>)<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-30" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb31" data-startfrom="1371" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1370"><span id="cb31-1371"><a href="#cb31-1371" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`## </span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">MethodsSources</span><span class="op">.</span><span class="at">methods</span><span class="op">.</span><span class="at">title</span>)<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-31" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb32" data-startfrom="1375" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1374"><span id="cb32-1375"><a href="#cb32-1375" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`### </span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">MethodsSources</span><span class="op">.</span><span class="at">methods</span><span class="op">.</span><span class="at">beeswarm</span><span class="op">.</span><span class="at">title</span>)<span class="sc">}</span></span>
<span id="cb32-1376"><a href="#cb32-1376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-1377"><a href="#cb32-1377" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">MethodsSources</span><span class="op">.</span><span class="at">methods</span><span class="op">.</span><span class="at">beeswarm</span><span class="op">.</span><span class="at">text</span>)<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-32" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb33" data-startfrom="1381" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1380"><span id="cb33-1381"><a href="#cb33-1381" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`### </span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">MethodsSources</span><span class="op">.</span><span class="at">methods</span><span class="op">.</span><span class="at">mappingHistoricalFuture</span><span class="op">.</span><span class="at">title</span>)<span class="sc">}</span></span>
<span id="cb33-1382"><a href="#cb33-1382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1383"><a href="#cb33-1383" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">MethodsSources</span><span class="op">.</span><span class="at">methods</span><span class="op">.</span><span class="at">mappingHistoricalFuture</span><span class="op">.</span><span class="at">text</span>)<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-33" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb34" data-startfrom="1387" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1386"><span id="cb34-1387"><a href="#cb34-1387" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`### </span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">MethodsSources</span><span class="op">.</span><span class="at">methods</span><span class="op">.</span><span class="at">adaptationAnalysis</span><span class="op">.</span><span class="at">title</span>)<span class="sc">}</span></span>
<span id="cb34-1388"><a href="#cb34-1388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-1389"><a href="#cb34-1389" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">MethodsSources</span><span class="op">.</span><span class="at">methods</span><span class="op">.</span><span class="at">adaptationAnalysis</span><span class="op">.</span><span class="at">text</span>)<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-34" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb35" data-startfrom="1393" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1392"><span id="cb35-1393"><a href="#cb35-1393" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`## </span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">MethodsSources</span><span class="op">.</span><span class="at">methods</span><span class="op">.</span><span class="at">references</span><span class="op">.</span><span class="at">title</span>)<span class="sc">}</span></span>
<span id="cb35-1394"><a href="#cb35-1394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-1395"><a href="#cb35-1395" aria-hidden="true" tabindex="-1"></a><span class="vs">- Alimagham, S. et al. (2024) Climate change impact and adaptation of rainfed cereal crops in sub-Saharan Africa. European Journal of Agronomy 155 (127137), [doi:10.1016/j.eja.2024.127137](https://doi.org/10.1016/j.eja.2024.127137)</span></span>
<span id="cb35-1396"><a href="#cb35-1396" aria-hidden="true" tabindex="-1"></a><span class="vs">- Hasegawa, T., Wakatsuki, H., Ju, H. et al. (2022) A global dataset for the projected impacts of climate change on four major crops. Sci Data 9, 58. [doi:10.1038/s41597-022-01150-7](https://doi.org/10.1038/s41597-022-01150-7)</span></span>
<span id="cb35-1397"><a href="#cb35-1397" aria-hidden="true" tabindex="-1"></a><span class="vs">- Yu, Q., You, L., Wood-Sichra, U., et al. (2020) A cultivated planet in 2010: 2. the global gridded agricultural production maps, Earth Syst. Sci. Data Discuss., 2020. [doi:10.5194/essd-2020-11](https://doi.org/10.5194/essd-2020-11)`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-35" data-nodetype="expression"></div></div></div><section id="appendix" class="level1 hidden"><h1 class="hidden">Appendix</h1><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb36" data-startfrom="1404" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1403"><span id="cb36-1404"><a href="#cb36-1404" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb36-1405"><a href="#cb36-1405" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="fu">md</span><span class="vs">`---</span></span>
<span id="cb36-1406"><a href="#cb36-1406" aria-hidden="true" tabindex="-1"></a><span class="vs">## Work by Topic</span></span>
<span id="cb36-1407"><a href="#cb36-1407" aria-hidden="true" tabindex="-1"></a><span class="vs">*Cells that power different sections*`</span></span>
<span id="cb36-1408"><a href="#cb36-1408" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-36" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb37" data-startfrom="1412" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1411"><span id="cb37-1412"><a href="#cb37-1412" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb37-1413"><a href="#cb37-1413" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="fu">md</span><span class="vs">`---</span></span>
<span id="cb37-1414"><a href="#cb37-1414" aria-hidden="true" tabindex="-1"></a><span class="vs">### Support notebook</span></span>
<span id="cb37-1415"><a href="#cb37-1415" aria-hidden="true" tabindex="-1"></a><span class="vs">[Support Notebook](https://observablehq.com/@periscopic/ab-atlas-spotlight-support): used for imports across spotlights.`</span></span>
<span id="cb37-1416"><a href="#cb37-1416" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-37" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb38" data-startfrom="1420" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1419"><span id="cb38-1420"><a href="#cb38-1420" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb38-1421"><a href="#cb38-1421" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="fu">md</span><span class="vs">`---</span></span>
<span id="cb38-1422"><a href="#cb38-1422" aria-hidden="true" tabindex="-1"></a><span class="vs">### Notebook Variables</span></span>
<span id="cb38-1423"><a href="#cb38-1423" aria-hidden="true" tabindex="-1"></a><span class="vs">_Main variables across notebook_`</span></span>
<span id="cb38-1424"><a href="#cb38-1424" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-38" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb39" data-startfrom="1428" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1427"><span id="cb39-1428"><a href="#cb39-1428" aria-hidden="true" tabindex="-1"></a><span class="co">// main title of the notebook</span></span>
<span id="cb39-1429"><a href="#cb39-1429" aria-hidden="true" tabindex="-1"></a>notebookTitle <span class="op">=</span> <span class="fu">_lang</span>({</span>
<span id="cb39-1430"><a href="#cb39-1430" aria-hidden="true" tabindex="-1"></a>  <span class="dt">en</span><span class="op">:</span> <span class="st">"View Projected Climate Impacts"</span><span class="op">,</span></span>
<span id="cb39-1431"><a href="#cb39-1431" aria-hidden="true" tabindex="-1"></a>  <span class="dt">fr</span><span class="op">:</span> <span class="st">"Visualiser les projections d’ impacts climatiques"</span><span class="op">,</span></span>
<span id="cb39-1432"><a href="#cb39-1432" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-39" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb40" data-startfrom="1436" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1435"><span id="cb40-1436"><a href="#cb40-1436" aria-hidden="true" tabindex="-1"></a><span class="co">// info for the admin selectors</span></span>
<span id="cb40-1437"><a href="#cb40-1437" aria-hidden="true" tabindex="-1"></a>adminRegions <span class="op">=</span> {</span>
<span id="cb40-1438"><a href="#cb40-1438" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> {</span>
<span id="cb40-1439"><a href="#cb40-1439" aria-hidden="true" tabindex="-1"></a>    <span class="dt">labels</span><span class="op">:</span> {</span>
<span id="cb40-1440"><a href="#cb40-1440" aria-hidden="true" tabindex="-1"></a>      <span class="dt">admin0</span><span class="op">:</span> <span class="st">'Country'</span><span class="op">,</span></span>
<span id="cb40-1441"><a href="#cb40-1441" aria-hidden="true" tabindex="-1"></a>      <span class="dt">admin1</span><span class="op">:</span> <span class="st">'Region'</span><span class="op">,</span></span>
<span id="cb40-1442"><a href="#cb40-1442" aria-hidden="true" tabindex="-1"></a>      <span class="dt">admin2</span><span class="op">:</span> <span class="st">'Subregion'</span></span>
<span id="cb40-1443"><a href="#cb40-1443" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb40-1444"><a href="#cb40-1444" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb40-1445"><a href="#cb40-1445" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-40" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb41" data-startfrom="1449" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1448"><span id="cb41-1449"><a href="#cb41-1449" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">getLowerLevelAdminLabel</span>(selections <span class="op">=</span> adminSelections) {</span>
<span id="cb41-1450"><a href="#cb41-1450" aria-hidden="true" tabindex="-1"></a>  <span class="co">// based on admin selection, get the lower level label</span></span>
<span id="cb41-1451"><a href="#cb41-1451" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (selections<span class="op">.</span><span class="at">selectAdmin2</span>) <span class="cf">return</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">subRegion</span>)<span class="op">;</span></span>
<span id="cb41-1452"><a href="#cb41-1452" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (selections<span class="op">.</span><span class="at">selectAdmin1</span>) <span class="cf">return</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">subRegion</span>)<span class="op">;</span></span>
<span id="cb41-1453"><a href="#cb41-1453" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (selections<span class="op">.</span><span class="at">selectAdmin0</span>) <span class="cf">return</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">region</span>)<span class="op">;</span></span>
<span id="cb41-1454"><a href="#cb41-1454" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="cf">return</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">country</span>)<span class="op">;</span></span>
<span id="cb41-1455"><a href="#cb41-1455" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-41" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb42" data-startfrom="1459" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1458"><span id="cb42-1459"><a href="#cb42-1459" aria-hidden="true" tabindex="-1"></a><span class="co">// width of the maps</span></span>
<span id="cb42-1460"><a href="#cb42-1460" aria-hidden="true" tabindex="-1"></a>mapWidth <span class="op">=</span> <span class="dv">625</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-42" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb43" data-startfrom="1464" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1463"><span id="cb43-1464"><a href="#cb43-1464" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`### Language and Translation tools`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-43" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb44" data-startfrom="1468" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1467"><span id="cb44-1468"><a href="#cb44-1468" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { Lang } <span class="im">from</span> <span class="st">"7d46679f7d0d917e"</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-44" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb45" data-startfrom="1472" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1471"><span id="cb45-1472"><a href="#cb45-1472" aria-hidden="true" tabindex="-1"></a>_lang <span class="op">=</span> Lang<span class="op">.</span><span class="fu">lg</span>(language<span class="op">.</span><span class="at">key</span>)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-45" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb46" data-startfrom="1476" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1475"><span id="cb46-1476"><a href="#cb46-1476" aria-hidden="true" tabindex="-1"></a>languages <span class="op">=</span> [</span>
<span id="cb46-1477"><a href="#cb46-1477" aria-hidden="true" tabindex="-1"></a>  { <span class="dt">key</span><span class="op">:</span> <span class="st">"en"</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"English"</span><span class="op">,</span> <span class="dt">locale</span><span class="op">:</span> <span class="st">"en-US"</span> }<span class="op">,</span></span>
<span id="cb46-1478"><a href="#cb46-1478" aria-hidden="true" tabindex="-1"></a>  { <span class="dt">key</span><span class="op">:</span> <span class="st">"fr"</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"Français"</span><span class="op">,</span> <span class="dt">locale</span><span class="op">:</span> <span class="st">"fr-FR"</span> }<span class="op">,</span></span>
<span id="cb46-1479"><a href="#cb46-1479" aria-hidden="true" tabindex="-1"></a>]<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-46" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb47" data-startfrom="1483" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1482"><span id="cb47-1483"><a href="#cb47-1483" aria-hidden="true" tabindex="-1"></a>defaultLangKey <span class="op">=</span> {</span>
<span id="cb47-1484"><a href="#cb47-1484" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> name <span class="op">=</span> <span class="st">"lang"</span><span class="op">;</span></span>
<span id="cb47-1485"><a href="#cb47-1485" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> list <span class="op">=</span> languages<span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">key</span>)<span class="op">;</span></span>
<span id="cb47-1486"><a href="#cb47-1486" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> defaultKey <span class="op">=</span> <span class="st">"en"</span><span class="op">;</span></span>
<span id="cb47-1487"><a href="#cb47-1487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-1488"><a href="#cb47-1488" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> queryParam <span class="op">=</span> <span class="cf">await</span> Lang<span class="op">.</span><span class="fu">getParamFromList</span>({ name<span class="op">,</span> list })<span class="op">;</span></span>
<span id="cb47-1489"><a href="#cb47-1489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-1490"><a href="#cb47-1490" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> queryParam <span class="op">??</span> defaultKey<span class="op">;</span></span>
<span id="cb47-1491"><a href="#cb47-1491" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-47" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb48" data-startfrom="1495" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1494"><span id="cb48-1495"><a href="#cb48-1495" aria-hidden="true" tabindex="-1"></a>viewof language <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">radio</span>(languages<span class="op">,</span> {</span>
<span id="cb48-1496"><a href="#cb48-1496" aria-hidden="true" tabindex="-1"></a>  <span class="dt">label</span><span class="op">:</span> <span class="st">"Main language toggle"</span><span class="op">,</span></span>
<span id="cb48-1497"><a href="#cb48-1497" aria-hidden="true" tabindex="-1"></a>  <span class="dt">format</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">key</span><span class="op">,</span></span>
<span id="cb48-1498"><a href="#cb48-1498" aria-hidden="true" tabindex="-1"></a>  <span class="dt">value</span><span class="op">:</span> languages<span class="op">.</span><span class="fu">find</span>((x) <span class="kw">=&gt;</span> x<span class="op">.</span><span class="at">key</span> <span class="op">===</span> defaultLangKey)<span class="op">,</span></span>
<span id="cb48-1499"><a href="#cb48-1499" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-48" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb49" data-startfrom="1503" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1502"><span id="cb49-1503"><a href="#cb49-1503" aria-hidden="true" tabindex="-1"></a>nbText <span class="op">=</span> <span class="kw">new</span> <span class="bu">Object</span>({</span>
<span id="cb49-1504"><a href="#cb49-1504" aria-hidden="true" tabindex="-1"></a>  <span class="dt">toc</span><span class="op">:</span> {</span>
<span id="cb49-1505"><a href="#cb49-1505" aria-hidden="true" tabindex="-1"></a>    <span class="dt">title</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"In this notebook"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Dans ce notebook"</span> }<span class="op">,</span></span>
<span id="cb49-1506"><a href="#cb49-1506" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb49-1507"><a href="#cb49-1507" aria-hidden="true" tabindex="-1"></a>  <span class="dt">overview</span><span class="op">:</span> {</span>
<span id="cb49-1508"><a href="#cb49-1508" aria-hidden="true" tabindex="-1"></a>    <span class="dt">title</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Overview"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Vue d’Ensemble"</span> }<span class="op">,</span></span>
<span id="cb49-1509"><a href="#cb49-1509" aria-hidden="true" tabindex="-1"></a>    <span class="dt">text</span><span class="op">:</span> {</span>
<span id="cb49-1510"><a href="#cb49-1510" aria-hidden="true" tabindex="-1"></a>      <span class="dt">en</span><span class="op">:</span> <span class="vs">`Sub-Saharan Africa’s greatest challenge is to be able to feed a population of 2.1 billion people by 2050 (about 2.5x larger than today) ideally on the same amount of arable land, and under less hospitable weather conditions due to climate change. But by 2050, most of the region will experience at least 2ºC warmer temperatures. Without adaptation, climate change could have dire consequences on food supply, in particular because over 95% of crop production happens under rainfed conditions and weather variability dictates more than one-third of year-on-year yield fluctuations. Cereal grains including maize, sorghum, rice, millet, and wheat are especially important as they provide 50% of daily caloric intake across the region. In this notebook, users can investigate the projected reductions in yield for key cereal crops and the adaptation benefits of some options for specific locations.`</span><span class="op">,</span></span>
<span id="cb49-1511"><a href="#cb49-1511" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fr</span><span class="op">:</span> <span class="vs">`Le plus grand défi de l'Afrique subsaharienne est de pouvoir nourrir une population de 2,1 milliards de personnes d'ici 2050 (environ 2,5 fois plus qu'aujourd'hui), idéalement sur la même quantité de terres arables, et dans des conditions météorologiques moins hospitalières en raison du changement climatique. Mais d'ici 2050, la plupart de la région connaîtra des températures au moins 2ºC plus chaudes. Sans adaptation, le changement climatique pourrait avoir des conséquences désastreuses sur l'approvisionnement alimentaire, notamment parce que plus de 95 % de la production agricole se fait sous des conditions de culture pluviale et que la variabilité climatique dicte plus d'un tiers des fluctuations annuelles des rendements. Les céréales, notamment le maïs, le sorgho, le riz, le millet et le blé, sont particulièrement importantes car elles fournissent 50 % de l'apport calorique quotidien dans toute la région. Dans ce notebook, les utilisateurs peuvent examiner les réductions projetées des rendements pour les principales cultures céréalières et les avantages de l'adaptation de certaines options pour des lieux spécifiques.`</span><span class="op">,</span></span>
<span id="cb49-1512"><a href="#cb49-1512" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb49-1513"><a href="#cb49-1513" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb49-1514"><a href="#cb49-1514" aria-hidden="true" tabindex="-1"></a>  <span class="dt">regionalPicture</span><span class="op">:</span> {</span>
<span id="cb49-1515"><a href="#cb49-1515" aria-hidden="true" tabindex="-1"></a>    <span class="dt">title</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"The Regional Picture"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"La Situation Régionale"</span> }<span class="op">,</span></span>
<span id="cb49-1516"><a href="#cb49-1516" aria-hidden="true" tabindex="-1"></a>    <span class="dt">text</span><span class="op">:</span> {</span>
<span id="cb49-1517"><a href="#cb49-1517" aria-hidden="true" tabindex="-1"></a>      <span class="dt">en</span><span class="op">:</span> <span class="vs">`The beeswarm plot visualization below helps you explore climate change impacts on maize, wheat, rice, and soybean for various regions in Sub-Saharan Africa. The impacts can be navigated by crop and levels of warming, and can be visualized with adaptation and without adaptation.`</span><span class="op">,</span></span>
<span id="cb49-1518"><a href="#cb49-1518" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fr</span><span class="op">:</span> <span class="vs">`La visualisation en diagramme de nuage de points ci-dessous vous aide à explorer les impacts du changement climatique sur le maïs, le blé, le riz et le soja pour diverses régions d'Afrique subsaharienne. Les impacts peuvent être explorés par culture et par niveaux de réchauffement, et peuvent être visualisés avec ou sans adaptation.`</span><span class="op">,</span></span>
<span id="cb49-1519"><a href="#cb49-1519" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb49-1520"><a href="#cb49-1520" aria-hidden="true" tabindex="-1"></a>    <span class="dt">selectors</span><span class="op">:</span> {</span>
<span id="cb49-1521"><a href="#cb49-1521" aria-hidden="true" tabindex="-1"></a>      <span class="dt">crops</span><span class="op">:</span> {</span>
<span id="cb49-1522"><a href="#cb49-1522" aria-hidden="true" tabindex="-1"></a>        <span class="dt">title</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Crops"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Cultures"</span> }<span class="op">,</span></span>
<span id="cb49-1523"><a href="#cb49-1523" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-1524"><a href="#cb49-1524" aria-hidden="true" tabindex="-1"></a>      <span class="dt">warmingLevel</span><span class="op">:</span> {</span>
<span id="cb49-1525"><a href="#cb49-1525" aria-hidden="true" tabindex="-1"></a>        <span class="dt">title</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Warming Level (℃)"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Niveau de réchauffement (℃)"</span> }<span class="op">,</span></span>
<span id="cb49-1526"><a href="#cb49-1526" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-1527"><a href="#cb49-1527" aria-hidden="true" tabindex="-1"></a>      <span class="dt">adaptation</span><span class="op">:</span> {</span>
<span id="cb49-1528"><a href="#cb49-1528" aria-hidden="true" tabindex="-1"></a>        <span class="dt">title</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Adaptation"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Adaptation"</span> }<span class="op">,</span></span>
<span id="cb49-1529"><a href="#cb49-1529" aria-hidden="true" tabindex="-1"></a>        <span class="dt">values</span><span class="op">:</span> {</span>
<span id="cb49-1530"><a href="#cb49-1530" aria-hidden="true" tabindex="-1"></a>          <span class="dt">Yes</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Yes"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Oui"</span> }<span class="op">,</span></span>
<span id="cb49-1531"><a href="#cb49-1531" aria-hidden="true" tabindex="-1"></a>          <span class="dt">No</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"No"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Non"</span> }<span class="op">,</span></span>
<span id="cb49-1532"><a href="#cb49-1532" aria-hidden="true" tabindex="-1"></a>          <span class="st">"All data"</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"All data"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Toutes les données"</span> }<span class="op">,</span></span>
<span id="cb49-1533"><a href="#cb49-1533" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb49-1534"><a href="#cb49-1534" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-1535"><a href="#cb49-1535" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb49-1536"><a href="#cb49-1536" aria-hidden="true" tabindex="-1"></a>    <span class="dt">beeswarm</span><span class="op">:</span> {</span>
<span id="cb49-1537"><a href="#cb49-1537" aria-hidden="true" tabindex="-1"></a>      <span class="dt">xAxis</span><span class="op">:</span> {</span>
<span id="cb49-1538"><a href="#cb49-1538" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Climate impacts relative to 2005 (%)"</span><span class="op">,</span></span>
<span id="cb49-1539"><a href="#cb49-1539" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Impacts climatiques par rapport à 2005 (%)"</span><span class="op">,</span></span>
<span id="cb49-1540"><a href="#cb49-1540" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-1541"><a href="#cb49-1541" aria-hidden="true" tabindex="-1"></a>      <span class="dt">yAxis</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"UN Region"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Région ONU"</span> }<span class="op">,</span></span>
<span id="cb49-1542"><a href="#cb49-1542" aria-hidden="true" tabindex="-1"></a>      <span class="dt">regions</span><span class="op">:</span> {</span>
<span id="cb49-1543"><a href="#cb49-1543" aria-hidden="true" tabindex="-1"></a>        <span class="dt">all</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"All"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Tous"</span> }<span class="op">,</span></span>
<span id="cb49-1544"><a href="#cb49-1544" aria-hidden="true" tabindex="-1"></a>        <span class="dt">Western</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Western"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Ouest"</span> }<span class="op">,</span></span>
<span id="cb49-1545"><a href="#cb49-1545" aria-hidden="true" tabindex="-1"></a>        <span class="dt">Southern</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Southern"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Sud"</span> }<span class="op">,</span></span>
<span id="cb49-1546"><a href="#cb49-1546" aria-hidden="true" tabindex="-1"></a>        <span class="dt">Northern</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Northern"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Nord"</span> }<span class="op">,</span></span>
<span id="cb49-1547"><a href="#cb49-1547" aria-hidden="true" tabindex="-1"></a>        <span class="dt">Eastern</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Eastern"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Est"</span> }<span class="op">,</span></span>
<span id="cb49-1548"><a href="#cb49-1548" aria-hidden="true" tabindex="-1"></a>        <span class="dt">Central</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Central"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Central"</span> }<span class="op">,</span></span>
<span id="cb49-1549"><a href="#cb49-1549" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-1550"><a href="#cb49-1550" aria-hidden="true" tabindex="-1"></a>      <span class="dt">legend</span><span class="op">:</span> {</span>
<span id="cb49-1551"><a href="#cb49-1551" aria-hidden="true" tabindex="-1"></a>        <span class="st">"With adaptation"</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"With Adaptation"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Avec Adaptation"</span> }<span class="op">,</span></span>
<span id="cb49-1552"><a href="#cb49-1552" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Without adaptation"</span><span class="op">:</span> {</span>
<span id="cb49-1553"><a href="#cb49-1553" aria-hidden="true" tabindex="-1"></a>          <span class="dt">en</span><span class="op">:</span> <span class="st">"Without Adaptation"</span><span class="op">,</span></span>
<span id="cb49-1554"><a href="#cb49-1554" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fr</span><span class="op">:</span> <span class="st">"Sans Adaptation"</span><span class="op">,</span></span>
<span id="cb49-1555"><a href="#cb49-1555" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb49-1556"><a href="#cb49-1556" aria-hidden="true" tabindex="-1"></a>        <span class="dt">Yes</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"With Adaptation"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Avec Adaptation"</span> }<span class="op">,</span></span>
<span id="cb49-1557"><a href="#cb49-1557" aria-hidden="true" tabindex="-1"></a>        <span class="dt">No</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Without Adaptation"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Sans Adaptation"</span> }<span class="op">,</span></span>
<span id="cb49-1558"><a href="#cb49-1558" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-1559"><a href="#cb49-1559" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb49-1560"><a href="#cb49-1560" aria-hidden="true" tabindex="-1"></a>    <span class="dt">beeswarmInsight</span><span class="op">:</span> {</span>
<span id="cb49-1561"><a href="#cb49-1561" aria-hidden="true" tabindex="-1"></a>      <span class="dt">title</span><span class="op">:</span> {</span>
<span id="cb49-1562"><a href="#cb49-1562" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="vs">`Quick insights for :::SelectedCrop::: and warming level (:::warmingLevel:::)`</span><span class="op">,</span></span>
<span id="cb49-1563"><a href="#cb49-1563" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="vs">`Aperçus rapides pour les cultures de :::SelectedCrop::: et niveau de réchauffement (:::warmingLevel:::)`</span><span class="op">,</span></span>
<span id="cb49-1564"><a href="#cb49-1564" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-1565"><a href="#cb49-1565" aria-hidden="true" tabindex="-1"></a>      <span class="dt">text</span><span class="op">:</span> {</span>
<span id="cb49-1566"><a href="#cb49-1566" aria-hidden="true" tabindex="-1"></a>        <span class="dt">insight1</span><span class="op">:</span> {</span>
<span id="cb49-1567"><a href="#cb49-1567" aria-hidden="true" tabindex="-1"></a>          <span class="dt">en</span><span class="op">:</span> <span class="vs">`At :::warmingLevel:::, **:::crops:::** is projected to experience a median yield reduction of **:::yieldReduction:::%** if no adaptation actions are taken`</span><span class="op">,</span></span>
<span id="cb49-1568"><a href="#cb49-1568" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fr</span><span class="op">:</span> <span class="vs">`À :::warmingLevel:::, les cultures sélectionnées de **:::crops:::** devraient connaître une réduction médiane des rendements de **:::yieldReduction:::%** si aucune mesure d'adaptation n'est prise.`</span><span class="op">,</span></span>
<span id="cb49-1569"><a href="#cb49-1569" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb49-1570"><a href="#cb49-1570" aria-hidden="true" tabindex="-1"></a>        <span class="dt">insight2</span><span class="op">:</span> {</span>
<span id="cb49-1571"><a href="#cb49-1571" aria-hidden="true" tabindex="-1"></a>          <span class="dt">main</span><span class="op">:</span> {</span>
<span id="cb49-1572"><a href="#cb49-1572" aria-hidden="true" tabindex="-1"></a>            <span class="dt">en</span><span class="op">:</span> <span class="vs">`The most negatively impacted region is :::mostAffected:::`</span><span class="op">,</span></span>
<span id="cb49-1573"><a href="#cb49-1573" aria-hidden="true" tabindex="-1"></a>            <span class="dt">fr</span><span class="op">:</span> <span class="vs">`La région la plus négativement impactée est :::mostAffected:::`</span><span class="op">,</span></span>
<span id="cb49-1574"><a href="#cb49-1574" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb49-1575"><a href="#cb49-1575" aria-hidden="true" tabindex="-1"></a>          <span class="dt">mostAffected</span><span class="op">:</span> {</span>
<span id="cb49-1576"><a href="#cb49-1576" aria-hidden="true" tabindex="-1"></a>            <span class="dt">en</span><span class="op">:</span> <span class="vs">`The most negatively impacted region is **:::mostAffected_adaptation:::** with adaptation and **:::mostAffected_noadaptation:::** without adaptation`</span><span class="op">,</span></span>
<span id="cb49-1577"><a href="#cb49-1577" aria-hidden="true" tabindex="-1"></a>            <span class="dt">fr</span><span class="op">:</span> <span class="vs">`La région la plus négativement impactée est **:::mostAffected_adaptation:::** avec adaptation et **:::mostAffected_noadaptation:::** sans adaptation`</span><span class="op">,</span></span>
<span id="cb49-1578"><a href="#cb49-1578" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb49-1579"><a href="#cb49-1579" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb49-1580"><a href="#cb49-1580" aria-hidden="true" tabindex="-1"></a>        <span class="dt">insight3</span><span class="op">:</span> {</span>
<span id="cb49-1581"><a href="#cb49-1581" aria-hidden="true" tabindex="-1"></a>          <span class="dt">compelling</span><span class="op">:</span> {</span>
<span id="cb49-1582"><a href="#cb49-1582" aria-hidden="true" tabindex="-1"></a>            <span class="dt">en</span><span class="op">:</span> <span class="vs">`Adaptation can offset these projected :::loss_gain::: with yield changes under adaptation being **:::withAdaptation:::%**.`</span><span class="op">,</span></span>
<span id="cb49-1583"><a href="#cb49-1583" aria-hidden="true" tabindex="-1"></a>            <span class="dt">fr</span><span class="op">:</span> <span class="vs">`L'adaptation peut compenser ces projections de pertes avec des changements de rendement sous adaptation étant de **:::withAdaptation:::%**.`</span><span class="op">,</span></span>
<span id="cb49-1584"><a href="#cb49-1584" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb49-1585"><a href="#cb49-1585" aria-hidden="true" tabindex="-1"></a>          <span class="dt">notCompelling</span><span class="op">:</span> {</span>
<span id="cb49-1586"><a href="#cb49-1586" aria-hidden="true" tabindex="-1"></a>            <span class="dt">en</span><span class="op">:</span> <span class="st">"No compelling evidence of adaptation benefits exists in our data"</span><span class="op">,</span></span>
<span id="cb49-1587"><a href="#cb49-1587" aria-hidden="true" tabindex="-1"></a>            <span class="dt">fr</span><span class="op">:</span> <span class="st">"Aucune preuve convaincante des avantages de l'adaptation n'existe dans nos données."</span><span class="op">,</span></span>
<span id="cb49-1588"><a href="#cb49-1588" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb49-1589"><a href="#cb49-1589" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb49-1590"><a href="#cb49-1590" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-1591"><a href="#cb49-1591" aria-hidden="true" tabindex="-1"></a>      <span class="dt">regions</span><span class="op">:</span> {</span>
<span id="cb49-1592"><a href="#cb49-1592" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Western Africa"</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Western Africa"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"L’Afrique de l’Ouest"</span> }<span class="op">,</span></span>
<span id="cb49-1593"><a href="#cb49-1593" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Southern Africa"</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Southern Africa"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"L’Afrique du Sud"</span> }<span class="op">,</span></span>
<span id="cb49-1594"><a href="#cb49-1594" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Northern Africa"</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Northern Africa"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"L’Afrique du Nord"</span> }<span class="op">,</span></span>
<span id="cb49-1595"><a href="#cb49-1595" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Eastern Africa"</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Eastern Africa"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"L’Afrique de l’Est"</span> }<span class="op">,</span></span>
<span id="cb49-1596"><a href="#cb49-1596" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Central Africa"</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Central Africa"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"L’Afrique Centrale"</span> }<span class="op">,</span></span>
<span id="cb49-1597"><a href="#cb49-1597" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-1598"><a href="#cb49-1598" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb49-1599"><a href="#cb49-1599" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb49-1600"><a href="#cb49-1600" aria-hidden="true" tabindex="-1"></a>  <span class="dt">zoomToStable</span><span class="op">:</span> {</span>
<span id="cb49-1601"><a href="#cb49-1601" aria-hidden="true" tabindex="-1"></a>    <span class="dt">title</span><span class="op">:</span> {</span>
<span id="cb49-1602"><a href="#cb49-1602" aria-hidden="true" tabindex="-1"></a>      <span class="dt">en</span><span class="op">:</span> <span class="st">"Zooming Into Africa’s Staple Cereal Crops"</span><span class="op">,</span></span>
<span id="cb49-1603"><a href="#cb49-1603" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fr</span><span class="op">:</span> <span class="st">"Un zoom sur les cultures céréalières de base en Afrique"</span><span class="op">,</span></span>
<span id="cb49-1604"><a href="#cb49-1604" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb49-1605"><a href="#cb49-1605" aria-hidden="true" tabindex="-1"></a>    <span class="dt">text</span><span class="op">:</span> {</span>
<span id="cb49-1606"><a href="#cb49-1606" aria-hidden="true" tabindex="-1"></a>      <span class="dt">en</span><span class="op">:</span> <span class="vs">`Global and regional averages hide a much more nuanced story about climate impacts on crop yield at national and subnational scales. Moreover, future scenarios also matter, with the trajectory of climate change inducing different levels of impact. This section navigates through country-level and within-country variation in projected impacts on crop yield using crop model-based projections.`</span><span class="op">,</span></span>
<span id="cb49-1607"><a href="#cb49-1607" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fr</span><span class="op">:</span> <span class="vs">`Les moyennes mondiales et régionales masquent une histoire bien plus nuancée des impacts climatiques sur les rendements des cultures à l'échelle nationale et infranationale. De plus, les scénarios futurs sont également importants, la trajectoire du changement climatique induisant différents niveaux d'impact. Cette section explore les variations au niveau des pays et à l'intérieur des pays concernant les impacts projetés sur les rendements des cultures en utilisant des projections basées sur des modèles de culture.`</span><span class="op">,</span></span>
<span id="cb49-1608"><a href="#cb49-1608" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb49-1609"><a href="#cb49-1609" aria-hidden="true" tabindex="-1"></a>    <span class="dt">selectors</span><span class="op">:</span> {</span>
<span id="cb49-1610"><a href="#cb49-1610" aria-hidden="true" tabindex="-1"></a>      <span class="dt">growSeason</span><span class="op">:</span> {</span>
<span id="cb49-1611"><a href="#cb49-1611" aria-hidden="true" tabindex="-1"></a>        <span class="dt">title</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Growing Season"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Saison de croissance"</span> }<span class="op">,</span></span>
<span id="cb49-1612"><a href="#cb49-1612" aria-hidden="true" tabindex="-1"></a>        <span class="dt">values</span><span class="op">:</span> {</span>
<span id="cb49-1613"><a href="#cb49-1613" aria-hidden="true" tabindex="-1"></a>          <span class="dt">both</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Both (Average)"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Les deux (Moyenne)"</span> }<span class="op">,</span></span>
<span id="cb49-1614"><a href="#cb49-1614" aria-hidden="true" tabindex="-1"></a>          <span class="dt">first</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"First"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Première"</span> }<span class="op">,</span></span>
<span id="cb49-1615"><a href="#cb49-1615" aria-hidden="true" tabindex="-1"></a>          <span class="dt">second</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Second"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Deuxième"</span> }<span class="op">,</span></span>
<span id="cb49-1616"><a href="#cb49-1616" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb49-1617"><a href="#cb49-1617" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-1618"><a href="#cb49-1618" aria-hidden="true" tabindex="-1"></a>      <span class="dt">YieldOutput</span><span class="op">:</span> {</span>
<span id="cb49-1619"><a href="#cb49-1619" aria-hidden="true" tabindex="-1"></a>        <span class="dt">title</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Yield Output"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Production de rendement"</span> }<span class="op">,</span></span>
<span id="cb49-1620"><a href="#cb49-1620" aria-hidden="true" tabindex="-1"></a>        <span class="dt">values</span><span class="op">:</span> {</span>
<span id="cb49-1621"><a href="#cb49-1621" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Yield change (ton/ha)"</span><span class="op">:</span> {</span>
<span id="cb49-1622"><a href="#cb49-1622" aria-hidden="true" tabindex="-1"></a>            <span class="dt">en</span><span class="op">:</span> <span class="st">"Yield change (ton/ha)"</span><span class="op">,</span></span>
<span id="cb49-1623"><a href="#cb49-1623" aria-hidden="true" tabindex="-1"></a>            <span class="dt">fr</span><span class="op">:</span> <span class="st">"Changement de rendement (tonnes/ha)"</span><span class="op">,</span></span>
<span id="cb49-1624"><a href="#cb49-1624" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb49-1625"><a href="#cb49-1625" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Yield (ton/ha)"</span><span class="op">:</span> {</span>
<span id="cb49-1626"><a href="#cb49-1626" aria-hidden="true" tabindex="-1"></a>            <span class="dt">en</span><span class="op">:</span> <span class="st">"Yield (ton/ha)"</span><span class="op">,</span></span>
<span id="cb49-1627"><a href="#cb49-1627" aria-hidden="true" tabindex="-1"></a>            <span class="dt">fr</span><span class="op">:</span> <span class="st">"Rendement (tonnes/ha)"</span><span class="op">,</span></span>
<span id="cb49-1628"><a href="#cb49-1628" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb49-1629"><a href="#cb49-1629" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Yield change (%)"</span><span class="op">:</span> {</span>
<span id="cb49-1630"><a href="#cb49-1630" aria-hidden="true" tabindex="-1"></a>            <span class="dt">en</span><span class="op">:</span> <span class="st">"Yield change (%)"</span><span class="op">,</span></span>
<span id="cb49-1631"><a href="#cb49-1631" aria-hidden="true" tabindex="-1"></a>            <span class="dt">fr</span><span class="op">:</span> <span class="st">"Changement de rendement (%)"</span><span class="op">,</span></span>
<span id="cb49-1632"><a href="#cb49-1632" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb49-1633"><a href="#cb49-1633" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Uncertainty in yield (ton/ha)"</span><span class="op">:</span> {</span>
<span id="cb49-1634"><a href="#cb49-1634" aria-hidden="true" tabindex="-1"></a>            <span class="dt">en</span><span class="op">:</span> <span class="st">"Uncertainty in yield (ton/ha)"</span><span class="op">,</span></span>
<span id="cb49-1635"><a href="#cb49-1635" aria-hidden="true" tabindex="-1"></a>            <span class="dt">fr</span><span class="op">:</span> <span class="st">"Incertitude du rendement (tonnes/ha)"</span><span class="op">,</span></span>
<span id="cb49-1636"><a href="#cb49-1636" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb49-1637"><a href="#cb49-1637" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb49-1638"><a href="#cb49-1638" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-1639"><a href="#cb49-1639" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Cultivar</span><span class="op">:</span> {</span>
<span id="cb49-1640"><a href="#cb49-1640" aria-hidden="true" tabindex="-1"></a>        <span class="dt">title</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Cultivar"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Cultivar"</span> }<span class="op">,</span></span>
<span id="cb49-1641"><a href="#cb49-1641" aria-hidden="true" tabindex="-1"></a>        <span class="dt">values</span><span class="op">:</span> {</span>
<span id="cb49-1642"><a href="#cb49-1642" aria-hidden="true" tabindex="-1"></a>          <span class="dt">current</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Current"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Actuel"</span> }<span class="op">,</span></span>
<span id="cb49-1643"><a href="#cb49-1643" aria-hidden="true" tabindex="-1"></a>          <span class="dt">early</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Early maturity"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Maturité précoce"</span> }<span class="op">,</span></span>
<span id="cb49-1644"><a href="#cb49-1644" aria-hidden="true" tabindex="-1"></a>          <span class="dt">late</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Late maturity"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Maturité tardive"</span> }<span class="op">,</span></span>
<span id="cb49-1645"><a href="#cb49-1645" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb49-1646"><a href="#cb49-1646" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-1647"><a href="#cb49-1647" aria-hidden="true" tabindex="-1"></a>      <span class="dt">layer</span><span class="op">:</span> {</span>
<span id="cb49-1648"><a href="#cb49-1648" aria-hidden="true" tabindex="-1"></a>        <span class="dt">title</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Map Layer"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Couche de la carte"</span> }<span class="op">,</span></span>
<span id="cb49-1649"><a href="#cb49-1649" aria-hidden="true" tabindex="-1"></a>        <span class="dt">values</span><span class="op">:</span> {</span>
<span id="cb49-1650"><a href="#cb49-1650" aria-hidden="true" tabindex="-1"></a>          <span class="dt">rainfed</span><span class="op">:</span> {</span>
<span id="cb49-1651"><a href="#cb49-1651" aria-hidden="true" tabindex="-1"></a>            <span class="dt">en</span><span class="op">:</span> <span class="st">"Mean rainfed potential yield"</span><span class="op">,</span></span>
<span id="cb49-1652"><a href="#cb49-1652" aria-hidden="true" tabindex="-1"></a>            <span class="dt">fr</span><span class="op">:</span> <span class="st">"Rendement potentiel moyen en culture pluviale"</span><span class="op">,</span></span>
<span id="cb49-1653"><a href="#cb49-1653" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb49-1654"><a href="#cb49-1654" aria-hidden="true" tabindex="-1"></a>          <span class="dt">irrigated</span><span class="op">:</span> {</span>
<span id="cb49-1655"><a href="#cb49-1655" aria-hidden="true" tabindex="-1"></a>            <span class="dt">en</span><span class="op">:</span> <span class="st">"Mean irrigated potential yield"</span><span class="op">,</span></span>
<span id="cb49-1656"><a href="#cb49-1656" aria-hidden="true" tabindex="-1"></a>            <span class="dt">fr</span><span class="op">:</span> <span class="st">"Rendement potentiel moyen en culture irriguée"</span><span class="op">,</span></span>
<span id="cb49-1657"><a href="#cb49-1657" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb49-1658"><a href="#cb49-1658" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb49-1659"><a href="#cb49-1659" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-1660"><a href="#cb49-1660" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb49-1661"><a href="#cb49-1661" aria-hidden="true" tabindex="-1"></a>    <span class="dt">MapInsight</span><span class="op">:</span> {</span>
<span id="cb49-1662"><a href="#cb49-1662" aria-hidden="true" tabindex="-1"></a>      <span class="dt">title</span><span class="op">:</span> {</span>
<span id="cb49-1663"><a href="#cb49-1663" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Quick Insights for :::geography:::, under :::scenario_selection::: for :::crop_selection:::"</span><span class="op">,</span></span>
<span id="cb49-1664"><a href="#cb49-1664" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Aperçu rapide pour la région de :::geography:::, sous :::scenario_selection::: pour les cultures de :::crop_selection:::"</span><span class="op">,</span></span>
<span id="cb49-1665"><a href="#cb49-1665" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-1666"><a href="#cb49-1666" aria-hidden="true" tabindex="-1"></a>      <span class="dt">insight1</span><span class="op">:</span> {</span>
<span id="cb49-1667"><a href="#cb49-1667" aria-hidden="true" tabindex="-1"></a>        <span class="co">// en:  ":::geography:::’s :::scenario_selection::: :::crop_selection::: rainfed/irrigated :::yield_selection::: is **:::value:::**",</span></span>
<span id="cb49-1668"><a href="#cb49-1668" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"The :::yield_selection::: for  :::crop_selection::: is **:::value:::**"</span><span class="op">,</span></span>
<span id="cb49-1669"><a href="#cb49-1669" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Le changement de rendement des cultures de :::crop_selection::: en culture pluviale :::yield_selection::: est de **:::value:::**"</span><span class="op">,</span></span>
<span id="cb49-1670"><a href="#cb49-1670" aria-hidden="true" tabindex="-1"></a>        <span class="co">// fr:  ":::geography:::’s :::scenario_selection::: :::crop_selection::: rainfed/irrigated :::yield_selection::: is **:::value:::**"</span></span>
<span id="cb49-1671"><a href="#cb49-1671" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-1672"><a href="#cb49-1672" aria-hidden="true" tabindex="-1"></a>      <span class="dt">insight2</span><span class="op">:</span> {</span>
<span id="cb49-1673"><a href="#cb49-1673" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"A climate change scenario with :::emission_level::: emissions by **:::horizon:::** has a **:::change_type:::** impact on yield of :::impact_pct:::  :::change_unit:::"</span><span class="op">,</span></span>
<span id="cb49-1674"><a href="#cb49-1674" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Un scénario de changement climatique avec des :::emission_level::: d'ici **:::horizon:::** a un impact **:::change_type:::** sur le rendement de :::impact_pct:::  :::change_unit:::"</span><span class="op">,</span></span>
<span id="cb49-1675"><a href="#cb49-1675" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-1676"><a href="#cb49-1676" aria-hidden="true" tabindex="-1"></a>      <span class="dt">insight3</span><span class="op">:</span> {</span>
<span id="cb49-1677"><a href="#cb49-1677" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"The projected yield changes arise from simulating yield under various plausible futures, which implies uncertainty. Accordingly, the range of projected changes is **:::minChange:::%** to **:::maxChange:::%** across the climate models used"</span><span class="op">,</span></span>
<span id="cb49-1678"><a href="#cb49-1678" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Les projections de changements de rendement résultent de la simulation du rendement sous divers futurs plausibles, ce qui implique une incertitude. En conséquence, l’intervalle de projection de changement est de **:::minChange:::%** à **:::maxChange:::%** à travers les modèles climatiques utilisés."</span><span class="op">,</span></span>
<span id="cb49-1679"><a href="#cb49-1679" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-1680"><a href="#cb49-1680" aria-hidden="true" tabindex="-1"></a>      <span class="dt">insight4</span><span class="op">:</span> {</span>
<span id="cb49-1681"><a href="#cb49-1681" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Across all of Sub-Saharan Africa, :::geography::: ranks :::rank::: out of :::num::: :::adminLvl::: at the same level, with regard to absolute yield changes"</span><span class="op">,</span></span>
<span id="cb49-1682"><a href="#cb49-1682" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Dans toute l'Afrique subsaharienne, :::geography::: se classe :::rank::: sur :::num::: au même niveau, en ce qui concerne les changements absolus de rendement"</span><span class="op">,</span></span>
<span id="cb49-1683"><a href="#cb49-1683" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-1684"><a href="#cb49-1684" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb49-1685"><a href="#cb49-1685" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb49-1686"><a href="#cb49-1686" aria-hidden="true" tabindex="-1"></a>  <span class="dt">adaptFutureChange</span><span class="op">:</span> {</span>
<span id="cb49-1687"><a href="#cb49-1687" aria-hidden="true" tabindex="-1"></a>    <span class="dt">title</span><span class="op">:</span> {</span>
<span id="cb49-1688"><a href="#cb49-1688" aria-hidden="true" tabindex="-1"></a>      <span class="dt">en</span><span class="op">:</span> <span class="st">"Adapting To The Future Changes"</span><span class="op">,</span></span>
<span id="cb49-1689"><a href="#cb49-1689" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fr</span><span class="op">:</span> <span class="st">"S'adapter aux changements futurs"</span><span class="op">,</span></span>
<span id="cb49-1690"><a href="#cb49-1690" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb49-1691"><a href="#cb49-1691" aria-hidden="true" tabindex="-1"></a>    <span class="dt">text</span><span class="op">:</span> {</span>
<span id="cb49-1692"><a href="#cb49-1692" aria-hidden="true" tabindex="-1"></a>      <span class="dt">en</span><span class="op">:</span> <span class="vs">`Adaptation is no longer optional, it is a must-do for all Sub-Saharan African countries. This section allows exploring some adaptation solutions, and their specific benefits across and within countries in the region.`</span><span class="op">,</span></span>
<span id="cb49-1693"><a href="#cb49-1693" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fr</span><span class="op">:</span> <span class="vs">`L'adaptation n'est plus optionnelle, elle est incontournable pour tous les pays d'Afrique subsaharienne. Cette section permet d'explorer certaines solutions d'adaptation et leurs avantages spécifiques à travers les pays et au sein des pays de la région.`</span><span class="op">,</span></span>
<span id="cb49-1694"><a href="#cb49-1694" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb49-1695"><a href="#cb49-1695" aria-hidden="true" tabindex="-1"></a>    <span class="dt">selectors</span><span class="op">:</span> {</span>
<span id="cb49-1696"><a href="#cb49-1696" aria-hidden="true" tabindex="-1"></a>      <span class="dt">sort</span><span class="op">:</span> {</span>
<span id="cb49-1697"><a href="#cb49-1697" aria-hidden="true" tabindex="-1"></a>        <span class="dt">title</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Sort"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Trier"</span> }<span class="op">,</span></span>
<span id="cb49-1698"><a href="#cb49-1698" aria-hidden="true" tabindex="-1"></a>        <span class="dt">values</span><span class="op">:</span> {</span>
<span id="cb49-1699"><a href="#cb49-1699" aria-hidden="true" tabindex="-1"></a>          <span class="dt">noAdapt</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"No adaptation"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Sans adaptation"</span> }<span class="op">,</span></span>
<span id="cb49-1700"><a href="#cb49-1700" aria-hidden="true" tabindex="-1"></a>          <span class="dt">meanDiff</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Mean difference"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Différence moyenne"</span> }<span class="op">,</span></span>
<span id="cb49-1701"><a href="#cb49-1701" aria-hidden="true" tabindex="-1"></a>          <span class="dt">alphabet</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Alphabetical"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Alphabétique"</span> }<span class="op">,</span></span>
<span id="cb49-1702"><a href="#cb49-1702" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb49-1703"><a href="#cb49-1703" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-1704"><a href="#cb49-1704" aria-hidden="true" tabindex="-1"></a>      <span class="dt">confidence</span><span class="op">:</span> {</span>
<span id="cb49-1705"><a href="#cb49-1705" aria-hidden="true" tabindex="-1"></a>        <span class="dt">title</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Confidence intervals"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Intervalles de confiance"</span> }<span class="op">,</span></span>
<span id="cb49-1706"><a href="#cb49-1706" aria-hidden="true" tabindex="-1"></a>        <span class="dt">visible</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Visible"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Visible"</span> }<span class="op">,</span> <span class="co">// Added in even though same to make adding/updating easier</span></span>
<span id="cb49-1707"><a href="#cb49-1707" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-1708"><a href="#cb49-1708" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb49-1709"><a href="#cb49-1709" aria-hidden="true" tabindex="-1"></a>    <span class="dt">plot</span><span class="op">:</span> {</span>
<span id="cb49-1710"><a href="#cb49-1710" aria-hidden="true" tabindex="-1"></a>      <span class="dt">yAxis</span><span class="op">:</span> {</span>
<span id="cb49-1711"><a href="#cb49-1711" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Late maturity, irrigation"</span><span class="op">:</span> {</span>
<span id="cb49-1712"><a href="#cb49-1712" aria-hidden="true" tabindex="-1"></a>          <span class="dt">en</span><span class="op">:</span> <span class="st">"Late maturity - irrigation"</span><span class="op">,</span></span>
<span id="cb49-1713"><a href="#cb49-1713" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fr</span><span class="op">:</span> <span class="st">"Maturité tardive - irrigation"</span><span class="op">,</span></span>
<span id="cb49-1714"><a href="#cb49-1714" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb49-1715"><a href="#cb49-1715" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Current cultivar, irrigation"</span><span class="op">:</span> {</span>
<span id="cb49-1716"><a href="#cb49-1716" aria-hidden="true" tabindex="-1"></a>          <span class="dt">en</span><span class="op">:</span> <span class="st">"Current cultivar - irrigation"</span><span class="op">,</span></span>
<span id="cb49-1717"><a href="#cb49-1717" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fr</span><span class="op">:</span> <span class="st">"Cultivar actuel - irrigation"</span><span class="op">,</span></span>
<span id="cb49-1718"><a href="#cb49-1718" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb49-1719"><a href="#cb49-1719" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Early maturity, irrigation"</span><span class="op">:</span> {</span>
<span id="cb49-1720"><a href="#cb49-1720" aria-hidden="true" tabindex="-1"></a>          <span class="dt">en</span><span class="op">:</span> <span class="st">"Early maturity - irrigation"</span><span class="op">,</span></span>
<span id="cb49-1721"><a href="#cb49-1721" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fr</span><span class="op">:</span> <span class="st">"Maturité précoce - irrigation"</span><span class="op">,</span></span>
<span id="cb49-1722"><a href="#cb49-1722" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb49-1723"><a href="#cb49-1723" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Late maturity, no irrigation"</span><span class="op">:</span> {</span>
<span id="cb49-1724"><a href="#cb49-1724" aria-hidden="true" tabindex="-1"></a>          <span class="dt">en</span><span class="op">:</span> <span class="st">"Late maturity - no irrigation"</span><span class="op">,</span></span>
<span id="cb49-1725"><a href="#cb49-1725" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fr</span><span class="op">:</span> <span class="st">"Maturité tardive - sans irrigation"</span><span class="op">,</span></span>
<span id="cb49-1726"><a href="#cb49-1726" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb49-1727"><a href="#cb49-1727" aria-hidden="true" tabindex="-1"></a>        <span class="st">"No adaptation"</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"No adaptation"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Sans adaptation"</span> }<span class="op">,</span></span>
<span id="cb49-1728"><a href="#cb49-1728" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Early maturity, no irrigation"</span><span class="op">:</span> {</span>
<span id="cb49-1729"><a href="#cb49-1729" aria-hidden="true" tabindex="-1"></a>          <span class="dt">en</span><span class="op">:</span> <span class="st">"Early maturity - no irrigation"</span><span class="op">,</span></span>
<span id="cb49-1730"><a href="#cb49-1730" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fr</span><span class="op">:</span> <span class="st">"Maturité précoce - sans irrigation"</span><span class="op">,</span></span>
<span id="cb49-1731"><a href="#cb49-1731" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb49-1732"><a href="#cb49-1732" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-1733"><a href="#cb49-1733" aria-hidden="true" tabindex="-1"></a>      <span class="dt">xAxis</span><span class="op">:</span> {</span>
<span id="cb49-1734"><a href="#cb49-1734" aria-hidden="true" tabindex="-1"></a>        <span class="dt">title</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Yield (ton/ha)"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Rendement (tonnes/ha)"</span> }<span class="op">,</span></span>
<span id="cb49-1735"><a href="#cb49-1735" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-1736"><a href="#cb49-1736" aria-hidden="true" tabindex="-1"></a>      <span class="dt">channels</span><span class="op">:</span> {</span>
<span id="cb49-1737"><a href="#cb49-1737" aria-hidden="true" tabindex="-1"></a>        <span class="dt">aez</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Horizon"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Horizon"</span> }<span class="op">,</span></span>
<span id="cb49-1738"><a href="#cb49-1738" aria-hidden="true" tabindex="-1"></a>        <span class="dt">nObs</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Observations"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Observations"</span> }<span class="op">,</span></span>
<span id="cb49-1739"><a href="#cb49-1739" aria-hidden="true" tabindex="-1"></a>        <span class="dt">diff</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Mean"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Moyenne"</span> }<span class="op">,</span> <span class="co">// Was mean difference but it is actuall just mean value</span></span>
<span id="cb49-1740"><a href="#cb49-1740" aria-hidden="true" tabindex="-1"></a>        <span class="dt">control</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Mean control"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Moyenne du témoin"</span> }<span class="op">,</span></span>
<span id="cb49-1741"><a href="#cb49-1741" aria-hidden="true" tabindex="-1"></a>        <span class="dt">prac</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"adaptation"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Adaptation"</span> }<span class="op">,</span></span>
<span id="cb49-1742"><a href="#cb49-1742" aria-hidden="true" tabindex="-1"></a>        <span class="dt">ciLow</span><span class="op">:</span> {</span>
<span id="cb49-1743"><a href="#cb49-1743" aria-hidden="true" tabindex="-1"></a>          <span class="dt">en</span><span class="op">:</span> <span class="st">"Lower Confidence interval"</span><span class="op">,</span></span>
<span id="cb49-1744"><a href="#cb49-1744" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fr</span><span class="op">:</span> <span class="st">"Intervalle de confiance inférieur"</span><span class="op">,</span></span>
<span id="cb49-1745"><a href="#cb49-1745" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb49-1746"><a href="#cb49-1746" aria-hidden="true" tabindex="-1"></a>        <span class="dt">ciHigh</span><span class="op">:</span> {</span>
<span id="cb49-1747"><a href="#cb49-1747" aria-hidden="true" tabindex="-1"></a>          <span class="dt">en</span><span class="op">:</span> <span class="st">"Upper Confidence interval"</span><span class="op">,</span></span>
<span id="cb49-1748"><a href="#cb49-1748" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fr</span><span class="op">:</span> <span class="st">"Intervalle de confiance supérieur"</span><span class="op">,</span></span>
<span id="cb49-1749"><a href="#cb49-1749" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb49-1750"><a href="#cb49-1750" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-1751"><a href="#cb49-1751" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb49-1752"><a href="#cb49-1752" aria-hidden="true" tabindex="-1"></a>    <span class="dt">insight</span><span class="op">:</span> {</span>
<span id="cb49-1753"><a href="#cb49-1753" aria-hidden="true" tabindex="-1"></a>      <span class="dt">title</span><span class="op">:</span> {</span>
<span id="cb49-1754"><a href="#cb49-1754" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Quick Insights for :::geography:::, :::scenario_name::: scenario, and :::crop_name:::"</span><span class="op">,</span></span>
<span id="cb49-1755"><a href="#cb49-1755" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Aperçu rapide pour la région de :::geography:::, sous :::scenario_name::: pour les cultures de :::crop_name:::"</span><span class="op">,</span></span>
<span id="cb49-1756"><a href="#cb49-1756" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-1757"><a href="#cb49-1757" aria-hidden="true" tabindex="-1"></a>      <span class="dt">insight1</span><span class="op">:</span> {</span>
<span id="cb49-1758"><a href="#cb49-1758" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">":::selected_geo:::'s adaptation analysis show that :::numBetter::: options would generate yield improvements for historical and future periods. These improvements vary between :::lowerBest::: (ton/ha) to :::upperBest::: (ton/ha) compared to no adaptation"</span><span class="op">,</span></span>
<span id="cb49-1759"><a href="#cb49-1759" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"L'analyse d'adaptation :::selected_geo::: montre que :::numBetter::: options généreraient des améliorations de rendement pour les périodes historiques et futures. Ces améliorations varient entre :::lowerBest::: (tonnes/ha) - :::upperBest::: (tonnes/ha) par rapport à l'absence d'adaptation."</span><span class="op">,</span></span>
<span id="cb49-1760"><a href="#cb49-1760" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-1761"><a href="#cb49-1761" aria-hidden="true" tabindex="-1"></a>      <span class="dt">insight2</span><span class="op">:</span> {</span>
<span id="cb49-1762"><a href="#cb49-1762" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Adaptation options with the greatest benefits include :::bestOptions:::, which together can generate yield gains of up to :::maxImprovement::: ton/ha compared to a no adaptation situation"</span><span class="op">,</span></span>
<span id="cb49-1763"><a href="#cb49-1763" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Les options d'adaptation avec les plus grands bénéfices incluent :::bestOptions:::, qui ensemble peuvent générer des gains de rendement allant jusqu'à :::maxImprovement::: (tonne/ha) par rapport à une situation sans adaptation."</span><span class="op">,</span></span>
<span id="cb49-1764"><a href="#cb49-1764" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-1765"><a href="#cb49-1765" aria-hidden="true" tabindex="-1"></a>      <span class="dt">insight3</span><span class="op">:</span> {</span>
<span id="cb49-1766"><a href="#cb49-1766" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Explore more adaptation options for a greater number of crops and systems at our notebook on [On-farm Solutions for Today](https://observablehq.com/d/7539fd16f4fc40e3)"</span><span class="op">,</span></span>
<span id="cb49-1767"><a href="#cb49-1767" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Explorez plus d'options d'adaptation pour un plus grand nombre de cultures et de systèmes dans notre notebook sur [les solutions agricoles pour aujourd'hui](https://observablehq.com/d/7539fd16f4fc40e3)"</span><span class="op">,</span></span>
<span id="cb49-1768"><a href="#cb49-1768" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-1769"><a href="#cb49-1769" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb49-1770"><a href="#cb49-1770" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb49-1771"><a href="#cb49-1771" aria-hidden="true" tabindex="-1"></a>  <span class="dt">summary</span><span class="op">:</span> {</span>
<span id="cb49-1772"><a href="#cb49-1772" aria-hidden="true" tabindex="-1"></a>    <span class="dt">title</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Summary"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Résumé"</span> }<span class="op">,</span></span>
<span id="cb49-1773"><a href="#cb49-1773" aria-hidden="true" tabindex="-1"></a>    <span class="dt">text1</span><span class="op">:</span> {</span>
<span id="cb49-1774"><a href="#cb49-1774" aria-hidden="true" tabindex="-1"></a>      <span class="dt">en</span><span class="op">:</span> <span class="st">"Climate change without adaptation implies a reduction of :::avg_loss:::% in the supply of cereal grains in Sub-Saharan Africa"</span><span class="op">,</span></span>
<span id="cb49-1775"><a href="#cb49-1775" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fr</span><span class="op">:</span> <span class="st">"Le changement climatique sans adaptation implique une réduction de :::avg_loss:::% de l'approvisionnement en céréales en Afrique subsaharienne."</span><span class="op">,</span></span>
<span id="cb49-1776"><a href="#cb49-1776" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb49-1777"><a href="#cb49-1777" aria-hidden="true" tabindex="-1"></a>    <span class="dt">text2</span><span class="op">:</span> {</span>
<span id="cb49-1778"><a href="#cb49-1778" aria-hidden="true" tabindex="-1"></a>      <span class="dt">en</span><span class="op">:</span> <span class="vs">`Specifically in :::selectedGeo:::, these reductions would come on top of already low yields from inadequate crop management. Adaptation investments should target **:::bestOptions:::** to reduce downstream risks of food insecurity, hunger, and poverty that may stem from projected yield reductions.`</span><span class="op">,</span></span>
<span id="cb49-1779"><a href="#cb49-1779" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fr</span><span class="op">:</span> <span class="vs">`En particulier :::selectedGeo:::, ces réductions s'ajouteraient à des rendements déjà faibles dus à une gestion inadéquate des cultures. Les investissements dans l'adaptation devraient cibler  **:::bestOptions:::** pour réduire les risques en aval d'insécurité alimentaire, de faim et de pauvreté qui pourraient découler des réductions de rendement projetées.`</span><span class="op">,</span></span>
<span id="cb49-1780"><a href="#cb49-1780" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb49-1781"><a href="#cb49-1781" aria-hidden="true" tabindex="-1"></a>    <span class="dt">adaptationOptions</span><span class="op">:</span> {</span>
<span id="cb49-1782"><a href="#cb49-1782" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Late maturity, irrigation"</span><span class="op">:</span> {</span>
<span id="cb49-1783"><a href="#cb49-1783" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"late maturity with irrigation"</span><span class="op">,</span></span>
<span id="cb49-1784"><a href="#cb49-1784" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"maturité tardive avec irrigation"</span><span class="op">,</span></span>
<span id="cb49-1785"><a href="#cb49-1785" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-1786"><a href="#cb49-1786" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Current cultivar, irrigation"</span><span class="op">:</span> {</span>
<span id="cb49-1787"><a href="#cb49-1787" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"current cultivar with irrigation"</span><span class="op">,</span></span>
<span id="cb49-1788"><a href="#cb49-1788" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"cultivar actuel avec irrigation"</span><span class="op">,</span></span>
<span id="cb49-1789"><a href="#cb49-1789" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-1790"><a href="#cb49-1790" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Early maturity, irrigation"</span><span class="op">:</span> {</span>
<span id="cb49-1791"><a href="#cb49-1791" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"early maturity with irrigation"</span><span class="op">,</span></span>
<span id="cb49-1792"><a href="#cb49-1792" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"maturité précoce avec irrigation"</span><span class="op">,</span></span>
<span id="cb49-1793"><a href="#cb49-1793" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-1794"><a href="#cb49-1794" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Late maturity, no irrigation"</span><span class="op">:</span> {</span>
<span id="cb49-1795"><a href="#cb49-1795" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"late maturity with no irrigation"</span><span class="op">,</span></span>
<span id="cb49-1796"><a href="#cb49-1796" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"maturité tardive sans irrigation"</span><span class="op">,</span></span>
<span id="cb49-1797"><a href="#cb49-1797" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-1798"><a href="#cb49-1798" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Early maturity, no irrigation"</span><span class="op">:</span> {</span>
<span id="cb49-1799"><a href="#cb49-1799" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"early maturity with no irrigation"</span><span class="op">,</span></span>
<span id="cb49-1800"><a href="#cb49-1800" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"maturité précoce sans irrigation"</span><span class="op">,</span></span>
<span id="cb49-1801"><a href="#cb49-1801" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-1802"><a href="#cb49-1802" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb49-1803"><a href="#cb49-1803" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb49-1804"><a href="#cb49-1804" aria-hidden="true" tabindex="-1"></a>  <span class="dt">MethodsSources</span><span class="op">:</span> {</span>
<span id="cb49-1805"><a href="#cb49-1805" aria-hidden="true" tabindex="-1"></a>    <span class="dt">title</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Methods &amp; Sources"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Méthodes et sources"</span> }<span class="op">,</span></span>
<span id="cb49-1806"><a href="#cb49-1806" aria-hidden="true" tabindex="-1"></a>    <span class="dt">sources</span><span class="op">:</span> {</span>
<span id="cb49-1807"><a href="#cb49-1807" aria-hidden="true" tabindex="-1"></a>      <span class="dt">title</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Datasets"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Jeux de données"</span> }<span class="op">,</span></span>
<span id="cb49-1808"><a href="#cb49-1808" aria-hidden="true" tabindex="-1"></a>      <span class="dt">cropYieldDB</span><span class="op">:</span> {</span>
<span id="cb49-1809"><a href="#cb49-1809" aria-hidden="true" tabindex="-1"></a>        <span class="dt">title</span><span class="op">:</span> {</span>
<span id="cb49-1810"><a href="#cb49-1810" aria-hidden="true" tabindex="-1"></a>          <span class="dt">en</span><span class="op">:</span> <span class="st">"Crop yield meta-analysis database"</span><span class="op">,</span></span>
<span id="cb49-1811"><a href="#cb49-1811" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fr</span><span class="op">:</span> <span class="st">"Base de données de méta-analyse des rendements des cultures"</span><span class="op">,</span></span>
<span id="cb49-1812"><a href="#cb49-1812" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb49-1813"><a href="#cb49-1813" aria-hidden="true" tabindex="-1"></a>        <span class="dt">text</span><span class="op">:</span> {</span>
<span id="cb49-1814"><a href="#cb49-1814" aria-hidden="true" tabindex="-1"></a>          <span class="dt">en</span><span class="op">:</span> <span class="vs">`The crop yield meta analysis dataset is from [Hasegawa et al. (2022)](https://doi.org/10.1038/s41597-022-01150-7). This dataset compiles estimates of climate change impacts on crop productivity derived from crop simulations under historical and future climates, with and without adaptation. The climate change impact estimates are derived from a comprehensive literature review of 202 studies published between 1984 and 2020. The dataset includes a total of 8,703 individual simulations, covers four crops (maize, rice, soybean, and wheat), and extends to 91 countries across the globe. The data include crop yield estimates under historical and future climates (for various emissions trajectories), current and future temperature and precipitation levels, and the use (or not) of adaptation options.`</span><span class="op">,</span></span>
<span id="cb49-1815"><a href="#cb49-1815" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fr</span><span class="op">:</span> <span class="vs">`Le jeu de données de méta-analyse des rendements des cultures provient de [Hasegawa et al. (2022)](https://doi.org/10.1038/s41597-022-01150-7). Ce jeu de données compile des estimations des impacts du changement climatique sur la productivité des cultures dérivées de simulations de cultures sous climats historiques et futurs, avec et sans adaptation. Les estimations des impacts du changement climatique sont dérivées d'une revue complète de la littérature de 202 études publiées entre 1984 et 2020. Le jeu de données inclut un total de 8 703 simulations individuelles, couvre quatre cultures (maïs, riz, soja et blé), et s'étend à 91 pays à travers le monde. Les données comprennent des estimations des rendements des cultures sous climats historiques et futurs (pour divers scénarios d'émissions), les niveaux actuels et futurs de température et de précipitations, et l'utilisation (ou non) des options d'adaptation.`</span><span class="op">,</span></span>
<span id="cb49-1816"><a href="#cb49-1816" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb49-1817"><a href="#cb49-1817" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-1818"><a href="#cb49-1818" aria-hidden="true" tabindex="-1"></a>      <span class="dt">cropYieldProjections</span><span class="op">:</span> {</span>
<span id="cb49-1819"><a href="#cb49-1819" aria-hidden="true" tabindex="-1"></a>        <span class="dt">title</span><span class="op">:</span> {</span>
<span id="cb49-1820"><a href="#cb49-1820" aria-hidden="true" tabindex="-1"></a>          <span class="dt">en</span><span class="op">:</span> <span class="st">"Crop yield projections for cereals under climate change and adaptation"</span><span class="op">,</span></span>
<span id="cb49-1821"><a href="#cb49-1821" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fr</span><span class="op">:</span> <span class="st">"Projections de rendements des céréales sous l'effet du changement climatique et de l'adaptation"</span><span class="op">,</span></span>
<span id="cb49-1822"><a href="#cb49-1822" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb49-1823"><a href="#cb49-1823" aria-hidden="true" tabindex="-1"></a>        <span class="dt">text</span><span class="op">:</span> {</span>
<span id="cb49-1824"><a href="#cb49-1824" aria-hidden="true" tabindex="-1"></a>          <span class="dt">en</span><span class="op">:</span> <span class="vs">`The historical and future simulated crop yield for maize, sorghum, millet, and wheat were derived from the [Global Yield Gap Atlas (GYGA)](https://www.yieldgap.org/). The method for deriving these data is described by [Alimagham et al. (2024)](https://doi.org/10.1016/j.eja.2024.127137). In brief, the WOFOST (World Food Studies) crop model is used to simulate water-limited and potential (i.e., irrigated) production of each of the four crops across 109 reference weather station locations in Sub-Saharan Africa. The historical weather data (1995–2014) were derived from local weather stations, whereas the future climate data for 2030 (2021-2040) and 2050 (2041–2060) are from bias-corrected General Circulation Models (GCMs) from the Coordinated Modelling Intercomparison Project-Phase 6 (CMIP6). The GCMs were GFDL-ESM4, IPSL-CM6A-LR, MPI-ESM1–2-HR, MRI-ESM2–0, and UKESM1–0-LL. Two Shared Socioeconomic Pathways (SSPs) were used, namely, SSP3-7.0 and SSP5-8.5. The bias correction of the future weather data uses the delta method, as documented by [Navarro-Racines et al. (2020)](https://doi.org/10.1038/s41597-019-0343-8). Carbon dioxide (CO2) concentrations were specified for each future scenario and time period.</span></span>
<span id="cb49-1825"><a href="#cb49-1825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1826"><a href="#cb49-1826" aria-hidden="true" tabindex="-1"></a><span class="vs">The crop model also requires soil and management (cultivar, planting dates) data as inputs. These data are available through the GYGA portal. Originally, these data have been collected and evaluated through an extensive network of agronomists and crop modelers that make part of the GYGA project. Cultivars are specified using thermal times derived from locally available planting, flowering, and maturity times. In addition to current cultivars, simulations are also conducted for ‘late maturity’ (12% longer thermal time) and ‘early maturity’ (12% shorter thermal time) cultivars. Soil data were obtained from the Africa Soil Information Service ([AfSIS](https://www.isric.org/projects/africa-soil-information-service-afsis)). At each weather station location, estimates of yield, phenology (planting, flowering, harvest time) were used into a random forest (RF) regressor that helped create extrapolated estimates of yield and phenology across the entirety of Sub-Saharan Africa using gridded weather data from elsewhere in the continent. The RF regressor explains over 90% of the variance in the WOFOST simulated yield, tested out of sample across scenarios and locations.</span></span>
<span id="cb49-1827"><a href="#cb49-1827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1828"><a href="#cb49-1828" aria-hidden="true" tabindex="-1"></a><span class="vs">GYGA simulated crop yield reports two types of adaptations, namely, shifts in cultivars, and irrigation. For cultivars, early and late maturity (in addition to currently used cultivars) are reported. For irrigation, a fully irrigated crop model simulation is available. The full combinatorial (i.e., each cultivar with and without irrigation) of these is available. This allows exploring five adaptation scenarios, in addition to the no adaptation (i.e., rainfed, current cultivar) scenario. All GYGA data are available at  https://www.yieldgap.org/. Specific licensing arrangements depending on user and/or institution type are described [here](https://www.yieldgap.org/web/guest/subscription-and-service).`</span><span class="op">,</span></span>
<span id="cb49-1829"><a href="#cb49-1829" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fr</span><span class="op">:</span> <span class="vs">`Les rendements historiques et futurs simulés pour le maïs, le sorgho, le millet et le blé ont été dérivés du [Global Yield Gap Atlas (GYGA)](https://www.yieldgap.org/). La méthode pour obtenir ces données est décrite par [Alimagham et al. (2024)](https://doi.org/10.1016/j.eja.2024.127137). En résumé, le modèle de culture WOFOST (World Food Studies) est utilisé pour simuler la production sous contrainte hydrique et la production potentielle (c'est-à-dire irriguée) de chacune des quatre cultures dans 109 stations météorologiques de référence en Afrique subsaharienne. Les données météorologiques historiques (1995-2014) proviennent de stations météorologiques locales, tandis que les données climatiques futures pour 2030 (2021-2040) et 2050 (2041-2060) proviennent de modèles de circulation générale (GCM) corrigés des biais du projet de comparaison de modèles coordonnés - Phase 6 (CMIP6). Les GCM utilisés étaient GFDL-ESM4, IPSL-CM6A-LR, MPI-ESM1-2-HR, MRI-ESM2-0, et UKESM1-0-LL. Deux trajectoires socio-économiques partagées (SSP) ont été utilisées, à savoir SSP3-7.0 et SSP5-8.5. La correction des biais des données climatiques futures utilise la méthode delta, comme documenté par [Navarro-Racines et al. (2020)](https://doi.org/10.1038/s41597-019-0343-8). Les concentrations de dioxyde de carbone (CO2) étaient spécifiées pour chaque scénario futur et chaque période.</span></span>
<span id="cb49-1830"><a href="#cb49-1830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1831"><a href="#cb49-1831" aria-hidden="true" tabindex="-1"></a><span class="vs">Le modèle de culture nécessite également des données sur le sol et la gestion (cultivar, dates de plantation) comme entrées. Ces données sont disponibles via le portail GYGA. À l'origine, ces données ont été collectées et évaluées grâce à un vaste réseau d'agronomes et de modélisateurs de cultures faisant partie du projet GYGA. Les cultivars sont spécifiés en utilisant les temps thermiques dérivés des périodes de plantation, de floraison et de maturité disponibles localement. En plus des cultivars actuels, des simulations sont également effectuées pour des cultivars de "maturité tardive" (temps thermique 12% plus long) et de "maturité précoce" (temps thermique 12% plus court). Les données sur les sols ont été obtenues auprès du service d'information sur les sols en Afrique ([AfSIS](https://www.isric.org/projects/africa-soil-information-service-afsis)). À chaque station météorologique, les estimations de rendement et de phénologie (plantation, floraison, récolte) ont été utilisées dans un régressif par forêt aléatoire (RF) qui a permis de créer des estimations extrapolées de rendement et de phénologie pour l'ensemble de l'Afrique subsaharienne en utilisant des données météorologiques maillées provenant d'ailleurs sur le continent. Le régressif RF explique plus de 90% de la variance dans le rendement simulé par WOFOST, testé hors échantillon à travers des scénarios et des lieux.</span></span>
<span id="cb49-1832"><a href="#cb49-1832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-1833"><a href="#cb49-1833" aria-hidden="true" tabindex="-1"></a><span class="vs">GYGA rapporte deux types d'adaptations pour les rendements simulés, à savoir les changements de cultivars et l'irrigation. Pour les cultivars, les maturités précoce et tardive (en plus des cultivars actuellement utilisés) sont rapportées. Pour l'irrigation, une simulation de modèle de culture entièrement irriguée est disponible. La combinaison complète (c'est-à-dire chaque cultivar avec et sans irrigation) de ces scénarios est disponible. Cela permet d'explorer cinq scénarios d'adaptation, en plus du scénario sans adaptation (c'est-à-dire pluvial, cultivar actuel). Toutes les données GYGA sont disponibles sur https://www.yieldgap.org/. Les arrangements de licence spécifiques en fonction du type d'utilisateur et/ou d'institution sont décrits [ici](https://www.yieldgap.org/web/guest/subscription-and-service).`</span><span class="op">,</span></span>
<span id="cb49-1834"><a href="#cb49-1834" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb49-1835"><a href="#cb49-1835" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-1836"><a href="#cb49-1836" aria-hidden="true" tabindex="-1"></a>      <span class="dt">harvestedArea</span><span class="op">:</span> {</span>
<span id="cb49-1837"><a href="#cb49-1837" aria-hidden="true" tabindex="-1"></a>        <span class="dt">title</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Harvested Area"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Superficie récoltée"</span> }<span class="op">,</span></span>
<span id="cb49-1838"><a href="#cb49-1838" aria-hidden="true" tabindex="-1"></a>        <span class="dt">text</span><span class="op">:</span> {</span>
<span id="cb49-1839"><a href="#cb49-1839" aria-hidden="true" tabindex="-1"></a>          <span class="dt">en</span><span class="op">:</span> <span class="vs">`[Harvested area data](https://radiantearth.github.io/stac-browser/#/external/digital-atlas.s3.amazonaws.com/stac/public_stac/exposure_catalog/mapspam2017/crop_ha/crop_ha.json) comes from  MapSPAM 2017 V2r3 (Spatial Production Allocation Model). This dataset is an updated version of MapSPAM specifically tailored for this project. It includes bug fixes and incorporates more data sources and at greater resolution. The MapSPAM methodology is fully documented by [Yu et al. (2020)](https://doi.org/10.5194/essd-2020-11).`</span><span class="op">,</span></span>
<span id="cb49-1840"><a href="#cb49-1840" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fr</span><span class="op">:</span> <span class="vs">`[Les données de superficie récoltée](https://radiantearth.github.io/stac-browser/#/external/digital-atlas.s3.amazonaws.com/stac/public_stac/exposure_catalog/mapspam2017/crop_ha/crop_ha.json?.language=fr) proviennent de MapSPAM 2017 V2r3 (Spatial Production Allocation Model). Ce jeu de données est une version mise à jour de MapSPAM spécifiquement adaptée à ce projet. Il comprend des corrections de bogues et intègre davantage de sources de données avec une résolution plus élevée. La méthodologie de MapSPAM est entièrement documentée par [Yu et al. (2020)](https://doi.org/10.5194/essd-2020-11).`</span><span class="op">,</span></span>
<span id="cb49-1841"><a href="#cb49-1841" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb49-1842"><a href="#cb49-1842" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-1843"><a href="#cb49-1843" aria-hidden="true" tabindex="-1"></a>      <span class="dt">boundaries</span><span class="op">:</span> {</span>
<span id="cb49-1844"><a href="#cb49-1844" aria-hidden="true" tabindex="-1"></a>        <span class="dt">title</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Boundaries"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Délimitations"</span> }<span class="op">,</span></span>
<span id="cb49-1845"><a href="#cb49-1845" aria-hidden="true" tabindex="-1"></a>        <span class="dt">text</span><span class="op">:</span> {</span>
<span id="cb49-1846"><a href="#cb49-1846" aria-hidden="true" tabindex="-1"></a>          <span class="dt">en</span><span class="op">:</span> <span class="vs">`[Administrative areas](https://radiantearth.github.io/stac-browser/#/external/digital-atlas.s3.amazonaws.com/stac/public_stac/boundary_catalog/geoBoundaries_SSA/collection.json) used in this notebook come from [geoBoundaries 6.0.0](https://github.com/wmgeolab/geoBoundaries). The gbHumanitarian boundaries are used and if not available then the gbOpen boundaries are substituted.`</span><span class="op">,</span></span>
<span id="cb49-1847"><a href="#cb49-1847" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fr</span><span class="op">:</span> <span class="vs">`[Les zones administratives](https://radiantearth.github.io/stac-browser/#/external/digital-atlas.s3.amazonaws.com/stac/public_stac/boundary_catalog/geoBoundaries_SSA/collection.json?.language=fr) utilisées dans ce notebook proviennent de [geoBoundaries 6.0.0](https://github.com/wmgeolab/geoBoundaries). Les frontières gbHumanitarian sont utilisées et, si elles ne sont pas disponibles, les frontières gbOpen sont substituées.`</span><span class="op">,</span></span>
<span id="cb49-1848"><a href="#cb49-1848" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb49-1849"><a href="#cb49-1849" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-1850"><a href="#cb49-1850" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb49-1851"><a href="#cb49-1851" aria-hidden="true" tabindex="-1"></a>    <span class="dt">methods</span><span class="op">:</span> {</span>
<span id="cb49-1852"><a href="#cb49-1852" aria-hidden="true" tabindex="-1"></a>      <span class="dt">title</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Methods"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Méthodologie"</span> }<span class="op">,</span></span>
<span id="cb49-1853"><a href="#cb49-1853" aria-hidden="true" tabindex="-1"></a>      <span class="dt">beeswarm</span><span class="op">:</span> {</span>
<span id="cb49-1854"><a href="#cb49-1854" aria-hidden="true" tabindex="-1"></a>        <span class="dt">title</span><span class="op">:</span> {</span>
<span id="cb49-1855"><a href="#cb49-1855" aria-hidden="true" tabindex="-1"></a>          <span class="dt">en</span><span class="op">:</span> <span class="st">"Crop yield meta analysis (beeswarm plot)"</span><span class="op">,</span></span>
<span id="cb49-1856"><a href="#cb49-1856" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fr</span><span class="op">:</span> <span class="st">"Méta-analyse des rendements des cultures (diagramme de nuage de points)"</span><span class="op">,</span></span>
<span id="cb49-1857"><a href="#cb49-1857" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb49-1858"><a href="#cb49-1858" aria-hidden="true" tabindex="-1"></a>        <span class="dt">text</span><span class="op">:</span> {</span>
<span id="cb49-1859"><a href="#cb49-1859" aria-hidden="true" tabindex="-1"></a>          <span class="dt">en</span><span class="op">:</span> <span class="vs">`We produced a beeswarm plot that shows the individual estimates of crop yield from the meta-analysis dataset. We subset the original dataset to cover only Sub-Saharan Africa (SSA), and display data per region within SSA. We allow splits of the data for visualization by warming levels, crops, and adaptation (with and without adaptation).`</span><span class="op">,</span></span>
<span id="cb49-1860"><a href="#cb49-1860" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fr</span><span class="op">:</span> <span class="vs">`Nous avons produit un diagramme de nuage de points qui montre les estimations individuelles des rendements des cultures à partir du jeu de données de méta-analyse. Nous avons extrait un sous-ensemble du jeu de données original pour ne couvrir que l'Afrique subsaharienne (SSA), et afficher les données par région au sein de la SSA. Nous permettons de diviser les données pour la visualisation par niveaux de réchauffement, cultures, et adaptation (avec et sans adaptation).`</span><span class="op">,</span></span>
<span id="cb49-1861"><a href="#cb49-1861" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb49-1862"><a href="#cb49-1862" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-1863"><a href="#cb49-1863" aria-hidden="true" tabindex="-1"></a>      <span class="dt">mappingHistoricalFuture</span><span class="op">:</span> {</span>
<span id="cb49-1864"><a href="#cb49-1864" aria-hidden="true" tabindex="-1"></a>        <span class="dt">title</span><span class="op">:</span> {</span>
<span id="cb49-1865"><a href="#cb49-1865" aria-hidden="true" tabindex="-1"></a>          <span class="dt">en</span><span class="op">:</span> <span class="st">"Mapping historical and future projected crop yields"</span><span class="op">,</span></span>
<span id="cb49-1866"><a href="#cb49-1866" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fr</span><span class="op">:</span> <span class="st">"Cartographie des rendements des cultures historiques et projetés futurs"</span><span class="op">,</span></span>
<span id="cb49-1867"><a href="#cb49-1867" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb49-1868"><a href="#cb49-1868" aria-hidden="true" tabindex="-1"></a>        <span class="dt">text</span><span class="op">:</span> {</span>
<span id="cb49-1869"><a href="#cb49-1869" aria-hidden="true" tabindex="-1"></a>          <span class="dt">en</span><span class="op">:</span> <span class="vs">`We aggregate GYGA’s crop yield projections at three administrative levels, namely, national, subnational level 1 (referred to as region across the notebook), and subnational level 2 (referred to as subregion across the notebook). The aggregation uses the weighted average of the crop yield and the harvested area present within the point location where a WOFOST simulation has been conducted, within the respective administrative boundaries. Data aggregation is done for rainfed and irrigated crop yields, for each crop, and for each scenario (period and Shared Socioeconomic Pathway –SSP) separately. Four indicators are mapped, namely, the average yield (in ton/ha), the yield change (in ton/ha), yield change (in percentage), and the uncertainty in yield (in ton/ha). For the latter, the individual climate model projections are used to compute the range (max. – min.) across the individual GCM projections.`</span><span class="op">,</span></span>
<span id="cb49-1870"><a href="#cb49-1870" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fr</span><span class="op">:</span> <span class="vs">`Nous agrégeons les projections de rendement des cultures de GYGA à trois niveaux administratifs, à savoir, national, sous-national niveau 1 (appelé région dans le notebook), et sous-national niveau 2 (appelé sous-région dans le notebook). L'agrégation utilise la moyenne pondérée du rendement des cultures et de la superficie récoltée présente à l'emplacement où une simulation WOFOST a été réalisée, dans les limites administratives respectives. L'agrégation des données est effectuée pour les rendements des cultures en sec et irriguées, pour chaque culture, et pour chaque scénario (période et Trajectoire Socio-économique Partagée – SSP) séparément. Quatre indicateurs sont cartographiés, à savoir, le rendement moyen (en tonnes/ha), le changement de rendement (en tonnes/ha), le changement de rendement (en pourcentage), et l'incertitude du rendement (en tonnes/ha). Pour ce dernier, les projections individuelles des modèles climatiques sont utilisées pour calculer l'écart (max. – min.) entre les projections individuelles des GCM.`</span><span class="op">,</span></span>
<span id="cb49-1871"><a href="#cb49-1871" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb49-1872"><a href="#cb49-1872" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-1873"><a href="#cb49-1873" aria-hidden="true" tabindex="-1"></a>      <span class="dt">adaptationAnalysis</span><span class="op">:</span> {</span>
<span id="cb49-1874"><a href="#cb49-1874" aria-hidden="true" tabindex="-1"></a>        <span class="dt">title</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Analysis of adaptation"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Analyse de l'adaptation"</span> }<span class="op">,</span></span>
<span id="cb49-1875"><a href="#cb49-1875" aria-hidden="true" tabindex="-1"></a>        <span class="dt">text</span><span class="op">:</span> {</span>
<span id="cb49-1876"><a href="#cb49-1876" aria-hidden="true" tabindex="-1"></a>          <span class="dt">en</span><span class="op">:</span> <span class="vs">`We display the mean yield of each adaptation option as simulated for each of the crops, for each climate scenario, and at different administrative boundary levels, namely, all Sub-Saharan Africa, national, subnational level 1, and subnational level 2. The objective is to provide a clear overview of the simulated yield level in the historical and future scenarios without adaptation, and the comparative performance of the various adaptation solutions against the no adaptation scenario. Crop yield is aggregated using weighted average against the MapSPAM harvested area. Confidence intervals extend to 5–95% of the individual GCMs (of which there are five).`</span><span class="op">,</span></span>
<span id="cb49-1877"><a href="#cb49-1877" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fr</span><span class="op">:</span> <span class="vs">`Nous affichons le rendement moyen de chaque option d'adaptation tel que simulé pour chacune des cultures, pour chaque scénario climatique, et à différents niveaux de limites administratives, à savoir, toute l'Afrique subsaharienne, national, sous-national niveau 1 et sous-national niveau 2. L'objectif est de fournir une vue d'ensemble claire du niveau de rendement simulé dans les scénarios historiques et futurs sans adaptation, et de la performance comparative des différentes solutions d'adaptation par rapport au scénario sans adaptation. Le rendement des cultures est agrégé en utilisant la moyenne pondérée par rapport à la superficie récoltée de MapSPAM. Les intervalles de confiance s'étendent de 5 à 95 % des modèles climatiques globaux (GCM) individuels (dont il y en a cinq).`</span><span class="op">,</span></span>
<span id="cb49-1878"><a href="#cb49-1878" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb49-1879"><a href="#cb49-1879" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-1880"><a href="#cb49-1880" aria-hidden="true" tabindex="-1"></a>      <span class="dt">references</span><span class="op">:</span> {</span>
<span id="cb49-1881"><a href="#cb49-1881" aria-hidden="true" tabindex="-1"></a>        <span class="dt">title</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"References"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Références"</span> }<span class="op">,</span></span>
<span id="cb49-1882"><a href="#cb49-1882" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-1883"><a href="#cb49-1883" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb49-1884"><a href="#cb49-1884" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb49-1885"><a href="#cb49-1885" aria-hidden="true" tabindex="-1"></a>  <span class="dt">appendix</span><span class="op">:</span> {</span>
<span id="cb49-1886"><a href="#cb49-1886" aria-hidden="true" tabindex="-1"></a>    <span class="dt">title</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Appendix"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Annexes"</span> }<span class="op">,</span></span>
<span id="cb49-1887"><a href="#cb49-1887" aria-hidden="true" tabindex="-1"></a>    <span class="dt">text</span><span class="op">:</span> {</span>
<span id="cb49-1888"><a href="#cb49-1888" aria-hidden="true" tabindex="-1"></a>      <span class="dt">en</span><span class="op">:</span> <span class="st">"This large section includes all the cells that power the notebook.This large section includes all the cells that power the notebook."</span><span class="op">,</span></span>
<span id="cb49-1889"><a href="#cb49-1889" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fr</span><span class="op">:</span> <span class="st">"Cette grande section comprend toutes les cellules qui alimentent le notebook"</span><span class="op">,</span></span>
<span id="cb49-1890"><a href="#cb49-1890" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb49-1891"><a href="#cb49-1891" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb49-1892"><a href="#cb49-1892" aria-hidden="true" tabindex="-1"></a>  <span class="dt">general</span><span class="op">:</span> {</span>
<span id="cb49-1893"><a href="#cb49-1893" aria-hidden="true" tabindex="-1"></a>    <span class="dt">positive</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"positive"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"positif"</span> }<span class="op">,</span></span>
<span id="cb49-1894"><a href="#cb49-1894" aria-hidden="true" tabindex="-1"></a>    <span class="dt">negative</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"negative"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"négatif"</span> }<span class="op">,</span></span>
<span id="cb49-1895"><a href="#cb49-1895" aria-hidden="true" tabindex="-1"></a>    <span class="dt">crops</span><span class="op">:</span> {</span>
<span id="cb49-1896"><a href="#cb49-1896" aria-hidden="true" tabindex="-1"></a>      <span class="dt">maize</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Maize"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Maïs"</span> }<span class="op">,</span></span>
<span id="cb49-1897"><a href="#cb49-1897" aria-hidden="true" tabindex="-1"></a>      <span class="dt">rice</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Rice"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Riz"</span> }<span class="op">,</span></span>
<span id="cb49-1898"><a href="#cb49-1898" aria-hidden="true" tabindex="-1"></a>      <span class="dt">wheat</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Wheat"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Blé"</span> }<span class="op">,</span></span>
<span id="cb49-1899"><a href="#cb49-1899" aria-hidden="true" tabindex="-1"></a>      <span class="dt">sorghum</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Sorghum"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Sorgho"</span> }<span class="op">,</span></span>
<span id="cb49-1900"><a href="#cb49-1900" aria-hidden="true" tabindex="-1"></a>      <span class="dt">millet</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Millet"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Millet"</span> }<span class="op">,</span></span>
<span id="cb49-1901"><a href="#cb49-1901" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb49-1902"><a href="#cb49-1902" aria-hidden="true" tabindex="-1"></a>    <span class="dt">crop</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Crop"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Culture"</span> }<span class="op">,</span></span>
<span id="cb49-1903"><a href="#cb49-1903" aria-hidden="true" tabindex="-1"></a>    <span class="dt">country</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Country"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Pays"</span> }<span class="op">,</span></span>
<span id="cb49-1904"><a href="#cb49-1904" aria-hidden="true" tabindex="-1"></a>    <span class="dt">region</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Region"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Région"</span> }<span class="op">,</span></span>
<span id="cb49-1905"><a href="#cb49-1905" aria-hidden="true" tabindex="-1"></a>    <span class="dt">subRegion</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Sub-Region"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Sous-région"</span> }<span class="op">,</span></span>
<span id="cb49-1906"><a href="#cb49-1906" aria-hidden="true" tabindex="-1"></a>    <span class="dt">scenario</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Scenario"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Scénario"</span> }<span class="op">,</span></span>
<span id="cb49-1907"><a href="#cb49-1907" aria-hidden="true" tabindex="-1"></a>    <span class="dt">historical</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Historical"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Historique"</span> }<span class="op">,</span></span>
<span id="cb49-1908"><a href="#cb49-1908" aria-hidden="true" tabindex="-1"></a>    <span class="dt">noData</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"No Data"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">""</span> }<span class="op">,</span></span>
<span id="cb49-1909"><a href="#cb49-1909" aria-hidden="true" tabindex="-1"></a>    <span class="dt">greyNoData</span><span class="op">:</span> {</span>
<span id="cb49-1910"><a href="#cb49-1910" aria-hidden="true" tabindex="-1"></a>      <span class="dt">en</span><span class="op">:</span> <span class="st">"Grey regions signal lack of data"</span><span class="op">,</span></span>
<span id="cb49-1911"><a href="#cb49-1911" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fr</span><span class="op">:</span> <span class="st">"Les régions grises indiquent un manque de données"</span><span class="op">,</span></span>
<span id="cb49-1912"><a href="#cb49-1912" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb49-1913"><a href="#cb49-1913" aria-hidden="true" tabindex="-1"></a>    <span class="dt">emission_ssp370</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Moderate emissions"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"émissions modérées"</span> }<span class="op">,</span></span>
<span id="cb49-1914"><a href="#cb49-1914" aria-hidden="true" tabindex="-1"></a>    <span class="dt">emission_ssp585</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"High emissions"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"émissions élevées"</span> }<span class="op">,</span></span>
<span id="cb49-1915"><a href="#cb49-1915" aria-hidden="true" tabindex="-1"></a>    <span class="dt">countries_article</span><span class="op">:</span> {</span>
<span id="cb49-1916"><a href="#cb49-1916" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Angola</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Angola"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"En Angola"</span> }<span class="op">,</span></span>
<span id="cb49-1917"><a href="#cb49-1917" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Benin</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Benin"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Au Bénin"</span> }<span class="op">,</span></span>
<span id="cb49-1918"><a href="#cb49-1918" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Botswana</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Botswana"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Au Botswana"</span> }<span class="op">,</span></span>
<span id="cb49-1919"><a href="#cb49-1919" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Burkina Faso"</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Burkina Faso"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Au Burkina Faso"</span> }<span class="op">,</span></span>
<span id="cb49-1920"><a href="#cb49-1920" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Burundi</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Burundi"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Au Burundi"</span> }<span class="op">,</span></span>
<span id="cb49-1921"><a href="#cb49-1921" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Cameroon</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Cameroon"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Au Cameroun"</span> }<span class="op">,</span></span>
<span id="cb49-1922"><a href="#cb49-1922" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Central African Republic"</span><span class="op">:</span> {</span>
<span id="cb49-1923"><a href="#cb49-1923" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Central African Republic"</span><span class="op">,</span></span>
<span id="cb49-1924"><a href="#cb49-1924" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"En République Centrafricaine"</span><span class="op">,</span></span>
<span id="cb49-1925"><a href="#cb49-1925" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-1926"><a href="#cb49-1926" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Chad</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Chad"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Au Tchad"</span> }<span class="op">,</span></span>
<span id="cb49-1927"><a href="#cb49-1927" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Congo - Brazzaville"</span><span class="op">:</span> {</span>
<span id="cb49-1928"><a href="#cb49-1928" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Congo - Brazzaville"</span><span class="op">,</span></span>
<span id="cb49-1929"><a href="#cb49-1929" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Au Congo - Brazzaville"</span><span class="op">,</span></span>
<span id="cb49-1930"><a href="#cb49-1930" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-1931"><a href="#cb49-1931" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Congo - Kinshasa"</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Congo - Kinshasa"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Au Congo - Kinshasa"</span> }<span class="op">,</span></span>
<span id="cb49-1932"><a href="#cb49-1932" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Côte d'Ivoire"</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Côte d'Ivoire"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"En Côte d'Ivoire"</span> }<span class="op">,</span></span>
<span id="cb49-1933"><a href="#cb49-1933" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Djibouti</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Djibouti"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"A Djibouti"</span> }<span class="op">,</span></span>
<span id="cb49-1934"><a href="#cb49-1934" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Equatorial Guinea"</span><span class="op">:</span> {</span>
<span id="cb49-1935"><a href="#cb49-1935" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Equatorial Guinea"</span><span class="op">,</span></span>
<span id="cb49-1936"><a href="#cb49-1936" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"En Guinée Équatoriale"</span><span class="op">,</span></span>
<span id="cb49-1937"><a href="#cb49-1937" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-1938"><a href="#cb49-1938" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Eritrea</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Eritrea"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"En Érythrée"</span> }<span class="op">,</span></span>
<span id="cb49-1939"><a href="#cb49-1939" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Eswatini</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Eswatini"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"En Eswatini"</span> }<span class="op">,</span></span>
<span id="cb49-1940"><a href="#cb49-1940" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Ethiopia</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Ethiopia"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"En Éthiopie"</span> }<span class="op">,</span></span>
<span id="cb49-1941"><a href="#cb49-1941" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Gabon</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Gabon"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Au Gabon"</span> }<span class="op">,</span></span>
<span id="cb49-1942"><a href="#cb49-1942" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Gambia</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Gambia"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"En Gambie"</span> }<span class="op">,</span></span>
<span id="cb49-1943"><a href="#cb49-1943" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Ghana</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Ghana"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Au Ghana"</span> }<span class="op">,</span></span>
<span id="cb49-1944"><a href="#cb49-1944" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Guinea</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Guinea"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"En Guinée"</span> }<span class="op">,</span></span>
<span id="cb49-1945"><a href="#cb49-1945" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Guinea-Bissau"</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Guinea-Bissau"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"En Guinée-Bissau"</span> }<span class="op">,</span></span>
<span id="cb49-1946"><a href="#cb49-1946" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Kenya</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Kenya"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Au Kenya"</span> }<span class="op">,</span></span>
<span id="cb49-1947"><a href="#cb49-1947" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Lesotho</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Lesotho"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Au Lesotho"</span> }<span class="op">,</span></span>
<span id="cb49-1948"><a href="#cb49-1948" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Liberia</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Liberia"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Au Libéria"</span> }<span class="op">,</span></span>
<span id="cb49-1949"><a href="#cb49-1949" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Madagascar</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Madagascar"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"À Madagascar"</span> }<span class="op">,</span></span>
<span id="cb49-1950"><a href="#cb49-1950" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Malawi</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Malawi"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Au Malawi"</span> }<span class="op">,</span></span>
<span id="cb49-1951"><a href="#cb49-1951" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Mali</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Mali"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Au Mali"</span> }<span class="op">,</span></span>
<span id="cb49-1952"><a href="#cb49-1952" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Mauritania</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Mauritania"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"En Mauritanie"</span> }<span class="op">,</span></span>
<span id="cb49-1953"><a href="#cb49-1953" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Mozambique</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Mozambique"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Au Mozambique"</span> }<span class="op">,</span></span>
<span id="cb49-1954"><a href="#cb49-1954" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Namibia</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Namibia"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"En Namibie"</span> }<span class="op">,</span></span>
<span id="cb49-1955"><a href="#cb49-1955" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Niger</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Niger"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Au Niger"</span> }<span class="op">,</span></span>
<span id="cb49-1956"><a href="#cb49-1956" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Nigeria</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Nigeria"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Au Nigéria"</span> }<span class="op">,</span></span>
<span id="cb49-1957"><a href="#cb49-1957" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Rwanda</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Rwanda"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Au Rwanda"</span> }<span class="op">,</span></span>
<span id="cb49-1958"><a href="#cb49-1958" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Senegal</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Senegal"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Au Sénégal"</span> }<span class="op">,</span></span>
<span id="cb49-1959"><a href="#cb49-1959" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Sierra Leone"</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Sierra Leone"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"À Sierra Leone"</span> }<span class="op">,</span></span>
<span id="cb49-1960"><a href="#cb49-1960" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Somalia</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Somalia"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"En Somalie"</span> }<span class="op">,</span></span>
<span id="cb49-1961"><a href="#cb49-1961" aria-hidden="true" tabindex="-1"></a>      <span class="st">"South Africa"</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"South Africa"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"En Afrique du Sud"</span> }<span class="op">,</span></span>
<span id="cb49-1962"><a href="#cb49-1962" aria-hidden="true" tabindex="-1"></a>      <span class="st">"South Sudan"</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"South Sudan"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Au Soudan du Sud"</span> }<span class="op">,</span></span>
<span id="cb49-1963"><a href="#cb49-1963" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Sudan</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Sudan"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Au Soudan"</span> }<span class="op">,</span></span>
<span id="cb49-1964"><a href="#cb49-1964" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Tanzania</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Tanzania"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"En Tanzanie"</span> }<span class="op">,</span></span>
<span id="cb49-1965"><a href="#cb49-1965" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Togo</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Togo"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Au Togo"</span> }<span class="op">,</span></span>
<span id="cb49-1966"><a href="#cb49-1966" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Uganda</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Uganda"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"En Ouganda"</span> }<span class="op">,</span></span>
<span id="cb49-1967"><a href="#cb49-1967" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Zambia</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Zambia"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"En Zambie"</span> }<span class="op">,</span></span>
<span id="cb49-1968"><a href="#cb49-1968" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Zimbabwe</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Zimbabwe"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Au Zimbabwe"</span> }<span class="op">,</span></span>
<span id="cb49-1969"><a href="#cb49-1969" aria-hidden="true" tabindex="-1"></a>      <span class="dt">SSA</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Sub-Saharan Africa"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"En Afrique Subsaharienne"</span> }<span class="op">,</span></span>
<span id="cb49-1970"><a href="#cb49-1970" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb49-1971"><a href="#cb49-1971" aria-hidden="true" tabindex="-1"></a>    <span class="dt">country_article2</span><span class="op">:</span> {</span>
<span id="cb49-1972"><a href="#cb49-1972" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Angola</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Angola"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"L’Angola"</span> }<span class="op">,</span></span>
<span id="cb49-1973"><a href="#cb49-1973" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Benin</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Benin"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Le Bénin"</span> }<span class="op">,</span></span>
<span id="cb49-1974"><a href="#cb49-1974" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Botswana</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Botswana"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Le Botswana"</span> }<span class="op">,</span></span>
<span id="cb49-1975"><a href="#cb49-1975" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Burkina Faso"</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Burkina Faso"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Le Burkina Faso"</span> }<span class="op">,</span></span>
<span id="cb49-1976"><a href="#cb49-1976" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Burundi</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Burundi"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Le Burundi"</span> }<span class="op">,</span></span>
<span id="cb49-1977"><a href="#cb49-1977" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Cameroon</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Cameroon"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Le Cameroun"</span> }<span class="op">,</span></span>
<span id="cb49-1978"><a href="#cb49-1978" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Central African Republic"</span><span class="op">:</span> {</span>
<span id="cb49-1979"><a href="#cb49-1979" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Central African Republic"</span><span class="op">,</span></span>
<span id="cb49-1980"><a href="#cb49-1980" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"La République Centrafricaine"</span><span class="op">,</span></span>
<span id="cb49-1981"><a href="#cb49-1981" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-1982"><a href="#cb49-1982" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Chad</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Chad"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Le Tchad"</span> }<span class="op">,</span></span>
<span id="cb49-1983"><a href="#cb49-1983" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Congo - Brazzaville"</span><span class="op">:</span> {</span>
<span id="cb49-1984"><a href="#cb49-1984" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Congo - Brazzaville"</span><span class="op">,</span></span>
<span id="cb49-1985"><a href="#cb49-1985" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Le Congo - Brazzaville"</span><span class="op">,</span></span>
<span id="cb49-1986"><a href="#cb49-1986" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-1987"><a href="#cb49-1987" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Congo - Kinshasa"</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Congo - Kinshasa"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Le Congo - Kinshasa"</span> }<span class="op">,</span></span>
<span id="cb49-1988"><a href="#cb49-1988" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Côte d'Ivoire"</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Côte d'Ivoire"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"La Côte d'Ivoire"</span> }<span class="op">,</span></span>
<span id="cb49-1989"><a href="#cb49-1989" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Djibouti</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Djibouti"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Djibouti"</span> }<span class="op">,</span></span>
<span id="cb49-1990"><a href="#cb49-1990" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Equatorial Guinea"</span><span class="op">:</span> {</span>
<span id="cb49-1991"><a href="#cb49-1991" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Equatorial Guinea"</span><span class="op">,</span></span>
<span id="cb49-1992"><a href="#cb49-1992" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"La Guinée Équatoriale"</span><span class="op">,</span></span>
<span id="cb49-1993"><a href="#cb49-1993" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-1994"><a href="#cb49-1994" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Eritrea</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Eritrea"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"L’Érythrée"</span> }<span class="op">,</span></span>
<span id="cb49-1995"><a href="#cb49-1995" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Eswatini</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Eswatini"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"L’Eswatini"</span> }<span class="op">,</span></span>
<span id="cb49-1996"><a href="#cb49-1996" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Ethiopia</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Ethiopia"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"L’Éthiopie"</span> }<span class="op">,</span></span>
<span id="cb49-1997"><a href="#cb49-1997" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Gabon</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Gabon"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Le Gabon"</span> }<span class="op">,</span></span>
<span id="cb49-1998"><a href="#cb49-1998" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Gambia</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Gambia"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"La  Gambie"</span> }<span class="op">,</span></span>
<span id="cb49-1999"><a href="#cb49-1999" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Ghana</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Ghana"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Le Ghana"</span> }<span class="op">,</span></span>
<span id="cb49-2000"><a href="#cb49-2000" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Guinea</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Guinea"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"La Guinée"</span> }<span class="op">,</span></span>
<span id="cb49-2001"><a href="#cb49-2001" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Guinea-Bissau"</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Guinea-Bissau"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"La Guinée-Bissau"</span> }<span class="op">,</span></span>
<span id="cb49-2002"><a href="#cb49-2002" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Kenya</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Kenya"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Le Kenya"</span> }<span class="op">,</span></span>
<span id="cb49-2003"><a href="#cb49-2003" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Lesotho</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Lesotho"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Le Lesotho"</span> }<span class="op">,</span></span>
<span id="cb49-2004"><a href="#cb49-2004" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Liberia</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Liberia"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Le Libéria"</span> }<span class="op">,</span></span>
<span id="cb49-2005"><a href="#cb49-2005" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Madagascar</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Madagascar"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Madagascar"</span> }<span class="op">,</span></span>
<span id="cb49-2006"><a href="#cb49-2006" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Malawi</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Malawi"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Le Malawi"</span> }<span class="op">,</span></span>
<span id="cb49-2007"><a href="#cb49-2007" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Mali</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Mali"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Le Mali"</span> }<span class="op">,</span></span>
<span id="cb49-2008"><a href="#cb49-2008" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Mauritania</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Mauritania"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"La Mauritanie"</span> }<span class="op">,</span></span>
<span id="cb49-2009"><a href="#cb49-2009" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Mozambique</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Mozambique"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Le Mozambique"</span> }<span class="op">,</span></span>
<span id="cb49-2010"><a href="#cb49-2010" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Namibia</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Namibia"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"La Namibie"</span> }<span class="op">,</span></span>
<span id="cb49-2011"><a href="#cb49-2011" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Niger</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Niger"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Le Niger"</span> }<span class="op">,</span></span>
<span id="cb49-2012"><a href="#cb49-2012" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Nigeria</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Nigeria"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Le Nigéria"</span> }<span class="op">,</span></span>
<span id="cb49-2013"><a href="#cb49-2013" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Rwanda</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Rwanda"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Le Rwanda"</span> }<span class="op">,</span></span>
<span id="cb49-2014"><a href="#cb49-2014" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Senegal</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Senegal"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Le Sénégal"</span> }<span class="op">,</span></span>
<span id="cb49-2015"><a href="#cb49-2015" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Sierra Leone"</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Sierra Leone"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Sierra Leone"</span> }<span class="op">,</span></span>
<span id="cb49-2016"><a href="#cb49-2016" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Somalia</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Somalia"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"La Somalie"</span> }<span class="op">,</span></span>
<span id="cb49-2017"><a href="#cb49-2017" aria-hidden="true" tabindex="-1"></a>      <span class="st">"South Africa"</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"South Africa"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"L’Afrique du Sud"</span> }<span class="op">,</span></span>
<span id="cb49-2018"><a href="#cb49-2018" aria-hidden="true" tabindex="-1"></a>      <span class="st">"South Sudan"</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"South Sudan"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Le Soudan du Sud"</span> }<span class="op">,</span></span>
<span id="cb49-2019"><a href="#cb49-2019" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Sudan</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Sudan"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Le Soudan"</span> }<span class="op">,</span></span>
<span id="cb49-2020"><a href="#cb49-2020" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Tanzania</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Tanzania"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"La Tanzanie"</span> }<span class="op">,</span></span>
<span id="cb49-2021"><a href="#cb49-2021" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Togo</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Togo"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Le Togo"</span> }<span class="op">,</span></span>
<span id="cb49-2022"><a href="#cb49-2022" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Uganda</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Uganda"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"L’Ouganda"</span> }<span class="op">,</span></span>
<span id="cb49-2023"><a href="#cb49-2023" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Zambia</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Zambia"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"La Zambie"</span> }<span class="op">,</span></span>
<span id="cb49-2024"><a href="#cb49-2024" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Zimbabwe</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Zimbabwe"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Le Zimbabwe"</span> }<span class="op">,</span></span>
<span id="cb49-2025"><a href="#cb49-2025" aria-hidden="true" tabindex="-1"></a>      <span class="dt">SSA</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"SSA"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"L’Afrique Subsaharienne"</span> }<span class="op">,</span></span>
<span id="cb49-2026"><a href="#cb49-2026" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb49-2027"><a href="#cb49-2027" aria-hidden="true" tabindex="-1"></a>    <span class="dt">adminNames</span><span class="op">:</span> {</span>
<span id="cb49-2028"><a href="#cb49-2028" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Full Country"</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Full Country"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Pays Entier"</span> }<span class="op">,</span></span>
<span id="cb49-2029"><a href="#cb49-2029" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Angola</span><span class="op">:</span> {</span>
<span id="cb49-2030"><a href="#cb49-2030" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Angola"</span><span class="op">,</span></span>
<span id="cb49-2031"><a href="#cb49-2031" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Angola"</span><span class="op">,</span></span>
<span id="cb49-2032"><a href="#cb49-2032" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-2033"><a href="#cb49-2033" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Benin</span><span class="op">:</span> {</span>
<span id="cb49-2034"><a href="#cb49-2034" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Benin"</span><span class="op">,</span></span>
<span id="cb49-2035"><a href="#cb49-2035" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Bénin"</span><span class="op">,</span></span>
<span id="cb49-2036"><a href="#cb49-2036" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-2037"><a href="#cb49-2037" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Botswana</span><span class="op">:</span> {</span>
<span id="cb49-2038"><a href="#cb49-2038" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Botswana"</span><span class="op">,</span></span>
<span id="cb49-2039"><a href="#cb49-2039" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Botswana"</span><span class="op">,</span></span>
<span id="cb49-2040"><a href="#cb49-2040" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-2041"><a href="#cb49-2041" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Burkina Faso"</span><span class="op">:</span> {</span>
<span id="cb49-2042"><a href="#cb49-2042" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Burkina Faso"</span><span class="op">,</span></span>
<span id="cb49-2043"><a href="#cb49-2043" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Burkina Faso"</span><span class="op">,</span></span>
<span id="cb49-2044"><a href="#cb49-2044" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-2045"><a href="#cb49-2045" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Burundi</span><span class="op">:</span> {</span>
<span id="cb49-2046"><a href="#cb49-2046" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Burundi"</span><span class="op">,</span></span>
<span id="cb49-2047"><a href="#cb49-2047" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Burundi"</span><span class="op">,</span></span>
<span id="cb49-2048"><a href="#cb49-2048" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-2049"><a href="#cb49-2049" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Cameroon</span><span class="op">:</span> {</span>
<span id="cb49-2050"><a href="#cb49-2050" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Cameroon"</span><span class="op">,</span></span>
<span id="cb49-2051"><a href="#cb49-2051" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Cameroun"</span><span class="op">,</span></span>
<span id="cb49-2052"><a href="#cb49-2052" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-2053"><a href="#cb49-2053" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Central African Republic"</span><span class="op">:</span> {</span>
<span id="cb49-2054"><a href="#cb49-2054" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Central African Republic"</span><span class="op">,</span></span>
<span id="cb49-2055"><a href="#cb49-2055" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"République Centrafricaine"</span><span class="op">,</span></span>
<span id="cb49-2056"><a href="#cb49-2056" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-2057"><a href="#cb49-2057" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Chad</span><span class="op">:</span> {</span>
<span id="cb49-2058"><a href="#cb49-2058" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Chad"</span><span class="op">,</span></span>
<span id="cb49-2059"><a href="#cb49-2059" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Tchad"</span><span class="op">,</span></span>
<span id="cb49-2060"><a href="#cb49-2060" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-2061"><a href="#cb49-2061" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Congo - Brazzaville"</span><span class="op">:</span> {</span>
<span id="cb49-2062"><a href="#cb49-2062" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Congo - Brazzaville"</span><span class="op">,</span></span>
<span id="cb49-2063"><a href="#cb49-2063" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Congo - Brazzaville"</span><span class="op">,</span></span>
<span id="cb49-2064"><a href="#cb49-2064" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-2065"><a href="#cb49-2065" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Congo - Kinshasa"</span><span class="op">:</span> {</span>
<span id="cb49-2066"><a href="#cb49-2066" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Congo - Kinshasa"</span><span class="op">,</span></span>
<span id="cb49-2067"><a href="#cb49-2067" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Congo - Kinshasa"</span><span class="op">,</span></span>
<span id="cb49-2068"><a href="#cb49-2068" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-2069"><a href="#cb49-2069" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Côte d’Ivoire"</span><span class="op">:</span> {</span>
<span id="cb49-2070"><a href="#cb49-2070" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Côte d’Ivoire"</span><span class="op">,</span></span>
<span id="cb49-2071"><a href="#cb49-2071" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Côte d’Ivoire"</span><span class="op">,</span></span>
<span id="cb49-2072"><a href="#cb49-2072" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-2073"><a href="#cb49-2073" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Djibouti</span><span class="op">:</span> {</span>
<span id="cb49-2074"><a href="#cb49-2074" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Djibouti"</span><span class="op">,</span></span>
<span id="cb49-2075"><a href="#cb49-2075" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Djibouti"</span><span class="op">,</span></span>
<span id="cb49-2076"><a href="#cb49-2076" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-2077"><a href="#cb49-2077" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Equatorial Guinea"</span><span class="op">:</span> {</span>
<span id="cb49-2078"><a href="#cb49-2078" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Equatorial Guinea"</span><span class="op">,</span></span>
<span id="cb49-2079"><a href="#cb49-2079" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Guinée Équatoriale"</span><span class="op">,</span></span>
<span id="cb49-2080"><a href="#cb49-2080" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-2081"><a href="#cb49-2081" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Eritrea</span><span class="op">:</span> {</span>
<span id="cb49-2082"><a href="#cb49-2082" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Eritrea"</span><span class="op">,</span></span>
<span id="cb49-2083"><a href="#cb49-2083" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Érythrée"</span><span class="op">,</span></span>
<span id="cb49-2084"><a href="#cb49-2084" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-2085"><a href="#cb49-2085" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Eswatini</span><span class="op">:</span> {</span>
<span id="cb49-2086"><a href="#cb49-2086" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Eswatini"</span><span class="op">,</span></span>
<span id="cb49-2087"><a href="#cb49-2087" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Eswatini"</span><span class="op">,</span></span>
<span id="cb49-2088"><a href="#cb49-2088" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-2089"><a href="#cb49-2089" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Ethiopia</span><span class="op">:</span> {</span>
<span id="cb49-2090"><a href="#cb49-2090" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Ethiopia"</span><span class="op">,</span></span>
<span id="cb49-2091"><a href="#cb49-2091" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Éthiopie"</span><span class="op">,</span></span>
<span id="cb49-2092"><a href="#cb49-2092" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-2093"><a href="#cb49-2093" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Gabon</span><span class="op">:</span> {</span>
<span id="cb49-2094"><a href="#cb49-2094" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Gabon"</span><span class="op">,</span></span>
<span id="cb49-2095"><a href="#cb49-2095" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Gabon"</span><span class="op">,</span></span>
<span id="cb49-2096"><a href="#cb49-2096" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-2097"><a href="#cb49-2097" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Gambia</span><span class="op">:</span> {</span>
<span id="cb49-2098"><a href="#cb49-2098" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Gambia"</span><span class="op">,</span></span>
<span id="cb49-2099"><a href="#cb49-2099" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Gambie"</span><span class="op">,</span></span>
<span id="cb49-2100"><a href="#cb49-2100" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-2101"><a href="#cb49-2101" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Ghana</span><span class="op">:</span> {</span>
<span id="cb49-2102"><a href="#cb49-2102" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Ghana"</span><span class="op">,</span></span>
<span id="cb49-2103"><a href="#cb49-2103" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Ghana"</span><span class="op">,</span></span>
<span id="cb49-2104"><a href="#cb49-2104" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-2105"><a href="#cb49-2105" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Guinea</span><span class="op">:</span> {</span>
<span id="cb49-2106"><a href="#cb49-2106" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Guinea"</span><span class="op">,</span></span>
<span id="cb49-2107"><a href="#cb49-2107" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Guinée"</span><span class="op">,</span></span>
<span id="cb49-2108"><a href="#cb49-2108" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-2109"><a href="#cb49-2109" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Guinea-Bissau"</span><span class="op">:</span> {</span>
<span id="cb49-2110"><a href="#cb49-2110" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Guinea-Bissau"</span><span class="op">,</span></span>
<span id="cb49-2111"><a href="#cb49-2111" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Guinée-Bissau"</span><span class="op">,</span></span>
<span id="cb49-2112"><a href="#cb49-2112" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-2113"><a href="#cb49-2113" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Kenya</span><span class="op">:</span> {</span>
<span id="cb49-2114"><a href="#cb49-2114" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Kenya"</span><span class="op">,</span></span>
<span id="cb49-2115"><a href="#cb49-2115" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Kenya"</span><span class="op">,</span></span>
<span id="cb49-2116"><a href="#cb49-2116" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-2117"><a href="#cb49-2117" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Lesotho</span><span class="op">:</span> {</span>
<span id="cb49-2118"><a href="#cb49-2118" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Lesotho"</span><span class="op">,</span></span>
<span id="cb49-2119"><a href="#cb49-2119" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Lesotho"</span><span class="op">,</span></span>
<span id="cb49-2120"><a href="#cb49-2120" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-2121"><a href="#cb49-2121" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Liberia</span><span class="op">:</span> {</span>
<span id="cb49-2122"><a href="#cb49-2122" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Liberia"</span><span class="op">,</span></span>
<span id="cb49-2123"><a href="#cb49-2123" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Libéria"</span><span class="op">,</span></span>
<span id="cb49-2124"><a href="#cb49-2124" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-2125"><a href="#cb49-2125" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Madagascar</span><span class="op">:</span> {</span>
<span id="cb49-2126"><a href="#cb49-2126" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Madagascar"</span><span class="op">,</span></span>
<span id="cb49-2127"><a href="#cb49-2127" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Madagascar"</span><span class="op">,</span></span>
<span id="cb49-2128"><a href="#cb49-2128" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-2129"><a href="#cb49-2129" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Malawi</span><span class="op">:</span> {</span>
<span id="cb49-2130"><a href="#cb49-2130" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Malawi"</span><span class="op">,</span></span>
<span id="cb49-2131"><a href="#cb49-2131" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Malawi"</span><span class="op">,</span></span>
<span id="cb49-2132"><a href="#cb49-2132" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-2133"><a href="#cb49-2133" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Mali</span><span class="op">:</span> {</span>
<span id="cb49-2134"><a href="#cb49-2134" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Mali"</span><span class="op">,</span></span>
<span id="cb49-2135"><a href="#cb49-2135" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Mali"</span><span class="op">,</span></span>
<span id="cb49-2136"><a href="#cb49-2136" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-2137"><a href="#cb49-2137" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Mauritania</span><span class="op">:</span> {</span>
<span id="cb49-2138"><a href="#cb49-2138" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Mauritania"</span><span class="op">,</span></span>
<span id="cb49-2139"><a href="#cb49-2139" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Mauritanie"</span><span class="op">,</span></span>
<span id="cb49-2140"><a href="#cb49-2140" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-2141"><a href="#cb49-2141" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Mozambique</span><span class="op">:</span> {</span>
<span id="cb49-2142"><a href="#cb49-2142" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Mozambique"</span><span class="op">,</span></span>
<span id="cb49-2143"><a href="#cb49-2143" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Mozambique"</span><span class="op">,</span></span>
<span id="cb49-2144"><a href="#cb49-2144" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-2145"><a href="#cb49-2145" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Namibia</span><span class="op">:</span> {</span>
<span id="cb49-2146"><a href="#cb49-2146" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Namibia"</span><span class="op">,</span></span>
<span id="cb49-2147"><a href="#cb49-2147" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Namibie"</span><span class="op">,</span></span>
<span id="cb49-2148"><a href="#cb49-2148" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-2149"><a href="#cb49-2149" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Niger</span><span class="op">:</span> {</span>
<span id="cb49-2150"><a href="#cb49-2150" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Niger"</span><span class="op">,</span></span>
<span id="cb49-2151"><a href="#cb49-2151" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Niger"</span><span class="op">,</span></span>
<span id="cb49-2152"><a href="#cb49-2152" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-2153"><a href="#cb49-2153" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Nigeria</span><span class="op">:</span> {</span>
<span id="cb49-2154"><a href="#cb49-2154" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Nigeria"</span><span class="op">,</span></span>
<span id="cb49-2155"><a href="#cb49-2155" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Nigéria"</span><span class="op">,</span></span>
<span id="cb49-2156"><a href="#cb49-2156" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-2157"><a href="#cb49-2157" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Rwanda</span><span class="op">:</span> {</span>
<span id="cb49-2158"><a href="#cb49-2158" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Rwanda"</span><span class="op">,</span></span>
<span id="cb49-2159"><a href="#cb49-2159" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Rwanda"</span><span class="op">,</span></span>
<span id="cb49-2160"><a href="#cb49-2160" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-2161"><a href="#cb49-2161" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Senegal</span><span class="op">:</span> {</span>
<span id="cb49-2162"><a href="#cb49-2162" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Senegal"</span><span class="op">,</span></span>
<span id="cb49-2163"><a href="#cb49-2163" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Sénégal"</span><span class="op">,</span></span>
<span id="cb49-2164"><a href="#cb49-2164" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-2165"><a href="#cb49-2165" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Sierra Leone"</span><span class="op">:</span> {</span>
<span id="cb49-2166"><a href="#cb49-2166" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Sierra Leone"</span><span class="op">,</span></span>
<span id="cb49-2167"><a href="#cb49-2167" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Sierra Leone"</span><span class="op">,</span></span>
<span id="cb49-2168"><a href="#cb49-2168" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-2169"><a href="#cb49-2169" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Somalia</span><span class="op">:</span> {</span>
<span id="cb49-2170"><a href="#cb49-2170" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Somalia"</span><span class="op">,</span></span>
<span id="cb49-2171"><a href="#cb49-2171" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Somalie"</span><span class="op">,</span></span>
<span id="cb49-2172"><a href="#cb49-2172" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-2173"><a href="#cb49-2173" aria-hidden="true" tabindex="-1"></a>      <span class="st">"South Africa"</span><span class="op">:</span> {</span>
<span id="cb49-2174"><a href="#cb49-2174" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"South Africa"</span><span class="op">,</span></span>
<span id="cb49-2175"><a href="#cb49-2175" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Afrique du Sud"</span><span class="op">,</span></span>
<span id="cb49-2176"><a href="#cb49-2176" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-2177"><a href="#cb49-2177" aria-hidden="true" tabindex="-1"></a>      <span class="st">"South Sudan"</span><span class="op">:</span> {</span>
<span id="cb49-2178"><a href="#cb49-2178" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"South Sudan"</span><span class="op">,</span></span>
<span id="cb49-2179"><a href="#cb49-2179" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Soudan du Sud"</span><span class="op">,</span></span>
<span id="cb49-2180"><a href="#cb49-2180" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-2181"><a href="#cb49-2181" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Sudan</span><span class="op">:</span> {</span>
<span id="cb49-2182"><a href="#cb49-2182" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Sudan"</span><span class="op">,</span></span>
<span id="cb49-2183"><a href="#cb49-2183" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Soudan"</span><span class="op">,</span></span>
<span id="cb49-2184"><a href="#cb49-2184" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-2185"><a href="#cb49-2185" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Tanzania</span><span class="op">:</span> {</span>
<span id="cb49-2186"><a href="#cb49-2186" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Tanzania"</span><span class="op">,</span></span>
<span id="cb49-2187"><a href="#cb49-2187" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Tanzanie"</span><span class="op">,</span></span>
<span id="cb49-2188"><a href="#cb49-2188" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-2189"><a href="#cb49-2189" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Togo</span><span class="op">:</span> {</span>
<span id="cb49-2190"><a href="#cb49-2190" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Togo"</span><span class="op">,</span></span>
<span id="cb49-2191"><a href="#cb49-2191" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Togo"</span><span class="op">,</span></span>
<span id="cb49-2192"><a href="#cb49-2192" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-2193"><a href="#cb49-2193" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Uganda</span><span class="op">:</span> {</span>
<span id="cb49-2194"><a href="#cb49-2194" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Uganda"</span><span class="op">,</span></span>
<span id="cb49-2195"><a href="#cb49-2195" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Ouganda"</span><span class="op">,</span></span>
<span id="cb49-2196"><a href="#cb49-2196" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-2197"><a href="#cb49-2197" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Zambia</span><span class="op">:</span> {</span>
<span id="cb49-2198"><a href="#cb49-2198" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Zambia"</span><span class="op">,</span></span>
<span id="cb49-2199"><a href="#cb49-2199" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Zambie"</span><span class="op">,</span></span>
<span id="cb49-2200"><a href="#cb49-2200" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-2201"><a href="#cb49-2201" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Zimbabwe</span><span class="op">:</span> {</span>
<span id="cb49-2202"><a href="#cb49-2202" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Zimbabwe"</span><span class="op">,</span></span>
<span id="cb49-2203"><a href="#cb49-2203" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Zimbabwe"</span><span class="op">,</span></span>
<span id="cb49-2204"><a href="#cb49-2204" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-2205"><a href="#cb49-2205" aria-hidden="true" tabindex="-1"></a>      <span class="dt">SSA</span><span class="op">:</span> {</span>
<span id="cb49-2206"><a href="#cb49-2206" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Sub-Saharan Africa"</span><span class="op">,</span></span>
<span id="cb49-2207"><a href="#cb49-2207" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Afrique Subsaharienne"</span><span class="op">,</span></span>
<span id="cb49-2208"><a href="#cb49-2208" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-2209"><a href="#cb49-2209" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Sub-Saharan Africa"</span><span class="op">:</span> {</span>
<span id="cb49-2210"><a href="#cb49-2210" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Sub-Saharan Africa"</span><span class="op">,</span></span>
<span id="cb49-2211"><a href="#cb49-2211" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Afrique Subsaharienne"</span><span class="op">,</span></span>
<span id="cb49-2212"><a href="#cb49-2212" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb49-2213"><a href="#cb49-2213" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb49-2214"><a href="#cb49-2214" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb49-2215"><a href="#cb49-2215" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-49" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb50" data-startfrom="2219" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2218"><span id="cb50-2219"><a href="#cb50-2219" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`&lt;style&gt;</span></span>
<span id="cb50-2220"><a href="#cb50-2220" aria-hidden="true" tabindex="-1"></a><span class="vs">.plotTooltip {</span></span>
<span id="cb50-2221"><a href="#cb50-2221" aria-hidden="true" tabindex="-1"></a><span class="vs">  z-index:2;</span></span>
<span id="cb50-2222"><a href="#cb50-2222" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 10px 10px;</span></span>
<span id="cb50-2223"><a href="#cb50-2223" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: black;</span></span>
<span id="cb50-2224"><a href="#cb50-2224" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb50-2225"><a href="#cb50-2225" aria-hidden="true" tabindex="-1"></a><span class="vs">  border: 1px solid rgba(0,0,0,1);</span></span>
<span id="cb50-2226"><a href="#cb50-2226" aria-hidden="true" tabindex="-1"></a><span class="vs">  pointer-events: none;</span></span>
<span id="cb50-2227"><a href="#cb50-2227" aria-hidden="true" tabindex="-1"></a><span class="vs">  transform: translate(-50%, -100%);</span></span>
<span id="cb50-2228"><a href="#cb50-2228" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: "IBM Plex Sans", "Source Serif Pro";</span></span>
<span id="cb50-2229"><a href="#cb50-2229" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-size: 14px;</span></span>
<span id="cb50-2230"><a href="#cb50-2230" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: rgba(255,255,255, 1);</span></span>
<span id="cb50-2231"><a href="#cb50-2231" aria-hidden="true" tabindex="-1"></a><span class="vs">  transition: 0.3s opacity ease-out, 0.1s border-color ease-out;</span></span>
<span id="cb50-2232"><a href="#cb50-2232" aria-hidden="true" tabindex="-1"></a><span class="vs">  position: relative;</span></span>
<span id="cb50-2233"><a href="#cb50-2233" aria-hidden="true" tabindex="-1"></a><span class="vs">  display: none;</span></span>
<span id="cb50-2234"><a href="#cb50-2234" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb50-2235"><a href="#cb50-2235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-2236"><a href="#cb50-2236" aria-hidden="true" tabindex="-1"></a><span class="vs">.plotTooltip::before {</span></span>
<span id="cb50-2237"><a href="#cb50-2237" aria-hidden="true" tabindex="-1"></a><span class="vs">  content: "";</span></span>
<span id="cb50-2238"><a href="#cb50-2238" aria-hidden="true" tabindex="-1"></a><span class="vs">  position: absolute;</span></span>
<span id="cb50-2239"><a href="#cb50-2239" aria-hidden="true" tabindex="-1"></a><span class="vs">  top: 100%;</span></span>
<span id="cb50-2240"><a href="#cb50-2240" aria-hidden="true" tabindex="-1"></a><span class="vs">  left: 50%;</span></span>
<span id="cb50-2241"><a href="#cb50-2241" aria-hidden="true" tabindex="-1"></a><span class="vs">  margin-left: -5px;</span></span>
<span id="cb50-2242"><a href="#cb50-2242" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-width: 5px;</span></span>
<span id="cb50-2243"><a href="#cb50-2243" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-style: solid;</span></span>
<span id="cb50-2244"><a href="#cb50-2244" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-color: black transparent transparent transparent;</span></span>
<span id="cb50-2245"><a href="#cb50-2245" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb50-2246"><a href="#cb50-2246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-2247"><a href="#cb50-2247" aria-hidden="true" tabindex="-1"></a><span class="vs">.plotTooltip::after {</span></span>
<span id="cb50-2248"><a href="#cb50-2248" aria-hidden="true" tabindex="-1"></a><span class="vs">  content: "";</span></span>
<span id="cb50-2249"><a href="#cb50-2249" aria-hidden="true" tabindex="-1"></a><span class="vs">  position: absolute;</span></span>
<span id="cb50-2250"><a href="#cb50-2250" aria-hidden="true" tabindex="-1"></a><span class="vs">  top: calc(100% - 1px);</span></span>
<span id="cb50-2251"><a href="#cb50-2251" aria-hidden="true" tabindex="-1"></a><span class="vs">  left: 50%;</span></span>
<span id="cb50-2252"><a href="#cb50-2252" aria-hidden="true" tabindex="-1"></a><span class="vs">  margin-left: -4.9px;</span></span>
<span id="cb50-2253"><a href="#cb50-2253" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-width: 4.9px;</span></span>
<span id="cb50-2254"><a href="#cb50-2254" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-style: solid;</span></span>
<span id="cb50-2255"><a href="#cb50-2255" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-color: white transparent transparent transparent;</span></span>
<span id="cb50-2256"><a href="#cb50-2256" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb50-2257"><a href="#cb50-2257" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/style&gt;`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-50" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb51" data-startfrom="2261" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2260"><span id="cb51-2261"><a href="#cb51-2261" aria-hidden="true" tabindex="-1"></a>formTemplate <span class="op">=</span> ({ gap <span class="op">=</span> <span class="st">"2em"</span> } <span class="op">=</span> {}) <span class="kw">=&gt;</span> {</span>
<span id="cb51-2262"><a href="#cb51-2262" aria-hidden="true" tabindex="-1"></a>  <span class="co">// template for input display</span></span>
<span id="cb51-2263"><a href="#cb51-2263" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> (inputs) <span class="kw">=&gt;</span></span>
<span id="cb51-2264"><a href="#cb51-2264" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html</span><span class="vs">`&lt;div style="display: flex; gap: </span><span class="sc">${</span>gap<span class="sc">}</span><span class="vs">;"&gt;</span><span class="sc">${</span>inputs<span class="sc">}</span><span class="vs">&lt;/div&gt;`</span><span class="op">;</span></span>
<span id="cb51-2265"><a href="#cb51-2265" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-51" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb52" data-startfrom="2269" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2268"><span id="cb52-2269"><a href="#cb52-2269" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`&lt;style&gt;</span></span>
<span id="cb52-2270"><a href="#cb52-2270" aria-hidden="true" tabindex="-1"></a><span class="vs">    /* Styling for tooltip labels */</span></span>
<span id="cb52-2271"><a href="#cb52-2271" aria-hidden="true" tabindex="-1"></a><span class="vs">    .tooltip {</span></span>
<span id="cb52-2272"><a href="#cb52-2272" aria-hidden="true" tabindex="-1"></a><span class="vs">        position: relative;</span></span>
<span id="cb52-2273"><a href="#cb52-2273" aria-hidden="true" tabindex="-1"></a><span class="vs">        display: inline-block;</span></span>
<span id="cb52-2274"><a href="#cb52-2274" aria-hidden="true" tabindex="-1"></a><span class="vs">        cursor: pointer;</span></span>
<span id="cb52-2275"><a href="#cb52-2275" aria-hidden="true" tabindex="-1"></a><span class="vs">        width: 100%;</span></span>
<span id="cb52-2276"><a href="#cb52-2276" aria-hidden="true" tabindex="-1"></a><span class="vs">    }</span></span>
<span id="cb52-2277"><a href="#cb52-2277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-2278"><a href="#cb52-2278" aria-hidden="true" tabindex="-1"></a><span class="vs">    .tooltip .tooltiptext {</span></span>
<span id="cb52-2279"><a href="#cb52-2279" aria-hidden="true" tabindex="-1"></a><span class="vs">        position: absolute;</span></span>
<span id="cb52-2280"><a href="#cb52-2280" aria-hidden="true" tabindex="-1"></a><span class="vs">        z-index: 1;</span></span>
<span id="cb52-2281"><a href="#cb52-2281" aria-hidden="true" tabindex="-1"></a><span class="vs">        visibility: hidden; </span></span>
<span id="cb52-2282"><a href="#cb52-2282" aria-hidden="true" tabindex="-1"></a><span class="vs">        left: 0;</span></span>
<span id="cb52-2283"><a href="#cb52-2283" aria-hidden="true" tabindex="-1"></a><span class="vs">        bottom: 100%;</span></span>
<span id="cb52-2284"><a href="#cb52-2284" aria-hidden="true" tabindex="-1"></a><span class="vs">        background-color: #efefef;</span></span>
<span id="cb52-2285"><a href="#cb52-2285" aria-hidden="true" tabindex="-1"></a><span class="vs">        color: #333;</span></span>
<span id="cb52-2286"><a href="#cb52-2286" aria-hidden="true" tabindex="-1"></a><span class="vs">        border: 0px solid #333;</span></span>
<span id="cb52-2287"><a href="#cb52-2287" aria-hidden="true" tabindex="-1"></a><span class="vs">        border-radius: 0;</span></span>
<span id="cb52-2288"><a href="#cb52-2288" aria-hidden="true" tabindex="-1"></a><span class="vs">        padding: 0px 0px;</span></span>
<span id="cb52-2289"><a href="#cb52-2289" aria-hidden="true" tabindex="-1"></a><span class="vs">        margin-bottom: 00px;</span></span>
<span id="cb52-2290"><a href="#cb52-2290" aria-hidden="true" tabindex="-1"></a><span class="vs">        text-transform: none;</span></span>
<span id="cb52-2291"><a href="#cb52-2291" aria-hidden="true" tabindex="-1"></a><span class="vs">        font-size: 14px;</span></span>
<span id="cb52-2292"><a href="#cb52-2292" aria-hidden="true" tabindex="-1"></a><span class="vs">        line-height: 1.6;</span></span>
<span id="cb52-2293"><a href="#cb52-2293" aria-hidden="true" tabindex="-1"></a><span class="vs">        text-align: left;</span></span>
<span id="cb52-2294"><a href="#cb52-2294" aria-hidden="true" tabindex="-1"></a><span class="vs">        opacity: 0;</span></span>
<span id="cb52-2295"><a href="#cb52-2295" aria-hidden="true" tabindex="-1"></a><span class="vs">        transition: opacity 0.3s;</span></span>
<span id="cb52-2296"><a href="#cb52-2296" aria-hidden="true" tabindex="-1"></a><span class="vs">    }</span></span>
<span id="cb52-2297"><a href="#cb52-2297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-2298"><a href="#cb52-2298" aria-hidden="true" tabindex="-1"></a><span class="vs">    .tooltip:hover .tooltiptext {</span></span>
<span id="cb52-2299"><a href="#cb52-2299" aria-hidden="true" tabindex="-1"></a><span class="vs">        visibility: visible;</span></span>
<span id="cb52-2300"><a href="#cb52-2300" aria-hidden="true" tabindex="-1"></a><span class="vs">        opacity: 1;</span></span>
<span id="cb52-2301"><a href="#cb52-2301" aria-hidden="true" tabindex="-1"></a><span class="vs">        cursor: default;</span></span>
<span id="cb52-2302"><a href="#cb52-2302" aria-hidden="true" tabindex="-1"></a><span class="vs">    }</span></span>
<span id="cb52-2303"><a href="#cb52-2303" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/style&gt;`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-52" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb53" data-startfrom="2307" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2306"><span id="cb53-2307"><a href="#cb53-2307" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb53-2308"><a href="#cb53-2308" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="fu">md</span><span class="vs">`**Color Scales**`</span></span>
<span id="cb53-2309"><a href="#cb53-2309" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-53" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb54" data-startfrom="2313" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2312"><span id="cb54-2313"><a href="#cb54-2313" aria-hidden="true" tabindex="-1"></a><span class="co">// color scale info</span></span>
<span id="cb54-2314"><a href="#cb54-2314" aria-hidden="true" tabindex="-1"></a>colorScales <span class="op">=</span> {</span>
<span id="cb54-2315"><a href="#cb54-2315" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> {</span>
<span id="cb54-2316"><a href="#cb54-2316" aria-hidden="true" tabindex="-1"></a>    <span class="dt">range</span><span class="op">:</span> {</span>
<span id="cb54-2317"><a href="#cb54-2317" aria-hidden="true" tabindex="-1"></a>      <span class="dt">green</span><span class="op">:</span> [<span class="st">'#E4F5D0'</span><span class="op">,</span> <span class="st">'#015023'</span>]<span class="op">,</span></span>
<span id="cb54-2318"><a href="#cb54-2318" aria-hidden="true" tabindex="-1"></a>      <span class="dt">blue</span><span class="op">:</span> [<span class="st">'#E8F2FF'</span><span class="op">,</span> <span class="st">'#003E6B'</span>]<span class="op">,</span></span>
<span id="cb54-2319"><a href="#cb54-2319" aria-hidden="true" tabindex="-1"></a>      <span class="dt">brown</span><span class="op">:</span> [<span class="st">'#FFFDE5'</span><span class="op">,</span> <span class="st">'#A87B00'</span>]<span class="op">,</span></span>
<span id="cb54-2320"><a href="#cb54-2320" aria-hidden="true" tabindex="-1"></a>      <span class="dt">yellowGreen</span><span class="op">:</span> [<span class="st">'#F7D732'</span><span class="op">,</span> <span class="st">'#216729'</span>]<span class="op">,</span></span>
<span id="cb54-2321"><a href="#cb54-2321" aria-hidden="true" tabindex="-1"></a>      <span class="dt">orangeRed</span><span class="op">:</span> [<span class="st">'#F4BB21'</span><span class="op">,</span> <span class="st">'#EC5A47'</span>]<span class="op">,</span></span>
<span id="cb54-2322"><a href="#cb54-2322" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb54-2323"><a href="#cb54-2323" aria-hidden="true" tabindex="-1"></a>    <span class="dt">unknown</span><span class="op">:</span> <span class="st">"#ccc"</span></span>
<span id="cb54-2324"><a href="#cb54-2324" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb54-2325"><a href="#cb54-2325" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-54" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb55" data-startfrom="2329" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2328"><span id="cb55-2329"><a href="#cb55-2329" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`---</span></span>
<span id="cb55-2330"><a href="#cb55-2330" aria-hidden="true" tabindex="-1"></a><span class="vs">### Admin Selection</span></span>
<span id="cb55-2331"><a href="#cb55-2331" aria-hidden="true" tabindex="-1"></a><span class="vs">*Global admin selector using dropdowns*</span></span>
<span id="cb55-2332"><a href="#cb55-2332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-2333"><a href="#cb55-2333" aria-hidden="true" tabindex="-1"></a><span class="vs">This is the global selector for the selected region</span></span>
<span id="cb55-2334"><a href="#cb55-2334" aria-hidden="true" tabindex="-1"></a><span class="vs">- The completed data is contained within adminSelections to be used in queries</span></span>
<span id="cb55-2335"><a href="#cb55-2335" aria-hidden="true" tabindex="-1"></a><span class="vs">- Dropdowns are defined below then bound for each section</span></span>
<span id="cb55-2336"><a href="#cb55-2336" aria-hidden="true" tabindex="-1"></a><span class="vs">  - Defined as separate cells since they dynamically respond to different values</span></span>
<span id="cb55-2337"><a href="#cb55-2337" aria-hidden="true" tabindex="-1"></a><span class="vs">    - In narrative, they are simply views of the data  </span></span>
<span id="cb55-2338"><a href="#cb55-2338" aria-hidden="true" tabindex="-1"></a><span class="vs">  - Dropdowns are dynamic based on higher-level choices</span></span>
<span id="cb55-2339"><a href="#cb55-2339" aria-hidden="true" tabindex="-1"></a><span class="vs">  - Options are defined from the geographic data</span></span>
<span id="cb55-2340"><a href="#cb55-2340" aria-hidden="true" tabindex="-1"></a><span class="vs">  - null value means unselected region</span></span>
<span id="cb55-2341"><a href="#cb55-2341" aria-hidden="true" tabindex="-1"></a><span class="vs">- Dropdowns are added to each section, using Inputs.bind to create synchronized inputs (see viewof for input definitions). A form input is used to consolidate and apply a template to format.`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-55" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb56" data-startfrom="2345" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2344"><span id="cb56-2345"><a href="#cb56-2345" aria-hidden="true" tabindex="-1"></a><span class="co">// get admin0 options from geo</span></span>
<span id="cb56-2346"><a href="#cb56-2346" aria-hidden="true" tabindex="-1"></a>dataAdmin0 <span class="op">=</span> {</span>
<span id="cb56-2347"><a href="#cb56-2347" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> data <span class="op">=</span> admin0_boundaries<span class="op">.</span><span class="at">features</span><span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">properties</span>)</span>
<span id="cb56-2348"><a href="#cb56-2348" aria-hidden="true" tabindex="-1"></a>  <span class="co">// add a blank value</span></span>
<span id="cb56-2349"><a href="#cb56-2349" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> [<span class="kw">null</span><span class="op">,</span> <span class="op">...</span>data<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">admin_name</span>)]</span>
<span id="cb56-2350"><a href="#cb56-2350" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-56" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb57" data-startfrom="2354" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2353"><span id="cb57-2354"><a href="#cb57-2354" aria-hidden="true" tabindex="-1"></a><span class="co">// get admin1 options based on admin0 selection</span></span>
<span id="cb57-2355"><a href="#cb57-2355" aria-hidden="true" tabindex="-1"></a><span class="co">// (the admin1 regions within selected admin0)</span></span>
<span id="cb57-2356"><a href="#cb57-2356" aria-hidden="true" tabindex="-1"></a>dataAdmin1 <span class="op">=</span> {</span>
<span id="cb57-2357"><a href="#cb57-2357" aria-hidden="true" tabindex="-1"></a>  <span class="co">// admin 1, filter by 0 </span></span>
<span id="cb57-2358"><a href="#cb57-2358" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> data <span class="op">=</span> admin1_boundaries<span class="op">.</span><span class="at">features</span><span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">properties</span>)</span>
<span id="cb57-2359"><a href="#cb57-2359" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">admin0_name</span> <span class="op">==</span> selectAdmin0)</span>
<span id="cb57-2360"><a href="#cb57-2360" aria-hidden="true" tabindex="-1"></a>  <span class="co">// add blank value</span></span>
<span id="cb57-2361"><a href="#cb57-2361" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> [<span class="kw">null</span><span class="op">,</span> <span class="op">...</span>data<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">admin1_name</span>)]</span>
<span id="cb57-2362"><a href="#cb57-2362" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-57" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb58" data-startfrom="2366" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2365"><span id="cb58-2366"><a href="#cb58-2366" aria-hidden="true" tabindex="-1"></a><span class="co">// get admin2 options based on admin1 selection</span></span>
<span id="cb58-2367"><a href="#cb58-2367" aria-hidden="true" tabindex="-1"></a><span class="co">// (the admin2 regions within selected admin1)</span></span>
<span id="cb58-2368"><a href="#cb58-2368" aria-hidden="true" tabindex="-1"></a>dataAdmin2 <span class="op">=</span> {</span>
<span id="cb58-2369"><a href="#cb58-2369" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> data <span class="op">=</span> boundaries<span class="op">.</span><span class="at">admin2</span><span class="op">.</span><span class="at">features</span><span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">properties</span>)</span>
<span id="cb58-2370"><a href="#cb58-2370" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">admin0_name</span> <span class="op">==</span> selectAdmin0 <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">admin1_name</span> <span class="op">==</span> selectAdmin1)</span>
<span id="cb58-2371"><a href="#cb58-2371" aria-hidden="true" tabindex="-1"></a>  <span class="co">// add blank value</span></span>
<span id="cb58-2372"><a href="#cb58-2372" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> [<span class="kw">null</span><span class="op">,</span> <span class="op">...</span>data<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">admin2_name</span>)]</span>
<span id="cb58-2373"><a href="#cb58-2373" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-58" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb59" data-startfrom="2377" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2376"><span id="cb59-2377"><a href="#cb59-2377" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`## Global impacts data`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-59" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb60" data-startfrom="2381" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2380"><span id="cb60-2381"><a href="#cb60-2381" aria-hidden="true" tabindex="-1"></a>crop_options_items <span class="op">=</span> {</span>
<span id="cb60-2382"><a href="#cb60-2382" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> [</span>
<span id="cb60-2383"><a href="#cb60-2383" aria-hidden="true" tabindex="-1"></a>      {<span class="dt">id</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">Crop</span><span class="op">:</span> <span class="st">"maize"</span>}<span class="op">,</span></span>
<span id="cb60-2384"><a href="#cb60-2384" aria-hidden="true" tabindex="-1"></a>      {<span class="dt">id</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">Crop</span><span class="op">:</span> <span class="st">"rice"</span>}<span class="op">,</span> </span>
<span id="cb60-2385"><a href="#cb60-2385" aria-hidden="true" tabindex="-1"></a>      {<span class="dt">id</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span> <span class="dt">Crop</span><span class="op">:</span> <span class="st">"soybean"</span>}<span class="op">,</span></span>
<span id="cb60-2386"><a href="#cb60-2386" aria-hidden="true" tabindex="-1"></a>      {<span class="dt">id</span><span class="op">:</span> <span class="dv">3</span><span class="op">,</span> <span class="dt">Crop</span><span class="op">:</span> <span class="st">"wheat"</span>}</span>
<span id="cb60-2387"><a href="#cb60-2387" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">;</span></span>
<span id="cb60-2388"><a href="#cb60-2388" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-60" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb61" data-startfrom="2392" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2391"><span id="cb61-2392"><a href="#cb61-2392" aria-hidden="true" tabindex="-1"></a><span class="co">// make a label for selector</span></span>
<span id="cb61-2393"><a href="#cb61-2393" aria-hidden="true" tabindex="-1"></a><span class="co">// html with tooltip on hover</span></span>
<span id="cb61-2394"><a href="#cb61-2394" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">makeTooltipLabel</span>({</span>
<span id="cb61-2395"><a href="#cb61-2395" aria-hidden="true" tabindex="-1"></a>  labelText <span class="op">=</span> <span class="st">"Dropdown label"</span><span class="op">,</span></span>
<span id="cb61-2396"><a href="#cb61-2396" aria-hidden="true" tabindex="-1"></a>  tooltipText <span class="op">=</span> <span class="st">"Tooltip text"</span><span class="op">,</span></span>
<span id="cb61-2397"><a href="#cb61-2397" aria-hidden="true" tabindex="-1"></a>} <span class="op">=</span> {}) {</span>
<span id="cb61-2398"><a href="#cb61-2398" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> htl<span class="op">.</span><span class="fu">html</span><span class="vs">`&lt;span class="tooltip"&gt;</span></span>
<span id="cb61-2399"><a href="#cb61-2399" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;span for="inputField"&gt;</span><span class="sc">${</span>labelText<span class="sc">}</span><span class="vs">&lt;/span&gt;</span></span>
<span id="cb61-2400"><a href="#cb61-2400" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;span class="tooltiptext"&gt;</span><span class="sc">${</span>tooltipText<span class="sc">}</span><span class="vs">&lt;/span&gt;</span></span>
<span id="cb61-2401"><a href="#cb61-2401" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/span&gt;`</span><span class="op">;</span></span>
<span id="cb61-2402"><a href="#cb61-2402" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-61" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb62" data-startfrom="2406" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2405"><span id="cb62-2406"><a href="#cb62-2406" aria-hidden="true" tabindex="-1"></a>debounce <span class="op">=</span> (delay<span class="op">,</span> input) <span class="kw">=&gt;</span> {</span>
<span id="cb62-2407"><a href="#cb62-2407" aria-hidden="true" tabindex="-1"></a>  <span class="kw">class</span> DelayedEvent <span class="kw">extends</span> <span class="bu">Event</span> {}</span>
<span id="cb62-2408"><a href="#cb62-2408" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> id<span class="op">;</span></span>
<span id="cb62-2409"><a href="#cb62-2409" aria-hidden="true" tabindex="-1"></a>  input<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">"input"</span><span class="op">,</span> (e) <span class="kw">=&gt;</span> {</span>
<span id="cb62-2410"><a href="#cb62-2410" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (e <span class="kw">instanceof</span> DelayedEvent) <span class="cf">return</span><span class="op">;</span></span>
<span id="cb62-2411"><a href="#cb62-2411" aria-hidden="true" tabindex="-1"></a>    e<span class="op">.</span><span class="fu">stopImmediatePropagation</span>()<span class="op">;</span></span>
<span id="cb62-2412"><a href="#cb62-2412" aria-hidden="true" tabindex="-1"></a>    <span class="pp">clearTimeout</span>(id)<span class="op">;</span></span>
<span id="cb62-2413"><a href="#cb62-2413" aria-hidden="true" tabindex="-1"></a>    id <span class="op">=</span> <span class="pp">setTimeout</span>(</span>
<span id="cb62-2414"><a href="#cb62-2414" aria-hidden="true" tabindex="-1"></a>      () <span class="kw">=&gt;</span> input<span class="op">.</span><span class="fu">dispatchEvent</span>(<span class="kw">new</span> <span class="fu">DelayedEvent</span>(<span class="st">"input"</span><span class="op">,</span> { <span class="dt">bubbles</span><span class="op">:</span> <span class="kw">true</span> }))<span class="op">,</span></span>
<span id="cb62-2415"><a href="#cb62-2415" aria-hidden="true" tabindex="-1"></a>      delay<span class="op">,</span></span>
<span id="cb62-2416"><a href="#cb62-2416" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb62-2417"><a href="#cb62-2417" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb62-2418"><a href="#cb62-2418" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> input<span class="op">;</span></span>
<span id="cb62-2419"><a href="#cb62-2419" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-62" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb63" data-startfrom="2423" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2422"><span id="cb63-2423"><a href="#cb63-2423" aria-hidden="true" tabindex="-1"></a>debounceDelay <span class="op">=</span> <span class="dv">500</span><span class="op">;</span> <span class="co">// ms delay to respond</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-63" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb64" data-startfrom="2427" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2426"><span id="cb64-2427"><a href="#cb64-2427" aria-hidden="true" tabindex="-1"></a>viewof select_crop <span class="op">=</span> {</span>
<span id="cb64-2428"><a href="#cb64-2428" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> checkbox <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">checkbox</span>(crop_options_items<span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">Crop</span>)<span class="op">,</span> { <span class="dt">label</span><span class="op">:</span> <span class="st">"Crops"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> [<span class="st">'maize'</span>] })<span class="op">;</span></span>
<span id="cb64-2429"><a href="#cb64-2429" aria-hidden="true" tabindex="-1"></a>  checkbox<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">'input'</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb64-2430"><a href="#cb64-2430" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (checkbox<span class="op">.</span><span class="at">value</span><span class="op">.</span><span class="at">length</span> <span class="op">===</span> <span class="dv">0</span>) {</span>
<span id="cb64-2431"><a href="#cb64-2431" aria-hidden="true" tabindex="-1"></a>      checkbox<span class="op">.</span><span class="at">value</span> <span class="op">=</span> [<span class="st">'maize'</span>]<span class="op">;</span></span>
<span id="cb64-2432"><a href="#cb64-2432" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb64-2433"><a href="#cb64-2433" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb64-2434"><a href="#cb64-2434" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> checkbox }</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-64" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb65" data-startfrom="2438" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2437"><span id="cb65-2438"><a href="#cb65-2438" aria-hidden="true" tabindex="-1"></a>viewof crop_selector_yield <span class="op">=</span> {</span>
<span id="cb65-2439"><a href="#cb65-2439" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> Inputs<span class="op">.</span><span class="fu">select</span>(</span>
<span id="cb65-2440"><a href="#cb65-2440" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"maize"</span><span class="op">,</span> <span class="st">"rice"</span><span class="op">,</span> <span class="st">"wheat"</span>]<span class="op">,</span></span>
<span id="cb65-2441"><a href="#cb65-2441" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">crop</span>)<span class="op">,</span></span>
<span id="cb65-2442"><a href="#cb65-2442" aria-hidden="true" tabindex="-1"></a>    <span class="dt">format</span><span class="op">:</span> c <span class="kw">=&gt;</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">crops</span>[c])}</span>
<span id="cb65-2443"><a href="#cb65-2443" aria-hidden="true" tabindex="-1"></a>  )  </span>
<span id="cb65-2444"><a href="#cb65-2444" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-65" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb66" data-startfrom="2448" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2447"><span id="cb66-2448"><a href="#cb66-2448" aria-hidden="true" tabindex="-1"></a>viewof sel_region <span class="op">=</span> {</span>
<span id="cb66-2449"><a href="#cb66-2449" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> Inputs<span class="op">.</span><span class="fu">select</span>(</span>
<span id="cb66-2450"><a href="#cb66-2450" aria-hidden="true" tabindex="-1"></a>    avaliable_unRegions<span class="op">,</span></span>
<span id="cb66-2451"><a href="#cb66-2451" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">regionalPicture</span><span class="op">.</span><span class="at">beeswarm</span><span class="op">.</span><span class="at">yAxis</span>)<span class="op">,</span></span>
<span id="cb66-2452"><a href="#cb66-2452" aria-hidden="true" tabindex="-1"></a>    <span class="dt">format</span><span class="op">:</span> d <span class="kw">=&gt;</span>  <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">regionalPicture</span><span class="op">.</span><span class="at">beeswarm</span><span class="op">.</span><span class="at">regions</span>[d <span class="op">||</span> <span class="st">"all"</span>])} <span class="co">// No region is NULL so add a label</span></span>
<span id="cb66-2453"><a href="#cb66-2453" aria-hidden="true" tabindex="-1"></a>  )  </span>
<span id="cb66-2454"><a href="#cb66-2454" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-66" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb67" data-startfrom="2458" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2457"><span id="cb67-2458"><a href="#cb67-2458" aria-hidden="true" tabindex="-1"></a>selected_crop_global <span class="op">=</span> [crop_selector_yield]<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-67" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb68" data-startfrom="2462" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2461"><span id="cb68-2462"><a href="#cb68-2462" aria-hidden="true" tabindex="-1"></a>warming_level_options <span class="op">=</span> {</span>
<span id="cb68-2463"><a href="#cb68-2463" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> {</span>
<span id="cb68-2464"><a href="#cb68-2464" aria-hidden="true" tabindex="-1"></a>      <span class="dv">0</span><span class="op">:</span> {<span class="dt">min</span><span class="op">:</span> <span class="op">-</span><span class="kw">Infinity</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="fl">1.5</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"&lt;1.5"</span>}<span class="op">,</span></span>
<span id="cb68-2465"><a href="#cb68-2465" aria-hidden="true" tabindex="-1"></a>      <span class="dv">1</span><span class="op">:</span> {<span class="dt">min</span><span class="op">:</span> <span class="fl">1.5</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="fl">2.0</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"1.5-2.0"</span>}<span class="op">,</span></span>
<span id="cb68-2466"><a href="#cb68-2466" aria-hidden="true" tabindex="-1"></a>      <span class="dv">2</span><span class="op">:</span> {<span class="dt">min</span><span class="op">:</span> <span class="fl">2.0</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="fl">3.0</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"2.0-3.0"</span>}<span class="op">,</span></span>
<span id="cb68-2467"><a href="#cb68-2467" aria-hidden="true" tabindex="-1"></a>      <span class="dv">3</span><span class="op">:</span> {<span class="dt">min</span><span class="op">:</span> <span class="fl">3.0</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="kw">Infinity</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"&gt;3.0"</span>}</span>
<span id="cb68-2468"><a href="#cb68-2468" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb68-2469"><a href="#cb68-2469" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-68" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb69" data-startfrom="2473" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2472"><span id="cb69-2473"><a href="#cb69-2473" aria-hidden="true" tabindex="-1"></a>impacts_metaanalysis_data <span class="op">=</span> {</span>
<span id="cb69-2474"><a href="#cb69-2474" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Excuse the names.. the R export "cleaned" them...</span></span>
<span id="cb69-2475"><a href="#cb69-2475" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> sqlQuery <span class="op">=</span> <span class="vs">`</span></span>
<span id="cb69-2476"><a href="#cb69-2476" aria-hidden="true" tabindex="-1"></a><span class="vs">    SELECT </span></span>
<span id="cb69-2477"><a href="#cb69-2477" aria-hidden="true" tabindex="-1"></a><span class="vs">      LOWER(Crop) as Crop,</span></span>
<span id="cb69-2478"><a href="#cb69-2478" aria-hidden="true" tabindex="-1"></a><span class="vs">      Country,</span></span>
<span id="cb69-2479"><a href="#cb69-2479" aria-hidden="true" tabindex="-1"></a><span class="vs">      "Projected.yield..t.ha." as proj_yield,</span></span>
<span id="cb69-2480"><a href="#cb69-2480" aria-hidden="true" tabindex="-1"></a><span class="vs">      "Climate.impacts...." as yield_impact_pct,</span></span>
<span id="cb69-2481"><a href="#cb69-2481" aria-hidden="true" tabindex="-1"></a><span class="vs">      "Global.delta.T.from.pre.industrial.period" as preindustrial_temp_delta,</span></span>
<span id="cb69-2482"><a href="#cb69-2482" aria-hidden="true" tabindex="-1"></a><span class="vs">      "Global.delta.T.from.2005" as temp_delta_2005,</span></span>
<span id="cb69-2483"><a href="#cb69-2483" aria-hidden="true" tabindex="-1"></a><span class="vs">      Reference,</span></span>
<span id="cb69-2484"><a href="#cb69-2484" aria-hidden="true" tabindex="-1"></a><span class="vs">      Adaptation,</span></span>
<span id="cb69-2485"><a href="#cb69-2485" aria-hidden="true" tabindex="-1"></a><span class="vs">    FROM projected_impacts</span></span>
<span id="cb69-2486"><a href="#cb69-2486" aria-hidden="true" tabindex="-1"></a><span class="vs">    WHERE Region = 'Africa'</span></span>
<span id="cb69-2487"><a href="#cb69-2487" aria-hidden="true" tabindex="-1"></a><span class="vs">    AND LOWER(Crop) = '</span><span class="sc">${</span>crop_selector_yield<span class="sc">}</span><span class="vs">'`</span></span>
<span id="cb69-2488"><a href="#cb69-2488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-2489"><a href="#cb69-2489" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> filtered <span class="op">=</span> <span class="cf">await</span> db2<span class="op">.</span><span class="fu">query</span>(sqlQuery) <span class="co">// Put this in a seperate db (non-encrypted) to boost load time of first figure</span></span>
<span id="cb69-2490"><a href="#cb69-2490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-2491"><a href="#cb69-2491" aria-hidden="true" tabindex="-1"></a>  filtered <span class="op">=</span> filtered<span class="op">.</span><span class="fu">map</span>(item <span class="kw">=&gt;</span> ({</span>
<span id="cb69-2492"><a href="#cb69-2492" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span>item<span class="op">,</span></span>
<span id="cb69-2493"><a href="#cb69-2493" aria-hidden="true" tabindex="-1"></a>    <span class="dt">UNRegion</span><span class="op">:</span> country_to_region[item<span class="op">.</span><span class="at">Country</span><span class="op">.</span><span class="fu">toLowerCase</span>()<span class="op">.</span><span class="fu">trim</span>()]</span>
<span id="cb69-2494"><a href="#cb69-2494" aria-hidden="true" tabindex="-1"></a>  }))<span class="op">;</span></span>
<span id="cb69-2495"><a href="#cb69-2495" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> filtered<span class="op">;</span></span>
<span id="cb69-2496"><a href="#cb69-2496" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-69" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb70" data-startfrom="2500" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2499"><span id="cb70-2500"><a href="#cb70-2500" aria-hidden="true" tabindex="-1"></a>db2 <span class="op">=</span> DuckDBClient<span class="op">.</span><span class="fu">of</span>({</span>
<span id="cb70-2501"><a href="#cb70-2501" aria-hidden="true" tabindex="-1"></a>  <span class="dt">projected_impacts</span><span class="op">:</span> <span class="fu">FileAttachment</span>(<span class="st">"projected-impacts_hasagawa.parquet"</span>)<span class="op">,</span></span>
<span id="cb70-2502"><a href="#cb70-2502" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-70" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb71" data-startfrom="2506" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2505"><span id="cb71-2506"><a href="#cb71-2506" aria-hidden="true" tabindex="-1"></a>avaliable_unRegions <span class="op">=</span> <span class="kw">new</span> <span class="bu">Set</span>([</span>
<span id="cb71-2507"><a href="#cb71-2507" aria-hidden="true" tabindex="-1"></a>  <span class="kw">null</span><span class="op">,</span></span>
<span id="cb71-2508"><a href="#cb71-2508" aria-hidden="true" tabindex="-1"></a>  <span class="op">...</span>impacts_metaanalysis_data<span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">UNRegion</span>)<span class="op">,</span></span>
<span id="cb71-2509"><a href="#cb71-2509" aria-hidden="true" tabindex="-1"></a>])<span class="op">;</span> <span class="co">// null for all of africa</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-71" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb72" data-startfrom="2513" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2512"><span id="cb72-2513"><a href="#cb72-2513" aria-hidden="true" tabindex="-1"></a>violin_insight_data <span class="op">=</span> {</span>
<span id="cb72-2514"><a href="#cb72-2514" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> data <span class="op">=</span> impacts_metaanalysis_data</span>
<span id="cb72-2515"><a href="#cb72-2515" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> ({</span>
<span id="cb72-2516"><a href="#cb72-2516" aria-hidden="true" tabindex="-1"></a>      <span class="op">...</span>d<span class="op">,</span></span>
<span id="cb72-2517"><a href="#cb72-2517" aria-hidden="true" tabindex="-1"></a>      <span class="dt">temp_band</span><span class="op">:</span> <span class="fu">classifyTempBand</span>(d<span class="op">.</span><span class="at">preindustrial_temp_delta</span>)</span>
<span id="cb72-2518"><a href="#cb72-2518" aria-hidden="true" tabindex="-1"></a>    }))<span class="op">;</span></span>
<span id="cb72-2519"><a href="#cb72-2519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-2520"><a href="#cb72-2520" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> region_data <span class="op">=</span> data</span>
<span id="cb72-2521"><a href="#cb72-2521" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> </span>
<span id="cb72-2522"><a href="#cb72-2522" aria-hidden="true" tabindex="-1"></a>      <span class="op">!</span>sel_region <span class="op">||</span> d<span class="op">?.</span><span class="at">UNRegion</span> <span class="op">===</span> sel_region</span>
<span id="cb72-2523"><a href="#cb72-2523" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb72-2524"><a href="#cb72-2524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-2525"><a href="#cb72-2525" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> median_yields <span class="op">=</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">fromEntries</span>(</span>
<span id="cb72-2526"><a href="#cb72-2526" aria-hidden="true" tabindex="-1"></a>    d3<span class="op">.</span><span class="fu">groups</span>(region_data<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">temp_band</span>)<span class="op">.</span><span class="fu">map</span>(([b<span class="op">,</span> rows]) <span class="kw">=&gt;</span> [</span>
<span id="cb72-2527"><a href="#cb72-2527" aria-hidden="true" tabindex="-1"></a>      b<span class="op">,</span></span>
<span id="cb72-2528"><a href="#cb72-2528" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb72-2529"><a href="#cb72-2529" aria-hidden="true" tabindex="-1"></a>        <span class="dt">median_without_adaptation</span><span class="op">:</span> d3<span class="op">.</span><span class="fu">median</span>(rows<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">Adaptation</span> <span class="op">===</span> <span class="st">"No"</span>)<span class="op">,</span> d <span class="kw">=&gt;</span> <span class="op">+</span>d<span class="op">.</span><span class="at">yield_impact_pct</span>) <span class="op">??</span> <span class="kw">null</span><span class="op">,</span></span>
<span id="cb72-2530"><a href="#cb72-2530" aria-hidden="true" tabindex="-1"></a>        <span class="dt">median_with_adaptation</span><span class="op">:</span> d3<span class="op">.</span><span class="fu">median</span>(rows<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">Adaptation</span> <span class="op">===</span> <span class="st">"Yes"</span>)<span class="op">,</span> d <span class="kw">=&gt;</span> <span class="op">+</span>d<span class="op">.</span><span class="at">yield_impact_pct</span>) <span class="op">??</span> <span class="kw">null</span><span class="op">,</span></span>
<span id="cb72-2531"><a href="#cb72-2531" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb72-2532"><a href="#cb72-2532" aria-hidden="true" tabindex="-1"></a>    ])</span>
<span id="cb72-2533"><a href="#cb72-2533" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb72-2534"><a href="#cb72-2534" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb72-2535"><a href="#cb72-2535" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> worstRegionsByBand <span class="op">=</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">fromEntries</span>( <span class="co">// this should use the unfiltered data with all regions</span></span>
<span id="cb72-2536"><a href="#cb72-2536" aria-hidden="true" tabindex="-1"></a>    d3<span class="op">.</span><span class="fu">groups</span>(data<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">temp_band</span> <span class="op">??</span> <span class="st">"Unspecified"</span>)<span class="op">.</span><span class="fu">map</span>(([b<span class="op">,</span> rows]) <span class="kw">=&gt;</span> {</span>
<span id="cb72-2537"><a href="#cb72-2537" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> by <span class="op">=</span> subset <span class="kw">=&gt;</span> {</span>
<span id="cb72-2538"><a href="#cb72-2538" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> rmap <span class="op">=</span> d3<span class="op">.</span><span class="fu">rollup</span>(subset<span class="op">,</span> v <span class="kw">=&gt;</span> d3<span class="op">.</span><span class="fu">median</span>(v<span class="op">,</span> d <span class="kw">=&gt;</span> <span class="op">+</span>d<span class="op">.</span><span class="at">yield_impact_pct</span>)<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">UNRegion</span> <span class="op">??</span> <span class="st">"Unspecified"</span>)<span class="op">;</span></span>
<span id="cb72-2539"><a href="#cb72-2539" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="op">!</span>rmap<span class="op">.</span><span class="at">size</span>) <span class="cf">return</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb72-2540"><a href="#cb72-2540" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> minVal <span class="op">=</span> d3<span class="op">.</span><span class="fu">min</span>(rmap<span class="op">.</span><span class="fu">values</span>())<span class="op">;</span></span>
<span id="cb72-2541"><a href="#cb72-2541" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> worst <span class="op">=</span> [<span class="op">...</span>rmap]<span class="op">.</span><span class="fu">filter</span>(([<span class="op">,</span> m]) <span class="kw">=&gt;</span> m <span class="op">===</span> minVal)</span>
<span id="cb72-2542"><a href="#cb72-2542" aria-hidden="true" tabindex="-1"></a>                        <span class="op">.</span><span class="fu">map</span>(([r<span class="op">,</span> medianLoss]) <span class="kw">=&gt;</span> ({ <span class="dt">region</span><span class="op">:</span> r<span class="op">,</span> medianLoss }))<span class="op">;</span></span>
<span id="cb72-2543"><a href="#cb72-2543" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb72-2544"><a href="#cb72-2544" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> worst<span class="op">.</span><span class="at">length</span> <span class="op">===</span> <span class="dv">1</span> <span class="op">?</span> worst[<span class="dv">0</span>] <span class="op">:</span> worst<span class="op">;</span></span>
<span id="cb72-2545"><a href="#cb72-2545" aria-hidden="true" tabindex="-1"></a>      }<span class="op">;</span></span>
<span id="cb72-2546"><a href="#cb72-2546" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> [b<span class="op">,</span> {</span>
<span id="cb72-2547"><a href="#cb72-2547" aria-hidden="true" tabindex="-1"></a>        <span class="dt">worst_region_without_adaptation</span><span class="op">:</span> <span class="fu">by</span>(rows<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">Adaptation</span> <span class="op">===</span> <span class="st">"No"</span>))<span class="op">,</span></span>
<span id="cb72-2548"><a href="#cb72-2548" aria-hidden="true" tabindex="-1"></a>        <span class="dt">worst_region_with_adaptation</span><span class="op">:</span> <span class="fu">by</span>(rows<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">Adaptation</span> <span class="op">===</span> <span class="st">"Yes"</span>))<span class="op">,</span></span>
<span id="cb72-2549"><a href="#cb72-2549" aria-hidden="true" tabindex="-1"></a>      }]<span class="op">;</span></span>
<span id="cb72-2550"><a href="#cb72-2550" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb72-2551"><a href="#cb72-2551" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb72-2552"><a href="#cb72-2552" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb72-2553"><a href="#cb72-2553" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span>{</span>
<span id="cb72-2554"><a href="#cb72-2554" aria-hidden="true" tabindex="-1"></a>    median_yields<span class="op">,</span></span>
<span id="cb72-2555"><a href="#cb72-2555" aria-hidden="true" tabindex="-1"></a>    <span class="dt">worst_region</span><span class="op">:</span> worstRegionsByBand</span>
<span id="cb72-2556"><a href="#cb72-2556" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb72-2557"><a href="#cb72-2557" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-72" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb73" data-startfrom="2561" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2560"><span id="cb73-2561"><a href="#cb73-2561" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">classifyTempBand</span>(temp) {</span>
<span id="cb73-2562"><a href="#cb73-2562" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (temp <span class="op">&lt;=</span> <span class="dv">2</span>) <span class="cf">return</span> <span class="st">"≤ 2°C"</span><span class="op">;</span> <span class="co">// return "≤ 1.5°C";</span></span>
<span id="cb73-2563"><a href="#cb73-2563" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (temp <span class="op">&lt;=</span> <span class="dv">3</span>) <span class="cf">return</span> <span class="st">"2-3°C"</span><span class="op">;</span> <span class="co">// return "1.5–2.5°C";</span></span>
<span id="cb73-2564"><a href="#cb73-2564" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="st">"&gt; 3°C"</span><span class="op">;</span> <span class="co">// "&gt; 2.5°C"</span></span>
<span id="cb73-2565"><a href="#cb73-2565" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-73" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb74" data-startfrom="2569" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2568"><span id="cb74-2569"><a href="#cb74-2569" aria-hidden="true" tabindex="-1"></a>temp_opts <span class="op">=</span> [<span class="st">"≤ 2°C"</span><span class="op">,</span> <span class="st">"2-3°C"</span><span class="op">,</span> <span class="st">"&gt; 3°C"</span>]<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-74" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb75" data-startfrom="2573" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2572"><span id="cb75-2573"><a href="#cb75-2573" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`## Dynamic Insights`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-75" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb76" data-startfrom="2577" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2576"><span id="cb76-2577"><a href="#cb76-2577" aria-hidden="true" tabindex="-1"></a>country_to_region <span class="op">=</span> {</span>
<span id="cb76-2578"><a href="#cb76-2578" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {</span>
<span id="cb76-2579"><a href="#cb76-2579" aria-hidden="true" tabindex="-1"></a>  <span class="st">"algeria"</span><span class="op">:</span> <span class="st">"Northern"</span><span class="op">,</span></span>
<span id="cb76-2580"><a href="#cb76-2580" aria-hidden="true" tabindex="-1"></a>   <span class="st">"egypt"</span><span class="op">:</span> <span class="st">"Northern"</span><span class="op">,</span></span>
<span id="cb76-2581"><a href="#cb76-2581" aria-hidden="true" tabindex="-1"></a>   <span class="st">"libya"</span><span class="op">:</span> <span class="st">"Northern"</span><span class="op">,</span></span>
<span id="cb76-2582"><a href="#cb76-2582" aria-hidden="true" tabindex="-1"></a>   <span class="st">"morocco"</span><span class="op">:</span> <span class="st">"Northern"</span><span class="op">,</span></span>
<span id="cb76-2583"><a href="#cb76-2583" aria-hidden="true" tabindex="-1"></a>   <span class="st">"sudan"</span><span class="op">:</span> <span class="st">"Northern"</span><span class="op">,</span></span>
<span id="cb76-2584"><a href="#cb76-2584" aria-hidden="true" tabindex="-1"></a>   <span class="st">"tunisia"</span><span class="op">:</span> <span class="st">"Northern"</span><span class="op">,</span></span>
<span id="cb76-2585"><a href="#cb76-2585" aria-hidden="true" tabindex="-1"></a>   <span class="st">"western sahara"</span><span class="op">:</span> <span class="st">"Northern"</span><span class="op">,</span></span>
<span id="cb76-2586"><a href="#cb76-2586" aria-hidden="true" tabindex="-1"></a>   <span class="st">"syria"</span><span class="op">:</span> <span class="st">"Northern"</span><span class="op">,</span></span>
<span id="cb76-2587"><a href="#cb76-2587" aria-hidden="true" tabindex="-1"></a>   <span class="st">"british indian ocean territory"</span><span class="op">:</span> <span class="st">"Eastern"</span><span class="op">,</span></span>
<span id="cb76-2588"><a href="#cb76-2588" aria-hidden="true" tabindex="-1"></a>   <span class="st">"burundi"</span><span class="op">:</span> <span class="st">"Eastern"</span><span class="op">,</span></span>
<span id="cb76-2589"><a href="#cb76-2589" aria-hidden="true" tabindex="-1"></a>   <span class="st">"comoros"</span><span class="op">:</span> <span class="st">"Eastern"</span><span class="op">,</span></span>
<span id="cb76-2590"><a href="#cb76-2590" aria-hidden="true" tabindex="-1"></a>   <span class="st">"djibouti"</span><span class="op">:</span> <span class="st">"Eastern"</span><span class="op">,</span></span>
<span id="cb76-2591"><a href="#cb76-2591" aria-hidden="true" tabindex="-1"></a>   <span class="st">"eritrea"</span><span class="op">:</span> <span class="st">"Eastern"</span><span class="op">,</span></span>
<span id="cb76-2592"><a href="#cb76-2592" aria-hidden="true" tabindex="-1"></a>   <span class="st">"ethiopia"</span><span class="op">:</span> <span class="st">"Eastern"</span><span class="op">,</span></span>
<span id="cb76-2593"><a href="#cb76-2593" aria-hidden="true" tabindex="-1"></a>   <span class="st">"french southern territories"</span><span class="op">:</span> <span class="st">"Eastern"</span><span class="op">,</span></span>
<span id="cb76-2594"><a href="#cb76-2594" aria-hidden="true" tabindex="-1"></a>   <span class="st">"kenya"</span><span class="op">:</span> <span class="st">"Eastern"</span><span class="op">,</span></span>
<span id="cb76-2595"><a href="#cb76-2595" aria-hidden="true" tabindex="-1"></a>   <span class="st">"madagascar"</span><span class="op">:</span> <span class="st">"Eastern"</span><span class="op">,</span></span>
<span id="cb76-2596"><a href="#cb76-2596" aria-hidden="true" tabindex="-1"></a>   <span class="st">"malawi"</span><span class="op">:</span> <span class="st">"Eastern"</span><span class="op">,</span></span>
<span id="cb76-2597"><a href="#cb76-2597" aria-hidden="true" tabindex="-1"></a>   <span class="st">"mauritius"</span><span class="op">:</span> <span class="st">"Eastern"</span><span class="op">,</span></span>
<span id="cb76-2598"><a href="#cb76-2598" aria-hidden="true" tabindex="-1"></a>   <span class="st">"mayotte"</span><span class="op">:</span> <span class="st">"Eastern"</span><span class="op">,</span></span>
<span id="cb76-2599"><a href="#cb76-2599" aria-hidden="true" tabindex="-1"></a>   <span class="st">"mozambique"</span><span class="op">:</span> <span class="st">"Eastern"</span><span class="op">,</span></span>
<span id="cb76-2600"><a href="#cb76-2600" aria-hidden="true" tabindex="-1"></a>   <span class="st">"réunion"</span><span class="op">:</span> <span class="st">"Eastern"</span><span class="op">,</span></span>
<span id="cb76-2601"><a href="#cb76-2601" aria-hidden="true" tabindex="-1"></a>   <span class="st">"rwanda"</span><span class="op">:</span> <span class="st">"Eastern"</span><span class="op">,</span></span>
<span id="cb76-2602"><a href="#cb76-2602" aria-hidden="true" tabindex="-1"></a>   <span class="st">"seychelles"</span><span class="op">:</span> <span class="st">"Eastern"</span><span class="op">,</span></span>
<span id="cb76-2603"><a href="#cb76-2603" aria-hidden="true" tabindex="-1"></a>   <span class="st">"somalia"</span><span class="op">:</span> <span class="st">"Eastern"</span><span class="op">,</span></span>
<span id="cb76-2604"><a href="#cb76-2604" aria-hidden="true" tabindex="-1"></a>   <span class="st">"south sudan"</span><span class="op">:</span> <span class="st">"Eastern"</span><span class="op">,</span></span>
<span id="cb76-2605"><a href="#cb76-2605" aria-hidden="true" tabindex="-1"></a>   <span class="st">"uganda"</span><span class="op">:</span> <span class="st">"Eastern"</span><span class="op">,</span></span>
<span id="cb76-2606"><a href="#cb76-2606" aria-hidden="true" tabindex="-1"></a>   <span class="st">"united republic of tanzania"</span><span class="op">:</span> <span class="st">"Eastern"</span><span class="op">,</span></span>
<span id="cb76-2607"><a href="#cb76-2607" aria-hidden="true" tabindex="-1"></a>   <span class="st">"zambia"</span><span class="op">:</span> <span class="st">"Eastern"</span><span class="op">,</span></span>
<span id="cb76-2608"><a href="#cb76-2608" aria-hidden="true" tabindex="-1"></a>   <span class="st">"zimbabwe"</span><span class="op">:</span> <span class="st">"Eastern"</span><span class="op">,</span></span>
<span id="cb76-2609"><a href="#cb76-2609" aria-hidden="true" tabindex="-1"></a>   <span class="st">"tanzania"</span><span class="op">:</span> <span class="st">"Eastern"</span><span class="op">,</span></span>
<span id="cb76-2610"><a href="#cb76-2610" aria-hidden="true" tabindex="-1"></a>   <span class="st">"angola"</span><span class="op">:</span> <span class="st">"Central"</span><span class="op">,</span></span>
<span id="cb76-2611"><a href="#cb76-2611" aria-hidden="true" tabindex="-1"></a>   <span class="st">"cameroon"</span><span class="op">:</span> <span class="st">"Central"</span><span class="op">,</span></span>
<span id="cb76-2612"><a href="#cb76-2612" aria-hidden="true" tabindex="-1"></a>   <span class="st">"central african republic"</span><span class="op">:</span> <span class="st">"Central"</span><span class="op">,</span></span>
<span id="cb76-2613"><a href="#cb76-2613" aria-hidden="true" tabindex="-1"></a>   <span class="st">"chad"</span><span class="op">:</span> <span class="st">"Central"</span><span class="op">,</span></span>
<span id="cb76-2614"><a href="#cb76-2614" aria-hidden="true" tabindex="-1"></a>   <span class="st">"congo"</span><span class="op">:</span> <span class="st">"Central"</span><span class="op">,</span></span>
<span id="cb76-2615"><a href="#cb76-2615" aria-hidden="true" tabindex="-1"></a>   <span class="st">"democratic republic of the congo"</span><span class="op">:</span> <span class="st">"Central"</span><span class="op">,</span></span>
<span id="cb76-2616"><a href="#cb76-2616" aria-hidden="true" tabindex="-1"></a>   <span class="st">"equatorial guinea"</span><span class="op">:</span> <span class="st">"Central"</span><span class="op">,</span></span>
<span id="cb76-2617"><a href="#cb76-2617" aria-hidden="true" tabindex="-1"></a>   <span class="st">"gabon"</span><span class="op">:</span> <span class="st">"Central"</span><span class="op">,</span></span>
<span id="cb76-2618"><a href="#cb76-2618" aria-hidden="true" tabindex="-1"></a>   <span class="st">"sao tome and principe"</span><span class="op">:</span> <span class="st">"Central"</span><span class="op">,</span></span>
<span id="cb76-2619"><a href="#cb76-2619" aria-hidden="true" tabindex="-1"></a>   <span class="st">"botswana"</span><span class="op">:</span> <span class="st">"Southern"</span><span class="op">,</span></span>
<span id="cb76-2620"><a href="#cb76-2620" aria-hidden="true" tabindex="-1"></a>   <span class="st">"eswatini"</span><span class="op">:</span> <span class="st">"Southern"</span><span class="op">,</span></span>
<span id="cb76-2621"><a href="#cb76-2621" aria-hidden="true" tabindex="-1"></a>   <span class="st">"lesotho"</span><span class="op">:</span> <span class="st">"Southern"</span><span class="op">,</span></span>
<span id="cb76-2622"><a href="#cb76-2622" aria-hidden="true" tabindex="-1"></a>   <span class="st">"namibia"</span><span class="op">:</span> <span class="st">"Southern"</span><span class="op">,</span></span>
<span id="cb76-2623"><a href="#cb76-2623" aria-hidden="true" tabindex="-1"></a>   <span class="st">"south africa"</span><span class="op">:</span> <span class="st">"Southern"</span><span class="op">,</span></span>
<span id="cb76-2624"><a href="#cb76-2624" aria-hidden="true" tabindex="-1"></a>   <span class="st">"benin"</span><span class="op">:</span> <span class="st">"Western"</span><span class="op">,</span></span>
<span id="cb76-2625"><a href="#cb76-2625" aria-hidden="true" tabindex="-1"></a>   <span class="st">"burkina faso"</span><span class="op">:</span> <span class="st">"Western"</span><span class="op">,</span></span>
<span id="cb76-2626"><a href="#cb76-2626" aria-hidden="true" tabindex="-1"></a>   <span class="st">"cabo verde"</span><span class="op">:</span> <span class="st">"Western"</span><span class="op">,</span></span>
<span id="cb76-2627"><a href="#cb76-2627" aria-hidden="true" tabindex="-1"></a>   <span class="st">"cote d'lvoire"</span><span class="op">:</span> <span class="st">"Western"</span><span class="op">,</span></span>
<span id="cb76-2628"><a href="#cb76-2628" aria-hidden="true" tabindex="-1"></a>   <span class="st">"gambia"</span><span class="op">:</span> <span class="st">"Western"</span><span class="op">,</span></span>
<span id="cb76-2629"><a href="#cb76-2629" aria-hidden="true" tabindex="-1"></a>   <span class="st">"ghana"</span><span class="op">:</span> <span class="st">"Western"</span><span class="op">,</span></span>
<span id="cb76-2630"><a href="#cb76-2630" aria-hidden="true" tabindex="-1"></a>   <span class="st">"guinea"</span><span class="op">:</span> <span class="st">"Western"</span><span class="op">,</span></span>
<span id="cb76-2631"><a href="#cb76-2631" aria-hidden="true" tabindex="-1"></a>   <span class="st">"guinea-bissau"</span><span class="op">:</span> <span class="st">"Western"</span><span class="op">,</span></span>
<span id="cb76-2632"><a href="#cb76-2632" aria-hidden="true" tabindex="-1"></a>   <span class="st">"liberia"</span><span class="op">:</span> <span class="st">"Western"</span><span class="op">,</span></span>
<span id="cb76-2633"><a href="#cb76-2633" aria-hidden="true" tabindex="-1"></a>   <span class="st">"mali"</span><span class="op">:</span> <span class="st">"Western"</span><span class="op">,</span></span>
<span id="cb76-2634"><a href="#cb76-2634" aria-hidden="true" tabindex="-1"></a>   <span class="st">"mauritania"</span><span class="op">:</span> <span class="st">"Western"</span><span class="op">,</span></span>
<span id="cb76-2635"><a href="#cb76-2635" aria-hidden="true" tabindex="-1"></a>   <span class="st">"niger"</span><span class="op">:</span> <span class="st">"Western"</span><span class="op">,</span></span>
<span id="cb76-2636"><a href="#cb76-2636" aria-hidden="true" tabindex="-1"></a>   <span class="st">"nigeria"</span><span class="op">:</span> <span class="st">"Western"</span><span class="op">,</span></span>
<span id="cb76-2637"><a href="#cb76-2637" aria-hidden="true" tabindex="-1"></a>   <span class="st">"saint helena, ascension and tristan da cunha"</span><span class="op">:</span> <span class="st">"Western"</span><span class="op">,</span></span>
<span id="cb76-2638"><a href="#cb76-2638" aria-hidden="true" tabindex="-1"></a>   <span class="st">"saint helena"</span><span class="op">:</span> <span class="st">"Western"</span><span class="op">,</span></span>
<span id="cb76-2639"><a href="#cb76-2639" aria-hidden="true" tabindex="-1"></a>   <span class="st">"ascension island"</span><span class="op">:</span> <span class="st">"Western"</span><span class="op">,</span></span>
<span id="cb76-2640"><a href="#cb76-2640" aria-hidden="true" tabindex="-1"></a>   <span class="st">"tristan da cunha"</span><span class="op">:</span> <span class="st">"Western"</span><span class="op">,</span></span>
<span id="cb76-2641"><a href="#cb76-2641" aria-hidden="true" tabindex="-1"></a>   <span class="st">"senegal"</span><span class="op">:</span> <span class="st">"Western"</span><span class="op">,</span></span>
<span id="cb76-2642"><a href="#cb76-2642" aria-hidden="true" tabindex="-1"></a>   <span class="st">"sierra leone"</span><span class="op">:</span> <span class="st">"Western"</span><span class="op">,</span></span>
<span id="cb76-2643"><a href="#cb76-2643" aria-hidden="true" tabindex="-1"></a>   <span class="st">"togo"</span><span class="op">:</span> <span class="st">"Western"</span><span class="op">,</span></span>
<span id="cb76-2644"><a href="#cb76-2644" aria-hidden="true" tabindex="-1"></a>   <span class="st">"sudan savanna"</span><span class="op">:</span> <span class="st">"Western"</span><span class="op">,</span></span>
<span id="cb76-2645"><a href="#cb76-2645" aria-hidden="true" tabindex="-1"></a>   <span class="st">"guinea bissau"</span><span class="op">:</span> <span class="st">"Western"</span></span>
<span id="cb76-2646"><a href="#cb76-2646" aria-hidden="true" tabindex="-1"></a>  }}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-76" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb77" data-startfrom="2650" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2649"><span id="cb77-2650"><a href="#cb77-2650" aria-hidden="true" tabindex="-1"></a>viewof crop_selector_dynamic_insights <span class="op">=</span> {</span>
<span id="cb77-2651"><a href="#cb77-2651" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> Inputs<span class="op">.</span><span class="fu">select</span>(</span>
<span id="cb77-2652"><a href="#cb77-2652" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"maize"</span><span class="op">,</span> <span class="st">"sorghum"</span><span class="op">,</span> <span class="st">"millet"</span><span class="op">,</span> <span class="st">"wheat"</span>]<span class="op">,</span></span>
<span id="cb77-2653"><a href="#cb77-2653" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">crop</span>)<span class="op">,</span></span>
<span id="cb77-2654"><a href="#cb77-2654" aria-hidden="true" tabindex="-1"></a>    <span class="dt">format</span><span class="op">:</span> c <span class="kw">=&gt;</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">crops</span>[c])}</span>
<span id="cb77-2655"><a href="#cb77-2655" aria-hidden="true" tabindex="-1"></a>  )  </span>
<span id="cb77-2656"><a href="#cb77-2656" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-77" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb78" data-startfrom="2660" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2659"><span id="cb78-2660"><a href="#cb78-2660" aria-hidden="true" tabindex="-1"></a>cycle_selector_options_di <span class="op">=</span> {</span>
<span id="cb78-2661"><a href="#cb78-2661" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> {</span>
<span id="cb78-2662"><a href="#cb78-2662" aria-hidden="true" tabindex="-1"></a>      <span class="dv">0</span><span class="op">:</span> {<span class="dt">cycle</span><span class="op">:</span> <span class="st">"both"</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">zoomToStable</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">growSeason</span><span class="op">.</span><span class="at">values</span><span class="op">.</span><span class="at">both</span>)}<span class="op">,</span></span>
<span id="cb78-2663"><a href="#cb78-2663" aria-hidden="true" tabindex="-1"></a>      <span class="dv">1</span><span class="op">:</span> {<span class="dt">cycle</span><span class="op">:</span> <span class="st">"1"</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">zoomToStable</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">growSeason</span><span class="op">.</span><span class="at">values</span><span class="op">.</span><span class="at">first</span>)}<span class="op">,</span></span>
<span id="cb78-2664"><a href="#cb78-2664" aria-hidden="true" tabindex="-1"></a>      <span class="dv">2</span><span class="op">:</span> {<span class="dt">cycle</span><span class="op">:</span> <span class="st">"2"</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">zoomToStable</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">growSeason</span><span class="op">.</span><span class="at">values</span><span class="op">.</span><span class="at">second</span>)}<span class="op">,</span></span>
<span id="cb78-2665"><a href="#cb78-2665" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb78-2666"><a href="#cb78-2666" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-78" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb79" data-startfrom="2670" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2669"><span id="cb79-2670"><a href="#cb79-2670" aria-hidden="true" tabindex="-1"></a>selected_cycle_options <span class="op">=</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">values</span>(cycle_selector_options_di)<span class="op">.</span><span class="fu">find</span>(</span>
<span id="cb79-2671"><a href="#cb79-2671" aria-hidden="true" tabindex="-1"></a>  (option) <span class="kw">=&gt;</span> option<span class="op">.</span><span class="at">label</span> <span class="op">===</span> cycle_selector_di<span class="op">,</span></span>
<span id="cb79-2672"><a href="#cb79-2672" aria-hidden="true" tabindex="-1"></a>)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-79" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb80" data-startfrom="2676" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2675"><span id="cb80-2676"><a href="#cb80-2676" aria-hidden="true" tabindex="-1"></a>viewof cycle_selector_di <span class="op">=</span> {</span>
<span id="cb80-2677"><a href="#cb80-2677" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> Inputs<span class="op">.</span><span class="fu">select</span>(</span>
<span id="cb80-2678"><a href="#cb80-2678" aria-hidden="true" tabindex="-1"></a>      <span class="bu">Object</span><span class="op">.</span><span class="fu">values</span>(cycle_selector_options_di)<span class="op">.</span><span class="fu">map</span>((x) <span class="kw">=&gt;</span> x<span class="op">.</span><span class="at">label</span>)<span class="op">,</span></span>
<span id="cb80-2679"><a href="#cb80-2679" aria-hidden="true" tabindex="-1"></a>      {<span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">zoomToStable</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">growSeason</span><span class="op">.</span><span class="at">title</span>) }</span>
<span id="cb80-2680"><a href="#cb80-2680" aria-hidden="true" tabindex="-1"></a>  )  </span>
<span id="cb80-2681"><a href="#cb80-2681" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-80" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb81" data-startfrom="2685" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2684"><span id="cb81-2685"><a href="#cb81-2685" aria-hidden="true" tabindex="-1"></a>scenario_options <span class="op">=</span> {</span>
<span id="cb81-2686"><a href="#cb81-2686" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> {</span>
<span id="cb81-2687"><a href="#cb81-2687" aria-hidden="true" tabindex="-1"></a>      <span class="dv">0</span><span class="op">:</span> {<span class="dt">ssp</span><span class="op">:</span> <span class="st">"SSP370"</span><span class="op">,</span> <span class="dt">horizon</span><span class="op">:</span> <span class="dv">2030</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"SSP3-7.0: 2021-2040"</span>}<span class="op">,</span></span>
<span id="cb81-2688"><a href="#cb81-2688" aria-hidden="true" tabindex="-1"></a>      <span class="dv">1</span><span class="op">:</span> {<span class="dt">ssp</span><span class="op">:</span> <span class="st">"SSP370"</span><span class="op">,</span> <span class="dt">horizon</span><span class="op">:</span> <span class="dv">2005</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">historical</span>)}<span class="op">,</span></span>
<span id="cb81-2689"><a href="#cb81-2689" aria-hidden="true" tabindex="-1"></a>      <span class="dv">2</span><span class="op">:</span> {<span class="dt">ssp</span><span class="op">:</span> <span class="st">"SSP370"</span><span class="op">,</span> <span class="dt">horizon</span><span class="op">:</span> <span class="dv">2050</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"SSP3-7.0: 2041-2060"</span>}<span class="op">,</span></span>
<span id="cb81-2690"><a href="#cb81-2690" aria-hidden="true" tabindex="-1"></a>      <span class="dv">3</span><span class="op">:</span> {<span class="dt">ssp</span><span class="op">:</span> <span class="st">"SSP585"</span><span class="op">,</span> <span class="dt">horizon</span><span class="op">:</span> <span class="dv">2030</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"SSP5-8.5: 2021-2040"</span>}<span class="op">,</span></span>
<span id="cb81-2691"><a href="#cb81-2691" aria-hidden="true" tabindex="-1"></a>      <span class="dv">4</span><span class="op">:</span> {<span class="dt">ssp</span><span class="op">:</span> <span class="st">"SSP585"</span><span class="op">,</span> <span class="dt">horizon</span><span class="op">:</span> <span class="dv">2050</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"SSP5-8.5: 2041-2060"</span>}</span>
<span id="cb81-2692"><a href="#cb81-2692" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb81-2693"><a href="#cb81-2693" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-81" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb82" data-startfrom="2697" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2696"><span id="cb82-2697"><a href="#cb82-2697" aria-hidden="true" tabindex="-1"></a>viewof scenario_selector_di <span class="op">=</span> {</span>
<span id="cb82-2698"><a href="#cb82-2698" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> Inputs<span class="op">.</span><span class="fu">select</span>(</span>
<span id="cb82-2699"><a href="#cb82-2699" aria-hidden="true" tabindex="-1"></a>      <span class="bu">Object</span><span class="op">.</span><span class="fu">values</span>(scenario_options)<span class="op">.</span><span class="fu">map</span>((x) <span class="kw">=&gt;</span> x<span class="op">.</span><span class="at">label</span>)<span class="op">,</span></span>
<span id="cb82-2700"><a href="#cb82-2700" aria-hidden="true" tabindex="-1"></a>      {<span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">scenario</span>)<span class="op">,</span></span>
<span id="cb82-2701"><a href="#cb82-2701" aria-hidden="true" tabindex="-1"></a>       <span class="dt">format</span><span class="op">:</span> l <span class="kw">=&gt;</span> l <span class="op">===</span> <span class="st">"Historical"</span><span class="op">?</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">historical</span>) <span class="op">:</span> l}</span>
<span id="cb82-2702"><a href="#cb82-2702" aria-hidden="true" tabindex="-1"></a>  )  </span>
<span id="cb82-2703"><a href="#cb82-2703" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-82" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb83" data-startfrom="2707" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2706"><span id="cb83-2707"><a href="#cb83-2707" aria-hidden="true" tabindex="-1"></a>selected_scenario <span class="op">=</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">values</span>(scenario_options)<span class="op">.</span><span class="fu">find</span>(</span>
<span id="cb83-2708"><a href="#cb83-2708" aria-hidden="true" tabindex="-1"></a>  (option) <span class="kw">=&gt;</span> option<span class="op">.</span><span class="at">label</span> <span class="op">===</span> scenario_selector_di<span class="op">,</span></span>
<span id="cb83-2709"><a href="#cb83-2709" aria-hidden="true" tabindex="-1"></a>)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-83" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb84" data-startfrom="2713" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2712"><span id="cb84-2713"><a href="#cb84-2713" aria-hidden="true" tabindex="-1"></a>yield_output_options <span class="op">=</span> {</span>
<span id="cb84-2714"><a href="#cb84-2714" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> {</span>
<span id="cb84-2715"><a href="#cb84-2715" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span><span class="op">:</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"Yield change (ton/ha)"</span>}<span class="op">,</span></span>
<span id="cb84-2716"><a href="#cb84-2716" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span><span class="op">:</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"Yield (ton/ha)"</span>}<span class="op">,</span></span>
<span id="cb84-2717"><a href="#cb84-2717" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span><span class="op">:</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"Yield change (%)"</span>}<span class="op">,</span></span>
<span id="cb84-2718"><a href="#cb84-2718" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span><span class="op">:</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"Uncertainty in yield (ton/ha)"</span>}<span class="op">,</span></span>
<span id="cb84-2719"><a href="#cb84-2719" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb84-2720"><a href="#cb84-2720" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-84" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb85" data-startfrom="2724" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2723"><span id="cb85-2724"><a href="#cb85-2724" aria-hidden="true" tabindex="-1"></a>viewof yield_output_selector_di <span class="op">=</span> {</span>
<span id="cb85-2725"><a href="#cb85-2725" aria-hidden="true" tabindex="-1"></a> <span class="kw">let</span> options </span>
<span id="cb85-2726"><a href="#cb85-2726" aria-hidden="true" tabindex="-1"></a>   <span class="cf">if</span> (scenario_selector_di <span class="op">===</span> <span class="st">"Historique"</span> <span class="op">||</span> scenario_selector_di <span class="op">===</span> <span class="st">"Historic"</span>) {</span>
<span id="cb85-2727"><a href="#cb85-2727" aria-hidden="true" tabindex="-1"></a>     options <span class="op">=</span> [<span class="st">"Yield (ton/ha)"</span><span class="op">,</span> <span class="st">"Uncertainty in yield (ton/ha)"</span>]</span>
<span id="cb85-2728"><a href="#cb85-2728" aria-hidden="true" tabindex="-1"></a>   } <span class="cf">else</span> {</span>
<span id="cb85-2729"><a href="#cb85-2729" aria-hidden="true" tabindex="-1"></a>     options <span class="op">=</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">values</span>(yield_output_options)<span class="op">.</span><span class="fu">map</span>((x) <span class="kw">=&gt;</span> x<span class="op">.</span><span class="at">label</span>)</span>
<span id="cb85-2730"><a href="#cb85-2730" aria-hidden="true" tabindex="-1"></a>   }</span>
<span id="cb85-2731"><a href="#cb85-2731" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> Inputs<span class="op">.</span><span class="fu">select</span>(</span>
<span id="cb85-2732"><a href="#cb85-2732" aria-hidden="true" tabindex="-1"></a>      options<span class="op">,</span></span>
<span id="cb85-2733"><a href="#cb85-2733" aria-hidden="true" tabindex="-1"></a>      {<span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">zoomToStable</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">YieldOutput</span><span class="op">.</span><span class="at">title</span>)<span class="op">,</span></span>
<span id="cb85-2734"><a href="#cb85-2734" aria-hidden="true" tabindex="-1"></a>       <span class="dt">format</span><span class="op">:</span> l <span class="kw">=&gt;</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">zoomToStable</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">YieldOutput</span><span class="op">.</span><span class="at">values</span>[l])}</span>
<span id="cb85-2735"><a href="#cb85-2735" aria-hidden="true" tabindex="-1"></a>  )  </span>
<span id="cb85-2736"><a href="#cb85-2736" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-85" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb86" data-startfrom="2740" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2739"><span id="cb86-2740"><a href="#cb86-2740" aria-hidden="true" tabindex="-1"></a>selected_yield_output <span class="op">=</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">values</span>(yield_output_options)<span class="op">.</span><span class="fu">find</span>(</span>
<span id="cb86-2741"><a href="#cb86-2741" aria-hidden="true" tabindex="-1"></a>  (option) <span class="kw">=&gt;</span> option<span class="op">.</span><span class="at">label</span> <span class="op">===</span> yield_output_selector_di<span class="op">,</span></span>
<span id="cb86-2742"><a href="#cb86-2742" aria-hidden="true" tabindex="-1"></a>)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-86" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb87" data-startfrom="2746" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2745"><span id="cb87-2746"><a href="#cb87-2746" aria-hidden="true" tabindex="-1"></a>cultivar_options <span class="op">=</span> {</span>
<span id="cb87-2747"><a href="#cb87-2747" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> {</span>
<span id="cb87-2748"><a href="#cb87-2748" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span><span class="op">:</span> {<span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">zoomToStable</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">Cultivar</span><span class="op">.</span><span class="at">values</span><span class="op">.</span><span class="at">current</span>)<span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="st">"current"</span>}<span class="op">,</span></span>
<span id="cb87-2749"><a href="#cb87-2749" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span><span class="op">:</span> {<span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">zoomToStable</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">Cultivar</span><span class="op">.</span><span class="at">values</span><span class="op">.</span><span class="at">early</span>)<span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="st">"early"</span>}<span class="op">,</span></span>
<span id="cb87-2750"><a href="#cb87-2750" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span><span class="op">:</span> {<span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">zoomToStable</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">Cultivar</span><span class="op">.</span><span class="at">values</span><span class="op">.</span><span class="at">late</span>)<span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="st">"late"</span>}<span class="op">,</span></span>
<span id="cb87-2751"><a href="#cb87-2751" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb87-2752"><a href="#cb87-2752" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-87" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb88" data-startfrom="2756" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2755"><span id="cb88-2756"><a href="#cb88-2756" aria-hidden="true" tabindex="-1"></a>viewof cultivar_selector_di <span class="op">=</span> {</span>
<span id="cb88-2757"><a href="#cb88-2757" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> Inputs<span class="op">.</span><span class="fu">select</span>(</span>
<span id="cb88-2758"><a href="#cb88-2758" aria-hidden="true" tabindex="-1"></a>      <span class="bu">Object</span><span class="op">.</span><span class="fu">values</span>(cultivar_options)<span class="op">.</span><span class="fu">map</span>((x) <span class="kw">=&gt;</span> x<span class="op">.</span><span class="at">label</span>)<span class="op">,</span></span>
<span id="cb88-2759"><a href="#cb88-2759" aria-hidden="true" tabindex="-1"></a>      {<span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">zoomToStable</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">Cultivar</span><span class="op">.</span><span class="at">title</span>) }</span>
<span id="cb88-2760"><a href="#cb88-2760" aria-hidden="true" tabindex="-1"></a>  )  </span>
<span id="cb88-2761"><a href="#cb88-2761" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-88" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb89" data-startfrom="2765" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2764"><span id="cb89-2765"><a href="#cb89-2765" aria-hidden="true" tabindex="-1"></a>selected_cultivar <span class="op">=</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">values</span>(cultivar_options)<span class="op">.</span><span class="fu">find</span>(</span>
<span id="cb89-2766"><a href="#cb89-2766" aria-hidden="true" tabindex="-1"></a>  (option) <span class="kw">=&gt;</span> option<span class="op">.</span><span class="at">label</span> <span class="op">===</span> cultivar_selector_di<span class="op">,</span></span>
<span id="cb89-2767"><a href="#cb89-2767" aria-hidden="true" tabindex="-1"></a>)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-89" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb90" data-startfrom="2771" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2770"><span id="cb90-2771"><a href="#cb90-2771" aria-hidden="true" tabindex="-1"></a>zoom_in_elements <span class="op">=</span> {</span>
<span id="cb90-2772"><a href="#cb90-2772" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> form <span class="op">=</span> [</span>
<span id="cb90-2773"><a href="#cb90-2773" aria-hidden="true" tabindex="-1"></a>      viewof crop_selector_dynamic_insights<span class="op">,</span></span>
<span id="cb90-2774"><a href="#cb90-2774" aria-hidden="true" tabindex="-1"></a>      viewof cycle_selector_di<span class="op">,</span></span>
<span id="cb90-2775"><a href="#cb90-2775" aria-hidden="true" tabindex="-1"></a>      viewof scenario_selector_di<span class="op">,</span></span>
<span id="cb90-2776"><a href="#cb90-2776" aria-hidden="true" tabindex="-1"></a>      viewof yield_output_selector_di<span class="op">,</span></span>
<span id="cb90-2777"><a href="#cb90-2777" aria-hidden="true" tabindex="-1"></a>      viewof cultivar_selector_di<span class="op">,</span></span>
<span id="cb90-2778"><a href="#cb90-2778" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb90-2779"><a href="#cb90-2779" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> form</span>
<span id="cb90-2780"><a href="#cb90-2780" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-90" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb91" data-startfrom="2784" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2783"><span id="cb91-2784"><a href="#cb91-2784" aria-hidden="true" tabindex="-1"></a>viewof selectAdmin0 <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">select</span>(dataAdmin0<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> adminRegions<span class="op">.</span><span class="at">labels</span><span class="op">.</span><span class="at">admin0</span>})</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-91" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb92" data-startfrom="2788" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2787"><span id="cb92-2788"><a href="#cb92-2788" aria-hidden="true" tabindex="-1"></a>viewof selectAdmin1 <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">select</span>(dataAdmin1<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> adminRegions<span class="op">.</span><span class="at">labels</span><span class="op">.</span><span class="at">admin1</span>})</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-92" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb93" data-startfrom="2792" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2791"><span id="cb93-2792"><a href="#cb93-2792" aria-hidden="true" tabindex="-1"></a>viewof selectAdmin2 <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">select</span>(dataAdmin2<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> adminRegions<span class="op">.</span><span class="at">labels</span><span class="op">.</span><span class="at">admin2</span>})</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-93" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb94" data-startfrom="2796" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2795"><span id="cb94-2796"><a href="#cb94-2796" aria-hidden="true" tabindex="-1"></a><span class="co">// selected admin regions from dropdowns</span></span>
<span id="cb94-2797"><a href="#cb94-2797" aria-hidden="true" tabindex="-1"></a>adminSelections <span class="op">=</span> <span class="kw">new</span> <span class="bu">Object</span>({</span>
<span id="cb94-2798"><a href="#cb94-2798" aria-hidden="true" tabindex="-1"></a>  selectAdmin0<span class="op">,</span></span>
<span id="cb94-2799"><a href="#cb94-2799" aria-hidden="true" tabindex="-1"></a>  selectAdmin1<span class="op">,</span></span>
<span id="cb94-2800"><a href="#cb94-2800" aria-hidden="true" tabindex="-1"></a>  selectAdmin2<span class="op">,</span></span>
<span id="cb94-2801"><a href="#cb94-2801" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-94" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb95" data-startfrom="2805" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2804"><span id="cb95-2805"><a href="#cb95-2805" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">arrayMin</span>(arr) {</span>
<span id="cb95-2806"><a href="#cb95-2806" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> len <span class="op">=</span> arr<span class="op">.</span><span class="at">length</span><span class="op">,</span></span>
<span id="cb95-2807"><a href="#cb95-2807" aria-hidden="true" tabindex="-1"></a>    min <span class="op">=</span> <span class="kw">Infinity</span><span class="op">;</span></span>
<span id="cb95-2808"><a href="#cb95-2808" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (len<span class="op">--</span>) {</span>
<span id="cb95-2809"><a href="#cb95-2809" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (arr[len] <span class="op">&lt;</span> min) {</span>
<span id="cb95-2810"><a href="#cb95-2810" aria-hidden="true" tabindex="-1"></a>      min <span class="op">=</span> arr[len]<span class="op">;</span></span>
<span id="cb95-2811"><a href="#cb95-2811" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb95-2812"><a href="#cb95-2812" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb95-2813"><a href="#cb95-2813" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> min<span class="op">;</span></span>
<span id="cb95-2814"><a href="#cb95-2814" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-95" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb96" data-startfrom="2818" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2817"><span id="cb96-2818"><a href="#cb96-2818" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">arrayMax</span>(arr) {</span>
<span id="cb96-2819"><a href="#cb96-2819" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> len <span class="op">=</span> arr<span class="op">.</span><span class="at">length</span><span class="op">,</span></span>
<span id="cb96-2820"><a href="#cb96-2820" aria-hidden="true" tabindex="-1"></a>    max <span class="op">=</span> <span class="op">-</span><span class="kw">Infinity</span><span class="op">;</span></span>
<span id="cb96-2821"><a href="#cb96-2821" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (len<span class="op">--</span>) {</span>
<span id="cb96-2822"><a href="#cb96-2822" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (arr[len] <span class="op">&gt;</span> max) {</span>
<span id="cb96-2823"><a href="#cb96-2823" aria-hidden="true" tabindex="-1"></a>      max <span class="op">=</span> arr[len]<span class="op">;</span></span>
<span id="cb96-2824"><a href="#cb96-2824" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb96-2825"><a href="#cb96-2825" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb96-2826"><a href="#cb96-2826" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> max<span class="op">;</span></span>
<span id="cb96-2827"><a href="#cb96-2827" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-96" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb97" data-startfrom="2831" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2830"><span id="cb97-2831"><a href="#cb97-2831" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">get_yield_column</span>(yield_output_selection<span class="op">,</span> yield_type) {</span>
<span id="cb97-2832"><a href="#cb97-2832" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> {</span>
<span id="cb97-2833"><a href="#cb97-2833" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Yield (ton/ha)"</span><span class="op">:</span> <span class="st">"yield_"</span> <span class="op">+</span> yield_type <span class="op">+</span> <span class="st">"_avg"</span><span class="op">,</span></span>
<span id="cb97-2834"><a href="#cb97-2834" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Yield change (ton/ha)"</span><span class="op">:</span> <span class="st">"yield_"</span> <span class="op">+</span> yield_type <span class="op">+</span> <span class="st">"_abs_change"</span><span class="op">,</span></span>
<span id="cb97-2835"><a href="#cb97-2835" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Yield change (%)"</span><span class="op">:</span> <span class="st">"yield_"</span> <span class="op">+</span> yield_type <span class="op">+</span> <span class="st">"_rlt_change"</span><span class="op">,</span></span>
<span id="cb97-2836"><a href="#cb97-2836" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Uncertainty in yield (ton/ha)"</span><span class="op">:</span> <span class="st">"yield_"</span> <span class="op">+</span> yield_type <span class="op">+</span> <span class="st">"_rng"</span><span class="op">,</span></span>
<span id="cb97-2837"><a href="#cb97-2837" aria-hidden="true" tabindex="-1"></a>  }[yield_output_selection]<span class="op">;</span></span>
<span id="cb97-2838"><a href="#cb97-2838" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-97" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb98" data-startfrom="2842" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2841"><span id="cb98-2842"><a href="#cb98-2842" aria-hidden="true" tabindex="-1"></a>mapDataColumn <span class="op">=</span> <span class="fu">get_yield_column</span>(</span>
<span id="cb98-2843"><a href="#cb98-2843" aria-hidden="true" tabindex="-1"></a>  selected_yield_output<span class="op">.</span><span class="at">label</span><span class="op">,</span></span>
<span id="cb98-2844"><a href="#cb98-2844" aria-hidden="true" tabindex="-1"></a>  selectGeoDataType<span class="op">.</span><span class="at">labelTip</span><span class="op">,</span></span>
<span id="cb98-2845"><a href="#cb98-2845" aria-hidden="true" tabindex="-1"></a>)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-98" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb99" data-startfrom="2849" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2848"><span id="cb99-2849"><a href="#cb99-2849" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`## Adapting to the future changes`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-99" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb100" data-startfrom="2853" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2852"><span id="cb100-2853"><a href="#cb100-2853" aria-hidden="true" tabindex="-1"></a>colorYellowGreen <span class="op">=</span> [<span class="st">"#F7D732"</span><span class="op">,</span> <span class="st">"#216729"</span>]<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-100" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb101" data-startfrom="2857" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2856"><span id="cb101-2857"><a href="#cb101-2857" aria-hidden="true" tabindex="-1"></a>formatNum <span class="op">=</span> d3<span class="op">.</span><span class="fu">format</span>(<span class="st">".2f"</span>)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-101" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb102" data-startfrom="2861" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2860"><span id="cb102-2861"><a href="#cb102-2861" aria-hidden="true" tabindex="-1"></a>atfc_crop_options <span class="op">=</span> {</span>
<span id="cb102-2862"><a href="#cb102-2862" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> opts <span class="op">=</span> {</span>
<span id="cb102-2863"><a href="#cb102-2863" aria-hidden="true" tabindex="-1"></a>      <span class="dv">0</span><span class="op">:</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"maize"</span><span class="op">,</span> <span class="dt">crop</span><span class="op">:</span> <span class="st">"maize"</span>}<span class="op">,</span></span>
<span id="cb102-2864"><a href="#cb102-2864" aria-hidden="true" tabindex="-1"></a>      <span class="dv">1</span><span class="op">:</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"sorghum"</span><span class="op">,</span> <span class="dt">crop</span><span class="op">:</span> <span class="st">"sorghum"</span>}<span class="op">,</span></span>
<span id="cb102-2865"><a href="#cb102-2865" aria-hidden="true" tabindex="-1"></a>      <span class="dv">2</span><span class="op">:</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"millet"</span><span class="op">,</span> <span class="dt">crop</span><span class="op">:</span> <span class="st">"millet"</span>}<span class="op">,</span></span>
<span id="cb102-2866"><a href="#cb102-2866" aria-hidden="true" tabindex="-1"></a>      <span class="dv">3</span><span class="op">:</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"wheat"</span><span class="op">,</span> <span class="dt">crop</span><span class="op">:</span> <span class="st">"wheat"</span>}<span class="op">,</span></span>
<span id="cb102-2867"><a href="#cb102-2867" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb102-2868"><a href="#cb102-2868" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> opts</span>
<span id="cb102-2869"><a href="#cb102-2869" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-102" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb103" data-startfrom="2873" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2872"><span id="cb103-2873"><a href="#cb103-2873" aria-hidden="true" tabindex="-1"></a>viewof atfc_crop_selector <span class="op">=</span> {</span>
<span id="cb103-2874"><a href="#cb103-2874" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> Inputs<span class="op">.</span><span class="fu">select</span>(</span>
<span id="cb103-2875"><a href="#cb103-2875" aria-hidden="true" tabindex="-1"></a>    <span class="bu">Object</span><span class="op">.</span><span class="fu">values</span>(atfc_crop_options)<span class="op">.</span><span class="fu">map</span>((x) <span class="kw">=&gt;</span> x<span class="op">.</span><span class="at">label</span>)<span class="op">,</span></span>
<span id="cb103-2876"><a href="#cb103-2876" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">crop</span>)<span class="op">,</span></span>
<span id="cb103-2877"><a href="#cb103-2877" aria-hidden="true" tabindex="-1"></a>    <span class="dt">format</span><span class="op">:</span> l <span class="kw">=&gt;</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">crops</span>[l])}</span>
<span id="cb103-2878"><a href="#cb103-2878" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb103-2879"><a href="#cb103-2879" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-103" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb104" data-startfrom="2883" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2882"><span id="cb104-2883"><a href="#cb104-2883" aria-hidden="true" tabindex="-1"></a>selected_crop_atfc <span class="op">=</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">values</span>(atfc_crop_options)<span class="op">.</span><span class="fu">find</span>(</span>
<span id="cb104-2884"><a href="#cb104-2884" aria-hidden="true" tabindex="-1"></a>  (option) <span class="kw">=&gt;</span> option<span class="op">.</span><span class="at">label</span> <span class="op">==</span> atfc_crop_selector<span class="op">,</span></span>
<span id="cb104-2885"><a href="#cb104-2885" aria-hidden="true" tabindex="-1"></a>)<span class="op">.</span><span class="at">crop</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-104" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb105" data-startfrom="2889" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2888"><span id="cb105-2889"><a href="#cb105-2889" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb105-2890"><a href="#cb105-2890" aria-hidden="true" tabindex="-1"></a><span class="co">[Adaptation option selector] Selector for the combinatorial of fields ‘cultivar’ and ‘irrigation’ in data file. Cultivar options are current (labeled as “Current (no cultivar adaptation)”), early (labeled as “Early maturity”), and late (labeled as “Late maturity”). Irrigation options are Yes, No. “Yes” uses the “yield_irr” data (needs to be aggregated in the same way it was done for “yield_rfd” above) and the “No” uses the “yield_rfd”.as follows,</span></span>
<span id="cb105-2891"><a href="#cb105-2891" aria-hidden="true" tabindex="-1"></a><span class="co">    No adaptation – this is data from ‘current’ cultivar, and ‘yield_rfd’</span></span>
<span id="cb105-2892"><a href="#cb105-2892" aria-hidden="true" tabindex="-1"></a><span class="co">    Current cultivar, irrigation – this is data from current cultivar but yield_irr</span></span>
<span id="cb105-2893"><a href="#cb105-2893" aria-hidden="true" tabindex="-1"></a><span class="co">    Early maturity, no irrigation – this is data from early cultivar but yield_rfd</span></span>
<span id="cb105-2894"><a href="#cb105-2894" aria-hidden="true" tabindex="-1"></a><span class="co">    Early maturity, irrigation – this is data from early cultivar but yield_irr</span></span>
<span id="cb105-2895"><a href="#cb105-2895" aria-hidden="true" tabindex="-1"></a><span class="co">    Late maturity, no irrigation – this is data from late cultivar but yield_rfd</span></span>
<span id="cb105-2896"><a href="#cb105-2896" aria-hidden="true" tabindex="-1"></a><span class="co">    Late maturity, irrigation – this is data from late cultivar but yield_irr</span></span>
<span id="cb105-2897"><a href="#cb105-2897" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;note: a second data file for adaptation will be shared by us. We’ll make it consistent with what you need.&gt;</span></span>
<span id="cb105-2898"><a href="#cb105-2898" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb105-2899"><a href="#cb105-2899" aria-hidden="true" tabindex="-1"></a>adapting_to_future_changes_options <span class="op">=</span> {</span>
<span id="cb105-2900"><a href="#cb105-2900" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> adapting_to_future_changes_options <span class="op">=</span> {</span>
<span id="cb105-2901"><a href="#cb105-2901" aria-hidden="true" tabindex="-1"></a>      <span class="dv">0</span><span class="op">:</span> {<span class="dt">cultivar</span><span class="op">:</span> <span class="st">""</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">""</span>}<span class="op">,</span></span>
<span id="cb105-2902"><a href="#cb105-2902" aria-hidden="true" tabindex="-1"></a>      <span class="dv">1</span><span class="op">:</span> {<span class="dt">cultivar</span><span class="op">:</span> <span class="st">"current"</span><span class="op">,</span> <span class="dt">yield</span><span class="op">:</span> <span class="st">"yield_rfd"</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"No adaptation"</span>}<span class="op">,</span></span>
<span id="cb105-2903"><a href="#cb105-2903" aria-hidden="true" tabindex="-1"></a>      <span class="dv">2</span><span class="op">:</span> {<span class="dt">cultivar</span><span class="op">:</span> <span class="st">"current"</span><span class="op">,</span> <span class="dt">yield</span><span class="op">:</span> <span class="st">"yield_irr"</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"Current cultivar, irrigation"</span>}<span class="op">,</span></span>
<span id="cb105-2904"><a href="#cb105-2904" aria-hidden="true" tabindex="-1"></a>      <span class="dv">3</span><span class="op">:</span> {<span class="dt">cultivar</span><span class="op">:</span> <span class="st">"early"</span><span class="op">,</span> <span class="dt">yield</span><span class="op">:</span> <span class="st">"yield_rfd"</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"Early maturity, no irrigation"</span>}<span class="op">,</span></span>
<span id="cb105-2905"><a href="#cb105-2905" aria-hidden="true" tabindex="-1"></a>      <span class="dv">4</span><span class="op">:</span> {<span class="dt">cultivar</span><span class="op">:</span> <span class="st">"early"</span><span class="op">,</span> <span class="dt">yield</span><span class="op">:</span> <span class="st">"yield_irr"</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"Early maturity, irrigation"</span>}<span class="op">,</span></span>
<span id="cb105-2906"><a href="#cb105-2906" aria-hidden="true" tabindex="-1"></a>      <span class="dv">5</span><span class="op">:</span> {<span class="dt">cultivar</span><span class="op">:</span> <span class="st">"late"</span><span class="op">,</span> <span class="dt">yield</span><span class="op">:</span> <span class="st">"yield_rfd"</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"Late maturity, no irrigation"</span>}<span class="op">,</span></span>
<span id="cb105-2907"><a href="#cb105-2907" aria-hidden="true" tabindex="-1"></a>      <span class="dv">6</span><span class="op">:</span> {<span class="dt">cultivar</span><span class="op">:</span> <span class="st">"late"</span><span class="op">,</span> <span class="dt">yield</span><span class="op">:</span> <span class="st">"yield_irr"</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"Late maturity, irrigation"</span>}</span>
<span id="cb105-2908"><a href="#cb105-2908" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb105-2909"><a href="#cb105-2909" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> adapting_to_future_changes_options</span>
<span id="cb105-2910"><a href="#cb105-2910" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-105" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb106" data-startfrom="2914" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2913"><span id="cb106-2914"><a href="#cb106-2914" aria-hidden="true" tabindex="-1"></a>atfc_scenario_selector_options <span class="op">=</span> {</span>
<span id="cb106-2915"><a href="#cb106-2915" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> {</span>
<span id="cb106-2916"><a href="#cb106-2916" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span><span class="op">:</span> {<span class="dt">label</span><span class="op">:</span> <span class="vs">`SSP3-7.0 (</span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">emission_ssp370</span>)<span class="sc">}</span><span class="vs">)`</span><span class="op">,</span> <span class="dt">ssp</span><span class="op">:</span> <span class="st">"SSP370"</span>}<span class="op">,</span></span>
<span id="cb106-2917"><a href="#cb106-2917" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span><span class="op">:</span> {<span class="dt">label</span><span class="op">:</span> <span class="vs">`SSP5-8.5 (</span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">emission_ssp585</span>)<span class="sc">}</span><span class="vs">)`</span><span class="op">,</span> <span class="dt">ssp</span><span class="op">:</span> <span class="st">"SSP585"</span>}<span class="op">,</span></span>
<span id="cb106-2918"><a href="#cb106-2918" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb106-2919"><a href="#cb106-2919" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-106" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb107" data-startfrom="2923" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2922"><span id="cb107-2923"><a href="#cb107-2923" aria-hidden="true" tabindex="-1"></a>viewof atfc_cycle_selector <span class="op">=</span> {</span>
<span id="cb107-2924"><a href="#cb107-2924" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> Inputs<span class="op">.</span><span class="fu">select</span>(</span>
<span id="cb107-2925"><a href="#cb107-2925" aria-hidden="true" tabindex="-1"></a>      <span class="bu">Object</span><span class="op">.</span><span class="fu">values</span>(cycle_selector_options_di)<span class="op">.</span><span class="fu">map</span>((x) <span class="kw">=&gt;</span> x<span class="op">.</span><span class="at">cycle</span>)<span class="op">,</span></span>
<span id="cb107-2926"><a href="#cb107-2926" aria-hidden="true" tabindex="-1"></a>      {<span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">zoomToStable</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">growSeason</span><span class="op">.</span><span class="at">title</span>) }</span>
<span id="cb107-2927"><a href="#cb107-2927" aria-hidden="true" tabindex="-1"></a>  )  </span>
<span id="cb107-2928"><a href="#cb107-2928" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-107" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb108" data-startfrom="2932" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2931"><span id="cb108-2932"><a href="#cb108-2932" aria-hidden="true" tabindex="-1"></a>viewof atfc_scenario_selector <span class="op">=</span> {</span>
<span id="cb108-2933"><a href="#cb108-2933" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> Inputs<span class="op">.</span><span class="fu">select</span>(</span>
<span id="cb108-2934"><a href="#cb108-2934" aria-hidden="true" tabindex="-1"></a>      <span class="bu">Object</span><span class="op">.</span><span class="fu">values</span>(atfc_scenario_selector_options)<span class="op">.</span><span class="fu">map</span>((x) <span class="kw">=&gt;</span> x<span class="op">.</span><span class="at">ssp</span>)<span class="op">,</span></span>
<span id="cb108-2935"><a href="#cb108-2935" aria-hidden="true" tabindex="-1"></a>      {<span class="dt">label</span><span class="op">:</span> <span class="st">"Scenario"</span>}</span>
<span id="cb108-2936"><a href="#cb108-2936" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb108-2937"><a href="#cb108-2937" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-108" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb109" data-startfrom="2941" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2940"><span id="cb109-2941"><a href="#cb109-2941" aria-hidden="true" tabindex="-1"></a>dataYieldATFC1 <span class="op">=</span> {</span>
<span id="cb109-2942"><a href="#cb109-2942" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> [</span>
<span id="cb109-2943"><a href="#cb109-2943" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb109-2944"><a href="#cb109-2944" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Practice</span><span class="op">:</span><span class="st">"No adaptation"</span><span class="op">,</span></span>
<span id="cb109-2945"><a href="#cb109-2945" aria-hidden="true" tabindex="-1"></a>      <span class="dt">AEZ_Class_FAO</span><span class="op">:</span> <span class="st">"historical"</span><span class="op">,</span></span>
<span id="cb109-2946"><a href="#cb109-2946" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Mean_Difference</span><span class="op">:</span> <span class="dv">3</span><span class="op">,</span></span>
<span id="cb109-2947"><a href="#cb109-2947" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb109-2948"><a href="#cb109-2948" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb109-2949"><a href="#cb109-2949" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Practice</span><span class="op">:</span><span class="st">"No adaptation"</span><span class="op">,</span></span>
<span id="cb109-2950"><a href="#cb109-2950" aria-hidden="true" tabindex="-1"></a>      <span class="dt">AEZ_Class_FAO</span><span class="op">:</span> <span class="st">"2030"</span><span class="op">,</span></span>
<span id="cb109-2951"><a href="#cb109-2951" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Mean_Difference</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb109-2952"><a href="#cb109-2952" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb109-2953"><a href="#cb109-2953" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb109-2954"><a href="#cb109-2954" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Practice</span><span class="op">:</span><span class="st">"No adaptation"</span><span class="op">,</span></span>
<span id="cb109-2955"><a href="#cb109-2955" aria-hidden="true" tabindex="-1"></a>      <span class="dt">AEZ_Class_FAO</span><span class="op">:</span> <span class="st">"2050"</span><span class="op">,</span></span>
<span id="cb109-2956"><a href="#cb109-2956" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Mean_Difference</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb109-2957"><a href="#cb109-2957" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb109-2958"><a href="#cb109-2958" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb109-2959"><a href="#cb109-2959" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Practice</span><span class="op">:</span><span class="st">"Irrigation"</span><span class="op">,</span></span>
<span id="cb109-2960"><a href="#cb109-2960" aria-hidden="true" tabindex="-1"></a>      <span class="dt">AEZ_Class_FAO</span><span class="op">:</span> <span class="st">"historical"</span><span class="op">,</span></span>
<span id="cb109-2961"><a href="#cb109-2961" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Mean_Difference</span><span class="op">:</span> <span class="dv">3</span><span class="op">,</span></span>
<span id="cb109-2962"><a href="#cb109-2962" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb109-2963"><a href="#cb109-2963" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb109-2964"><a href="#cb109-2964" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Practice</span><span class="op">:</span><span class="st">"Irrigation"</span><span class="op">,</span></span>
<span id="cb109-2965"><a href="#cb109-2965" aria-hidden="true" tabindex="-1"></a>      <span class="dt">AEZ_Class_FAO</span><span class="op">:</span> <span class="st">"2030"</span><span class="op">,</span></span>
<span id="cb109-2966"><a href="#cb109-2966" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Mean_Difference</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb109-2967"><a href="#cb109-2967" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb109-2968"><a href="#cb109-2968" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb109-2969"><a href="#cb109-2969" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Practice</span><span class="op">:</span><span class="st">"Irrigation"</span><span class="op">,</span></span>
<span id="cb109-2970"><a href="#cb109-2970" aria-hidden="true" tabindex="-1"></a>      <span class="dt">AEZ_Class_FAO</span><span class="op">:</span> <span class="st">"2050"</span><span class="op">,</span></span>
<span id="cb109-2971"><a href="#cb109-2971" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Mean_Difference</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb109-2972"><a href="#cb109-2972" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb109-2973"><a href="#cb109-2973" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb109-2974"><a href="#cb109-2974" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Practice</span><span class="op">:</span><span class="st">"Early cultivar"</span><span class="op">,</span></span>
<span id="cb109-2975"><a href="#cb109-2975" aria-hidden="true" tabindex="-1"></a>      <span class="dt">AEZ_Class_FAO</span><span class="op">:</span> <span class="st">"historical"</span><span class="op">,</span></span>
<span id="cb109-2976"><a href="#cb109-2976" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Mean_Difference</span><span class="op">:</span> <span class="dv">3</span><span class="op">,</span></span>
<span id="cb109-2977"><a href="#cb109-2977" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb109-2978"><a href="#cb109-2978" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb109-2979"><a href="#cb109-2979" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Practice</span><span class="op">:</span><span class="st">"Early cultivar"</span><span class="op">,</span></span>
<span id="cb109-2980"><a href="#cb109-2980" aria-hidden="true" tabindex="-1"></a>      <span class="dt">AEZ_Class_FAO</span><span class="op">:</span> <span class="st">"2030"</span><span class="op">,</span></span>
<span id="cb109-2981"><a href="#cb109-2981" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Mean_Difference</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb109-2982"><a href="#cb109-2982" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb109-2983"><a href="#cb109-2983" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb109-2984"><a href="#cb109-2984" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Practice</span><span class="op">:</span><span class="st">"Early cultivar"</span><span class="op">,</span></span>
<span id="cb109-2985"><a href="#cb109-2985" aria-hidden="true" tabindex="-1"></a>      <span class="dt">AEZ_Class_FAO</span><span class="op">:</span> <span class="st">"2050"</span><span class="op">,</span></span>
<span id="cb109-2986"><a href="#cb109-2986" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Mean_Difference</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb109-2987"><a href="#cb109-2987" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb109-2988"><a href="#cb109-2988" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb109-2989"><a href="#cb109-2989" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Practice</span><span class="op">:</span><span class="st">"Late cultivar"</span><span class="op">,</span></span>
<span id="cb109-2990"><a href="#cb109-2990" aria-hidden="true" tabindex="-1"></a>      <span class="dt">AEZ_Class_FAO</span><span class="op">:</span> <span class="st">"historical"</span><span class="op">,</span></span>
<span id="cb109-2991"><a href="#cb109-2991" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Mean_Difference</span><span class="op">:</span> <span class="dv">3</span><span class="op">,</span></span>
<span id="cb109-2992"><a href="#cb109-2992" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb109-2993"><a href="#cb109-2993" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb109-2994"><a href="#cb109-2994" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Practice</span><span class="op">:</span><span class="st">"Late cultivar"</span><span class="op">,</span></span>
<span id="cb109-2995"><a href="#cb109-2995" aria-hidden="true" tabindex="-1"></a>      <span class="dt">AEZ_Class_FAO</span><span class="op">:</span> <span class="st">"2030"</span><span class="op">,</span></span>
<span id="cb109-2996"><a href="#cb109-2996" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Mean_Difference</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb109-2997"><a href="#cb109-2997" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb109-2998"><a href="#cb109-2998" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb109-2999"><a href="#cb109-2999" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Practice</span><span class="op">:</span><span class="st">"Late cultivar"</span><span class="op">,</span></span>
<span id="cb109-3000"><a href="#cb109-3000" aria-hidden="true" tabindex="-1"></a>      <span class="dt">AEZ_Class_FAO</span><span class="op">:</span> <span class="st">"2050"</span><span class="op">,</span></span>
<span id="cb109-3001"><a href="#cb109-3001" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Mean_Difference</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb109-3002"><a href="#cb109-3002" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb109-3003"><a href="#cb109-3003" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb109-3004"><a href="#cb109-3004" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Practice</span><span class="op">:</span><span class="st">"Irrigation &amp; early cultivar"</span><span class="op">,</span></span>
<span id="cb109-3005"><a href="#cb109-3005" aria-hidden="true" tabindex="-1"></a>      <span class="dt">AEZ_Class_FAO</span><span class="op">:</span> <span class="st">"historical"</span><span class="op">,</span></span>
<span id="cb109-3006"><a href="#cb109-3006" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Mean_Difference</span><span class="op">:</span> <span class="dv">3</span><span class="op">,</span></span>
<span id="cb109-3007"><a href="#cb109-3007" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb109-3008"><a href="#cb109-3008" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb109-3009"><a href="#cb109-3009" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Practice</span><span class="op">:</span><span class="st">"Irrigation &amp; late cultivar"</span><span class="op">,</span></span>
<span id="cb109-3010"><a href="#cb109-3010" aria-hidden="true" tabindex="-1"></a>      <span class="dt">AEZ_Class_FAO</span><span class="op">:</span> <span class="st">"2030"</span><span class="op">,</span></span>
<span id="cb109-3011"><a href="#cb109-3011" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Mean_Difference</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb109-3012"><a href="#cb109-3012" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb109-3013"><a href="#cb109-3013" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb109-3014"><a href="#cb109-3014" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Practice</span><span class="op">:</span><span class="st">"Irrigation &amp; late cultivar"</span><span class="op">,</span></span>
<span id="cb109-3015"><a href="#cb109-3015" aria-hidden="true" tabindex="-1"></a>      <span class="dt">AEZ_Class_FAO</span><span class="op">:</span> <span class="st">"2050"</span><span class="op">,</span></span>
<span id="cb109-3016"><a href="#cb109-3016" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Mean_Difference</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb109-3017"><a href="#cb109-3017" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb109-3018"><a href="#cb109-3018" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb109-3019"><a href="#cb109-3019" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-109" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb110" data-startfrom="3023" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3022"><span id="cb110-3023"><a href="#cb110-3023" aria-hidden="true" tabindex="-1"></a>dataYieldATFC <span class="op">=</span> {</span>
<span id="cb110-3024"><a href="#cb110-3024" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> query <span class="op">=</span> <span class="vs">`</span></span>
<span id="cb110-3025"><a href="#cb110-3025" aria-hidden="true" tabindex="-1"></a><span class="vs">SELECT *</span></span>
<span id="cb110-3026"><a href="#cb110-3026" aria-hidden="true" tabindex="-1"></a><span class="vs">FROM afc_data </span></span>
<span id="cb110-3027"><a href="#cb110-3027" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span><span class="fu">WhereAdminQuery_ATFC</span>()<span class="sc">}</span><span class="vs"> </span></span>
<span id="cb110-3028"><a href="#cb110-3028" aria-hidden="true" tabindex="-1"></a><span class="vs">AND ssp = '</span><span class="sc">${</span>atfc_scenario_selector<span class="op">.</span><span class="fu">toUpperCase</span>()<span class="sc">}</span><span class="vs">'</span></span>
<span id="cb110-3029"><a href="#cb110-3029" aria-hidden="true" tabindex="-1"></a><span class="vs">AND cycle = '</span><span class="sc">${</span>atfc_cycle_selector<span class="sc">}</span><span class="vs">'</span></span>
<span id="cb110-3030"><a href="#cb110-3030" aria-hidden="true" tabindex="-1"></a><span class="vs">`</span></span>
<span id="cb110-3031"><a href="#cb110-3031" aria-hidden="true" tabindex="-1"></a>  mutable DBloaded <span class="op">=</span> <span class="kw">true</span></span>
<span id="cb110-3032"><a href="#cb110-3032" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> db<span class="op">.</span><span class="fu">query</span>(query)<span class="op">.</span><span class="fu">then</span>((r) <span class="kw">=&gt;</span> r<span class="op">.</span><span class="fu">toArray</span>())<span class="op">;</span></span>
<span id="cb110-3033"><a href="#cb110-3033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-3034"><a href="#cb110-3034" aria-hidden="true" tabindex="-1"></a><span class="co">//     let query = `</span></span>
<span id="cb110-3035"><a href="#cb110-3035" aria-hidden="true" tabindex="-1"></a><span class="co">// SELECT * </span></span>
<span id="cb110-3036"><a href="#cb110-3036" aria-hidden="true" tabindex="-1"></a><span class="co">// FROM afc_data </span></span>
<span id="cb110-3037"><a href="#cb110-3037" aria-hidden="true" tabindex="-1"></a><span class="co">// WHERE 1 = 1 </span></span>
<span id="cb110-3038"><a href="#cb110-3038" aria-hidden="true" tabindex="-1"></a><span class="co">// AND ssp = '${atfc_scenario_selector.toUpperCase()}'</span></span>
<span id="cb110-3039"><a href="#cb110-3039" aria-hidden="true" tabindex="-1"></a><span class="co">// AND cycle = '${atfc_cycle_selector}'</span></span>
<span id="cb110-3040"><a href="#cb110-3040" aria-hidden="true" tabindex="-1"></a><span class="co">// `;</span></span>
<span id="cb110-3041"><a href="#cb110-3041" aria-hidden="true" tabindex="-1"></a><span class="co">//   if (adminSelections.selectAdmin0 != null) {</span></span>
<span id="cb110-3042"><a href="#cb110-3042" aria-hidden="true" tabindex="-1"></a><span class="co">//     const none_admins = getAdminsNoneForSameLevel();</span></span>
<span id="cb110-3043"><a href="#cb110-3043" aria-hidden="true" tabindex="-1"></a><span class="co">//     for (let i = 0; i &lt; none_admins.length; i++)</span></span>
<span id="cb110-3044"><a href="#cb110-3044" aria-hidden="true" tabindex="-1"></a><span class="co">//       query += ` AND ${none_admins[i]} = ''`;</span></span>
<span id="cb110-3045"><a href="#cb110-3045" aria-hidden="true" tabindex="-1"></a><span class="co">//   }</span></span>
<span id="cb110-3046"><a href="#cb110-3046" aria-hidden="true" tabindex="-1"></a><span class="co">//   return db.query(query).then((r) =&gt; r.toArray());</span></span>
<span id="cb110-3047"><a href="#cb110-3047" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-110" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb111" data-startfrom="3051" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3050"><span id="cb111-3051"><a href="#cb111-3051" aria-hidden="true" tabindex="-1"></a>WhereAdminQuery_ATFC <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb111-3052"><a href="#cb111-3052" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="op">!</span>selectAdmin0 <span class="op">||</span> <span class="op">!</span>selectAdmin1) {</span>
<span id="cb111-3053"><a href="#cb111-3053" aria-hidden="true" tabindex="-1"></a>    <span class="co">// where admin0_name is null, it is ssa, return admin 0 data</span></span>
<span id="cb111-3054"><a href="#cb111-3054" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="vs">`WHERE admin1_name = ''`</span><span class="op">;</span></span>
<span id="cb111-3055"><a href="#cb111-3055" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (<span class="op">!</span>selectAdmin2 <span class="op">&amp;&amp;</span> selectAdmin1) {</span>
<span id="cb111-3056"><a href="#cb111-3056" aria-hidden="true" tabindex="-1"></a>    <span class="co">// where admin0 and admin1 is not null, return admin 1 for selected country</span></span>
<span id="cb111-3057"><a href="#cb111-3057" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="vs">`WHERE admin1_name != '' AND admin2_name = '' AND admin0_name = '</span><span class="sc">${</span>selectAdmin0<span class="sc">}</span><span class="vs">'`</span><span class="op">;</span></span>
<span id="cb111-3058"><a href="#cb111-3058" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb111-3059"><a href="#cb111-3059" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="vs">`WHERE admin2_name != '' AND admin0_name = '</span><span class="sc">${</span>selectAdmin0<span class="sc">}</span><span class="vs">' AND admin1_name = '</span><span class="sc">${</span>selectAdmin1<span class="sc">}</span><span class="vs">'`</span><span class="op">;</span></span>
<span id="cb111-3060"><a href="#cb111-3060" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb111-3061"><a href="#cb111-3061" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-111" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb112" data-startfrom="3065" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3064"><span id="cb112-3065"><a href="#cb112-3065" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">getRegionalGranularityLevel</span>(adminSelections) {</span>
<span id="cb112-3066"><a href="#cb112-3066" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (adminSelections<span class="op">.</span><span class="at">selectAdmin0</span> <span class="op">==</span> <span class="kw">null</span>) <span class="cf">return</span> <span class="st">"admin0_name"</span><span class="op">;</span></span>
<span id="cb112-3067"><a href="#cb112-3067" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (adminSelections<span class="op">.</span><span class="at">selectAdmin1</span> <span class="op">==</span> <span class="kw">null</span>) <span class="cf">return</span> <span class="st">"admin1_name"</span><span class="op">;</span></span>
<span id="cb112-3068"><a href="#cb112-3068" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (adminSelections<span class="op">.</span><span class="at">selectAdmin2</span> <span class="op">==</span> <span class="kw">null</span>) <span class="cf">return</span> <span class="st">"admin2_name"</span><span class="op">;</span></span>
<span id="cb112-3069"><a href="#cb112-3069" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="st">"admin2_name"</span><span class="op">;</span></span>
<span id="cb112-3070"><a href="#cb112-3070" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-112" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb113" data-startfrom="3074" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3073"><span id="cb113-3074"><a href="#cb113-3074" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">get_selected_admin_atfc</span>() {</span>
<span id="cb113-3075"><a href="#cb113-3075" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (adminSelections<span class="op">.</span><span class="at">selectAdmin0</span> <span class="op">==</span> <span class="kw">null</span>) {</span>
<span id="cb113-3076"><a href="#cb113-3076" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> { <span class="dt">admin</span><span class="op">:</span> <span class="st">"admin0_name"</span><span class="op">,</span> <span class="dt">highlight</span><span class="op">:</span> <span class="kw">null</span> }<span class="op">;</span></span>
<span id="cb113-3077"><a href="#cb113-3077" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb113-3078"><a href="#cb113-3078" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (adminSelections<span class="op">.</span><span class="at">selectAdmin1</span> <span class="op">==</span> <span class="kw">null</span>) {</span>
<span id="cb113-3079"><a href="#cb113-3079" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> { <span class="dt">admin</span><span class="op">:</span> <span class="st">"admin0_name"</span><span class="op">,</span> <span class="dt">highlight</span><span class="op">:</span> adminSelections<span class="op">.</span><span class="at">selectAdmin0</span> }<span class="op">;</span></span>
<span id="cb113-3080"><a href="#cb113-3080" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb113-3081"><a href="#cb113-3081" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (adminSelections<span class="op">.</span><span class="at">selectAdmin2</span> <span class="op">==</span> <span class="kw">null</span>) {</span>
<span id="cb113-3082"><a href="#cb113-3082" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb113-3083"><a href="#cb113-3083" aria-hidden="true" tabindex="-1"></a>          <span class="dt">admin</span><span class="op">:</span> <span class="st">"admin1_name"</span><span class="op">,</span></span>
<span id="cb113-3084"><a href="#cb113-3084" aria-hidden="true" tabindex="-1"></a>          <span class="dt">highlight</span><span class="op">:</span> adminSelections<span class="op">.</span><span class="at">selectAdmin1</span><span class="op">,</span></span>
<span id="cb113-3085"><a href="#cb113-3085" aria-hidden="true" tabindex="-1"></a>        }<span class="op">;</span></span>
<span id="cb113-3086"><a href="#cb113-3086" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb113-3087"><a href="#cb113-3087" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {</span>
<span id="cb113-3088"><a href="#cb113-3088" aria-hidden="true" tabindex="-1"></a>          <span class="dt">admin</span><span class="op">:</span> <span class="st">"admin2_name"</span><span class="op">,</span></span>
<span id="cb113-3089"><a href="#cb113-3089" aria-hidden="true" tabindex="-1"></a>          <span class="dt">highlight</span><span class="op">:</span> adminSelections<span class="op">.</span><span class="at">selectAdmin2</span><span class="op">,</span></span>
<span id="cb113-3090"><a href="#cb113-3090" aria-hidden="true" tabindex="-1"></a>        }<span class="op">;</span></span>
<span id="cb113-3091"><a href="#cb113-3091" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb113-3092"><a href="#cb113-3092" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb113-3093"><a href="#cb113-3093" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb113-3094"><a href="#cb113-3094" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-113" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb114" data-startfrom="3098" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3097"><span id="cb114-3098"><a href="#cb114-3098" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">getAdminsNoneForSameLevel</span>() {</span>
<span id="cb114-3099"><a href="#cb114-3099" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (adminSelections<span class="op">.</span><span class="at">selectAdmin0</span> <span class="op">==</span> <span class="kw">null</span>)</span>
<span id="cb114-3100"><a href="#cb114-3100" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="st">"admin0_name"</span><span class="op">,</span> <span class="st">"admin1_name"</span><span class="op">,</span> <span class="st">"admin2_name"</span>]<span class="op">;</span></span>
<span id="cb114-3101"><a href="#cb114-3101" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (adminSelections<span class="op">.</span><span class="at">selectAdmin1</span> <span class="op">==</span> <span class="kw">null</span>)</span>
<span id="cb114-3102"><a href="#cb114-3102" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="st">"admin1_name"</span><span class="op">,</span> <span class="st">"admin2_name"</span>]<span class="op">;</span></span>
<span id="cb114-3103"><a href="#cb114-3103" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (adminSelections<span class="op">.</span><span class="at">selectAdmin2</span> <span class="op">==</span> <span class="kw">null</span>) <span class="cf">return</span> [<span class="st">"admin2_name"</span>]<span class="op">;</span></span>
<span id="cb114-3104"><a href="#cb114-3104" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> []<span class="op">;</span></span>
<span id="cb114-3105"><a href="#cb114-3105" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-114" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb115" data-startfrom="3109" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3108"><span id="cb115-3109"><a href="#cb115-3109" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">round</span>(x<span class="op">,</span> places) {</span>
<span id="cb115-3110"><a href="#cb115-3110" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> pot <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">pow</span>(<span class="dv">10</span><span class="op">,</span> places)<span class="op">;</span></span>
<span id="cb115-3111"><a href="#cb115-3111" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">round</span>(x <span class="op">*</span> pot) <span class="op">/</span> pot<span class="op">;</span></span>
<span id="cb115-3112"><a href="#cb115-3112" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-115" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb116" data-startfrom="3116" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3115"><span id="cb116-3116"><a href="#cb116-3116" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">get_adpt_options_higher_yield_than_no_adaptation</span>(data) {</span>
<span id="cb116-3117"><a href="#cb116-3117" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> maxMeanDifference <span class="op">=</span> {</span>
<span id="cb116-3118"><a href="#cb116-3118" aria-hidden="true" tabindex="-1"></a>    <span class="dt">historical</span><span class="op">:</span> <span class="op">-</span><span class="kw">Infinity</span><span class="op">,</span></span>
<span id="cb116-3119"><a href="#cb116-3119" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2030</span><span class="op">:</span> <span class="op">-</span><span class="kw">Infinity</span><span class="op">,</span></span>
<span id="cb116-3120"><a href="#cb116-3120" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2050</span><span class="op">:</span> <span class="op">-</span><span class="kw">Infinity</span><span class="op">,</span></span>
<span id="cb116-3121"><a href="#cb116-3121" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb116-3122"><a href="#cb116-3122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-3123"><a href="#cb116-3123" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Find the maximum mean_difference for "No adaptation" for each horizon</span></span>
<span id="cb116-3124"><a href="#cb116-3124" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> options <span class="op">=</span> <span class="kw">new</span> <span class="bu">Set</span>()<span class="op">;</span></span>
<span id="cb116-3125"><a href="#cb116-3125" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">const</span> row <span class="kw">of</span> data) {</span>
<span id="cb116-3126"><a href="#cb116-3126" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (row<span class="op">.</span><span class="at">adaptation</span> <span class="op">==</span> <span class="st">"No adaptation"</span>) {</span>
<span id="cb116-3127"><a href="#cb116-3127" aria-hidden="true" tabindex="-1"></a>      maxMeanDifference[row<span class="op">.</span><span class="at">horizon</span>] <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(</span>
<span id="cb116-3128"><a href="#cb116-3128" aria-hidden="true" tabindex="-1"></a>        maxMeanDifference[row<span class="op">.</span><span class="at">horizon</span>]<span class="op">,</span></span>
<span id="cb116-3129"><a href="#cb116-3129" aria-hidden="true" tabindex="-1"></a>        row<span class="op">.</span><span class="at">mean_difference</span><span class="op">,</span></span>
<span id="cb116-3130"><a href="#cb116-3130" aria-hidden="true" tabindex="-1"></a>      )<span class="op">;</span></span>
<span id="cb116-3131"><a href="#cb116-3131" aria-hidden="true" tabindex="-1"></a>      <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb116-3132"><a href="#cb116-3132" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb116-3133"><a href="#cb116-3133" aria-hidden="true" tabindex="-1"></a>    options<span class="op">.</span><span class="fu">add</span>(row<span class="op">.</span><span class="at">adaptation</span>)<span class="op">;</span></span>
<span id="cb116-3134"><a href="#cb116-3134" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb116-3135"><a href="#cb116-3135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-3136"><a href="#cb116-3136" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">const</span> row <span class="kw">of</span> data) {</span>
<span id="cb116-3137"><a href="#cb116-3137" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (row<span class="op">.</span><span class="at">adaptation</span> <span class="op">==</span> <span class="st">"No adaptation"</span>) <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb116-3138"><a href="#cb116-3138" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (row<span class="op">.</span><span class="at">mean_difference</span> <span class="op">&lt;</span> maxMeanDifference[row<span class="op">.</span><span class="at">horizon</span>]) {</span>
<span id="cb116-3139"><a href="#cb116-3139" aria-hidden="true" tabindex="-1"></a>      options<span class="op">.</span><span class="fu">delete</span>(row<span class="op">.</span><span class="at">adaptation</span>)<span class="op">;</span></span>
<span id="cb116-3140"><a href="#cb116-3140" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb116-3141"><a href="#cb116-3141" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb116-3142"><a href="#cb116-3142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-3143"><a href="#cb116-3143" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> results <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb116-3144"><a href="#cb116-3144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-3145"><a href="#cb116-3145" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">const</span> option <span class="kw">of</span> options) {</span>
<span id="cb116-3146"><a href="#cb116-3146" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> filt <span class="op">=</span> data<span class="op">.</span><span class="fu">filter</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">adaptation</span> <span class="op">==</span> option)<span class="op">;</span></span>
<span id="cb116-3147"><a href="#cb116-3147" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> obj <span class="op">=</span> {</span>
<span id="cb116-3148"><a href="#cb116-3148" aria-hidden="true" tabindex="-1"></a>      <span class="dt">option</span><span class="op">:</span> option<span class="op">,</span></span>
<span id="cb116-3149"><a href="#cb116-3149" aria-hidden="true" tabindex="-1"></a>      <span class="dt">historical</span><span class="op">:</span></span>
<span id="cb116-3150"><a href="#cb116-3150" aria-hidden="true" tabindex="-1"></a>        filt<span class="op">.</span><span class="fu">find</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">horizon</span> <span class="op">==</span> <span class="st">"historical"</span>)<span class="op">.</span><span class="at">mean_difference</span> <span class="op">-</span></span>
<span id="cb116-3151"><a href="#cb116-3151" aria-hidden="true" tabindex="-1"></a>        maxMeanDifference<span class="op">.</span><span class="at">historical</span><span class="op">,</span></span>
<span id="cb116-3152"><a href="#cb116-3152" aria-hidden="true" tabindex="-1"></a>      <span class="dv">2030</span><span class="op">:</span></span>
<span id="cb116-3153"><a href="#cb116-3153" aria-hidden="true" tabindex="-1"></a>        filt<span class="op">.</span><span class="fu">find</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">horizon</span> <span class="op">==</span> <span class="st">"2030"</span>)<span class="op">.</span><span class="at">mean_difference</span> <span class="op">-</span></span>
<span id="cb116-3154"><a href="#cb116-3154" aria-hidden="true" tabindex="-1"></a>        maxMeanDifference[<span class="st">"2030"</span>]<span class="op">,</span></span>
<span id="cb116-3155"><a href="#cb116-3155" aria-hidden="true" tabindex="-1"></a>      <span class="dv">2050</span><span class="op">:</span></span>
<span id="cb116-3156"><a href="#cb116-3156" aria-hidden="true" tabindex="-1"></a>        filt<span class="op">.</span><span class="fu">find</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">horizon</span> <span class="op">==</span> <span class="st">"2050"</span>)<span class="op">.</span><span class="at">mean_difference</span> <span class="op">-</span></span>
<span id="cb116-3157"><a href="#cb116-3157" aria-hidden="true" tabindex="-1"></a>        maxMeanDifference[<span class="st">"2050"</span>]<span class="op">,</span></span>
<span id="cb116-3158"><a href="#cb116-3158" aria-hidden="true" tabindex="-1"></a>    }<span class="op">;</span></span>
<span id="cb116-3159"><a href="#cb116-3159" aria-hidden="true" tabindex="-1"></a>    results<span class="op">.</span><span class="fu">push</span>(obj)<span class="op">;</span></span>
<span id="cb116-3160"><a href="#cb116-3160" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb116-3161"><a href="#cb116-3161" aria-hidden="true" tabindex="-1"></a>  results<span class="op">.</span><span class="fu">sort</span>((a<span class="op">,</span> b) <span class="kw">=&gt;</span> a<span class="op">.</span><span class="at">historical</span> <span class="op">-</span> b<span class="op">.</span><span class="at">historical</span>)<span class="op">.</span><span class="fu">reverse</span>()<span class="op">;</span></span>
<span id="cb116-3162"><a href="#cb116-3162" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> results<span class="op">;</span></span>
<span id="cb116-3163"><a href="#cb116-3163" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-116" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb117" data-startfrom="3167" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3166"><span id="cb117-3167"><a href="#cb117-3167" aria-hidden="true" tabindex="-1"></a>highlighted_data <span class="op">=</span> {</span>
<span id="cb117-3168"><a href="#cb117-3168" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> selected_geo <span class="op">=</span> <span class="fu">get_selected_admin_atfc</span>()<span class="op">;</span></span>
<span id="cb117-3169"><a href="#cb117-3169" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (selectAdmin0 <span class="op">==</span> <span class="kw">null</span>){</span>
<span id="cb117-3170"><a href="#cb117-3170" aria-hidden="true" tabindex="-1"></a>      selected_geo <span class="op">=</span> {</span>
<span id="cb117-3171"><a href="#cb117-3171" aria-hidden="true" tabindex="-1"></a>        <span class="dt">admin</span><span class="op">:</span> <span class="st">"admin0_name"</span><span class="op">,</span></span>
<span id="cb117-3172"><a href="#cb117-3172" aria-hidden="true" tabindex="-1"></a>        <span class="dt">highlight</span><span class="op">:</span> <span class="st">""</span></span>
<span id="cb117-3173"><a href="#cb117-3173" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb117-3174"><a href="#cb117-3174" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb117-3175"><a href="#cb117-3175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-3176"><a href="#cb117-3176" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> dataYieldATFC<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> (</span>
<span id="cb117-3177"><a href="#cb117-3177" aria-hidden="true" tabindex="-1"></a>        (d<span class="op">.</span><span class="at">crop</span><span class="op">.</span><span class="fu">toLowerCase</span>()<span class="op">.</span><span class="fu">trim</span>() <span class="op">==</span> selected_crop_atfc<span class="op">.</span><span class="fu">toLowerCase</span>()<span class="op">.</span><span class="fu">trim</span>()) <span class="op">&amp;&amp;</span></span>
<span id="cb117-3178"><a href="#cb117-3178" aria-hidden="true" tabindex="-1"></a>        (d<span class="op">.</span><span class="at">cycle</span> <span class="op">==</span> atfc_cycle_selector) <span class="op">&amp;&amp;</span></span>
<span id="cb117-3179"><a href="#cb117-3179" aria-hidden="true" tabindex="-1"></a>        (d<span class="op">.</span><span class="at">ssp</span> <span class="op">==</span> atfc_scenario_selector) <span class="op">&amp;&amp;</span></span>
<span id="cb117-3180"><a href="#cb117-3180" aria-hidden="true" tabindex="-1"></a>        (d[selected_geo<span class="op">.</span><span class="at">admin</span>] <span class="op">==</span> selected_geo<span class="op">.</span><span class="at">highlight</span>)</span>
<span id="cb117-3181"><a href="#cb117-3181" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb117-3182"><a href="#cb117-3182" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb117-3183"><a href="#cb117-3183" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-117" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb118" data-startfrom="3187" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3186"><span id="cb118-3187"><a href="#cb118-3187" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">average</span>(vals) {</span>
<span id="cb118-3188"><a href="#cb118-3188" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> sum <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb118-3189"><a href="#cb118-3189" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> vals<span class="op">.</span><span class="at">length</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb118-3190"><a href="#cb118-3190" aria-hidden="true" tabindex="-1"></a>    sum <span class="op">+=</span> vals[i]<span class="op">;</span></span>
<span id="cb118-3191"><a href="#cb118-3191" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb118-3192"><a href="#cb118-3192" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> sum <span class="op">/</span> vals<span class="op">.</span><span class="at">length</span><span class="op">;</span></span>
<span id="cb118-3193"><a href="#cb118-3193" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-118" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb119" data-startfrom="3197" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3196"><span id="cb119-3197"><a href="#cb119-3197" aria-hidden="true" tabindex="-1"></a>containsAll <span class="op">=</span> (arr1<span class="op">,</span> arr2) <span class="kw">=&gt;</span> arr2<span class="op">.</span><span class="fu">every</span>((arr2Item) <span class="kw">=&gt;</span> arr1<span class="op">.</span><span class="fu">includes</span>(arr2Item))<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-119" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb120" data-startfrom="3201" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3200"><span id="cb120-3201"><a href="#cb120-3201" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`---</span></span>
<span id="cb120-3202"><a href="#cb120-3202" aria-hidden="true" tabindex="-1"></a><span class="vs">### Admin Selection - Display</span></span>
<span id="cb120-3203"><a href="#cb120-3203" aria-hidden="true" tabindex="-1"></a><span class="vs">*Showing admin selections*`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-120" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb121" data-startfrom="3207" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3206"><span id="cb121-3207"><a href="#cb121-3207" aria-hidden="true" tabindex="-1"></a><span class="co">// options for the global admin selection</span></span>
<span id="cb121-3208"><a href="#cb121-3208" aria-hidden="true" tabindex="-1"></a><span class="co">// used when no admin selection is made</span></span>
<span id="cb121-3209"><a href="#cb121-3209" aria-hidden="true" tabindex="-1"></a>globalSelection <span class="op">=</span> {</span>
<span id="cb121-3210"><a href="#cb121-3210" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> {</span>
<span id="cb121-3211"><a href="#cb121-3211" aria-hidden="true" tabindex="-1"></a>    <span class="dt">label</span><span class="op">:</span> <span class="st">"Sub-Saharan Africa"</span><span class="op">,</span></span>
<span id="cb121-3212"><a href="#cb121-3212" aria-hidden="true" tabindex="-1"></a>    <span class="dt">labelGeneral</span><span class="op">:</span> <span class="st">"Africa"</span></span>
<span id="cb121-3213"><a href="#cb121-3213" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb121-3214"><a href="#cb121-3214" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-121" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb122" data-startfrom="3218" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3217"><span id="cb122-3218"><a href="#cb122-3218" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">getAdminSelection</span>(selections <span class="op">=</span> adminSelections) {</span>
<span id="cb122-3219"><a href="#cb122-3219" aria-hidden="true" tabindex="-1"></a>  <span class="co">// get the most granular admin selection made</span></span>
<span id="cb122-3220"><a href="#cb122-3220" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> a0 <span class="op">=</span> selections<span class="op">.</span><span class="at">selectAdmin0</span><span class="op">;</span></span>
<span id="cb122-3221"><a href="#cb122-3221" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> a1 <span class="op">=</span> selections<span class="op">.</span><span class="at">selectAdmin1</span><span class="op">;</span></span>
<span id="cb122-3222"><a href="#cb122-3222" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> a2 <span class="op">=</span> selections<span class="op">.</span><span class="at">selectAdmin2</span><span class="op">;</span></span>
<span id="cb122-3223"><a href="#cb122-3223" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> <span class="bu">global</span> <span class="op">=</span> globalSelection<span class="op">.</span><span class="at">label</span><span class="op">;</span></span>
<span id="cb122-3224"><a href="#cb122-3224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-3225"><a href="#cb122-3225" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> a2 <span class="op">?</span> a2 <span class="op">:</span> a1 <span class="op">?</span> a1 <span class="op">:</span> a0 <span class="op">?</span> a0 <span class="op">:</span> <span class="bu">global</span><span class="op">;</span></span>
<span id="cb122-3226"><a href="#cb122-3226" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-122" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb123" data-startfrom="3230" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3229"><span id="cb123-3230"><a href="#cb123-3230" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">getAdminSelectionAdmin0</span>(selections <span class="op">=</span> adminSelections) {</span>
<span id="cb123-3231"><a href="#cb123-3231" aria-hidden="true" tabindex="-1"></a>  <span class="co">// get the selected admin0 or global value</span></span>
<span id="cb123-3232"><a href="#cb123-3232" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> a0 <span class="op">=</span> selections<span class="op">.</span><span class="at">selectAdmin0</span><span class="op">;</span></span>
<span id="cb123-3233"><a href="#cb123-3233" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> <span class="bu">global</span> <span class="op">=</span> globalSelection<span class="op">.</span><span class="at">label</span><span class="op">;</span></span>
<span id="cb123-3234"><a href="#cb123-3234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-3235"><a href="#cb123-3235" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> a0 <span class="op">?</span> a0 <span class="op">:</span> <span class="bu">global</span><span class="op">;</span></span>
<span id="cb123-3236"><a href="#cb123-3236" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-123" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb124" data-startfrom="3240" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3239"><span id="cb124-3240"><a href="#cb124-3240" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">getAdminSelectionMarkdownPath</span>(selections <span class="op">=</span> adminSelections) {</span>
<span id="cb124-3241"><a href="#cb124-3241" aria-hidden="true" tabindex="-1"></a>  <span class="co">// function to show selected admin region</span></span>
<span id="cb124-3242"><a href="#cb124-3242" aria-hidden="true" tabindex="-1"></a>  <span class="co">// return path showing nested admin selection</span></span>
<span id="cb124-3243"><a href="#cb124-3243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-3244"><a href="#cb124-3244" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> delim <span class="op">=</span> <span class="st">" → "</span><span class="op">;</span></span>
<span id="cb124-3245"><a href="#cb124-3245" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> path <span class="op">=</span> [</span>
<span id="cb124-3246"><a href="#cb124-3246" aria-hidden="true" tabindex="-1"></a>    selections<span class="op">.</span><span class="at">selectAdmin0</span><span class="op">,</span></span>
<span id="cb124-3247"><a href="#cb124-3247" aria-hidden="true" tabindex="-1"></a>    selections<span class="op">.</span><span class="at">selectAdmin1</span><span class="op">,</span></span>
<span id="cb124-3248"><a href="#cb124-3248" aria-hidden="true" tabindex="-1"></a>    selections<span class="op">.</span><span class="at">selectAdmin2</span><span class="op">,</span></span>
<span id="cb124-3249"><a href="#cb124-3249" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">.</span><span class="fu">filter</span>((d) <span class="kw">=&gt;</span> d)<span class="op">;</span></span>
<span id="cb124-3250"><a href="#cb124-3250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-3251"><a href="#cb124-3251" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> formatted <span class="op">=</span> path</span>
<span id="cb124-3252"><a href="#cb124-3252" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">filter</span>((d) <span class="kw">=&gt;</span> d)</span>
<span id="cb124-3253"><a href="#cb124-3253" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">map</span>((d<span class="op">,</span> i) <span class="kw">=&gt;</span> {</span>
<span id="cb124-3254"><a href="#cb124-3254" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> i <span class="op">==</span> path<span class="op">.</span><span class="at">length</span> <span class="op">-</span> <span class="dv">1</span> <span class="op">?</span> <span class="vs">`**</span><span class="sc">${</span>d<span class="sc">}</span><span class="vs">**`</span> <span class="op">:</span> <span class="vs">`*</span><span class="sc">${</span>d<span class="sc">}</span><span class="vs">*`</span><span class="op">;</span></span>
<span id="cb124-3255"><a href="#cb124-3255" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb124-3256"><a href="#cb124-3256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-3257"><a href="#cb124-3257" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> formatted<span class="op">.</span><span class="at">length</span> <span class="op">==</span> <span class="dv">0</span></span>
<span id="cb124-3258"><a href="#cb124-3258" aria-hidden="true" tabindex="-1"></a>    <span class="op">?</span> <span class="vs">`**</span><span class="sc">${</span>globalSelection<span class="op">.</span><span class="at">label</span><span class="sc">}</span><span class="vs">**`</span> <span class="co">// no selection, all of Africa</span></span>
<span id="cb124-3259"><a href="#cb124-3259" aria-hidden="true" tabindex="-1"></a>    <span class="op">:</span> <span class="vs">`</span><span class="sc">${</span>formatted<span class="op">.</span><span class="fu">join</span>(delim)<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span>
<span id="cb124-3260"><a href="#cb124-3260" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-124" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb125" data-startfrom="3264" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3263"><span id="cb125-3264"><a href="#cb125-3264" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`---</span></span>
<span id="cb125-3265"><a href="#cb125-3265" aria-hidden="true" tabindex="-1"></a><span class="vs">### Choropleth map - Geographic Impact</span></span>
<span id="cb125-3266"><a href="#cb125-3266" aria-hidden="true" tabindex="-1"></a><span class="vs">*Showing context for admin selection*</span></span>
<span id="cb125-3267"><a href="#cb125-3267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-3268"><a href="#cb125-3268" aria-hidden="true" tabindex="-1"></a><span class="vs">There is some hoop-jumping to get the right data based on the Admin Selection. The tabular data is then bound to the applicable geojson, and visualized with Plot.`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-125" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb126" data-startfrom="3272" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3271"><span id="cb126-3272"><a href="#cb126-3272" aria-hidden="true" tabindex="-1"></a>dataYield <span class="op">=</span> {</span>
<span id="cb126-3273"><a href="#cb126-3273" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> query <span class="op">=</span> <span class="vs">`</span></span>
<span id="cb126-3274"><a href="#cb126-3274" aria-hidden="true" tabindex="-1"></a><span class="vs">SELECT *</span></span>
<span id="cb126-3275"><a href="#cb126-3275" aria-hidden="true" tabindex="-1"></a><span class="vs">FROM aggregated</span></span>
<span id="cb126-3276"><a href="#cb126-3276" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span><span class="fu">WhereAdminQuery</span>()<span class="sc">}</span></span>
<span id="cb126-3277"><a href="#cb126-3277" aria-hidden="true" tabindex="-1"></a><span class="vs">AND ssp = '</span><span class="sc">${</span>selected_scenario<span class="op">.</span><span class="at">ssp</span><span class="sc">}</span><span class="vs">'</span></span>
<span id="cb126-3278"><a href="#cb126-3278" aria-hidden="true" tabindex="-1"></a><span class="vs">AND horizon = '</span><span class="sc">${</span>selected_scenario<span class="op">.</span><span class="at">horizon</span><span class="sc">}</span><span class="vs">'</span></span>
<span id="cb126-3279"><a href="#cb126-3279" aria-hidden="true" tabindex="-1"></a><span class="vs">AND cycle = '</span><span class="sc">${</span>selected_cycle_options<span class="op">.</span><span class="at">cycle</span><span class="sc">}</span><span class="vs">'</span></span>
<span id="cb126-3280"><a href="#cb126-3280" aria-hidden="true" tabindex="-1"></a><span class="vs">AND crop = '</span><span class="sc">${</span>crop_selector_dynamic_insights<span class="sc">}</span><span class="vs">'</span></span>
<span id="cb126-3281"><a href="#cb126-3281" aria-hidden="true" tabindex="-1"></a><span class="vs">AND cultivar = '</span><span class="sc">${</span>selected_cultivar<span class="op">.</span><span class="at">value</span><span class="sc">}</span><span class="vs">'</span></span>
<span id="cb126-3282"><a href="#cb126-3282" aria-hidden="true" tabindex="-1"></a><span class="vs">`</span></span>
<span id="cb126-3283"><a href="#cb126-3283" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> resp <span class="op">=</span> <span class="cf">await</span> db<span class="op">.</span><span class="fu">queryStream</span>(query)</span>
<span id="cb126-3284"><a href="#cb126-3284" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> resp<span class="op">.</span><span class="fu">readRows</span>()</span>
<span id="cb126-3285"><a href="#cb126-3285" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-126" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb127" data-startfrom="3289" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3288"><span id="cb127-3289"><a href="#cb127-3289" aria-hidden="true" tabindex="-1"></a>selected_cultivar<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-127" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb128" data-startfrom="3293" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3292"><span id="cb128-3293"><a href="#cb128-3293" aria-hidden="true" tabindex="-1"></a><span class="co">// grab tabular data for choropleth</span></span>
<span id="cb128-3294"><a href="#cb128-3294" aria-hidden="true" tabindex="-1"></a>dataGeoImpact <span class="op">=</span> {</span>
<span id="cb128-3295"><a href="#cb128-3295" aria-hidden="true" tabindex="-1"></a>  <span class="co">// get data for choropleth map based on choice</span></span>
<span id="cb128-3296"><a href="#cb128-3296" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dataSource <span class="op">=</span> selectGeoDataType<span class="op">.</span><span class="at">key</span> <span class="op">==</span> <span class="st">"population"</span></span>
<span id="cb128-3297"><a href="#cb128-3297" aria-hidden="true" tabindex="-1"></a>    <span class="op">?</span> dataYield</span>
<span id="cb128-3298"><a href="#cb128-3298" aria-hidden="true" tabindex="-1"></a>    <span class="op">:</span> dataYield</span>
<span id="cb128-3299"><a href="#cb128-3299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-3300"><a href="#cb128-3300" aria-hidden="true" tabindex="-1"></a>  <span class="co">// select different data based on admin selections</span></span>
<span id="cb128-3301"><a href="#cb128-3301" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (adminSelections<span class="op">.</span><span class="at">selectAdmin1</span>) {</span>
<span id="cb128-3302"><a href="#cb128-3302" aria-hidden="true" tabindex="-1"></a>    <span class="co">// admin1 or 2 is selected, show all admin2's for selected admin1</span></span>
<span id="cb128-3303"><a href="#cb128-3303" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> T<span class="op">.</span><span class="fu">tidy</span>(</span>
<span id="cb128-3304"><a href="#cb128-3304" aria-hidden="true" tabindex="-1"></a>      dataSource<span class="op">,</span></span>
<span id="cb128-3305"><a href="#cb128-3305" aria-hidden="true" tabindex="-1"></a>      T<span class="op">.</span><span class="fu">filter</span>((d) <span class="kw">=&gt;</span> {</span>
<span id="cb128-3306"><a href="#cb128-3306" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> d<span class="op">.</span><span class="at">admin1_name</span> <span class="op">==</span> adminSelections<span class="op">.</span><span class="at">selectAdmin1</span></span>
<span id="cb128-3307"><a href="#cb128-3307" aria-hidden="true" tabindex="-1"></a>          <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">admin2_name</span> <span class="co">// always non-null</span></span>
<span id="cb128-3308"><a href="#cb128-3308" aria-hidden="true" tabindex="-1"></a>      })</span>
<span id="cb128-3309"><a href="#cb128-3309" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb128-3310"><a href="#cb128-3310" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (adminSelections<span class="op">.</span><span class="at">selectAdmin0</span>) {</span>
<span id="cb128-3311"><a href="#cb128-3311" aria-hidden="true" tabindex="-1"></a>    <span class="co">// admin0 is selected, with no admin1</span></span>
<span id="cb128-3312"><a href="#cb128-3312" aria-hidden="true" tabindex="-1"></a>    <span class="co">// get all admin1 data for selected admin0</span></span>
<span id="cb128-3313"><a href="#cb128-3313" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> T<span class="op">.</span><span class="fu">tidy</span>(</span>
<span id="cb128-3314"><a href="#cb128-3314" aria-hidden="true" tabindex="-1"></a>      dataSource<span class="op">,</span></span>
<span id="cb128-3315"><a href="#cb128-3315" aria-hidden="true" tabindex="-1"></a>      T<span class="op">.</span><span class="fu">filter</span>((d) <span class="kw">=&gt;</span> {</span>
<span id="cb128-3316"><a href="#cb128-3316" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> d<span class="op">.</span><span class="at">admin0_name</span> <span class="op">==</span> adminSelections<span class="op">.</span><span class="at">selectAdmin0</span></span>
<span id="cb128-3317"><a href="#cb128-3317" aria-hidden="true" tabindex="-1"></a>        <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">admin1_name</span> <span class="co">// always non-null </span></span>
<span id="cb128-3318"><a href="#cb128-3318" aria-hidden="true" tabindex="-1"></a>        <span class="op">&amp;&amp;</span> <span class="op">!</span>d<span class="op">.</span><span class="at">admin2_name</span> <span class="co">// always null</span></span>
<span id="cb128-3319"><a href="#cb128-3319" aria-hidden="true" tabindex="-1"></a>      })</span>
<span id="cb128-3320"><a href="#cb128-3320" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb128-3321"><a href="#cb128-3321" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb128-3322"><a href="#cb128-3322" aria-hidden="true" tabindex="-1"></a>    <span class="co">// end case: admin0 is not selected</span></span>
<span id="cb128-3323"><a href="#cb128-3323" aria-hidden="true" tabindex="-1"></a>    <span class="co">// get all admin0 data</span></span>
<span id="cb128-3324"><a href="#cb128-3324" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> T<span class="op">.</span><span class="fu">tidy</span>(</span>
<span id="cb128-3325"><a href="#cb128-3325" aria-hidden="true" tabindex="-1"></a>      dataSource<span class="op">,</span></span>
<span id="cb128-3326"><a href="#cb128-3326" aria-hidden="true" tabindex="-1"></a>      T<span class="op">.</span><span class="fu">filter</span>((d) <span class="kw">=&gt;</span> {</span>
<span id="cb128-3327"><a href="#cb128-3327" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="op">!</span>d<span class="op">.</span><span class="at">admin1_name</span> <span class="co">// always null </span></span>
<span id="cb128-3328"><a href="#cb128-3328" aria-hidden="true" tabindex="-1"></a>        <span class="op">&amp;&amp;</span> <span class="op">!</span>d<span class="op">.</span><span class="at">admin2_name</span> <span class="co">// always null</span></span>
<span id="cb128-3329"><a href="#cb128-3329" aria-hidden="true" tabindex="-1"></a>      })</span>
<span id="cb128-3330"><a href="#cb128-3330" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb128-3331"><a href="#cb128-3331" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb128-3332"><a href="#cb128-3332" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-128" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb129" data-startfrom="3336" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3335"><span id="cb129-3336"><a href="#cb129-3336" aria-hidden="true" tabindex="-1"></a><span class="co">// bind geojson to tabular data</span></span>
<span id="cb129-3337"><a href="#cb129-3337" aria-hidden="true" tabindex="-1"></a>mapDataGeoImpact <span class="op">=</span> {</span>
<span id="cb129-3338"><a href="#cb129-3338" aria-hidden="true" tabindex="-1"></a>  <span class="co">// no selections</span></span>
<span id="cb129-3339"><a href="#cb129-3339" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="op">!</span>adminSelections<span class="op">.</span><span class="at">selectAdmin0</span>) {</span>
<span id="cb129-3340"><a href="#cb129-3340" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">bindTabularToGeo</span>({</span>
<span id="cb129-3341"><a href="#cb129-3341" aria-hidden="true" tabindex="-1"></a>      <span class="dt">data</span><span class="op">:</span> dataGeoImpact<span class="op">,</span></span>
<span id="cb129-3342"><a href="#cb129-3342" aria-hidden="true" tabindex="-1"></a>      <span class="dt">dataBindColumn</span><span class="op">:</span> <span class="st">"admin0_name"</span><span class="op">,</span></span>
<span id="cb129-3343"><a href="#cb129-3343" aria-hidden="true" tabindex="-1"></a>      <span class="dt">geoData</span><span class="op">:</span> boundaries<span class="op">.</span><span class="at">admin0</span><span class="op">,</span></span>
<span id="cb129-3344"><a href="#cb129-3344" aria-hidden="true" tabindex="-1"></a>      <span class="dt">geoDataBindColumn</span><span class="op">:</span> <span class="st">"admin0_name"</span></span>
<span id="cb129-3345"><a href="#cb129-3345" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb129-3346"><a href="#cb129-3346" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb129-3347"><a href="#cb129-3347" aria-hidden="true" tabindex="-1"></a>  <span class="co">// admin0 selected only</span></span>
<span id="cb129-3348"><a href="#cb129-3348" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="cf">if</span> (<span class="op">!</span>adminSelections<span class="op">.</span><span class="at">selectAdmin1</span>) {</span>
<span id="cb129-3349"><a href="#cb129-3349" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> data <span class="op">=</span> T<span class="op">.</span><span class="fu">tidy</span>(</span>
<span id="cb129-3350"><a href="#cb129-3350" aria-hidden="true" tabindex="-1"></a>      dataGeoImpact<span class="op">,</span></span>
<span id="cb129-3351"><a href="#cb129-3351" aria-hidden="true" tabindex="-1"></a>      T<span class="op">.</span><span class="fu">mutate</span>({ <span class="dt">a1_a0</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> [d<span class="op">.</span><span class="at">admin1_name</span><span class="op">,</span> d<span class="op">.</span><span class="at">admin0_name</span>]<span class="op">.</span><span class="fu">join</span>(<span class="st">"_"</span>) })</span>
<span id="cb129-3352"><a href="#cb129-3352" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb129-3353"><a href="#cb129-3353" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> geoData <span class="op">=</span> {</span>
<span id="cb129-3354"><a href="#cb129-3354" aria-hidden="true" tabindex="-1"></a>      <span class="op">...</span>boundaries<span class="op">.</span><span class="at">admin1</span><span class="op">,</span></span>
<span id="cb129-3355"><a href="#cb129-3355" aria-hidden="true" tabindex="-1"></a>      <span class="dt">features</span><span class="op">:</span> boundaries<span class="op">.</span><span class="at">admin1</span><span class="op">.</span><span class="at">features</span><span class="op">.</span><span class="fu">filter</span>(</span>
<span id="cb129-3356"><a href="#cb129-3356" aria-hidden="true" tabindex="-1"></a>        (d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">admin0_name</span> <span class="op">==</span> adminSelections<span class="op">.</span><span class="at">selectAdmin0</span></span>
<span id="cb129-3357"><a href="#cb129-3357" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb129-3358"><a href="#cb129-3358" aria-hidden="true" tabindex="-1"></a>    }<span class="op">;</span></span>
<span id="cb129-3359"><a href="#cb129-3359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-3360"><a href="#cb129-3360" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">bindTabularToGeo</span>({</span>
<span id="cb129-3361"><a href="#cb129-3361" aria-hidden="true" tabindex="-1"></a>      <span class="dt">data</span><span class="op">:</span> data<span class="op">,</span></span>
<span id="cb129-3362"><a href="#cb129-3362" aria-hidden="true" tabindex="-1"></a>      <span class="dt">dataBindColumn</span><span class="op">:</span> <span class="st">"a1_a0"</span><span class="op">,</span></span>
<span id="cb129-3363"><a href="#cb129-3363" aria-hidden="true" tabindex="-1"></a>      <span class="dt">geoData</span><span class="op">:</span> geoData<span class="op">,</span></span>
<span id="cb129-3364"><a href="#cb129-3364" aria-hidden="true" tabindex="-1"></a>      <span class="dt">geoDataBindColumn</span><span class="op">:</span> <span class="st">"a1_a0"</span></span>
<span id="cb129-3365"><a href="#cb129-3365" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb129-3366"><a href="#cb129-3366" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb129-3367"><a href="#cb129-3367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-3368"><a href="#cb129-3368" aria-hidden="true" tabindex="-1"></a>  <span class="co">// admin1 is selected</span></span>
<span id="cb129-3369"><a href="#cb129-3369" aria-hidden="true" tabindex="-1"></a>  <span class="co">// show all admin2 regions within admin1</span></span>
<span id="cb129-3370"><a href="#cb129-3370" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> {</span>
<span id="cb129-3371"><a href="#cb129-3371" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> data <span class="op">=</span> T<span class="op">.</span><span class="fu">tidy</span>(</span>
<span id="cb129-3372"><a href="#cb129-3372" aria-hidden="true" tabindex="-1"></a>      dataGeoImpact<span class="op">,</span></span>
<span id="cb129-3373"><a href="#cb129-3373" aria-hidden="true" tabindex="-1"></a>      T<span class="op">.</span><span class="fu">mutate</span>({</span>
<span id="cb129-3374"><a href="#cb129-3374" aria-hidden="true" tabindex="-1"></a>        <span class="dt">a2_a1_a0</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> [d<span class="op">.</span><span class="at">admin2_name</span><span class="op">,</span> d<span class="op">.</span><span class="at">admin1_name</span><span class="op">,</span> d<span class="op">.</span><span class="at">admin0_name</span>]<span class="op">.</span><span class="fu">join</span>(<span class="st">"_"</span>)</span>
<span id="cb129-3375"><a href="#cb129-3375" aria-hidden="true" tabindex="-1"></a>      })</span>
<span id="cb129-3376"><a href="#cb129-3376" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb129-3377"><a href="#cb129-3377" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> geoData <span class="op">=</span> {</span>
<span id="cb129-3378"><a href="#cb129-3378" aria-hidden="true" tabindex="-1"></a>      <span class="op">...</span>boundaries<span class="op">.</span><span class="at">admin2</span><span class="op">,</span></span>
<span id="cb129-3379"><a href="#cb129-3379" aria-hidden="true" tabindex="-1"></a>      <span class="dt">features</span><span class="op">:</span> boundaries<span class="op">.</span><span class="at">admin2</span><span class="op">.</span><span class="at">features</span><span class="op">.</span><span class="fu">filter</span>(</span>
<span id="cb129-3380"><a href="#cb129-3380" aria-hidden="true" tabindex="-1"></a>        (d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">admin1_name</span> <span class="op">==</span> adminSelections<span class="op">.</span><span class="at">selectAdmin1</span></span>
<span id="cb129-3381"><a href="#cb129-3381" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb129-3382"><a href="#cb129-3382" aria-hidden="true" tabindex="-1"></a>    }<span class="op">;</span></span>
<span id="cb129-3383"><a href="#cb129-3383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-3384"><a href="#cb129-3384" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">bindTabularToGeo</span>({</span>
<span id="cb129-3385"><a href="#cb129-3385" aria-hidden="true" tabindex="-1"></a>      <span class="dt">data</span><span class="op">:</span> data<span class="op">,</span></span>
<span id="cb129-3386"><a href="#cb129-3386" aria-hidden="true" tabindex="-1"></a>      <span class="dt">dataBindColumn</span><span class="op">:</span> <span class="st">"a2_a1_a0"</span><span class="op">,</span></span>
<span id="cb129-3387"><a href="#cb129-3387" aria-hidden="true" tabindex="-1"></a>      <span class="dt">geoData</span><span class="op">:</span> geoData<span class="op">,</span></span>
<span id="cb129-3388"><a href="#cb129-3388" aria-hidden="true" tabindex="-1"></a>      <span class="dt">geoDataBindColumn</span><span class="op">:</span> <span class="st">"a2_a1_a0"</span></span>
<span id="cb129-3389"><a href="#cb129-3389" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb129-3390"><a href="#cb129-3390" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb129-3391"><a href="#cb129-3391" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-129" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb130" data-startfrom="3395" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3394"><span id="cb130-3395"><a href="#cb130-3395" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">filterYieldDataByAdmins</span>(d) {</span>
<span id="cb130-3396"><a href="#cb130-3396" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (adminSelections<span class="op">.</span><span class="at">selectAdmin0</span> <span class="op">==</span> <span class="kw">null</span>) <span class="cf">return</span> d<span class="op">;</span></span>
<span id="cb130-3397"><a href="#cb130-3397" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (adminSelections<span class="op">.</span><span class="at">selectAdmin1</span> <span class="op">==</span> <span class="kw">null</span>)</span>
<span id="cb130-3398"><a href="#cb130-3398" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (</span>
<span id="cb130-3399"><a href="#cb130-3399" aria-hidden="true" tabindex="-1"></a>      d<span class="op">.</span><span class="at">admin0_name</span> <span class="op">==</span> adminSelections<span class="op">.</span><span class="at">selectAdmin0</span> <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">admin1_name</span> <span class="op">==</span> <span class="kw">null</span></span>
<span id="cb130-3400"><a href="#cb130-3400" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb130-3401"><a href="#cb130-3401" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (adminSelections<span class="op">.</span><span class="at">selectAdmin2</span> <span class="op">==</span> <span class="kw">null</span>)</span>
<span id="cb130-3402"><a href="#cb130-3402" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (</span>
<span id="cb130-3403"><a href="#cb130-3403" aria-hidden="true" tabindex="-1"></a>      d<span class="op">.</span><span class="at">admin0_name</span> <span class="op">==</span> adminSelections<span class="op">.</span><span class="at">selectAdmin0</span> <span class="op">&amp;&amp;</span></span>
<span id="cb130-3404"><a href="#cb130-3404" aria-hidden="true" tabindex="-1"></a>      d<span class="op">.</span><span class="at">admin1_name</span> <span class="op">==</span> adminSelections<span class="op">.</span><span class="at">selectAdmin1</span> <span class="op">&amp;&amp;</span></span>
<span id="cb130-3405"><a href="#cb130-3405" aria-hidden="true" tabindex="-1"></a>      d<span class="op">.</span><span class="at">admin2_name</span> <span class="op">==</span> <span class="kw">null</span></span>
<span id="cb130-3406"><a href="#cb130-3406" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb130-3407"><a href="#cb130-3407" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> (</span>
<span id="cb130-3408"><a href="#cb130-3408" aria-hidden="true" tabindex="-1"></a>    d<span class="op">.</span><span class="at">admin0_name</span> <span class="op">==</span> adminSelections<span class="op">.</span><span class="at">selectAdmin0</span> <span class="op">&amp;&amp;</span></span>
<span id="cb130-3409"><a href="#cb130-3409" aria-hidden="true" tabindex="-1"></a>    d<span class="op">.</span><span class="at">admin1_name</span> <span class="op">==</span> adminSelections<span class="op">.</span><span class="at">selectAdmin1</span> <span class="op">&amp;&amp;</span></span>
<span id="cb130-3410"><a href="#cb130-3410" aria-hidden="true" tabindex="-1"></a>    d<span class="op">.</span><span class="at">admin2_name</span> <span class="op">==</span> adminSelections<span class="op">.</span><span class="at">selectAdmin2</span></span>
<span id="cb130-3411"><a href="#cb130-3411" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb130-3412"><a href="#cb130-3412" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-130" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb131" data-startfrom="3416" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3415"><span id="cb131-3416"><a href="#cb131-3416" aria-hidden="true" tabindex="-1"></a>WhereAdminQuery <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb131-3417"><a href="#cb131-3417" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="op">!</span>selectAdmin0) {</span>
<span id="cb131-3418"><a href="#cb131-3418" aria-hidden="true" tabindex="-1"></a>    <span class="co">// where admin0_name is null, it is ssa, return admin 0 data</span></span>
<span id="cb131-3419"><a href="#cb131-3419" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="vs">`WHERE admin1_name IS NULL`</span><span class="op">;</span></span>
<span id="cb131-3420"><a href="#cb131-3420" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (selectAdmin0 <span class="op">&amp;&amp;</span> <span class="op">!</span>selectAdmin1) {</span>
<span id="cb131-3421"><a href="#cb131-3421" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Where admin0 is selected, return all admin 1 for that country</span></span>
<span id="cb131-3422"><a href="#cb131-3422" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="vs">`WHERE admin0_name == '</span><span class="sc">${</span>selectAdmin0<span class="sc">}</span><span class="vs">' AND admin1_name IS NOT NULL AND admin2_name IS NULL`</span><span class="op">;</span></span>
<span id="cb131-3423"><a href="#cb131-3423" aria-hidden="true" tabindex="-1"></a>    <span class="co">// } else if (selectAdmin1 &amp;&amp; !selectAdmin2) { // where admin0 and admin1 is selected, return all admin2 for that region/country</span></span>
<span id="cb131-3424"><a href="#cb131-3424" aria-hidden="true" tabindex="-1"></a>    <span class="co">//   return `WHERE admin0_name = '${selectAdmin0}' AND admin1_name = '${selectAdmin1}' AND admin2_name IS NOT NULL`</span></span>
<span id="cb131-3425"><a href="#cb131-3425" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb131-3426"><a href="#cb131-3426" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="vs">`WHERE admin0_name = '</span><span class="sc">${</span>selectAdmin0<span class="sc">}</span><span class="vs">' AND admin1_name = '</span><span class="sc">${</span>selectAdmin1<span class="sc">}</span><span class="vs">' AND admin2_name IS NOT NULL`</span><span class="op">;</span></span>
<span id="cb131-3427"><a href="#cb131-3427" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb131-3428"><a href="#cb131-3428" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-131" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb132" data-startfrom="3432" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3431"><span id="cb132-3432"><a href="#cb132-3432" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`---</span></span>
<span id="cb132-3433"><a href="#cb132-3433" aria-hidden="true" tabindex="-1"></a><span class="vs">## Data</span></span>
<span id="cb132-3434"><a href="#cb132-3434" aria-hidden="true" tabindex="-1"></a><span class="vs">*Data sources*</span></span>
<span id="cb132-3435"><a href="#cb132-3435" aria-hidden="true" tabindex="-1"></a><span class="vs">- Data is from local files downloaded from S3, uploaded as a file attachments</span></span>
<span id="cb132-3436"><a href="#cb132-3436" aria-hidden="true" tabindex="-1"></a><span class="vs">- Data is then wrapped as a duckDB database table (separate tables for each parquet file)</span></span>
<span id="cb132-3437"><a href="#cb132-3437" aria-hidden="true" tabindex="-1"></a><span class="vs">- We are using some simplified data sources, suffixed with reduced.parquet in the S3 bucket`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-132" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb133" data-startfrom="3441" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3440"><span id="cb133-3441"><a href="#cb133-3441" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { db } <span class="im">from</span> <span class="st">"876b0cd897b4c214"</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-133" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb134" data-startfrom="3445" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3444"><span id="cb134-3445"><a href="#cb134-3445" aria-hidden="true" tabindex="-1"></a>mutable DBloaded <span class="op">=</span> <span class="kw">false</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-134" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb135" data-startfrom="3449" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3448"><span id="cb135-3449"><a href="#cb135-3449" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb135-3450"><a href="#cb135-3450" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="op">!</span>DBloaded) {</span>
<span id="cb135-3451"><a href="#cb135-3451" aria-hidden="true" tabindex="-1"></a>    <span class="bu">document</span><span class="op">.</span><span class="at">body</span><span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">cursor</span> <span class="op">=</span> <span class="st">"wait"</span><span class="op">;</span></span>
<span id="cb135-3452"><a href="#cb135-3452" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb135-3453"><a href="#cb135-3453" aria-hidden="true" tabindex="-1"></a>    <span class="bu">document</span><span class="op">.</span><span class="at">body</span><span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">cursor</span> <span class="op">=</span> <span class="st">"default"</span><span class="op">;</span></span>
<span id="cb135-3454"><a href="#cb135-3454" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb135-3455"><a href="#cb135-3455" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-135" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb136" data-startfrom="3459" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3458"><span id="cb136-3459"><a href="#cb136-3459" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`### Geographic data</span></span>
<span id="cb136-3460"><a href="#cb136-3460" aria-hidden="true" tabindex="-1"></a><span class="vs">Geo files were converted to TopoJSON and reduced in complexity before uploading to the notebook, see [Simplify large spatial files](https://observablehq.com/d/258c68ee969e8ed5?collection=@periscopic/ab-atlas) notebook for method.</span></span>
<span id="cb136-3461"><a href="#cb136-3461" aria-hidden="true" tabindex="-1"></a><span class="vs">- **admin0**: broadest level, country boundaries</span></span>
<span id="cb136-3462"><a href="#cb136-3462" aria-hidden="true" tabindex="-1"></a><span class="vs">  - boundaries/atlas-region_admin0_harmonized.geojson</span></span>
<span id="cb136-3463"><a href="#cb136-3463" aria-hidden="true" tabindex="-1"></a><span class="vs">- **admin1**: one level down from admin0, regions within each admin0 region</span></span>
<span id="cb136-3464"><a href="#cb136-3464" aria-hidden="true" tabindex="-1"></a><span class="vs">  - boundaries/atlas-region_admin1_simplified.parquet</span></span>
<span id="cb136-3465"><a href="#cb136-3465" aria-hidden="true" tabindex="-1"></a><span class="vs">- **admin2**: lowest level, subregions of every admin1 region</span></span>
<span id="cb136-3466"><a href="#cb136-3466" aria-hidden="true" tabindex="-1"></a><span class="vs">  - These are only loaded when needed and are called directly from the S3 bucket to reduce bandwidth and memory requirements</span></span>
<span id="cb136-3467"><a href="#cb136-3467" aria-hidden="true" tabindex="-1"></a><span class="vs">  - https://digital-atlas.s3.amazonaws.com/boundaries/atlas-region_admin2_simplified.parquet`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-136" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb137" data-startfrom="3471" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3470"><span id="cb137-3471"><a href="#cb137-3471" aria-hidden="true" tabindex="-1"></a>admin0_boundaries <span class="op">=</span> {</span>
<span id="cb137-3472"><a href="#cb137-3472" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> input0 <span class="op">=</span> <span class="cf">await</span> <span class="fu">FileAttachment</span>(<span class="st">"atlas-region_admin0_harmonized.json"</span>)<span class="op">.</span><span class="fu">json</span>()</span>
<span id="cb137-3473"><a href="#cb137-3473" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> topojson<span class="op">.</span><span class="fu">feature</span>(input0<span class="op">,</span> input0<span class="op">.</span><span class="at">objects</span>[<span class="st">"atlas-region_admin0_harmonized"</span>])</span>
<span id="cb137-3474"><a href="#cb137-3474" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-137" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb138" data-startfrom="3478" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3477"><span id="cb138-3478"><a href="#cb138-3478" aria-hidden="true" tabindex="-1"></a>admin1_boundaries <span class="op">=</span> <span class="fu">getadmin1</span>()<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-138" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb139" data-startfrom="3482" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3481"><span id="cb139-3482"><a href="#cb139-3482" aria-hidden="true" tabindex="-1"></a>boundaries <span class="op">=</span> {</span>
<span id="cb139-3483"><a href="#cb139-3483" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> input1 <span class="op">=</span> <span class="cf">await</span> <span class="fu">getadmin1</span>()</span>
<span id="cb139-3484"><a href="#cb139-3484" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> input2 <span class="op">=</span> <span class="cf">await</span> <span class="fu">getadmin2</span>()</span>
<span id="cb139-3485"><a href="#cb139-3485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-3486"><a href="#cb139-3486" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> geo <span class="op">=</span> {</span>
<span id="cb139-3487"><a href="#cb139-3487" aria-hidden="true" tabindex="-1"></a>    <span class="dt">admin0</span><span class="op">:</span> admin0_boundaries<span class="op">,</span></span>
<span id="cb139-3488"><a href="#cb139-3488" aria-hidden="true" tabindex="-1"></a>    <span class="dt">admin1</span><span class="op">:</span> admin1_boundaries<span class="op">,</span></span>
<span id="cb139-3489"><a href="#cb139-3489" aria-hidden="true" tabindex="-1"></a>    <span class="dt">admin2</span><span class="op">:</span> <span class="cf">await</span> <span class="fu">getadmin2</span>()<span class="op">,</span></span>
<span id="cb139-3490"><a href="#cb139-3490" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb139-3491"><a href="#cb139-3491" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> geo</span>
<span id="cb139-3492"><a href="#cb139-3492" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-139" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb140" data-startfrom="3496" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3495"><span id="cb140-3496"><a href="#cb140-3496" aria-hidden="true" tabindex="-1"></a>getadmin1 <span class="op">=</span> <span class="kw">async</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb140-3497"><a href="#cb140-3497" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> admin1_query <span class="op">=</span> <span class="vs">`WHERE admin0_name = '</span><span class="sc">${</span>selectAdmin0<span class="sc">}</span><span class="vs">'`</span><span class="op">;</span></span>
<span id="cb140-3498"><a href="#cb140-3498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-3499"><a href="#cb140-3499" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> response <span class="op">=</span> <span class="cf">await</span> geo_db<span class="op">.</span><span class="fu">query</span>(<span class="vs">`</span></span>
<span id="cb140-3500"><a href="#cb140-3500" aria-hidden="true" tabindex="-1"></a><span class="vs">    SELECT *</span></span>
<span id="cb140-3501"><a href="#cb140-3501" aria-hidden="true" tabindex="-1"></a><span class="vs">    FROM admin1_geom</span></span>
<span id="cb140-3502"><a href="#cb140-3502" aria-hidden="true" tabindex="-1"></a><span class="vs">    </span><span class="sc">${</span>admin1_query<span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span></span>
<span id="cb140-3503"><a href="#cb140-3503" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> a1_names <span class="op">=</span> response<span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">admin1_name</span>)<span class="op">;</span></span>
<span id="cb140-3504"><a href="#cb140-3504" aria-hidden="true" tabindex="-1"></a>  <span class="co">// mutable admin1_names = ["Full Country"].concat(a1_names);</span></span>
<span id="cb140-3505"><a href="#cb140-3505" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> wkb_list <span class="op">=</span> response<span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">geometry</span>)<span class="op">;</span></span>
<span id="cb140-3506"><a href="#cb140-3506" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> data <span class="op">=</span> <span class="cf">await</span> response<span class="op">.</span><span class="fu">map</span>(({ geometry<span class="op">,</span> <span class="op">...</span>rest }) <span class="kw">=&gt;</span> rest)<span class="op">;</span></span>
<span id="cb140-3507"><a href="#cb140-3507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-3508"><a href="#cb140-3508" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="fu">geojsonFromWKB</span>(wkb_list<span class="op">,</span> data)<span class="op">;</span></span>
<span id="cb140-3509"><a href="#cb140-3509" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-140" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb141" data-startfrom="3513" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3512"><span id="cb141-3513"><a href="#cb141-3513" aria-hidden="true" tabindex="-1"></a>getadmin2 <span class="op">=</span> <span class="kw">async</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb141-3514"><a href="#cb141-3514" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="op">!</span>selectAdmin1) {</span>
<span id="cb141-3515"><a href="#cb141-3515" aria-hidden="true" tabindex="-1"></a>    <span class="co">// If select Admin 1 is null, return without querying to save bandwidth</span></span>
<span id="cb141-3516"><a href="#cb141-3516" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {</span>
<span id="cb141-3517"><a href="#cb141-3517" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">"FeatureCollection"</span><span class="op">,</span></span>
<span id="cb141-3518"><a href="#cb141-3518" aria-hidden="true" tabindex="-1"></a>      <span class="dt">features</span><span class="op">:</span> []<span class="op">,</span></span>
<span id="cb141-3519"><a href="#cb141-3519" aria-hidden="true" tabindex="-1"></a>    }<span class="op">;</span></span>
<span id="cb141-3520"><a href="#cb141-3520" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb141-3521"><a href="#cb141-3521" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> admin2_query <span class="op">=</span> <span class="vs">`WHERE admin0_name = '</span><span class="sc">${</span>selectAdmin0<span class="sc">}</span><span class="vs">' AND admin1_name = '</span><span class="sc">${</span>selectAdmin1<span class="sc">}</span><span class="vs">'`</span><span class="op">;</span></span>
<span id="cb141-3522"><a href="#cb141-3522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-3523"><a href="#cb141-3523" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> response <span class="op">=</span> <span class="cf">await</span> geo_db<span class="op">.</span><span class="fu">query</span>(<span class="vs">`</span></span>
<span id="cb141-3524"><a href="#cb141-3524" aria-hidden="true" tabindex="-1"></a><span class="vs">    SELECT *</span></span>
<span id="cb141-3525"><a href="#cb141-3525" aria-hidden="true" tabindex="-1"></a><span class="vs">    FROM admin2_geom</span></span>
<span id="cb141-3526"><a href="#cb141-3526" aria-hidden="true" tabindex="-1"></a><span class="vs">    </span><span class="sc">${</span>admin2_query<span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span></span>
<span id="cb141-3527"><a href="#cb141-3527" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> wkb_list <span class="op">=</span> response<span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">geometry</span>)<span class="op">;</span></span>
<span id="cb141-3528"><a href="#cb141-3528" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> data <span class="op">=</span> <span class="cf">await</span> response<span class="op">.</span><span class="fu">map</span>(({ geometry<span class="op">,</span> <span class="op">...</span>rest }) <span class="kw">=&gt;</span> rest)<span class="op">;</span></span>
<span id="cb141-3529"><a href="#cb141-3529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-3530"><a href="#cb141-3530" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="fu">geojsonFromWKB</span>(wkb_list<span class="op">,</span> data)<span class="op">;</span></span>
<span id="cb141-3531"><a href="#cb141-3531" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-141" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb142" data-startfrom="3535" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3534"><span id="cb142-3535"><a href="#cb142-3535" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">geojsonFromWKB</span>(wkb<span class="op">,</span> data <span class="op">=</span> <span class="kw">null</span>) {</span>
<span id="cb142-3536"><a href="#cb142-3536" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (data <span class="op">&amp;&amp;</span> wkb<span class="op">.</span><span class="at">length</span> <span class="op">!==</span> data<span class="op">.</span><span class="at">length</span>) {</span>
<span id="cb142-3537"><a href="#cb142-3537" aria-hidden="true" tabindex="-1"></a>    <span class="cf">throw</span> <span class="kw">new</span> <span class="bu">Error</span>(</span>
<span id="cb142-3538"><a href="#cb142-3538" aria-hidden="true" tabindex="-1"></a>      <span class="vs">`Data length mismatch: expected </span><span class="sc">${</span>wkb<span class="op">.</span><span class="at">length</span><span class="sc">}</span><span class="vs">, got </span><span class="sc">${</span>data<span class="op">.</span><span class="at">length</span><span class="sc">}</span><span class="vs">`</span><span class="op">,</span></span>
<span id="cb142-3539"><a href="#cb142-3539" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb142-3540"><a href="#cb142-3540" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb142-3541"><a href="#cb142-3541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-3542"><a href="#cb142-3542" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> {</span>
<span id="cb142-3543"><a href="#cb142-3543" aria-hidden="true" tabindex="-1"></a>    <span class="dt">type</span><span class="op">:</span> <span class="st">"FeatureCollection"</span><span class="op">,</span></span>
<span id="cb142-3544"><a href="#cb142-3544" aria-hidden="true" tabindex="-1"></a>    <span class="dt">features</span><span class="op">:</span> wkb<span class="op">.</span><span class="fu">map</span>((wkbItem<span class="op">,</span> i) <span class="kw">=&gt;</span> {</span>
<span id="cb142-3545"><a href="#cb142-3545" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> geometry <span class="op">=</span> wkx<span class="op">.</span><span class="at">Geometry</span><span class="op">.</span><span class="fu">parse</span>(<span class="bu">Buffer</span><span class="op">.</span><span class="fu">from</span>(wkbItem))<span class="op">.</span><span class="fu">toGeoJSON</span>()<span class="op">;</span></span>
<span id="cb142-3546"><a href="#cb142-3546" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> geometryRewound <span class="op">=</span> <span class="fu">turfRewind</span>(geometry<span class="op">,</span> { <span class="dt">reverse</span><span class="op">:</span> <span class="kw">true</span> })<span class="op">;</span></span>
<span id="cb142-3547"><a href="#cb142-3547" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> {</span>
<span id="cb142-3548"><a href="#cb142-3548" aria-hidden="true" tabindex="-1"></a>        <span class="dt">type</span><span class="op">:</span> <span class="st">"Feature"</span><span class="op">,</span></span>
<span id="cb142-3549"><a href="#cb142-3549" aria-hidden="true" tabindex="-1"></a>        <span class="dt">geometry</span><span class="op">:</span> geometryRewound<span class="op">,</span></span>
<span id="cb142-3550"><a href="#cb142-3550" aria-hidden="true" tabindex="-1"></a>        <span class="dt">properties</span><span class="op">:</span> data <span class="op">?</span> data[i] <span class="op">:</span> <span class="kw">null</span><span class="op">,</span></span>
<span id="cb142-3551"><a href="#cb142-3551" aria-hidden="true" tabindex="-1"></a>      }<span class="op">;</span></span>
<span id="cb142-3552"><a href="#cb142-3552" aria-hidden="true" tabindex="-1"></a>    })<span class="op">,</span></span>
<span id="cb142-3553"><a href="#cb142-3553" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb142-3554"><a href="#cb142-3554" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-142" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb143" data-startfrom="3558" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3557"><span id="cb143-3558"><a href="#cb143-3558" aria-hidden="true" tabindex="-1"></a>geo_db <span class="op">=</span> {</span>
<span id="cb143-3559"><a href="#cb143-3559" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> db <span class="op">=</span> <span class="cf">await</span> DuckDBClient<span class="op">.</span><span class="fu">of</span>({</span>
<span id="cb143-3560"><a href="#cb143-3560" aria-hidden="true" tabindex="-1"></a>    <span class="dt">admin1_geom</span><span class="op">:</span> <span class="fu">FileAttachment</span>(<span class="st">"atlas-region_admin1_simplified.parquet"</span>)</span>
<span id="cb143-3561"><a href="#cb143-3561" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb143-3562"><a href="#cb143-3562" aria-hidden="true" tabindex="-1"></a>  <span class="cf">await</span> db<span class="op">.</span><span class="fu">query</span>(<span class="vs">`</span></span>
<span id="cb143-3563"><a href="#cb143-3563" aria-hidden="true" tabindex="-1"></a><span class="vs">    CREATE VIEW admin2_geom AS</span></span>
<span id="cb143-3564"><a href="#cb143-3564" aria-hidden="true" tabindex="-1"></a><span class="vs">    SELECT *</span></span>
<span id="cb143-3565"><a href="#cb143-3565" aria-hidden="true" tabindex="-1"></a><span class="vs">    FROM read_parquet("</span><span class="sc">${</span><span class="fu">resolveWindowsCacheIssue</span>(</span>
<span id="cb143-3566"><a href="#cb143-3566" aria-hidden="true" tabindex="-1"></a>      <span class="st">"https://digital-atlas.s3.amazonaws.com/boundaries/atlas-region_admin2_simplified.parquet"</span></span>
<span id="cb143-3567"><a href="#cb143-3567" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">}</span><span class="vs">")`</span>)<span class="op">;</span></span>
<span id="cb143-3568"><a href="#cb143-3568" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> db<span class="op">;</span></span>
<span id="cb143-3569"><a href="#cb143-3569" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-143" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb144" data-startfrom="3573" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3572"><span id="cb144-3573"><a href="#cb144-3573" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { resolveWindowsCacheIssue } <span class="im">from</span> <span class="st">"72281be2f13a0a72"</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-144" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb145" data-startfrom="3577" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3576"><span id="cb145-3577"><a href="#cb145-3577" aria-hidden="true" tabindex="-1"></a><span class="bu">Buffer</span> <span class="op">=</span> (<span class="cf">await</span> <span class="im">import</span>(<span class="st">"https://cdn.jsdelivr.net/npm/buffer@6.0.3/+esm"</span>))</span>
<span id="cb145-3578"><a href="#cb145-3578" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="at">Buffer</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-145" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb146" data-startfrom="3582" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3581"><span id="cb146-3582"><a href="#cb146-3582" aria-hidden="true" tabindex="-1"></a>wkx <span class="op">=</span> <span class="pp">require</span>(<span class="st">"https://bundle.run/wkx@0.5.0"</span>)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-146" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb147" data-startfrom="3586" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3585"><span id="cb147-3586"><a href="#cb147-3586" aria-hidden="true" tabindex="-1"></a>turfRewind <span class="op">=</span> <span class="pp">require</span>(<span class="st">"@turf/turf"</span>)<span class="op">.</span><span class="fu">then</span>((t) <span class="kw">=&gt;</span> t<span class="op">.</span><span class="at">rewind</span>)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-147" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb148" data-startfrom="3590" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3589"><span id="cb148-3590"><a href="#cb148-3590" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`***</span></span>
<span id="cb148-3591"><a href="#cb148-3591" aria-hidden="true" tabindex="-1"></a><span class="vs">## Helpers</span></span>
<span id="cb148-3592"><a href="#cb148-3592" aria-hidden="true" tabindex="-1"></a><span class="vs">*Functions and other good stuff*`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-148" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb149" data-startfrom="3596" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3595"><span id="cb149-3596"><a href="#cb149-3596" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`---</span></span>
<span id="cb149-3597"><a href="#cb149-3597" aria-hidden="true" tabindex="-1"></a><span class="vs">### Dynamic insights</span></span>
<span id="cb149-3598"><a href="#cb149-3598" aria-hidden="true" tabindex="-1"></a><span class="vs">*functions for formatting results*`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-149" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb150" data-startfrom="3602" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3601"><span id="cb150-3602"><a href="#cb150-3602" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">filterByAdminNames</span>(data) {</span>
<span id="cb150-3603"><a href="#cb150-3603" aria-hidden="true" tabindex="-1"></a>  <span class="co">// filter down data by combined selected admin0/admin1/admin2 Admin Selections</span></span>
<span id="cb150-3604"><a href="#cb150-3604" aria-hidden="true" tabindex="-1"></a>  <span class="co">// pass data from query, use tidyjs to filter by admin selection</span></span>
<span id="cb150-3605"><a href="#cb150-3605" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> result <span class="op">=</span> T<span class="op">.</span><span class="fu">tidy</span>(</span>
<span id="cb150-3606"><a href="#cb150-3606" aria-hidden="true" tabindex="-1"></a>    data<span class="op">,</span></span>
<span id="cb150-3607"><a href="#cb150-3607" aria-hidden="true" tabindex="-1"></a>    T<span class="op">.</span><span class="fu">filter</span>((d) <span class="kw">=&gt;</span> {</span>
<span id="cb150-3608"><a href="#cb150-3608" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> (</span>
<span id="cb150-3609"><a href="#cb150-3609" aria-hidden="true" tabindex="-1"></a>        d<span class="op">.</span><span class="at">admin0_name</span> <span class="op">==</span> adminSelections<span class="op">.</span><span class="at">selectAdmin0</span> <span class="op">&amp;&amp;</span></span>
<span id="cb150-3610"><a href="#cb150-3610" aria-hidden="true" tabindex="-1"></a>        d<span class="op">.</span><span class="at">admin1_name</span> <span class="op">==</span> adminSelections<span class="op">.</span><span class="at">selectAdmin1</span> <span class="op">&amp;&amp;</span></span>
<span id="cb150-3611"><a href="#cb150-3611" aria-hidden="true" tabindex="-1"></a>        d<span class="op">.</span><span class="at">admin2_name</span> <span class="op">==</span> adminSelections<span class="op">.</span><span class="at">selectAdmin2</span></span>
<span id="cb150-3612"><a href="#cb150-3612" aria-hidden="true" tabindex="-1"></a>      )<span class="op">;</span></span>
<span id="cb150-3613"><a href="#cb150-3613" aria-hidden="true" tabindex="-1"></a>    })<span class="op">,</span></span>
<span id="cb150-3614"><a href="#cb150-3614" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb150-3615"><a href="#cb150-3615" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> result<span class="op">;</span></span>
<span id="cb150-3616"><a href="#cb150-3616" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-150" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb151" data-startfrom="3620" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3619"><span id="cb151-3620"><a href="#cb151-3620" aria-hidden="true" tabindex="-1"></a><span class="co">// wrapper for format functions, show chosen default</span></span>
<span id="cb151-3621"><a href="#cb151-3621" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">formatWithDefault</span>({</span>
<span id="cb151-3622"><a href="#cb151-3622" aria-hidden="true" tabindex="-1"></a>  value <span class="op">=</span> <span class="dv">1000</span><span class="op">,</span></span>
<span id="cb151-3623"><a href="#cb151-3623" aria-hidden="true" tabindex="-1"></a>  format <span class="op">=</span> (d) <span class="kw">=&gt;</span> d<span class="op">,</span></span>
<span id="cb151-3624"><a href="#cb151-3624" aria-hidden="true" tabindex="-1"></a>  defaultValue <span class="op">=</span> <span class="st">"---"</span><span class="op">,</span></span>
<span id="cb151-3625"><a href="#cb151-3625" aria-hidden="true" tabindex="-1"></a>  debug <span class="op">=</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb151-3626"><a href="#cb151-3626" aria-hidden="true" tabindex="-1"></a>} <span class="op">=</span> {}) {</span>
<span id="cb151-3627"><a href="#cb151-3627" aria-hidden="true" tabindex="-1"></a>  <span class="co">// apply a formatting function to a value</span></span>
<span id="cb151-3628"><a href="#cb151-3628" aria-hidden="true" tabindex="-1"></a>  <span class="co">// return default value if undefined or null</span></span>
<span id="cb151-3629"><a href="#cb151-3629" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (value <span class="op">??</span> <span class="kw">true</span>) {</span>
<span id="cb151-3630"><a href="#cb151-3630" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">format</span>(value)<span class="op">;</span></span>
<span id="cb151-3631"><a href="#cb151-3631" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb151-3632"><a href="#cb151-3632" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> defaultValue<span class="op">;</span></span>
<span id="cb151-3633"><a href="#cb151-3633" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb151-3634"><a href="#cb151-3634" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-151" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb152" data-startfrom="3638" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3637"><span id="cb152-3638"><a href="#cb152-3638" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`---</span></span>
<span id="cb152-3639"><a href="#cb152-3639" aria-hidden="true" tabindex="-1"></a><span class="vs">### Data functions: format and transform</span></span>
<span id="cb152-3640"><a href="#cb152-3640" aria-hidden="true" tabindex="-1"></a><span class="vs">*apply formatting to/transform a value*</span></span>
<span id="cb152-3641"><a href="#cb152-3641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-3642"><a href="#cb152-3642" aria-hidden="true" tabindex="-1"></a><span class="vs">- Reference: [Intl.NumberFormat()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl/NumberFormat/NumberFormat)`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-152" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb153" data-startfrom="3646" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3645"><span id="cb153-3646"><a href="#cb153-3646" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`### Transforms`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-153" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb154" data-startfrom="3650" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3649"><span id="cb154-3650"><a href="#cb154-3650" aria-hidden="true" tabindex="-1"></a><span class="co">// transform non-number to percent value</span></span>
<span id="cb154-3651"><a href="#cb154-3651" aria-hidden="true" tabindex="-1"></a>transformPercent <span class="op">=</span> (d) <span class="kw">=&gt;</span> {</span>
<span id="cb154-3652"><a href="#cb154-3652" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (d <span class="op">===</span> <span class="kw">undefined</span> <span class="op">||</span> d <span class="op">===</span> <span class="kw">null</span>) <span class="cf">return</span> d<span class="op">;</span></span>
<span id="cb154-3653"><a href="#cb154-3653" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="cf">return</span> d <span class="op">*</span> <span class="dv">100</span><span class="op">;</span></span>
<span id="cb154-3654"><a href="#cb154-3654" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-154" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb155" data-startfrom="3658" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3657"><span id="cb155-3658"><a href="#cb155-3658" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`### Formatting`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-155" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb156" data-startfrom="3662" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3661"><span id="cb156-3662"><a href="#cb156-3662" aria-hidden="true" tabindex="-1"></a><span class="co">// format non-number as percent</span></span>
<span id="cb156-3663"><a href="#cb156-3663" aria-hidden="true" tabindex="-1"></a>formatPercentTenth <span class="op">=</span> (d) <span class="kw">=&gt;</span> {</span>
<span id="cb156-3664"><a href="#cb156-3664" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (d <span class="op">===</span> <span class="kw">undefined</span> <span class="op">||</span> d <span class="op">===</span> <span class="kw">null</span>) <span class="cf">return</span> d<span class="op">;</span></span>
<span id="cb156-3665"><a href="#cb156-3665" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="cf">return</span> d3<span class="op">.</span><span class="fu">format</span>(<span class="st">".1%"</span>)(d)<span class="op">;</span></span>
<span id="cb156-3666"><a href="#cb156-3666" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-156" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb157" data-startfrom="3670" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3669"><span id="cb157-3670"><a href="#cb157-3670" aria-hidden="true" tabindex="-1"></a><span class="co">// format non-number as percent</span></span>
<span id="cb157-3671"><a href="#cb157-3671" aria-hidden="true" tabindex="-1"></a>formatPercentWhole <span class="op">=</span> (d) <span class="kw">=&gt;</span> {</span>
<span id="cb157-3672"><a href="#cb157-3672" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (d <span class="op">===</span> <span class="kw">undefined</span> <span class="op">||</span> d <span class="op">===</span> <span class="kw">null</span>) <span class="cf">return</span> d<span class="op">;</span></span>
<span id="cb157-3673"><a href="#cb157-3673" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="cf">return</span> d3<span class="op">.</span><span class="fu">format</span>(<span class="st">".0%"</span>)(d)<span class="op">;</span></span>
<span id="cb157-3674"><a href="#cb157-3674" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-157" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb158" data-startfrom="3678" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3677"><span id="cb158-3678"><a href="#cb158-3678" aria-hidden="true" tabindex="-1"></a><span class="co">// format US currency</span></span>
<span id="cb158-3679"><a href="#cb158-3679" aria-hidden="true" tabindex="-1"></a>formatUSD <span class="op">=</span> <span class="kw">new</span> <span class="bu">Intl</span><span class="op">.</span><span class="fu">NumberFormat</span>(<span class="st">"en-US"</span><span class="op">,</span> {</span>
<span id="cb158-3680"><a href="#cb158-3680" aria-hidden="true" tabindex="-1"></a>  <span class="dt">notation</span><span class="op">:</span> <span class="st">"compact"</span><span class="op">,</span></span>
<span id="cb158-3681"><a href="#cb158-3681" aria-hidden="true" tabindex="-1"></a>  <span class="dt">compactDisplay</span><span class="op">:</span> <span class="st">"short"</span><span class="op">,</span></span>
<span id="cb158-3682"><a href="#cb158-3682" aria-hidden="true" tabindex="-1"></a>  <span class="dt">style</span><span class="op">:</span> <span class="st">"currency"</span><span class="op">,</span></span>
<span id="cb158-3683"><a href="#cb158-3683" aria-hidden="true" tabindex="-1"></a>  <span class="dt">currency</span><span class="op">:</span> <span class="st">"usd"</span><span class="op">,</span></span>
<span id="cb158-3684"><a href="#cb158-3684" aria-hidden="true" tabindex="-1"></a>})<span class="op">.</span><span class="at">format</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-158" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb159" data-startfrom="3688" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3687"><span id="cb159-3688"><a href="#cb159-3688" aria-hidden="true" tabindex="-1"></a><span class="co">// format number, long notation</span></span>
<span id="cb159-3689"><a href="#cb159-3689" aria-hidden="true" tabindex="-1"></a>formatNumCompactLong <span class="op">=</span> <span class="kw">new</span> <span class="bu">Intl</span><span class="op">.</span><span class="fu">NumberFormat</span>(<span class="st">"en-US"</span><span class="op">,</span> {</span>
<span id="cb159-3690"><a href="#cb159-3690" aria-hidden="true" tabindex="-1"></a>  <span class="dt">notation</span><span class="op">:</span> <span class="st">"compact"</span><span class="op">,</span></span>
<span id="cb159-3691"><a href="#cb159-3691" aria-hidden="true" tabindex="-1"></a>  <span class="dt">compactDisplay</span><span class="op">:</span> <span class="st">"long"</span><span class="op">,</span></span>
<span id="cb159-3692"><a href="#cb159-3692" aria-hidden="true" tabindex="-1"></a>  <span class="dt">unitDisplay</span><span class="op">:</span> <span class="st">"long"</span><span class="op">,</span></span>
<span id="cb159-3693"><a href="#cb159-3693" aria-hidden="true" tabindex="-1"></a>})<span class="op">.</span><span class="at">format</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-159" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb160" data-startfrom="3697" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3696"><span id="cb160-3697"><a href="#cb160-3697" aria-hidden="true" tabindex="-1"></a><span class="co">// format number, long notation</span></span>
<span id="cb160-3698"><a href="#cb160-3698" aria-hidden="true" tabindex="-1"></a>formatNumCompactShort <span class="op">=</span> <span class="kw">new</span> <span class="bu">Intl</span><span class="op">.</span><span class="fu">NumberFormat</span>(<span class="st">"en-US"</span><span class="op">,</span> {</span>
<span id="cb160-3699"><a href="#cb160-3699" aria-hidden="true" tabindex="-1"></a>  <span class="dt">notation</span><span class="op">:</span> <span class="st">"compact"</span><span class="op">,</span></span>
<span id="cb160-3700"><a href="#cb160-3700" aria-hidden="true" tabindex="-1"></a>  <span class="dt">compactDisplay</span><span class="op">:</span> <span class="st">"short"</span><span class="op">,</span></span>
<span id="cb160-3701"><a href="#cb160-3701" aria-hidden="true" tabindex="-1"></a>})<span class="op">.</span><span class="at">format</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-160" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb161" data-startfrom="3705" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3704"><span id="cb161-3705"><a href="#cb161-3705" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`---</span></span>
<span id="cb161-3706"><a href="#cb161-3706" aria-hidden="true" tabindex="-1"></a><span class="vs">### Querying data</span></span>
<span id="cb161-3707"><a href="#cb161-3707" aria-hidden="true" tabindex="-1"></a><span class="vs">*functions for querying data*`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-161" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb162" data-startfrom="3711" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3710"><span id="cb162-3711"><a href="#cb162-3711" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">getUniqueValues</span>(col<span class="op">,</span> tbl<span class="op">,</span> db) {</span>
<span id="cb162-3712"><a href="#cb162-3712" aria-hidden="true" tabindex="-1"></a>  <span class="co">// return unique values of from db tbl as a list</span></span>
<span id="cb162-3713"><a href="#cb162-3713" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> db</span>
<span id="cb162-3714"><a href="#cb162-3714" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">query</span>(<span class="vs">`select distinct </span><span class="sc">${</span>col<span class="sc">}</span><span class="vs"> from </span><span class="sc">${</span>tbl<span class="sc">}</span><span class="vs">`</span>)</span>
<span id="cb162-3715"><a href="#cb162-3715" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">then</span>((x) <span class="kw">=&gt;</span> x<span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> d[col]))</span>
<span id="cb162-3716"><a href="#cb162-3716" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">then</span>((r) <span class="kw">=&gt;</span> r<span class="op">.</span><span class="fu">toArray</span>())<span class="op">;</span></span>
<span id="cb162-3717"><a href="#cb162-3717" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-162" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb163" data-startfrom="3721" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3720"><span id="cb163-3721"><a href="#cb163-3721" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">bindTabularToGeo</span>({</span>
<span id="cb163-3722"><a href="#cb163-3722" aria-hidden="true" tabindex="-1"></a>  data <span class="op">=</span> []<span class="op">,</span></span>
<span id="cb163-3723"><a href="#cb163-3723" aria-hidden="true" tabindex="-1"></a>  dataBindColumn <span class="op">=</span> <span class="st">"dataBindColumn"</span><span class="op">,</span></span>
<span id="cb163-3724"><a href="#cb163-3724" aria-hidden="true" tabindex="-1"></a>  geoData <span class="op">=</span> []<span class="op">,</span></span>
<span id="cb163-3725"><a href="#cb163-3725" aria-hidden="true" tabindex="-1"></a>  geoDataBindColumn <span class="op">=</span> <span class="st">"geoDataBindColumn"</span><span class="op">,</span></span>
<span id="cb163-3726"><a href="#cb163-3726" aria-hidden="true" tabindex="-1"></a>}) {</span>
<span id="cb163-3727"><a href="#cb163-3727" aria-hidden="true" tabindex="-1"></a>  <span class="co">// bind data to geojson</span></span>
<span id="cb163-3728"><a href="#cb163-3728" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> index <span class="op">=</span> <span class="kw">new</span> <span class="bu">Map</span>(data<span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> [d[dataBindColumn]<span class="op">,</span> d]))<span class="op">;</span> <span class="co">// map data by dataBindColumn</span></span>
<span id="cb163-3729"><a href="#cb163-3729" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> geojson <span class="op">=</span> <span class="bu">JSON</span><span class="op">.</span><span class="fu">parse</span>(<span class="bu">JSON</span><span class="op">.</span><span class="fu">stringify</span>(geoData))<span class="op">;</span> <span class="co">// do a copy, rather than mutate</span></span>
<span id="cb163-3730"><a href="#cb163-3730" aria-hidden="true" tabindex="-1"></a>  <span class="co">// join up data to geojson</span></span>
<span id="cb163-3731"><a href="#cb163-3731" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">const</span> f <span class="kw">of</span> geojson<span class="op">.</span><span class="at">features</span>) {</span>
<span id="cb163-3732"><a href="#cb163-3732" aria-hidden="true" tabindex="-1"></a>    f<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">data</span> <span class="op">=</span> index<span class="op">.</span><span class="fu">get</span>(f<span class="op">.</span><span class="at">properties</span>[geoDataBindColumn])<span class="op">;</span></span>
<span id="cb163-3733"><a href="#cb163-3733" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb163-3734"><a href="#cb163-3734" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> geojson<span class="op">;</span></span>
<span id="cb163-3735"><a href="#cb163-3735" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-163" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb164" data-startfrom="3739" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3738"><span id="cb164-3739"><a href="#cb164-3739" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`## Imports`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-164" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb165" data-startfrom="3743" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3742"><span id="cb165-3743"><a href="#cb165-3743" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { toc } <span class="im">from</span> <span class="st">"@nebrius/indented-toc"</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-165" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb166" data-startfrom="3747" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3746"><span id="cb166-3747"><a href="#cb166-3747" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { T } <span class="im">from</span> <span class="st">"@pbeshai/tidyjs"</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-166" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb167" data-startfrom="3751" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3750"><span id="cb167-3751"><a href="#cb167-3751" aria-hidden="true" tabindex="-1"></a>quick_insights_projected_1 <span class="op">=</span> <span class="fu">FileAttachment</span>(</span>
<span id="cb167-3752"><a href="#cb167-3752" aria-hidden="true" tabindex="-1"></a>  <span class="st">"quick_insights_projected_1@1.json"</span><span class="op">,</span></span>
<span id="cb167-3753"><a href="#cb167-3753" aria-hidden="true" tabindex="-1"></a>)<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-167" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb168" data-startfrom="3757" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3756"><span id="cb168-3757"><a href="#cb168-3757" aria-hidden="true" tabindex="-1"></a>quick_insights_projected_2 <span class="op">=</span> <span class="fu">FileAttachment</span>(</span>
<span id="cb168-3758"><a href="#cb168-3758" aria-hidden="true" tabindex="-1"></a>  <span class="st">"quick_insights_projected_2@1.json"</span><span class="op">,</span></span>
<span id="cb168-3759"><a href="#cb168-3759" aria-hidden="true" tabindex="-1"></a>)<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-168" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb169" data-startfrom="3763" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3762"><span id="cb169-3763"><a href="#cb169-3763" aria-hidden="true" tabindex="-1"></a>quick_insights_projected_3 <span class="op">=</span> <span class="fu">FileAttachment</span>(</span>
<span id="cb169-3764"><a href="#cb169-3764" aria-hidden="true" tabindex="-1"></a>  <span class="st">"quick_insights_projected_3_only_africa.json"</span><span class="op">,</span></span>
<span id="cb169-3765"><a href="#cb169-3765" aria-hidden="true" tabindex="-1"></a>)<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-169" data-nodetype="declaration"></div></div></div></section></main><script type="ojs-module-contents">eyJjb250ZW50cyI6W3sibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImltcG9ydCB7IGhlcm9JbWFnZSB9IGZyb20gXCIvaGVscGVycy9oZXJvLmpzXCI7XG5oZXJvX3VybCA9IFwiLi8uLi8uLi9pbWFnZXMvcHJvamVjdGVkSW1wYWN0cy53ZWJwXCI7XG5cbmhlcm8gPSBoZXJvSW1hZ2Uobm90ZWJvb2tUaXRsZSwgaGVyb191cmwpO1xuaHRtbGAke2hlcm99YDtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImltcG9ydCB7IGF0bGFzVE9DIH0gZnJvbSAnL2hlbHBlcnMvdG9jLm9qcycgXG57XG4gIGF3YWl0IG5iVGV4dCAvLyBmb3JjZSB3YWl0L3JlbG9hZCB3aXRoIG5iVGV4dCB0byBsb2FkIHNvIGhlYWRpbmdzIGhhdmUgY29ycmVjdCBsYWJlbHMvbGFuZ3VhZ2VzXG4gIHJldHVybiBhdGxhc1RPQyh7XG4gICAgICBoZWFkaW5nOiBgPGI+JHtfbGFuZyh7ZW46XCJJbiB0aGlzIG5vdGVib29rXCIsIGZyOlwiRGFucyBjZSBub3RlYm9va1wifSl9PC9iPmAsXG4gICAgICBza2lwOiBbbm90ZWJvb2tUaXRsZSwgXCJub3RlYm9vay10aXRsZVwiLCBcIkFwcGVuZGl4XCIsIFwic291cmNlLWNvZGVcIl1cbiAgICAgIH0pXG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTMiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ2aWV3b2YgcHJldHR5TGFuZ3VhZ2VWaWV3ID0ge1xuICByZXR1cm4gSW5wdXRzLmJpbmQoXG4gICAgSW5wdXRzLnJhZGlvKGxhbmd1YWdlcywge1xuICAgICAgbGFiZWw6IF9sYW5nKHtlbjogXCJMYW5ndWFnZVwiLCBmcjogXCJMYW5ndWVcIn0pLFxuICAgICAgZm9ybWF0OiAoZCkgPT4gZC5sYWJlbFxuICAgIH0pLFxuICAgIHZpZXdvZiBsYW5ndWFnZVxuICApO1xufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC00IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoibWRgIyAke19sYW5nKG5iVGV4dC5vdmVydmlldy50aXRsZSl9XG5cbiR7X2xhbmcobmJUZXh0Lm92ZXJ2aWV3LnRleHQpfWA7XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTUiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJtZGAjICR7X2xhbmcobmJUZXh0LnJlZ2lvbmFsUGljdHVyZS50aXRsZSl9XG5cbiR7X2xhbmcobmJUZXh0LnJlZ2lvbmFsUGljdHVyZS50ZXh0KX1gO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC02IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoie1xuICBjb25zdCBmb3JtID0gSW5wdXRzLmZvcm0oXG4gICAgW1xuICAgICAgSW5wdXRzLmJpbmQoXG4gICAgICAgIElucHV0cy5zZWxlY3QoXG4gICAgICAgICAgW1wibWFpemVcIiwgXCJyaWNlXCIsIFwid2hlYXRcIl0sXG4gICAgICAgICAge2xhYmVsOiBfbGFuZyhuYlRleHQuZ2VuZXJhbC5jcm9wKSxcbiAgICAgICAgICBmb3JtYXQ6IGMgPT4gX2xhbmcobmJUZXh0LmdlbmVyYWwuY3JvcHNbY10pfVxuICAgICAgICApLFxuICAgICAgdmlld29mIGNyb3Bfc2VsZWN0b3JfeWllbGQpLFxuICAgICAgSW5wdXRzLmJpbmQoXG4gICAgICAgIElucHV0cy5zZWxlY3QoXG4gICAgICAgICAgYXZhbGlhYmxlX3VuUmVnaW9ucyxcbiAgICAgICAgICB7bGFiZWw6IF9sYW5nKG5iVGV4dC5yZWdpb25hbFBpY3R1cmUuYmVlc3dhcm0ueUF4aXMpLFxuICAgICAgICAgIGZvcm1hdDogZCA9PiAgX2xhbmcobmJUZXh0LnJlZ2lvbmFsUGljdHVyZS5iZWVzd2FybS5yZWdpb25zW2QgfHwgXCJhbGxcIl0pfSAvLyBObyByZWdpb24gaXMgTlVMTCBzbyBhZGQgYSBsYWJlbFxuICAgICAgICApLFxuICAgICAgdmlld29mIHNlbF9yZWdpb24pLFxuICAgIF0sXG4gICAge1xuICAgICAgdGVtcGxhdGU6IGZvcm1UZW1wbGF0ZSgpXG4gICAgfVxuICApXG4gIHJldHVybiBmb3JtXG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTciLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ7XG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgLy8gREFUQSBQUkVQQVJBVElPTlxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIFxuICBjb25zdCBjbGVhbkRhdGEgPSBpbXBhY3RzX21ldGFhbmFseXNpc19kYXRhXG4gICAgLmZpbHRlcihkID0+IFxuICAgICAgIXNlbF9yZWdpb24gfHwgZD8uVU5SZWdpb24gPT09IHNlbF9yZWdpb25cbiAgICApXG4gICAgLm1hcChkID0+ICh7XG4gICAgICAuLi5kLFxuICAgICAgdGVtcF9iYW5kOiBjbGFzc2lmeVRlbXBCYW5kKGQucHJlaW5kdXN0cmlhbF90ZW1wX2RlbHRhKVxuICAgIH0pKTtcblxuICAgIGNvbnN0IHZpb2xpbl90dF9odG1sID0gKHRlbXAsIGFkYXB0YXRpb24sIG1lYW4sIG1pbiwgbWF4LCBzZCwgbl9vYnMpID0+IHtcbiAgICAgIHJldHVybiBgPHN0cm9uZz5XaXRoIEFkYXB0YXRhdGlvbjo8L3N0cm9uZz4gJHthZGFwdGF0aW9ufTxici8+XG4gICAgICAgICAgICAgIDxzdHJvbmc+VGVtcGVyYXR1cmU6PC9zdHJvbmc+ICR7dGVtcH08YnIvPlxuICAgICAgICAgICAgICA8c3Ryb25nPllpZWxkIGxvc3MgKCUpOjwvc3Ryb25nPjxici8+XG4gICAgICAgICAgICAgIDxzdHJvbmc+TWVhbjo8L3N0cm9uZz4gJHttZWFuLnRvRml4ZWQoMil9PGJyLz5cbiAgICAgICAgICAgICAgPHN0cm9uZz5NaW46PC9zdHJvbmc+ICR7bWluLnRvRml4ZWQoMil9PGJyLz5cbiAgICAgICAgICAgICAgPHN0cm9uZz5NYXg6PC9zdHJvbmc+ICR7bWF4LnRvRml4ZWQoMil9PGJyLz5cbiAgICAgICAgICAgICAgPHN0cm9uZz5TdGQgRGV2Ojwvc3Ryb25nPiAke3NkLnRvRml4ZWQoMil9PGJyLz5cbiAgICAgICAgICAgICAgPHN0cm9uZz5PYnNlcnZhdGlvbnM6PC9zdHJvbmc+ICR7bl9vYnN9PGJyLz5gXG4gICAgfVxuXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgLy8gSEVMUEVSIEZVTkNUSU9OU1xuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIFxuICBmdW5jdGlvbiBjbGFzc2lmeVRlbXBCYW5kKHRlbXApIHtcbiAgICBpZiAodGVtcCA8PSAyKSByZXR1cm4gXCLiiaQgMsKwQ1wiIC8vIHJldHVybiBcIuKJpCAxLjXCsENcIjtcbiAgICBpZiAodGVtcCA8PSAzKSByZXR1cm4gXCIyLTPCsENcIi8vIHJldHVybiBcIjEuNeKAkzIuNcKwQ1wiO1xuICAgIHJldHVybiBcIj4gM8KwQ1wiOyAvLyBcIj4gMi41wrBDXCJcbiAgfVxuXG4gIGZ1bmN0aW9uIGdhdXNzaWFuS2VybmVsKHUpIHtcbiAgICByZXR1cm4gTWF0aC5leHAoLTAuNSAqIHUgKiB1KSAvIE1hdGguc3FydCgyICogTWF0aC5QSSk7XG4gIH1cblxuICBmdW5jdGlvbiBzaWx2ZXJtYW5CYW5kd2lkdGgodmFsdWVzKSB7XG4gICAgY29uc3QgbiA9IHZhbHVlcy5sZW5ndGg7XG4gICAgaWYgKG4gPCAyKSByZXR1cm4gMS41O1xuICAgIGNvbnN0IHNkID0gZDMuZGV2aWF0aW9uKHZhbHVlcykgfHwgMTtcbiAgICByZXR1cm4gTWF0aC5tYXgoMSwgMS4wNiAqIHNkICogTWF0aC5wb3cobiwgLTAuMikpO1xuICB9XG5cbiAgZnVuY3Rpb24gY29tcHV0ZUtERShncmlkLCBzYW1wbGVzLCBiYW5kd2lkdGgpIHtcbiAgICBjb25zdCBpbnZCdyA9IDEgLyBiYW5kd2lkdGg7XG4gICAgcmV0dXJuIGdyaWQubWFwKGdyaWRQb2ludCA9PiB7XG4gICAgICBjb25zdCBkZW5zaXR5ID0gZDMubWVhbihzYW1wbGVzLCB2ID0+IFxuICAgICAgICBnYXVzc2lhbktlcm5lbCgoZ3JpZFBvaW50IC0gdikgKiBpbnZCdylcbiAgICAgICkgKiBpbnZCdztcbiAgICAgIHJldHVybiBbZ3JpZFBvaW50LCBkZW5zaXR5IHx8IDBdO1xuICAgIH0pO1xuICB9XG4gIFxuICBmdW5jdGlvbiBrZGVXaXRoaW5FeHRlbnQoc2FtcGxlcywgc3RlcD0wLjI1KSB7IC8vIENsYW1wIHRoZSB0YWlscyBvZiB0aGUgdmlvbGluIHRvIG1pbiBhbmQgbWF4XG4gICAgY29uc3QgW2xvLCBoaV0gPSBkMy5leHRlbnQoc2FtcGxlcyk7XG4gICAgY29uc3QgYncgPSBzaWx2ZXJtYW5CYW5kd2lkdGgoc2FtcGxlcyk7XG4gICAgY29uc3QgZ3JpZCA9IGQzLnJhbmdlKGxvLCBoaSArIHN0ZXAsIHN0ZXApO1xuICAgIGNvbnN0IGRlbnNpdHkgPSBjb21wdXRlS0RFKGdyaWQsIHNhbXBsZXMsIGJ3KTtcbiAgICBjb25zdCBtYXhEZW5zaXR5ID0gZDMubWF4KGRlbnNpdHksIGQgPT4gZFsxXSkgfHwgMDtcbiAgICByZXR1cm4geyBkZW5zaXR5LCBtYXhEZW5zaXR5LCBsbywgaGkgfTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGNvbXB1dGVEZW5zaXRpZXNQZXJBZGFwdGF0aW9uKGRhdGFTdWJzZXQpIHtcbiAgICByZXR1cm4gZDMuZ3JvdXBzKGRhdGFTdWJzZXQsIGQgPT4gZC5BZGFwdGF0aW9uKVxuICAgICAgLm1hcCgoW2FkYXB0YXRpb24sIHJlY29yZHNdKSA9PiB7XG4gICAgICAgIGNvbnN0IHZhbHVlcyA9IHJlY29yZHMubWFwKGQgPT4gZC55aWVsZF9pbXBhY3RfcGN0KTtcbiAgICAgICAgY29uc3QgeyBkZW5zaXR5LCBtYXhEZW5zaXR5LCBsbywgaGkgfSA9IGtkZVdpdGhpbkV4dGVudCh2YWx1ZXMpO1xuICAgICAgICByZXR1cm4geyBhZGFwdGF0aW9uLCByZWNvcmRzLCBkZW5zaXR5LCBtYXhEZW5zaXR5LCBsbywgaGkgfTtcbiAgICB9KTtcbiAgfVxuXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgLy8gU0NBTEVTIEFORCBESU1FTlNJT05TXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgXG4gIGNvbnN0IG1hcmdpbiA9IHsgdG9wOiA2MCwgcmlnaHQ6IDMwLCBib3R0b206IDMwLCBsZWZ0OiA4MCB9O1xuICBjb25zdCB3aWR0aCA9IDEwMDA7XG4gIGNvbnN0IGhlaWdodCA9IDYwMDtcbiAgY29uc3QgaW5uZXJXID0gd2lkdGggLSBtYXJnaW4ubGVmdCAtIG1hcmdpbi5yaWdodDtcbiAgY29uc3QgaW5uZXJIID0gaGVpZ2h0IC0gbWFyZ2luLnRvcCAtIG1hcmdpbi5ib3R0b207XG5cbiAgLy8gWSBzY2FsZSAoeWllbGQgaW1wYWN0KVxuICAvLyBjb25zdCB5RXh0ZW50ID0gZDMuZXh0ZW50KGNsZWFuRGF0YSwgZCA9PiBkLnlpZWxkX2ltcGFjdF9wY3QpO1xuICBjb25zdCB5RXh0ZW50ID0gWy0xMDAsIDEwMF1cbiAgY29uc3QgcGFkZGluZyA9IDA7XG4gIGNvbnN0IHlNaW4gPSBNYXRoLm1pbigoeUV4dGVudFswXSA/PyAtMTApIC0gcGFkZGluZywgMCk7XG4gIGNvbnN0IHlNYXggPSBNYXRoLm1heCgoeUV4dGVudFsxXSA/PyAxMCkgKyBwYWRkaW5nLCAwKTtcbiAgXG4gIGNvbnN0IHlTY2FsZSA9IGQzLnNjYWxlTGluZWFyKClcbiAgICAuZG9tYWluKFt5TWluLCB5TWF4XSlcbiAgICAubmljZSgpXG4gICAgLnJhbmdlKFtpbm5lckgsIDBdKTtcblxuICBjb25zdCB5R3JpZCA9IGQzLnJhbmdlKFxuICAgIHlTY2FsZS5kb21haW4oKVswXSwgXG4gICAgeVNjYWxlLmRvbWFpbigpWzFdICsgMWUtOSwgXG4gICAgKHlTY2FsZS5kb21haW4oKVsxXSAtIHlTY2FsZS5kb21haW4oKVswXSkgLyAxMDBcbiAgKTtcblxuICAvLyBUZW1wZXJhdHVyZSBiYW5kIGNvbHVtbnNcbiAgLy8gY29uc3QgdGVtcEJhbmRzID0gW1wi4omkIDEuNcKwQ1wiLCBcIjEuNeKAkzIuNcKwQ1wiLCBcIj4gMi41wrBDXCJdO1xuICBjb25zdCB0ZW1wQmFuZHMgPSBbXCLiiaQgMsKwQ1wiLCBcIjItM8KwQ1wiLCBcIj4gM8KwQ1wiXVxuICBjb25zdCB4QmFuZFNjYWxlID0gZDMuc2NhbGVCYW5kKClcbiAgICAuZG9tYWluKHRlbXBCYW5kcylcbiAgICAucmFuZ2UoWzAsIGlubmVyV10pXG4gICAgLnBhZGRpbmcoMC4xNSk7XG5cbiAgLy8gQWRhcHRhdGlvbiBjYXRlZ29yaWVzIHdpdGhpbiBlYWNoIGNvbHVtblxuICBjb25zdCBhZGFwdGF0aW9uVHlwZXMgPSBBcnJheS5mcm9tKFxuICAgIG5ldyBTZXQoY2xlYW5EYXRhLm1hcChkID0+IGQuQWRhcHRhdGlvbikpXG4gICkuc29ydChkMy5hc2NlbmRpbmcpO1xuICBcbiAgY29uc3QgeElubmVyU2NhbGUgPSBkMy5zY2FsZVBvaW50KClcbiAgICAuZG9tYWluKGFkYXB0YXRpb25UeXBlcylcbiAgICAucmFuZ2UoWzAsIHhCYW5kU2NhbGUuYmFuZHdpZHRoKCldKVxuICAgIC5wYWRkaW5nKDAuNik7XG5cbiAgLy8gQ29sb3Igc2NhbGVcbiAgY29uc3QgY29sb3JTY2FsZSA9IGQzLnNjYWxlT3JkaW5hbCgpXG4gICAgLmRvbWFpbihhZGFwdGF0aW9uVHlwZXMpXG4gICAgLnJhbmdlKGQzLnNjaGVtZVRhYmxlYXUxMCk7XG5cbiAgLy8gVmlvbGluIHdpZHRoIHNjYWxlIChzaGFyZWQgYWNyb3NzIGFsbCBjb2x1bW5zKVxuICBjb25zdCBtYXhEZW5zaXR5R2xvYmFsID0gZDMubWF4KFxuICAgIHRlbXBCYW5kcy5tYXAoYmFuZCA9PiB7XG4gICAgICBjb25zdCBzdWJzZXQgPSBjbGVhbkRhdGEuZmlsdGVyKGQgPT4gZC50ZW1wX2JhbmQgPT09IGJhbmQpO1xuICAgICAgcmV0dXJuIGQzLm1heChjb21wdXRlRGVuc2l0aWVzUGVyQWRhcHRhdGlvbihzdWJzZXQpLCBkID0+IGQubWF4RGVuc2l0eSk7XG4gICAgfSlcbiAgKSB8fCAxO1xuICBcbiAgY29uc3QgbWF4VmlvbGluSGFsZldpZHRoID0gTWF0aC5taW4oNDUsICh4QmFuZFNjYWxlLmJhbmR3aWR0aCgpIC8gYWRhcHRhdGlvblR5cGVzLmxlbmd0aCkgKiAwLjM1KTtcbiAgY29uc3Qgd2lkdGhTY2FsZSA9IGQzLnNjYWxlTGluZWFyKClcbiAgICAuZG9tYWluKFswLCBtYXhEZW5zaXR5R2xvYmFsXSlcbiAgICAucmFuZ2UoWzAsIG1heFZpb2xpbkhhbGZXaWR0aF0pO1xuXG4gIC8vIFZpb2xpbiBhcmVhIGdlbmVyYXRvclxuICBjb25zdCBhcmVhR2VuZXJhdG9yID0gZDMuYXJlYSgpXG4gICAgLmN1cnZlKGQzLmN1cnZlQ2F0bXVsbFJvbSlcbiAgICAueDAoZCA9PiAtd2lkdGhTY2FsZShkWzFdKSlcbiAgICAueDEoZCA9PiArd2lkdGhTY2FsZShkWzFdKSlcbiAgICAueShkID0+IHlTY2FsZShkWzBdKSk7XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAvLyBTVkcgU0VUVVBcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICBjb25zdCBpZCA9IFwiaW1wYWN0ZnVsVmlvbGluXCJcbiAgY29uc3Qgc3ZnID0gZDMuY3JlYXRlKFwic3ZnXCIpXG4gICAgLmF0dHIoXCJ3aWR0aFwiLCB3aWR0aClcbiAgICAuYXR0cihcImhlaWdodFwiLCBoZWlnaHQpXG4gICAgLy8gLnN0eWxlKFwiYmFja2dyb3VuZFwiLCBcIiNmYWZhZmFcIilcbiAgICAvLyAuc3R5bGUoXCJmb250LWZhbWlseVwiLCBcIidJbnRlcicsIC1hcHBsZS1zeXN0ZW0sIEJsaW5rTWFjU3lzdGVtRm9udCwgJ1NlZ29lIFVJJywgc2Fucy1zZXJpZlwiKTtcblxuICBjb25zdCBjaGFydEFyZWEgPSBzdmcuYXBwZW5kKFwiZ1wiKVxuICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIGB0cmFuc2xhdGUoJHttYXJnaW4ubGVmdH0sJHttYXJnaW4udG9wfSlgKTtcblxuICBkMy5zZWxlY3RBbGwoYCMke2lkfS10b29sdGlwYCkucmVtb3ZlKCk7XG4gIGNvbnN0IHRvb2x0aXAgPSBkM1xuICAgIC5zZWxlY3QoXCJib2R5XCIpXG4gICAgLmFwcGVuZChcImRpdlwiKVxuICAgIC5hdHRyKFwiaWRcIiwgYCR7aWR9LXRvb2x0aXBgKVxuICAgIC5hdHRyKFwiY2xhc3NcIiwgXCJwbG90VG9vbHRpcCBoYXphcmRUaXBcIilcbiAgICAuc3R5bGUoXCJwb3NpdGlvblwiLCBcImFic29sdXRlXCIpO1xuXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgLy8gRFJBVyBDT0xVTU5TIChURU1QRVJBVFVSRSBCQU5EUylcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICBcbiAgY29uc3QgY29sdW1uc0dyb3VwID0gY2hhcnRBcmVhLmFwcGVuZChcImdcIikuYXR0cihcImNsYXNzXCIsIFwiY29sdW1uc1wiKTtcbiAgY29uc3Qgaml0dGVyR2VuZXJhdG9yID0gZDMucmFuZG9tVW5pZm9ybS5zb3VyY2UoZDMucmFuZG9tTGNnKDQyKSkoXG4gICAgLW1heFZpb2xpbkhhbGZXaWR0aCAqIDAuODUsIFxuICAgIG1heFZpb2xpbkhhbGZXaWR0aCAqIDAuODVcbiAgKTtcblxuICB0ZW1wQmFuZHMuZm9yRWFjaChiYW5kID0+IHtcbiAgICBjb25zdCBjb2x1bW5Hcm91cCA9IGNvbHVtbnNHcm91cC5hcHBlbmQoXCJnXCIpXG4gICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBgdHJhbnNsYXRlKCR7eEJhbmRTY2FsZShiYW5kKX0sMClgKTtcblxuICAgIC8vIENvbHVtbiBoZWFkZXJcbiAgICBjb2x1bW5Hcm91cC5hcHBlbmQoXCJ0ZXh0XCIpXG4gICAgICAuYXR0cihcInhcIiwgeEJhbmRTY2FsZS5iYW5kd2lkdGgoKSAvIDIpXG4gICAgICAuYXR0cihcInlcIiwgLTEyKVxuICAgICAgLmF0dHIoXCJ0ZXh0LWFuY2hvclwiLCBcIm1pZGRsZVwiKVxuICAgICAgLmF0dHIoXCJmb250LXdlaWdodFwiLCA3MDApXG4gICAgICAuYXR0cihcImZvbnQtc2l6ZVwiLCAxNClcbiAgICAgIC5hdHRyKFwiZmlsbFwiLCBcIiMxYTFhMWFcIilcbiAgICAgIC50ZXh0KGJhbmQpO1xuXG4gICAgLy8gQ29tcHV0ZSBkZW5zaXRpZXMgZm9yIHRoaXMgdGVtcGVyYXR1cmUgYmFuZFxuICAgIGNvbnN0IGJhbmREYXRhID0gY2xlYW5EYXRhLmZpbHRlcihkID0+IGQudGVtcF9iYW5kID09PSBiYW5kKTtcbiAgICBjb25zdCBkZW5zaXRpZXMgPSBjb21wdXRlRGVuc2l0aWVzUGVyQWRhcHRhdGlvbihiYW5kRGF0YSk7XG5cbiAgICAvLyBEcmF3IHZpb2xpbnNcbiAgICBkZW5zaXRpZXMuZm9yRWFjaCgoeyBhZGFwdGF0aW9uLCBkZW5zaXR5LCByZWNvcmRzIH0pID0+IHtcbiAgICAgIGNvbnN0IGN4ID0geElubmVyU2NhbGUoYWRhcHRhdGlvbik7XG4gICAgICBpZiAoY3ggPT0gbnVsbCkgcmV0dXJuO1xuXG4gICAgICAvLyBDYWxjIGdyb3VwIHN0YXRzIGZvciB0aGUgdG9vbHRpcCBhbmQgbWVhbiBsaW5lc1xuICAgICAgY29uc3QgbWVhbllpZWxkID0gZDMubWVhbihyZWNvcmRzLCBkID0+IGQueWllbGRfaW1wYWN0X3BjdCk7XG4gICAgICBjb25zdCBzZFlpZWxkID0gZDMuZGV2aWF0aW9uKHJlY29yZHMsIGQgPT4gZC55aWVsZF9pbXBhY3RfcGN0KTtcbiAgICAgIGNvbnN0IG1pbllpZWxkID0gZDMubWluKHJlY29yZHMsIGQgPT4gZC55aWVsZF9pbXBhY3RfcGN0KTtcbiAgICAgIGNvbnN0IG1heFlpZWxkID0gZDMubWF4KHJlY29yZHMsIGQgPT4gZC55aWVsZF9pbXBhY3RfcGN0KTtcbiAgICAgIGNvbnN0IG5fb2JzID0gcmVjb3Jkcy5sZW5ndGhcblxuXG4gICAgICBjb25zdCB2aW9saW5Hcm91cCA9IGNvbHVtbkdyb3VwLmFwcGVuZChcImdcIilcbiAgICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgYHRyYW5zbGF0ZSgke2N4fSwwKWApO1xuXG4gICAgICB2aW9saW5Hcm91cC5hcHBlbmQoXCJwYXRoXCIpXG4gICAgICAgIC5hdHRyKFwiZFwiLCBhcmVhR2VuZXJhdG9yKGRlbnNpdHkpKVxuICAgICAgICAuYXR0cihcImZpbGxcIiwgY29sb3JTY2FsZShhZGFwdGF0aW9uKSlcbiAgICAgICAgLmF0dHIoXCJmaWxsLW9wYWNpdHlcIiwgMC4yKVxuICAgICAgICAuYXR0cihcInN0cm9rZVwiLCBjb2xvclNjYWxlKGFkYXB0YXRpb24pKVxuICAgICAgICAuYXR0cihcInN0cm9rZS13aWR0aFwiLCAxLjUpXG4gICAgICAgIC5zdHlsZShcImZpbHRlclwiLCBcImRyb3Atc2hhZG93KDAgMXB4IDJweCByZ2JhKDAsMCwwLDAuMDUpKVwiKTtcblxuICAgICAgdmlvbGluR3JvdXBcbiAgICAgICAgLm9uKFwibW91c2Vtb3ZlXCIsIChldmVudCwgZCkgPT4ge1xuICAgICAgICAgIHRvb2x0aXBcbiAgICAgICAgICAgIC5zdHlsZShcInRvcFwiLCBldmVudC5wYWdlWSAtIDEwICsgXCJweFwiKVxuICAgICAgICAgICAgLnN0eWxlKFwibGVmdFwiLCBldmVudC5wYWdlWCArIDEwICsgXCJweFwiKVxuICAgICAgICAgICAgLnN0eWxlKFwib3BhY2l0eVwiLCAxKVxuICAgICAgICAgICAgLnN0eWxlKFwiZGlzcGxheVwiLCBcImJsb2NrXCIpXG4gICAgICAgICAgICAuaHRtbCh2aW9saW5fdHRfaHRtbChiYW5kLCBhZGFwdGF0aW9uLCBtZWFuWWllbGQsIG1pbllpZWxkLCBtYXhZaWVsZCwgc2RZaWVsZCwgbl9vYnMpKTtcbiAgICAgICAgfSlcbiAgICAgICAgICAub24oXCJtb3VzZW91dFwiLCBmdW5jdGlvbiAoZXZlbnQsIGQpIHtcbiAgICAgICAgICAgIGQzLnNlbGVjdChgIyR7aWR9LXRvb2x0aXBgKS5zdHlsZShcImRpc3BsYXlcIiwgXCJub25lXCIpO1xuICAgICAgICB9KTtcbiAgICAgIFxuICAgICAgLy8gTWVhbiBsaW5lXG4gICAgICBjb25zdCBtZWFuWSA9IHlTY2FsZShtZWFuWWllbGQpO1xuICAgICAgdmlvbGluR3JvdXAuYXBwZW5kKFwibGluZVwiKVxuICAgICAgICAuYXR0cihcIngxXCIsIC1tYXhWaW9saW5IYWxmV2lkdGggKiAwLjQpXG4gICAgICAgIC5hdHRyKFwieDJcIiwgbWF4VmlvbGluSGFsZldpZHRoICogMC40KVxuICAgICAgICAuYXR0cihcInkxXCIsIG1lYW5ZKVxuICAgICAgICAuYXR0cihcInkyXCIsIG1lYW5ZKVxuICAgICAgICAuYXR0cihcInN0cm9rZVwiLCBjb2xvclNjYWxlKGFkYXB0YXRpb24pKVxuICAgICAgICAuYXR0cihcInN0cm9rZS13aWR0aFwiLCAyLjUpXG4gICAgICAgIC5hdHRyKFwic3Ryb2tlLW9wYWNpdHlcIiwgMC45KTtcbiAgICB9KTtcblxuXG4gICAgLy8gRHJhdyBkYXRhIHBvaW50c1xuICAgIGNvbHVtbkdyb3VwLmFwcGVuZChcImdcIilcbiAgICAgIC5zZWxlY3RBbGwoXCJjaXJjbGVcIilcbiAgICAgIC5kYXRhKGJhbmREYXRhKVxuICAgICAgLmpvaW4oXCJjaXJjbGVcIilcbiAgICAgICAgLmF0dHIoXCJjeFwiLCBkID0+IHhJbm5lclNjYWxlKGQuQWRhcHRhdGlvbikgKyBqaXR0ZXJHZW5lcmF0b3IoKSlcbiAgICAgICAgLmF0dHIoXCJjeVwiLCBkID0+IHlTY2FsZShkLnlpZWxkX2ltcGFjdF9wY3QpKVxuICAgICAgICAuYXR0cihcInJcIiwgMi41KVxuICAgICAgICAuYXR0cihcImZpbGxcIiwgZCA9PiBjb2xvclNjYWxlKGQuQWRhcHRhdGlvbikpXG4gICAgICAgIC5hdHRyKFwiZmlsbC1vcGFjaXR5XCIsIDAuMSlcbiAgICAgICAgLmF0dHIoXCJzdHJva2VcIiwgZCA9PiBjb2xvclNjYWxlKGQuQWRhcHRhdGlvbikpXG4gICAgICAgIC5hdHRyKFwic3Ryb2tlLXdpZHRoXCIsIDAuMTUpXG4gICAgICAgIC5zdHlsZShcImN1cnNvclwiLCBcInBvaW50ZXJcIilcbiAgICAgIC5hcHBlbmQoXCJ0aXRsZVwiKVxuICAgICAgICAudGV4dChkID0+IGAke2QuQ3JvcH0g4oCiICR7ZC5Db3VudHJ5fVxuVGVtcGVyYXR1cmU6ICR7ZC5wcmVpbmR1c3RyaWFsX3RlbXBfZGVsdGF9wrBDXG5ZaWVsZCBJbXBhY3Q6ICR7ZC55aWVsZF9pbXBhY3RfcGN0LnRvRml4ZWQoMil9JVxuQWRhcHRhdGlvbjogJHtkLkFkYXB0YXRpb259XG5SZWZlcmVuY2U6ICR7ZC5SZWZlcmVuY2V9YCk7XG4gIH0pO1xuXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgLy8gQVhFUyBBTkQgR1JJRExJTkVTXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgXG4gIC8vIFktYXhpc1xuICBjb25zdCB5QXhpcyA9IGNoYXJ0QXJlYS5hcHBlbmQoXCJnXCIpXG4gICAgLmF0dHIoXCJjbGFzc1wiLCBcInktYXhpc1wiKVxuICAgIC5jYWxsKGQzLmF4aXNMZWZ0KHlTY2FsZSkudGlja3MoOCkudGlja1NpemUoLWlubmVyVykpXG4gICAgLmNhbGwoZyA9PiBnLnNlbGVjdChcIi5kb21haW5cIikucmVtb3ZlKCkpXG4gICAgLmNhbGwoZyA9PiBnLnNlbGVjdEFsbChcIi50aWNrIGxpbmVcIilcbiAgICAgIC5hdHRyKFwic3Ryb2tlXCIsIFwiI2UwZTBlMFwiKVxuICAgICAgLmF0dHIoXCJzdHJva2UtZGFzaGFycmF5XCIsIFwiMiwyXCIpKVxuICAgIC5jYWxsKGcgPT4gZy5zZWxlY3RBbGwoXCIudGljayB0ZXh0XCIpXG4gICAgICAuYXR0cihcImZpbGxcIiwgXCIjNjY2XCIpXG4gICAgICAuYXR0cihcImZvbnQtc2l6ZVwiLCAxMSkpO1xuXG4gIC8vIFplcm8gcmVmZXJlbmNlIGxpbmVcbiAgY2hhcnRBcmVhLmFwcGVuZChcImxpbmVcIilcbiAgICAuYXR0cihcIngxXCIsIDApXG4gICAgLmF0dHIoXCJ4MlwiLCBpbm5lclcpXG4gICAgLmF0dHIoXCJ5MVwiLCB5U2NhbGUoMCkpXG4gICAgLmF0dHIoXCJ5MlwiLCB5U2NhbGUoMCkpXG4gICAgLmF0dHIoXCJzdHJva2VcIiwgXCIjMzMzXCIpXG4gICAgLmF0dHIoXCJzdHJva2Utd2lkdGhcIiwgMS41KVxuICAgIC5hdHRyKFwic3Ryb2tlLWRhc2hhcnJheVwiLCBcIjQsNFwiKTtcblxuICAvLyBBZGFwdGF0aW9uIGNhdGVnb3J5IHRpY2tzICh3aXRoaW4gZWFjaCBjb2x1bW4pXG4gIC8vIGNvbnN0IGlubmVyQXhpc0dlbmVyYXRvciA9IGQzLmF4aXNCb3R0b20oeElubmVyU2NhbGUpLnRpY2tTaXplKDApO1xuICAvLyB0ZW1wQmFuZHMuZm9yRWFjaChiYW5kID0+IHtcbiAgLy8gICBjaGFydEFyZWEuYXBwZW5kKFwiZ1wiKVxuICAvLyAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgYHRyYW5zbGF0ZSgke3hCYW5kU2NhbGUoYmFuZCl9LCR7aW5uZXJIfSlgKVxuICAvLyAgICAgLmNhbGwoaW5uZXJBeGlzR2VuZXJhdG9yKVxuICAvLyAgICAgLmNhbGwoZyA9PiBnLnNlbGVjdChcIi5kb21haW5cIikucmVtb3ZlKCkpXG4gIC8vICAgICAuY2FsbChnID0+IGcuc2VsZWN0QWxsKFwidGV4dFwiKVxuICAvLyAgICAgICAuYXR0cihcImR5XCIsIFwiMWVtXCIpXG4gIC8vICAgICAgIC5hdHRyKFwiZm9udC1zaXplXCIsIDEwKVxuICAvLyAgICAgICAuYXR0cihcImZpbGxcIiwgXCIjNjY2XCIpXG4gIC8vICAgICAgIC50ZXh0KGQgPT4gX2xhbmcobmJUZXh0LnJlZ2lvbmFsUGljdHVyZS5iZWVzd2FybS5sZWdlbmRbZF0pKSk7XG4gIC8vIH0pO1xuXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgLy8gTEFCRUxTXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgXG4gIC8vIFktYXhpcyBsYWJlbFxuICBzdmcuYXBwZW5kKFwidGV4dFwiKVxuICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIGB0cmFuc2xhdGUoMjAsJHtoZWlnaHQvMn0pIHJvdGF0ZSgtOTApYClcbiAgICAuYXR0cihcInRleHQtYW5jaG9yXCIsIFwibWlkZGxlXCIpXG4gICAgLmF0dHIoXCJmb250LXdlaWdodFwiLCA2MDApXG4gICAgLmF0dHIoXCJmb250LXNpemVcIiwgMTMpXG4gICAgLmF0dHIoXCJmaWxsXCIsIFwiIzMzM1wiKVxuICAgIC50ZXh0KFwiWWllbGQgSW1wYWN0ICglKVwiKTtcblxuICAvLyBYLWF4aXMgbGFiZWxcbiAgc3ZnLmFwcGVuZChcInRleHRcIilcbiAgICAuYXR0cihcInhcIiwgd2lkdGggLyAyKVxuICAgIC5hdHRyKFwieVwiLCAxMClcbiAgICAuYXR0cihcInRleHQtYW5jaG9yXCIsIFwibWlkZGxlXCIpXG4gICAgLmF0dHIoXCJmb250LXdlaWdodFwiLCA2MDApXG4gICAgLmF0dHIoXCJmb250LXNpemVcIiwgMTMpXG4gICAgLmF0dHIoXCJmaWxsXCIsIFwiIzMzM1wiKVxuICAgIC50ZXh0KFwiVGVtcGVyYXR1cmUgSW5jcmVhc2UgZnJvbSBQcmUtSW5kdXN0cmlhbCBMZXZlbHNcIik7XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAvLyBMZWdlbmRcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIGNvbnN0IGxlZ2VuZEl0ZW1zID0gYWRhcHRhdGlvblR5cGVzLm1hcChhID0+ICh7XG4gICAga2V5OiBhLFxuICAgIC8vIHVzZSB5b3VyIGxvY2FsaXplZCBsYWJlbCBpZiBhdmFpbGFibGU7IGVsc2UgZmFsbCBiYWNrIHRvIHRoZSByYXcga2V5XG4gICAgbGFiZWw6IChfbGFuZz8uKG5iVGV4dD8ucmVnaW9uYWxQaWN0dXJlPy5iZWVzd2FybT8ubGVnZW5kPy5bYV0pKSA/PyBhLFxuICAgIGNvbG9yOiBjb2xvclNjYWxlKGEpXG4gIH0pKTtcblxuICBjb25zdCBzdyA9IDEyOyAgICAgICAgICAgIC8vIHN3YXRjaCBzaXplXG4gIGNvbnN0IHJvd0ggPSAyMDsgICAgICAgICAgLy8gcm93IGhlaWdodFxuICBjb25zdCBnYXAgPSA4OyAgICAgICAgICAgIC8vIGdhcCBiZXR3ZWVuIHN3YXRjaCBhbmQgdGV4dFxuICBjb25zdCBjb2xXaWR0aCA9IDE3MDsgICAgIC8vIHdpZHRoIHBlciBsZWdlbmQgY29sdW1uXG4gIGNvbnN0IGNvbHMgPSBsZWdlbmRJdGVtcy5sZW5ndGggPiA2ID8gMiA6IDE7XG5cbiAgLy8gcG9zaXRpb24gdG9wLXJpZ2h0IGluc2lkZSB0aGUgY2hhcnQgYXJlYVxuICBjb25zdCBsZWdlbmRYID0gbWFyZ2luLmxlZnQgKyA1O1xuICBjb25zdCBsZWdlbmRZID0gbWFyZ2luLnRvcCArIDg7XG5cbiAgY29uc3QgbGVnZW5kID0gc3ZnLmFwcGVuZChcImdcIilcbiAgICAuYXR0cihcImNsYXNzXCIsIFwibGVnZW5kXCIpXG4gICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgYHRyYW5zbGF0ZSgke2xlZ2VuZFh9LCAke2xlZ2VuZFl9KWApXG4gICAgLmF0dHIoXCJhcmlhLWxhYmVsXCIsIFwiTGVnZW5kXCIpO1xuXG4gIGNvbnN0IGl0ZW1zID0gbGVnZW5kLmFwcGVuZChcImdcIik7XG5cbiAgaXRlbXMuc2VsZWN0QWxsKFwiZy5pdGVtXCIpXG4gICAgLmRhdGEobGVnZW5kSXRlbXMpXG4gICAgLmpvaW4oXCJnXCIpXG4gICAgICAuYXR0cihcImNsYXNzXCIsIFwiaXRlbVwiKVxuICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgKGQsIGkpID0+IHtcbiAgICAgICAgY29uc3QgY29sID0gTWF0aC5mbG9vcihpIC8gTWF0aC5jZWlsKGxlZ2VuZEl0ZW1zLmxlbmd0aCAvIGNvbHMpKTtcbiAgICAgICAgY29uc3Qgcm93ID0gaSAlIE1hdGguY2VpbChsZWdlbmRJdGVtcy5sZW5ndGggLyBjb2xzKTtcbiAgICAgICAgcmV0dXJuIGB0cmFuc2xhdGUoJHtjb2wgKiBjb2xXaWR0aH0sICR7cm93ICogcm93SH0pYDtcbiAgICAgIH0pXG4gICAgLmVhY2goZnVuY3Rpb24oZCkge1xuICAgICAgY29uc3QgZyA9IGQzLnNlbGVjdCh0aGlzKTtcbiAgICAgICAgZy5hcHBlbmQoXCJyZWN0XCIpXG4gICAgICAgICAgLmF0dHIoXCJ3aWR0aFwiLCBzdylcbiAgICAgICAgICAuYXR0cihcImhlaWdodFwiLCBzdylcbiAgICAgICAgICAuYXR0cihcInJ4XCIsIDIpXG4gICAgICAgICAgLmF0dHIoXCJyeVwiLCAyKVxuICAgICAgICAgIC5hdHRyKFwieVwiLCAwKVxuICAgICAgICAgIC5hdHRyKFwiZmlsbFwiLCBkLmNvbG9yKVxuICAgICAgICAgIC5hdHRyKFwiZmlsbC1vcGFjaXR5XCIsIDAuMilcbiAgICAgICAgICAuYXR0cihcInN0cm9rZVwiLCBkLmNvbG9yKVxuICAgICAgICAgIC5hdHRyKFwic3Ryb2tlLXdpZHRoXCIsIDEuNSk7XG4gICAgICAgIFxuICAgICAgICBnLmFwcGVuZChcInRleHRcIilcbiAgICAgICAgICAuYXR0cihcInhcIiwgc3cgKyBnYXApXG4gICAgICAgICAgLmF0dHIoXCJ5XCIsIHN3LzIpXG4gICAgICAgICAgLmF0dHIoXCJkb21pbmFudC1iYXNlbGluZVwiLCBcIm1pZGRsZVwiKVxuICAgICAgICAgIC5hdHRyKFwiZm9udC1zaXplXCIsIDExKVxuICAgICAgICAgIC5hdHRyKFwiZmlsbFwiLCBcIiMzMzNcIilcbiAgICAgICAgICAudGV4dChkLmxhYmVsKTtcbiAgICB9KTtcblxuICByZXR1cm4gc3ZnLm5vZGUoKTtcbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtOCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImJlZXN3YXJtX2luc2lnaHRfdGl0bGUgPSB7XG4gIGxldCB0ZW1wbGF0ZSA9IF9sYW5nKG5iVGV4dC5yZWdpb25hbFBpY3R1cmUuYmVlc3dhcm1JbnNpZ2h0LnRpdGxlKVxuICBsZXQgaXRlbXMgPSBbXG4gICAge25hbWU6IFwiU2VsZWN0ZWRDcm9wXCIsIHZhbHVlOiBzZWxlY3RlZF9jcm9wX2dsb2JhbC5tYXAoKGMpID0+IF9sYW5nKG5iVGV4dC5nZW5lcmFsLmNyb3BzW2NdKSl9LFxuICAgIHtuYW1lOiBcIndhcm1pbmdMZXZlbFwiLCB2YWx1ZTogd2FybWluZ19sZXZlbH0sXG4gIF1cbnJldHVybiBtZGAjIyMgJHtMYW5nLnJlZHVjZVJlcGxhY2VUZW1wbGF0ZUl0ZW1zKHRlbXBsYXRlLCBpdGVtcyl9YFxufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC05IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoidmlld29mIHdhcm1pbmdfbGV2ZWwgPSB7XG4gIHJldHVybiBJbnB1dHMuc2VsZWN0KFxuICAgICAgdGVtcF9vcHRzLFxuICAgICAge2xhYmVsOiBfbGFuZyhuYlRleHQucmVnaW9uYWxQaWN0dXJlLnNlbGVjdG9ycy53YXJtaW5nTGV2ZWwudGl0bGUpIH1cbiAgKSAgXG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTEwIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoidmlvbGluX2luc2lnaHQgPSB7XG5cbiAgbGV0IGJhbmRfc2VsID0gd2FybWluZ19sZXZlbFxuICBjb25zdCB0ZW1wQmFuZF9kYXRhID0ge1xuICAgIHRlbXBfYmFuZDogYmFuZF9zZWwsXG4gICAgLi4udmlvbGluX2luc2lnaHRfZGF0YS5tZWRpYW5feWllbGRzW2JhbmRfc2VsXSxcbiAgICAuLi52aW9saW5faW5zaWdodF9kYXRhLndvcnN0X3JlZ2lvbltiYW5kX3NlbF1cbiAgfTtcbi8vIHJldHVybiB0ZW1wQmFuZF9kYXRhXG4gIC8vUG9pbnQgMVxuICBjb25zdCB0ZW1wbGF0ZV9pbnNpZ2h0MSA9IF9sYW5nKG5iVGV4dC5yZWdpb25hbFBpY3R1cmUuYmVlc3dhcm1JbnNpZ2h0LnRleHQuaW5zaWdodDEpXG4gIGNvbnN0IHZhbHVlc19pbnNpZ2h0MSA9IFtcbiAgICAgICAge25hbWU6IFwid2FybWluZ0xldmVsXCIsIHZhbHVlOiBiYW5kX3NlbH0sXG4gICAgICAgIHtuYW1lOiBcImNyb3BzXCIsIHZhbHVlOiBzZWxlY3RlZF9jcm9wX2dsb2JhbC5tYXAoKGMpID0+IF9sYW5nKG5iVGV4dC5nZW5lcmFsLmNyb3BzW2NdKSl9LFxuICAgICAgICB7bmFtZTogXCJ5aWVsZFJlZHVjdGlvblwiLCB2YWx1ZTogdGVtcEJhbmRfZGF0YS5tZWRpYW5fd2l0aG91dF9hZGFwdGF0aW9uLnRvRml4ZWQoMil9XG4gICAgXVxuICBjb25zdCBpbnNpZ2h0MSA9IExhbmcucmVkdWNlUmVwbGFjZVRlbXBsYXRlSXRlbXModGVtcGxhdGVfaW5zaWdodDEsIHZhbHVlc19pbnNpZ2h0MSlcblxuICAvL1BvaW50IDJcbiAgbGV0IHRlbXBsYXRlX2luc2lnaHQyID0gX2xhbmcobmJUZXh0LnJlZ2lvbmFsUGljdHVyZS5iZWVzd2FybUluc2lnaHQudGV4dC5pbnNpZ2h0Mi5tb3N0QWZmZWN0ZWQpXG4gIGxldCB2YWx1ZXNfaW5zaWdodDIgPSBbXG4gICAgICB7bmFtZTogXCJtb3N0QWZmZWN0ZWRfYWRhcHRhdGlvblwiLCB2YWx1ZTogdGVtcEJhbmRfZGF0YS53b3JzdF9yZWdpb25fd2l0aF9hZGFwdGF0aW9uLnJlZ2lvbn0sXG4gICAgICB7bmFtZTogXCJtb3N0QWZmZWN0ZWRfbm9hZGFwdGF0aW9uXCIsIHZhbHVlOiB0ZW1wQmFuZF9kYXRhLndvcnN0X3JlZ2lvbl93aXRob3V0X2FkYXB0YXRpb24ucmVnaW9ufSxcbiAgICBdXG4gIGNvbnN0IGluc2lnaHQyID0gTGFuZy5yZWR1Y2VSZXBsYWNlVGVtcGxhdGVJdGVtcyh0ZW1wbGF0ZV9pbnNpZ2h0MiwgdmFsdWVzX2luc2lnaHQyKVxuXG4gIC8vUG9pbnQgM1xuICBsZXQgaW5zaWdodDM7XG4gIGlmICghIXRlbXBCYW5kX2RhdGEubWVkaWFuX3dpdGhfYWRhcHRhdGlvbikge1xuICAgIGxldCB0ZW1wbGF0ZV9pbnNpZ2h0MyA9IF9sYW5nKG5iVGV4dC5yZWdpb25hbFBpY3R1cmUuYmVlc3dhcm1JbnNpZ2h0LnRleHQuaW5zaWdodDMuY29tcGVsbGluZyk7XG4gICAgY29uc3QgdmFsdWVzX2luc2lnaHQzID0gW1xuICAgICAge25hbWU6IFwibG9zc19nYWluXCIsIHZhbHVlOiBcImxvc3Nlc1wifSwgLy8gSGFyZCBjb2RlZCBmb3Igbm93IGFzIGFsbCBkYXRhIGlzIGJldHRlciB3aXRoIGFkYXB0YXRpb25cbiAgICAgIHtuYW1lOiBcIndpdGhBZGFwdGF0aW9uXCIsIHZhbHVlOiB0ZW1wQmFuZF9kYXRhLm1lZGlhbl93aXRoX2FkYXB0YXRpb24udG9GaXhlZCgyKX0sXG4gICAgXVxuICAgIGluc2lnaHQzID0gTGFuZy5yZWR1Y2VSZXBsYWNlVGVtcGxhdGVJdGVtcyh0ZW1wbGF0ZV9pbnNpZ2h0MywgdmFsdWVzX2luc2lnaHQzKVxuICB9IGVsc2Uge1xuICAgIGluc2lnaHQzID0gX2xhbmcobmJUZXh0LnJlZ2lvbmFsUGljdHVyZS5iZWVzd2FybUluc2lnaHQudGV4dC5pbnNpZ2h0My5ub3RDb21wZWxsaW5nKTtcbiAgfVxuICBcbnJldHVybiBtZGBcbiogJHtpbnNpZ2h0Mn1cbiogJHtpbnNpZ2h0MX1cbiogJHtpbnNpZ2h0M31gXG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTExIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoibWRgIyAke19sYW5nKG5iVGV4dC56b29tVG9TdGFibGUudGl0bGUpfVxuXG4ke19sYW5nKG5iVGV4dC56b29tVG9TdGFibGUudGV4dCl9YDtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTIiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ6b29tX2luX3NlbGVjdG9ycyA9IHtcbiAgY29uc3QgZm9ybSA9IElucHV0cy5mb3JtKHpvb21faW5fZWxlbWVudHMsIHt0ZW1wbGF0ZTogZm9ybVRlbXBsYXRlKCl9KVxuICByZXR1cm4gZm9ybVxufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xMyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Ii8vIGZvcm1hdCBhZG1pbiBzZWxlY3Rpb25zXG4vLyBiaW5kIHRvIGFwcGVuZGl4IGlucHV0cywgYWRkIHRlbXBsYXRlIHRvIGZvcm1hdFxuZ2VvSW1wYWN0QWRtaW5TZWxlY3RvcnMgPSBJbnB1dHMuZm9ybShcbiAgW1xuICAgIElucHV0cy5iaW5kKFxuICAgICAgSW5wdXRzLnNlbGVjdChkYXRhQWRtaW4wLCB7IGxhYmVsOiBfbGFuZyhuYlRleHQuZ2VuZXJhbC5jb3VudHJ5KSwgZm9ybWF0OiB4ID0+IHggPT0gbnVsbCA/IF9sYW5nKG5iVGV4dC5nZW5lcmFsLmFkbWluTmFtZXNbJ1NTQSddKTogX2xhbmcobmJUZXh0LmdlbmVyYWwuYWRtaW5OYW1lc1t4XSl9KSxcbiAgICAgIHZpZXdvZiBzZWxlY3RBZG1pbjBcbiAgICApLFxuICAgIElucHV0cy5iaW5kKFxuICAgICAgSW5wdXRzLnNlbGVjdChkYXRhQWRtaW4xLCB7IGxhYmVsOiBfbGFuZyhuYlRleHQuZ2VuZXJhbC5yZWdpb24pIH0pLFxuICAgICAgdmlld29mIHNlbGVjdEFkbWluMVxuICAgICksXG4gICAgSW5wdXRzLmJpbmQoXG4gICAgICBJbnB1dHMuc2VsZWN0KGRhdGFBZG1pbjIsIHsgbGFiZWw6IF9sYW5nKG5iVGV4dC5nZW5lcmFsLnN1YlJlZ2lvbikgfSksXG4gICAgICB2aWV3b2Ygc2VsZWN0QWRtaW4yXG4gICAgKVxuICBdLFxuICB7XG4gICAgdGVtcGxhdGU6IGZvcm1UZW1wbGF0ZSgpXG4gIH1cbilcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTQiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiIvLyBkZWZpbmUgY2hvaWNlcyBmb3IgdGhlIGRhdGEgdmFsdWVcbnZpZXdvZiBzZWxlY3RHZW9EYXRhVHlwZSA9IHtcbiAgY29uc3Qgb3B0aW9ucyA9IFtcbi8qICAgIFxuICAgIHtcbiAgICAgIGtleTogXCJwb3B1bGF0aW9uXCIsIC8vIGxvb2t1cCBpZCBmb3IgZGF0YSBvcHRpb25cbiAgICAgIGRhdGFDb2x1bW46IFwicnVyYWxfcG9wXCIsIC8vIGRhdGEgY29sdW1uXG4gICAgICBsYWJlbDogXCJSdXJhbCBwb3B1bGF0aW9uXCIsIC8vIGxhYmVsXG4gICAgICBsYWJlbFRpcDogXCJSdXJhbCBwb3B1bGF0aW9uXCIsIC8vIGxhYmVsIGZvciB0b29sdGlwXG4gICAgICBsYWJlbExlZ2VuZDogXCJSdXJhbCBwb3B1bGF0aW9uXCIsIC8vIGxhYmVsIGZvciBsZWdlbmRcbiAgICAgIGZvcm1hdEZ1bmM6IGZvcm1hdE51bUNvbXBhY3RTaG9ydCwgLy8gZm9ybWF0dGluZyBmdW5jdGlvbiBmb3IgcmF3IGRhdGEgdmFsdWVcbiAgICAgIGNvbG9yUmFuZ2U6IGNvbG9yU2NhbGVzLnJhbmdlLnllbGxvd0dyZWVuLCAvLyBjb2xvciByYW5nZVxuICAgICAgY29sb3JVbmtub3duOiBjb2xvclNjYWxlcy51bmtub3duLCAvLyB1bmtub3duIGZpbGwgY29sb3IgXG4gICAgfSxcbiAgICB7XG4gICAgICBrZXk6IFwidm9wXCIsXG4gICAgICBkYXRhQ29sdW1uOiBcInZvcF90b3RhbFwiLFxuICAgICAgbGFiZWw6IFwiVG90YWwgVmFsdWUgb2YgUHJvZHVjdGlvbiAoVm9QKVwiLFxuICAgICAgbGFiZWxUaXA6IFwiVm9QXCIsXG4gICAgICBsYWJlbExlZ2VuZDogXCJWYWx1ZSBvZiBQcm9kdWN0aW9uICgkKVwiLFxuICAgICAgZm9ybWF0RnVuYzogZm9ybWF0VVNELFxuICAgICAgY29sb3JSYW5nZTogY29sb3JTY2FsZXMucmFuZ2UueWVsbG93R3JlZW4sXG4gICAgICBjb2xvclVua25vd246IGNvbG9yU2NhbGVzLnVua25vd24sXG4gICAgfSxcbiovXG4gICAge1xuICAgICAga2V5OiBcIndtZWFuX3lpZWxkX3JmZFwiLFxuICAgICAgZGF0YUNvbHVtbjogXCJ3bWVhbl95aWVsZF9yZmRcIixcbiAgICAgIGxhYmVsOiBfbGFuZyhuYlRleHQuem9vbVRvU3RhYmxlLnNlbGVjdG9ycy5sYXllci52YWx1ZXMucmFpbmZlZCksLy9cIk1lYW4gcmFpbmZlZCBwb3RlbnRpYWwgeWllbGRcIiwgXG4gICAgICBsYWJlbFRpcDogXCJyZmRcIixcbiAgICAgIGxhYmVsTGVnZW5kOiBfbGFuZyhuYlRleHQuem9vbVRvU3RhYmxlLnNlbGVjdG9ycy5sYXllci52YWx1ZXMucmFpbmZlZCksXG4gICAgICBmb3JtYXRGdW5jOiBmb3JtYXROdW1Db21wYWN0U2hvcnQsXG4gICAgICBjb2xvclJhbmdlOiBjb2xvclNjYWxlcy5yYW5nZS55ZWxsb3dHcmVlbixcbiAgICAgIGNvbG9yVW5rbm93bjogY29sb3JTY2FsZXMudW5rbm93bixcbiAgICB9LFxuICAgIHtcbiAgICAgIGtleTogXCJ3bWVhbl95aWVsZF9pcnJcIixcbiAgICAgIGRhdGFDb2x1bW46IFwid21lYW5feWllbGRfaXJyXCIsXG4gICAgICBsYWJlbDogIF9sYW5nKG5iVGV4dC56b29tVG9TdGFibGUuc2VsZWN0b3JzLmxheWVyLnZhbHVlcy5pcnJpZ2F0ZWQpLFxuICAgICAgbGFiZWxUaXA6IFwiaXJyXCIsXG4gICAgICBsYWJlbExlZ2VuZDogX2xhbmcobmJUZXh0Lnpvb21Ub1N0YWJsZS5zZWxlY3RvcnMubGF5ZXIudmFsdWVzLmlycmlnYXRlZCksXG4gICAgICBmb3JtYXRGdW5jOiBmb3JtYXROdW1Db21wYWN0U2hvcnQsXG4gICAgICBjb2xvclJhbmdlOiBjb2xvclNjYWxlcy5yYW5nZS55ZWxsb3dHcmVlbixcbiAgICAgIGNvbG9yVW5rbm93bjogY29sb3JTY2FsZXMudW5rbm93bixcbiAgICB9LFxuICBdO1xuICByZXR1cm4gSW5wdXRzLnJhZGlvKG9wdGlvbnMuc29ydCgoYSxiKSA9PiBiLmtleS5sb2NhbGVDb21wYXJlKGEua2V5KSksIHtcbiAgICB3aWR0aDogMzAwLFxuICAgIGxhYmVsOiAgX2xhbmcobmJUZXh0Lnpvb21Ub1N0YWJsZS5zZWxlY3RvcnMubGF5ZXIudGl0bGUpLFxuICAgIGZvcm1hdDogKHgpID0+IHgubGFiZWwsXG4gICAgdmFsdWU6IG9wdGlvbnMuZmluZCgodCkgPT4gdC5rZXkgPT09IFwid21lYW5feWllbGRfcmZkXCIpXG4gIH0pO1xufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xNSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InBsb3RDaG9yb3BsZXRoR2VvSW1wYWN0ID0ge1xuICBjb25zdCBkYXRhID0gbWFwRGF0YUdlb0ltcGFjdFxuICBjb25zdCBzZWxlY3RvciA9IHNlbGVjdEdlb0RhdGFUeXBlXG4gIGNvbnN0IGRhdGFDb2x1bW4gPSBtYXBEYXRhQ29sdW1uO1xuICBcbiAgLy8gcmV0dXJuIHBsb3RcbiAgcmV0dXJuIFBsb3QucGxvdCh7XG4gICAgd2lkdGg6IG1hcFdpZHRoLFxuICAgIGhlaWdodDogNTUwLFxuICAgIGNhcHRpb246IF9sYW5nKG5iVGV4dC5nZW5lcmFsLmdyZXlOb0RhdGEpLFxuICAgIHByb2plY3Rpb246IHtcbiAgICAgIHR5cGU6IFwiYXppbXV0aGFsLWVxdWFsLWFyZWFcIixcbiAgICAgIGRvbWFpbjogZGF0YVxuICAgIH0sXG4gICAgY29sb3I6IHtcbiAgICAgIGxlZ2VuZDogdHJ1ZSxcbiAgICAgIGxhYmVsOiBzZWxlY3Rvci5sYWJlbExlZ2VuZCxcbiAgICAgIHJhbmdlOiBzZWxlY3Rvci5jb2xvclJhbmdlLFxuICAgICAgdW5rbm93bjogc2VsZWN0b3IuY29sb3JVbmtub3duLFxuICAgICAgdGlja0Zvcm1hdDogc2VsZWN0b3IuZm9ybWF0RnVuYyxcbiAgICB9LFxuICAgIG1hcmtzOiBbXG4gICAgICAvLyBnZW8gZGF0YVxuICAgICAgUGxvdC5nZW8oZGF0YS5mZWF0dXJlcywge1xuICAgICAgICBmaWxsOiAoZCkgPT4ge1xuICAgICAgICAgIGNvbnN0IGZpbGxWYWx1ZSA9IGQucHJvcGVydGllcy5kYXRhID8gZC5wcm9wZXJ0aWVzLmRhdGFbZGF0YUNvbHVtbl0gOiBudWxsOyAvLyBoYW5kbGUgbWlzc2luZyBkYXRhXG4gICAgICAgICAgcmV0dXJuIGZpbGxWYWx1ZVxuICAgICAgICB9LFxuICAgICAgICBzdHJva2U6IFwiI2ZmZlwiLFxuICAgICAgICBzdHJva2VXaWR0aDogMC41XG4gICAgICB9KSxcbiAgICAgIC8vIGFkbWluMiBoaWdobGlnaHQgXG4gICAgICAvLyBpZiBBZG1pbiBzZWxlY3Rpb24gaW5jbHVkZXMgYWRtaW4yLCBoaWdobGlnaHQgc2VjdGlvblxuICAgICAgUGxvdC5nZW8oYWRtaW5TZWxlY3Rpb25zLnNlbGVjdEFkbWluMiBcbiAgICAgICAgICAgICAgID8gZGF0YS5mZWF0dXJlcy5maWx0ZXIoZCA9PiBkLnByb3BlcnRpZXMuYWRtaW4yX25hbWUgPT0gYWRtaW5TZWxlY3Rpb25zLnNlbGVjdEFkbWluMilcbiAgICAgICAgICAgICAgIDogW10sIHtcbiAgICAgICAgZmlsbDogbnVsbCxcbiAgICAgICAgc3Ryb2tlOiBcIiMzMzNcIixcbiAgICAgICAgc3Ryb2tlV2lkdGg6IDEuNVxuICAgICAgfSksXG4gICAgICAvLyBnZW8gcG9pbnRlclxuICAgICAgUGxvdC5nZW8oZGF0YSwgUGxvdC5wb2ludGVyKFxuICAgICAgICBQbG90LmNlbnRyb2lkKHtcbiAgICAgICAgc3Ryb2tlOiBcIiMzMzNcIixcbiAgICAgICAgc3Ryb2tlV2lkdGg6IDEuNSxcbiAgICAgIH0pKSksXG4gICAgICAvLyB0b29sdGlwXG4gICAgICBQbG90LnRpcChcbiAgICAgICAgZGF0YS5mZWF0dXJlcyxcbiAgICAgICAgUGxvdC5wb2ludGVyKFxuICAgICAgICAgIFBsb3QuY2VudHJvaWQoe1xuICAgICAgICAgICAgY2hhbm5lbHM6IHtcbiAgICAgICAgICAgICAgbmFtZToge1xuICAgICAgICAgICAgICAgIC8vIHJlZ2lvbiBsYWJlbCwgYmFzZWQgb24gc2VsZWN0aW9uXG4gICAgICAgICAgICAgICAgbGFiZWw6IGdldExvd2VyTGV2ZWxBZG1pbkxhYmVsKCksIC8vIHBsb3QtbGV2ZWwgc28gaW5wdXRzIGRvbid0IHJlbG9hZFxuICAgICAgICAgICAgICAgIHZhbHVlOiAoZCkgPT4gZC5wcm9wZXJ0aWVzLmFkbWluX25hbWVcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgY291bnRyeTogKGQpID0+IGQucHJvcGVydGllcy5hZG1pbjBfbmFtZSxcbiAgICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgIGxhYmVsOiBzZWxlY3Rvci5sYWJlbFRpcCxcbiAgICAgICAgICAgICAgICB2YWx1ZTogKGQpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBkYXRhID0gZC5wcm9wZXJ0aWVzLmRhdGEgPyBkLnByb3BlcnRpZXMuZGF0YVtkYXRhQ29sdW1uXSA6IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgIHJldHVybiBkYXRhXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBmb3JtYXQ6IHtcbiAgICAgICAgICAgICAgbmFtZTogdHJ1ZSxcbiAgICAgICAgICAgICAgY291bnRyeTogZmFsc2UsXG4gICAgICAgICAgICAgIGRhdGE6IChkKSA9PiBzZWxlY3Rvci5mb3JtYXRGdW5jKGQpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSlcbiAgICAgICAgKVxuICAgICAgKVxuICAgIF1cbiAgfSk7XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTE2IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoibWFwX2luc2lnaHRzID0ge1xuICBhc3luYyBmdW5jdGlvbiBxdWlja19pbnNpZ2h0X21hcF9hZG1pbl9yYW5rKGRhdGFfY29sdW1uKXtcbiAgICBsZXQgbm9uZV9hZG1pbnNfZm9yX3NhbWVfbGV2ZWwgPSBnZXRBZG1pbnNOb25lRm9yU2FtZUxldmVsKClcbiAgICBsZXQgcXVlcnkgPSBgXG4gICAgICAgIFNFTEVDVCAqXG4gICAgICAgIEZST00gYWdncmVnYXRlZFxuICAgICAgICBXSEVSRSBjeWNsZSA9ICcke3NlbGVjdGVkX2N5Y2xlX29wdGlvbnMuY3ljbGV9J1xuICAgICAgICBBTkQgY3JvcCA9ICcke2Nyb3Bfc2VsZWN0b3JfZHluYW1pY19pbnNpZ2h0c30nXG4gICAgICAgIEFORCBjdWx0aXZhciA9ICcke3NlbGVjdGVkX2N1bHRpdmFyLnZhbHVlfSdgXG4gICAgaWYgKG5vbmVfYWRtaW5zX2Zvcl9zYW1lX2xldmVsLmxlbmd0aCA+IDApIHtcbiAgICAgIHF1ZXJ5ICs9IGAgQU5EICR7bm9uZV9hZG1pbnNfZm9yX3NhbWVfbGV2ZWwubWFwKGNvbCA9PiBgJHtjb2x9IElTIE5VTExgKS5qb2luKCcgQU5EICcpfWBcbiAgICB9XG4gICAgbGV0IHNhbWVfbGV2ZWwgPSBhd2FpdCBkYi5xdWVyeShxdWVyeSlcbiAgICAgIC50aGVuKChyKSA9PiByLnRvQXJyYXkoKSlcbiAgICAvLyBTb3J0IGJ5IGFic29sdXRlIHlpZWxkIGNoYW5nZXMsIGRlc2NlbmRpbmcgb3JkZXJcbiAgICAvLyBUT0RPOiBhYnNvbHV0ZSB2YWx1ZT9cbiAgICBzYW1lX2xldmVsLnNvcnQoKGEsIGIpID0+IE1hdGguYWJzKGFbZGF0YV9jb2x1bW5dKSAtIE1hdGguYWJzKGJbZGF0YV9jb2x1bW5dKSkucmV2ZXJzZSgpO1xuICBcbiAgICBsZXQgcmFua2luZyA9IDA7XG4gICAgbGV0IHNlbGVjdGVkX2FkbWluID0gZ2V0X3NlbGVjdGVkX2FkbWluX2F0ZmMoKTtcbiAgICBsZXQgYWRtaW5zX3RvX25hbWVzID0ge1xuICAgICAgYWRtaW4wX25hbWU6IFwiY291bnRyaWVzXCIsXG4gICAgICBhZG1pbjFfbmFtZTogXCJyZWdpb25zXCIsXG4gICAgICBhZG1pbjJfbmFtZTogXCJzdWJyZWdpb25zXCIsXG4gICAgfVxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2FtZV9sZXZlbC5sZW5ndGg7IGkrKyl7XG4gICAgICBsZXQgb2JqID0gc2FtZV9sZXZlbFtpXTtcbiAgICAgIGlmIChvYmpbc2VsZWN0ZWRfYWRtaW4uYWRtaW5dICE9IHNlbGVjdGVkX2FkbWluLmhpZ2hsaWdodClcbiAgICAgICAgY29udGludWVcbiAgICAgIHJhbmtpbmcgPSBpICsgMTtcbiAgICAgIGJyZWFrXG4gICAgfVxuICAgIFxuICAgIHJldHVybiB7XG4gICAgICBkYXRhOiBzYW1lX2xldmVsLFxuICAgICAgcmFua2luZzogcmFua2luZyxcbiAgICAgIHNlbGVjdGVkX2dlbzogc2VsZWN0ZWRfYWRtaW4uaGlnaGxpZ2h0LFxuICAgICAgYWRtaW5fbmFtZTogYWRtaW5zX3RvX25hbWVzW3NlbGVjdGVkX2FkbWluLmFkbWluXSxcbiAgICAgIG91dF9vZjogc2FtZV9sZXZlbC5sZW5ndGgsXG4gICAgfTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGF2ZXJhZ2VfZmlyc3RfaW5zaWdodF9mb3JfYWxsX3N1YnNhaGFyYW5fYWZyaWNhKGZpbHRlcmVkKSB7XG4gICAgY29uc3QgeWllbGRfaW5fc2VsZWN0ZWRfZ2VvID0gZmlsdGVyZWQuZmlsdGVyKGQgPT4gZC5hZG1pbjFfbmFtZSA9PSBudWxsKVxuICAgIGNvbnN0IGNvbG5hbWUgPSBnZXRfeWllbGRfY29sdW1uKHNlbGVjdGVkX3lpZWxkX291dHB1dC5sYWJlbCwgc2VsZWN0R2VvRGF0YVR5cGUubGFiZWxUaXApO1xuICAgIC8vY29uc3QgY29sbmFtZSA9IFwieWllbGRfXCIrc2VsZWN0R2VvRGF0YVR5cGUubGFiZWxUaXArXCJfYXZnXCI7XG4gICAgY29uc3QgdmFsdWVzID0geWllbGRfaW5fc2VsZWN0ZWRfZ2VvLm1hcChkID0+IGRbbWFwRGF0YUNvbHVtbl0pO1xuICAgIGxldCBvYmogPSB7fVxuICAgIG9ialtjb2xuYW1lXSA9IGF2ZXJhZ2UodmFsdWVzKVxuICAgIHJldHVybiBbb2JqXVxuICB9XG5cblxuICAvLyBUaXRsZVxuICBsZXQgZ2VvZ3MgPSBPYmplY3QudmFsdWVzKGFkbWluU2VsZWN0aW9ucykuZmlsdGVyKGQgPT4gZCAhPT0gbnVsbClcbiAgaWYgKGdlb2dzLmxlbmd0aCA9PSAwKXsgXG4gICAgLy8gZ2VvZ3MgPSBfbGFuZyhuYlRleHQuZ2VuZXJhbC5jb3VudHJ5X2FydGljbGUyLlNTQSk7ICBcbiAgICBnZW9ncyA9IF9sYW5nKG5iVGV4dC5nZW5lcmFsLmFkbWluTmFtZXMuU1NBKTsgIFxuICB9IGVsc2Uge1xuICAgIGdlb2dzID0gZ2VvZ3MubWFwKHZhbCA9PiBfbGFuZyhuYlRleHQuZ2VuZXJhbC5hZG1pbk5hbWVzW3ZhbF0pIHx8IHZhbCkuam9pbihcIiwgXCIpXG4gICAgLy8gZ2VvZ3MgPSBnZW9ncy5tYXAodmFsID0+IF9sYW5nKG5iVGV4dC5nZW5lcmFsLmNvdW50cnlfYXJ0aWNsZTJbdmFsXSkgfHwgdmFsKS5qb2luKFwiLCBcIilcbiAgfVxuICBsZXQgeWllbGRfaW5fc2VsZWN0ZWRfZ2VvID0gZGF0YVlpZWxkLmZpbHRlcihmaWx0ZXJZaWVsZERhdGFCeUFkbWlucyk7XG4gIGlmIChzZWxlY3RBZG1pbjAgPT0gbnVsbCl7XG4gICAgeWllbGRfaW5fc2VsZWN0ZWRfZ2VvID0gYXZlcmFnZV9maXJzdF9pbnNpZ2h0X2Zvcl9hbGxfc3Vic2FoYXJhbl9hZnJpY2EoeWllbGRfaW5fc2VsZWN0ZWRfZ2VvKSBcbiAgfVxuXG4gIGxldCB0aXRsZV90ZW1wbGF0ZSA9IF9sYW5nKG5iVGV4dC56b29tVG9TdGFibGUuTWFwSW5zaWdodC50aXRsZSlcblxuICBsZXQgdGl0bGVfdmFsdWVzID0gW1xuICAgIHtuYW1lOlwiZ2VvZ3JhcGh5XCIsIHZhbHVlOiBnZW9nc30sXG4gICAge25hbWU6XCJzY2VuYXJpb19zZWxlY3Rpb25cIiwgdmFsdWU6IHNlbGVjdGVkX3NjZW5hcmlvLmxhYmVsLnRvTG93ZXJDYXNlKCl9LFxuICAgIHtuYW1lOlwiY3JvcF9zZWxlY3Rpb25cIiwgdmFsdWU6IF9sYW5nKG5iVGV4dC5nZW5lcmFsLmNyb3BzW2Nyb3Bfc2VsZWN0b3JfZHluYW1pY19pbnNpZ2h0cy50b0xvd2VyQ2FzZSgpXSl9XG4gIF1cbiAgXG4gIGNvbnN0IHRpdGxlID0gTGFuZy5yZWR1Y2VSZXBsYWNlVGVtcGxhdGVJdGVtcyh0aXRsZV90ZW1wbGF0ZSwgdGl0bGVfdmFsdWVzKVxuXG4gIC8vIEdsb2JhbHNcbiAgY29uc3QgX291dHB1dE5hbWUgPSBfbGFuZyhuYlRleHQuem9vbVRvU3RhYmxlLnNlbGVjdG9ycy5ZaWVsZE91dHB1dC52YWx1ZXNbc2VsZWN0ZWRfeWllbGRfb3V0cHV0LmxhYmVsXSkudG9Mb3dlckNhc2UoKVxuICBjb25zdCBfb3V0cHV0VW5pdCA9IF9vdXRwdXROYW1lLm1hdGNoKC9cXCgoW14pXSspXFwpL2cpO1xuXG4gIC8vSW5zaWdodCAxXG4gIGxldCBpbnNpZ2h0MSA9IFwiXCJcbiAgLy8gUmFpbmZlZCB5aWVsZFxuICBpZiAoeWllbGRfaW5fc2VsZWN0ZWRfZ2VvICE9PSBudWxsICYmIHlpZWxkX2luX3NlbGVjdGVkX2dlby5sZW5ndGggPT0gMSl7XG4gICAgbGV0IHlpZWxkX2luX3NlbGVjdGVkX2dlb19vYmogPSB5aWVsZF9pbl9zZWxlY3RlZF9nZW9bMF07XG4gICAgaWYgKHlpZWxkX2luX3NlbGVjdGVkX2dlb19vYmpbbWFwRGF0YUNvbHVtbl0gIT0gbnVsbCl7XG4gICAgICBsZXQgcm91bmRlZCA9IE1hdGgucm91bmQoeWllbGRfaW5fc2VsZWN0ZWRfZ2VvX29ialttYXBEYXRhQ29sdW1uXSAqIDEwMCkgLyAxMDA7XG4gICAgICBcbiAgICAgIGxldCBpbnNpZ2h0MV90ZW1wbGF0ZSA9IF9sYW5nKG5iVGV4dC56b29tVG9TdGFibGUuTWFwSW5zaWdodC5pbnNpZ2h0MSlcbiAgICAgIFxuICAgICAgbGV0IGluc2lnaHQxX3ZhbHVlcyA9IFtcbiAgICAgICAge25hbWU6XCJnZW9ncmFwaHlcIiwgdmFsdWU6IGdlb2dzfSxcbiAgICAgICAge25hbWU6XCJzY2VuYXJpb19zZWxlY3Rpb25cIiwgdmFsdWU6IHNlbGVjdGVkX3NjZW5hcmlvLmxhYmVsLnRvTG93ZXJDYXNlKCl9LFxuICAgICAgICB7bmFtZTpcImNyb3Bfc2VsZWN0aW9uXCIsIHZhbHVlOiBjcm9wX3NlbGVjdG9yX2R5bmFtaWNfaW5zaWdodHN9LFxuICAgICAgICB7bmFtZTpcInlpZWxkX3NlbGVjdGlvblwiLCB2YWx1ZTogX291dHB1dE5hbWV9LFxuICAgICAgICB7bmFtZTpcInZhbHVlXCIsIHZhbHVlOiByb3VuZGVkfVxuICAgICAgXVxuICAgICAgXG4gICAgICBpbnNpZ2h0MSA9IGAqICR7TGFuZy5yZWR1Y2VSZXBsYWNlVGVtcGxhdGVJdGVtcyhpbnNpZ2h0MV90ZW1wbGF0ZSwgaW5zaWdodDFfdmFsdWVzKX1gICBcbiAgICB9XG4gIH1cblxuICAvLyBJbnNpZ2h0IDJcbiAgbGV0IGluc2lnaHQyID0gXCJcIlxubGV0IHByZV9maWx0ZXJlZCA9IGF3YWl0IGRiLnF1ZXJ5KGBcbiAgU0VMRUNUICpcbiAgRlJPTSBhZ2dyZWdhdGVkIFxuICBXSEVSRSBjeWNsZSA9ICcke3NlbGVjdGVkX2N5Y2xlX29wdGlvbnMuY3ljbGV9J1xuICBBTkQgY3JvcCA9ICcke2Nyb3Bfc2VsZWN0b3JfZHluYW1pY19pbnNpZ2h0cy50b0xvd2VyQ2FzZSgpfSdcbiAgQU5EIGN1bHRpdmFyID0gJyR7c2VsZWN0ZWRfY3VsdGl2YXIudmFsdWV9J1xuYCkudGhlbigocikgPT4gci50b0FycmF5KCkpXG4gIFxuICBpZiAoYWRtaW5TZWxlY3Rpb25zLnNlbGVjdEFkbWluMCAhPSBudWxsKXtcbiAgIHByZV9maWx0ZXJlZCA9IHByZV9maWx0ZXJlZC5maWx0ZXIoZmlsdGVyWWllbGREYXRhQnlBZG1pbnMpO1xuICB9XG5cbiAgLy8gQSBjbGltYXRlIGNoYW5nZSBzY2VuYXJpbyAuLi5cbiAgaWYgKHNlbGVjdGVkX3NjZW5hcmlvLmxhYmVsLnRvTG93ZXJDYXNlKCkgIT0gXCJoaXN0b3JpY2FsXCIpe1xuICAgIGxldCBjbGltYXRlX2NoYW5nZV9zY2VuYXJpb3M7XG4gICAgaWYgKGFkbWluU2VsZWN0aW9ucy5zZWxlY3RBZG1pbjAgPT0gbnVsbCl7XG4gICAgICBjb25zdCBhZnJpY2FfcHJlX2ZpbHRlcmVkID0gcHJlX2ZpbHRlcmVkLmZpbHRlcihkID0+IGQuYWRtaW4xX25hbWUgPT0gbnVsbCAmJiBkLnNzcCA9PSBzZWxlY3RlZF9zY2VuYXJpby5zc3ApO1xuICAgICAgY29uc3QgaG9yaXpvbnMgPSBbMjAzMCwgMjA1MF07XG4gICAgICBjbGltYXRlX2NoYW5nZV9zY2VuYXJpb3MgPSBbXTtcbiAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCBob3Jpem9ucy5sZW5ndGg7IGkrKyl7XG4gICAgICAgIGNvbnN0IHRlbXBfaCA9IGhvcml6b25zW2ldO1xuICAgICAgICBsZXQgYXZlcmFnZWRfaG9yaXpvbiA9IGF2ZXJhZ2VfZmlyc3RfaW5zaWdodF9mb3JfYWxsX3N1YnNhaGFyYW5fYWZyaWNhKFxuICAgICAgICAgIGFmcmljYV9wcmVfZmlsdGVyZWQuZmlsdGVyKGQgPT4gZC5ob3Jpem9uID09IHRlbXBfaClcbiAgICAgICAgKTtcbiAgICAgICAgYXZlcmFnZWRfaG9yaXpvblswXVtcImhvcml6b25cIl0gPSB0ZW1wX2g7XG4gICAgICAgIGF2ZXJhZ2VkX2hvcml6b25bMF1bXCJzc3BcIl0gPSBzZWxlY3RlZF9zY2VuYXJpby5zc3A7IFxuICAgICAgICBjbGltYXRlX2NoYW5nZV9zY2VuYXJpb3MucHVzaCguLi5hdmVyYWdlZF9ob3Jpem9uKVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBjbGltYXRlX2NoYW5nZV9zY2VuYXJpb3MgPSBwcmVfZmlsdGVyZWQuZmlsdGVyKChkKSA9PiAoXG4gICAgICAgIChkLnNzcCA9PSBzZWxlY3RlZF9zY2VuYXJpby5zc3ApXG4gICAgICApKTtcbiAgICB9XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjbGltYXRlX2NoYW5nZV9zY2VuYXJpb3MubGVuZ3RoOyBpKyspe1xuICAgICAgbGV0IGVtaXNzaW9ucyA9IGNsaW1hdGVfY2hhbmdlX3NjZW5hcmlvc1tpXS5zc3AgPT0gXCJTU1AzNzBcIiA/IFwibW9kZXJhdGUgXCI6IFwiaGlnaCBcIjtcbiAgICAgIGVtaXNzaW9ucyArPSBjbGltYXRlX2NoYW5nZV9zY2VuYXJpb3NbaV0uc3NwXG4gICAgICBsZXQgaW1wYWN0ID0gTWF0aC5yb3VuZChjbGltYXRlX2NoYW5nZV9zY2VuYXJpb3NbaV1bbWFwRGF0YUNvbHVtbl0gKiAxMDApIC8gMTAwO1xuICAgICAgbGV0IGhvcml6b24gPSBjbGltYXRlX2NoYW5nZV9zY2VuYXJpb3NbaV0uaG9yaXpvblxuICAgICAgaWYgKGhvcml6b24gPT0gMjAwNSlcbiAgICAgICAgY29udGludWVcbiAgICAgIGxldCBjaGFuZ2U7XG4gICAgICBpZiAoaW1wYWN0ID09IDApXG4gICAgICAgIGNoYW5nZSA9IFwibmV1dHJhbFwiXG4gICAgICBlbHNlXG4gICAgICAgIGNoYW5nZSA9IGltcGFjdCA+IDAgPyBcInBvc2l0aXZlXCIgOiBcIm5lZ2F0aXZlXCI7XG5cbiAgICAgIGxldCBpbnNpZ2h0Ml90ZW1wbGF0ZSA9IF9sYW5nKG5iVGV4dC56b29tVG9TdGFibGUuTWFwSW5zaWdodC5pbnNpZ2h0MilcbiAgICAgIFxuICAgICAgbGV0IGluc2lnaHQyX3ZhbHVlcyA9IFtcbiAgICAgICAge25hbWU6XCJlbWlzc2lvbl9sZXZlbFwiLCB2YWx1ZTogZW1pc3Npb25zfSxcbiAgICAgICAge25hbWU6XCJob3Jpem9uXCIsIHZhbHVlOiBob3Jpem9ufSxcbiAgICAgICAge25hbWU6XCJjaGFuZ2VfdHlwZVwiLCB2YWx1ZTogX2xhbmcobmJUZXh0LmdlbmVyYWxbY2hhbmdlXSl9LFxuICAgICAgICB7bmFtZTpcImltcGFjdF9wY3RcIiwgdmFsdWU6IGltcGFjdH0sXG4gICAgICAgIHtuYW1lOlwiY2hhbmdlX3VuaXRcIiwgdmFsdWU6IF9vdXRwdXRVbml0fVxuICAgICAgXVxuXG4gICAgICBpbnNpZ2h0MiArPSBgKiAke0xhbmcucmVkdWNlUmVwbGFjZVRlbXBsYXRlSXRlbXMoaW5zaWdodDJfdGVtcGxhdGUsIGluc2lnaHQyX3ZhbHVlcyl9XFxuYFxuXG4gICAgICAvLyBpbnNpZ2h0cyArPSBgKiBBIGNsaW1hdGUgY2hhbmdlIHNjZW5hcmlvIHdpdGggJHtlbWlzc2lvbnN9IGVtaXNzaW9ucyBieSAqKiR7aG9yaXpvbn0qKiBoYXMgYSAqKiR7Y2hhbmdlfSoqIGltcGFjdCBvbiB5aWVsZCBvZiAke2ltcGFjdH0lLiBcXG5gXG4gICAgfVxuICB9XG5cbiAgbGV0IGluc2lnaHQzID0gXCJcIlxuICBpZiAoc2VsZWN0ZWRfeWllbGRfb3V0cHV0LmxhYmVsID09IFwiWWllbGQgY2hhbmdlICglKVwiKXtcbiAgICBjb25zdCB2YWx1ZXNfY29sID0gZ2V0X3lpZWxkX2NvbHVtbihcIllpZWxkIGNoYW5nZSAoJSlcIiwgc2VsZWN0R2VvRGF0YVR5cGUubGFiZWxUaXApO1xuICAgIGNvbnN0IGNoYW5nZV92YWx1ZXMgPSBwcmVfZmlsdGVyZWRcbiAgICAgIC5maWx0ZXIoZCA9PiAoKGRbdmFsdWVzX2NvbF0gIT09IG51bGwpKSlcbiAgICAgIC5tYXAoZCA9PiBkW3ZhbHVlc19jb2xdKTtcbiAgICBsZXQgbWF4X2NoYW5nZSA9IE1hdGgucm91bmQoYXJyYXlNYXgoY2hhbmdlX3ZhbHVlcykgKiAxMDApIC8gMTAwO1xuICAgIGxldCBtaW5fY2hhbmdlID0gTWF0aC5yb3VuZChhcnJheU1pbihjaGFuZ2VfdmFsdWVzKSAqIDEwMCkgLyAxMDA7XG5cbiAgICBsZXQgaW5zaWdodDNfdGVtcGxhdGUgPSBfbGFuZyhuYlRleHQuem9vbVRvU3RhYmxlLk1hcEluc2lnaHQuaW5zaWdodDMpXG4gICAgXG4gICAgbGV0IGluc2lnaHQzX3ZhbHVlcyA9IFtcbiAgICAgIHtuYW1lOlwibWluQ2hhbmdlXCIsIHZhbHVlOiBtaW5fY2hhbmdlfSxcbiAgICAgIHtuYW1lOlwibWF4Q2hhbmdlXCIsIHZhbHVlOiBtYXhfY2hhbmdlfSxcbiAgICBdXG5cbiAgICBpbnNpZ2h0MyA9IGAqICR7TGFuZy5yZWR1Y2VSZXBsYWNlVGVtcGxhdGVJdGVtcyhpbnNpZ2h0M190ZW1wbGF0ZSwgaW5zaWdodDNfdmFsdWVzKX1gXG5cbi8vICAgICBpbnNpZ2h0cyArPSBgKiBUaGUgcHJvamVjdGVkIHlpZWxkIGNoYW5nZXMgYXJpc2UgZnJvbSBzaW11bGF0aW5nIHlpZWxkIHVuZGVyIHZhcmlvdXMgcGxhdXNpYmxlIGZ1dHVyZXMsIHdoaWNoIGltcGxpZXMgdW5jZXJ0YWludHkuIEFjY29yZGluZ2x5LCB0aGUgcmFuZ2Ugb2YgcHJvamVjdGVkIGNoYW5nZXMgaXMgKioke21pbl9jaGFuZ2V9JSoqIHRvICoqJHttYXhfY2hhbmdlfSUqKiBhY3Jvc3MgdGhlIGNsaW1hdGUgbW9kZWxzIHVzZWQuXG4vLyBgXG4gIH1cblxuICAvL2luc2lnaHQgNFxuICBsZXQgaW5zaWdodDQgPSBcIlwiXG4gIGlmIChhZG1pblNlbGVjdGlvbnMuc2VsZWN0QWRtaW4wICE9IG51bGwpe1xuICAgIC8vIEFic29sdXRlIHlpZWxkIGNoYW5nZXNcbiAgICBsZXQgZGF0YV9jb2x1bW4gPSBnZXRfeWllbGRfY29sdW1uKFwiWWllbGQgY2hhbmdlICh0b24vaGEpXCIsIHNlbGVjdEdlb0RhdGFUeXBlLmxhYmVsVGlwKTtcbiAgICBsZXQgcmVzdWx0ID0gYXdhaXQgcXVpY2tfaW5zaWdodF9tYXBfYWRtaW5fcmFuayhkYXRhX2NvbHVtbik7XG4gICAgXG4gICAgbGV0IGluc2lnaHQ0X3RlbXBsYXRlID0gX2xhbmcobmJUZXh0Lnpvb21Ub1N0YWJsZS5NYXBJbnNpZ2h0Lmluc2lnaHQ0KVxuICAgIGxldCBpbnNpZ2h0NF92YWx1ZXMgPSBbXG4gICAgICB7bmFtZTpcImdlb2dyYXBoeVwiLCB2YWx1ZTogcmVzdWx0LnNlbGVjdGVkX2dlb30sXG4gICAgICB7bmFtZTpcInJhbmtcIiwgdmFsdWU6IHJlc3VsdC5yYW5raW5nfSxcbiAgICAgIHtuYW1lOlwibnVtXCIsIHZhbHVlOiByZXN1bHQub3V0X29mfSxcbiAgICAgIHtuYW1lOlwiYWRtaW5MdmxcIiwgdmFsdWU6IHJlc3VsdC5hZG1pbl9uYW1lfSxcbiAgICBdXG5cbiAgICBpbnNpZ2h0NCA9IGAqICR7TGFuZy5yZWR1Y2VSZXBsYWNlVGVtcGxhdGVJdGVtcyhpbnNpZ2h0NF90ZW1wbGF0ZSwgaW5zaWdodDRfdmFsdWVzKX1gXG4gICAgLy8gaW5zaWdodHMgKz0gYCogQWNyb3NzIGFsbCBvZiBTdWItU2FoYXJhbiBBZnJpY2EsICR7cmVzdWx0LnNlbGVjdGVkX2dlb30gcmFua3MgJHtyZXN1bHQucmFua2luZ30gb3V0IG9mICR7cmVzdWx0Lm91dF9vZn0gJHtyZXN1bHQuYWRtaW5fbmFtZX0gYXQgdGhlIHNhbWUgbGV2ZWwsIHdpdGggcmVnYXJkIHRvIGFic29sdXRlIHlpZWxkIGNoYW5nZXMuXFxuYFxuICB9XG5cbiAgXG4gIHJldHVybiBtZGBcbiMjIyAke3RpdGxlfVxuJHtpbnNpZ2h0MX1cbiR7aW5zaWdodDJ9XG4ke2luc2lnaHQzfVxuJHtpbnNpZ2h0NH1gXG4gIFxuLy8gJHtpbnNpZ2h0c31gXG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTE3IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoibWRgIyAke19sYW5nKG5iVGV4dC5hZGFwdEZ1dHVyZUNoYW5nZS50aXRsZSl9XG5cbiR7X2xhbmcobmJUZXh0LmFkYXB0RnV0dXJlQ2hhbmdlLnRleHQpfWA7XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTE4IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiYXRmY19mb3JtID0gSW5wdXRzLmZvcm0oW1xuICAgIHZpZXdvZiBhdGZjX2Nyb3Bfc2VsZWN0b3IsXG4gICAgdmlld29mIGF0ZmNfY3ljbGVfc2VsZWN0b3IsXG4gICAgdmlld29mIGF0ZmNfc2NlbmFyaW9fc2VsZWN0b3Jcbl0sIHt0ZW1wbGF0ZTogZm9ybVRlbXBsYXRlKCl9KVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xOSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Imdlb0ltcGFjdEFkbWluU2VsZWN0b3JzQUZDID0gSW5wdXRzLmZvcm0oXG4gIFtcbiAgICBJbnB1dHMuYmluZChcbiAgICAgIElucHV0cy5zZWxlY3QoZGF0YUFkbWluMCwgeyBsYWJlbDogX2xhbmcobmJUZXh0LmdlbmVyYWwuY291bnRyeSksIGZvcm1hdDogeCA9PiB4ID09IG51bGwgPyBfbGFuZyhuYlRleHQuZ2VuZXJhbC5hZG1pbk5hbWVzWydTU0EnXSk6IF9sYW5nKG5iVGV4dC5nZW5lcmFsLmFkbWluTmFtZXNbeF0pfSksXG4gICAgICB2aWV3b2Ygc2VsZWN0QWRtaW4wXG4gICAgKSxcbiAgICBJbnB1dHMuYmluZChcbiAgICAgIElucHV0cy5zZWxlY3QoZGF0YUFkbWluMSwgeyBsYWJlbDogX2xhbmcobmJUZXh0LmdlbmVyYWwucmVnaW9uKSB9KSxcbiAgICAgIHZpZXdvZiBzZWxlY3RBZG1pbjFcbiAgICApLFxuICAgIElucHV0cy5iaW5kKFxuICAgICAgSW5wdXRzLnNlbGVjdChkYXRhQWRtaW4yLCB7IGxhYmVsOiBfbGFuZyhuYlRleHQuZ2VuZXJhbC5zdWJSZWdpb24pIH0pLFxuICAgICAgdmlld29mIHNlbGVjdEFkbWluMlxuICAgIClcbiAgXSxcbiAge1xuICAgIHRlbXBsYXRlOiBmb3JtVGVtcGxhdGUoKVxuICB9XG4pXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTIwIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoidmlld29mIHJhZGlvU29ydERvdFBsb3RDcm9wID0ge1xuICBjb25zdCBkYXRhID0gW1xuICAgIHtcbiAgICAgIGtleTogXCJvYnNlcnZhdGlvbnNcIixcbiAgICAgIGxhYmVsOiBfbGFuZyhuYlRleHQuYWRhcHRGdXR1cmVDaGFuZ2Uuc2VsZWN0b3JzLnNvcnQudmFsdWVzLm5vQWRhcHQpLFxuICAgICAgY2hhbm5lbDogXCJuT2JzXCIsXG4gICAgICByZXZlcnNlOiB0cnVlLFxuICAgIH0sXG4gICAge1xuICAgICAga2V5OiBcIm1lYW5cIixcbiAgICAgIGxhYmVsOiBfbGFuZyhuYlRleHQuYWRhcHRGdXR1cmVDaGFuZ2Uuc2VsZWN0b3JzLnNvcnQudmFsdWVzLm1lYW5EaWZmKSxcbiAgICAgIGNoYW5uZWw6IFwieFwiLFxuICAgICAgcmV2ZXJzZTogdHJ1ZSxcbiAgICB9LFxuICAgIHtcbiAgICAgIGtleTogXCJhbHBoYVwiLFxuICAgICAgbGFiZWw6IF9sYW5nKG5iVGV4dC5hZGFwdEZ1dHVyZUNoYW5nZS5zZWxlY3RvcnMuc29ydC52YWx1ZXMuYWxwaGFiZXQpLFxuICAgICAgY2hhbm5lbDogXCJ5XCIsXG4gICAgICByZXZlcnNlOiBmYWxzZSxcbiAgICB9LFxuICBdXG4gIHJldHVybiBJbnB1dHMucmFkaW8oZGF0YSwgeyBsYWJlbDogXCJTb3J0XCIsIGZvcm1hdDogZCA9PiBkLmxhYmVsLCB2YWx1ZTogZGF0YS5maW5kKHggPT4geC5rZXkgPT09ICdtZWFuJykgfSk7XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTIxIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoicGxvdERvdEFFWiA9IHtcbiAgY29uc3QgYmFzZURhdGEgPSBkYXRhWWllbGRBVEZDO1xuICBjb25zdCBwbG90RGF0YSA9IGJhc2VEYXRhLmZpbHRlcihkID0+IChcbiAgICAgIChkLmNyb3AudG9Mb3dlckNhc2UoKS50cmltKCkgPT0gc2VsZWN0ZWRfY3JvcF9hdGZjLnRvTG93ZXJDYXNlKCkudHJpbSgpKVxuICAgIClcbiAgKTtcbiAgdmFyIHRvSGlnbGlnaHQgPSBnZXRfc2VsZWN0ZWRfYWRtaW5fYXRmYygpO1xuICBpZiAoc2VsZWN0QWRtaW4wID09IG51bGwpe1xuICAgIHRvSGlnbGlnaHQgPSB7XG4gICAgICBhZG1pbjogXCJhZG1pbjBfbmFtZVwiLFxuICAgICAgaGlnaGxpZ2h0OiBcIlwiXG4gICAgfVxuICB9XG4gIGNvbnN0IGFlekNvbG9yID0ge1xuICAgIGRvbWFpbjogW1xuICAgICAgXCJoaXN0b3JpY2FsXCIsXG4gICAgICBcIjIwMzBcIixcbiAgICAgIFwiMjA1MFwiLFxuICAgIF0sXG4gICAgcmFuZ2U6IFtcbiAgICAgIFwiIzc0Qjk1QVwiLFxuICAgICAgXCIjRjNENkIwXCIsXG4gICAgICBcIiNCMDJCMTlcIixcbiAgICBdLFxuICB9XG4gIGNvbnN0IGFlekRhdGEgPSBULnRpZHkoXG4gICAgcGxvdERhdGEsXG4gICAgVC5maWx0ZXIoKGQpID0+IHtcbiAgICAgIGlmICh0b0hpZ2xpZ2h0LmhpZ2hsaWdodCA9PSBudWxsKSByZXR1cm4gZDtcbiAgICAgIHJldHVybiBkW3RvSGlnbGlnaHQuYWRtaW5dID09IHRvSGlnbGlnaHQuaGlnaGxpZ2h0O1xuICAgIH0pLFxuICAgIFQuYXJyYW5nZShcIm1lYW5fZGlmZmVyZW5jZVwiKVxuICApO1xuICBcbiAgY29uc3QgY29sb3JEb21haW4gPSBhZXpDb2xvci5kb21haW47XG4gIGNvbnN0IGNvbG9yUmFuZ2UgPSBhZXpDb2xvci5yYW5nZTtcbiAgY29uc3QgbWFyZ2luQm90dG9tID0gMDtcbiAgY29uc3QgbWFyZ2luVG9wID0gNTA7XG4gIGNvbnN0IHlIZWlnaHQgPSAzNTtcbiAgY29uc3QgaGVpZ2h0ID1cbiAgICBtYXJnaW5Ub3AgK1xuICAgIG1hcmdpbkJvdHRvbSArXG4gICAgZDMuZ3JvdXAocGxvdERhdGEsIChkKSA9PiBkLmFkYXB0YXRpb24pLnNpemUgKiB5SGVpZ2h0O1xuICBjb25zdCBfZm9ybWF0TnVtID0gZm9ybWF0TnVtO1xuICAvLyBjb25zdCBfdG9nZ2xlQ0lzID0gdG9nZ2xlQ0lzQ3JvcFswXTsgLy8gUmVtb3ZlIGFzIENJIGFyZSB0b28gc21hbGwgdG8gc2VlIG9uIHBsb3RcbiAgY29uc3QgX3JhZGlvU29ydCA9IHJhZGlvU29ydERvdFBsb3RDcm9wO1xuICBcbiAgcmV0dXJuIFBsb3QucGxvdCh7XG4gICAgaGVpZ2h0LFxuICAgIG1hcmdpbkJvdHRvbSxcbiAgICBtYXJnaW5Ub3AsXG4gICAgbWFyZ2luTGVmdDogMTYwLFxuICAgIG1hcmdpblJpZ2h0OiA1MCxcbiAgICB3aWR0aDogMTAwMCxcbiAgICB4OiB7XG4gICAgICBheGlzOiBcInRvcFwiLFxuICAgICAgbmljZTogdHJ1ZSxcbiAgICAgIGdyaWQ6IHRydWUsXG4gICAgICBsYWJlbDogX2xhbmcobmJUZXh0LmFkYXB0RnV0dXJlQ2hhbmdlLnBsb3QueEF4aXMudGl0bGUpLFxuICAgICAgbGFiZWxBbmNob3I6IFwiY2VudGVyXCIsXG4gICAgICBsYWJlbE9mZnNldDogNDAsXG4gICAgICBsYWJlbEFycm93OiBcIm5vbmVcIlxuICAgIH0sXG4gICAgeToge1xuICAgICAgdGlja1NpemU6IDAsXG4gICAgICBsYWJlbDogbnVsbFxuICAgIH0sXG4gICAgY29sb3I6IHtcbiAgICAgIGRvbWFpbjogY29sb3JEb21haW4sXG4gICAgICByYW5nZTogY29sb3JSYW5nZSxcbiAgICAgIHRpY2tGb3JtYXQ6IGwgPT4gbCA9PT0gXCJoaXN0b3JpY2FsXCI/IF9sYW5nKG5iVGV4dC5nZW5lcmFsLmhpc3RvcmljYWwpIDogbCxcbiAgICAgIGxlZ2VuZDogdHJ1ZVxuICAgIH0sXG4gICAgbWFya3M6IFtcbiAgICAgIC8vIG1haW4geS1heGlzXG4gICAgICBQbG90LmF4aXNZKHtcbiAgICAgICAgdGlja1NpemU6IDAsXG4gICAgICAgIHRpY2tGb3JtYXQ6IGQgPT4gX2xhbmcobmJUZXh0LmFkYXB0RnV0dXJlQ2hhbmdlLnBsb3QueUF4aXNbZF0pXG4gICAgICB9KSxcbiAgICAgIC8vIHBvaW50ZXIgd2hpdGUtb3V0XG4gICAgICBQbG90LmF4aXNZKFxuICAgICAgICBQbG90LnBvaW50ZXJZKHtcbiAgICAgICAgICBmaWxsOiBcIndoaXRlXCIsXG4gICAgICAgICAgdGV4dFN0cm9rZTogXCJ3aGl0ZVwiLFxuICAgICAgICAgIHRleHRTdHJva2VXaWR0aDogMixcbiAgICAgICAgICB0aWNrU2l6ZTogMCxcbiAgICAgICAgICB0aWNrRm9ybWF0OiBkID0+IF9sYW5nKG5iVGV4dC5hZGFwdEZ1dHVyZUNoYW5nZS5wbG90LnlBeGlzW2RdKVxuICAgICAgICB9KVxuICAgICAgKSxcbiAgICAgIC8vIGJvbGQgcG9pbnRlclxuICAgICAgUGxvdC5heGlzWShcbiAgICAgICAgUGxvdC5wb2ludGVyWSh7XG4gICAgICAgICAgZm9udFdlaWdodDogXCJib2xkXCIsXG4gICAgICAgICAgdGlja1NpemU6IDAsXG4gICAgICAgICAgdGlja0Zvcm1hdDogZCA9PiBfbGFuZyhuYlRleHQuYWRhcHRGdXR1cmVDaGFuZ2UucGxvdC55QXhpc1tkXSlcbiAgICAgICAgfSlcbiAgICAgICksXG4gICAgICAvLyB6ZXJvIHBvaW50XG4gICAgICBQbG90LnJ1bGVYKFswXSwgeyBzdHJva2U6IFwiIzMzM1wiLCBzdHJva2VEYXNoYXJyYXk6IFs0XSB9KSxcbiAgICAgIC8vIGJhc2UgZG90c1xuICAgICAgUGxvdC5kb3QocGxvdERhdGEsIHtcbiAgICAgICAgeDogXCJtZWFuX2RpZmZlcmVuY2VcIixcbiAgICAgICAgeTogXCJhZGFwdGF0aW9uXCIsXG4gICAgICAgIHNvcnQ6IHsgeTogX3JhZGlvU29ydC5jaGFubmVsLCByZXZlcnNlOiBfcmFkaW9Tb3J0LnJldmVyc2UgfSxcbiAgICAgICAgcjogOCxcbiAgICAgICAgc3Ryb2tlOiBcIiNmZmZcIixcbiAgICAgICAgc3Ryb2tlV2lkdGg6IDAuNyxcbiAgICAgICAgZmlsbDogXCIjZWZlZmVmXCIsXG4gICAgICAgIGNoYW5uZWxzOiB7XG4gICAgICAgICAgbk9iczoge1xuICAgICAgICAgICAgbGFiZWw6IFwiIyBPYnNlcnZhdGlvbnNcIixcbiAgICAgICAgICAgIHZhbHVlOiBcIk5fT2JzXCJcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pLFxuICAgICAgLy8gc2VsZWN0aW9uOiBzcGFuIGxpbmVzOiBDSSAtIFJlbW92ZWQgYXMgdGhlIENJIGFyZSBzbyBzbWFsbCB0aGV5IGRvIG5vdCBhcHBlcmFyXG4gICAgICAvLyBQbG90LnJ1bGVZKF90b2dnbGVDSXMgPT0gXCJWaXNpYmxlXCIgPyBhZXpEYXRhIDogW10sIHtcbiAgICAgIC8vICAgeTogXCJhZGFwdGF0aW9uXCIsXG4gICAgICAvLyAgIHgxOiAoZCkgPT4gKGQuY2lfdXBwZXIgPT0gbnVsbCA/IG51bGwgOiBkLmNpX3VwcGVyKSxcbiAgICAgIC8vICAgeDI6IChkKSA9PiAoZC5jaV9sb3dlciAgPT0gbnVsbCA/IG51bGwgOiBkLmNpX2xvd2VyKSxcbiAgICAgIC8vICAgc3Ryb2tlOiBcIiMzMzNcIlxuICAgICAgLy8gfSksXG4gICAgICAvLyBzZWxlY3Rpb246IG1lYW4gZGlmZiBkb3RzXG4gICAgICBQbG90LmRvdChhZXpEYXRhLCB7XG4gICAgICAgIHg6IFwibWVhbl9kaWZmZXJlbmNlXCIsXG4gICAgICAgIHk6IFwiYWRhcHRhdGlvblwiLFxuICAgICAgICBmaWxsOiAoZCkgPT4ge1xuICAgICAgICAgIHJldHVybiBkLmhvcml6b247XG4gICAgICAgIH0sXG4gICAgICAgIHI6IDgsXG4gICAgICAgIHN0cm9rZTogXCIjZmZmXCIsXG4gICAgICAgIHN0cm9rZVdpZHRoOiAwLjcsXG4gICAgICAgIGNoYW5uZWxzOiB7XG4gICAgICAgICAgYWV6OiB7XG4gICAgICAgICAgICBsYWJlbDogX2xhbmcobmJUZXh0LmFkYXB0RnV0dXJlQ2hhbmdlLnBsb3QuY2hhbm5lbHMuYWV6KSxcbiAgICAgICAgICAgIHZhbHVlOiBcImhvcml6b25cIlxuICAgICAgICAgIH0sXG4gICAgICAgICAgLy8gbk9iczoge1xuICAgICAgICAgIC8vICAgbGFiZWw6IF9sYW5nKG5iVGV4dC5hZGFwdEZ1dHVyZUNoYW5nZS5wbG90LmNoYW5uZWxzLm5PYnMpLFxuICAgICAgICAgIC8vICAgdmFsdWU6IFwiTl9PYnNcIlxuICAgICAgICAgIC8vIH0sXG4gICAgICAgICAgZGlmZjoge1xuICAgICAgICAgICAgbGFiZWw6IF9sYW5nKG5iVGV4dC5hZGFwdEZ1dHVyZUNoYW5nZS5wbG90LmNoYW5uZWxzLmRpZmYpLFxuICAgICAgICAgICAgdmFsdWU6IFwibWVhbl9kaWZmZXJlbmNlXCJcbiAgICAgICAgICB9LFxuICAgICAgICAgIGNvbnRyb2w6IHtcbiAgICAgICAgICAgIGxhYmVsOiBfbGFuZyhuYlRleHQuYWRhcHRGdXR1cmVDaGFuZ2UucGxvdC5jaGFubmVscy5jb250cm9sKSxcbiAgICAgICAgICAgIHZhbHVlOiBcIk1lYW5fQ29udHJvbFwiXG4gICAgICAgICAgfSxcbiAgICAgICAgICBwcmFjOiB7XG4gICAgICAgICAgICBsYWJlbDogX2xhbmcobmJUZXh0LmFkYXB0RnV0dXJlQ2hhbmdlLnBsb3QuY2hhbm5lbHMucHJhYyksXG4gICAgICAgICAgICB2YWx1ZTogXCJhZGFwdGF0aW9uXCJcbiAgICAgICAgICB9LFxuICAgICAgICAgIGNyb3A6IHtcbiAgICAgICAgICAgIGxhYmVsOiBfbGFuZyhuYlRleHQuZ2VuZXJhbC5jcm9wKSxcbiAgICAgICAgICAgIHZhbHVlOiBcIkNyb3BcIlxuICAgICAgICAgIH0sXG4gICAgICAgICAgY2lMb3c6IHtcbiAgICAgICAgICAgIGxhYmVsOiBfbGFuZyhuYlRleHQuYWRhcHRGdXR1cmVDaGFuZ2UucGxvdC5jaGFubmVscy5jaUxvdyksXG4gICAgICAgICAgICB2YWx1ZTogXCJMb3dlclwiXG4gICAgICAgICAgfSxcbiAgICAgICAgICBjaUhpZ2g6IHtcbiAgICAgICAgICAgIGxhYmVsOiBfbGFuZyhuYlRleHQuYWRhcHRGdXR1cmVDaGFuZ2UucGxvdC5jaGFubmVscy5jaUhpZ2gpLFxuICAgICAgICAgICAgdmFsdWU6IFwiVXBwZXJcIlxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgdGlwOiB7XG4gICAgICAgICAgZm9ybWF0OiB7XG4gICAgICAgICAgICB4OiBmYWxzZSxcbiAgICAgICAgICAgIHk6IGZhbHNlLFxuICAgICAgICAgICAgZmlsbDogZmFsc2UsXG4gICAgICAgICAgICBwcmFjOiBmYWxzZSxcbiAgICAgICAgICAgIGNyb3A6IGZhbHNlLFxuICAgICAgICAgICAgYWV6OiAoZCkgPT4gZCA9PT0gXCJoaXN0b3JpY2FsXCI/IF9sYW5nKG5iVGV4dC5nZW5lcmFsLmhpc3RvcmljYWwpIDogZCxcbiAgICAgICAgICAgIGRpZmY6IChkKSA9PiBfZm9ybWF0TnVtKGQpLFxuICAgICAgICAgICAgY29udHJvbDogKGQpID0+IF9mb3JtYXROdW0oZCksXG4gICAgICAgICAgICBjaUxvdzogKGQpID0+IF9mb3JtYXROdW0oZCksXG4gICAgICAgICAgICBjaUhpZ2g6IChkKSA9PiBfZm9ybWF0TnVtKGQpLFxuICAgICAgICAgICAgbk9iczogdHJ1ZVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSksXG4gICAgICAvLyBkb3QgaGlnaGxpZ2h0IG9uIGhvdmVyXG4gICAgICBQbG90LmRvdChcbiAgICAgICAgYWV6RGF0YSxcbiAgICAgICAgUGxvdC5wb2ludGVyKHtcbiAgICAgICAgICB4OiBcIm1lYW5fZGlmZmVyZW5jZVwiLFxuICAgICAgICAgIHk6IFwiYWRhcHRhdGlvblwiLFxuICAgICAgICAgIHI6IDgsXG4gICAgICAgICAgZmlsbDogKGQpID0+IHtcbiAgICAgICAgICAgIHJldHVybiBkLmhvcml6b247XG4gICAgICAgICAgfSxcbiAgICAgICAgICBzdHJva2U6IFwiIzMzM1wiLFxuICAgICAgICAgIHN0cm9rZVdpZHRoOiAwLjcsXG4gICAgICAgICAgY2hhbm5lbHM6IHtcbiAgICAgICAgICAgIG5PYnM6IHtcbiAgICAgICAgICAgICAgbGFiZWw6IFwiIyBPYnNlcnZhdGlvbnNcIixcbiAgICAgICAgICAgICAgdmFsdWU6IFwiTl9PYnNcIlxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICksXG4gICAgICAvLyBvYnNlcnZhdGlvbiBjb3VudHNcbiAgICAgIC8vIFBsb3QudGV4dFkoXG4gICAgICAvLyAgIGFlekRhdGEsXG4gICAgICAvLyAgIFBsb3QubWFwKFxuICAgICAgLy8gICAgIHsgdGV4dDogKHZhbHVlcykgPT4gdmFsdWVzLm1hcCgoZCkgPT4gZCArIFwiIG9icy5cIikgfSxcbiAgICAgIC8vICAgICBQbG90Lmdyb3VwWShcbiAgICAgIC8vICAgICAgIHsgdGV4dDogXCJzdW1cIiB9LFxuICAgICAgLy8gICAgICAge1xuICAgICAgLy8gICAgICAgICB5OiBcImFkYXB0YXRpb25cIixcbiAgICAgIC8vICAgICAgICAgdGV4dDogXCJOX09ic1wiLFxuICAgICAgLy8gICAgICAgICBmcmFtZUFuY2hvcjogXCJyaWdodFwiLFxuICAgICAgLy8gICAgICAgICB0ZXh0QW5jaG9yOiBcInN0YXJ0XCIsXG4gICAgICAvLyAgICAgICAgIGR4OiAxNlxuICAgICAgLy8gICAgICAgfVxuICAgICAgLy8gICAgIClcbiAgICAgIC8vICAgKVxuICAgICAgLy8gKSxcbiAgICBdXG4gIH0pO1xufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0yMiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImFkYXB0YXRpb25faW5zaWdodHMgPSB7XG5cbiAgLy9UaXRsZSBQcm9jZXNzaW5nXG4gIGxldCBnZW9ncyA9IE9iamVjdC52YWx1ZXMoYWRtaW5TZWxlY3Rpb25zKS5maWx0ZXIoZCA9PiBkICE9PSBudWxsKVxuICBpZiAoZ2VvZ3MubGVuZ3RoID09IDApeyAvLyByZW5hbWVkIHRvIGF2YW9pZCBmdXR1cmUgbmFtZSBpc3N1ZXMgaWYgdXNpbmcgZ2Vvcy13YXNtXG4gICAgLy8gZ2VvZ3MgPSBfbGFuZyhuYlRleHQuZ2VuZXJhbC5jb3VudHJ5X2FydGljbGUyLlNTQSk7ICBcbiAgICBnZW9ncyA9IF9sYW5nKG5iVGV4dC5nZW5lcmFsLmFkbWluTmFtZXMuU1NBKTsgIFxuICB9IGVsc2Uge1xuICAgIC8vIGdlb2dzID0gZ2VvZ3MubWFwKHZhbCA9PiBfbGFuZyhuYlRleHQuZ2VuZXJhbC5jb3VudHJ5X2FydGljbGUyW3ZhbF0pIHx8IHZhbCkuam9pbihcIiwgXCIpXG4gICAgZ2VvZ3MgPSBnZW9ncy5tYXAodmFsID0+IF9sYW5nKG5iVGV4dC5nZW5lcmFsLmFkbWluTmFtZXNbdmFsXSkgfHwgdmFsKS5qb2luKFwiLCBcIilcbiAgfVxuICBsZXQgdGl0bGVfdGVtcGxhdGUgPSBfbGFuZyhuYlRleHQuYWRhcHRGdXR1cmVDaGFuZ2UuaW5zaWdodC50aXRsZSlcbiAgbGV0IHRpdGxlX3ZhbHVlcyA9IFtcbiAgICB7bmFtZTpcImdlb2dyYXBoeVwiLCB2YWx1ZTogZ2VvZ3N9LFxuICAgIHtuYW1lOlwic2NlbmFyaW9fbmFtZVwiLCB2YWx1ZTogYXRmY19zY2VuYXJpb19zZWxlY3Rvci50b0xvd2VyQ2FzZSgpfSxcbiAgICB7bmFtZTpcImNyb3BfbmFtZVwiLCB2YWx1ZTogc2VsZWN0ZWRfY3JvcF9hdGZjfVxuICBdXG4gIGxldCB0aXRsZSA9IExhbmcucmVkdWNlUmVwbGFjZVRlbXBsYXRlSXRlbXModGl0bGVfdGVtcGxhdGUsIHRpdGxlX3ZhbHVlcylcblxuICAvL0NvbmRpdGlvbmFscyBmb3IgaW5zaWdodCAxIGFuZCAyXG4gIGxldCBpbnNpZ2h0MSA9ICcnXG4gIGxldCBpbnNpZ2h0MiA9ICcnXG4gIC8vSW5zaWdodCAxIHByb2Nlc3NpbmdcblxuICB2YXIgc2VsZWN0ZWRfZ2VvID0gZ2V0X3NlbGVjdGVkX2FkbWluX2F0ZmMoKTtcbiAgaWYgKHNlbGVjdEFkbWluMCA9PSBudWxsKXtcbiAgICBzZWxlY3RlZF9nZW8gPSB7XG4gICAgICBhZG1pbjogXCJhZG1pbjBfbmFtZVwiLFxuICAgICAgaGlnaGxpZ2h0OiBcIlNTQVwiXG4gICAgfVxuICB9XG4gIGlmIChoaWdobGlnaHRlZF9kYXRhLmxlbmd0aCA+IDApe1xuICAgIGxldCBiZXR0ZXJfdGhhbl9ub19hZHB0ID0gZ2V0X2FkcHRfb3B0aW9uc19oaWdoZXJfeWllbGRfdGhhbl9ub19hZGFwdGF0aW9uKGhpZ2hsaWdodGVkX2RhdGEpO1xuICAgIGxldCBudW1fb3B0aW9uc19iZXR0ZXJfdGhhbl9ub19hcHQgPSBiZXR0ZXJfdGhhbl9ub19hZHB0Lmxlbmd0aDtcbiAgICBsZXQgbG93ZXJfYmVzdCA9IHJvdW5kKE1hdGgubWluKC4uLmJldHRlcl90aGFuX25vX2FkcHQubWFwKGQgPT4gZFtcIjIwNTBcIl0pKSwgMik7XG4gICAgbGV0IHVwcGVyX2Jlc3QgPSByb3VuZChNYXRoLm1heCguLi5iZXR0ZXJfdGhhbl9ub19hZHB0Lm1hcChkID0+IGRbXCJoaXN0b3JpY2FsXCJdKSksIDIpO1xuXG4gICAgbGV0IGluc2lnaHQxX3RlbXBsYXRlID0gX2xhbmcobmJUZXh0LmFkYXB0RnV0dXJlQ2hhbmdlLmluc2lnaHQuaW5zaWdodDEpXG4gICAgXG4gICAgbGV0IGluc2lnaHQxX3ZhbHVlcyA9IFtcbiAgICAgIHtuYW1lOlwic2VsZWN0ZWRfZ2VvXCIsIHZhbHVlOiBfbGFuZyhuYlRleHQuZ2VuZXJhbC5jb3VudHJpZXNfYXJ0aWNsZVtzZWxlY3RlZF9nZW8uaGlnaGxpZ2h0XSl9LFxuICAgICAge25hbWU6XCJudW1CZXR0ZXJcIiwgdmFsdWU6IG51bV9vcHRpb25zX2JldHRlcl90aGFuX25vX2FwdH0sXG4gICAgICB7bmFtZTpcImxvd2VyQmVzdFwiLCB2YWx1ZTogbG93ZXJfYmVzdH0sXG4gICAgICB7bmFtZTpcInVwcGVyQmVzdFwiLCB2YWx1ZTogdXBwZXJfYmVzdH1cbiAgICBdXG4gICAgaW5zaWdodDEgPSBgKiAke0xhbmcucmVkdWNlUmVwbGFjZVRlbXBsYXRlSXRlbXMoaW5zaWdodDFfdGVtcGxhdGUsIGluc2lnaHQxX3ZhbHVlcyl9YFxuXG4gICAgLy9JbnNpZ2h0IDIgcHJvY2Vzc2luZ1xuXG4gICAgLy8gU2VsZWN0IHRvcCAzIG9yIGxlc3NcbiAgICBjb25zdCB0b3AgPSBNYXRoLm1pbiguLi5bMywgYmV0dGVyX3RoYW5fbm9fYWRwdC5sZW5ndGhdKTtcbiAgICBjb25zdCBiZXN0X29wdGlvbnMgPSBbXTtcbiAgICBsZXQgbWF4X2ltcHJvdmVtZW50ID0gMDtcbiAgICBmb3IobGV0IGogPSAwOyBqIDwgdG9wOyBqICsrKXtcbiAgICAgIGJlc3Rfb3B0aW9ucy5wdXNoKGJldHRlcl90aGFuX25vX2FkcHRbal0ub3B0aW9uKTtcbiAgICAgIG1heF9pbXByb3ZlbWVudCA9IE1hdGgubWF4KGJldHRlcl90aGFuX25vX2FkcHRbal0uaGlzdG9yaWNhbCwgbWF4X2ltcHJvdmVtZW50KTtcbiAgICB9XG4gICAgbGV0IGluc2lnaHQyX3RlbXBsYXRlID0gX2xhbmcobmJUZXh0LmFkYXB0RnV0dXJlQ2hhbmdlLmluc2lnaHQuaW5zaWdodDIpXG4gICAgbGV0IGluc2lnaHQyX3ZhbHVlcyA9IFtcbiAgICAgIHtuYW1lOlwiYmVzdE9wdGlvbnNcIiwgdmFsdWU6IGJlc3Rfb3B0aW9ucy5tYXAoKGQpID0+IF9sYW5nKG5iVGV4dC5zdW1tYXJ5LmFkYXB0YXRpb25PcHRpb25zW2RdKSkuam9pbihcIiwgXCIpfSxcbiAgICAgIHtuYW1lOlwibWF4SW1wcm92ZW1lbnRcIiwgdmFsdWU6IHJvdW5kKG1heF9pbXByb3ZlbWVudCwgMil9XG4gICAgXVxuXG4gICAgaW5zaWdodDIgPSBgKiAke0xhbmcucmVkdWNlUmVwbGFjZVRlbXBsYXRlSXRlbXMoaW5zaWdodDJfdGVtcGxhdGUsIGluc2lnaHQyX3ZhbHVlcyl9YFxuICB9XG5cblxuICBsZXQgaW5zaWdodDMgPSBgKiAke19sYW5nKG5iVGV4dC5hZGFwdEZ1dHVyZUNoYW5nZS5pbnNpZ2h0Lmluc2lnaHQzKX1gXG4gIFxuICByZXR1cm4gbWRgXG4jIyMgJHt0aXRsZX1cbiR7aW5zaWdodDF9XG4ke2luc2lnaHQyfVxuJHtpbnNpZ2h0M31gXG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTIzIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoibWRgIyAke19sYW5nKG5iVGV4dC5zdW1tYXJ5LnRpdGxlKX1gO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0yNCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InN1bW1hcnlfdGV4dCA9IHtcbiAgbGV0IHZhbHNfd2l0aG91dF9hZGFwdCA9IHF1aWNrX2luc2lnaHRzX3Byb2plY3RlZF8yLmZpbHRlcihkID0+IGQuY3JvcHMubGVuZ3RoID09IDQpLm1hcChkID0+IGQud2l0aG91dF9hZGFwdGF0aW9uKTtcbiAgbGV0IGF2ZyA9IGF2ZXJhZ2UodmFsc193aXRob3V0X2FkYXB0KTtcbiAgbGV0IHRlbXBsYXRlX2luc2lnaHQxID0gX2xhbmcobmJUZXh0LnN1bW1hcnkudGV4dDEpXG4gIGxldCBpbnNpZ2h0MSA9IExhbmcucmVkdWNlUmVwbGFjZVRlbXBsYXRlSXRlbXModGVtcGxhdGVfaW5zaWdodDEsIFt7bmFtZTpcImF2Z19sb3NzXCIsIHZhbHVlOiByb3VuZChhdmcsIDIpfV0pXG4gIC8vIGxldCBpbnNpZ2h0cyA9IGBDbGltYXRlIGNoYW5nZSB3aXRob3V0IGFkYXB0YXRpb24gaW1wbGllcyBhIHJlZHVjdGlvbiBvZiAke3JvdW5kKGF2ZywgMil9JSBpbiB0aGUgc3VwcGx5IG9mIGNlcmVhbCBncmFpbnMgaW4gU3ViLVNhaGFyYW4gQWZyaWNhLmBcbiAgbGV0IGluc2lnaHQyID0gJydcbiAgaWYgKGFkbWluU2VsZWN0aW9ucy5zZWxlY3RBZG1pbjAgIT0gbnVsbCAmJiBoaWdobGlnaHRlZF9kYXRhLmxlbmd0aCA+IDApe1xuICAgIGNvbnN0IHNlbGVjdGVkX2dlbyA9IGdldF9zZWxlY3RlZF9hZG1pbl9hdGZjKCk7XG4gICAgbGV0IGJldHRlcl90aGFuX25vX2FkcHQgPSBnZXRfYWRwdF9vcHRpb25zX2hpZ2hlcl95aWVsZF90aGFuX25vX2FkYXB0YXRpb24oaGlnaGxpZ2h0ZWRfZGF0YSk7XG4gICAgbGV0IG51bV9vcHRpb25zX2JldHRlcl90aGFuX25vX2FwdCA9IGJldHRlcl90aGFuX25vX2FkcHQubGVuZ3RoO1xuICAgIGxldCBsb3dlcl9iZXN0ID0gcm91bmQoTWF0aC5taW4oLi4uYmV0dGVyX3RoYW5fbm9fYWRwdC5tYXAoZCA9PiBkW1wiMjA1MFwiXSkpLCAyKTtcbiAgICBsZXQgdXBwZXJfYmVzdCA9IHJvdW5kKE1hdGgubWF4KC4uLmJldHRlcl90aGFuX25vX2FkcHQubWFwKGQgPT4gZFtcImhpc3RvcmljYWxcIl0pKSwgMik7XG4gICAgXG4gICAgLy8gU2VsZWN0IHRvcCAzIG9yIGxlc3NcbiAgICBjb25zdCB0b3AgPSBNYXRoLm1pbiguLi5bMywgYmV0dGVyX3RoYW5fbm9fYWRwdC5sZW5ndGhdKTtcbiAgICBjb25zdCBiZXN0X29wdGlvbnMgPSBbXTtcbiAgICBsZXQgbWF4X2ltcHJvdmVtZW50ID0gMDtcbiAgICBmb3IobGV0IGogPSAwOyBqIDwgdG9wOyBqICsrKXtcbiAgICAgIGxldCBvcHRpb24gPSBfbGFuZyhuYlRleHQuc3VtbWFyeS5hZGFwdGF0aW9uT3B0aW9uc1tiZXR0ZXJfdGhhbl9ub19hZHB0W2pdLm9wdGlvbl0pXG4gICAgICBiZXN0X29wdGlvbnMucHVzaChvcHRpb24pO1xuICAgICAgbWF4X2ltcHJvdmVtZW50ID0gTWF0aC5tYXgoYmV0dGVyX3RoYW5fbm9fYWRwdFtqXS5oaXN0b3JpY2FsLCBtYXhfaW1wcm92ZW1lbnQpO1xuICAgIH1cbiAgICBsZXQgdGVtcGxhdGVfaW5zaWdodDIgPSBfbGFuZyhuYlRleHQuc3VtbWFyeS50ZXh0MilcbiAgICBsZXQgdmFsdWVzX2luc2lnaHQyID0gW1xuICAgICAge25hbWU6XCJzZWxlY3RlZEdlb1wiLCB2YWx1ZTogX2xhbmcobmJUZXh0LmdlbmVyYWwuY291bnRyaWVzX2FydGljbGVbc2VsZWN0ZWRfZ2VvLmhpZ2hsaWdodF0pfSxcbiAgICAgIHtuYW1lOlwiYmVzdE9wdGlvbnNcIiwgdmFsdWU6IGJlc3Rfb3B0aW9ucy5qb2luKFwiLCBcIil9XG4gICAgXVxuICAgIGluc2lnaHQyID0gTGFuZy5yZWR1Y2VSZXBsYWNlVGVtcGxhdGVJdGVtcyh0ZW1wbGF0ZV9pbnNpZ2h0MiwgdmFsdWVzX2luc2lnaHQyKVxuICB9XG4gIHJldHVybiBtZGBcbiR7aW5zaWdodDF9XG5cbiR7aW5zaWdodDJ9YCBcbiAgXG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTI1IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoibWRgIyAke19sYW5nKG5iVGV4dC5NZXRob2RzU291cmNlcy50aXRsZSl9YDtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMjYiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJtZGAjIyAke19sYW5nKG5iVGV4dC5NZXRob2RzU291cmNlcy5zb3VyY2VzLnRpdGxlKX1gO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0yNyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Im1kYCMjIyAke19sYW5nKG5iVGV4dC5NZXRob2RzU291cmNlcy5zb3VyY2VzLmNyb3BZaWVsZERCLnRpdGxlKX1cblxuJHtfbGFuZyhuYlRleHQuTWV0aG9kc1NvdXJjZXMuc291cmNlcy5jcm9wWWllbGREQi50ZXh0KX1gO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0yOCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Im1kYCMjIyAke19sYW5nKG5iVGV4dC5NZXRob2RzU291cmNlcy5zb3VyY2VzLmNyb3BZaWVsZFByb2plY3Rpb25zLnRpdGxlKX1cblxuJHtfbGFuZyhuYlRleHQuTWV0aG9kc1NvdXJjZXMuc291cmNlcy5jcm9wWWllbGRQcm9qZWN0aW9ucy50ZXh0KX1gO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0yOSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Im1kYCMjIyAke19sYW5nKG5iVGV4dC5NZXRob2RzU291cmNlcy5zb3VyY2VzLmhhcnZlc3RlZEFyZWEudGl0bGUpfVxuXG4ke19sYW5nKG5iVGV4dC5NZXRob2RzU291cmNlcy5zb3VyY2VzLmhhcnZlc3RlZEFyZWEudGV4dCl9YDtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMzAiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJtZGAjIyMgJHtfbGFuZyhuYlRleHQuTWV0aG9kc1NvdXJjZXMuc291cmNlcy5ib3VuZGFyaWVzLnRpdGxlKX1cblxuJHtfbGFuZyhuYlRleHQuTWV0aG9kc1NvdXJjZXMuc291cmNlcy5ib3VuZGFyaWVzLnRleHQpfWA7XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTMxIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoibWRgIyMgJHtfbGFuZyhuYlRleHQuTWV0aG9kc1NvdXJjZXMubWV0aG9kcy50aXRsZSl9YDtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMzIiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJtZGAjIyMgJHtfbGFuZyhuYlRleHQuTWV0aG9kc1NvdXJjZXMubWV0aG9kcy5iZWVzd2FybS50aXRsZSl9XG5cbiR7X2xhbmcobmJUZXh0Lk1ldGhvZHNTb3VyY2VzLm1ldGhvZHMuYmVlc3dhcm0udGV4dCl9YDtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMzMiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJtZGAjIyMgJHtfbGFuZyhuYlRleHQuTWV0aG9kc1NvdXJjZXMubWV0aG9kcy5tYXBwaW5nSGlzdG9yaWNhbEZ1dHVyZS50aXRsZSl9XG5cbiR7X2xhbmcobmJUZXh0Lk1ldGhvZHNTb3VyY2VzLm1ldGhvZHMubWFwcGluZ0hpc3RvcmljYWxGdXR1cmUudGV4dCl9YDtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMzQiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJtZGAjIyMgJHtfbGFuZyhuYlRleHQuTWV0aG9kc1NvdXJjZXMubWV0aG9kcy5hZGFwdGF0aW9uQW5hbHlzaXMudGl0bGUpfVxuXG4ke19sYW5nKG5iVGV4dC5NZXRob2RzU291cmNlcy5tZXRob2RzLmFkYXB0YXRpb25BbmFseXNpcy50ZXh0KX1gO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0zNSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Im1kYCMjICR7X2xhbmcobmJUZXh0Lk1ldGhvZHNTb3VyY2VzLm1ldGhvZHMucmVmZXJlbmNlcy50aXRsZSl9XG5cbi0gQWxpbWFnaGFtLCBTLiBldCBhbC4gKDIwMjQpIENsaW1hdGUgY2hhbmdlIGltcGFjdCBhbmQgYWRhcHRhdGlvbiBvZiByYWluZmVkIGNlcmVhbCBjcm9wcyBpbiBzdWItU2FoYXJhbiBBZnJpY2EuIEV1cm9wZWFuIEpvdXJuYWwgb2YgQWdyb25vbXkgMTU1ICgxMjcxMzcpLCBbZG9pOjEwLjEwMTYvai5lamEuMjAyNC4xMjcxMzddKGh0dHBzOi8vZG9pLm9yZy8xMC4xMDE2L2ouZWphLjIwMjQuMTI3MTM3KVxuLSBIYXNlZ2F3YSwgVC4sIFdha2F0c3VraSwgSC4sIEp1LCBILiBldCBhbC4gKDIwMjIpIEEgZ2xvYmFsIGRhdGFzZXQgZm9yIHRoZSBwcm9qZWN0ZWQgaW1wYWN0cyBvZiBjbGltYXRlIGNoYW5nZSBvbiBmb3VyIG1ham9yIGNyb3BzLiBTY2kgRGF0YSA5LCA1OC4gW2RvaToxMC4xMDM4L3M0MTU5Ny0wMjItMDExNTAtN10oaHR0cHM6Ly9kb2kub3JnLzEwLjEwMzgvczQxNTk3LTAyMi0wMTE1MC03KVxuLSBZdSwgUS4sIFlvdSwgTC4sIFdvb2QtU2ljaHJhLCBVLiwgZXQgYWwuICgyMDIwKSBBIGN1bHRpdmF0ZWQgcGxhbmV0IGluIDIwMTA6IDIuIHRoZSBnbG9iYWwgZ3JpZGRlZCBhZ3JpY3VsdHVyYWwgcHJvZHVjdGlvbiBtYXBzLCBFYXJ0aCBTeXN0LiBTY2kuIERhdGEgRGlzY3Vzcy4sIDIwMjAuIFtkb2k6MTAuNTE5NC9lc3NkLTIwMjAtMTFdKGh0dHBzOi8vZG9pLm9yZy8xMC41MTk0L2Vzc2QtMjAyMC0xMSlgO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0zNiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IntcbiAgcmV0dXJuIG1kYC0tLVxuIyMgV29yayBieSBUb3BpY1xuKkNlbGxzIHRoYXQgcG93ZXIgZGlmZmVyZW50IHNlY3Rpb25zKmBcbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMzciLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ7XG4gIHJldHVybiBtZGAtLS1cbiMjIyBTdXBwb3J0IG5vdGVib29rXG5bU3VwcG9ydCBOb3RlYm9va10oaHR0cHM6Ly9vYnNlcnZhYmxlaHEuY29tL0BwZXJpc2NvcGljL2FiLWF0bGFzLXNwb3RsaWdodC1zdXBwb3J0KTogdXNlZCBmb3IgaW1wb3J0cyBhY3Jvc3Mgc3BvdGxpZ2h0cy5gXG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTM4IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoie1xuICByZXR1cm4gbWRgLS0tXG4jIyMgTm90ZWJvb2sgVmFyaWFibGVzXG5fTWFpbiB2YXJpYWJsZXMgYWNyb3NzIG5vdGVib29rX2Bcbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMzkiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiIvLyBtYWluIHRpdGxlIG9mIHRoZSBub3RlYm9va1xubm90ZWJvb2tUaXRsZSA9IF9sYW5nKHtcbiAgZW46IFwiVmlldyBQcm9qZWN0ZWQgQ2xpbWF0ZSBJbXBhY3RzXCIsXG4gIGZyOiBcIlZpc3VhbGlzZXIgbGVzIHByb2plY3Rpb25zIGTigJkgaW1wYWN0cyBjbGltYXRpcXVlc1wiLFxufSk7XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTQwIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiLy8gaW5mbyBmb3IgdGhlIGFkbWluIHNlbGVjdG9yc1xuYWRtaW5SZWdpb25zID0ge1xuICByZXR1cm4ge1xuICAgIGxhYmVsczoge1xuICAgICAgYWRtaW4wOiAnQ291bnRyeScsXG4gICAgICBhZG1pbjE6ICdSZWdpb24nLFxuICAgICAgYWRtaW4yOiAnU3VicmVnaW9uJ1xuICAgIH1cbiAgfTtcbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNDEiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJmdW5jdGlvbiBnZXRMb3dlckxldmVsQWRtaW5MYWJlbChzZWxlY3Rpb25zID0gYWRtaW5TZWxlY3Rpb25zKSB7XG4gIC8vIGJhc2VkIG9uIGFkbWluIHNlbGVjdGlvbiwgZ2V0IHRoZSBsb3dlciBsZXZlbCBsYWJlbFxuICBpZiAoc2VsZWN0aW9ucy5zZWxlY3RBZG1pbjIpIHJldHVybiBfbGFuZyhuYlRleHQuZ2VuZXJhbC5zdWJSZWdpb24pO1xuICBpZiAoc2VsZWN0aW9ucy5zZWxlY3RBZG1pbjEpIHJldHVybiBfbGFuZyhuYlRleHQuZ2VuZXJhbC5zdWJSZWdpb24pO1xuICBpZiAoc2VsZWN0aW9ucy5zZWxlY3RBZG1pbjApIHJldHVybiBfbGFuZyhuYlRleHQuZ2VuZXJhbC5yZWdpb24pO1xuICBlbHNlIHJldHVybiBfbGFuZyhuYlRleHQuZ2VuZXJhbC5jb3VudHJ5KTtcbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNDIiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiIvLyB3aWR0aCBvZiB0aGUgbWFwc1xubWFwV2lkdGggPSA2MjU7XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTQzIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoibWRgIyMjIExhbmd1YWdlIGFuZCBUcmFuc2xhdGlvbiB0b29sc2A7XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTQ0IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiaW1wb3J0IHsgTGFuZyB9IGZyb20gXCI3ZDQ2Njc5ZjdkMGQ5MTdlXCI7XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTQ1IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiX2xhbmcgPSBMYW5nLmxnKGxhbmd1YWdlLmtleSk7XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTQ2IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoibGFuZ3VhZ2VzID0gW1xuICB7IGtleTogXCJlblwiLCBsYWJlbDogXCJFbmdsaXNoXCIsIGxvY2FsZTogXCJlbi1VU1wiIH0sXG4gIHsga2V5OiBcImZyXCIsIGxhYmVsOiBcIkZyYW7Dp2Fpc1wiLCBsb2NhbGU6IFwiZnItRlJcIiB9LFxuXTtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNDciLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJkZWZhdWx0TGFuZ0tleSA9IHtcbiAgY29uc3QgbmFtZSA9IFwibGFuZ1wiO1xuICBjb25zdCBsaXN0ID0gbGFuZ3VhZ2VzLm1hcCgoZCkgPT4gZC5rZXkpO1xuICBjb25zdCBkZWZhdWx0S2V5ID0gXCJlblwiO1xuXG4gIGNvbnN0IHF1ZXJ5UGFyYW0gPSBhd2FpdCBMYW5nLmdldFBhcmFtRnJvbUxpc3QoeyBuYW1lLCBsaXN0IH0pO1xuXG4gIHJldHVybiBxdWVyeVBhcmFtID8/IGRlZmF1bHRLZXk7XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTQ4IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoidmlld29mIGxhbmd1YWdlID0gSW5wdXRzLnJhZGlvKGxhbmd1YWdlcywge1xuICBsYWJlbDogXCJNYWluIGxhbmd1YWdlIHRvZ2dsZVwiLFxuICBmb3JtYXQ6IChkKSA9PiBkLmtleSxcbiAgdmFsdWU6IGxhbmd1YWdlcy5maW5kKCh4KSA9PiB4LmtleSA9PT0gZGVmYXVsdExhbmdLZXkpLFxufSlcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNDkiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJuYlRleHQgPSBuZXcgT2JqZWN0KHtcbiAgdG9jOiB7XG4gICAgdGl0bGU6IHsgZW46IFwiSW4gdGhpcyBub3RlYm9va1wiLCBmcjogXCJEYW5zIGNlIG5vdGVib29rXCIgfSxcbiAgfSxcbiAgb3ZlcnZpZXc6IHtcbiAgICB0aXRsZTogeyBlbjogXCJPdmVydmlld1wiLCBmcjogXCJWdWUgZOKAmUVuc2VtYmxlXCIgfSxcbiAgICB0ZXh0OiB7XG4gICAgICBlbjogYFN1Yi1TYWhhcmFuIEFmcmljYeKAmXMgZ3JlYXRlc3QgY2hhbGxlbmdlIGlzIHRvIGJlIGFibGUgdG8gZmVlZCBhIHBvcHVsYXRpb24gb2YgMi4xIGJpbGxpb24gcGVvcGxlIGJ5IDIwNTAgKGFib3V0IDIuNXggbGFyZ2VyIHRoYW4gdG9kYXkpIGlkZWFsbHkgb24gdGhlIHNhbWUgYW1vdW50IG9mIGFyYWJsZSBsYW5kLCBhbmQgdW5kZXIgbGVzcyBob3NwaXRhYmxlIHdlYXRoZXIgY29uZGl0aW9ucyBkdWUgdG8gY2xpbWF0ZSBjaGFuZ2UuIEJ1dCBieSAyMDUwLCBtb3N0IG9mIHRoZSByZWdpb24gd2lsbCBleHBlcmllbmNlIGF0IGxlYXN0IDLCukMgd2FybWVyIHRlbXBlcmF0dXJlcy4gV2l0aG91dCBhZGFwdGF0aW9uLCBjbGltYXRlIGNoYW5nZSBjb3VsZCBoYXZlIGRpcmUgY29uc2VxdWVuY2VzIG9uIGZvb2Qgc3VwcGx5LCBpbiBwYXJ0aWN1bGFyIGJlY2F1c2Ugb3ZlciA5NSUgb2YgY3JvcCBwcm9kdWN0aW9uIGhhcHBlbnMgdW5kZXIgcmFpbmZlZCBjb25kaXRpb25zIGFuZCB3ZWF0aGVyIHZhcmlhYmlsaXR5IGRpY3RhdGVzIG1vcmUgdGhhbiBvbmUtdGhpcmQgb2YgeWVhci1vbi15ZWFyIHlpZWxkIGZsdWN0dWF0aW9ucy4gQ2VyZWFsIGdyYWlucyBpbmNsdWRpbmcgbWFpemUsIHNvcmdodW0sIHJpY2UsIG1pbGxldCwgYW5kIHdoZWF0IGFyZSBlc3BlY2lhbGx5IGltcG9ydGFudCBhcyB0aGV5IHByb3ZpZGUgNTAlIG9mIGRhaWx5IGNhbG9yaWMgaW50YWtlIGFjcm9zcyB0aGUgcmVnaW9uLiBJbiB0aGlzIG5vdGVib29rLCB1c2VycyBjYW4gaW52ZXN0aWdhdGUgdGhlIHByb2plY3RlZCByZWR1Y3Rpb25zIGluIHlpZWxkIGZvciBrZXkgY2VyZWFsIGNyb3BzIGFuZCB0aGUgYWRhcHRhdGlvbiBiZW5lZml0cyBvZiBzb21lIG9wdGlvbnMgZm9yIHNwZWNpZmljIGxvY2F0aW9ucy5gLFxuICAgICAgZnI6IGBMZSBwbHVzIGdyYW5kIGTDqWZpIGRlIGwnQWZyaXF1ZSBzdWJzYWhhcmllbm5lIGVzdCBkZSBwb3V2b2lyIG5vdXJyaXIgdW5lIHBvcHVsYXRpb24gZGUgMiwxIG1pbGxpYXJkcyBkZSBwZXJzb25uZXMgZCdpY2kgMjA1MCAoZW52aXJvbiAyLDUgZm9pcyBwbHVzIHF1J2F1am91cmQnaHVpKSwgaWTDqWFsZW1lbnQgc3VyIGxhIG3Dqm1lIHF1YW50aXTDqSBkZSB0ZXJyZXMgYXJhYmxlcywgZXQgZGFucyBkZXMgY29uZGl0aW9ucyBtw6l0w6lvcm9sb2dpcXVlcyBtb2lucyBob3NwaXRhbGnDqHJlcyBlbiByYWlzb24gZHUgY2hhbmdlbWVudCBjbGltYXRpcXVlLiBNYWlzIGQnaWNpIDIwNTAsIGxhIHBsdXBhcnQgZGUgbGEgcsOpZ2lvbiBjb25uYcOudHJhIGRlcyB0ZW1ww6lyYXR1cmVzIGF1IG1vaW5zIDLCukMgcGx1cyBjaGF1ZGVzLiBTYW5zIGFkYXB0YXRpb24sIGxlIGNoYW5nZW1lbnQgY2xpbWF0aXF1ZSBwb3VycmFpdCBhdm9pciBkZXMgY29uc8OpcXVlbmNlcyBkw6lzYXN0cmV1c2VzIHN1ciBsJ2FwcHJvdmlzaW9ubmVtZW50IGFsaW1lbnRhaXJlLCBub3RhbW1lbnQgcGFyY2UgcXVlIHBsdXMgZGUgOTUgJSBkZSBsYSBwcm9kdWN0aW9uIGFncmljb2xlIHNlIGZhaXQgc291cyBkZXMgY29uZGl0aW9ucyBkZSBjdWx0dXJlIHBsdXZpYWxlIGV0IHF1ZSBsYSB2YXJpYWJpbGl0w6kgY2xpbWF0aXF1ZSBkaWN0ZSBwbHVzIGQndW4gdGllcnMgZGVzIGZsdWN0dWF0aW9ucyBhbm51ZWxsZXMgZGVzIHJlbmRlbWVudHMuIExlcyBjw6lyw6lhbGVzLCBub3RhbW1lbnQgbGUgbWHDr3MsIGxlIHNvcmdobywgbGUgcml6LCBsZSBtaWxsZXQgZXQgbGUgYmzDqSwgc29udCBwYXJ0aWN1bGnDqHJlbWVudCBpbXBvcnRhbnRlcyBjYXIgZWxsZXMgZm91cm5pc3NlbnQgNTAgJSBkZSBsJ2FwcG9ydCBjYWxvcmlxdWUgcXVvdGlkaWVuIGRhbnMgdG91dGUgbGEgcsOpZ2lvbi4gRGFucyBjZSBub3RlYm9vaywgbGVzIHV0aWxpc2F0ZXVycyBwZXV2ZW50IGV4YW1pbmVyIGxlcyByw6lkdWN0aW9ucyBwcm9qZXTDqWVzIGRlcyByZW5kZW1lbnRzIHBvdXIgbGVzIHByaW5jaXBhbGVzIGN1bHR1cmVzIGPDqXLDqWFsacOocmVzIGV0IGxlcyBhdmFudGFnZXMgZGUgbCdhZGFwdGF0aW9uIGRlIGNlcnRhaW5lcyBvcHRpb25zIHBvdXIgZGVzIGxpZXV4IHNww6ljaWZpcXVlcy5gLFxuICAgIH0sXG4gIH0sXG4gIHJlZ2lvbmFsUGljdHVyZToge1xuICAgIHRpdGxlOiB7IGVuOiBcIlRoZSBSZWdpb25hbCBQaWN0dXJlXCIsIGZyOiBcIkxhIFNpdHVhdGlvbiBSw6lnaW9uYWxlXCIgfSxcbiAgICB0ZXh0OiB7XG4gICAgICBlbjogYFRoZSBiZWVzd2FybSBwbG90IHZpc3VhbGl6YXRpb24gYmVsb3cgaGVscHMgeW91IGV4cGxvcmUgY2xpbWF0ZSBjaGFuZ2UgaW1wYWN0cyBvbiBtYWl6ZSwgd2hlYXQsIHJpY2UsIGFuZCBzb3liZWFuIGZvciB2YXJpb3VzIHJlZ2lvbnMgaW4gU3ViLVNhaGFyYW4gQWZyaWNhLiBUaGUgaW1wYWN0cyBjYW4gYmUgbmF2aWdhdGVkIGJ5IGNyb3AgYW5kIGxldmVscyBvZiB3YXJtaW5nLCBhbmQgY2FuIGJlIHZpc3VhbGl6ZWQgd2l0aCBhZGFwdGF0aW9uIGFuZCB3aXRob3V0IGFkYXB0YXRpb24uYCxcbiAgICAgIGZyOiBgTGEgdmlzdWFsaXNhdGlvbiBlbiBkaWFncmFtbWUgZGUgbnVhZ2UgZGUgcG9pbnRzIGNpLWRlc3NvdXMgdm91cyBhaWRlIMOgIGV4cGxvcmVyIGxlcyBpbXBhY3RzIGR1IGNoYW5nZW1lbnQgY2xpbWF0aXF1ZSBzdXIgbGUgbWHDr3MsIGxlIGJsw6ksIGxlIHJpeiBldCBsZSBzb2phIHBvdXIgZGl2ZXJzZXMgcsOpZ2lvbnMgZCdBZnJpcXVlIHN1YnNhaGFyaWVubmUuIExlcyBpbXBhY3RzIHBldXZlbnQgw6p0cmUgZXhwbG9yw6lzIHBhciBjdWx0dXJlIGV0IHBhciBuaXZlYXV4IGRlIHLDqWNoYXVmZmVtZW50LCBldCBwZXV2ZW50IMOqdHJlIHZpc3VhbGlzw6lzIGF2ZWMgb3Ugc2FucyBhZGFwdGF0aW9uLmAsXG4gICAgfSxcbiAgICBzZWxlY3RvcnM6IHtcbiAgICAgIGNyb3BzOiB7XG4gICAgICAgIHRpdGxlOiB7IGVuOiBcIkNyb3BzXCIsIGZyOiBcIkN1bHR1cmVzXCIgfSxcbiAgICAgIH0sXG4gICAgICB3YXJtaW5nTGV2ZWw6IHtcbiAgICAgICAgdGl0bGU6IHsgZW46IFwiV2FybWluZyBMZXZlbCAo4oSDKVwiLCBmcjogXCJOaXZlYXUgZGUgcsOpY2hhdWZmZW1lbnQgKOKEgylcIiB9LFxuICAgICAgfSxcbiAgICAgIGFkYXB0YXRpb246IHtcbiAgICAgICAgdGl0bGU6IHsgZW46IFwiQWRhcHRhdGlvblwiLCBmcjogXCJBZGFwdGF0aW9uXCIgfSxcbiAgICAgICAgdmFsdWVzOiB7XG4gICAgICAgICAgWWVzOiB7IGVuOiBcIlllc1wiLCBmcjogXCJPdWlcIiB9LFxuICAgICAgICAgIE5vOiB7IGVuOiBcIk5vXCIsIGZyOiBcIk5vblwiIH0sXG4gICAgICAgICAgXCJBbGwgZGF0YVwiOiB7IGVuOiBcIkFsbCBkYXRhXCIsIGZyOiBcIlRvdXRlcyBsZXMgZG9ubsOpZXNcIiB9LFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICB9LFxuICAgIGJlZXN3YXJtOiB7XG4gICAgICB4QXhpczoge1xuICAgICAgICBlbjogXCJDbGltYXRlIGltcGFjdHMgcmVsYXRpdmUgdG8gMjAwNSAoJSlcIixcbiAgICAgICAgZnI6IFwiSW1wYWN0cyBjbGltYXRpcXVlcyBwYXIgcmFwcG9ydCDDoCAyMDA1ICglKVwiLFxuICAgICAgfSxcbiAgICAgIHlBeGlzOiB7IGVuOiBcIlVOIFJlZ2lvblwiLCBmcjogXCJSw6lnaW9uIE9OVVwiIH0sXG4gICAgICByZWdpb25zOiB7XG4gICAgICAgIGFsbDogeyBlbjogXCJBbGxcIiwgZnI6IFwiVG91c1wiIH0sXG4gICAgICAgIFdlc3Rlcm46IHsgZW46IFwiV2VzdGVyblwiLCBmcjogXCJPdWVzdFwiIH0sXG4gICAgICAgIFNvdXRoZXJuOiB7IGVuOiBcIlNvdXRoZXJuXCIsIGZyOiBcIlN1ZFwiIH0sXG4gICAgICAgIE5vcnRoZXJuOiB7IGVuOiBcIk5vcnRoZXJuXCIsIGZyOiBcIk5vcmRcIiB9LFxuICAgICAgICBFYXN0ZXJuOiB7IGVuOiBcIkVhc3Rlcm5cIiwgZnI6IFwiRXN0XCIgfSxcbiAgICAgICAgQ2VudHJhbDogeyBlbjogXCJDZW50cmFsXCIsIGZyOiBcIkNlbnRyYWxcIiB9LFxuICAgICAgfSxcbiAgICAgIGxlZ2VuZDoge1xuICAgICAgICBcIldpdGggYWRhcHRhdGlvblwiOiB7IGVuOiBcIldpdGggQWRhcHRhdGlvblwiLCBmcjogXCJBdmVjIEFkYXB0YXRpb25cIiB9LFxuICAgICAgICBcIldpdGhvdXQgYWRhcHRhdGlvblwiOiB7XG4gICAgICAgICAgZW46IFwiV2l0aG91dCBBZGFwdGF0aW9uXCIsXG4gICAgICAgICAgZnI6IFwiU2FucyBBZGFwdGF0aW9uXCIsXG4gICAgICAgIH0sXG4gICAgICAgIFllczogeyBlbjogXCJXaXRoIEFkYXB0YXRpb25cIiwgZnI6IFwiQXZlYyBBZGFwdGF0aW9uXCIgfSxcbiAgICAgICAgTm86IHsgZW46IFwiV2l0aG91dCBBZGFwdGF0aW9uXCIsIGZyOiBcIlNhbnMgQWRhcHRhdGlvblwiIH0sXG4gICAgICB9LFxuICAgIH0sXG4gICAgYmVlc3dhcm1JbnNpZ2h0OiB7XG4gICAgICB0aXRsZToge1xuICAgICAgICBlbjogYFF1aWNrIGluc2lnaHRzIGZvciA6OjpTZWxlY3RlZENyb3A6OjogYW5kIHdhcm1pbmcgbGV2ZWwgKDo6Ondhcm1pbmdMZXZlbDo6OilgLFxuICAgICAgICBmcjogYEFwZXLDp3VzIHJhcGlkZXMgcG91ciBsZXMgY3VsdHVyZXMgZGUgOjo6U2VsZWN0ZWRDcm9wOjo6IGV0IG5pdmVhdSBkZSByw6ljaGF1ZmZlbWVudCAoOjo6d2FybWluZ0xldmVsOjo6KWAsXG4gICAgICB9LFxuICAgICAgdGV4dDoge1xuICAgICAgICBpbnNpZ2h0MToge1xuICAgICAgICAgIGVuOiBgQXQgOjo6d2FybWluZ0xldmVsOjo6LCAqKjo6OmNyb3BzOjo6KiogaXMgcHJvamVjdGVkIHRvIGV4cGVyaWVuY2UgYSBtZWRpYW4geWllbGQgcmVkdWN0aW9uIG9mICoqOjo6eWllbGRSZWR1Y3Rpb246OjolKiogaWYgbm8gYWRhcHRhdGlvbiBhY3Rpb25zIGFyZSB0YWtlbmAsXG4gICAgICAgICAgZnI6IGDDgCA6Ojp3YXJtaW5nTGV2ZWw6OjosIGxlcyBjdWx0dXJlcyBzw6lsZWN0aW9ubsOpZXMgZGUgKio6Ojpjcm9wczo6OioqIGRldnJhaWVudCBjb25uYcOudHJlIHVuZSByw6lkdWN0aW9uIG3DqWRpYW5lIGRlcyByZW5kZW1lbnRzIGRlICoqOjo6eWllbGRSZWR1Y3Rpb246OjolKiogc2kgYXVjdW5lIG1lc3VyZSBkJ2FkYXB0YXRpb24gbidlc3QgcHJpc2UuYCxcbiAgICAgICAgfSxcbiAgICAgICAgaW5zaWdodDI6IHtcbiAgICAgICAgICBtYWluOiB7XG4gICAgICAgICAgICBlbjogYFRoZSBtb3N0IG5lZ2F0aXZlbHkgaW1wYWN0ZWQgcmVnaW9uIGlzIDo6Om1vc3RBZmZlY3RlZDo6OmAsXG4gICAgICAgICAgICBmcjogYExhIHLDqWdpb24gbGEgcGx1cyBuw6lnYXRpdmVtZW50IGltcGFjdMOpZSBlc3QgOjo6bW9zdEFmZmVjdGVkOjo6YCxcbiAgICAgICAgICB9LFxuICAgICAgICAgIG1vc3RBZmZlY3RlZDoge1xuICAgICAgICAgICAgZW46IGBUaGUgbW9zdCBuZWdhdGl2ZWx5IGltcGFjdGVkIHJlZ2lvbiBpcyAqKjo6Om1vc3RBZmZlY3RlZF9hZGFwdGF0aW9uOjo6Kiogd2l0aCBhZGFwdGF0aW9uIGFuZCAqKjo6Om1vc3RBZmZlY3RlZF9ub2FkYXB0YXRpb246OjoqKiB3aXRob3V0IGFkYXB0YXRpb25gLFxuICAgICAgICAgICAgZnI6IGBMYSByw6lnaW9uIGxhIHBsdXMgbsOpZ2F0aXZlbWVudCBpbXBhY3TDqWUgZXN0ICoqOjo6bW9zdEFmZmVjdGVkX2FkYXB0YXRpb246OjoqKiBhdmVjIGFkYXB0YXRpb24gZXQgKio6Ojptb3N0QWZmZWN0ZWRfbm9hZGFwdGF0aW9uOjo6Kiogc2FucyBhZGFwdGF0aW9uYCxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICBpbnNpZ2h0Mzoge1xuICAgICAgICAgIGNvbXBlbGxpbmc6IHtcbiAgICAgICAgICAgIGVuOiBgQWRhcHRhdGlvbiBjYW4gb2Zmc2V0IHRoZXNlIHByb2plY3RlZCA6Ojpsb3NzX2dhaW46Ojogd2l0aCB5aWVsZCBjaGFuZ2VzIHVuZGVyIGFkYXB0YXRpb24gYmVpbmcgKio6Ojp3aXRoQWRhcHRhdGlvbjo6OiUqKi5gLFxuICAgICAgICAgICAgZnI6IGBMJ2FkYXB0YXRpb24gcGV1dCBjb21wZW5zZXIgY2VzIHByb2plY3Rpb25zIGRlIHBlcnRlcyBhdmVjIGRlcyBjaGFuZ2VtZW50cyBkZSByZW5kZW1lbnQgc291cyBhZGFwdGF0aW9uIMOpdGFudCBkZSAqKjo6OndpdGhBZGFwdGF0aW9uOjo6JSoqLmAsXG4gICAgICAgICAgfSxcbiAgICAgICAgICBub3RDb21wZWxsaW5nOiB7XG4gICAgICAgICAgICBlbjogXCJObyBjb21wZWxsaW5nIGV2aWRlbmNlIG9mIGFkYXB0YXRpb24gYmVuZWZpdHMgZXhpc3RzIGluIG91ciBkYXRhXCIsXG4gICAgICAgICAgICBmcjogXCJBdWN1bmUgcHJldXZlIGNvbnZhaW5jYW50ZSBkZXMgYXZhbnRhZ2VzIGRlIGwnYWRhcHRhdGlvbiBuJ2V4aXN0ZSBkYW5zIG5vcyBkb25uw6llcy5cIixcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICAgIHJlZ2lvbnM6IHtcbiAgICAgICAgXCJXZXN0ZXJuIEFmcmljYVwiOiB7IGVuOiBcIldlc3Rlcm4gQWZyaWNhXCIsIGZyOiBcIkzigJlBZnJpcXVlIGRlIGzigJlPdWVzdFwiIH0sXG4gICAgICAgIFwiU291dGhlcm4gQWZyaWNhXCI6IHsgZW46IFwiU291dGhlcm4gQWZyaWNhXCIsIGZyOiBcIkzigJlBZnJpcXVlIGR1IFN1ZFwiIH0sXG4gICAgICAgIFwiTm9ydGhlcm4gQWZyaWNhXCI6IHsgZW46IFwiTm9ydGhlcm4gQWZyaWNhXCIsIGZyOiBcIkzigJlBZnJpcXVlIGR1IE5vcmRcIiB9LFxuICAgICAgICBcIkVhc3Rlcm4gQWZyaWNhXCI6IHsgZW46IFwiRWFzdGVybiBBZnJpY2FcIiwgZnI6IFwiTOKAmUFmcmlxdWUgZGUgbOKAmUVzdFwiIH0sXG4gICAgICAgIFwiQ2VudHJhbCBBZnJpY2FcIjogeyBlbjogXCJDZW50cmFsIEFmcmljYVwiLCBmcjogXCJM4oCZQWZyaXF1ZSBDZW50cmFsZVwiIH0sXG4gICAgICB9LFxuICAgIH0sXG4gIH0sXG4gIHpvb21Ub1N0YWJsZToge1xuICAgIHRpdGxlOiB7XG4gICAgICBlbjogXCJab29taW5nIEludG8gQWZyaWNh4oCZcyBTdGFwbGUgQ2VyZWFsIENyb3BzXCIsXG4gICAgICBmcjogXCJVbiB6b29tIHN1ciBsZXMgY3VsdHVyZXMgY8OpcsOpYWxpw6hyZXMgZGUgYmFzZSBlbiBBZnJpcXVlXCIsXG4gICAgfSxcbiAgICB0ZXh0OiB7XG4gICAgICBlbjogYEdsb2JhbCBhbmQgcmVnaW9uYWwgYXZlcmFnZXMgaGlkZSBhIG11Y2ggbW9yZSBudWFuY2VkIHN0b3J5IGFib3V0IGNsaW1hdGUgaW1wYWN0cyBvbiBjcm9wIHlpZWxkIGF0IG5hdGlvbmFsIGFuZCBzdWJuYXRpb25hbCBzY2FsZXMuIE1vcmVvdmVyLCBmdXR1cmUgc2NlbmFyaW9zIGFsc28gbWF0dGVyLCB3aXRoIHRoZSB0cmFqZWN0b3J5IG9mIGNsaW1hdGUgY2hhbmdlIGluZHVjaW5nIGRpZmZlcmVudCBsZXZlbHMgb2YgaW1wYWN0LiBUaGlzIHNlY3Rpb24gbmF2aWdhdGVzIHRocm91Z2ggY291bnRyeS1sZXZlbCBhbmQgd2l0aGluLWNvdW50cnkgdmFyaWF0aW9uIGluIHByb2plY3RlZCBpbXBhY3RzIG9uIGNyb3AgeWllbGQgdXNpbmcgY3JvcCBtb2RlbC1iYXNlZCBwcm9qZWN0aW9ucy5gLFxuICAgICAgZnI6IGBMZXMgbW95ZW5uZXMgbW9uZGlhbGVzIGV0IHLDqWdpb25hbGVzIG1hc3F1ZW50IHVuZSBoaXN0b2lyZSBiaWVuIHBsdXMgbnVhbmPDqWUgZGVzIGltcGFjdHMgY2xpbWF0aXF1ZXMgc3VyIGxlcyByZW5kZW1lbnRzIGRlcyBjdWx0dXJlcyDDoCBsJ8OpY2hlbGxlIG5hdGlvbmFsZSBldCBpbmZyYW5hdGlvbmFsZS4gRGUgcGx1cywgbGVzIHNjw6luYXJpb3MgZnV0dXJzIHNvbnQgw6lnYWxlbWVudCBpbXBvcnRhbnRzLCBsYSB0cmFqZWN0b2lyZSBkdSBjaGFuZ2VtZW50IGNsaW1hdGlxdWUgaW5kdWlzYW50IGRpZmbDqXJlbnRzIG5pdmVhdXggZCdpbXBhY3QuIENldHRlIHNlY3Rpb24gZXhwbG9yZSBsZXMgdmFyaWF0aW9ucyBhdSBuaXZlYXUgZGVzIHBheXMgZXQgw6AgbCdpbnTDqXJpZXVyIGRlcyBwYXlzIGNvbmNlcm5hbnQgbGVzIGltcGFjdHMgcHJvamV0w6lzIHN1ciBsZXMgcmVuZGVtZW50cyBkZXMgY3VsdHVyZXMgZW4gdXRpbGlzYW50IGRlcyBwcm9qZWN0aW9ucyBiYXPDqWVzIHN1ciBkZXMgbW9kw6hsZXMgZGUgY3VsdHVyZS5gLFxuICAgIH0sXG4gICAgc2VsZWN0b3JzOiB7XG4gICAgICBncm93U2Vhc29uOiB7XG4gICAgICAgIHRpdGxlOiB7IGVuOiBcIkdyb3dpbmcgU2Vhc29uXCIsIGZyOiBcIlNhaXNvbiBkZSBjcm9pc3NhbmNlXCIgfSxcbiAgICAgICAgdmFsdWVzOiB7XG4gICAgICAgICAgYm90aDogeyBlbjogXCJCb3RoIChBdmVyYWdlKVwiLCBmcjogXCJMZXMgZGV1eCAoTW95ZW5uZSlcIiB9LFxuICAgICAgICAgIGZpcnN0OiB7IGVuOiBcIkZpcnN0XCIsIGZyOiBcIlByZW1pw6hyZVwiIH0sXG4gICAgICAgICAgc2Vjb25kOiB7IGVuOiBcIlNlY29uZFwiLCBmcjogXCJEZXV4acOobWVcIiB9LFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICAgIFlpZWxkT3V0cHV0OiB7XG4gICAgICAgIHRpdGxlOiB7IGVuOiBcIllpZWxkIE91dHB1dFwiLCBmcjogXCJQcm9kdWN0aW9uIGRlIHJlbmRlbWVudFwiIH0sXG4gICAgICAgIHZhbHVlczoge1xuICAgICAgICAgIFwiWWllbGQgY2hhbmdlICh0b24vaGEpXCI6IHtcbiAgICAgICAgICAgIGVuOiBcIllpZWxkIGNoYW5nZSAodG9uL2hhKVwiLFxuICAgICAgICAgICAgZnI6IFwiQ2hhbmdlbWVudCBkZSByZW5kZW1lbnQgKHRvbm5lcy9oYSlcIixcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiWWllbGQgKHRvbi9oYSlcIjoge1xuICAgICAgICAgICAgZW46IFwiWWllbGQgKHRvbi9oYSlcIixcbiAgICAgICAgICAgIGZyOiBcIlJlbmRlbWVudCAodG9ubmVzL2hhKVwiLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJZaWVsZCBjaGFuZ2UgKCUpXCI6IHtcbiAgICAgICAgICAgIGVuOiBcIllpZWxkIGNoYW5nZSAoJSlcIixcbiAgICAgICAgICAgIGZyOiBcIkNoYW5nZW1lbnQgZGUgcmVuZGVtZW50ICglKVwiLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJVbmNlcnRhaW50eSBpbiB5aWVsZCAodG9uL2hhKVwiOiB7XG4gICAgICAgICAgICBlbjogXCJVbmNlcnRhaW50eSBpbiB5aWVsZCAodG9uL2hhKVwiLFxuICAgICAgICAgICAgZnI6IFwiSW5jZXJ0aXR1ZGUgZHUgcmVuZGVtZW50ICh0b25uZXMvaGEpXCIsXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICBDdWx0aXZhcjoge1xuICAgICAgICB0aXRsZTogeyBlbjogXCJDdWx0aXZhclwiLCBmcjogXCJDdWx0aXZhclwiIH0sXG4gICAgICAgIHZhbHVlczoge1xuICAgICAgICAgIGN1cnJlbnQ6IHsgZW46IFwiQ3VycmVudFwiLCBmcjogXCJBY3R1ZWxcIiB9LFxuICAgICAgICAgIGVhcmx5OiB7IGVuOiBcIkVhcmx5IG1hdHVyaXR5XCIsIGZyOiBcIk1hdHVyaXTDqSBwcsOpY29jZVwiIH0sXG4gICAgICAgICAgbGF0ZTogeyBlbjogXCJMYXRlIG1hdHVyaXR5XCIsIGZyOiBcIk1hdHVyaXTDqSB0YXJkaXZlXCIgfSxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICBsYXllcjoge1xuICAgICAgICB0aXRsZTogeyBlbjogXCJNYXAgTGF5ZXJcIiwgZnI6IFwiQ291Y2hlIGRlIGxhIGNhcnRlXCIgfSxcbiAgICAgICAgdmFsdWVzOiB7XG4gICAgICAgICAgcmFpbmZlZDoge1xuICAgICAgICAgICAgZW46IFwiTWVhbiByYWluZmVkIHBvdGVudGlhbCB5aWVsZFwiLFxuICAgICAgICAgICAgZnI6IFwiUmVuZGVtZW50IHBvdGVudGllbCBtb3llbiBlbiBjdWx0dXJlIHBsdXZpYWxlXCIsXG4gICAgICAgICAgfSxcbiAgICAgICAgICBpcnJpZ2F0ZWQ6IHtcbiAgICAgICAgICAgIGVuOiBcIk1lYW4gaXJyaWdhdGVkIHBvdGVudGlhbCB5aWVsZFwiLFxuICAgICAgICAgICAgZnI6IFwiUmVuZGVtZW50IHBvdGVudGllbCBtb3llbiBlbiBjdWx0dXJlIGlycmlndcOpZVwiLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgIH0sXG4gICAgTWFwSW5zaWdodDoge1xuICAgICAgdGl0bGU6IHtcbiAgICAgICAgZW46IFwiUXVpY2sgSW5zaWdodHMgZm9yIDo6Omdlb2dyYXBoeTo6OiwgdW5kZXIgOjo6c2NlbmFyaW9fc2VsZWN0aW9uOjo6IGZvciA6Ojpjcm9wX3NlbGVjdGlvbjo6OlwiLFxuICAgICAgICBmcjogXCJBcGVyw6d1IHJhcGlkZSBwb3VyIGxhIHLDqWdpb24gZGUgOjo6Z2VvZ3JhcGh5Ojo6LCBzb3VzIDo6OnNjZW5hcmlvX3NlbGVjdGlvbjo6OiBwb3VyIGxlcyBjdWx0dXJlcyBkZSA6Ojpjcm9wX3NlbGVjdGlvbjo6OlwiLFxuICAgICAgfSxcbiAgICAgIGluc2lnaHQxOiB7XG4gICAgICAgIC8vIGVuOiAgXCI6OjpnZW9ncmFwaHk6OjrigJlzIDo6OnNjZW5hcmlvX3NlbGVjdGlvbjo6OiA6Ojpjcm9wX3NlbGVjdGlvbjo6OiByYWluZmVkL2lycmlnYXRlZCA6Ojp5aWVsZF9zZWxlY3Rpb246OjogaXMgKio6Ojp2YWx1ZTo6OioqXCIsXG4gICAgICAgIGVuOiBcIlRoZSA6Ojp5aWVsZF9zZWxlY3Rpb246OjogZm9yICA6Ojpjcm9wX3NlbGVjdGlvbjo6OiBpcyAqKjo6OnZhbHVlOjo6KipcIixcbiAgICAgICAgZnI6IFwiTGUgY2hhbmdlbWVudCBkZSByZW5kZW1lbnQgZGVzIGN1bHR1cmVzIGRlIDo6OmNyb3Bfc2VsZWN0aW9uOjo6IGVuIGN1bHR1cmUgcGx1dmlhbGUgOjo6eWllbGRfc2VsZWN0aW9uOjo6IGVzdCBkZSAqKjo6OnZhbHVlOjo6KipcIixcbiAgICAgICAgLy8gZnI6ICBcIjo6Omdlb2dyYXBoeTo6OuKAmXMgOjo6c2NlbmFyaW9fc2VsZWN0aW9uOjo6IDo6OmNyb3Bfc2VsZWN0aW9uOjo6IHJhaW5mZWQvaXJyaWdhdGVkIDo6OnlpZWxkX3NlbGVjdGlvbjo6OiBpcyAqKjo6OnZhbHVlOjo6KipcIlxuICAgICAgfSxcbiAgICAgIGluc2lnaHQyOiB7XG4gICAgICAgIGVuOiBcIkEgY2xpbWF0ZSBjaGFuZ2Ugc2NlbmFyaW8gd2l0aCA6OjplbWlzc2lvbl9sZXZlbDo6OiBlbWlzc2lvbnMgYnkgKio6Ojpob3Jpem9uOjo6KiogaGFzIGEgKio6OjpjaGFuZ2VfdHlwZTo6OioqIGltcGFjdCBvbiB5aWVsZCBvZiA6OjppbXBhY3RfcGN0Ojo6ICA6OjpjaGFuZ2VfdW5pdDo6OlwiLFxuICAgICAgICBmcjogXCJVbiBzY8OpbmFyaW8gZGUgY2hhbmdlbWVudCBjbGltYXRpcXVlIGF2ZWMgZGVzIDo6OmVtaXNzaW9uX2xldmVsOjo6IGQnaWNpICoqOjo6aG9yaXpvbjo6OioqIGEgdW4gaW1wYWN0ICoqOjo6Y2hhbmdlX3R5cGU6OjoqKiBzdXIgbGUgcmVuZGVtZW50IGRlIDo6OmltcGFjdF9wY3Q6OjogIDo6OmNoYW5nZV91bml0Ojo6XCIsXG4gICAgICB9LFxuICAgICAgaW5zaWdodDM6IHtcbiAgICAgICAgZW46IFwiVGhlIHByb2plY3RlZCB5aWVsZCBjaGFuZ2VzIGFyaXNlIGZyb20gc2ltdWxhdGluZyB5aWVsZCB1bmRlciB2YXJpb3VzIHBsYXVzaWJsZSBmdXR1cmVzLCB3aGljaCBpbXBsaWVzIHVuY2VydGFpbnR5LiBBY2NvcmRpbmdseSwgdGhlIHJhbmdlIG9mIHByb2plY3RlZCBjaGFuZ2VzIGlzICoqOjo6bWluQ2hhbmdlOjo6JSoqIHRvICoqOjo6bWF4Q2hhbmdlOjo6JSoqIGFjcm9zcyB0aGUgY2xpbWF0ZSBtb2RlbHMgdXNlZFwiLFxuICAgICAgICBmcjogXCJMZXMgcHJvamVjdGlvbnMgZGUgY2hhbmdlbWVudHMgZGUgcmVuZGVtZW50IHLDqXN1bHRlbnQgZGUgbGEgc2ltdWxhdGlvbiBkdSByZW5kZW1lbnQgc291cyBkaXZlcnMgZnV0dXJzIHBsYXVzaWJsZXMsIGNlIHF1aSBpbXBsaXF1ZSB1bmUgaW5jZXJ0aXR1ZGUuIEVuIGNvbnPDqXF1ZW5jZSwgbOKAmWludGVydmFsbGUgZGUgcHJvamVjdGlvbiBkZSBjaGFuZ2VtZW50IGVzdCBkZSAqKjo6Om1pbkNoYW5nZTo6OiUqKiDDoCAqKjo6Om1heENoYW5nZTo6OiUqKiDDoCB0cmF2ZXJzIGxlcyBtb2TDqGxlcyBjbGltYXRpcXVlcyB1dGlsaXPDqXMuXCIsXG4gICAgICB9LFxuICAgICAgaW5zaWdodDQ6IHtcbiAgICAgICAgZW46IFwiQWNyb3NzIGFsbCBvZiBTdWItU2FoYXJhbiBBZnJpY2EsIDo6Omdlb2dyYXBoeTo6OiByYW5rcyA6OjpyYW5rOjo6IG91dCBvZiA6OjpudW06OjogOjo6YWRtaW5Mdmw6OjogYXQgdGhlIHNhbWUgbGV2ZWwsIHdpdGggcmVnYXJkIHRvIGFic29sdXRlIHlpZWxkIGNoYW5nZXNcIixcbiAgICAgICAgZnI6IFwiRGFucyB0b3V0ZSBsJ0FmcmlxdWUgc3Vic2FoYXJpZW5uZSwgOjo6Z2VvZ3JhcGh5Ojo6IHNlIGNsYXNzZSA6OjpyYW5rOjo6IHN1ciA6OjpudW06OjogYXUgbcOqbWUgbml2ZWF1LCBlbiBjZSBxdWkgY29uY2VybmUgbGVzIGNoYW5nZW1lbnRzIGFic29sdXMgZGUgcmVuZGVtZW50XCIsXG4gICAgICB9LFxuICAgIH0sXG4gIH0sXG4gIGFkYXB0RnV0dXJlQ2hhbmdlOiB7XG4gICAgdGl0bGU6IHtcbiAgICAgIGVuOiBcIkFkYXB0aW5nIFRvIFRoZSBGdXR1cmUgQ2hhbmdlc1wiLFxuICAgICAgZnI6IFwiUydhZGFwdGVyIGF1eCBjaGFuZ2VtZW50cyBmdXR1cnNcIixcbiAgICB9LFxuICAgIHRleHQ6IHtcbiAgICAgIGVuOiBgQWRhcHRhdGlvbiBpcyBubyBsb25nZXIgb3B0aW9uYWwsIGl0IGlzIGEgbXVzdC1kbyBmb3IgYWxsIFN1Yi1TYWhhcmFuIEFmcmljYW4gY291bnRyaWVzLiBUaGlzIHNlY3Rpb24gYWxsb3dzIGV4cGxvcmluZyBzb21lIGFkYXB0YXRpb24gc29sdXRpb25zLCBhbmQgdGhlaXIgc3BlY2lmaWMgYmVuZWZpdHMgYWNyb3NzIGFuZCB3aXRoaW4gY291bnRyaWVzIGluIHRoZSByZWdpb24uYCxcbiAgICAgIGZyOiBgTCdhZGFwdGF0aW9uIG4nZXN0IHBsdXMgb3B0aW9ubmVsbGUsIGVsbGUgZXN0IGluY29udG91cm5hYmxlIHBvdXIgdG91cyBsZXMgcGF5cyBkJ0FmcmlxdWUgc3Vic2FoYXJpZW5uZS4gQ2V0dGUgc2VjdGlvbiBwZXJtZXQgZCdleHBsb3JlciBjZXJ0YWluZXMgc29sdXRpb25zIGQnYWRhcHRhdGlvbiBldCBsZXVycyBhdmFudGFnZXMgc3DDqWNpZmlxdWVzIMOgIHRyYXZlcnMgbGVzIHBheXMgZXQgYXUgc2VpbiBkZXMgcGF5cyBkZSBsYSByw6lnaW9uLmAsXG4gICAgfSxcbiAgICBzZWxlY3RvcnM6IHtcbiAgICAgIHNvcnQ6IHtcbiAgICAgICAgdGl0bGU6IHsgZW46IFwiU29ydFwiLCBmcjogXCJUcmllclwiIH0sXG4gICAgICAgIHZhbHVlczoge1xuICAgICAgICAgIG5vQWRhcHQ6IHsgZW46IFwiTm8gYWRhcHRhdGlvblwiLCBmcjogXCJTYW5zIGFkYXB0YXRpb25cIiB9LFxuICAgICAgICAgIG1lYW5EaWZmOiB7IGVuOiBcIk1lYW4gZGlmZmVyZW5jZVwiLCBmcjogXCJEaWZmw6lyZW5jZSBtb3llbm5lXCIgfSxcbiAgICAgICAgICBhbHBoYWJldDogeyBlbjogXCJBbHBoYWJldGljYWxcIiwgZnI6IFwiQWxwaGFiw6l0aXF1ZVwiIH0sXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgY29uZmlkZW5jZToge1xuICAgICAgICB0aXRsZTogeyBlbjogXCJDb25maWRlbmNlIGludGVydmFsc1wiLCBmcjogXCJJbnRlcnZhbGxlcyBkZSBjb25maWFuY2VcIiB9LFxuICAgICAgICB2aXNpYmxlOiB7IGVuOiBcIlZpc2libGVcIiwgZnI6IFwiVmlzaWJsZVwiIH0sIC8vIEFkZGVkIGluIGV2ZW4gdGhvdWdoIHNhbWUgdG8gbWFrZSBhZGRpbmcvdXBkYXRpbmcgZWFzaWVyXG4gICAgICB9LFxuICAgIH0sXG4gICAgcGxvdDoge1xuICAgICAgeUF4aXM6IHtcbiAgICAgICAgXCJMYXRlIG1hdHVyaXR5LCBpcnJpZ2F0aW9uXCI6IHtcbiAgICAgICAgICBlbjogXCJMYXRlIG1hdHVyaXR5IC0gaXJyaWdhdGlvblwiLFxuICAgICAgICAgIGZyOiBcIk1hdHVyaXTDqSB0YXJkaXZlIC0gaXJyaWdhdGlvblwiLFxuICAgICAgICB9LFxuICAgICAgICBcIkN1cnJlbnQgY3VsdGl2YXIsIGlycmlnYXRpb25cIjoge1xuICAgICAgICAgIGVuOiBcIkN1cnJlbnQgY3VsdGl2YXIgLSBpcnJpZ2F0aW9uXCIsXG4gICAgICAgICAgZnI6IFwiQ3VsdGl2YXIgYWN0dWVsIC0gaXJyaWdhdGlvblwiLFxuICAgICAgICB9LFxuICAgICAgICBcIkVhcmx5IG1hdHVyaXR5LCBpcnJpZ2F0aW9uXCI6IHtcbiAgICAgICAgICBlbjogXCJFYXJseSBtYXR1cml0eSAtIGlycmlnYXRpb25cIixcbiAgICAgICAgICBmcjogXCJNYXR1cml0w6kgcHLDqWNvY2UgLSBpcnJpZ2F0aW9uXCIsXG4gICAgICAgIH0sXG4gICAgICAgIFwiTGF0ZSBtYXR1cml0eSwgbm8gaXJyaWdhdGlvblwiOiB7XG4gICAgICAgICAgZW46IFwiTGF0ZSBtYXR1cml0eSAtIG5vIGlycmlnYXRpb25cIixcbiAgICAgICAgICBmcjogXCJNYXR1cml0w6kgdGFyZGl2ZSAtIHNhbnMgaXJyaWdhdGlvblwiLFxuICAgICAgICB9LFxuICAgICAgICBcIk5vIGFkYXB0YXRpb25cIjogeyBlbjogXCJObyBhZGFwdGF0aW9uXCIsIGZyOiBcIlNhbnMgYWRhcHRhdGlvblwiIH0sXG4gICAgICAgIFwiRWFybHkgbWF0dXJpdHksIG5vIGlycmlnYXRpb25cIjoge1xuICAgICAgICAgIGVuOiBcIkVhcmx5IG1hdHVyaXR5IC0gbm8gaXJyaWdhdGlvblwiLFxuICAgICAgICAgIGZyOiBcIk1hdHVyaXTDqSBwcsOpY29jZSAtIHNhbnMgaXJyaWdhdGlvblwiLFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICAgIHhBeGlzOiB7XG4gICAgICAgIHRpdGxlOiB7IGVuOiBcIllpZWxkICh0b24vaGEpXCIsIGZyOiBcIlJlbmRlbWVudCAodG9ubmVzL2hhKVwiIH0sXG4gICAgICB9LFxuICAgICAgY2hhbm5lbHM6IHtcbiAgICAgICAgYWV6OiB7IGVuOiBcIkhvcml6b25cIiwgZnI6IFwiSG9yaXpvblwiIH0sXG4gICAgICAgIG5PYnM6IHsgZW46IFwiT2JzZXJ2YXRpb25zXCIsIGZyOiBcIk9ic2VydmF0aW9uc1wiIH0sXG4gICAgICAgIGRpZmY6IHsgZW46IFwiTWVhblwiLCBmcjogXCJNb3llbm5lXCIgfSwgLy8gV2FzIG1lYW4gZGlmZmVyZW5jZSBidXQgaXQgaXMgYWN0dWFsbCBqdXN0IG1lYW4gdmFsdWVcbiAgICAgICAgY29udHJvbDogeyBlbjogXCJNZWFuIGNvbnRyb2xcIiwgZnI6IFwiTW95ZW5uZSBkdSB0w6ltb2luXCIgfSxcbiAgICAgICAgcHJhYzogeyBlbjogXCJhZGFwdGF0aW9uXCIsIGZyOiBcIkFkYXB0YXRpb25cIiB9LFxuICAgICAgICBjaUxvdzoge1xuICAgICAgICAgIGVuOiBcIkxvd2VyIENvbmZpZGVuY2UgaW50ZXJ2YWxcIixcbiAgICAgICAgICBmcjogXCJJbnRlcnZhbGxlIGRlIGNvbmZpYW5jZSBpbmbDqXJpZXVyXCIsXG4gICAgICAgIH0sXG4gICAgICAgIGNpSGlnaDoge1xuICAgICAgICAgIGVuOiBcIlVwcGVyIENvbmZpZGVuY2UgaW50ZXJ2YWxcIixcbiAgICAgICAgICBmcjogXCJJbnRlcnZhbGxlIGRlIGNvbmZpYW5jZSBzdXDDqXJpZXVyXCIsXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgIH0sXG4gICAgaW5zaWdodDoge1xuICAgICAgdGl0bGU6IHtcbiAgICAgICAgZW46IFwiUXVpY2sgSW5zaWdodHMgZm9yIDo6Omdlb2dyYXBoeTo6OiwgOjo6c2NlbmFyaW9fbmFtZTo6OiBzY2VuYXJpbywgYW5kIDo6OmNyb3BfbmFtZTo6OlwiLFxuICAgICAgICBmcjogXCJBcGVyw6d1IHJhcGlkZSBwb3VyIGxhIHLDqWdpb24gZGUgOjo6Z2VvZ3JhcGh5Ojo6LCBzb3VzIDo6OnNjZW5hcmlvX25hbWU6OjogcG91ciBsZXMgY3VsdHVyZXMgZGUgOjo6Y3JvcF9uYW1lOjo6XCIsXG4gICAgICB9LFxuICAgICAgaW5zaWdodDE6IHtcbiAgICAgICAgZW46IFwiOjo6c2VsZWN0ZWRfZ2VvOjo6J3MgYWRhcHRhdGlvbiBhbmFseXNpcyBzaG93IHRoYXQgOjo6bnVtQmV0dGVyOjo6IG9wdGlvbnMgd291bGQgZ2VuZXJhdGUgeWllbGQgaW1wcm92ZW1lbnRzIGZvciBoaXN0b3JpY2FsIGFuZCBmdXR1cmUgcGVyaW9kcy4gVGhlc2UgaW1wcm92ZW1lbnRzIHZhcnkgYmV0d2VlbiA6Ojpsb3dlckJlc3Q6OjogKHRvbi9oYSkgdG8gOjo6dXBwZXJCZXN0Ojo6ICh0b24vaGEpIGNvbXBhcmVkIHRvIG5vIGFkYXB0YXRpb25cIixcbiAgICAgICAgZnI6IFwiTCdhbmFseXNlIGQnYWRhcHRhdGlvbiA6OjpzZWxlY3RlZF9nZW86OjogbW9udHJlIHF1ZSA6OjpudW1CZXR0ZXI6Ojogb3B0aW9ucyBnw6luw6lyZXJhaWVudCBkZXMgYW3DqWxpb3JhdGlvbnMgZGUgcmVuZGVtZW50IHBvdXIgbGVzIHDDqXJpb2RlcyBoaXN0b3JpcXVlcyBldCBmdXR1cmVzLiBDZXMgYW3DqWxpb3JhdGlvbnMgdmFyaWVudCBlbnRyZSA6Ojpsb3dlckJlc3Q6OjogKHRvbm5lcy9oYSkgLSA6Ojp1cHBlckJlc3Q6OjogKHRvbm5lcy9oYSkgcGFyIHJhcHBvcnQgw6AgbCdhYnNlbmNlIGQnYWRhcHRhdGlvbi5cIixcbiAgICAgIH0sXG4gICAgICBpbnNpZ2h0Mjoge1xuICAgICAgICBlbjogXCJBZGFwdGF0aW9uIG9wdGlvbnMgd2l0aCB0aGUgZ3JlYXRlc3QgYmVuZWZpdHMgaW5jbHVkZSA6OjpiZXN0T3B0aW9uczo6Oiwgd2hpY2ggdG9nZXRoZXIgY2FuIGdlbmVyYXRlIHlpZWxkIGdhaW5zIG9mIHVwIHRvIDo6Om1heEltcHJvdmVtZW50Ojo6IHRvbi9oYSBjb21wYXJlZCB0byBhIG5vIGFkYXB0YXRpb24gc2l0dWF0aW9uXCIsXG4gICAgICAgIGZyOiBcIkxlcyBvcHRpb25zIGQnYWRhcHRhdGlvbiBhdmVjIGxlcyBwbHVzIGdyYW5kcyBiw6luw6lmaWNlcyBpbmNsdWVudCA6OjpiZXN0T3B0aW9uczo6OiwgcXVpIGVuc2VtYmxlIHBldXZlbnQgZ8OpbsOpcmVyIGRlcyBnYWlucyBkZSByZW5kZW1lbnQgYWxsYW50IGp1c3F1J8OgIDo6Om1heEltcHJvdmVtZW50Ojo6ICh0b25uZS9oYSkgcGFyIHJhcHBvcnQgw6AgdW5lIHNpdHVhdGlvbiBzYW5zIGFkYXB0YXRpb24uXCIsXG4gICAgICB9LFxuICAgICAgaW5zaWdodDM6IHtcbiAgICAgICAgZW46IFwiRXhwbG9yZSBtb3JlIGFkYXB0YXRpb24gb3B0aW9ucyBmb3IgYSBncmVhdGVyIG51bWJlciBvZiBjcm9wcyBhbmQgc3lzdGVtcyBhdCBvdXIgbm90ZWJvb2sgb24gW09uLWZhcm0gU29sdXRpb25zIGZvciBUb2RheV0oaHR0cHM6Ly9vYnNlcnZhYmxlaHEuY29tL2QvNzUzOWZkMTZmNGZjNDBlMylcIixcbiAgICAgICAgZnI6IFwiRXhwbG9yZXogcGx1cyBkJ29wdGlvbnMgZCdhZGFwdGF0aW9uIHBvdXIgdW4gcGx1cyBncmFuZCBub21icmUgZGUgY3VsdHVyZXMgZXQgZGUgc3lzdMOobWVzIGRhbnMgbm90cmUgbm90ZWJvb2sgc3VyIFtsZXMgc29sdXRpb25zIGFncmljb2xlcyBwb3VyIGF1am91cmQnaHVpXShodHRwczovL29ic2VydmFibGVocS5jb20vZC83NTM5ZmQxNmY0ZmM0MGUzKVwiLFxuICAgICAgfSxcbiAgICB9LFxuICB9LFxuICBzdW1tYXJ5OiB7XG4gICAgdGl0bGU6IHsgZW46IFwiU3VtbWFyeVwiLCBmcjogXCJSw6lzdW3DqVwiIH0sXG4gICAgdGV4dDE6IHtcbiAgICAgIGVuOiBcIkNsaW1hdGUgY2hhbmdlIHdpdGhvdXQgYWRhcHRhdGlvbiBpbXBsaWVzIGEgcmVkdWN0aW9uIG9mIDo6OmF2Z19sb3NzOjo6JSBpbiB0aGUgc3VwcGx5IG9mIGNlcmVhbCBncmFpbnMgaW4gU3ViLVNhaGFyYW4gQWZyaWNhXCIsXG4gICAgICBmcjogXCJMZSBjaGFuZ2VtZW50IGNsaW1hdGlxdWUgc2FucyBhZGFwdGF0aW9uIGltcGxpcXVlIHVuZSByw6lkdWN0aW9uIGRlIDo6OmF2Z19sb3NzOjo6JSBkZSBsJ2FwcHJvdmlzaW9ubmVtZW50IGVuIGPDqXLDqWFsZXMgZW4gQWZyaXF1ZSBzdWJzYWhhcmllbm5lLlwiLFxuICAgIH0sXG4gICAgdGV4dDI6IHtcbiAgICAgIGVuOiBgU3BlY2lmaWNhbGx5IGluIDo6OnNlbGVjdGVkR2VvOjo6LCB0aGVzZSByZWR1Y3Rpb25zIHdvdWxkIGNvbWUgb24gdG9wIG9mIGFscmVhZHkgbG93IHlpZWxkcyBmcm9tIGluYWRlcXVhdGUgY3JvcCBtYW5hZ2VtZW50LiBBZGFwdGF0aW9uIGludmVzdG1lbnRzIHNob3VsZCB0YXJnZXQgKio6OjpiZXN0T3B0aW9uczo6OioqIHRvIHJlZHVjZSBkb3duc3RyZWFtIHJpc2tzIG9mIGZvb2QgaW5zZWN1cml0eSwgaHVuZ2VyLCBhbmQgcG92ZXJ0eSB0aGF0IG1heSBzdGVtIGZyb20gcHJvamVjdGVkIHlpZWxkIHJlZHVjdGlvbnMuYCxcbiAgICAgIGZyOiBgRW4gcGFydGljdWxpZXIgOjo6c2VsZWN0ZWRHZW86OjosIGNlcyByw6lkdWN0aW9ucyBzJ2Fqb3V0ZXJhaWVudCDDoCBkZXMgcmVuZGVtZW50cyBkw6lqw6AgZmFpYmxlcyBkdXMgw6AgdW5lIGdlc3Rpb24gaW5hZMOpcXVhdGUgZGVzIGN1bHR1cmVzLiBMZXMgaW52ZXN0aXNzZW1lbnRzIGRhbnMgbCdhZGFwdGF0aW9uIGRldnJhaWVudCBjaWJsZXIgICoqOjo6YmVzdE9wdGlvbnM6OjoqKiBwb3VyIHLDqWR1aXJlIGxlcyByaXNxdWVzIGVuIGF2YWwgZCdpbnPDqWN1cml0w6kgYWxpbWVudGFpcmUsIGRlIGZhaW0gZXQgZGUgcGF1dnJldMOpIHF1aSBwb3VycmFpZW50IGTDqWNvdWxlciBkZXMgcsOpZHVjdGlvbnMgZGUgcmVuZGVtZW50IHByb2pldMOpZXMuYCxcbiAgICB9LFxuICAgIGFkYXB0YXRpb25PcHRpb25zOiB7XG4gICAgICBcIkxhdGUgbWF0dXJpdHksIGlycmlnYXRpb25cIjoge1xuICAgICAgICBlbjogXCJsYXRlIG1hdHVyaXR5IHdpdGggaXJyaWdhdGlvblwiLFxuICAgICAgICBmcjogXCJtYXR1cml0w6kgdGFyZGl2ZSBhdmVjIGlycmlnYXRpb25cIixcbiAgICAgIH0sXG4gICAgICBcIkN1cnJlbnQgY3VsdGl2YXIsIGlycmlnYXRpb25cIjoge1xuICAgICAgICBlbjogXCJjdXJyZW50IGN1bHRpdmFyIHdpdGggaXJyaWdhdGlvblwiLFxuICAgICAgICBmcjogXCJjdWx0aXZhciBhY3R1ZWwgYXZlYyBpcnJpZ2F0aW9uXCIsXG4gICAgICB9LFxuICAgICAgXCJFYXJseSBtYXR1cml0eSwgaXJyaWdhdGlvblwiOiB7XG4gICAgICAgIGVuOiBcImVhcmx5IG1hdHVyaXR5IHdpdGggaXJyaWdhdGlvblwiLFxuICAgICAgICBmcjogXCJtYXR1cml0w6kgcHLDqWNvY2UgYXZlYyBpcnJpZ2F0aW9uXCIsXG4gICAgICB9LFxuICAgICAgXCJMYXRlIG1hdHVyaXR5LCBubyBpcnJpZ2F0aW9uXCI6IHtcbiAgICAgICAgZW46IFwibGF0ZSBtYXR1cml0eSB3aXRoIG5vIGlycmlnYXRpb25cIixcbiAgICAgICAgZnI6IFwibWF0dXJpdMOpIHRhcmRpdmUgc2FucyBpcnJpZ2F0aW9uXCIsXG4gICAgICB9LFxuICAgICAgXCJFYXJseSBtYXR1cml0eSwgbm8gaXJyaWdhdGlvblwiOiB7XG4gICAgICAgIGVuOiBcImVhcmx5IG1hdHVyaXR5IHdpdGggbm8gaXJyaWdhdGlvblwiLFxuICAgICAgICBmcjogXCJtYXR1cml0w6kgcHLDqWNvY2Ugc2FucyBpcnJpZ2F0aW9uXCIsXG4gICAgICB9LFxuICAgIH0sXG4gIH0sXG4gIE1ldGhvZHNTb3VyY2VzOiB7XG4gICAgdGl0bGU6IHsgZW46IFwiTWV0aG9kcyAmIFNvdXJjZXNcIiwgZnI6IFwiTcOpdGhvZGVzIGV0IHNvdXJjZXNcIiB9LFxuICAgIHNvdXJjZXM6IHtcbiAgICAgIHRpdGxlOiB7IGVuOiBcIkRhdGFzZXRzXCIsIGZyOiBcIkpldXggZGUgZG9ubsOpZXNcIiB9LFxuICAgICAgY3JvcFlpZWxkREI6IHtcbiAgICAgICAgdGl0bGU6IHtcbiAgICAgICAgICBlbjogXCJDcm9wIHlpZWxkIG1ldGEtYW5hbHlzaXMgZGF0YWJhc2VcIixcbiAgICAgICAgICBmcjogXCJCYXNlIGRlIGRvbm7DqWVzIGRlIG3DqXRhLWFuYWx5c2UgZGVzIHJlbmRlbWVudHMgZGVzIGN1bHR1cmVzXCIsXG4gICAgICAgIH0sXG4gICAgICAgIHRleHQ6IHtcbiAgICAgICAgICBlbjogYFRoZSBjcm9wIHlpZWxkIG1ldGEgYW5hbHlzaXMgZGF0YXNldCBpcyBmcm9tIFtIYXNlZ2F3YSBldCBhbC4gKDIwMjIpXShodHRwczovL2RvaS5vcmcvMTAuMTAzOC9zNDE1OTctMDIyLTAxMTUwLTcpLiBUaGlzIGRhdGFzZXQgY29tcGlsZXMgZXN0aW1hdGVzIG9mIGNsaW1hdGUgY2hhbmdlIGltcGFjdHMgb24gY3JvcCBwcm9kdWN0aXZpdHkgZGVyaXZlZCBmcm9tIGNyb3Agc2ltdWxhdGlvbnMgdW5kZXIgaGlzdG9yaWNhbCBhbmQgZnV0dXJlIGNsaW1hdGVzLCB3aXRoIGFuZCB3aXRob3V0IGFkYXB0YXRpb24uIFRoZSBjbGltYXRlIGNoYW5nZSBpbXBhY3QgZXN0aW1hdGVzIGFyZSBkZXJpdmVkIGZyb20gYSBjb21wcmVoZW5zaXZlIGxpdGVyYXR1cmUgcmV2aWV3IG9mIDIwMiBzdHVkaWVzIHB1Ymxpc2hlZCBiZXR3ZWVuIDE5ODQgYW5kIDIwMjAuIFRoZSBkYXRhc2V0IGluY2x1ZGVzIGEgdG90YWwgb2YgOCw3MDMgaW5kaXZpZHVhbCBzaW11bGF0aW9ucywgY292ZXJzIGZvdXIgY3JvcHMgKG1haXplLCByaWNlLCBzb3liZWFuLCBhbmQgd2hlYXQpLCBhbmQgZXh0ZW5kcyB0byA5MSBjb3VudHJpZXMgYWNyb3NzIHRoZSBnbG9iZS4gVGhlIGRhdGEgaW5jbHVkZSBjcm9wIHlpZWxkIGVzdGltYXRlcyB1bmRlciBoaXN0b3JpY2FsIGFuZCBmdXR1cmUgY2xpbWF0ZXMgKGZvciB2YXJpb3VzIGVtaXNzaW9ucyB0cmFqZWN0b3JpZXMpLCBjdXJyZW50IGFuZCBmdXR1cmUgdGVtcGVyYXR1cmUgYW5kIHByZWNpcGl0YXRpb24gbGV2ZWxzLCBhbmQgdGhlIHVzZSAob3Igbm90KSBvZiBhZGFwdGF0aW9uIG9wdGlvbnMuYCxcbiAgICAgICAgICBmcjogYExlIGpldSBkZSBkb25uw6llcyBkZSBtw6l0YS1hbmFseXNlIGRlcyByZW5kZW1lbnRzIGRlcyBjdWx0dXJlcyBwcm92aWVudCBkZSBbSGFzZWdhd2EgZXQgYWwuICgyMDIyKV0oaHR0cHM6Ly9kb2kub3JnLzEwLjEwMzgvczQxNTk3LTAyMi0wMTE1MC03KS4gQ2UgamV1IGRlIGRvbm7DqWVzIGNvbXBpbGUgZGVzIGVzdGltYXRpb25zIGRlcyBpbXBhY3RzIGR1IGNoYW5nZW1lbnQgY2xpbWF0aXF1ZSBzdXIgbGEgcHJvZHVjdGl2aXTDqSBkZXMgY3VsdHVyZXMgZMOpcml2w6llcyBkZSBzaW11bGF0aW9ucyBkZSBjdWx0dXJlcyBzb3VzIGNsaW1hdHMgaGlzdG9yaXF1ZXMgZXQgZnV0dXJzLCBhdmVjIGV0IHNhbnMgYWRhcHRhdGlvbi4gTGVzIGVzdGltYXRpb25zIGRlcyBpbXBhY3RzIGR1IGNoYW5nZW1lbnQgY2xpbWF0aXF1ZSBzb250IGTDqXJpdsOpZXMgZCd1bmUgcmV2dWUgY29tcGzDqHRlIGRlIGxhIGxpdHTDqXJhdHVyZSBkZSAyMDIgw6l0dWRlcyBwdWJsacOpZXMgZW50cmUgMTk4NCBldCAyMDIwLiBMZSBqZXUgZGUgZG9ubsOpZXMgaW5jbHV0IHVuIHRvdGFsIGRlIDggNzAzIHNpbXVsYXRpb25zIGluZGl2aWR1ZWxsZXMsIGNvdXZyZSBxdWF0cmUgY3VsdHVyZXMgKG1hw69zLCByaXosIHNvamEgZXQgYmzDqSksIGV0IHMnw6l0ZW5kIMOgIDkxIHBheXMgw6AgdHJhdmVycyBsZSBtb25kZS4gTGVzIGRvbm7DqWVzIGNvbXByZW5uZW50IGRlcyBlc3RpbWF0aW9ucyBkZXMgcmVuZGVtZW50cyBkZXMgY3VsdHVyZXMgc291cyBjbGltYXRzIGhpc3RvcmlxdWVzIGV0IGZ1dHVycyAocG91ciBkaXZlcnMgc2PDqW5hcmlvcyBkJ8OpbWlzc2lvbnMpLCBsZXMgbml2ZWF1eCBhY3R1ZWxzIGV0IGZ1dHVycyBkZSB0ZW1ww6lyYXR1cmUgZXQgZGUgcHLDqWNpcGl0YXRpb25zLCBldCBsJ3V0aWxpc2F0aW9uIChvdSBub24pIGRlcyBvcHRpb25zIGQnYWRhcHRhdGlvbi5gLFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICAgIGNyb3BZaWVsZFByb2plY3Rpb25zOiB7XG4gICAgICAgIHRpdGxlOiB7XG4gICAgICAgICAgZW46IFwiQ3JvcCB5aWVsZCBwcm9qZWN0aW9ucyBmb3IgY2VyZWFscyB1bmRlciBjbGltYXRlIGNoYW5nZSBhbmQgYWRhcHRhdGlvblwiLFxuICAgICAgICAgIGZyOiBcIlByb2plY3Rpb25zIGRlIHJlbmRlbWVudHMgZGVzIGPDqXLDqWFsZXMgc291cyBsJ2VmZmV0IGR1IGNoYW5nZW1lbnQgY2xpbWF0aXF1ZSBldCBkZSBsJ2FkYXB0YXRpb25cIixcbiAgICAgICAgfSxcbiAgICAgICAgdGV4dDoge1xuICAgICAgICAgIGVuOiBgVGhlIGhpc3RvcmljYWwgYW5kIGZ1dHVyZSBzaW11bGF0ZWQgY3JvcCB5aWVsZCBmb3IgbWFpemUsIHNvcmdodW0sIG1pbGxldCwgYW5kIHdoZWF0IHdlcmUgZGVyaXZlZCBmcm9tIHRoZSBbR2xvYmFsIFlpZWxkIEdhcCBBdGxhcyAoR1lHQSldKGh0dHBzOi8vd3d3LnlpZWxkZ2FwLm9yZy8pLiBUaGUgbWV0aG9kIGZvciBkZXJpdmluZyB0aGVzZSBkYXRhIGlzIGRlc2NyaWJlZCBieSBbQWxpbWFnaGFtIGV0IGFsLiAoMjAyNCldKGh0dHBzOi8vZG9pLm9yZy8xMC4xMDE2L2ouZWphLjIwMjQuMTI3MTM3KS4gSW4gYnJpZWYsIHRoZSBXT0ZPU1QgKFdvcmxkIEZvb2QgU3R1ZGllcykgY3JvcCBtb2RlbCBpcyB1c2VkIHRvIHNpbXVsYXRlIHdhdGVyLWxpbWl0ZWQgYW5kIHBvdGVudGlhbCAoaS5lLiwgaXJyaWdhdGVkKSBwcm9kdWN0aW9uIG9mIGVhY2ggb2YgdGhlIGZvdXIgY3JvcHMgYWNyb3NzIDEwOSByZWZlcmVuY2Ugd2VhdGhlciBzdGF0aW9uIGxvY2F0aW9ucyBpbiBTdWItU2FoYXJhbiBBZnJpY2EuIFRoZSBoaXN0b3JpY2FsIHdlYXRoZXIgZGF0YSAoMTk5NeKAkzIwMTQpIHdlcmUgZGVyaXZlZCBmcm9tIGxvY2FsIHdlYXRoZXIgc3RhdGlvbnMsIHdoZXJlYXMgdGhlIGZ1dHVyZSBjbGltYXRlIGRhdGEgZm9yIDIwMzAgKDIwMjEtMjA0MCkgYW5kIDIwNTAgKDIwNDHigJMyMDYwKSBhcmUgZnJvbSBiaWFzLWNvcnJlY3RlZCBHZW5lcmFsIENpcmN1bGF0aW9uIE1vZGVscyAoR0NNcykgZnJvbSB0aGUgQ29vcmRpbmF0ZWQgTW9kZWxsaW5nIEludGVyY29tcGFyaXNvbiBQcm9qZWN0LVBoYXNlIDYgKENNSVA2KS4gVGhlIEdDTXMgd2VyZSBHRkRMLUVTTTQsIElQU0wtQ002QS1MUiwgTVBJLUVTTTHigJMyLUhSLCBNUkktRVNNMuKAkzAsIGFuZCBVS0VTTTHigJMwLUxMLiBUd28gU2hhcmVkIFNvY2lvZWNvbm9taWMgUGF0aHdheXMgKFNTUHMpIHdlcmUgdXNlZCwgbmFtZWx5LCBTU1AzLTcuMCBhbmQgU1NQNS04LjUuIFRoZSBiaWFzIGNvcnJlY3Rpb24gb2YgdGhlIGZ1dHVyZSB3ZWF0aGVyIGRhdGEgdXNlcyB0aGUgZGVsdGEgbWV0aG9kLCBhcyBkb2N1bWVudGVkIGJ5IFtOYXZhcnJvLVJhY2luZXMgZXQgYWwuICgyMDIwKV0oaHR0cHM6Ly9kb2kub3JnLzEwLjEwMzgvczQxNTk3LTAxOS0wMzQzLTgpLiBDYXJib24gZGlveGlkZSAoQ08yKSBjb25jZW50cmF0aW9ucyB3ZXJlIHNwZWNpZmllZCBmb3IgZWFjaCBmdXR1cmUgc2NlbmFyaW8gYW5kIHRpbWUgcGVyaW9kLlxuXG5UaGUgY3JvcCBtb2RlbCBhbHNvIHJlcXVpcmVzIHNvaWwgYW5kIG1hbmFnZW1lbnQgKGN1bHRpdmFyLCBwbGFudGluZyBkYXRlcykgZGF0YSBhcyBpbnB1dHMuIFRoZXNlIGRhdGEgYXJlIGF2YWlsYWJsZSB0aHJvdWdoIHRoZSBHWUdBIHBvcnRhbC4gT3JpZ2luYWxseSwgdGhlc2UgZGF0YSBoYXZlIGJlZW4gY29sbGVjdGVkIGFuZCBldmFsdWF0ZWQgdGhyb3VnaCBhbiBleHRlbnNpdmUgbmV0d29yayBvZiBhZ3Jvbm9taXN0cyBhbmQgY3JvcCBtb2RlbGVycyB0aGF0IG1ha2UgcGFydCBvZiB0aGUgR1lHQSBwcm9qZWN0LiBDdWx0aXZhcnMgYXJlIHNwZWNpZmllZCB1c2luZyB0aGVybWFsIHRpbWVzIGRlcml2ZWQgZnJvbSBsb2NhbGx5IGF2YWlsYWJsZSBwbGFudGluZywgZmxvd2VyaW5nLCBhbmQgbWF0dXJpdHkgdGltZXMuIEluIGFkZGl0aW9uIHRvIGN1cnJlbnQgY3VsdGl2YXJzLCBzaW11bGF0aW9ucyBhcmUgYWxzbyBjb25kdWN0ZWQgZm9yIOKAmGxhdGUgbWF0dXJpdHnigJkgKDEyJSBsb25nZXIgdGhlcm1hbCB0aW1lKSBhbmQg4oCYZWFybHkgbWF0dXJpdHnigJkgKDEyJSBzaG9ydGVyIHRoZXJtYWwgdGltZSkgY3VsdGl2YXJzLiBTb2lsIGRhdGEgd2VyZSBvYnRhaW5lZCBmcm9tIHRoZSBBZnJpY2EgU29pbCBJbmZvcm1hdGlvbiBTZXJ2aWNlIChbQWZTSVNdKGh0dHBzOi8vd3d3LmlzcmljLm9yZy9wcm9qZWN0cy9hZnJpY2Etc29pbC1pbmZvcm1hdGlvbi1zZXJ2aWNlLWFmc2lzKSkuIEF0IGVhY2ggd2VhdGhlciBzdGF0aW9uIGxvY2F0aW9uLCBlc3RpbWF0ZXMgb2YgeWllbGQsIHBoZW5vbG9neSAocGxhbnRpbmcsIGZsb3dlcmluZywgaGFydmVzdCB0aW1lKSB3ZXJlIHVzZWQgaW50byBhIHJhbmRvbSBmb3Jlc3QgKFJGKSByZWdyZXNzb3IgdGhhdCBoZWxwZWQgY3JlYXRlIGV4dHJhcG9sYXRlZCBlc3RpbWF0ZXMgb2YgeWllbGQgYW5kIHBoZW5vbG9neSBhY3Jvc3MgdGhlIGVudGlyZXR5IG9mIFN1Yi1TYWhhcmFuIEFmcmljYSB1c2luZyBncmlkZGVkIHdlYXRoZXIgZGF0YSBmcm9tIGVsc2V3aGVyZSBpbiB0aGUgY29udGluZW50LiBUaGUgUkYgcmVncmVzc29yIGV4cGxhaW5zIG92ZXIgOTAlIG9mIHRoZSB2YXJpYW5jZSBpbiB0aGUgV09GT1NUIHNpbXVsYXRlZCB5aWVsZCwgdGVzdGVkIG91dCBvZiBzYW1wbGUgYWNyb3NzIHNjZW5hcmlvcyBhbmQgbG9jYXRpb25zLlxuXG5HWUdBIHNpbXVsYXRlZCBjcm9wIHlpZWxkIHJlcG9ydHMgdHdvIHR5cGVzIG9mIGFkYXB0YXRpb25zLCBuYW1lbHksIHNoaWZ0cyBpbiBjdWx0aXZhcnMsIGFuZCBpcnJpZ2F0aW9uLiBGb3IgY3VsdGl2YXJzLCBlYXJseSBhbmQgbGF0ZSBtYXR1cml0eSAoaW4gYWRkaXRpb24gdG8gY3VycmVudGx5IHVzZWQgY3VsdGl2YXJzKSBhcmUgcmVwb3J0ZWQuIEZvciBpcnJpZ2F0aW9uLCBhIGZ1bGx5IGlycmlnYXRlZCBjcm9wIG1vZGVsIHNpbXVsYXRpb24gaXMgYXZhaWxhYmxlLiBUaGUgZnVsbCBjb21iaW5hdG9yaWFsIChpLmUuLCBlYWNoIGN1bHRpdmFyIHdpdGggYW5kIHdpdGhvdXQgaXJyaWdhdGlvbikgb2YgdGhlc2UgaXMgYXZhaWxhYmxlLiBUaGlzIGFsbG93cyBleHBsb3JpbmcgZml2ZSBhZGFwdGF0aW9uIHNjZW5hcmlvcywgaW4gYWRkaXRpb24gdG8gdGhlIG5vIGFkYXB0YXRpb24gKGkuZS4sIHJhaW5mZWQsIGN1cnJlbnQgY3VsdGl2YXIpIHNjZW5hcmlvLiBBbGwgR1lHQSBkYXRhIGFyZSBhdmFpbGFibGUgYXQgIGh0dHBzOi8vd3d3LnlpZWxkZ2FwLm9yZy8uIFNwZWNpZmljIGxpY2Vuc2luZyBhcnJhbmdlbWVudHMgZGVwZW5kaW5nIG9uIHVzZXIgYW5kL29yIGluc3RpdHV0aW9uIHR5cGUgYXJlIGRlc2NyaWJlZCBbaGVyZV0oaHR0cHM6Ly93d3cueWllbGRnYXAub3JnL3dlYi9ndWVzdC9zdWJzY3JpcHRpb24tYW5kLXNlcnZpY2UpLmAsXG4gICAgICAgICAgZnI6IGBMZXMgcmVuZGVtZW50cyBoaXN0b3JpcXVlcyBldCBmdXR1cnMgc2ltdWzDqXMgcG91ciBsZSBtYcOvcywgbGUgc29yZ2hvLCBsZSBtaWxsZXQgZXQgbGUgYmzDqSBvbnQgw6l0w6kgZMOpcml2w6lzIGR1IFtHbG9iYWwgWWllbGQgR2FwIEF0bGFzIChHWUdBKV0oaHR0cHM6Ly93d3cueWllbGRnYXAub3JnLykuIExhIG3DqXRob2RlIHBvdXIgb2J0ZW5pciBjZXMgZG9ubsOpZXMgZXN0IGTDqWNyaXRlIHBhciBbQWxpbWFnaGFtIGV0IGFsLiAoMjAyNCldKGh0dHBzOi8vZG9pLm9yZy8xMC4xMDE2L2ouZWphLjIwMjQuMTI3MTM3KS4gRW4gcsOpc3Vtw6ksIGxlIG1vZMOobGUgZGUgY3VsdHVyZSBXT0ZPU1QgKFdvcmxkIEZvb2QgU3R1ZGllcykgZXN0IHV0aWxpc8OpIHBvdXIgc2ltdWxlciBsYSBwcm9kdWN0aW9uIHNvdXMgY29udHJhaW50ZSBoeWRyaXF1ZSBldCBsYSBwcm9kdWN0aW9uIHBvdGVudGllbGxlIChjJ2VzdC3DoC1kaXJlIGlycmlndcOpZSkgZGUgY2hhY3VuZSBkZXMgcXVhdHJlIGN1bHR1cmVzIGRhbnMgMTA5IHN0YXRpb25zIG3DqXTDqW9yb2xvZ2lxdWVzIGRlIHLDqWbDqXJlbmNlIGVuIEFmcmlxdWUgc3Vic2FoYXJpZW5uZS4gTGVzIGRvbm7DqWVzIG3DqXTDqW9yb2xvZ2lxdWVzIGhpc3RvcmlxdWVzICgxOTk1LTIwMTQpIHByb3ZpZW5uZW50IGRlIHN0YXRpb25zIG3DqXTDqW9yb2xvZ2lxdWVzIGxvY2FsZXMsIHRhbmRpcyBxdWUgbGVzIGRvbm7DqWVzIGNsaW1hdGlxdWVzIGZ1dHVyZXMgcG91ciAyMDMwICgyMDIxLTIwNDApIGV0IDIwNTAgKDIwNDEtMjA2MCkgcHJvdmllbm5lbnQgZGUgbW9kw6hsZXMgZGUgY2lyY3VsYXRpb24gZ8OpbsOpcmFsZSAoR0NNKSBjb3JyaWfDqXMgZGVzIGJpYWlzIGR1IHByb2pldCBkZSBjb21wYXJhaXNvbiBkZSBtb2TDqGxlcyBjb29yZG9ubsOpcyAtIFBoYXNlIDYgKENNSVA2KS4gTGVzIEdDTSB1dGlsaXPDqXMgw6l0YWllbnQgR0ZETC1FU000LCBJUFNMLUNNNkEtTFIsIE1QSS1FU00xLTItSFIsIE1SSS1FU00yLTAsIGV0IFVLRVNNMS0wLUxMLiBEZXV4IHRyYWplY3RvaXJlcyBzb2Npby3DqWNvbm9taXF1ZXMgcGFydGFnw6llcyAoU1NQKSBvbnQgw6l0w6kgdXRpbGlzw6llcywgw6Agc2F2b2lyIFNTUDMtNy4wIGV0IFNTUDUtOC41LiBMYSBjb3JyZWN0aW9uIGRlcyBiaWFpcyBkZXMgZG9ubsOpZXMgY2xpbWF0aXF1ZXMgZnV0dXJlcyB1dGlsaXNlIGxhIG3DqXRob2RlIGRlbHRhLCBjb21tZSBkb2N1bWVudMOpIHBhciBbTmF2YXJyby1SYWNpbmVzIGV0IGFsLiAoMjAyMCldKGh0dHBzOi8vZG9pLm9yZy8xMC4xMDM4L3M0MTU5Ny0wMTktMDM0My04KS4gTGVzIGNvbmNlbnRyYXRpb25zIGRlIGRpb3h5ZGUgZGUgY2FyYm9uZSAoQ08yKSDDqXRhaWVudCBzcMOpY2lmacOpZXMgcG91ciBjaGFxdWUgc2PDqW5hcmlvIGZ1dHVyIGV0IGNoYXF1ZSBww6lyaW9kZS5cblxuTGUgbW9kw6hsZSBkZSBjdWx0dXJlIG7DqWNlc3NpdGUgw6lnYWxlbWVudCBkZXMgZG9ubsOpZXMgc3VyIGxlIHNvbCBldCBsYSBnZXN0aW9uIChjdWx0aXZhciwgZGF0ZXMgZGUgcGxhbnRhdGlvbikgY29tbWUgZW50csOpZXMuIENlcyBkb25uw6llcyBzb250IGRpc3BvbmlibGVzIHZpYSBsZSBwb3J0YWlsIEdZR0EuIMOAIGwnb3JpZ2luZSwgY2VzIGRvbm7DqWVzIG9udCDDqXTDqSBjb2xsZWN0w6llcyBldCDDqXZhbHXDqWVzIGdyw6JjZSDDoCB1biB2YXN0ZSByw6lzZWF1IGQnYWdyb25vbWVzIGV0IGRlIG1vZMOpbGlzYXRldXJzIGRlIGN1bHR1cmVzIGZhaXNhbnQgcGFydGllIGR1IHByb2pldCBHWUdBLiBMZXMgY3VsdGl2YXJzIHNvbnQgc3DDqWNpZmnDqXMgZW4gdXRpbGlzYW50IGxlcyB0ZW1wcyB0aGVybWlxdWVzIGTDqXJpdsOpcyBkZXMgcMOpcmlvZGVzIGRlIHBsYW50YXRpb24sIGRlIGZsb3JhaXNvbiBldCBkZSBtYXR1cml0w6kgZGlzcG9uaWJsZXMgbG9jYWxlbWVudC4gRW4gcGx1cyBkZXMgY3VsdGl2YXJzIGFjdHVlbHMsIGRlcyBzaW11bGF0aW9ucyBzb250IMOpZ2FsZW1lbnQgZWZmZWN0dcOpZXMgcG91ciBkZXMgY3VsdGl2YXJzIGRlIFwibWF0dXJpdMOpIHRhcmRpdmVcIiAodGVtcHMgdGhlcm1pcXVlIDEyJSBwbHVzIGxvbmcpIGV0IGRlIFwibWF0dXJpdMOpIHByw6ljb2NlXCIgKHRlbXBzIHRoZXJtaXF1ZSAxMiUgcGx1cyBjb3VydCkuIExlcyBkb25uw6llcyBzdXIgbGVzIHNvbHMgb250IMOpdMOpIG9idGVudWVzIGF1cHLDqHMgZHUgc2VydmljZSBkJ2luZm9ybWF0aW9uIHN1ciBsZXMgc29scyBlbiBBZnJpcXVlIChbQWZTSVNdKGh0dHBzOi8vd3d3LmlzcmljLm9yZy9wcm9qZWN0cy9hZnJpY2Etc29pbC1pbmZvcm1hdGlvbi1zZXJ2aWNlLWFmc2lzKSkuIMOAIGNoYXF1ZSBzdGF0aW9uIG3DqXTDqW9yb2xvZ2lxdWUsIGxlcyBlc3RpbWF0aW9ucyBkZSByZW5kZW1lbnQgZXQgZGUgcGjDqW5vbG9naWUgKHBsYW50YXRpb24sIGZsb3JhaXNvbiwgcsOpY29sdGUpIG9udCDDqXTDqSB1dGlsaXPDqWVzIGRhbnMgdW4gcsOpZ3Jlc3NpZiBwYXIgZm9yw6p0IGFsw6lhdG9pcmUgKFJGKSBxdWkgYSBwZXJtaXMgZGUgY3LDqWVyIGRlcyBlc3RpbWF0aW9ucyBleHRyYXBvbMOpZXMgZGUgcmVuZGVtZW50IGV0IGRlIHBow6lub2xvZ2llIHBvdXIgbCdlbnNlbWJsZSBkZSBsJ0FmcmlxdWUgc3Vic2FoYXJpZW5uZSBlbiB1dGlsaXNhbnQgZGVzIGRvbm7DqWVzIG3DqXTDqW9yb2xvZ2lxdWVzIG1haWxsw6llcyBwcm92ZW5hbnQgZCdhaWxsZXVycyBzdXIgbGUgY29udGluZW50LiBMZSByw6lncmVzc2lmIFJGIGV4cGxpcXVlIHBsdXMgZGUgOTAlIGRlIGxhIHZhcmlhbmNlIGRhbnMgbGUgcmVuZGVtZW50IHNpbXVsw6kgcGFyIFdPRk9TVCwgdGVzdMOpIGhvcnMgw6ljaGFudGlsbG9uIMOgIHRyYXZlcnMgZGVzIHNjw6luYXJpb3MgZXQgZGVzIGxpZXV4LlxuXG5HWUdBIHJhcHBvcnRlIGRldXggdHlwZXMgZCdhZGFwdGF0aW9ucyBwb3VyIGxlcyByZW5kZW1lbnRzIHNpbXVsw6lzLCDDoCBzYXZvaXIgbGVzIGNoYW5nZW1lbnRzIGRlIGN1bHRpdmFycyBldCBsJ2lycmlnYXRpb24uIFBvdXIgbGVzIGN1bHRpdmFycywgbGVzIG1hdHVyaXTDqXMgcHLDqWNvY2UgZXQgdGFyZGl2ZSAoZW4gcGx1cyBkZXMgY3VsdGl2YXJzIGFjdHVlbGxlbWVudCB1dGlsaXPDqXMpIHNvbnQgcmFwcG9ydMOpZXMuIFBvdXIgbCdpcnJpZ2F0aW9uLCB1bmUgc2ltdWxhdGlvbiBkZSBtb2TDqGxlIGRlIGN1bHR1cmUgZW50acOocmVtZW50IGlycmlndcOpZSBlc3QgZGlzcG9uaWJsZS4gTGEgY29tYmluYWlzb24gY29tcGzDqHRlIChjJ2VzdC3DoC1kaXJlIGNoYXF1ZSBjdWx0aXZhciBhdmVjIGV0IHNhbnMgaXJyaWdhdGlvbikgZGUgY2VzIHNjw6luYXJpb3MgZXN0IGRpc3BvbmlibGUuIENlbGEgcGVybWV0IGQnZXhwbG9yZXIgY2lucSBzY8OpbmFyaW9zIGQnYWRhcHRhdGlvbiwgZW4gcGx1cyBkdSBzY8OpbmFyaW8gc2FucyBhZGFwdGF0aW9uIChjJ2VzdC3DoC1kaXJlIHBsdXZpYWwsIGN1bHRpdmFyIGFjdHVlbCkuIFRvdXRlcyBsZXMgZG9ubsOpZXMgR1lHQSBzb250IGRpc3BvbmlibGVzIHN1ciBodHRwczovL3d3dy55aWVsZGdhcC5vcmcvLiBMZXMgYXJyYW5nZW1lbnRzIGRlIGxpY2VuY2Ugc3DDqWNpZmlxdWVzIGVuIGZvbmN0aW9uIGR1IHR5cGUgZCd1dGlsaXNhdGV1ciBldC9vdSBkJ2luc3RpdHV0aW9uIHNvbnQgZMOpY3JpdHMgW2ljaV0oaHR0cHM6Ly93d3cueWllbGRnYXAub3JnL3dlYi9ndWVzdC9zdWJzY3JpcHRpb24tYW5kLXNlcnZpY2UpLmAsXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgaGFydmVzdGVkQXJlYToge1xuICAgICAgICB0aXRsZTogeyBlbjogXCJIYXJ2ZXN0ZWQgQXJlYVwiLCBmcjogXCJTdXBlcmZpY2llIHLDqWNvbHTDqWVcIiB9LFxuICAgICAgICB0ZXh0OiB7XG4gICAgICAgICAgZW46IGBbSGFydmVzdGVkIGFyZWEgZGF0YV0oaHR0cHM6Ly9yYWRpYW50ZWFydGguZ2l0aHViLmlvL3N0YWMtYnJvd3Nlci8jL2V4dGVybmFsL2RpZ2l0YWwtYXRsYXMuczMuYW1hem9uYXdzLmNvbS9zdGFjL3B1YmxpY19zdGFjL2V4cG9zdXJlX2NhdGFsb2cvbWFwc3BhbTIwMTcvY3JvcF9oYS9jcm9wX2hhLmpzb24pIGNvbWVzIGZyb20gIE1hcFNQQU0gMjAxNyBWMnIzIChTcGF0aWFsIFByb2R1Y3Rpb24gQWxsb2NhdGlvbiBNb2RlbCkuIFRoaXMgZGF0YXNldCBpcyBhbiB1cGRhdGVkIHZlcnNpb24gb2YgTWFwU1BBTSBzcGVjaWZpY2FsbHkgdGFpbG9yZWQgZm9yIHRoaXMgcHJvamVjdC4gSXQgaW5jbHVkZXMgYnVnIGZpeGVzIGFuZCBpbmNvcnBvcmF0ZXMgbW9yZSBkYXRhIHNvdXJjZXMgYW5kIGF0IGdyZWF0ZXIgcmVzb2x1dGlvbi4gVGhlIE1hcFNQQU0gbWV0aG9kb2xvZ3kgaXMgZnVsbHkgZG9jdW1lbnRlZCBieSBbWXUgZXQgYWwuICgyMDIwKV0oaHR0cHM6Ly9kb2kub3JnLzEwLjUxOTQvZXNzZC0yMDIwLTExKS5gLFxuICAgICAgICAgIGZyOiBgW0xlcyBkb25uw6llcyBkZSBzdXBlcmZpY2llIHLDqWNvbHTDqWVdKGh0dHBzOi8vcmFkaWFudGVhcnRoLmdpdGh1Yi5pby9zdGFjLWJyb3dzZXIvIy9leHRlcm5hbC9kaWdpdGFsLWF0bGFzLnMzLmFtYXpvbmF3cy5jb20vc3RhYy9wdWJsaWNfc3RhYy9leHBvc3VyZV9jYXRhbG9nL21hcHNwYW0yMDE3L2Nyb3BfaGEvY3JvcF9oYS5qc29uPy5sYW5ndWFnZT1mcikgcHJvdmllbm5lbnQgZGUgTWFwU1BBTSAyMDE3IFYycjMgKFNwYXRpYWwgUHJvZHVjdGlvbiBBbGxvY2F0aW9uIE1vZGVsKS4gQ2UgamV1IGRlIGRvbm7DqWVzIGVzdCB1bmUgdmVyc2lvbiBtaXNlIMOgIGpvdXIgZGUgTWFwU1BBTSBzcMOpY2lmaXF1ZW1lbnQgYWRhcHTDqWUgw6AgY2UgcHJvamV0LiBJbCBjb21wcmVuZCBkZXMgY29ycmVjdGlvbnMgZGUgYm9ndWVzIGV0IGludMOoZ3JlIGRhdmFudGFnZSBkZSBzb3VyY2VzIGRlIGRvbm7DqWVzIGF2ZWMgdW5lIHLDqXNvbHV0aW9uIHBsdXMgw6lsZXbDqWUuIExhIG3DqXRob2RvbG9naWUgZGUgTWFwU1BBTSBlc3QgZW50acOocmVtZW50IGRvY3VtZW50w6llIHBhciBbWXUgZXQgYWwuICgyMDIwKV0oaHR0cHM6Ly9kb2kub3JnLzEwLjUxOTQvZXNzZC0yMDIwLTExKS5gLFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICAgIGJvdW5kYXJpZXM6IHtcbiAgICAgICAgdGl0bGU6IHsgZW46IFwiQm91bmRhcmllc1wiLCBmcjogXCJEw6lsaW1pdGF0aW9uc1wiIH0sXG4gICAgICAgIHRleHQ6IHtcbiAgICAgICAgICBlbjogYFtBZG1pbmlzdHJhdGl2ZSBhcmVhc10oaHR0cHM6Ly9yYWRpYW50ZWFydGguZ2l0aHViLmlvL3N0YWMtYnJvd3Nlci8jL2V4dGVybmFsL2RpZ2l0YWwtYXRsYXMuczMuYW1hem9uYXdzLmNvbS9zdGFjL3B1YmxpY19zdGFjL2JvdW5kYXJ5X2NhdGFsb2cvZ2VvQm91bmRhcmllc19TU0EvY29sbGVjdGlvbi5qc29uKSB1c2VkIGluIHRoaXMgbm90ZWJvb2sgY29tZSBmcm9tIFtnZW9Cb3VuZGFyaWVzIDYuMC4wXShodHRwczovL2dpdGh1Yi5jb20vd21nZW9sYWIvZ2VvQm91bmRhcmllcykuIFRoZSBnYkh1bWFuaXRhcmlhbiBib3VuZGFyaWVzIGFyZSB1c2VkIGFuZCBpZiBub3QgYXZhaWxhYmxlIHRoZW4gdGhlIGdiT3BlbiBib3VuZGFyaWVzIGFyZSBzdWJzdGl0dXRlZC5gLFxuICAgICAgICAgIGZyOiBgW0xlcyB6b25lcyBhZG1pbmlzdHJhdGl2ZXNdKGh0dHBzOi8vcmFkaWFudGVhcnRoLmdpdGh1Yi5pby9zdGFjLWJyb3dzZXIvIy9leHRlcm5hbC9kaWdpdGFsLWF0bGFzLnMzLmFtYXpvbmF3cy5jb20vc3RhYy9wdWJsaWNfc3RhYy9ib3VuZGFyeV9jYXRhbG9nL2dlb0JvdW5kYXJpZXNfU1NBL2NvbGxlY3Rpb24uanNvbj8ubGFuZ3VhZ2U9ZnIpIHV0aWxpc8OpZXMgZGFucyBjZSBub3RlYm9vayBwcm92aWVubmVudCBkZSBbZ2VvQm91bmRhcmllcyA2LjAuMF0oaHR0cHM6Ly9naXRodWIuY29tL3dtZ2VvbGFiL2dlb0JvdW5kYXJpZXMpLiBMZXMgZnJvbnRpw6hyZXMgZ2JIdW1hbml0YXJpYW4gc29udCB1dGlsaXPDqWVzIGV0LCBzaSBlbGxlcyBuZSBzb250IHBhcyBkaXNwb25pYmxlcywgbGVzIGZyb250acOocmVzIGdiT3BlbiBzb250IHN1YnN0aXR1w6llcy5gLFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICB9LFxuICAgIG1ldGhvZHM6IHtcbiAgICAgIHRpdGxlOiB7IGVuOiBcIk1ldGhvZHNcIiwgZnI6IFwiTcOpdGhvZG9sb2dpZVwiIH0sXG4gICAgICBiZWVzd2FybToge1xuICAgICAgICB0aXRsZToge1xuICAgICAgICAgIGVuOiBcIkNyb3AgeWllbGQgbWV0YSBhbmFseXNpcyAoYmVlc3dhcm0gcGxvdClcIixcbiAgICAgICAgICBmcjogXCJNw6l0YS1hbmFseXNlIGRlcyByZW5kZW1lbnRzIGRlcyBjdWx0dXJlcyAoZGlhZ3JhbW1lIGRlIG51YWdlIGRlIHBvaW50cylcIixcbiAgICAgICAgfSxcbiAgICAgICAgdGV4dDoge1xuICAgICAgICAgIGVuOiBgV2UgcHJvZHVjZWQgYSBiZWVzd2FybSBwbG90IHRoYXQgc2hvd3MgdGhlIGluZGl2aWR1YWwgZXN0aW1hdGVzIG9mIGNyb3AgeWllbGQgZnJvbSB0aGUgbWV0YS1hbmFseXNpcyBkYXRhc2V0LiBXZSBzdWJzZXQgdGhlIG9yaWdpbmFsIGRhdGFzZXQgdG8gY292ZXIgb25seSBTdWItU2FoYXJhbiBBZnJpY2EgKFNTQSksIGFuZCBkaXNwbGF5IGRhdGEgcGVyIHJlZ2lvbiB3aXRoaW4gU1NBLiBXZSBhbGxvdyBzcGxpdHMgb2YgdGhlIGRhdGEgZm9yIHZpc3VhbGl6YXRpb24gYnkgd2FybWluZyBsZXZlbHMsIGNyb3BzLCBhbmQgYWRhcHRhdGlvbiAod2l0aCBhbmQgd2l0aG91dCBhZGFwdGF0aW9uKS5gLFxuICAgICAgICAgIGZyOiBgTm91cyBhdm9ucyBwcm9kdWl0IHVuIGRpYWdyYW1tZSBkZSBudWFnZSBkZSBwb2ludHMgcXVpIG1vbnRyZSBsZXMgZXN0aW1hdGlvbnMgaW5kaXZpZHVlbGxlcyBkZXMgcmVuZGVtZW50cyBkZXMgY3VsdHVyZXMgw6AgcGFydGlyIGR1IGpldSBkZSBkb25uw6llcyBkZSBtw6l0YS1hbmFseXNlLiBOb3VzIGF2b25zIGV4dHJhaXQgdW4gc291cy1lbnNlbWJsZSBkdSBqZXUgZGUgZG9ubsOpZXMgb3JpZ2luYWwgcG91ciBuZSBjb3V2cmlyIHF1ZSBsJ0FmcmlxdWUgc3Vic2FoYXJpZW5uZSAoU1NBKSwgZXQgYWZmaWNoZXIgbGVzIGRvbm7DqWVzIHBhciByw6lnaW9uIGF1IHNlaW4gZGUgbGEgU1NBLiBOb3VzIHBlcm1ldHRvbnMgZGUgZGl2aXNlciBsZXMgZG9ubsOpZXMgcG91ciBsYSB2aXN1YWxpc2F0aW9uIHBhciBuaXZlYXV4IGRlIHLDqWNoYXVmZmVtZW50LCBjdWx0dXJlcywgZXQgYWRhcHRhdGlvbiAoYXZlYyBldCBzYW5zIGFkYXB0YXRpb24pLmAsXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgbWFwcGluZ0hpc3RvcmljYWxGdXR1cmU6IHtcbiAgICAgICAgdGl0bGU6IHtcbiAgICAgICAgICBlbjogXCJNYXBwaW5nIGhpc3RvcmljYWwgYW5kIGZ1dHVyZSBwcm9qZWN0ZWQgY3JvcCB5aWVsZHNcIixcbiAgICAgICAgICBmcjogXCJDYXJ0b2dyYXBoaWUgZGVzIHJlbmRlbWVudHMgZGVzIGN1bHR1cmVzIGhpc3RvcmlxdWVzIGV0IHByb2pldMOpcyBmdXR1cnNcIixcbiAgICAgICAgfSxcbiAgICAgICAgdGV4dDoge1xuICAgICAgICAgIGVuOiBgV2UgYWdncmVnYXRlIEdZR0HigJlzIGNyb3AgeWllbGQgcHJvamVjdGlvbnMgYXQgdGhyZWUgYWRtaW5pc3RyYXRpdmUgbGV2ZWxzLCBuYW1lbHksIG5hdGlvbmFsLCBzdWJuYXRpb25hbCBsZXZlbCAxIChyZWZlcnJlZCB0byBhcyByZWdpb24gYWNyb3NzIHRoZSBub3RlYm9vayksIGFuZCBzdWJuYXRpb25hbCBsZXZlbCAyIChyZWZlcnJlZCB0byBhcyBzdWJyZWdpb24gYWNyb3NzIHRoZSBub3RlYm9vaykuIFRoZSBhZ2dyZWdhdGlvbiB1c2VzIHRoZSB3ZWlnaHRlZCBhdmVyYWdlIG9mIHRoZSBjcm9wIHlpZWxkIGFuZCB0aGUgaGFydmVzdGVkIGFyZWEgcHJlc2VudCB3aXRoaW4gdGhlIHBvaW50IGxvY2F0aW9uIHdoZXJlIGEgV09GT1NUIHNpbXVsYXRpb24gaGFzIGJlZW4gY29uZHVjdGVkLCB3aXRoaW4gdGhlIHJlc3BlY3RpdmUgYWRtaW5pc3RyYXRpdmUgYm91bmRhcmllcy4gRGF0YSBhZ2dyZWdhdGlvbiBpcyBkb25lIGZvciByYWluZmVkIGFuZCBpcnJpZ2F0ZWQgY3JvcCB5aWVsZHMsIGZvciBlYWNoIGNyb3AsIGFuZCBmb3IgZWFjaCBzY2VuYXJpbyAocGVyaW9kIGFuZCBTaGFyZWQgU29jaW9lY29ub21pYyBQYXRod2F5IOKAk1NTUCkgc2VwYXJhdGVseS4gRm91ciBpbmRpY2F0b3JzIGFyZSBtYXBwZWQsIG5hbWVseSwgdGhlIGF2ZXJhZ2UgeWllbGQgKGluIHRvbi9oYSksIHRoZSB5aWVsZCBjaGFuZ2UgKGluIHRvbi9oYSksIHlpZWxkIGNoYW5nZSAoaW4gcGVyY2VudGFnZSksIGFuZCB0aGUgdW5jZXJ0YWludHkgaW4geWllbGQgKGluIHRvbi9oYSkuIEZvciB0aGUgbGF0dGVyLCB0aGUgaW5kaXZpZHVhbCBjbGltYXRlIG1vZGVsIHByb2plY3Rpb25zIGFyZSB1c2VkIHRvIGNvbXB1dGUgdGhlIHJhbmdlIChtYXguIOKAkyBtaW4uKSBhY3Jvc3MgdGhlIGluZGl2aWR1YWwgR0NNIHByb2plY3Rpb25zLmAsXG4gICAgICAgICAgZnI6IGBOb3VzIGFncsOpZ2VvbnMgbGVzIHByb2plY3Rpb25zIGRlIHJlbmRlbWVudCBkZXMgY3VsdHVyZXMgZGUgR1lHQSDDoCB0cm9pcyBuaXZlYXV4IGFkbWluaXN0cmF0aWZzLCDDoCBzYXZvaXIsIG5hdGlvbmFsLCBzb3VzLW5hdGlvbmFsIG5pdmVhdSAxIChhcHBlbMOpIHLDqWdpb24gZGFucyBsZSBub3RlYm9vayksIGV0IHNvdXMtbmF0aW9uYWwgbml2ZWF1IDIgKGFwcGVsw6kgc291cy1yw6lnaW9uIGRhbnMgbGUgbm90ZWJvb2spLiBMJ2FncsOpZ2F0aW9uIHV0aWxpc2UgbGEgbW95ZW5uZSBwb25kw6lyw6llIGR1IHJlbmRlbWVudCBkZXMgY3VsdHVyZXMgZXQgZGUgbGEgc3VwZXJmaWNpZSByw6ljb2x0w6llIHByw6lzZW50ZSDDoCBsJ2VtcGxhY2VtZW50IG/DuSB1bmUgc2ltdWxhdGlvbiBXT0ZPU1QgYSDDqXTDqSByw6lhbGlzw6llLCBkYW5zIGxlcyBsaW1pdGVzIGFkbWluaXN0cmF0aXZlcyByZXNwZWN0aXZlcy4gTCdhZ3LDqWdhdGlvbiBkZXMgZG9ubsOpZXMgZXN0IGVmZmVjdHXDqWUgcG91ciBsZXMgcmVuZGVtZW50cyBkZXMgY3VsdHVyZXMgZW4gc2VjIGV0IGlycmlndcOpZXMsIHBvdXIgY2hhcXVlIGN1bHR1cmUsIGV0IHBvdXIgY2hhcXVlIHNjw6luYXJpbyAocMOpcmlvZGUgZXQgVHJhamVjdG9pcmUgU29jaW8tw6ljb25vbWlxdWUgUGFydGFnw6llIOKAkyBTU1ApIHPDqXBhcsOpbWVudC4gUXVhdHJlIGluZGljYXRldXJzIHNvbnQgY2FydG9ncmFwaGnDqXMsIMOgIHNhdm9pciwgbGUgcmVuZGVtZW50IG1veWVuIChlbiB0b25uZXMvaGEpLCBsZSBjaGFuZ2VtZW50IGRlIHJlbmRlbWVudCAoZW4gdG9ubmVzL2hhKSwgbGUgY2hhbmdlbWVudCBkZSByZW5kZW1lbnQgKGVuIHBvdXJjZW50YWdlKSwgZXQgbCdpbmNlcnRpdHVkZSBkdSByZW5kZW1lbnQgKGVuIHRvbm5lcy9oYSkuIFBvdXIgY2UgZGVybmllciwgbGVzIHByb2plY3Rpb25zIGluZGl2aWR1ZWxsZXMgZGVzIG1vZMOobGVzIGNsaW1hdGlxdWVzIHNvbnQgdXRpbGlzw6llcyBwb3VyIGNhbGN1bGVyIGwnw6ljYXJ0IChtYXguIOKAkyBtaW4uKSBlbnRyZSBsZXMgcHJvamVjdGlvbnMgaW5kaXZpZHVlbGxlcyBkZXMgR0NNLmAsXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgYWRhcHRhdGlvbkFuYWx5c2lzOiB7XG4gICAgICAgIHRpdGxlOiB7IGVuOiBcIkFuYWx5c2lzIG9mIGFkYXB0YXRpb25cIiwgZnI6IFwiQW5hbHlzZSBkZSBsJ2FkYXB0YXRpb25cIiB9LFxuICAgICAgICB0ZXh0OiB7XG4gICAgICAgICAgZW46IGBXZSBkaXNwbGF5IHRoZSBtZWFuIHlpZWxkIG9mIGVhY2ggYWRhcHRhdGlvbiBvcHRpb24gYXMgc2ltdWxhdGVkIGZvciBlYWNoIG9mIHRoZSBjcm9wcywgZm9yIGVhY2ggY2xpbWF0ZSBzY2VuYXJpbywgYW5kIGF0IGRpZmZlcmVudCBhZG1pbmlzdHJhdGl2ZSBib3VuZGFyeSBsZXZlbHMsIG5hbWVseSwgYWxsIFN1Yi1TYWhhcmFuIEFmcmljYSwgbmF0aW9uYWwsIHN1Ym5hdGlvbmFsIGxldmVsIDEsIGFuZCBzdWJuYXRpb25hbCBsZXZlbCAyLiBUaGUgb2JqZWN0aXZlIGlzIHRvIHByb3ZpZGUgYSBjbGVhciBvdmVydmlldyBvZiB0aGUgc2ltdWxhdGVkIHlpZWxkIGxldmVsIGluIHRoZSBoaXN0b3JpY2FsIGFuZCBmdXR1cmUgc2NlbmFyaW9zIHdpdGhvdXQgYWRhcHRhdGlvbiwgYW5kIHRoZSBjb21wYXJhdGl2ZSBwZXJmb3JtYW5jZSBvZiB0aGUgdmFyaW91cyBhZGFwdGF0aW9uIHNvbHV0aW9ucyBhZ2FpbnN0IHRoZSBubyBhZGFwdGF0aW9uIHNjZW5hcmlvLiBDcm9wIHlpZWxkIGlzIGFnZ3JlZ2F0ZWQgdXNpbmcgd2VpZ2h0ZWQgYXZlcmFnZSBhZ2FpbnN0IHRoZSBNYXBTUEFNIGhhcnZlc3RlZCBhcmVhLiBDb25maWRlbmNlIGludGVydmFscyBleHRlbmQgdG8gNeKAkzk1JSBvZiB0aGUgaW5kaXZpZHVhbCBHQ01zIChvZiB3aGljaCB0aGVyZSBhcmUgZml2ZSkuYCxcbiAgICAgICAgICBmcjogYE5vdXMgYWZmaWNob25zIGxlIHJlbmRlbWVudCBtb3llbiBkZSBjaGFxdWUgb3B0aW9uIGQnYWRhcHRhdGlvbiB0ZWwgcXVlIHNpbXVsw6kgcG91ciBjaGFjdW5lIGRlcyBjdWx0dXJlcywgcG91ciBjaGFxdWUgc2PDqW5hcmlvIGNsaW1hdGlxdWUsIGV0IMOgIGRpZmbDqXJlbnRzIG5pdmVhdXggZGUgbGltaXRlcyBhZG1pbmlzdHJhdGl2ZXMsIMOgIHNhdm9pciwgdG91dGUgbCdBZnJpcXVlIHN1YnNhaGFyaWVubmUsIG5hdGlvbmFsLCBzb3VzLW5hdGlvbmFsIG5pdmVhdSAxIGV0IHNvdXMtbmF0aW9uYWwgbml2ZWF1IDIuIEwnb2JqZWN0aWYgZXN0IGRlIGZvdXJuaXIgdW5lIHZ1ZSBkJ2Vuc2VtYmxlIGNsYWlyZSBkdSBuaXZlYXUgZGUgcmVuZGVtZW50IHNpbXVsw6kgZGFucyBsZXMgc2PDqW5hcmlvcyBoaXN0b3JpcXVlcyBldCBmdXR1cnMgc2FucyBhZGFwdGF0aW9uLCBldCBkZSBsYSBwZXJmb3JtYW5jZSBjb21wYXJhdGl2ZSBkZXMgZGlmZsOpcmVudGVzIHNvbHV0aW9ucyBkJ2FkYXB0YXRpb24gcGFyIHJhcHBvcnQgYXUgc2PDqW5hcmlvIHNhbnMgYWRhcHRhdGlvbi4gTGUgcmVuZGVtZW50IGRlcyBjdWx0dXJlcyBlc3QgYWdyw6lnw6kgZW4gdXRpbGlzYW50IGxhIG1veWVubmUgcG9uZMOpcsOpZSBwYXIgcmFwcG9ydCDDoCBsYSBzdXBlcmZpY2llIHLDqWNvbHTDqWUgZGUgTWFwU1BBTS4gTGVzIGludGVydmFsbGVzIGRlIGNvbmZpYW5jZSBzJ8OpdGVuZGVudCBkZSA1IMOgIDk1ICUgZGVzIG1vZMOobGVzIGNsaW1hdGlxdWVzIGdsb2JhdXggKEdDTSkgaW5kaXZpZHVlbHMgKGRvbnQgaWwgeSBlbiBhIGNpbnEpLmAsXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgcmVmZXJlbmNlczoge1xuICAgICAgICB0aXRsZTogeyBlbjogXCJSZWZlcmVuY2VzXCIsIGZyOiBcIlLDqWbDqXJlbmNlc1wiIH0sXG4gICAgICB9LFxuICAgIH0sXG4gIH0sXG4gIGFwcGVuZGl4OiB7XG4gICAgdGl0bGU6IHsgZW46IFwiQXBwZW5kaXhcIiwgZnI6IFwiQW5uZXhlc1wiIH0sXG4gICAgdGV4dDoge1xuICAgICAgZW46IFwiVGhpcyBsYXJnZSBzZWN0aW9uIGluY2x1ZGVzIGFsbCB0aGUgY2VsbHMgdGhhdCBwb3dlciB0aGUgbm90ZWJvb2suVGhpcyBsYXJnZSBzZWN0aW9uIGluY2x1ZGVzIGFsbCB0aGUgY2VsbHMgdGhhdCBwb3dlciB0aGUgbm90ZWJvb2suXCIsXG4gICAgICBmcjogXCJDZXR0ZSBncmFuZGUgc2VjdGlvbiBjb21wcmVuZCB0b3V0ZXMgbGVzIGNlbGx1bGVzIHF1aSBhbGltZW50ZW50IGxlIG5vdGVib29rXCIsXG4gICAgfSxcbiAgfSxcbiAgZ2VuZXJhbDoge1xuICAgIHBvc2l0aXZlOiB7IGVuOiBcInBvc2l0aXZlXCIsIGZyOiBcInBvc2l0aWZcIiB9LFxuICAgIG5lZ2F0aXZlOiB7IGVuOiBcIm5lZ2F0aXZlXCIsIGZyOiBcIm7DqWdhdGlmXCIgfSxcbiAgICBjcm9wczoge1xuICAgICAgbWFpemU6IHsgZW46IFwiTWFpemVcIiwgZnI6IFwiTWHDr3NcIiB9LFxuICAgICAgcmljZTogeyBlbjogXCJSaWNlXCIsIGZyOiBcIlJpelwiIH0sXG4gICAgICB3aGVhdDogeyBlbjogXCJXaGVhdFwiLCBmcjogXCJCbMOpXCIgfSxcbiAgICAgIHNvcmdodW06IHsgZW46IFwiU29yZ2h1bVwiLCBmcjogXCJTb3JnaG9cIiB9LFxuICAgICAgbWlsbGV0OiB7IGVuOiBcIk1pbGxldFwiLCBmcjogXCJNaWxsZXRcIiB9LFxuICAgIH0sXG4gICAgY3JvcDogeyBlbjogXCJDcm9wXCIsIGZyOiBcIkN1bHR1cmVcIiB9LFxuICAgIGNvdW50cnk6IHsgZW46IFwiQ291bnRyeVwiLCBmcjogXCJQYXlzXCIgfSxcbiAgICByZWdpb246IHsgZW46IFwiUmVnaW9uXCIsIGZyOiBcIlLDqWdpb25cIiB9LFxuICAgIHN1YlJlZ2lvbjogeyBlbjogXCJTdWItUmVnaW9uXCIsIGZyOiBcIlNvdXMtcsOpZ2lvblwiIH0sXG4gICAgc2NlbmFyaW86IHsgZW46IFwiU2NlbmFyaW9cIiwgZnI6IFwiU2PDqW5hcmlvXCIgfSxcbiAgICBoaXN0b3JpY2FsOiB7IGVuOiBcIkhpc3RvcmljYWxcIiwgZnI6IFwiSGlzdG9yaXF1ZVwiIH0sXG4gICAgbm9EYXRhOiB7IGVuOiBcIk5vIERhdGFcIiwgZnI6IFwiXCIgfSxcbiAgICBncmV5Tm9EYXRhOiB7XG4gICAgICBlbjogXCJHcmV5IHJlZ2lvbnMgc2lnbmFsIGxhY2sgb2YgZGF0YVwiLFxuICAgICAgZnI6IFwiTGVzIHLDqWdpb25zIGdyaXNlcyBpbmRpcXVlbnQgdW4gbWFucXVlIGRlIGRvbm7DqWVzXCIsXG4gICAgfSxcbiAgICBlbWlzc2lvbl9zc3AzNzA6IHsgZW46IFwiTW9kZXJhdGUgZW1pc3Npb25zXCIsIGZyOiBcIsOpbWlzc2lvbnMgbW9kw6lyw6llc1wiIH0sXG4gICAgZW1pc3Npb25fc3NwNTg1OiB7IGVuOiBcIkhpZ2ggZW1pc3Npb25zXCIsIGZyOiBcIsOpbWlzc2lvbnMgw6lsZXbDqWVzXCIgfSxcbiAgICBjb3VudHJpZXNfYXJ0aWNsZToge1xuICAgICAgQW5nb2xhOiB7IGVuOiBcIkFuZ29sYVwiLCBmcjogXCJFbiBBbmdvbGFcIiB9LFxuICAgICAgQmVuaW46IHsgZW46IFwiQmVuaW5cIiwgZnI6IFwiQXUgQsOpbmluXCIgfSxcbiAgICAgIEJvdHN3YW5hOiB7IGVuOiBcIkJvdHN3YW5hXCIsIGZyOiBcIkF1IEJvdHN3YW5hXCIgfSxcbiAgICAgIFwiQnVya2luYSBGYXNvXCI6IHsgZW46IFwiQnVya2luYSBGYXNvXCIsIGZyOiBcIkF1IEJ1cmtpbmEgRmFzb1wiIH0sXG4gICAgICBCdXJ1bmRpOiB7IGVuOiBcIkJ1cnVuZGlcIiwgZnI6IFwiQXUgQnVydW5kaVwiIH0sXG4gICAgICBDYW1lcm9vbjogeyBlbjogXCJDYW1lcm9vblwiLCBmcjogXCJBdSBDYW1lcm91blwiIH0sXG4gICAgICBcIkNlbnRyYWwgQWZyaWNhbiBSZXB1YmxpY1wiOiB7XG4gICAgICAgIGVuOiBcIkNlbnRyYWwgQWZyaWNhbiBSZXB1YmxpY1wiLFxuICAgICAgICBmcjogXCJFbiBSw6lwdWJsaXF1ZSBDZW50cmFmcmljYWluZVwiLFxuICAgICAgfSxcbiAgICAgIENoYWQ6IHsgZW46IFwiQ2hhZFwiLCBmcjogXCJBdSBUY2hhZFwiIH0sXG4gICAgICBcIkNvbmdvIC0gQnJhenphdmlsbGVcIjoge1xuICAgICAgICBlbjogXCJDb25nbyAtIEJyYXp6YXZpbGxlXCIsXG4gICAgICAgIGZyOiBcIkF1IENvbmdvIC0gQnJhenphdmlsbGVcIixcbiAgICAgIH0sXG4gICAgICBcIkNvbmdvIC0gS2luc2hhc2FcIjogeyBlbjogXCJDb25nbyAtIEtpbnNoYXNhXCIsIGZyOiBcIkF1IENvbmdvIC0gS2luc2hhc2FcIiB9LFxuICAgICAgXCJDw7R0ZSBkJ0l2b2lyZVwiOiB7IGVuOiBcIkPDtHRlIGQnSXZvaXJlXCIsIGZyOiBcIkVuIEPDtHRlIGQnSXZvaXJlXCIgfSxcbiAgICAgIERqaWJvdXRpOiB7IGVuOiBcIkRqaWJvdXRpXCIsIGZyOiBcIkEgRGppYm91dGlcIiB9LFxuICAgICAgXCJFcXVhdG9yaWFsIEd1aW5lYVwiOiB7XG4gICAgICAgIGVuOiBcIkVxdWF0b3JpYWwgR3VpbmVhXCIsXG4gICAgICAgIGZyOiBcIkVuIEd1aW7DqWUgw4lxdWF0b3JpYWxlXCIsXG4gICAgICB9LFxuICAgICAgRXJpdHJlYTogeyBlbjogXCJFcml0cmVhXCIsIGZyOiBcIkVuIMOJcnl0aHLDqWVcIiB9LFxuICAgICAgRXN3YXRpbmk6IHsgZW46IFwiRXN3YXRpbmlcIiwgZnI6IFwiRW4gRXN3YXRpbmlcIiB9LFxuICAgICAgRXRoaW9waWE6IHsgZW46IFwiRXRoaW9waWFcIiwgZnI6IFwiRW4gw4l0aGlvcGllXCIgfSxcbiAgICAgIEdhYm9uOiB7IGVuOiBcIkdhYm9uXCIsIGZyOiBcIkF1IEdhYm9uXCIgfSxcbiAgICAgIEdhbWJpYTogeyBlbjogXCJHYW1iaWFcIiwgZnI6IFwiRW4gR2FtYmllXCIgfSxcbiAgICAgIEdoYW5hOiB7IGVuOiBcIkdoYW5hXCIsIGZyOiBcIkF1IEdoYW5hXCIgfSxcbiAgICAgIEd1aW5lYTogeyBlbjogXCJHdWluZWFcIiwgZnI6IFwiRW4gR3VpbsOpZVwiIH0sXG4gICAgICBcIkd1aW5lYS1CaXNzYXVcIjogeyBlbjogXCJHdWluZWEtQmlzc2F1XCIsIGZyOiBcIkVuIEd1aW7DqWUtQmlzc2F1XCIgfSxcbiAgICAgIEtlbnlhOiB7IGVuOiBcIktlbnlhXCIsIGZyOiBcIkF1IEtlbnlhXCIgfSxcbiAgICAgIExlc290aG86IHsgZW46IFwiTGVzb3Rob1wiLCBmcjogXCJBdSBMZXNvdGhvXCIgfSxcbiAgICAgIExpYmVyaWE6IHsgZW46IFwiTGliZXJpYVwiLCBmcjogXCJBdSBMaWLDqXJpYVwiIH0sXG4gICAgICBNYWRhZ2FzY2FyOiB7IGVuOiBcIk1hZGFnYXNjYXJcIiwgZnI6IFwiw4AgTWFkYWdhc2NhclwiIH0sXG4gICAgICBNYWxhd2k6IHsgZW46IFwiTWFsYXdpXCIsIGZyOiBcIkF1IE1hbGF3aVwiIH0sXG4gICAgICBNYWxpOiB7IGVuOiBcIk1hbGlcIiwgZnI6IFwiQXUgTWFsaVwiIH0sXG4gICAgICBNYXVyaXRhbmlhOiB7IGVuOiBcIk1hdXJpdGFuaWFcIiwgZnI6IFwiRW4gTWF1cml0YW5pZVwiIH0sXG4gICAgICBNb3phbWJpcXVlOiB7IGVuOiBcIk1vemFtYmlxdWVcIiwgZnI6IFwiQXUgTW96YW1iaXF1ZVwiIH0sXG4gICAgICBOYW1pYmlhOiB7IGVuOiBcIk5hbWliaWFcIiwgZnI6IFwiRW4gTmFtaWJpZVwiIH0sXG4gICAgICBOaWdlcjogeyBlbjogXCJOaWdlclwiLCBmcjogXCJBdSBOaWdlclwiIH0sXG4gICAgICBOaWdlcmlhOiB7IGVuOiBcIk5pZ2VyaWFcIiwgZnI6IFwiQXUgTmlnw6lyaWFcIiB9LFxuICAgICAgUndhbmRhOiB7IGVuOiBcIlJ3YW5kYVwiLCBmcjogXCJBdSBSd2FuZGFcIiB9LFxuICAgICAgU2VuZWdhbDogeyBlbjogXCJTZW5lZ2FsXCIsIGZyOiBcIkF1IFPDqW7DqWdhbFwiIH0sXG4gICAgICBcIlNpZXJyYSBMZW9uZVwiOiB7IGVuOiBcIlNpZXJyYSBMZW9uZVwiLCBmcjogXCLDgCBTaWVycmEgTGVvbmVcIiB9LFxuICAgICAgU29tYWxpYTogeyBlbjogXCJTb21hbGlhXCIsIGZyOiBcIkVuIFNvbWFsaWVcIiB9LFxuICAgICAgXCJTb3V0aCBBZnJpY2FcIjogeyBlbjogXCJTb3V0aCBBZnJpY2FcIiwgZnI6IFwiRW4gQWZyaXF1ZSBkdSBTdWRcIiB9LFxuICAgICAgXCJTb3V0aCBTdWRhblwiOiB7IGVuOiBcIlNvdXRoIFN1ZGFuXCIsIGZyOiBcIkF1IFNvdWRhbiBkdSBTdWRcIiB9LFxuICAgICAgU3VkYW46IHsgZW46IFwiU3VkYW5cIiwgZnI6IFwiQXUgU291ZGFuXCIgfSxcbiAgICAgIFRhbnphbmlhOiB7IGVuOiBcIlRhbnphbmlhXCIsIGZyOiBcIkVuIFRhbnphbmllXCIgfSxcbiAgICAgIFRvZ286IHsgZW46IFwiVG9nb1wiLCBmcjogXCJBdSBUb2dvXCIgfSxcbiAgICAgIFVnYW5kYTogeyBlbjogXCJVZ2FuZGFcIiwgZnI6IFwiRW4gT3VnYW5kYVwiIH0sXG4gICAgICBaYW1iaWE6IHsgZW46IFwiWmFtYmlhXCIsIGZyOiBcIkVuIFphbWJpZVwiIH0sXG4gICAgICBaaW1iYWJ3ZTogeyBlbjogXCJaaW1iYWJ3ZVwiLCBmcjogXCJBdSBaaW1iYWJ3ZVwiIH0sXG4gICAgICBTU0E6IHsgZW46IFwiU3ViLVNhaGFyYW4gQWZyaWNhXCIsIGZyOiBcIkVuIEFmcmlxdWUgU3Vic2FoYXJpZW5uZVwiIH0sXG4gICAgfSxcbiAgICBjb3VudHJ5X2FydGljbGUyOiB7XG4gICAgICBBbmdvbGE6IHsgZW46IFwiQW5nb2xhXCIsIGZyOiBcIkzigJlBbmdvbGFcIiB9LFxuICAgICAgQmVuaW46IHsgZW46IFwiQmVuaW5cIiwgZnI6IFwiTGUgQsOpbmluXCIgfSxcbiAgICAgIEJvdHN3YW5hOiB7IGVuOiBcIkJvdHN3YW5hXCIsIGZyOiBcIkxlIEJvdHN3YW5hXCIgfSxcbiAgICAgIFwiQnVya2luYSBGYXNvXCI6IHsgZW46IFwiQnVya2luYSBGYXNvXCIsIGZyOiBcIkxlIEJ1cmtpbmEgRmFzb1wiIH0sXG4gICAgICBCdXJ1bmRpOiB7IGVuOiBcIkJ1cnVuZGlcIiwgZnI6IFwiTGUgQnVydW5kaVwiIH0sXG4gICAgICBDYW1lcm9vbjogeyBlbjogXCJDYW1lcm9vblwiLCBmcjogXCJMZSBDYW1lcm91blwiIH0sXG4gICAgICBcIkNlbnRyYWwgQWZyaWNhbiBSZXB1YmxpY1wiOiB7XG4gICAgICAgIGVuOiBcIkNlbnRyYWwgQWZyaWNhbiBSZXB1YmxpY1wiLFxuICAgICAgICBmcjogXCJMYSBSw6lwdWJsaXF1ZSBDZW50cmFmcmljYWluZVwiLFxuICAgICAgfSxcbiAgICAgIENoYWQ6IHsgZW46IFwiQ2hhZFwiLCBmcjogXCJMZSBUY2hhZFwiIH0sXG4gICAgICBcIkNvbmdvIC0gQnJhenphdmlsbGVcIjoge1xuICAgICAgICBlbjogXCJDb25nbyAtIEJyYXp6YXZpbGxlXCIsXG4gICAgICAgIGZyOiBcIkxlIENvbmdvIC0gQnJhenphdmlsbGVcIixcbiAgICAgIH0sXG4gICAgICBcIkNvbmdvIC0gS2luc2hhc2FcIjogeyBlbjogXCJDb25nbyAtIEtpbnNoYXNhXCIsIGZyOiBcIkxlIENvbmdvIC0gS2luc2hhc2FcIiB9LFxuICAgICAgXCJDw7R0ZSBkJ0l2b2lyZVwiOiB7IGVuOiBcIkPDtHRlIGQnSXZvaXJlXCIsIGZyOiBcIkxhIEPDtHRlIGQnSXZvaXJlXCIgfSxcbiAgICAgIERqaWJvdXRpOiB7IGVuOiBcIkRqaWJvdXRpXCIsIGZyOiBcIkRqaWJvdXRpXCIgfSxcbiAgICAgIFwiRXF1YXRvcmlhbCBHdWluZWFcIjoge1xuICAgICAgICBlbjogXCJFcXVhdG9yaWFsIEd1aW5lYVwiLFxuICAgICAgICBmcjogXCJMYSBHdWluw6llIMOJcXVhdG9yaWFsZVwiLFxuICAgICAgfSxcbiAgICAgIEVyaXRyZWE6IHsgZW46IFwiRXJpdHJlYVwiLCBmcjogXCJM4oCZw4lyeXRocsOpZVwiIH0sXG4gICAgICBFc3dhdGluaTogeyBlbjogXCJFc3dhdGluaVwiLCBmcjogXCJM4oCZRXN3YXRpbmlcIiB9LFxuICAgICAgRXRoaW9waWE6IHsgZW46IFwiRXRoaW9waWFcIiwgZnI6IFwiTOKAmcOJdGhpb3BpZVwiIH0sXG4gICAgICBHYWJvbjogeyBlbjogXCJHYWJvblwiLCBmcjogXCJMZSBHYWJvblwiIH0sXG4gICAgICBHYW1iaWE6IHsgZW46IFwiR2FtYmlhXCIsIGZyOiBcIkxhICBHYW1iaWVcIiB9LFxuICAgICAgR2hhbmE6IHsgZW46IFwiR2hhbmFcIiwgZnI6IFwiTGUgR2hhbmFcIiB9LFxuICAgICAgR3VpbmVhOiB7IGVuOiBcIkd1aW5lYVwiLCBmcjogXCJMYSBHdWluw6llXCIgfSxcbiAgICAgIFwiR3VpbmVhLUJpc3NhdVwiOiB7IGVuOiBcIkd1aW5lYS1CaXNzYXVcIiwgZnI6IFwiTGEgR3VpbsOpZS1CaXNzYXVcIiB9LFxuICAgICAgS2VueWE6IHsgZW46IFwiS2VueWFcIiwgZnI6IFwiTGUgS2VueWFcIiB9LFxuICAgICAgTGVzb3RobzogeyBlbjogXCJMZXNvdGhvXCIsIGZyOiBcIkxlIExlc290aG9cIiB9LFxuICAgICAgTGliZXJpYTogeyBlbjogXCJMaWJlcmlhXCIsIGZyOiBcIkxlIExpYsOpcmlhXCIgfSxcbiAgICAgIE1hZGFnYXNjYXI6IHsgZW46IFwiTWFkYWdhc2NhclwiLCBmcjogXCJNYWRhZ2FzY2FyXCIgfSxcbiAgICAgIE1hbGF3aTogeyBlbjogXCJNYWxhd2lcIiwgZnI6IFwiTGUgTWFsYXdpXCIgfSxcbiAgICAgIE1hbGk6IHsgZW46IFwiTWFsaVwiLCBmcjogXCJMZSBNYWxpXCIgfSxcbiAgICAgIE1hdXJpdGFuaWE6IHsgZW46IFwiTWF1cml0YW5pYVwiLCBmcjogXCJMYSBNYXVyaXRhbmllXCIgfSxcbiAgICAgIE1vemFtYmlxdWU6IHsgZW46IFwiTW96YW1iaXF1ZVwiLCBmcjogXCJMZSBNb3phbWJpcXVlXCIgfSxcbiAgICAgIE5hbWliaWE6IHsgZW46IFwiTmFtaWJpYVwiLCBmcjogXCJMYSBOYW1pYmllXCIgfSxcbiAgICAgIE5pZ2VyOiB7IGVuOiBcIk5pZ2VyXCIsIGZyOiBcIkxlIE5pZ2VyXCIgfSxcbiAgICAgIE5pZ2VyaWE6IHsgZW46IFwiTmlnZXJpYVwiLCBmcjogXCJMZSBOaWfDqXJpYVwiIH0sXG4gICAgICBSd2FuZGE6IHsgZW46IFwiUndhbmRhXCIsIGZyOiBcIkxlIFJ3YW5kYVwiIH0sXG4gICAgICBTZW5lZ2FsOiB7IGVuOiBcIlNlbmVnYWxcIiwgZnI6IFwiTGUgU8OpbsOpZ2FsXCIgfSxcbiAgICAgIFwiU2llcnJhIExlb25lXCI6IHsgZW46IFwiU2llcnJhIExlb25lXCIsIGZyOiBcIlNpZXJyYSBMZW9uZVwiIH0sXG4gICAgICBTb21hbGlhOiB7IGVuOiBcIlNvbWFsaWFcIiwgZnI6IFwiTGEgU29tYWxpZVwiIH0sXG4gICAgICBcIlNvdXRoIEFmcmljYVwiOiB7IGVuOiBcIlNvdXRoIEFmcmljYVwiLCBmcjogXCJM4oCZQWZyaXF1ZSBkdSBTdWRcIiB9LFxuICAgICAgXCJTb3V0aCBTdWRhblwiOiB7IGVuOiBcIlNvdXRoIFN1ZGFuXCIsIGZyOiBcIkxlIFNvdWRhbiBkdSBTdWRcIiB9LFxuICAgICAgU3VkYW46IHsgZW46IFwiU3VkYW5cIiwgZnI6IFwiTGUgU291ZGFuXCIgfSxcbiAgICAgIFRhbnphbmlhOiB7IGVuOiBcIlRhbnphbmlhXCIsIGZyOiBcIkxhIFRhbnphbmllXCIgfSxcbiAgICAgIFRvZ286IHsgZW46IFwiVG9nb1wiLCBmcjogXCJMZSBUb2dvXCIgfSxcbiAgICAgIFVnYW5kYTogeyBlbjogXCJVZ2FuZGFcIiwgZnI6IFwiTOKAmU91Z2FuZGFcIiB9LFxuICAgICAgWmFtYmlhOiB7IGVuOiBcIlphbWJpYVwiLCBmcjogXCJMYSBaYW1iaWVcIiB9LFxuICAgICAgWmltYmFid2U6IHsgZW46IFwiWmltYmFid2VcIiwgZnI6IFwiTGUgWmltYmFid2VcIiB9LFxuICAgICAgU1NBOiB7IGVuOiBcIlNTQVwiLCBmcjogXCJM4oCZQWZyaXF1ZSBTdWJzYWhhcmllbm5lXCIgfSxcbiAgICB9LFxuICAgIGFkbWluTmFtZXM6IHtcbiAgICAgIFwiRnVsbCBDb3VudHJ5XCI6IHsgZW46IFwiRnVsbCBDb3VudHJ5XCIsIGZyOiBcIlBheXMgRW50aWVyXCIgfSxcbiAgICAgIEFuZ29sYToge1xuICAgICAgICBlbjogXCJBbmdvbGFcIixcbiAgICAgICAgZnI6IFwiQW5nb2xhXCIsXG4gICAgICB9LFxuICAgICAgQmVuaW46IHtcbiAgICAgICAgZW46IFwiQmVuaW5cIixcbiAgICAgICAgZnI6IFwiQsOpbmluXCIsXG4gICAgICB9LFxuICAgICAgQm90c3dhbmE6IHtcbiAgICAgICAgZW46IFwiQm90c3dhbmFcIixcbiAgICAgICAgZnI6IFwiQm90c3dhbmFcIixcbiAgICAgIH0sXG4gICAgICBcIkJ1cmtpbmEgRmFzb1wiOiB7XG4gICAgICAgIGVuOiBcIkJ1cmtpbmEgRmFzb1wiLFxuICAgICAgICBmcjogXCJCdXJraW5hIEZhc29cIixcbiAgICAgIH0sXG4gICAgICBCdXJ1bmRpOiB7XG4gICAgICAgIGVuOiBcIkJ1cnVuZGlcIixcbiAgICAgICAgZnI6IFwiQnVydW5kaVwiLFxuICAgICAgfSxcbiAgICAgIENhbWVyb29uOiB7XG4gICAgICAgIGVuOiBcIkNhbWVyb29uXCIsXG4gICAgICAgIGZyOiBcIkNhbWVyb3VuXCIsXG4gICAgICB9LFxuICAgICAgXCJDZW50cmFsIEFmcmljYW4gUmVwdWJsaWNcIjoge1xuICAgICAgICBlbjogXCJDZW50cmFsIEFmcmljYW4gUmVwdWJsaWNcIixcbiAgICAgICAgZnI6IFwiUsOpcHVibGlxdWUgQ2VudHJhZnJpY2FpbmVcIixcbiAgICAgIH0sXG4gICAgICBDaGFkOiB7XG4gICAgICAgIGVuOiBcIkNoYWRcIixcbiAgICAgICAgZnI6IFwiVGNoYWRcIixcbiAgICAgIH0sXG4gICAgICBcIkNvbmdvIC0gQnJhenphdmlsbGVcIjoge1xuICAgICAgICBlbjogXCJDb25nbyAtIEJyYXp6YXZpbGxlXCIsXG4gICAgICAgIGZyOiBcIkNvbmdvIC0gQnJhenphdmlsbGVcIixcbiAgICAgIH0sXG4gICAgICBcIkNvbmdvIC0gS2luc2hhc2FcIjoge1xuICAgICAgICBlbjogXCJDb25nbyAtIEtpbnNoYXNhXCIsXG4gICAgICAgIGZyOiBcIkNvbmdvIC0gS2luc2hhc2FcIixcbiAgICAgIH0sXG4gICAgICBcIkPDtHRlIGTigJlJdm9pcmVcIjoge1xuICAgICAgICBlbjogXCJDw7R0ZSBk4oCZSXZvaXJlXCIsXG4gICAgICAgIGZyOiBcIkPDtHRlIGTigJlJdm9pcmVcIixcbiAgICAgIH0sXG4gICAgICBEamlib3V0aToge1xuICAgICAgICBlbjogXCJEamlib3V0aVwiLFxuICAgICAgICBmcjogXCJEamlib3V0aVwiLFxuICAgICAgfSxcbiAgICAgIFwiRXF1YXRvcmlhbCBHdWluZWFcIjoge1xuICAgICAgICBlbjogXCJFcXVhdG9yaWFsIEd1aW5lYVwiLFxuICAgICAgICBmcjogXCJHdWluw6llIMOJcXVhdG9yaWFsZVwiLFxuICAgICAgfSxcbiAgICAgIEVyaXRyZWE6IHtcbiAgICAgICAgZW46IFwiRXJpdHJlYVwiLFxuICAgICAgICBmcjogXCLDiXJ5dGhyw6llXCIsXG4gICAgICB9LFxuICAgICAgRXN3YXRpbmk6IHtcbiAgICAgICAgZW46IFwiRXN3YXRpbmlcIixcbiAgICAgICAgZnI6IFwiRXN3YXRpbmlcIixcbiAgICAgIH0sXG4gICAgICBFdGhpb3BpYToge1xuICAgICAgICBlbjogXCJFdGhpb3BpYVwiLFxuICAgICAgICBmcjogXCLDiXRoaW9waWVcIixcbiAgICAgIH0sXG4gICAgICBHYWJvbjoge1xuICAgICAgICBlbjogXCJHYWJvblwiLFxuICAgICAgICBmcjogXCJHYWJvblwiLFxuICAgICAgfSxcbiAgICAgIEdhbWJpYToge1xuICAgICAgICBlbjogXCJHYW1iaWFcIixcbiAgICAgICAgZnI6IFwiR2FtYmllXCIsXG4gICAgICB9LFxuICAgICAgR2hhbmE6IHtcbiAgICAgICAgZW46IFwiR2hhbmFcIixcbiAgICAgICAgZnI6IFwiR2hhbmFcIixcbiAgICAgIH0sXG4gICAgICBHdWluZWE6IHtcbiAgICAgICAgZW46IFwiR3VpbmVhXCIsXG4gICAgICAgIGZyOiBcIkd1aW7DqWVcIixcbiAgICAgIH0sXG4gICAgICBcIkd1aW5lYS1CaXNzYXVcIjoge1xuICAgICAgICBlbjogXCJHdWluZWEtQmlzc2F1XCIsXG4gICAgICAgIGZyOiBcIkd1aW7DqWUtQmlzc2F1XCIsXG4gICAgICB9LFxuICAgICAgS2VueWE6IHtcbiAgICAgICAgZW46IFwiS2VueWFcIixcbiAgICAgICAgZnI6IFwiS2VueWFcIixcbiAgICAgIH0sXG4gICAgICBMZXNvdGhvOiB7XG4gICAgICAgIGVuOiBcIkxlc290aG9cIixcbiAgICAgICAgZnI6IFwiTGVzb3Rob1wiLFxuICAgICAgfSxcbiAgICAgIExpYmVyaWE6IHtcbiAgICAgICAgZW46IFwiTGliZXJpYVwiLFxuICAgICAgICBmcjogXCJMaWLDqXJpYVwiLFxuICAgICAgfSxcbiAgICAgIE1hZGFnYXNjYXI6IHtcbiAgICAgICAgZW46IFwiTWFkYWdhc2NhclwiLFxuICAgICAgICBmcjogXCJNYWRhZ2FzY2FyXCIsXG4gICAgICB9LFxuICAgICAgTWFsYXdpOiB7XG4gICAgICAgIGVuOiBcIk1hbGF3aVwiLFxuICAgICAgICBmcjogXCJNYWxhd2lcIixcbiAgICAgIH0sXG4gICAgICBNYWxpOiB7XG4gICAgICAgIGVuOiBcIk1hbGlcIixcbiAgICAgICAgZnI6IFwiTWFsaVwiLFxuICAgICAgfSxcbiAgICAgIE1hdXJpdGFuaWE6IHtcbiAgICAgICAgZW46IFwiTWF1cml0YW5pYVwiLFxuICAgICAgICBmcjogXCJNYXVyaXRhbmllXCIsXG4gICAgICB9LFxuICAgICAgTW96YW1iaXF1ZToge1xuICAgICAgICBlbjogXCJNb3phbWJpcXVlXCIsXG4gICAgICAgIGZyOiBcIk1vemFtYmlxdWVcIixcbiAgICAgIH0sXG4gICAgICBOYW1pYmlhOiB7XG4gICAgICAgIGVuOiBcIk5hbWliaWFcIixcbiAgICAgICAgZnI6IFwiTmFtaWJpZVwiLFxuICAgICAgfSxcbiAgICAgIE5pZ2VyOiB7XG4gICAgICAgIGVuOiBcIk5pZ2VyXCIsXG4gICAgICAgIGZyOiBcIk5pZ2VyXCIsXG4gICAgICB9LFxuICAgICAgTmlnZXJpYToge1xuICAgICAgICBlbjogXCJOaWdlcmlhXCIsXG4gICAgICAgIGZyOiBcIk5pZ8OpcmlhXCIsXG4gICAgICB9LFxuICAgICAgUndhbmRhOiB7XG4gICAgICAgIGVuOiBcIlJ3YW5kYVwiLFxuICAgICAgICBmcjogXCJSd2FuZGFcIixcbiAgICAgIH0sXG4gICAgICBTZW5lZ2FsOiB7XG4gICAgICAgIGVuOiBcIlNlbmVnYWxcIixcbiAgICAgICAgZnI6IFwiU8OpbsOpZ2FsXCIsXG4gICAgICB9LFxuICAgICAgXCJTaWVycmEgTGVvbmVcIjoge1xuICAgICAgICBlbjogXCJTaWVycmEgTGVvbmVcIixcbiAgICAgICAgZnI6IFwiU2llcnJhIExlb25lXCIsXG4gICAgICB9LFxuICAgICAgU29tYWxpYToge1xuICAgICAgICBlbjogXCJTb21hbGlhXCIsXG4gICAgICAgIGZyOiBcIlNvbWFsaWVcIixcbiAgICAgIH0sXG4gICAgICBcIlNvdXRoIEFmcmljYVwiOiB7XG4gICAgICAgIGVuOiBcIlNvdXRoIEFmcmljYVwiLFxuICAgICAgICBmcjogXCJBZnJpcXVlIGR1IFN1ZFwiLFxuICAgICAgfSxcbiAgICAgIFwiU291dGggU3VkYW5cIjoge1xuICAgICAgICBlbjogXCJTb3V0aCBTdWRhblwiLFxuICAgICAgICBmcjogXCJTb3VkYW4gZHUgU3VkXCIsXG4gICAgICB9LFxuICAgICAgU3VkYW46IHtcbiAgICAgICAgZW46IFwiU3VkYW5cIixcbiAgICAgICAgZnI6IFwiU291ZGFuXCIsXG4gICAgICB9LFxuICAgICAgVGFuemFuaWE6IHtcbiAgICAgICAgZW46IFwiVGFuemFuaWFcIixcbiAgICAgICAgZnI6IFwiVGFuemFuaWVcIixcbiAgICAgIH0sXG4gICAgICBUb2dvOiB7XG4gICAgICAgIGVuOiBcIlRvZ29cIixcbiAgICAgICAgZnI6IFwiVG9nb1wiLFxuICAgICAgfSxcbiAgICAgIFVnYW5kYToge1xuICAgICAgICBlbjogXCJVZ2FuZGFcIixcbiAgICAgICAgZnI6IFwiT3VnYW5kYVwiLFxuICAgICAgfSxcbiAgICAgIFphbWJpYToge1xuICAgICAgICBlbjogXCJaYW1iaWFcIixcbiAgICAgICAgZnI6IFwiWmFtYmllXCIsXG4gICAgICB9LFxuICAgICAgWmltYmFid2U6IHtcbiAgICAgICAgZW46IFwiWmltYmFid2VcIixcbiAgICAgICAgZnI6IFwiWmltYmFid2VcIixcbiAgICAgIH0sXG4gICAgICBTU0E6IHtcbiAgICAgICAgZW46IFwiU3ViLVNhaGFyYW4gQWZyaWNhXCIsXG4gICAgICAgIGZyOiBcIkFmcmlxdWUgU3Vic2FoYXJpZW5uZVwiLFxuICAgICAgfSxcbiAgICAgIFwiU3ViLVNhaGFyYW4gQWZyaWNhXCI6IHtcbiAgICAgICAgZW46IFwiU3ViLVNhaGFyYW4gQWZyaWNhXCIsXG4gICAgICAgIGZyOiBcIkFmcmlxdWUgU3Vic2FoYXJpZW5uZVwiLFxuICAgICAgfSxcbiAgICB9LFxuICB9LFxufSk7XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTUwIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiaHRtbGA8c3R5bGU+XG4ucGxvdFRvb2x0aXAge1xuICB6LWluZGV4OjI7XG4gIHBhZGRpbmc6IDEwcHggMTBweDtcbiAgY29sb3I6IGJsYWNrO1xuICBib3JkZXItcmFkaXVzOiA0cHg7XG4gIGJvcmRlcjogMXB4IHNvbGlkIHJnYmEoMCwwLDAsMSk7XG4gIHBvaW50ZXItZXZlbnRzOiBub25lO1xuICB0cmFuc2Zvcm06IHRyYW5zbGF0ZSgtNTAlLCAtMTAwJSk7XG4gIGZvbnQtZmFtaWx5OiBcIklCTSBQbGV4IFNhbnNcIiwgXCJTb3VyY2UgU2VyaWYgUHJvXCI7XG4gIGZvbnQtc2l6ZTogMTRweDtcbiAgYmFja2dyb3VuZDogcmdiYSgyNTUsMjU1LDI1NSwgMSk7XG4gIHRyYW5zaXRpb246IDAuM3Mgb3BhY2l0eSBlYXNlLW91dCwgMC4xcyBib3JkZXItY29sb3IgZWFzZS1vdXQ7XG4gIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgZGlzcGxheTogbm9uZTtcbn1cblxuLnBsb3RUb29sdGlwOjpiZWZvcmUge1xuICBjb250ZW50OiBcIlwiO1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIHRvcDogMTAwJTtcbiAgbGVmdDogNTAlO1xuICBtYXJnaW4tbGVmdDogLTVweDtcbiAgYm9yZGVyLXdpZHRoOiA1cHg7XG4gIGJvcmRlci1zdHlsZTogc29saWQ7XG4gIGJvcmRlci1jb2xvcjogYmxhY2sgdHJhbnNwYXJlbnQgdHJhbnNwYXJlbnQgdHJhbnNwYXJlbnQ7XG59XG5cbi5wbG90VG9vbHRpcDo6YWZ0ZXIge1xuICBjb250ZW50OiBcIlwiO1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIHRvcDogY2FsYygxMDAlIC0gMXB4KTtcbiAgbGVmdDogNTAlO1xuICBtYXJnaW4tbGVmdDogLTQuOXB4O1xuICBib3JkZXItd2lkdGg6IDQuOXB4O1xuICBib3JkZXItc3R5bGU6IHNvbGlkO1xuICBib3JkZXItY29sb3I6IHdoaXRlIHRyYW5zcGFyZW50IHRyYW5zcGFyZW50IHRyYW5zcGFyZW50O1xufVxuPC9zdHlsZT5gO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC01MSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImZvcm1UZW1wbGF0ZSA9ICh7IGdhcCA9IFwiMmVtXCIgfSA9IHt9KSA9PiB7XG4gIC8vIHRlbXBsYXRlIGZvciBpbnB1dCBkaXNwbGF5XG4gIHJldHVybiAoaW5wdXRzKSA9PlxuICAgIGh0bWxgPGRpdiBzdHlsZT1cImRpc3BsYXk6IGZsZXg7IGdhcDogJHtnYXB9O1wiPiR7aW5wdXRzfTwvZGl2PmA7XG59O1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC01MiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Imh0bWxgPHN0eWxlPlxuICAgIC8qIFN0eWxpbmcgZm9yIHRvb2x0aXAgbGFiZWxzICovXG4gICAgLnRvb2x0aXAge1xuICAgICAgICBwb3NpdGlvbjogcmVsYXRpdmU7XG4gICAgICAgIGRpc3BsYXk6IGlubGluZS1ibG9jaztcbiAgICAgICAgY3Vyc29yOiBwb2ludGVyO1xuICAgICAgICB3aWR0aDogMTAwJTtcbiAgICB9XG5cbiAgICAudG9vbHRpcCAudG9vbHRpcHRleHQge1xuICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICAgIHotaW5kZXg6IDE7XG4gICAgICAgIHZpc2liaWxpdHk6IGhpZGRlbjsgXG4gICAgICAgIGxlZnQ6IDA7XG4gICAgICAgIGJvdHRvbTogMTAwJTtcbiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogI2VmZWZlZjtcbiAgICAgICAgY29sb3I6ICMzMzM7XG4gICAgICAgIGJvcmRlcjogMHB4IHNvbGlkICMzMzM7XG4gICAgICAgIGJvcmRlci1yYWRpdXM6IDA7XG4gICAgICAgIHBhZGRpbmc6IDBweCAwcHg7XG4gICAgICAgIG1hcmdpbi1ib3R0b206IDAwcHg7XG4gICAgICAgIHRleHQtdHJhbnNmb3JtOiBub25lO1xuICAgICAgICBmb250LXNpemU6IDE0cHg7XG4gICAgICAgIGxpbmUtaGVpZ2h0OiAxLjY7XG4gICAgICAgIHRleHQtYWxpZ246IGxlZnQ7XG4gICAgICAgIG9wYWNpdHk6IDA7XG4gICAgICAgIHRyYW5zaXRpb246IG9wYWNpdHkgMC4zcztcbiAgICB9XG5cbiAgICAudG9vbHRpcDpob3ZlciAudG9vbHRpcHRleHQge1xuICAgICAgICB2aXNpYmlsaXR5OiB2aXNpYmxlO1xuICAgICAgICBvcGFjaXR5OiAxO1xuICAgICAgICBjdXJzb3I6IGRlZmF1bHQ7XG4gICAgfVxuPC9zdHlsZT5gO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC01MyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IntcbiAgcmV0dXJuIG1kYCoqQ29sb3IgU2NhbGVzKipgXG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTU0IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiLy8gY29sb3Igc2NhbGUgaW5mb1xuY29sb3JTY2FsZXMgPSB7XG4gIHJldHVybiB7XG4gICAgcmFuZ2U6IHtcbiAgICAgIGdyZWVuOiBbJyNFNEY1RDAnLCAnIzAxNTAyMyddLFxuICAgICAgYmx1ZTogWycjRThGMkZGJywgJyMwMDNFNkInXSxcbiAgICAgIGJyb3duOiBbJyNGRkZERTUnLCAnI0E4N0IwMCddLFxuICAgICAgeWVsbG93R3JlZW46IFsnI0Y3RDczMicsICcjMjE2NzI5J10sXG4gICAgICBvcmFuZ2VSZWQ6IFsnI0Y0QkIyMScsICcjRUM1QTQ3J10sXG4gICAgfSxcbiAgICB1bmtub3duOiBcIiNjY2NcIlxuICB9XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTU1IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoibWRgLS0tXG4jIyMgQWRtaW4gU2VsZWN0aW9uXG4qR2xvYmFsIGFkbWluIHNlbGVjdG9yIHVzaW5nIGRyb3Bkb3ducypcblxuVGhpcyBpcyB0aGUgZ2xvYmFsIHNlbGVjdG9yIGZvciB0aGUgc2VsZWN0ZWQgcmVnaW9uXG4tIFRoZSBjb21wbGV0ZWQgZGF0YSBpcyBjb250YWluZWQgd2l0aGluIGFkbWluU2VsZWN0aW9ucyB0byBiZSB1c2VkIGluIHF1ZXJpZXNcbi0gRHJvcGRvd25zIGFyZSBkZWZpbmVkIGJlbG93IHRoZW4gYm91bmQgZm9yIGVhY2ggc2VjdGlvblxuICAtIERlZmluZWQgYXMgc2VwYXJhdGUgY2VsbHMgc2luY2UgdGhleSBkeW5hbWljYWxseSByZXNwb25kIHRvIGRpZmZlcmVudCB2YWx1ZXNcbiAgICAtIEluIG5hcnJhdGl2ZSwgdGhleSBhcmUgc2ltcGx5IHZpZXdzIG9mIHRoZSBkYXRhICBcbiAgLSBEcm9wZG93bnMgYXJlIGR5bmFtaWMgYmFzZWQgb24gaGlnaGVyLWxldmVsIGNob2ljZXNcbiAgLSBPcHRpb25zIGFyZSBkZWZpbmVkIGZyb20gdGhlIGdlb2dyYXBoaWMgZGF0YVxuICAtIG51bGwgdmFsdWUgbWVhbnMgdW5zZWxlY3RlZCByZWdpb25cbi0gRHJvcGRvd25zIGFyZSBhZGRlZCB0byBlYWNoIHNlY3Rpb24sIHVzaW5nIElucHV0cy5iaW5kIHRvIGNyZWF0ZSBzeW5jaHJvbml6ZWQgaW5wdXRzIChzZWUgdmlld29mIGZvciBpbnB1dCBkZWZpbml0aW9ucykuIEEgZm9ybSBpbnB1dCBpcyB1c2VkIHRvIGNvbnNvbGlkYXRlIGFuZCBhcHBseSBhIHRlbXBsYXRlIHRvIGZvcm1hdC5gO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC01NiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Ii8vIGdldCBhZG1pbjAgb3B0aW9ucyBmcm9tIGdlb1xuZGF0YUFkbWluMCA9IHtcbiAgY29uc3QgZGF0YSA9IGFkbWluMF9ib3VuZGFyaWVzLmZlYXR1cmVzLm1hcChkID0+IGQucHJvcGVydGllcylcbiAgLy8gYWRkIGEgYmxhbmsgdmFsdWVcbiAgcmV0dXJuIFtudWxsLCAuLi5kYXRhLm1hcChkID0+IGQuYWRtaW5fbmFtZSldXG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTU3IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiLy8gZ2V0IGFkbWluMSBvcHRpb25zIGJhc2VkIG9uIGFkbWluMCBzZWxlY3Rpb25cbi8vICh0aGUgYWRtaW4xIHJlZ2lvbnMgd2l0aGluIHNlbGVjdGVkIGFkbWluMClcbmRhdGFBZG1pbjEgPSB7XG4gIC8vIGFkbWluIDEsIGZpbHRlciBieSAwIFxuICBjb25zdCBkYXRhID0gYWRtaW4xX2JvdW5kYXJpZXMuZmVhdHVyZXMubWFwKGQgPT4gZC5wcm9wZXJ0aWVzKVxuICAuZmlsdGVyKGQgPT4gZC5hZG1pbjBfbmFtZSA9PSBzZWxlY3RBZG1pbjApXG4gIC8vIGFkZCBibGFuayB2YWx1ZVxuICByZXR1cm4gW251bGwsIC4uLmRhdGEubWFwKGQgPT4gZC5hZG1pbjFfbmFtZSldXG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTU4IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiLy8gZ2V0IGFkbWluMiBvcHRpb25zIGJhc2VkIG9uIGFkbWluMSBzZWxlY3Rpb25cbi8vICh0aGUgYWRtaW4yIHJlZ2lvbnMgd2l0aGluIHNlbGVjdGVkIGFkbWluMSlcbmRhdGFBZG1pbjIgPSB7XG4gIGNvbnN0IGRhdGEgPSBib3VuZGFyaWVzLmFkbWluMi5mZWF0dXJlcy5tYXAoZCA9PiBkLnByb3BlcnRpZXMpXG4gIC5maWx0ZXIoZCA9PiBkLmFkbWluMF9uYW1lID09IHNlbGVjdEFkbWluMCAmJiBkLmFkbWluMV9uYW1lID09IHNlbGVjdEFkbWluMSlcbiAgLy8gYWRkIGJsYW5rIHZhbHVlXG4gIHJldHVybiBbbnVsbCwgLi4uZGF0YS5tYXAoZCA9PiBkLmFkbWluMl9uYW1lKV1cbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNTkiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJtZGAjIyBHbG9iYWwgaW1wYWN0cyBkYXRhYDtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNjAiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJjcm9wX29wdGlvbnNfaXRlbXMgPSB7XG4gIHJldHVybiBbXG4gICAgICB7aWQ6IDAsIENyb3A6IFwibWFpemVcIn0sXG4gICAgICB7aWQ6IDEsIENyb3A6IFwicmljZVwifSwgXG4gICAgICB7aWQ6IDIsIENyb3A6IFwic295YmVhblwifSxcbiAgICAgIHtpZDogMywgQ3JvcDogXCJ3aGVhdFwifVxuICBdO1xufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC02MSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Ii8vIG1ha2UgYSBsYWJlbCBmb3Igc2VsZWN0b3Jcbi8vIGh0bWwgd2l0aCB0b29sdGlwIG9uIGhvdmVyXG5mdW5jdGlvbiBtYWtlVG9vbHRpcExhYmVsKHtcbiAgbGFiZWxUZXh0ID0gXCJEcm9wZG93biBsYWJlbFwiLFxuICB0b29sdGlwVGV4dCA9IFwiVG9vbHRpcCB0ZXh0XCIsXG59ID0ge30pIHtcbiAgcmV0dXJuIGh0bC5odG1sYDxzcGFuIGNsYXNzPVwidG9vbHRpcFwiPlxuICAgIDxzcGFuIGZvcj1cImlucHV0RmllbGRcIj4ke2xhYmVsVGV4dH08L3NwYW4+XG4gICAgPHNwYW4gY2xhc3M9XCJ0b29sdGlwdGV4dFwiPiR7dG9vbHRpcFRleHR9PC9zcGFuPlxuPC9zcGFuPmA7XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTYyIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiZGVib3VuY2UgPSAoZGVsYXksIGlucHV0KSA9PiB7XG4gIGNsYXNzIERlbGF5ZWRFdmVudCBleHRlbmRzIEV2ZW50IHt9XG4gIGxldCBpZDtcbiAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIChlKSA9PiB7XG4gICAgaWYgKGUgaW5zdGFuY2VvZiBEZWxheWVkRXZlbnQpIHJldHVybjtcbiAgICBlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xuICAgIGNsZWFyVGltZW91dChpZCk7XG4gICAgaWQgPSBzZXRUaW1lb3V0KFxuICAgICAgKCkgPT4gaW5wdXQuZGlzcGF0Y2hFdmVudChuZXcgRGVsYXllZEV2ZW50KFwiaW5wdXRcIiwgeyBidWJibGVzOiB0cnVlIH0pKSxcbiAgICAgIGRlbGF5LFxuICAgICk7XG4gIH0pO1xuICByZXR1cm4gaW5wdXQ7XG59O1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC02MyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImRlYm91bmNlRGVsYXkgPSA1MDA7IC8vIG1zIGRlbGF5IHRvIHJlc3BvbmRcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNjQiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ2aWV3b2Ygc2VsZWN0X2Nyb3AgPSB7XG4gIGNvbnN0IGNoZWNrYm94ID0gSW5wdXRzLmNoZWNrYm94KGNyb3Bfb3B0aW9uc19pdGVtcy5tYXAoKGQpID0+IGQuQ3JvcCksIHsgbGFiZWw6IFwiQ3JvcHNcIiwgdmFsdWU6IFsnbWFpemUnXSB9KTtcbiAgY2hlY2tib3guYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoKSA9PiB7XG4gICAgaWYgKGNoZWNrYm94LnZhbHVlLmxlbmd0aCA9PT0gMCkge1xuICAgICAgY2hlY2tib3gudmFsdWUgPSBbJ21haXplJ107XG4gICAgfVxuICB9KTtcbiAgcmV0dXJuIGNoZWNrYm94IH1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNjUiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ2aWV3b2YgY3JvcF9zZWxlY3Rvcl95aWVsZCA9IHtcbiAgcmV0dXJuIElucHV0cy5zZWxlY3QoXG4gICAgW1wibWFpemVcIiwgXCJyaWNlXCIsIFwid2hlYXRcIl0sXG4gICAge2xhYmVsOiBfbGFuZyhuYlRleHQuZ2VuZXJhbC5jcm9wKSxcbiAgICBmb3JtYXQ6IGMgPT4gX2xhbmcobmJUZXh0LmdlbmVyYWwuY3JvcHNbY10pfVxuICApICBcbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNjYiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ2aWV3b2Ygc2VsX3JlZ2lvbiA9IHtcbiAgcmV0dXJuIElucHV0cy5zZWxlY3QoXG4gICAgYXZhbGlhYmxlX3VuUmVnaW9ucyxcbiAgICB7bGFiZWw6IF9sYW5nKG5iVGV4dC5yZWdpb25hbFBpY3R1cmUuYmVlc3dhcm0ueUF4aXMpLFxuICAgIGZvcm1hdDogZCA9PiAgX2xhbmcobmJUZXh0LnJlZ2lvbmFsUGljdHVyZS5iZWVzd2FybS5yZWdpb25zW2QgfHwgXCJhbGxcIl0pfSAvLyBObyByZWdpb24gaXMgTlVMTCBzbyBhZGQgYSBsYWJlbFxuICApICBcbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNjciLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJzZWxlY3RlZF9jcm9wX2dsb2JhbCA9IFtjcm9wX3NlbGVjdG9yX3lpZWxkXTtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNjgiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ3YXJtaW5nX2xldmVsX29wdGlvbnMgPSB7XG4gIHJldHVybiB7XG4gICAgICAwOiB7bWluOiAtSW5maW5pdHksIG1heDogMS41LCBsYWJlbDogXCI8MS41XCJ9LFxuICAgICAgMToge21pbjogMS41LCBtYXg6IDIuMCwgbGFiZWw6IFwiMS41LTIuMFwifSxcbiAgICAgIDI6IHttaW46IDIuMCwgbWF4OiAzLjAsIGxhYmVsOiBcIjIuMC0zLjBcIn0sXG4gICAgICAzOiB7bWluOiAzLjAsIG1heDogSW5maW5pdHksIGxhYmVsOiBcIj4zLjBcIn1cbiAgfVxufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC02OSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImltcGFjdHNfbWV0YWFuYWx5c2lzX2RhdGEgPSB7XG4gIC8vIEV4Y3VzZSB0aGUgbmFtZXMuLiB0aGUgUiBleHBvcnQgXCJjbGVhbmVkXCIgdGhlbS4uLlxuICBsZXQgc3FsUXVlcnkgPSBgXG4gICAgU0VMRUNUIFxuICAgICAgTE9XRVIoQ3JvcCkgYXMgQ3JvcCxcbiAgICAgIENvdW50cnksXG4gICAgICBcIlByb2plY3RlZC55aWVsZC4udC5oYS5cIiBhcyBwcm9qX3lpZWxkLFxuICAgICAgXCJDbGltYXRlLmltcGFjdHMuLi4uXCIgYXMgeWllbGRfaW1wYWN0X3BjdCxcbiAgICAgIFwiR2xvYmFsLmRlbHRhLlQuZnJvbS5wcmUuaW5kdXN0cmlhbC5wZXJpb2RcIiBhcyBwcmVpbmR1c3RyaWFsX3RlbXBfZGVsdGEsXG4gICAgICBcIkdsb2JhbC5kZWx0YS5ULmZyb20uMjAwNVwiIGFzIHRlbXBfZGVsdGFfMjAwNSxcbiAgICAgIFJlZmVyZW5jZSxcbiAgICAgIEFkYXB0YXRpb24sXG4gICAgRlJPTSBwcm9qZWN0ZWRfaW1wYWN0c1xuICAgIFdIRVJFIFJlZ2lvbiA9ICdBZnJpY2EnXG4gICAgQU5EIExPV0VSKENyb3ApID0gJyR7Y3JvcF9zZWxlY3Rvcl95aWVsZH0nYFxuXG4gIGxldCBmaWx0ZXJlZCA9IGF3YWl0IGRiMi5xdWVyeShzcWxRdWVyeSkgLy8gUHV0IHRoaXMgaW4gYSBzZXBlcmF0ZSBkYiAobm9uLWVuY3J5cHRlZCkgdG8gYm9vc3QgbG9hZCB0aW1lIG9mIGZpcnN0IGZpZ3VyZVxuXG4gIGZpbHRlcmVkID0gZmlsdGVyZWQubWFwKGl0ZW0gPT4gKHtcbiAgICAuLi5pdGVtLFxuICAgIFVOUmVnaW9uOiBjb3VudHJ5X3RvX3JlZ2lvbltpdGVtLkNvdW50cnkudG9Mb3dlckNhc2UoKS50cmltKCldXG4gIH0pKTtcbiAgcmV0dXJuIGZpbHRlcmVkO1xufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC03MCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImRiMiA9IER1Y2tEQkNsaWVudC5vZih7XG4gIHByb2plY3RlZF9pbXBhY3RzOiBGaWxlQXR0YWNobWVudChcInByb2plY3RlZC1pbXBhY3RzX2hhc2FnYXdhLnBhcnF1ZXRcIiksXG59KTtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNzEiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJhdmFsaWFibGVfdW5SZWdpb25zID0gbmV3IFNldChbXG4gIG51bGwsXG4gIC4uLmltcGFjdHNfbWV0YWFuYWx5c2lzX2RhdGEubWFwKChkKSA9PiBkLlVOUmVnaW9uKSxcbl0pOyAvLyBudWxsIGZvciBhbGwgb2YgYWZyaWNhXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTcyIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoidmlvbGluX2luc2lnaHRfZGF0YSA9IHtcbiAgbGV0IGRhdGEgPSBpbXBhY3RzX21ldGFhbmFseXNpc19kYXRhXG4gICAgLm1hcChkID0+ICh7XG4gICAgICAuLi5kLFxuICAgICAgdGVtcF9iYW5kOiBjbGFzc2lmeVRlbXBCYW5kKGQucHJlaW5kdXN0cmlhbF90ZW1wX2RlbHRhKVxuICAgIH0pKTtcblxuICBsZXQgcmVnaW9uX2RhdGEgPSBkYXRhXG4gICAgLmZpbHRlcihkID0+IFxuICAgICAgIXNlbF9yZWdpb24gfHwgZD8uVU5SZWdpb24gPT09IHNlbF9yZWdpb25cbiAgICApXG5cbiAgY29uc3QgbWVkaWFuX3lpZWxkcyA9IE9iamVjdC5mcm9tRW50cmllcyhcbiAgICBkMy5ncm91cHMocmVnaW9uX2RhdGEsIGQgPT4gZC50ZW1wX2JhbmQpLm1hcCgoW2IsIHJvd3NdKSA9PiBbXG4gICAgICBiLFxuICAgICAge1xuICAgICAgICBtZWRpYW5fd2l0aG91dF9hZGFwdGF0aW9uOiBkMy5tZWRpYW4ocm93cy5maWx0ZXIoZCA9PiBkLkFkYXB0YXRpb24gPT09IFwiTm9cIiksIGQgPT4gK2QueWllbGRfaW1wYWN0X3BjdCkgPz8gbnVsbCxcbiAgICAgICAgbWVkaWFuX3dpdGhfYWRhcHRhdGlvbjogZDMubWVkaWFuKHJvd3MuZmlsdGVyKGQgPT4gZC5BZGFwdGF0aW9uID09PSBcIlllc1wiKSwgZCA9PiArZC55aWVsZF9pbXBhY3RfcGN0KSA/PyBudWxsLFxuICAgICAgfVxuICAgIF0pXG4gICk7XG4gIFxuICBjb25zdCB3b3JzdFJlZ2lvbnNCeUJhbmQgPSBPYmplY3QuZnJvbUVudHJpZXMoIC8vIHRoaXMgc2hvdWxkIHVzZSB0aGUgdW5maWx0ZXJlZCBkYXRhIHdpdGggYWxsIHJlZ2lvbnNcbiAgICBkMy5ncm91cHMoZGF0YSwgZCA9PiBkLnRlbXBfYmFuZCA/PyBcIlVuc3BlY2lmaWVkXCIpLm1hcCgoW2IsIHJvd3NdKSA9PiB7XG4gICAgICBjb25zdCBieSA9IHN1YnNldCA9PiB7XG4gICAgICAgIGNvbnN0IHJtYXAgPSBkMy5yb2xsdXAoc3Vic2V0LCB2ID0+IGQzLm1lZGlhbih2LCBkID0+ICtkLnlpZWxkX2ltcGFjdF9wY3QpLCBkID0+IGQuVU5SZWdpb24gPz8gXCJVbnNwZWNpZmllZFwiKTtcbiAgICAgICAgaWYgKCFybWFwLnNpemUpIHJldHVybiBudWxsO1xuICAgICAgICBjb25zdCBtaW5WYWwgPSBkMy5taW4ocm1hcC52YWx1ZXMoKSk7XG4gICAgICAgIGNvbnN0IHdvcnN0ID0gWy4uLnJtYXBdLmZpbHRlcigoWywgbV0pID0+IG0gPT09IG1pblZhbClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5tYXAoKFtyLCBtZWRpYW5Mb3NzXSkgPT4gKHsgcmVnaW9uOiByLCBtZWRpYW5Mb3NzIH0pKTtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiB3b3JzdC5sZW5ndGggPT09IDEgPyB3b3JzdFswXSA6IHdvcnN0O1xuICAgICAgfTtcbiAgICAgIHJldHVybiBbYiwge1xuICAgICAgICB3b3JzdF9yZWdpb25fd2l0aG91dF9hZGFwdGF0aW9uOiBieShyb3dzLmZpbHRlcihkID0+IGQuQWRhcHRhdGlvbiA9PT0gXCJOb1wiKSksXG4gICAgICAgIHdvcnN0X3JlZ2lvbl93aXRoX2FkYXB0YXRpb246IGJ5KHJvd3MuZmlsdGVyKGQgPT4gZC5BZGFwdGF0aW9uID09PSBcIlllc1wiKSksXG4gICAgICB9XTtcbiAgICB9KVxuICApO1xuICBcbiAgcmV0dXJue1xuICAgIG1lZGlhbl95aWVsZHMsXG4gICAgd29yc3RfcmVnaW9uOiB3b3JzdFJlZ2lvbnNCeUJhbmRcbiAgfVxufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC03MyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImZ1bmN0aW9uIGNsYXNzaWZ5VGVtcEJhbmQodGVtcCkge1xuICBpZiAodGVtcCA8PSAyKSByZXR1cm4gXCLiiaQgMsKwQ1wiOyAvLyByZXR1cm4gXCLiiaQgMS41wrBDXCI7XG4gIGlmICh0ZW1wIDw9IDMpIHJldHVybiBcIjItM8KwQ1wiOyAvLyByZXR1cm4gXCIxLjXigJMyLjXCsENcIjtcbiAgcmV0dXJuIFwiPiAzwrBDXCI7IC8vIFwiPiAyLjXCsENcIlxufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC03NCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InRlbXBfb3B0cyA9IFtcIuKJpCAywrBDXCIsIFwiMi0zwrBDXCIsIFwiPiAzwrBDXCJdO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC03NSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Im1kYCMjIER5bmFtaWMgSW5zaWdodHNgO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC03NiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImNvdW50cnlfdG9fcmVnaW9uID0ge1xuICAgIHJldHVybiB7XG4gIFwiYWxnZXJpYVwiOiBcIk5vcnRoZXJuXCIsXG4gICBcImVneXB0XCI6IFwiTm9ydGhlcm5cIixcbiAgIFwibGlieWFcIjogXCJOb3J0aGVyblwiLFxuICAgXCJtb3JvY2NvXCI6IFwiTm9ydGhlcm5cIixcbiAgIFwic3VkYW5cIjogXCJOb3J0aGVyblwiLFxuICAgXCJ0dW5pc2lhXCI6IFwiTm9ydGhlcm5cIixcbiAgIFwid2VzdGVybiBzYWhhcmFcIjogXCJOb3J0aGVyblwiLFxuICAgXCJzeXJpYVwiOiBcIk5vcnRoZXJuXCIsXG4gICBcImJyaXRpc2ggaW5kaWFuIG9jZWFuIHRlcnJpdG9yeVwiOiBcIkVhc3Rlcm5cIixcbiAgIFwiYnVydW5kaVwiOiBcIkVhc3Rlcm5cIixcbiAgIFwiY29tb3Jvc1wiOiBcIkVhc3Rlcm5cIixcbiAgIFwiZGppYm91dGlcIjogXCJFYXN0ZXJuXCIsXG4gICBcImVyaXRyZWFcIjogXCJFYXN0ZXJuXCIsXG4gICBcImV0aGlvcGlhXCI6IFwiRWFzdGVyblwiLFxuICAgXCJmcmVuY2ggc291dGhlcm4gdGVycml0b3JpZXNcIjogXCJFYXN0ZXJuXCIsXG4gICBcImtlbnlhXCI6IFwiRWFzdGVyblwiLFxuICAgXCJtYWRhZ2FzY2FyXCI6IFwiRWFzdGVyblwiLFxuICAgXCJtYWxhd2lcIjogXCJFYXN0ZXJuXCIsXG4gICBcIm1hdXJpdGl1c1wiOiBcIkVhc3Rlcm5cIixcbiAgIFwibWF5b3R0ZVwiOiBcIkVhc3Rlcm5cIixcbiAgIFwibW96YW1iaXF1ZVwiOiBcIkVhc3Rlcm5cIixcbiAgIFwicsOpdW5pb25cIjogXCJFYXN0ZXJuXCIsXG4gICBcInJ3YW5kYVwiOiBcIkVhc3Rlcm5cIixcbiAgIFwic2V5Y2hlbGxlc1wiOiBcIkVhc3Rlcm5cIixcbiAgIFwic29tYWxpYVwiOiBcIkVhc3Rlcm5cIixcbiAgIFwic291dGggc3VkYW5cIjogXCJFYXN0ZXJuXCIsXG4gICBcInVnYW5kYVwiOiBcIkVhc3Rlcm5cIixcbiAgIFwidW5pdGVkIHJlcHVibGljIG9mIHRhbnphbmlhXCI6IFwiRWFzdGVyblwiLFxuICAgXCJ6YW1iaWFcIjogXCJFYXN0ZXJuXCIsXG4gICBcInppbWJhYndlXCI6IFwiRWFzdGVyblwiLFxuICAgXCJ0YW56YW5pYVwiOiBcIkVhc3Rlcm5cIixcbiAgIFwiYW5nb2xhXCI6IFwiQ2VudHJhbFwiLFxuICAgXCJjYW1lcm9vblwiOiBcIkNlbnRyYWxcIixcbiAgIFwiY2VudHJhbCBhZnJpY2FuIHJlcHVibGljXCI6IFwiQ2VudHJhbFwiLFxuICAgXCJjaGFkXCI6IFwiQ2VudHJhbFwiLFxuICAgXCJjb25nb1wiOiBcIkNlbnRyYWxcIixcbiAgIFwiZGVtb2NyYXRpYyByZXB1YmxpYyBvZiB0aGUgY29uZ29cIjogXCJDZW50cmFsXCIsXG4gICBcImVxdWF0b3JpYWwgZ3VpbmVhXCI6IFwiQ2VudHJhbFwiLFxuICAgXCJnYWJvblwiOiBcIkNlbnRyYWxcIixcbiAgIFwic2FvIHRvbWUgYW5kIHByaW5jaXBlXCI6IFwiQ2VudHJhbFwiLFxuICAgXCJib3Rzd2FuYVwiOiBcIlNvdXRoZXJuXCIsXG4gICBcImVzd2F0aW5pXCI6IFwiU291dGhlcm5cIixcbiAgIFwibGVzb3Rob1wiOiBcIlNvdXRoZXJuXCIsXG4gICBcIm5hbWliaWFcIjogXCJTb3V0aGVyblwiLFxuICAgXCJzb3V0aCBhZnJpY2FcIjogXCJTb3V0aGVyblwiLFxuICAgXCJiZW5pblwiOiBcIldlc3Rlcm5cIixcbiAgIFwiYnVya2luYSBmYXNvXCI6IFwiV2VzdGVyblwiLFxuICAgXCJjYWJvIHZlcmRlXCI6IFwiV2VzdGVyblwiLFxuICAgXCJjb3RlIGQnbHZvaXJlXCI6IFwiV2VzdGVyblwiLFxuICAgXCJnYW1iaWFcIjogXCJXZXN0ZXJuXCIsXG4gICBcImdoYW5hXCI6IFwiV2VzdGVyblwiLFxuICAgXCJndWluZWFcIjogXCJXZXN0ZXJuXCIsXG4gICBcImd1aW5lYS1iaXNzYXVcIjogXCJXZXN0ZXJuXCIsXG4gICBcImxpYmVyaWFcIjogXCJXZXN0ZXJuXCIsXG4gICBcIm1hbGlcIjogXCJXZXN0ZXJuXCIsXG4gICBcIm1hdXJpdGFuaWFcIjogXCJXZXN0ZXJuXCIsXG4gICBcIm5pZ2VyXCI6IFwiV2VzdGVyblwiLFxuICAgXCJuaWdlcmlhXCI6IFwiV2VzdGVyblwiLFxuICAgXCJzYWludCBoZWxlbmEsIGFzY2Vuc2lvbiBhbmQgdHJpc3RhbiBkYSBjdW5oYVwiOiBcIldlc3Rlcm5cIixcbiAgIFwic2FpbnQgaGVsZW5hXCI6IFwiV2VzdGVyblwiLFxuICAgXCJhc2NlbnNpb24gaXNsYW5kXCI6IFwiV2VzdGVyblwiLFxuICAgXCJ0cmlzdGFuIGRhIGN1bmhhXCI6IFwiV2VzdGVyblwiLFxuICAgXCJzZW5lZ2FsXCI6IFwiV2VzdGVyblwiLFxuICAgXCJzaWVycmEgbGVvbmVcIjogXCJXZXN0ZXJuXCIsXG4gICBcInRvZ29cIjogXCJXZXN0ZXJuXCIsXG4gICBcInN1ZGFuIHNhdmFubmFcIjogXCJXZXN0ZXJuXCIsXG4gICBcImd1aW5lYSBiaXNzYXVcIjogXCJXZXN0ZXJuXCJcbiAgfX1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNzciLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ2aWV3b2YgY3JvcF9zZWxlY3Rvcl9keW5hbWljX2luc2lnaHRzID0ge1xuICByZXR1cm4gSW5wdXRzLnNlbGVjdChcbiAgICBbXCJtYWl6ZVwiLCBcInNvcmdodW1cIiwgXCJtaWxsZXRcIiwgXCJ3aGVhdFwiXSxcbiAgICB7bGFiZWw6IF9sYW5nKG5iVGV4dC5nZW5lcmFsLmNyb3ApLFxuICAgIGZvcm1hdDogYyA9PiBfbGFuZyhuYlRleHQuZ2VuZXJhbC5jcm9wc1tjXSl9XG4gICkgIFxufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC03OCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImN5Y2xlX3NlbGVjdG9yX29wdGlvbnNfZGkgPSB7XG4gIHJldHVybiB7XG4gICAgICAwOiB7Y3ljbGU6IFwiYm90aFwiLCBsYWJlbDogX2xhbmcobmJUZXh0Lnpvb21Ub1N0YWJsZS5zZWxlY3RvcnMuZ3Jvd1NlYXNvbi52YWx1ZXMuYm90aCl9LFxuICAgICAgMToge2N5Y2xlOiBcIjFcIiwgbGFiZWw6IF9sYW5nKG5iVGV4dC56b29tVG9TdGFibGUuc2VsZWN0b3JzLmdyb3dTZWFzb24udmFsdWVzLmZpcnN0KX0sXG4gICAgICAyOiB7Y3ljbGU6IFwiMlwiLCBsYWJlbDogX2xhbmcobmJUZXh0Lnpvb21Ub1N0YWJsZS5zZWxlY3RvcnMuZ3Jvd1NlYXNvbi52YWx1ZXMuc2Vjb25kKX0sXG4gIH1cbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNzkiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJzZWxlY3RlZF9jeWNsZV9vcHRpb25zID0gT2JqZWN0LnZhbHVlcyhjeWNsZV9zZWxlY3Rvcl9vcHRpb25zX2RpKS5maW5kKFxuICAob3B0aW9uKSA9PiBvcHRpb24ubGFiZWwgPT09IGN5Y2xlX3NlbGVjdG9yX2RpLFxuKTtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtODAiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ2aWV3b2YgY3ljbGVfc2VsZWN0b3JfZGkgPSB7XG4gIHJldHVybiBJbnB1dHMuc2VsZWN0KFxuICAgICAgT2JqZWN0LnZhbHVlcyhjeWNsZV9zZWxlY3Rvcl9vcHRpb25zX2RpKS5tYXAoKHgpID0+IHgubGFiZWwpLFxuICAgICAge2xhYmVsOiBfbGFuZyhuYlRleHQuem9vbVRvU3RhYmxlLnNlbGVjdG9ycy5ncm93U2Vhc29uLnRpdGxlKSB9XG4gICkgIFxufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC04MSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InNjZW5hcmlvX29wdGlvbnMgPSB7XG4gIHJldHVybiB7XG4gICAgICAwOiB7c3NwOiBcIlNTUDM3MFwiLCBob3Jpem9uOiAyMDMwLCBsYWJlbDogXCJTU1AzLTcuMDogMjAyMS0yMDQwXCJ9LFxuICAgICAgMToge3NzcDogXCJTU1AzNzBcIiwgaG9yaXpvbjogMjAwNSwgbGFiZWw6IF9sYW5nKG5iVGV4dC5nZW5lcmFsLmhpc3RvcmljYWwpfSxcbiAgICAgIDI6IHtzc3A6IFwiU1NQMzcwXCIsIGhvcml6b246IDIwNTAsIGxhYmVsOiBcIlNTUDMtNy4wOiAyMDQxLTIwNjBcIn0sXG4gICAgICAzOiB7c3NwOiBcIlNTUDU4NVwiLCBob3Jpem9uOiAyMDMwLCBsYWJlbDogXCJTU1A1LTguNTogMjAyMS0yMDQwXCJ9LFxuICAgICAgNDoge3NzcDogXCJTU1A1ODVcIiwgaG9yaXpvbjogMjA1MCwgbGFiZWw6IFwiU1NQNS04LjU6IDIwNDEtMjA2MFwifVxuICB9XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTgyIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoidmlld29mIHNjZW5hcmlvX3NlbGVjdG9yX2RpID0ge1xuICByZXR1cm4gSW5wdXRzLnNlbGVjdChcbiAgICAgIE9iamVjdC52YWx1ZXMoc2NlbmFyaW9fb3B0aW9ucykubWFwKCh4KSA9PiB4LmxhYmVsKSxcbiAgICAgIHtsYWJlbDogX2xhbmcobmJUZXh0LmdlbmVyYWwuc2NlbmFyaW8pLFxuICAgICAgIGZvcm1hdDogbCA9PiBsID09PSBcIkhpc3RvcmljYWxcIj8gX2xhbmcobmJUZXh0LmdlbmVyYWwuaGlzdG9yaWNhbCkgOiBsfVxuICApICBcbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtODMiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJzZWxlY3RlZF9zY2VuYXJpbyA9IE9iamVjdC52YWx1ZXMoc2NlbmFyaW9fb3B0aW9ucykuZmluZChcbiAgKG9wdGlvbikgPT4gb3B0aW9uLmxhYmVsID09PSBzY2VuYXJpb19zZWxlY3Rvcl9kaSxcbik7XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTg0IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoieWllbGRfb3V0cHV0X29wdGlvbnMgPSB7XG4gIHJldHVybiB7XG4gICAgMDoge2xhYmVsOiBcIllpZWxkIGNoYW5nZSAodG9uL2hhKVwifSxcbiAgICAxOiB7bGFiZWw6IFwiWWllbGQgKHRvbi9oYSlcIn0sXG4gICAgMjoge2xhYmVsOiBcIllpZWxkIGNoYW5nZSAoJSlcIn0sXG4gICAgMzoge2xhYmVsOiBcIlVuY2VydGFpbnR5IGluIHlpZWxkICh0b24vaGEpXCJ9LFxuICB9XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTg1IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoidmlld29mIHlpZWxkX291dHB1dF9zZWxlY3Rvcl9kaSA9IHtcbiBsZXQgb3B0aW9ucyBcbiAgIGlmIChzY2VuYXJpb19zZWxlY3Rvcl9kaSA9PT0gXCJIaXN0b3JpcXVlXCIgfHwgc2NlbmFyaW9fc2VsZWN0b3JfZGkgPT09IFwiSGlzdG9yaWNcIikge1xuICAgICBvcHRpb25zID0gW1wiWWllbGQgKHRvbi9oYSlcIiwgXCJVbmNlcnRhaW50eSBpbiB5aWVsZCAodG9uL2hhKVwiXVxuICAgfSBlbHNlIHtcbiAgICAgb3B0aW9ucyA9IE9iamVjdC52YWx1ZXMoeWllbGRfb3V0cHV0X29wdGlvbnMpLm1hcCgoeCkgPT4geC5sYWJlbClcbiAgIH1cbiAgcmV0dXJuIElucHV0cy5zZWxlY3QoXG4gICAgICBvcHRpb25zLFxuICAgICAge2xhYmVsOiBfbGFuZyhuYlRleHQuem9vbVRvU3RhYmxlLnNlbGVjdG9ycy5ZaWVsZE91dHB1dC50aXRsZSksXG4gICAgICAgZm9ybWF0OiBsID0+IF9sYW5nKG5iVGV4dC56b29tVG9TdGFibGUuc2VsZWN0b3JzLllpZWxkT3V0cHV0LnZhbHVlc1tsXSl9XG4gICkgIFxufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC04NiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InNlbGVjdGVkX3lpZWxkX291dHB1dCA9IE9iamVjdC52YWx1ZXMoeWllbGRfb3V0cHV0X29wdGlvbnMpLmZpbmQoXG4gIChvcHRpb24pID0+IG9wdGlvbi5sYWJlbCA9PT0geWllbGRfb3V0cHV0X3NlbGVjdG9yX2RpLFxuKTtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtODciLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJjdWx0aXZhcl9vcHRpb25zID0ge1xuICByZXR1cm4ge1xuICAgIDA6IHtsYWJlbDogX2xhbmcobmJUZXh0Lnpvb21Ub1N0YWJsZS5zZWxlY3RvcnMuQ3VsdGl2YXIudmFsdWVzLmN1cnJlbnQpLCB2YWx1ZTogXCJjdXJyZW50XCJ9LFxuICAgIDE6IHtsYWJlbDogX2xhbmcobmJUZXh0Lnpvb21Ub1N0YWJsZS5zZWxlY3RvcnMuQ3VsdGl2YXIudmFsdWVzLmVhcmx5KSwgdmFsdWU6IFwiZWFybHlcIn0sXG4gICAgMjoge2xhYmVsOiBfbGFuZyhuYlRleHQuem9vbVRvU3RhYmxlLnNlbGVjdG9ycy5DdWx0aXZhci52YWx1ZXMubGF0ZSksIHZhbHVlOiBcImxhdGVcIn0sXG4gIH1cbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtODgiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ2aWV3b2YgY3VsdGl2YXJfc2VsZWN0b3JfZGkgPSB7XG4gIHJldHVybiBJbnB1dHMuc2VsZWN0KFxuICAgICAgT2JqZWN0LnZhbHVlcyhjdWx0aXZhcl9vcHRpb25zKS5tYXAoKHgpID0+IHgubGFiZWwpLFxuICAgICAge2xhYmVsOiBfbGFuZyhuYlRleHQuem9vbVRvU3RhYmxlLnNlbGVjdG9ycy5DdWx0aXZhci50aXRsZSkgfVxuICApICBcbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtODkiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJzZWxlY3RlZF9jdWx0aXZhciA9IE9iamVjdC52YWx1ZXMoY3VsdGl2YXJfb3B0aW9ucykuZmluZChcbiAgKG9wdGlvbikgPT4gb3B0aW9uLmxhYmVsID09PSBjdWx0aXZhcl9zZWxlY3Rvcl9kaSxcbik7XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTkwIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiem9vbV9pbl9lbGVtZW50cyA9IHtcbiAgY29uc3QgZm9ybSA9IFtcbiAgICAgIHZpZXdvZiBjcm9wX3NlbGVjdG9yX2R5bmFtaWNfaW5zaWdodHMsXG4gICAgICB2aWV3b2YgY3ljbGVfc2VsZWN0b3JfZGksXG4gICAgICB2aWV3b2Ygc2NlbmFyaW9fc2VsZWN0b3JfZGksXG4gICAgICB2aWV3b2YgeWllbGRfb3V0cHV0X3NlbGVjdG9yX2RpLFxuICAgICAgdmlld29mIGN1bHRpdmFyX3NlbGVjdG9yX2RpLFxuICBdXG4gIHJldHVybiBmb3JtXG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTkxIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoidmlld29mIHNlbGVjdEFkbWluMCA9IElucHV0cy5zZWxlY3QoZGF0YUFkbWluMCwge2xhYmVsOiBhZG1pblJlZ2lvbnMubGFiZWxzLmFkbWluMH0pXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTkyIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoidmlld29mIHNlbGVjdEFkbWluMSA9IElucHV0cy5zZWxlY3QoZGF0YUFkbWluMSwge2xhYmVsOiBhZG1pblJlZ2lvbnMubGFiZWxzLmFkbWluMX0pXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTkzIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoidmlld29mIHNlbGVjdEFkbWluMiA9IElucHV0cy5zZWxlY3QoZGF0YUFkbWluMiwge2xhYmVsOiBhZG1pblJlZ2lvbnMubGFiZWxzLmFkbWluMn0pXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTk0IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiLy8gc2VsZWN0ZWQgYWRtaW4gcmVnaW9ucyBmcm9tIGRyb3Bkb3duc1xuYWRtaW5TZWxlY3Rpb25zID0gbmV3IE9iamVjdCh7XG4gIHNlbGVjdEFkbWluMCxcbiAgc2VsZWN0QWRtaW4xLFxuICBzZWxlY3RBZG1pbjIsXG59KTtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtOTUiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJmdW5jdGlvbiBhcnJheU1pbihhcnIpIHtcbiAgdmFyIGxlbiA9IGFyci5sZW5ndGgsXG4gICAgbWluID0gSW5maW5pdHk7XG4gIHdoaWxlIChsZW4tLSkge1xuICAgIGlmIChhcnJbbGVuXSA8IG1pbikge1xuICAgICAgbWluID0gYXJyW2xlbl07XG4gICAgfVxuICB9XG4gIHJldHVybiBtaW47XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTk2IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiZnVuY3Rpb24gYXJyYXlNYXgoYXJyKSB7XG4gIHZhciBsZW4gPSBhcnIubGVuZ3RoLFxuICAgIG1heCA9IC1JbmZpbml0eTtcbiAgd2hpbGUgKGxlbi0tKSB7XG4gICAgaWYgKGFycltsZW5dID4gbWF4KSB7XG4gICAgICBtYXggPSBhcnJbbGVuXTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIG1heDtcbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtOTciLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJmdW5jdGlvbiBnZXRfeWllbGRfY29sdW1uKHlpZWxkX291dHB1dF9zZWxlY3Rpb24sIHlpZWxkX3R5cGUpIHtcbiAgcmV0dXJuIHtcbiAgICBcIllpZWxkICh0b24vaGEpXCI6IFwieWllbGRfXCIgKyB5aWVsZF90eXBlICsgXCJfYXZnXCIsXG4gICAgXCJZaWVsZCBjaGFuZ2UgKHRvbi9oYSlcIjogXCJ5aWVsZF9cIiArIHlpZWxkX3R5cGUgKyBcIl9hYnNfY2hhbmdlXCIsXG4gICAgXCJZaWVsZCBjaGFuZ2UgKCUpXCI6IFwieWllbGRfXCIgKyB5aWVsZF90eXBlICsgXCJfcmx0X2NoYW5nZVwiLFxuICAgIFwiVW5jZXJ0YWludHkgaW4geWllbGQgKHRvbi9oYSlcIjogXCJ5aWVsZF9cIiArIHlpZWxkX3R5cGUgKyBcIl9ybmdcIixcbiAgfVt5aWVsZF9vdXRwdXRfc2VsZWN0aW9uXTtcbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtOTgiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJtYXBEYXRhQ29sdW1uID0gZ2V0X3lpZWxkX2NvbHVtbihcbiAgc2VsZWN0ZWRfeWllbGRfb3V0cHV0LmxhYmVsLFxuICBzZWxlY3RHZW9EYXRhVHlwZS5sYWJlbFRpcCxcbik7XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTk5IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoibWRgIyMgQWRhcHRpbmcgdG8gdGhlIGZ1dHVyZSBjaGFuZ2VzYDtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTAwIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiY29sb3JZZWxsb3dHcmVlbiA9IFtcIiNGN0Q3MzJcIiwgXCIjMjE2NzI5XCJdO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xMDEiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJmb3JtYXROdW0gPSBkMy5mb3JtYXQoXCIuMmZcIik7XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTEwMiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImF0ZmNfY3JvcF9vcHRpb25zID0ge1xuICAgIGNvbnN0IG9wdHMgPSB7XG4gICAgICAwOiB7bGFiZWw6IFwibWFpemVcIiwgY3JvcDogXCJtYWl6ZVwifSxcbiAgICAgIDE6IHtsYWJlbDogXCJzb3JnaHVtXCIsIGNyb3A6IFwic29yZ2h1bVwifSxcbiAgICAgIDI6IHtsYWJlbDogXCJtaWxsZXRcIiwgY3JvcDogXCJtaWxsZXRcIn0sXG4gICAgICAzOiB7bGFiZWw6IFwid2hlYXRcIiwgY3JvcDogXCJ3aGVhdFwifSxcbiAgfVxuICByZXR1cm4gb3B0c1xufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xMDMiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ2aWV3b2YgYXRmY19jcm9wX3NlbGVjdG9yID0ge1xuICByZXR1cm4gSW5wdXRzLnNlbGVjdChcbiAgICBPYmplY3QudmFsdWVzKGF0ZmNfY3JvcF9vcHRpb25zKS5tYXAoKHgpID0+IHgubGFiZWwpLFxuICAgIHtsYWJlbDogX2xhbmcobmJUZXh0LmdlbmVyYWwuY3JvcCksXG4gICAgZm9ybWF0OiBsID0+IF9sYW5nKG5iVGV4dC5nZW5lcmFsLmNyb3BzW2xdKX1cbiAgKVxufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xMDQiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJzZWxlY3RlZF9jcm9wX2F0ZmMgPSBPYmplY3QudmFsdWVzKGF0ZmNfY3JvcF9vcHRpb25zKS5maW5kKFxuICAob3B0aW9uKSA9PiBvcHRpb24ubGFiZWwgPT0gYXRmY19jcm9wX3NlbGVjdG9yLFxuKS5jcm9wO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xMDUiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiIvKlxuW0FkYXB0YXRpb24gb3B0aW9uIHNlbGVjdG9yXSBTZWxlY3RvciBmb3IgdGhlIGNvbWJpbmF0b3JpYWwgb2YgZmllbGRzIOKAmGN1bHRpdmFy4oCZIGFuZCDigJhpcnJpZ2F0aW9u4oCZIGluIGRhdGEgZmlsZS4gQ3VsdGl2YXIgb3B0aW9ucyBhcmUgY3VycmVudCAobGFiZWxlZCBhcyDigJxDdXJyZW50IChubyBjdWx0aXZhciBhZGFwdGF0aW9uKeKAnSksIGVhcmx5IChsYWJlbGVkIGFzIOKAnEVhcmx5IG1hdHVyaXR54oCdKSwgYW5kIGxhdGUgKGxhYmVsZWQgYXMg4oCcTGF0ZSBtYXR1cml0eeKAnSkuIElycmlnYXRpb24gb3B0aW9ucyBhcmUgWWVzLCBOby4g4oCcWWVz4oCdIHVzZXMgdGhlIOKAnHlpZWxkX2lycuKAnSBkYXRhIChuZWVkcyB0byBiZSBhZ2dyZWdhdGVkIGluIHRoZSBzYW1lIHdheSBpdCB3YXMgZG9uZSBmb3Ig4oCceWllbGRfcmZk4oCdIGFib3ZlKSBhbmQgdGhlIOKAnE5v4oCdIHVzZXMgdGhlIOKAnHlpZWxkX3JmZOKAnS5hcyBmb2xsb3dzLFxuXHRObyBhZGFwdGF0aW9uIOKAkyB0aGlzIGlzIGRhdGEgZnJvbSDigJhjdXJyZW504oCZIGN1bHRpdmFyLCBhbmQg4oCYeWllbGRfcmZk4oCZXG5cdEN1cnJlbnQgY3VsdGl2YXIsIGlycmlnYXRpb24g4oCTIHRoaXMgaXMgZGF0YSBmcm9tIGN1cnJlbnQgY3VsdGl2YXIgYnV0IHlpZWxkX2lyclxuXHRFYXJseSBtYXR1cml0eSwgbm8gaXJyaWdhdGlvbiDigJMgdGhpcyBpcyBkYXRhIGZyb20gZWFybHkgY3VsdGl2YXIgYnV0IHlpZWxkX3JmZFxuXHRFYXJseSBtYXR1cml0eSwgaXJyaWdhdGlvbiDigJMgdGhpcyBpcyBkYXRhIGZyb20gZWFybHkgY3VsdGl2YXIgYnV0IHlpZWxkX2lyclxuXHRMYXRlIG1hdHVyaXR5LCBubyBpcnJpZ2F0aW9uIOKAkyB0aGlzIGlzIGRhdGEgZnJvbSBsYXRlIGN1bHRpdmFyIGJ1dCB5aWVsZF9yZmRcblx0TGF0ZSBtYXR1cml0eSwgaXJyaWdhdGlvbiDigJMgdGhpcyBpcyBkYXRhIGZyb20gbGF0ZSBjdWx0aXZhciBidXQgeWllbGRfaXJyXG48bm90ZTogYSBzZWNvbmQgZGF0YSBmaWxlIGZvciBhZGFwdGF0aW9uIHdpbGwgYmUgc2hhcmVkIGJ5IHVzLiBXZeKAmWxsIG1ha2UgaXQgY29uc2lzdGVudCB3aXRoIHdoYXQgeW91IG5lZWQuPlxuKi9cbmFkYXB0aW5nX3RvX2Z1dHVyZV9jaGFuZ2VzX29wdGlvbnMgPSB7XG4gICAgY29uc3QgYWRhcHRpbmdfdG9fZnV0dXJlX2NoYW5nZXNfb3B0aW9ucyA9IHtcbiAgICAgIDA6IHtjdWx0aXZhcjogXCJcIiwgbGFiZWw6IFwiXCJ9LFxuICAgICAgMToge2N1bHRpdmFyOiBcImN1cnJlbnRcIiwgeWllbGQ6IFwieWllbGRfcmZkXCIsIGxhYmVsOiBcIk5vIGFkYXB0YXRpb25cIn0sXG4gICAgICAyOiB7Y3VsdGl2YXI6IFwiY3VycmVudFwiLCB5aWVsZDogXCJ5aWVsZF9pcnJcIiwgbGFiZWw6IFwiQ3VycmVudCBjdWx0aXZhciwgaXJyaWdhdGlvblwifSxcbiAgICAgIDM6IHtjdWx0aXZhcjogXCJlYXJseVwiLCB5aWVsZDogXCJ5aWVsZF9yZmRcIiwgbGFiZWw6IFwiRWFybHkgbWF0dXJpdHksIG5vIGlycmlnYXRpb25cIn0sXG4gICAgICA0OiB7Y3VsdGl2YXI6IFwiZWFybHlcIiwgeWllbGQ6IFwieWllbGRfaXJyXCIsIGxhYmVsOiBcIkVhcmx5IG1hdHVyaXR5LCBpcnJpZ2F0aW9uXCJ9LFxuICAgICAgNToge2N1bHRpdmFyOiBcImxhdGVcIiwgeWllbGQ6IFwieWllbGRfcmZkXCIsIGxhYmVsOiBcIkxhdGUgbWF0dXJpdHksIG5vIGlycmlnYXRpb25cIn0sXG4gICAgICA2OiB7Y3VsdGl2YXI6IFwibGF0ZVwiLCB5aWVsZDogXCJ5aWVsZF9pcnJcIiwgbGFiZWw6IFwiTGF0ZSBtYXR1cml0eSwgaXJyaWdhdGlvblwifVxuICB9XG4gIHJldHVybiBhZGFwdGluZ190b19mdXR1cmVfY2hhbmdlc19vcHRpb25zXG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTEwNiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImF0ZmNfc2NlbmFyaW9fc2VsZWN0b3Jfb3B0aW9ucyA9IHtcbiAgcmV0dXJuIHtcbiAgICAwOiB7bGFiZWw6IGBTU1AzLTcuMCAoJHtfbGFuZyhuYlRleHQuZ2VuZXJhbC5lbWlzc2lvbl9zc3AzNzApfSlgLCBzc3A6IFwiU1NQMzcwXCJ9LFxuICAgIDE6IHtsYWJlbDogYFNTUDUtOC41ICgke19sYW5nKG5iVGV4dC5nZW5lcmFsLmVtaXNzaW9uX3NzcDU4NSl9KWAsIHNzcDogXCJTU1A1ODVcIn0sXG4gIH1cbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTA3IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoidmlld29mIGF0ZmNfY3ljbGVfc2VsZWN0b3IgPSB7XG4gIHJldHVybiBJbnB1dHMuc2VsZWN0KFxuICAgICAgT2JqZWN0LnZhbHVlcyhjeWNsZV9zZWxlY3Rvcl9vcHRpb25zX2RpKS5tYXAoKHgpID0+IHguY3ljbGUpLFxuICAgICAge2xhYmVsOiBfbGFuZyhuYlRleHQuem9vbVRvU3RhYmxlLnNlbGVjdG9ycy5ncm93U2Vhc29uLnRpdGxlKSB9XG4gICkgIFxufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xMDgiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ2aWV3b2YgYXRmY19zY2VuYXJpb19zZWxlY3RvciA9IHtcbiAgcmV0dXJuIElucHV0cy5zZWxlY3QoXG4gICAgICBPYmplY3QudmFsdWVzKGF0ZmNfc2NlbmFyaW9fc2VsZWN0b3Jfb3B0aW9ucykubWFwKCh4KSA9PiB4LnNzcCksXG4gICAgICB7bGFiZWw6IFwiU2NlbmFyaW9cIn1cbiAgKVxufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xMDkiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJkYXRhWWllbGRBVEZDMSA9IHtcbiAgcmV0dXJuIFtcbiAgICB7XG4gICAgICBQcmFjdGljZTpcIk5vIGFkYXB0YXRpb25cIixcbiAgICAgIEFFWl9DbGFzc19GQU86IFwiaGlzdG9yaWNhbFwiLFxuICAgICAgTWVhbl9EaWZmZXJlbmNlOiAzLFxuICAgIH0sXG4gICAge1xuICAgICAgUHJhY3RpY2U6XCJObyBhZGFwdGF0aW9uXCIsXG4gICAgICBBRVpfQ2xhc3NfRkFPOiBcIjIwMzBcIixcbiAgICAgIE1lYW5fRGlmZmVyZW5jZTogMixcbiAgICB9LFxuICAgIHtcbiAgICAgIFByYWN0aWNlOlwiTm8gYWRhcHRhdGlvblwiLFxuICAgICAgQUVaX0NsYXNzX0ZBTzogXCIyMDUwXCIsXG4gICAgICBNZWFuX0RpZmZlcmVuY2U6IDEsXG4gICAgfSxcbiAgICB7XG4gICAgICBQcmFjdGljZTpcIklycmlnYXRpb25cIixcbiAgICAgIEFFWl9DbGFzc19GQU86IFwiaGlzdG9yaWNhbFwiLFxuICAgICAgTWVhbl9EaWZmZXJlbmNlOiAzLFxuICAgIH0sXG4gICAge1xuICAgICAgUHJhY3RpY2U6XCJJcnJpZ2F0aW9uXCIsXG4gICAgICBBRVpfQ2xhc3NfRkFPOiBcIjIwMzBcIixcbiAgICAgIE1lYW5fRGlmZmVyZW5jZTogMixcbiAgICB9LFxuICAgIHtcbiAgICAgIFByYWN0aWNlOlwiSXJyaWdhdGlvblwiLFxuICAgICAgQUVaX0NsYXNzX0ZBTzogXCIyMDUwXCIsXG4gICAgICBNZWFuX0RpZmZlcmVuY2U6IDEsXG4gICAgfSxcbiAgICB7XG4gICAgICBQcmFjdGljZTpcIkVhcmx5IGN1bHRpdmFyXCIsXG4gICAgICBBRVpfQ2xhc3NfRkFPOiBcImhpc3RvcmljYWxcIixcbiAgICAgIE1lYW5fRGlmZmVyZW5jZTogMyxcbiAgICB9LFxuICAgIHtcbiAgICAgIFByYWN0aWNlOlwiRWFybHkgY3VsdGl2YXJcIixcbiAgICAgIEFFWl9DbGFzc19GQU86IFwiMjAzMFwiLFxuICAgICAgTWVhbl9EaWZmZXJlbmNlOiAyLFxuICAgIH0sXG4gICAge1xuICAgICAgUHJhY3RpY2U6XCJFYXJseSBjdWx0aXZhclwiLFxuICAgICAgQUVaX0NsYXNzX0ZBTzogXCIyMDUwXCIsXG4gICAgICBNZWFuX0RpZmZlcmVuY2U6IDEsXG4gICAgfSxcbiAgICB7XG4gICAgICBQcmFjdGljZTpcIkxhdGUgY3VsdGl2YXJcIixcbiAgICAgIEFFWl9DbGFzc19GQU86IFwiaGlzdG9yaWNhbFwiLFxuICAgICAgTWVhbl9EaWZmZXJlbmNlOiAzLFxuICAgIH0sXG4gICAge1xuICAgICAgUHJhY3RpY2U6XCJMYXRlIGN1bHRpdmFyXCIsXG4gICAgICBBRVpfQ2xhc3NfRkFPOiBcIjIwMzBcIixcbiAgICAgIE1lYW5fRGlmZmVyZW5jZTogMixcbiAgICB9LFxuICAgIHtcbiAgICAgIFByYWN0aWNlOlwiTGF0ZSBjdWx0aXZhclwiLFxuICAgICAgQUVaX0NsYXNzX0ZBTzogXCIyMDUwXCIsXG4gICAgICBNZWFuX0RpZmZlcmVuY2U6IDEsXG4gICAgfSxcbiAgICB7XG4gICAgICBQcmFjdGljZTpcIklycmlnYXRpb24gJiBlYXJseSBjdWx0aXZhclwiLFxuICAgICAgQUVaX0NsYXNzX0ZBTzogXCJoaXN0b3JpY2FsXCIsXG4gICAgICBNZWFuX0RpZmZlcmVuY2U6IDMsXG4gICAgfSxcbiAgICB7XG4gICAgICBQcmFjdGljZTpcIklycmlnYXRpb24gJiBsYXRlIGN1bHRpdmFyXCIsXG4gICAgICBBRVpfQ2xhc3NfRkFPOiBcIjIwMzBcIixcbiAgICAgIE1lYW5fRGlmZmVyZW5jZTogMixcbiAgICB9LFxuICAgIHtcbiAgICAgIFByYWN0aWNlOlwiSXJyaWdhdGlvbiAmIGxhdGUgY3VsdGl2YXJcIixcbiAgICAgIEFFWl9DbGFzc19GQU86IFwiMjA1MFwiLFxuICAgICAgTWVhbl9EaWZmZXJlbmNlOiAxLFxuICAgIH0sXG4gIF1cbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTEwIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiZGF0YVlpZWxkQVRGQyA9IHtcbiAgbGV0IHF1ZXJ5ID0gYFxuU0VMRUNUICpcbkZST00gYWZjX2RhdGEgXG4ke1doZXJlQWRtaW5RdWVyeV9BVEZDKCl9IFxuQU5EIHNzcCA9ICcke2F0ZmNfc2NlbmFyaW9fc2VsZWN0b3IudG9VcHBlckNhc2UoKX0nXG5BTkQgY3ljbGUgPSAnJHthdGZjX2N5Y2xlX3NlbGVjdG9yfSdcbmBcbiAgbXV0YWJsZSBEQmxvYWRlZCA9IHRydWVcbiAgcmV0dXJuIGRiLnF1ZXJ5KHF1ZXJ5KS50aGVuKChyKSA9PiByLnRvQXJyYXkoKSk7XG5cbi8vICAgICBsZXQgcXVlcnkgPSBgXG4vLyBTRUxFQ1QgKiBcbi8vIEZST00gYWZjX2RhdGEgXG4vLyBXSEVSRSAxID0gMSBcbi8vIEFORCBzc3AgPSAnJHthdGZjX3NjZW5hcmlvX3NlbGVjdG9yLnRvVXBwZXJDYXNlKCl9J1xuLy8gQU5EIGN5Y2xlID0gJyR7YXRmY19jeWNsZV9zZWxlY3Rvcn0nXG4vLyBgO1xuLy8gICBpZiAoYWRtaW5TZWxlY3Rpb25zLnNlbGVjdEFkbWluMCAhPSBudWxsKSB7XG4vLyAgICAgY29uc3Qgbm9uZV9hZG1pbnMgPSBnZXRBZG1pbnNOb25lRm9yU2FtZUxldmVsKCk7XG4vLyAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBub25lX2FkbWlucy5sZW5ndGg7IGkrKylcbi8vICAgICAgIHF1ZXJ5ICs9IGAgQU5EICR7bm9uZV9hZG1pbnNbaV19ID0gJydgO1xuLy8gICB9XG4vLyAgIHJldHVybiBkYi5xdWVyeShxdWVyeSkudGhlbigocikgPT4gci50b0FycmF5KCkpO1xufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xMTEiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJXaGVyZUFkbWluUXVlcnlfQVRGQyA9ICgpID0+IHtcbiAgaWYgKCFzZWxlY3RBZG1pbjAgfHwgIXNlbGVjdEFkbWluMSkge1xuICAgIC8vIHdoZXJlIGFkbWluMF9uYW1lIGlzIG51bGwsIGl0IGlzIHNzYSwgcmV0dXJuIGFkbWluIDAgZGF0YVxuICAgIHJldHVybiBgV0hFUkUgYWRtaW4xX25hbWUgPSAnJ2A7XG4gIH0gZWxzZSBpZiAoIXNlbGVjdEFkbWluMiAmJiBzZWxlY3RBZG1pbjEpIHtcbiAgICAvLyB3aGVyZSBhZG1pbjAgYW5kIGFkbWluMSBpcyBub3QgbnVsbCwgcmV0dXJuIGFkbWluIDEgZm9yIHNlbGVjdGVkIGNvdW50cnlcbiAgICByZXR1cm4gYFdIRVJFIGFkbWluMV9uYW1lICE9ICcnIEFORCBhZG1pbjJfbmFtZSA9ICcnIEFORCBhZG1pbjBfbmFtZSA9ICcke3NlbGVjdEFkbWluMH0nYDtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gYFdIRVJFIGFkbWluMl9uYW1lICE9ICcnIEFORCBhZG1pbjBfbmFtZSA9ICcke3NlbGVjdEFkbWluMH0nIEFORCBhZG1pbjFfbmFtZSA9ICcke3NlbGVjdEFkbWluMX0nYDtcbiAgfVxufTtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTEyIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiZnVuY3Rpb24gZ2V0UmVnaW9uYWxHcmFudWxhcml0eUxldmVsKGFkbWluU2VsZWN0aW9ucykge1xuICBpZiAoYWRtaW5TZWxlY3Rpb25zLnNlbGVjdEFkbWluMCA9PSBudWxsKSByZXR1cm4gXCJhZG1pbjBfbmFtZVwiO1xuICBpZiAoYWRtaW5TZWxlY3Rpb25zLnNlbGVjdEFkbWluMSA9PSBudWxsKSByZXR1cm4gXCJhZG1pbjFfbmFtZVwiO1xuICBpZiAoYWRtaW5TZWxlY3Rpb25zLnNlbGVjdEFkbWluMiA9PSBudWxsKSByZXR1cm4gXCJhZG1pbjJfbmFtZVwiO1xuICByZXR1cm4gXCJhZG1pbjJfbmFtZVwiO1xufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xMTMiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJmdW5jdGlvbiBnZXRfc2VsZWN0ZWRfYWRtaW5fYXRmYygpIHtcbiAgaWYgKGFkbWluU2VsZWN0aW9ucy5zZWxlY3RBZG1pbjAgPT0gbnVsbCkge1xuICAgIHJldHVybiB7IGFkbWluOiBcImFkbWluMF9uYW1lXCIsIGhpZ2hsaWdodDogbnVsbCB9O1xuICB9IGVsc2Uge1xuICAgIGlmIChhZG1pblNlbGVjdGlvbnMuc2VsZWN0QWRtaW4xID09IG51bGwpIHtcbiAgICAgIHJldHVybiB7IGFkbWluOiBcImFkbWluMF9uYW1lXCIsIGhpZ2hsaWdodDogYWRtaW5TZWxlY3Rpb25zLnNlbGVjdEFkbWluMCB9O1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoYWRtaW5TZWxlY3Rpb25zLnNlbGVjdEFkbWluMiA9PSBudWxsKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgYWRtaW46IFwiYWRtaW4xX25hbWVcIixcbiAgICAgICAgICBoaWdobGlnaHQ6IGFkbWluU2VsZWN0aW9ucy5zZWxlY3RBZG1pbjEsXG4gICAgICAgIH07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGFkbWluOiBcImFkbWluMl9uYW1lXCIsXG4gICAgICAgICAgaGlnaGxpZ2h0OiBhZG1pblNlbGVjdGlvbnMuc2VsZWN0QWRtaW4yLFxuICAgICAgICB9O1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xMTQiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJmdW5jdGlvbiBnZXRBZG1pbnNOb25lRm9yU2FtZUxldmVsKCkge1xuICBpZiAoYWRtaW5TZWxlY3Rpb25zLnNlbGVjdEFkbWluMCA9PSBudWxsKVxuICAgIHJldHVybiBbXCJhZG1pbjBfbmFtZVwiLCBcImFkbWluMV9uYW1lXCIsIFwiYWRtaW4yX25hbWVcIl07XG4gIGlmIChhZG1pblNlbGVjdGlvbnMuc2VsZWN0QWRtaW4xID09IG51bGwpXG4gICAgcmV0dXJuIFtcImFkbWluMV9uYW1lXCIsIFwiYWRtaW4yX25hbWVcIl07XG4gIGlmIChhZG1pblNlbGVjdGlvbnMuc2VsZWN0QWRtaW4yID09IG51bGwpIHJldHVybiBbXCJhZG1pbjJfbmFtZVwiXTtcbiAgcmV0dXJuIFtdO1xufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xMTUiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJmdW5jdGlvbiByb3VuZCh4LCBwbGFjZXMpIHtcbiAgY29uc3QgcG90ID0gTWF0aC5wb3coMTAsIHBsYWNlcyk7XG4gIHJldHVybiBNYXRoLnJvdW5kKHggKiBwb3QpIC8gcG90O1xufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xMTYiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJmdW5jdGlvbiBnZXRfYWRwdF9vcHRpb25zX2hpZ2hlcl95aWVsZF90aGFuX25vX2FkYXB0YXRpb24oZGF0YSkge1xuICBjb25zdCBtYXhNZWFuRGlmZmVyZW5jZSA9IHtcbiAgICBoaXN0b3JpY2FsOiAtSW5maW5pdHksXG4gICAgMjAzMDogLUluZmluaXR5LFxuICAgIDIwNTA6IC1JbmZpbml0eSxcbiAgfTtcblxuICAvLyBGaW5kIHRoZSBtYXhpbXVtIG1lYW5fZGlmZmVyZW5jZSBmb3IgXCJObyBhZGFwdGF0aW9uXCIgZm9yIGVhY2ggaG9yaXpvblxuICBjb25zdCBvcHRpb25zID0gbmV3IFNldCgpO1xuICBmb3IgKGNvbnN0IHJvdyBvZiBkYXRhKSB7XG4gICAgaWYgKHJvdy5hZGFwdGF0aW9uID09IFwiTm8gYWRhcHRhdGlvblwiKSB7XG4gICAgICBtYXhNZWFuRGlmZmVyZW5jZVtyb3cuaG9yaXpvbl0gPSBNYXRoLm1heChcbiAgICAgICAgbWF4TWVhbkRpZmZlcmVuY2Vbcm93Lmhvcml6b25dLFxuICAgICAgICByb3cubWVhbl9kaWZmZXJlbmNlLFxuICAgICAgKTtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBvcHRpb25zLmFkZChyb3cuYWRhcHRhdGlvbik7XG4gIH1cblxuICBmb3IgKGNvbnN0IHJvdyBvZiBkYXRhKSB7XG4gICAgaWYgKHJvdy5hZGFwdGF0aW9uID09IFwiTm8gYWRhcHRhdGlvblwiKSBjb250aW51ZTtcbiAgICBpZiAocm93Lm1lYW5fZGlmZmVyZW5jZSA8IG1heE1lYW5EaWZmZXJlbmNlW3Jvdy5ob3Jpem9uXSkge1xuICAgICAgb3B0aW9ucy5kZWxldGUocm93LmFkYXB0YXRpb24pO1xuICAgIH1cbiAgfVxuXG4gIGxldCByZXN1bHRzID0gW107XG5cbiAgZm9yIChjb25zdCBvcHRpb24gb2Ygb3B0aW9ucykge1xuICAgIGNvbnN0IGZpbHQgPSBkYXRhLmZpbHRlcigoZCkgPT4gZC5hZGFwdGF0aW9uID09IG9wdGlvbik7XG4gICAgbGV0IG9iaiA9IHtcbiAgICAgIG9wdGlvbjogb3B0aW9uLFxuICAgICAgaGlzdG9yaWNhbDpcbiAgICAgICAgZmlsdC5maW5kKChkKSA9PiBkLmhvcml6b24gPT0gXCJoaXN0b3JpY2FsXCIpLm1lYW5fZGlmZmVyZW5jZSAtXG4gICAgICAgIG1heE1lYW5EaWZmZXJlbmNlLmhpc3RvcmljYWwsXG4gICAgICAyMDMwOlxuICAgICAgICBmaWx0LmZpbmQoKGQpID0+IGQuaG9yaXpvbiA9PSBcIjIwMzBcIikubWVhbl9kaWZmZXJlbmNlIC1cbiAgICAgICAgbWF4TWVhbkRpZmZlcmVuY2VbXCIyMDMwXCJdLFxuICAgICAgMjA1MDpcbiAgICAgICAgZmlsdC5maW5kKChkKSA9PiBkLmhvcml6b24gPT0gXCIyMDUwXCIpLm1lYW5fZGlmZmVyZW5jZSAtXG4gICAgICAgIG1heE1lYW5EaWZmZXJlbmNlW1wiMjA1MFwiXSxcbiAgICB9O1xuICAgIHJlc3VsdHMucHVzaChvYmopO1xuICB9XG4gIHJlc3VsdHMuc29ydCgoYSwgYikgPT4gYS5oaXN0b3JpY2FsIC0gYi5oaXN0b3JpY2FsKS5yZXZlcnNlKCk7XG4gIHJldHVybiByZXN1bHRzO1xufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xMTciLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJoaWdobGlnaHRlZF9kYXRhID0ge1xuICB2YXIgc2VsZWN0ZWRfZ2VvID0gZ2V0X3NlbGVjdGVkX2FkbWluX2F0ZmMoKTtcbiAgICBpZiAoc2VsZWN0QWRtaW4wID09IG51bGwpe1xuICAgICAgc2VsZWN0ZWRfZ2VvID0ge1xuICAgICAgICBhZG1pbjogXCJhZG1pbjBfbmFtZVwiLFxuICAgICAgICBoaWdobGlnaHQ6IFwiXCJcbiAgICAgIH1cbiAgICB9XG5cbiAgcmV0dXJuIGRhdGFZaWVsZEFURkMuZmlsdGVyKGQgPT4gKFxuICAgICAgICAoZC5jcm9wLnRvTG93ZXJDYXNlKCkudHJpbSgpID09IHNlbGVjdGVkX2Nyb3BfYXRmYy50b0xvd2VyQ2FzZSgpLnRyaW0oKSkgJiZcbiAgICAgICAgKGQuY3ljbGUgPT0gYXRmY19jeWNsZV9zZWxlY3RvcikgJiZcbiAgICAgICAgKGQuc3NwID09IGF0ZmNfc2NlbmFyaW9fc2VsZWN0b3IpICYmXG4gICAgICAgIChkW3NlbGVjdGVkX2dlby5hZG1pbl0gPT0gc2VsZWN0ZWRfZ2VvLmhpZ2hsaWdodClcbiAgICAgIClcbiAgICApO1xufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xMTgiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJmdW5jdGlvbiBhdmVyYWdlKHZhbHMpIHtcbiAgbGV0IHN1bSA9IDA7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgdmFscy5sZW5ndGg7IGkrKykge1xuICAgIHN1bSArPSB2YWxzW2ldO1xuICB9XG4gIHJldHVybiBzdW0gLyB2YWxzLmxlbmd0aDtcbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTE5IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiY29udGFpbnNBbGwgPSAoYXJyMSwgYXJyMikgPT4gYXJyMi5ldmVyeSgoYXJyMkl0ZW0pID0+IGFycjEuaW5jbHVkZXMoYXJyMkl0ZW0pKTtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTIwIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoibWRgLS0tXG4jIyMgQWRtaW4gU2VsZWN0aW9uIC0gRGlzcGxheVxuKlNob3dpbmcgYWRtaW4gc2VsZWN0aW9ucypgO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xMjEiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiIvLyBvcHRpb25zIGZvciB0aGUgZ2xvYmFsIGFkbWluIHNlbGVjdGlvblxuLy8gdXNlZCB3aGVuIG5vIGFkbWluIHNlbGVjdGlvbiBpcyBtYWRlXG5nbG9iYWxTZWxlY3Rpb24gPSB7XG4gIHJldHVybiB7XG4gICAgbGFiZWw6IFwiU3ViLVNhaGFyYW4gQWZyaWNhXCIsXG4gICAgbGFiZWxHZW5lcmFsOiBcIkFmcmljYVwiXG4gIH1cbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTIyIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiZnVuY3Rpb24gZ2V0QWRtaW5TZWxlY3Rpb24oc2VsZWN0aW9ucyA9IGFkbWluU2VsZWN0aW9ucykge1xuICAvLyBnZXQgdGhlIG1vc3QgZ3JhbnVsYXIgYWRtaW4gc2VsZWN0aW9uIG1hZGVcbiAgY29uc3QgYTAgPSBzZWxlY3Rpb25zLnNlbGVjdEFkbWluMDtcbiAgY29uc3QgYTEgPSBzZWxlY3Rpb25zLnNlbGVjdEFkbWluMTtcbiAgY29uc3QgYTIgPSBzZWxlY3Rpb25zLnNlbGVjdEFkbWluMjtcbiAgY29uc3QgZ2xvYmFsID0gZ2xvYmFsU2VsZWN0aW9uLmxhYmVsO1xuXG4gIHJldHVybiBhMiA/IGEyIDogYTEgPyBhMSA6IGEwID8gYTAgOiBnbG9iYWw7XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTEyMyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImZ1bmN0aW9uIGdldEFkbWluU2VsZWN0aW9uQWRtaW4wKHNlbGVjdGlvbnMgPSBhZG1pblNlbGVjdGlvbnMpIHtcbiAgLy8gZ2V0IHRoZSBzZWxlY3RlZCBhZG1pbjAgb3IgZ2xvYmFsIHZhbHVlXG4gIGNvbnN0IGEwID0gc2VsZWN0aW9ucy5zZWxlY3RBZG1pbjA7XG4gIGNvbnN0IGdsb2JhbCA9IGdsb2JhbFNlbGVjdGlvbi5sYWJlbDtcblxuICByZXR1cm4gYTAgPyBhMCA6IGdsb2JhbDtcbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTI0IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiZnVuY3Rpb24gZ2V0QWRtaW5TZWxlY3Rpb25NYXJrZG93blBhdGgoc2VsZWN0aW9ucyA9IGFkbWluU2VsZWN0aW9ucykge1xuICAvLyBmdW5jdGlvbiB0byBzaG93IHNlbGVjdGVkIGFkbWluIHJlZ2lvblxuICAvLyByZXR1cm4gcGF0aCBzaG93aW5nIG5lc3RlZCBhZG1pbiBzZWxlY3Rpb25cblxuICBjb25zdCBkZWxpbSA9IFwiIOKGkiBcIjtcbiAgY29uc3QgcGF0aCA9IFtcbiAgICBzZWxlY3Rpb25zLnNlbGVjdEFkbWluMCxcbiAgICBzZWxlY3Rpb25zLnNlbGVjdEFkbWluMSxcbiAgICBzZWxlY3Rpb25zLnNlbGVjdEFkbWluMixcbiAgXS5maWx0ZXIoKGQpID0+IGQpO1xuXG4gIGNvbnN0IGZvcm1hdHRlZCA9IHBhdGhcbiAgICAuZmlsdGVyKChkKSA9PiBkKVxuICAgIC5tYXAoKGQsIGkpID0+IHtcbiAgICAgIHJldHVybiBpID09IHBhdGgubGVuZ3RoIC0gMSA/IGAqKiR7ZH0qKmAgOiBgKiR7ZH0qYDtcbiAgICB9KTtcblxuICByZXR1cm4gZm9ybWF0dGVkLmxlbmd0aCA9PSAwXG4gICAgPyBgKioke2dsb2JhbFNlbGVjdGlvbi5sYWJlbH0qKmAgLy8gbm8gc2VsZWN0aW9uLCBhbGwgb2YgQWZyaWNhXG4gICAgOiBgJHtmb3JtYXR0ZWQuam9pbihkZWxpbSl9YDtcbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTI1IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoibWRgLS0tXG4jIyMgQ2hvcm9wbGV0aCBtYXAgLSBHZW9ncmFwaGljIEltcGFjdFxuKlNob3dpbmcgY29udGV4dCBmb3IgYWRtaW4gc2VsZWN0aW9uKlxuXG5UaGVyZSBpcyBzb21lIGhvb3AtanVtcGluZyB0byBnZXQgdGhlIHJpZ2h0IGRhdGEgYmFzZWQgb24gdGhlIEFkbWluIFNlbGVjdGlvbi4gVGhlIHRhYnVsYXIgZGF0YSBpcyB0aGVuIGJvdW5kIHRvIHRoZSBhcHBsaWNhYmxlIGdlb2pzb24sIGFuZCB2aXN1YWxpemVkIHdpdGggUGxvdC5gO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xMjYiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJkYXRhWWllbGQgPSB7XG4gIGxldCBxdWVyeSA9IGBcblNFTEVDVCAqXG5GUk9NIGFnZ3JlZ2F0ZWRcbiR7V2hlcmVBZG1pblF1ZXJ5KCl9XG5BTkQgc3NwID0gJyR7c2VsZWN0ZWRfc2NlbmFyaW8uc3NwfSdcbkFORCBob3Jpem9uID0gJyR7c2VsZWN0ZWRfc2NlbmFyaW8uaG9yaXpvbn0nXG5BTkQgY3ljbGUgPSAnJHtzZWxlY3RlZF9jeWNsZV9vcHRpb25zLmN5Y2xlfSdcbkFORCBjcm9wID0gJyR7Y3JvcF9zZWxlY3Rvcl9keW5hbWljX2luc2lnaHRzfSdcbkFORCBjdWx0aXZhciA9ICcke3NlbGVjdGVkX2N1bHRpdmFyLnZhbHVlfSdcbmBcbiAgbGV0IHJlc3AgPSBhd2FpdCBkYi5xdWVyeVN0cmVhbShxdWVyeSlcbiAgcmV0dXJuIHJlc3AucmVhZFJvd3MoKVxufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xMjciLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJzZWxlY3RlZF9jdWx0aXZhcjtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTI4IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiLy8gZ3JhYiB0YWJ1bGFyIGRhdGEgZm9yIGNob3JvcGxldGhcbmRhdGFHZW9JbXBhY3QgPSB7XG4gIC8vIGdldCBkYXRhIGZvciBjaG9yb3BsZXRoIG1hcCBiYXNlZCBvbiBjaG9pY2VcbiAgY29uc3QgZGF0YVNvdXJjZSA9IHNlbGVjdEdlb0RhdGFUeXBlLmtleSA9PSBcInBvcHVsYXRpb25cIlxuICAgID8gZGF0YVlpZWxkXG4gICAgOiBkYXRhWWllbGRcblxuICAvLyBzZWxlY3QgZGlmZmVyZW50IGRhdGEgYmFzZWQgb24gYWRtaW4gc2VsZWN0aW9uc1xuICBpZiAoYWRtaW5TZWxlY3Rpb25zLnNlbGVjdEFkbWluMSkge1xuICAgIC8vIGFkbWluMSBvciAyIGlzIHNlbGVjdGVkLCBzaG93IGFsbCBhZG1pbjIncyBmb3Igc2VsZWN0ZWQgYWRtaW4xXG4gICAgcmV0dXJuIFQudGlkeShcbiAgICAgIGRhdGFTb3VyY2UsXG4gICAgICBULmZpbHRlcigoZCkgPT4ge1xuICAgICAgICByZXR1cm4gZC5hZG1pbjFfbmFtZSA9PSBhZG1pblNlbGVjdGlvbnMuc2VsZWN0QWRtaW4xXG4gICAgICAgICAgJiYgZC5hZG1pbjJfbmFtZSAvLyBhbHdheXMgbm9uLW51bGxcbiAgICAgIH0pXG4gICAgKTtcbiAgfSBlbHNlIGlmIChhZG1pblNlbGVjdGlvbnMuc2VsZWN0QWRtaW4wKSB7XG4gICAgLy8gYWRtaW4wIGlzIHNlbGVjdGVkLCB3aXRoIG5vIGFkbWluMVxuICAgIC8vIGdldCBhbGwgYWRtaW4xIGRhdGEgZm9yIHNlbGVjdGVkIGFkbWluMFxuICAgIHJldHVybiBULnRpZHkoXG4gICAgICBkYXRhU291cmNlLFxuICAgICAgVC5maWx0ZXIoKGQpID0+IHtcbiAgICAgICAgcmV0dXJuIGQuYWRtaW4wX25hbWUgPT0gYWRtaW5TZWxlY3Rpb25zLnNlbGVjdEFkbWluMFxuICAgICAgICAmJiBkLmFkbWluMV9uYW1lIC8vIGFsd2F5cyBub24tbnVsbCBcbiAgICAgICAgJiYgIWQuYWRtaW4yX25hbWUgLy8gYWx3YXlzIG51bGxcbiAgICAgIH0pXG4gICAgKVxuICB9IGVsc2Uge1xuICAgIC8vIGVuZCBjYXNlOiBhZG1pbjAgaXMgbm90IHNlbGVjdGVkXG4gICAgLy8gZ2V0IGFsbCBhZG1pbjAgZGF0YVxuICAgIHJldHVybiBULnRpZHkoXG4gICAgICBkYXRhU291cmNlLFxuICAgICAgVC5maWx0ZXIoKGQpID0+IHtcbiAgICAgICAgcmV0dXJuICFkLmFkbWluMV9uYW1lIC8vIGFsd2F5cyBudWxsIFxuICAgICAgICAmJiAhZC5hZG1pbjJfbmFtZSAvLyBhbHdheXMgbnVsbFxuICAgICAgfSlcbiAgICApXG4gIH1cbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTI5IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiLy8gYmluZCBnZW9qc29uIHRvIHRhYnVsYXIgZGF0YVxubWFwRGF0YUdlb0ltcGFjdCA9IHtcbiAgLy8gbm8gc2VsZWN0aW9uc1xuICBpZiAoIWFkbWluU2VsZWN0aW9ucy5zZWxlY3RBZG1pbjApIHtcbiAgICByZXR1cm4gYmluZFRhYnVsYXJUb0dlbyh7XG4gICAgICBkYXRhOiBkYXRhR2VvSW1wYWN0LFxuICAgICAgZGF0YUJpbmRDb2x1bW46IFwiYWRtaW4wX25hbWVcIixcbiAgICAgIGdlb0RhdGE6IGJvdW5kYXJpZXMuYWRtaW4wLFxuICAgICAgZ2VvRGF0YUJpbmRDb2x1bW46IFwiYWRtaW4wX25hbWVcIlxuICAgIH0pO1xuICB9XG4gIC8vIGFkbWluMCBzZWxlY3RlZCBvbmx5XG4gIGVsc2UgaWYgKCFhZG1pblNlbGVjdGlvbnMuc2VsZWN0QWRtaW4xKSB7XG4gICAgY29uc3QgZGF0YSA9IFQudGlkeShcbiAgICAgIGRhdGFHZW9JbXBhY3QsXG4gICAgICBULm11dGF0ZSh7IGExX2EwOiAoZCkgPT4gW2QuYWRtaW4xX25hbWUsIGQuYWRtaW4wX25hbWVdLmpvaW4oXCJfXCIpIH0pXG4gICAgKTtcbiAgICBjb25zdCBnZW9EYXRhID0ge1xuICAgICAgLi4uYm91bmRhcmllcy5hZG1pbjEsXG4gICAgICBmZWF0dXJlczogYm91bmRhcmllcy5hZG1pbjEuZmVhdHVyZXMuZmlsdGVyKFxuICAgICAgICAoZCkgPT4gZC5wcm9wZXJ0aWVzLmFkbWluMF9uYW1lID09IGFkbWluU2VsZWN0aW9ucy5zZWxlY3RBZG1pbjBcbiAgICAgIClcbiAgICB9O1xuXG4gICAgcmV0dXJuIGJpbmRUYWJ1bGFyVG9HZW8oe1xuICAgICAgZGF0YTogZGF0YSxcbiAgICAgIGRhdGFCaW5kQ29sdW1uOiBcImExX2EwXCIsXG4gICAgICBnZW9EYXRhOiBnZW9EYXRhLFxuICAgICAgZ2VvRGF0YUJpbmRDb2x1bW46IFwiYTFfYTBcIlxuICAgIH0pO1xuICB9XG5cbiAgLy8gYWRtaW4xIGlzIHNlbGVjdGVkXG4gIC8vIHNob3cgYWxsIGFkbWluMiByZWdpb25zIHdpdGhpbiBhZG1pbjFcbiAgZWxzZSB7XG4gICAgY29uc3QgZGF0YSA9IFQudGlkeShcbiAgICAgIGRhdGFHZW9JbXBhY3QsXG4gICAgICBULm11dGF0ZSh7XG4gICAgICAgIGEyX2ExX2EwOiAoZCkgPT4gW2QuYWRtaW4yX25hbWUsIGQuYWRtaW4xX25hbWUsIGQuYWRtaW4wX25hbWVdLmpvaW4oXCJfXCIpXG4gICAgICB9KVxuICAgICk7XG4gICAgY29uc3QgZ2VvRGF0YSA9IHtcbiAgICAgIC4uLmJvdW5kYXJpZXMuYWRtaW4yLFxuICAgICAgZmVhdHVyZXM6IGJvdW5kYXJpZXMuYWRtaW4yLmZlYXR1cmVzLmZpbHRlcihcbiAgICAgICAgKGQpID0+IGQucHJvcGVydGllcy5hZG1pbjFfbmFtZSA9PSBhZG1pblNlbGVjdGlvbnMuc2VsZWN0QWRtaW4xXG4gICAgICApXG4gICAgfTtcblxuICAgIHJldHVybiBiaW5kVGFidWxhclRvR2VvKHtcbiAgICAgIGRhdGE6IGRhdGEsXG4gICAgICBkYXRhQmluZENvbHVtbjogXCJhMl9hMV9hMFwiLFxuICAgICAgZ2VvRGF0YTogZ2VvRGF0YSxcbiAgICAgIGdlb0RhdGFCaW5kQ29sdW1uOiBcImEyX2ExX2EwXCJcbiAgICB9KTtcbiAgfVxufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xMzAiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJmdW5jdGlvbiBmaWx0ZXJZaWVsZERhdGFCeUFkbWlucyhkKSB7XG4gIGlmIChhZG1pblNlbGVjdGlvbnMuc2VsZWN0QWRtaW4wID09IG51bGwpIHJldHVybiBkO1xuICBpZiAoYWRtaW5TZWxlY3Rpb25zLnNlbGVjdEFkbWluMSA9PSBudWxsKVxuICAgIHJldHVybiAoXG4gICAgICBkLmFkbWluMF9uYW1lID09IGFkbWluU2VsZWN0aW9ucy5zZWxlY3RBZG1pbjAgJiYgZC5hZG1pbjFfbmFtZSA9PSBudWxsXG4gICAgKTtcbiAgaWYgKGFkbWluU2VsZWN0aW9ucy5zZWxlY3RBZG1pbjIgPT0gbnVsbClcbiAgICByZXR1cm4gKFxuICAgICAgZC5hZG1pbjBfbmFtZSA9PSBhZG1pblNlbGVjdGlvbnMuc2VsZWN0QWRtaW4wICYmXG4gICAgICBkLmFkbWluMV9uYW1lID09IGFkbWluU2VsZWN0aW9ucy5zZWxlY3RBZG1pbjEgJiZcbiAgICAgIGQuYWRtaW4yX25hbWUgPT0gbnVsbFxuICAgICk7XG4gIHJldHVybiAoXG4gICAgZC5hZG1pbjBfbmFtZSA9PSBhZG1pblNlbGVjdGlvbnMuc2VsZWN0QWRtaW4wICYmXG4gICAgZC5hZG1pbjFfbmFtZSA9PSBhZG1pblNlbGVjdGlvbnMuc2VsZWN0QWRtaW4xICYmXG4gICAgZC5hZG1pbjJfbmFtZSA9PSBhZG1pblNlbGVjdGlvbnMuc2VsZWN0QWRtaW4yXG4gICk7XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTEzMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IldoZXJlQWRtaW5RdWVyeSA9ICgpID0+IHtcbiAgaWYgKCFzZWxlY3RBZG1pbjApIHtcbiAgICAvLyB3aGVyZSBhZG1pbjBfbmFtZSBpcyBudWxsLCBpdCBpcyBzc2EsIHJldHVybiBhZG1pbiAwIGRhdGFcbiAgICByZXR1cm4gYFdIRVJFIGFkbWluMV9uYW1lIElTIE5VTExgO1xuICB9IGVsc2UgaWYgKHNlbGVjdEFkbWluMCAmJiAhc2VsZWN0QWRtaW4xKSB7XG4gICAgLy8gV2hlcmUgYWRtaW4wIGlzIHNlbGVjdGVkLCByZXR1cm4gYWxsIGFkbWluIDEgZm9yIHRoYXQgY291bnRyeVxuICAgIHJldHVybiBgV0hFUkUgYWRtaW4wX25hbWUgPT0gJyR7c2VsZWN0QWRtaW4wfScgQU5EIGFkbWluMV9uYW1lIElTIE5PVCBOVUxMIEFORCBhZG1pbjJfbmFtZSBJUyBOVUxMYDtcbiAgICAvLyB9IGVsc2UgaWYgKHNlbGVjdEFkbWluMSAmJiAhc2VsZWN0QWRtaW4yKSB7IC8vIHdoZXJlIGFkbWluMCBhbmQgYWRtaW4xIGlzIHNlbGVjdGVkLCByZXR1cm4gYWxsIGFkbWluMiBmb3IgdGhhdCByZWdpb24vY291bnRyeVxuICAgIC8vICAgcmV0dXJuIGBXSEVSRSBhZG1pbjBfbmFtZSA9ICcke3NlbGVjdEFkbWluMH0nIEFORCBhZG1pbjFfbmFtZSA9ICcke3NlbGVjdEFkbWluMX0nIEFORCBhZG1pbjJfbmFtZSBJUyBOT1QgTlVMTGBcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gYFdIRVJFIGFkbWluMF9uYW1lID0gJyR7c2VsZWN0QWRtaW4wfScgQU5EIGFkbWluMV9uYW1lID0gJyR7c2VsZWN0QWRtaW4xfScgQU5EIGFkbWluMl9uYW1lIElTIE5PVCBOVUxMYDtcbiAgfVxufTtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTMyIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoibWRgLS0tXG4jIyBEYXRhXG4qRGF0YSBzb3VyY2VzKlxuLSBEYXRhIGlzIGZyb20gbG9jYWwgZmlsZXMgZG93bmxvYWRlZCBmcm9tIFMzLCB1cGxvYWRlZCBhcyBhIGZpbGUgYXR0YWNobWVudHNcbi0gRGF0YSBpcyB0aGVuIHdyYXBwZWQgYXMgYSBkdWNrREIgZGF0YWJhc2UgdGFibGUgKHNlcGFyYXRlIHRhYmxlcyBmb3IgZWFjaCBwYXJxdWV0IGZpbGUpXG4tIFdlIGFyZSB1c2luZyBzb21lIHNpbXBsaWZpZWQgZGF0YSBzb3VyY2VzLCBzdWZmaXhlZCB3aXRoIHJlZHVjZWQucGFycXVldCBpbiB0aGUgUzMgYnVja2V0YDtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTMzIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiaW1wb3J0IHsgZGIgfSBmcm9tIFwiODc2YjBjZDg5N2I0YzIxNFwiO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xMzQiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJtdXRhYmxlIERCbG9hZGVkID0gZmFsc2VcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTM1IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoie1xuICBpZiAoIURCbG9hZGVkKSB7XG4gICAgZG9jdW1lbnQuYm9keS5zdHlsZS5jdXJzb3IgPSBcIndhaXRcIjtcbiAgfSBlbHNlIHtcbiAgICBkb2N1bWVudC5ib2R5LnN0eWxlLmN1cnNvciA9IFwiZGVmYXVsdFwiO1xuICB9XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTEzNiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Im1kYCMjIyBHZW9ncmFwaGljIGRhdGFcbkdlbyBmaWxlcyB3ZXJlIGNvbnZlcnRlZCB0byBUb3BvSlNPTiBhbmQgcmVkdWNlZCBpbiBjb21wbGV4aXR5IGJlZm9yZSB1cGxvYWRpbmcgdG8gdGhlIG5vdGVib29rLCBzZWUgW1NpbXBsaWZ5IGxhcmdlIHNwYXRpYWwgZmlsZXNdKGh0dHBzOi8vb2JzZXJ2YWJsZWhxLmNvbS9kLzI1OGM2OGVlOTY5ZThlZDU/Y29sbGVjdGlvbj1AcGVyaXNjb3BpYy9hYi1hdGxhcykgbm90ZWJvb2sgZm9yIG1ldGhvZC5cbi0gKiphZG1pbjAqKjogYnJvYWRlc3QgbGV2ZWwsIGNvdW50cnkgYm91bmRhcmllc1xuICAtIGJvdW5kYXJpZXMvYXRsYXMtcmVnaW9uX2FkbWluMF9oYXJtb25pemVkLmdlb2pzb25cbi0gKiphZG1pbjEqKjogb25lIGxldmVsIGRvd24gZnJvbSBhZG1pbjAsIHJlZ2lvbnMgd2l0aGluIGVhY2ggYWRtaW4wIHJlZ2lvblxuICAtIGJvdW5kYXJpZXMvYXRsYXMtcmVnaW9uX2FkbWluMV9zaW1wbGlmaWVkLnBhcnF1ZXRcbi0gKiphZG1pbjIqKjogbG93ZXN0IGxldmVsLCBzdWJyZWdpb25zIG9mIGV2ZXJ5IGFkbWluMSByZWdpb25cbiAgLSBUaGVzZSBhcmUgb25seSBsb2FkZWQgd2hlbiBuZWVkZWQgYW5kIGFyZSBjYWxsZWQgZGlyZWN0bHkgZnJvbSB0aGUgUzMgYnVja2V0IHRvIHJlZHVjZSBiYW5kd2lkdGggYW5kIG1lbW9yeSByZXF1aXJlbWVudHNcbiAgLSBodHRwczovL2RpZ2l0YWwtYXRsYXMuczMuYW1hem9uYXdzLmNvbS9ib3VuZGFyaWVzL2F0bGFzLXJlZ2lvbl9hZG1pbjJfc2ltcGxpZmllZC5wYXJxdWV0YDtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTM3IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiYWRtaW4wX2JvdW5kYXJpZXMgPSB7XG4gIGNvbnN0IGlucHV0MCA9IGF3YWl0IEZpbGVBdHRhY2htZW50KFwiYXRsYXMtcmVnaW9uX2FkbWluMF9oYXJtb25pemVkLmpzb25cIikuanNvbigpXG4gIHJldHVybiB0b3BvanNvbi5mZWF0dXJlKGlucHV0MCwgaW5wdXQwLm9iamVjdHNbXCJhdGxhcy1yZWdpb25fYWRtaW4wX2hhcm1vbml6ZWRcIl0pXG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTEzOCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImFkbWluMV9ib3VuZGFyaWVzID0gZ2V0YWRtaW4xKCk7XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTEzOSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImJvdW5kYXJpZXMgPSB7XG4gIGNvbnN0IGlucHV0MSA9IGF3YWl0IGdldGFkbWluMSgpXG4gIGNvbnN0IGlucHV0MiA9IGF3YWl0IGdldGFkbWluMigpXG5cbiAgY29uc3QgZ2VvID0ge1xuICAgIGFkbWluMDogYWRtaW4wX2JvdW5kYXJpZXMsXG4gICAgYWRtaW4xOiBhZG1pbjFfYm91bmRhcmllcyxcbiAgICBhZG1pbjI6IGF3YWl0IGdldGFkbWluMigpLFxuICB9XG4gIHJldHVybiBnZW9cbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTQwIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiZ2V0YWRtaW4xID0gYXN5bmMgKCkgPT4ge1xuICBsZXQgYWRtaW4xX3F1ZXJ5ID0gYFdIRVJFIGFkbWluMF9uYW1lID0gJyR7c2VsZWN0QWRtaW4wfSdgO1xuXG4gIGxldCByZXNwb25zZSA9IGF3YWl0IGdlb19kYi5xdWVyeShgXG4gICAgU0VMRUNUICpcbiAgICBGUk9NIGFkbWluMV9nZW9tXG4gICAgJHthZG1pbjFfcXVlcnl9YCk7XG4gIGxldCBhMV9uYW1lcyA9IHJlc3BvbnNlLm1hcCgoZCkgPT4gZC5hZG1pbjFfbmFtZSk7XG4gIC8vIG11dGFibGUgYWRtaW4xX25hbWVzID0gW1wiRnVsbCBDb3VudHJ5XCJdLmNvbmNhdChhMV9uYW1lcyk7XG4gIGxldCB3a2JfbGlzdCA9IHJlc3BvbnNlLm1hcCgoZCkgPT4gZC5nZW9tZXRyeSk7XG4gIGxldCBkYXRhID0gYXdhaXQgcmVzcG9uc2UubWFwKCh7IGdlb21ldHJ5LCAuLi5yZXN0IH0pID0+IHJlc3QpO1xuXG4gIHJldHVybiBnZW9qc29uRnJvbVdLQih3a2JfbGlzdCwgZGF0YSk7XG59O1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xNDEiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJnZXRhZG1pbjIgPSBhc3luYyAoKSA9PiB7XG4gIGlmICghc2VsZWN0QWRtaW4xKSB7XG4gICAgLy8gSWYgc2VsZWN0IEFkbWluIDEgaXMgbnVsbCwgcmV0dXJuIHdpdGhvdXQgcXVlcnlpbmcgdG8gc2F2ZSBiYW5kd2lkdGhcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogXCJGZWF0dXJlQ29sbGVjdGlvblwiLFxuICAgICAgZmVhdHVyZXM6IFtdLFxuICAgIH07XG4gIH1cbiAgbGV0IGFkbWluMl9xdWVyeSA9IGBXSEVSRSBhZG1pbjBfbmFtZSA9ICcke3NlbGVjdEFkbWluMH0nIEFORCBhZG1pbjFfbmFtZSA9ICcke3NlbGVjdEFkbWluMX0nYDtcblxuICBsZXQgcmVzcG9uc2UgPSBhd2FpdCBnZW9fZGIucXVlcnkoYFxuICAgIFNFTEVDVCAqXG4gICAgRlJPTSBhZG1pbjJfZ2VvbVxuICAgICR7YWRtaW4yX3F1ZXJ5fWApO1xuICBsZXQgd2tiX2xpc3QgPSByZXNwb25zZS5tYXAoKGQpID0+IGQuZ2VvbWV0cnkpO1xuICBsZXQgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLm1hcCgoeyBnZW9tZXRyeSwgLi4ucmVzdCB9KSA9PiByZXN0KTtcblxuICByZXR1cm4gZ2VvanNvbkZyb21XS0Iod2tiX2xpc3QsIGRhdGEpO1xufTtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTQyIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiZnVuY3Rpb24gZ2VvanNvbkZyb21XS0Iod2tiLCBkYXRhID0gbnVsbCkge1xuICBpZiAoZGF0YSAmJiB3a2IubGVuZ3RoICE9PSBkYXRhLmxlbmd0aCkge1xuICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgIGBEYXRhIGxlbmd0aCBtaXNtYXRjaDogZXhwZWN0ZWQgJHt3a2IubGVuZ3RofSwgZ290ICR7ZGF0YS5sZW5ndGh9YCxcbiAgICApO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICB0eXBlOiBcIkZlYXR1cmVDb2xsZWN0aW9uXCIsXG4gICAgZmVhdHVyZXM6IHdrYi5tYXAoKHdrYkl0ZW0sIGkpID0+IHtcbiAgICAgIGNvbnN0IGdlb21ldHJ5ID0gd2t4Lkdlb21ldHJ5LnBhcnNlKEJ1ZmZlci5mcm9tKHdrYkl0ZW0pKS50b0dlb0pTT04oKTtcbiAgICAgIGNvbnN0IGdlb21ldHJ5UmV3b3VuZCA9IHR1cmZSZXdpbmQoZ2VvbWV0cnksIHsgcmV2ZXJzZTogdHJ1ZSB9KTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHR5cGU6IFwiRmVhdHVyZVwiLFxuICAgICAgICBnZW9tZXRyeTogZ2VvbWV0cnlSZXdvdW5kLFxuICAgICAgICBwcm9wZXJ0aWVzOiBkYXRhID8gZGF0YVtpXSA6IG51bGwsXG4gICAgICB9O1xuICAgIH0pLFxuICB9O1xufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xNDMiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJnZW9fZGIgPSB7XG4gIGxldCBkYiA9IGF3YWl0IER1Y2tEQkNsaWVudC5vZih7XG4gICAgYWRtaW4xX2dlb206IEZpbGVBdHRhY2htZW50KFwiYXRsYXMtcmVnaW9uX2FkbWluMV9zaW1wbGlmaWVkLnBhcnF1ZXRcIilcbiAgfSk7XG4gIGF3YWl0IGRiLnF1ZXJ5KGBcbiAgICBDUkVBVEUgVklFVyBhZG1pbjJfZ2VvbSBBU1xuICAgIFNFTEVDVCAqXG4gICAgRlJPTSByZWFkX3BhcnF1ZXQoXCIke3Jlc29sdmVXaW5kb3dzQ2FjaGVJc3N1ZShcbiAgICAgIFwiaHR0cHM6Ly9kaWdpdGFsLWF0bGFzLnMzLmFtYXpvbmF3cy5jb20vYm91bmRhcmllcy9hdGxhcy1yZWdpb25fYWRtaW4yX3NpbXBsaWZpZWQucGFycXVldFwiXG4gICAgKX1cIilgKTtcbiAgcmV0dXJuIGRiO1xufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xNDQiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJpbXBvcnQgeyByZXNvbHZlV2luZG93c0NhY2hlSXNzdWUgfSBmcm9tIFwiNzIyODFiZTJmMTNhMGE3MlwiO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xNDUiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJCdWZmZXIgPSAoYXdhaXQgaW1wb3J0KFwiaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L25wbS9idWZmZXJANi4wLjMvK2VzbVwiKSlcbiAgLkJ1ZmZlcjtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTQ2IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoid2t4ID0gcmVxdWlyZShcImh0dHBzOi8vYnVuZGxlLnJ1bi93a3hAMC41LjBcIik7XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTE0NyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InR1cmZSZXdpbmQgPSByZXF1aXJlKFwiQHR1cmYvdHVyZlwiKS50aGVuKCh0KSA9PiB0LnJld2luZCk7XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTE0OCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Im1kYCoqKlxuIyMgSGVscGVyc1xuKkZ1bmN0aW9ucyBhbmQgb3RoZXIgZ29vZCBzdHVmZipgO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xNDkiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJtZGAtLS1cbiMjIyBEeW5hbWljIGluc2lnaHRzXG4qZnVuY3Rpb25zIGZvciBmb3JtYXR0aW5nIHJlc3VsdHMqYDtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTUwIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiZnVuY3Rpb24gZmlsdGVyQnlBZG1pbk5hbWVzKGRhdGEpIHtcbiAgLy8gZmlsdGVyIGRvd24gZGF0YSBieSBjb21iaW5lZCBzZWxlY3RlZCBhZG1pbjAvYWRtaW4xL2FkbWluMiBBZG1pbiBTZWxlY3Rpb25zXG4gIC8vIHBhc3MgZGF0YSBmcm9tIHF1ZXJ5LCB1c2UgdGlkeWpzIHRvIGZpbHRlciBieSBhZG1pbiBzZWxlY3Rpb25cbiAgY29uc3QgcmVzdWx0ID0gVC50aWR5KFxuICAgIGRhdGEsXG4gICAgVC5maWx0ZXIoKGQpID0+IHtcbiAgICAgIHJldHVybiAoXG4gICAgICAgIGQuYWRtaW4wX25hbWUgPT0gYWRtaW5TZWxlY3Rpb25zLnNlbGVjdEFkbWluMCAmJlxuICAgICAgICBkLmFkbWluMV9uYW1lID09IGFkbWluU2VsZWN0aW9ucy5zZWxlY3RBZG1pbjEgJiZcbiAgICAgICAgZC5hZG1pbjJfbmFtZSA9PSBhZG1pblNlbGVjdGlvbnMuc2VsZWN0QWRtaW4yXG4gICAgICApO1xuICAgIH0pLFxuICApO1xuICByZXR1cm4gcmVzdWx0O1xufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xNTEiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiIvLyB3cmFwcGVyIGZvciBmb3JtYXQgZnVuY3Rpb25zLCBzaG93IGNob3NlbiBkZWZhdWx0XG5mdW5jdGlvbiBmb3JtYXRXaXRoRGVmYXVsdCh7XG4gIHZhbHVlID0gMTAwMCxcbiAgZm9ybWF0ID0gKGQpID0+IGQsXG4gIGRlZmF1bHRWYWx1ZSA9IFwiLS0tXCIsXG4gIGRlYnVnID0gZmFsc2UsXG59ID0ge30pIHtcbiAgLy8gYXBwbHkgYSBmb3JtYXR0aW5nIGZ1bmN0aW9uIHRvIGEgdmFsdWVcbiAgLy8gcmV0dXJuIGRlZmF1bHQgdmFsdWUgaWYgdW5kZWZpbmVkIG9yIG51bGxcbiAgaWYgKHZhbHVlID8/IHRydWUpIHtcbiAgICByZXR1cm4gZm9ybWF0KHZhbHVlKTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gZGVmYXVsdFZhbHVlO1xuICB9XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTE1MiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Im1kYC0tLVxuIyMjIERhdGEgZnVuY3Rpb25zOiBmb3JtYXQgYW5kIHRyYW5zZm9ybVxuKmFwcGx5IGZvcm1hdHRpbmcgdG8vdHJhbnNmb3JtIGEgdmFsdWUqXG5cbi0gUmVmZXJlbmNlOiBbSW50bC5OdW1iZXJGb3JtYXQoKV0oaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvSW50bC9OdW1iZXJGb3JtYXQvTnVtYmVyRm9ybWF0KWA7XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTE1MyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Im1kYCMjIyBUcmFuc2Zvcm1zYDtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTU0IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiLy8gdHJhbnNmb3JtIG5vbi1udW1iZXIgdG8gcGVyY2VudCB2YWx1ZVxudHJhbnNmb3JtUGVyY2VudCA9IChkKSA9PiB7XG4gIGlmIChkID09PSB1bmRlZmluZWQgfHwgZCA9PT0gbnVsbCkgcmV0dXJuIGQ7XG4gIGVsc2UgcmV0dXJuIGQgKiAxMDA7XG59O1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xNTUiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJtZGAjIyMgRm9ybWF0dGluZ2A7XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTE1NiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Ii8vIGZvcm1hdCBub24tbnVtYmVyIGFzIHBlcmNlbnRcbmZvcm1hdFBlcmNlbnRUZW50aCA9IChkKSA9PiB7XG4gIGlmIChkID09PSB1bmRlZmluZWQgfHwgZCA9PT0gbnVsbCkgcmV0dXJuIGQ7XG4gIGVsc2UgcmV0dXJuIGQzLmZvcm1hdChcIi4xJVwiKShkKTtcbn07XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTE1NyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Ii8vIGZvcm1hdCBub24tbnVtYmVyIGFzIHBlcmNlbnRcbmZvcm1hdFBlcmNlbnRXaG9sZSA9IChkKSA9PiB7XG4gIGlmIChkID09PSB1bmRlZmluZWQgfHwgZCA9PT0gbnVsbCkgcmV0dXJuIGQ7XG4gIGVsc2UgcmV0dXJuIGQzLmZvcm1hdChcIi4wJVwiKShkKTtcbn07XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTE1OCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Ii8vIGZvcm1hdCBVUyBjdXJyZW5jeVxuZm9ybWF0VVNEID0gbmV3IEludGwuTnVtYmVyRm9ybWF0KFwiZW4tVVNcIiwge1xuICBub3RhdGlvbjogXCJjb21wYWN0XCIsXG4gIGNvbXBhY3REaXNwbGF5OiBcInNob3J0XCIsXG4gIHN0eWxlOiBcImN1cnJlbmN5XCIsXG4gIGN1cnJlbmN5OiBcInVzZFwiLFxufSkuZm9ybWF0O1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xNTkiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiIvLyBmb3JtYXQgbnVtYmVyLCBsb25nIG5vdGF0aW9uXG5mb3JtYXROdW1Db21wYWN0TG9uZyA9IG5ldyBJbnRsLk51bWJlckZvcm1hdChcImVuLVVTXCIsIHtcbiAgbm90YXRpb246IFwiY29tcGFjdFwiLFxuICBjb21wYWN0RGlzcGxheTogXCJsb25nXCIsXG4gIHVuaXREaXNwbGF5OiBcImxvbmdcIixcbn0pLmZvcm1hdDtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTYwIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiLy8gZm9ybWF0IG51bWJlciwgbG9uZyBub3RhdGlvblxuZm9ybWF0TnVtQ29tcGFjdFNob3J0ID0gbmV3IEludGwuTnVtYmVyRm9ybWF0KFwiZW4tVVNcIiwge1xuICBub3RhdGlvbjogXCJjb21wYWN0XCIsXG4gIGNvbXBhY3REaXNwbGF5OiBcInNob3J0XCIsXG59KS5mb3JtYXQ7XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTE2MSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Im1kYC0tLVxuIyMjIFF1ZXJ5aW5nIGRhdGFcbipmdW5jdGlvbnMgZm9yIHF1ZXJ5aW5nIGRhdGEqYDtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTYyIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiZnVuY3Rpb24gZ2V0VW5pcXVlVmFsdWVzKGNvbCwgdGJsLCBkYikge1xuICAvLyByZXR1cm4gdW5pcXVlIHZhbHVlcyBvZiBmcm9tIGRiIHRibCBhcyBhIGxpc3RcbiAgcmV0dXJuIGRiXG4gICAgLnF1ZXJ5KGBzZWxlY3QgZGlzdGluY3QgJHtjb2x9IGZyb20gJHt0Ymx9YClcbiAgICAudGhlbigoeCkgPT4geC5tYXAoKGQpID0+IGRbY29sXSkpXG4gICAgLnRoZW4oKHIpID0+IHIudG9BcnJheSgpKTtcbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTYzIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiZnVuY3Rpb24gYmluZFRhYnVsYXJUb0dlbyh7XG4gIGRhdGEgPSBbXSxcbiAgZGF0YUJpbmRDb2x1bW4gPSBcImRhdGFCaW5kQ29sdW1uXCIsXG4gIGdlb0RhdGEgPSBbXSxcbiAgZ2VvRGF0YUJpbmRDb2x1bW4gPSBcImdlb0RhdGFCaW5kQ29sdW1uXCIsXG59KSB7XG4gIC8vIGJpbmQgZGF0YSB0byBnZW9qc29uXG4gIGNvbnN0IGluZGV4ID0gbmV3IE1hcChkYXRhLm1hcCgoZCkgPT4gW2RbZGF0YUJpbmRDb2x1bW5dLCBkXSkpOyAvLyBtYXAgZGF0YSBieSBkYXRhQmluZENvbHVtblxuICBjb25zdCBnZW9qc29uID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShnZW9EYXRhKSk7IC8vIGRvIGEgY29weSwgcmF0aGVyIHRoYW4gbXV0YXRlXG4gIC8vIGpvaW4gdXAgZGF0YSB0byBnZW9qc29uXG4gIGZvciAoY29uc3QgZiBvZiBnZW9qc29uLmZlYXR1cmVzKSB7XG4gICAgZi5wcm9wZXJ0aWVzLmRhdGEgPSBpbmRleC5nZXQoZi5wcm9wZXJ0aWVzW2dlb0RhdGFCaW5kQ29sdW1uXSk7XG4gIH1cbiAgcmV0dXJuIGdlb2pzb247XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTE2NCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Im1kYCMjIEltcG9ydHNgO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xNjUiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJpbXBvcnQgeyB0b2MgfSBmcm9tIFwiQG5lYnJpdXMvaW5kZW50ZWQtdG9jXCI7XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTE2NiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImltcG9ydCB7IFQgfSBmcm9tIFwiQHBiZXNoYWkvdGlkeWpzXCI7XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTE2NyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InF1aWNrX2luc2lnaHRzX3Byb2plY3RlZF8xID0gRmlsZUF0dGFjaG1lbnQoXG4gIFwicXVpY2tfaW5zaWdodHNfcHJvamVjdGVkXzFAMS5qc29uXCIsXG4pLmpzb24oKTtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTY4IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoicXVpY2tfaW5zaWdodHNfcHJvamVjdGVkXzIgPSBGaWxlQXR0YWNobWVudChcbiAgXCJxdWlja19pbnNpZ2h0c19wcm9qZWN0ZWRfMkAxLmpzb25cIixcbikuanNvbigpO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xNjkiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJxdWlja19pbnNpZ2h0c19wcm9qZWN0ZWRfMyA9IEZpbGVBdHRhY2htZW50KFxuICBcInF1aWNrX2luc2lnaHRzX3Byb2plY3RlZF8zX29ubHlfYWZyaWNhLmpzb25cIixcbikuanNvbigpO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdwcmV0dHlMYW5ndWFnZVZpZXcnKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnd2FybWluZ19sZXZlbCcpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdzZWxlY3RHZW9EYXRhVHlwZScpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdyYWRpb1NvcnREb3RQbG90Q3JvcCcpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdsYW5ndWFnZScpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdzZWxlY3RfY3JvcCcpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdjcm9wX3NlbGVjdG9yX3lpZWxkJykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ3NlbF9yZWdpb24nKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnY3JvcF9zZWxlY3Rvcl9keW5hbWljX2luc2lnaHRzJykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ2N5Y2xlX3NlbGVjdG9yX2RpJykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ3NjZW5hcmlvX3NlbGVjdG9yX2RpJykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ3lpZWxkX291dHB1dF9zZWxlY3Rvcl9kaScpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdjdWx0aXZhcl9zZWxlY3Rvcl9kaScpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdzZWxlY3RBZG1pbjAnKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnc2VsZWN0QWRtaW4xJykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ3NlbGVjdEFkbWluMicpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdhdGZjX2Nyb3Bfc2VsZWN0b3InKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnYXRmY19jeWNsZV9zZWxlY3RvcicpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdhdGZjX3NjZW5hcmlvX3NlbGVjdG9yJykifV19</script><script type="module">"file:"===window.location.protocol&&alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."),window._ojs.paths.runtimeToDoc="../../notebooks/projectedImpacts",window._ojs.paths.runtimeToRoot="../..",window._ojs.paths.docToRoot="../..",window._ojs.selfContained=!1,window._ojs.runtime.interpretFromScriptTags()</script><script id="quarto-html-after-body" type="application/javascript">window.document.addEventListener("DOMContentLoaded",function(t){const e=t=>{for(const e of t.classList)if(e.startsWith("code-annotation-"))return!0;return!1},n=function(t){const e=t.trigger;e.blur(),e.classList.add("code-copy-button-checked");var n=e.getAttribute("title");let o;e.setAttribute("title","Copied!"),window.bootstrap&&(e.setAttribute("data-bs-toggle","tooltip"),e.setAttribute("data-bs-placement","left"),e.setAttribute("data-bs-title","Copied!"),o=new bootstrap.Tooltip(e,{trigger:"manual",customClass:"code-copy-button-tooltip",offset:[0,-8]}),o.show()),setTimeout(function(){o&&(o.hide(),e.removeAttribute("data-bs-title"),e.removeAttribute("data-bs-toggle"),e.removeAttribute("data-bs-placement")),e.setAttribute("title",n),e.classList.remove("code-copy-button-checked")},1e3),t.clearSelection()},o=function(t){const n=t.parentElement.cloneNode(!0).querySelector("code");for(const t of n.children)e(t)&&t.remove();return n.innerText};if(new window.ClipboardJS(".code-copy-button:not([data-in-quarto-modal])",{text:o}).on("success",n),window.document.getElementById("quarto-embedded-source-code-modal")){new window.ClipboardJS(".code-copy-button[data-in-quarto-modal]",{text:o,container:window.document.getElementById("quarto-embedded-source-code-modal")}).on("success",n)}for(var i=new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//),a=new RegExp(/^mailto:/),l=new RegExp("https://adaptationatlas.github.io/atlas_notebooks/"),r=t=>l.test(t)||i.test(t)||a.test(t),d=window.document.querySelectorAll("a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)"),c=0;c<d.length;c++){const t=d[c];r(t.href)||void 0!==t.dataset.originalHref&&(t.href=t.dataset.originalHref)}function s(t,e,n,o){const i={allowHTML:!0,maxWidth:500,delay:100,arrow:!1,appendTo:function(t){return t.parentElement},interactive:!0,interactiveBorder:10,theme:"quarto",placement:"bottom-start"};e&&(i.content=e),n&&(i.onTrigger=n),o&&(i.onUntrigger=o),window.tippy(t,i)}const u=window.document.querySelectorAll('a[role="doc-noteref"]');for(c=0;c<u.length;c++){const t=u[c];s(t,function(){let e=t.getAttribute("data-footnote-href")||t.getAttribute("href");try{e=new URL(e).hash}catch{}const n=e.replace(/^#\/?/,""),o=window.document.getElementById(n);return o?o.innerHTML:""})}const h=window.document.querySelectorAll("a.quarto-xref"),m=(t,e)=>{const n=t=>{if(t.classList.remove("page-full","page-columns"),t.children)for(const e of t.children)n(e)};if(n(e),null===t||t.startsWith("sec-")){const t=document.createElement("div");if(e.children&&e.children.length>2){t.appendChild(e.children[0].cloneNode(!0));for(let n=1;n<e.children.length;n++){const o=e.children[n];if("P"!==o.tagName||""!==o.innerText){t.appendChild(o.cloneNode(!0));break}}return window.Quarto?.typesetMath&&window.Quarto.typesetMath(t),t.innerHTML}return window.Quarto?.typesetMath&&window.Quarto.typesetMath(e),e.innerHTML}{const t=e.querySelector("a.anchorjs-link");return t&&t.remove(),window.Quarto?.typesetMath&&window.Quarto.typesetMath(e),e.classList.contains("callout")?e.outerHTML:e.innerHTML}};for(c=0;c<h.length;c++){const t=h[c];s(t,void 0,function(e){e.disable();let n,o=t.getAttribute("href");if(o.startsWith("#"))n=o;else try{n=new URL(o).hash}catch{}if(n){const t=n.replace(/^#\/?/,""),i=window.document.getElementById(t);if(null!==i)try{const n=m(t,i.cloneNode(!0));e.setContent(n)}finally{e.enable(),e.show()}else fetch(o.split("#")[0]).then(t=>t.text()).then(n=>{const o=(new DOMParser).parseFromString(n,"text/html").getElementById(t);if(null!==o){const n=m(t,o);e.setContent(n)}}).finally(()=>{e.enable(),e.show()})}else fetch(o).then(t=>t.text()).then(t=>{const n=(new DOMParser).parseFromString(t,"text/html").querySelector("main.content");if(null!==n){n.children.length>0&&"HEADER"===n.children[0].tagName&&n.children[0].remove();const t=m(null,n);e.setContent(t)}}).finally(()=>{e.enable(),e.show()})},function(t){})}let w;const g=t=>{window.document;const e=t.getAttribute("data-target-cell"),n=t.getAttribute("data-target-annotation");const o=window.document.querySelector('span[data-code-cell="'+e+'"][data-code-annotation="'+n+'"]').getAttribute("data-code-lines").split(",").map(t=>e+"-"+t);let i=null,a=null,l=null;if(o.length>0){const n=window.document.getElementById(o[0]);if(i=n.offsetTop,a=n.offsetHeight,l=n.parentElement.parentElement,o.length>1){const t=window.document.getElementById(o[o.length-1]);a=t.offsetTop+t.offsetHeight-i}if(null!==i&&null!==a&&null!==l){let t=window.document.getElementById("code-annotation-line-highlight");null===t&&(t=window.document.createElement("div"),t.setAttribute("id","code-annotation-line-highlight"),t.style.position="absolute",l.appendChild(t)),t.style.top=i-2+"px",t.style.height=a+4+"px",t.style.left=0;let n=window.document.getElementById("code-annotation-line-highlight-gutter");if(null===n){n=window.document.createElement("div"),n.setAttribute("id","code-annotation-line-highlight-gutter"),n.style.position="absolute";window.document.getElementById(e).querySelector(".code-annotation-gutter").appendChild(n)}n.style.top=i-2+"px",n.style.height=a+4+"px"}w=t}},p=()=>{["code-annotation-line-highlight","code-annotation-line-highlight-gutter"].forEach(t=>{const e=window.document.getElementById(t);e&&e.remove()}),w=void 0};window.addEventListener("resize",function(t,e){let n,o=!1;return(...i)=>{o?(n&&clearTimeout(n),n=setTimeout(()=>{t.apply(this,i),n=o=!1},e)):(t.apply(this,i),o=!0)}}(()=>{elRect=void 0,w&&g(w)},10));const f=window.document.querySelectorAll("dt[data-target-cell]");for(const t of f)t.addEventListener("click",t=>{const e=t.target;if(e!==w){p();const t=window.document.querySelector("dt[data-target-cell].code-annotation-active");t&&t.classList.remove("code-annotation-active"),g(e),e.classList.add("code-annotation-active")}else p(),e.classList.remove("code-annotation-active")});const b=t=>{const e=t.parentElement;if(e){const n=e.dataset.cites;return n?{el:t,cites:n.split(" ")}:b(t.parentElement)}};var y=window.document.querySelectorAll('a[role="doc-biblioref"]');for(c=0;c<y.length;c++){const t=y[c],e=b(t);e&&s(e.el,function(){var t=window.document.createElement("div");return e.cites.forEach(function(e){var n=window.document.createElement("div");n.classList.add("hanging-indent"),n.classList.add("csl-entry");var o=window.document.getElementById("ref-"+e);o&&(n.innerHTML=o.innerHTML),t.appendChild(n)}),t.innerHTML})}})</script></div></body></html>