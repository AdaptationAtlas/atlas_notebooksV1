<!doctype html><html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head><meta charset="utf-8"><meta name="generator" content="quarto-1.8.26"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=yes"><title>notebook</title><style>code{white-space:pre-wrap}span.smallcaps{font-variant:small-caps}div.columns{display:flex;gap:min(4vw,1.5em)}div.column{flex:auto;overflow-x:auto}div.hanging-indent{margin-left:1.5em;text-indent:-1.5em}ul.task-list{list-style:none}ul.task-list li input[type=checkbox]{width:.8em;margin:0 .8em .2em -1em;vertical-align:middle}html{-webkit-text-size-adjust:100%}pre>code.sourceCode{white-space:pre;position:relative}pre>code.sourceCode>span{display:inline-block;line-height:1.25}pre>code.sourceCode>span:empty{height:1.2em}.sourceCode{overflow:visible}code.sourceCode>span{color:inherit;text-decoration:inherit}div.sourceCode{margin:1em 0}pre.sourceCode{margin:0}@media screen{div.sourceCode{overflow:auto}}@media print{pre>code.sourceCode{white-space:pre-wrap}pre>code.sourceCode>span{text-indent:-5em;padding-left:5em}}pre.numberSource code{counter-reset:source-line 0}pre.numberSource code>span{position:relative;left:-4em;counter-increment:source-line}pre.numberSource code>span>a:first-child::before{content:counter(source-line);position:relative;left:-1em;text-align:right;vertical-align:baseline;border:none;display:inline-block;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;padding:0 4px;width:4em}pre.numberSource{margin-left:3em;padding-left:4px}@media screen{pre>code.sourceCode>span>a:first-child::before{text-decoration:underline}}</style><script src="../../site_libs/quarto-nav/quarto-nav.js"></script><script src="../../site_libs/quarto-nav/headroom.min.js"></script><link href="../../images/atlas-icon.svg" rel="icon" type="image/svg+xml"><script src="../../site_libs/clipboard/clipboard.min.js"></script><script src="../../site_libs/quarto-html/quarto.js" type="module"></script><script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script><script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script><script src="../../site_libs/quarto-html/popper.min.js"></script><script src="../../site_libs/quarto-html/tippy.umd.min.js"></script><link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet"><link href="../../site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles"><script src="../../site_libs/bootstrap/bootstrap.min.js"></script><link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet"><link href="../../site_libs/bootstrap/bootstrap-730ea3c3007e3756c9d7af36786c00c3.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans&amp;display=swap" rel="stylesheet"><script type="module" src="../../site_libs/quarto-ojs/quarto-ojs-runtime.js"></script><link href="../../site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet"><link rel="stylesheet" href="../../styles.css"></head><body class="nav-fixed fullcontent quarto-light"><div id="quarto-search-results"></div><header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg" data-bs-theme="dark"><div class="navbar-container container-fluid"><div class="navbar-brand-container mx-auto"><a href="https://adaptationatlas.cgiar.org" class="navbar-brand navbar-brand-logo"><img src="../../images/atlas-logo.svg" alt="The Africa Agriculture Adaptation Atlas" class="navbar-logo light-content"> <img src="../../images/atlas-logo.svg" alt="The Africa Agriculture Adaptation Atlas" class="navbar-logo dark-content"></a></div><button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="window.quartoToggleHeadroom&&window.quartoToggleHeadroom()"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarCollapse"><ul class="navbar-nav navbar-nav-scroll ms-auto"><li class="nav-item"><a class="nav-link" href="../../docs/doc_index.html"><i class="bi bi-info-circle" role="img" aria-label="More Information"></i> <span class="menu-text">Documentation</span></a></li><li class="nav-item"><a class="nav-link" href="https://github.com/AdaptationAtlas/atlas_notebooks/issues/new"><span class="menu-text">Report an Issue</span></a></li><li class="nav-item compact"><a class="nav-link" href="https://github.com/AdaptationAtlas/atlas_notebooks"><i class="bi bi-github" role="img" aria-label="GitHub"></i> <span class="menu-text"></span></a></li></ul></div><div class="quarto-navbar-tools"></div></div></nav></header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar"><main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"></header><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb1" data-startfrom="8" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 7"><span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { heroImage } <span class="im">from</span> <span class="st">"/helpers/hero.js"</span><span class="op">;</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>hero_url <span class="op">=</span> <span class="st">"./../../images/explore.webp"</span><span class="op">;</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>hero <span class="op">=</span> <span class="fu">heroImage</span>(notebookTitle<span class="op">,</span> hero_url)<span class="op">;</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`</span><span class="sc">${</span>hero<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-1-1" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-1-2" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-1-3" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-1-4" data-nodetype="expression"></div></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb2" data-startfrom="16" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 15"><span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { atlasTOC } <span class="im">from</span> <span class="st">'/helpers/toc.ojs'</span> </span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">await</span> nbText <span class="co">// force wait/reload with nbText to load so headings have correct labels/languages</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="fu">atlasTOC</span>({</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>      <span class="dt">heading</span><span class="op">:</span> <span class="vs">`&lt;b&gt;</span><span class="sc">${</span><span class="fu">_lang</span>({<span class="dt">en</span><span class="op">:</span><span class="st">"In this notebook"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span><span class="st">"Dans ce notebook"</span>})<span class="sc">}</span><span class="vs">&lt;/b&gt;`</span><span class="op">,</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>      <span class="dt">skip</span><span class="op">:</span> [notebookTitle<span class="op">,</span> <span class="st">"notebook-title"</span><span class="op">,</span> <span class="st">"Appendix"</span><span class="op">,</span> <span class="st">"source-code"</span>]</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>      })</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-2-1" data-nodetype="declaration"></div></div></div><div class="cell-output cell-output-display"><div><div id="ojs-cell-2-2" data-nodetype="expression"></div></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb3" data-startfrom="26" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 25"><span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>viewof prettyLanguageView <span class="op">=</span> {</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> Inputs<span class="op">.</span><span class="fu">bind</span>(</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>    Inputs<span class="op">.</span><span class="fu">radio</span>(languages<span class="op">,</span> {</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>      <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>({<span class="dt">en</span><span class="op">:</span> <span class="st">"Language"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Langue"</span>})<span class="op">,</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>      <span class="dt">format</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">label</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>    })<span class="op">,</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>    viewof language</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-3" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb4" data-startfrom="38" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 37"><span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`# </span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">overview</span><span class="op">.</span><span class="at">title</span>)<span class="sc">}</span></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a><span class="vs">_</span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">overview</span><span class="op">.</span><span class="at">subTitle</span>)<span class="sc">}</span><span class="vs">_</span></span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">overview</span><span class="op">.</span><span class="at">text</span>)<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-4" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb5" data-startfrom="46" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 45"><span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`</span></span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;div style="</span></span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a><span class="vs">    margin:16px 0;</span></span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a><span class="vs">    padding:14px 18px;</span></span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a><span class="vs">    border-radius:8px;</span></span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a><span class="vs">    background:linear-gradient(135deg, #4f7bd9, #6fa8dc);</span></span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a><span class="vs">    color:#ffffff;</span></span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a><span class="vs">  "&gt;</span></span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;div style="</span></span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a><span class="vs">      font-size:1.15rem;</span></span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a><span class="vs">      font-weight:600;</span></span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a><span class="vs">      margin-bottom:4px;</span></span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a><span class="vs">    "&gt;</span></span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a><span class="vs">      </span><span class="sc">${</span><span class="fu">_lang</span>({</span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Looking for raster maps?"</span><span class="op">,</span></span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Vous cherchez des cartes raster ?"</span><span class="op">,</span></span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a>      })<span class="sc">}</span></span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;/div&gt;</span></span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;div style="</span></span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a><span class="vs">      font-size:0.95rem;</span></span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a><span class="vs">      line-height:1.4;</span></span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a><span class="vs">    "&gt;</span></span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true" tabindex="-1"></a><span class="vs">      </span><span class="sc">${</span><span class="fu">_lang</span>({</span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Raster layers are available in our previous Explore view."</span><span class="op">,</span></span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Les couches raster sont disponibles dans l’ancienne vue Explorer."</span><span class="op">,</span></span>
<span id="cb5-72"><a href="#cb5-72" aria-hidden="true" tabindex="-1"></a>      })<span class="sc">}</span></span>
<span id="cb5-73"><a href="#cb5-73" aria-hidden="true" tabindex="-1"></a><span class="vs">      &lt;a</span></span>
<span id="cb5-74"><a href="#cb5-74" aria-hidden="true" tabindex="-1"></a><span class="vs">        href="http://agadaptationatlas-stage.org.s3-website-us-west-2.amazonaws.com/explore"</span></span>
<span id="cb5-75"><a href="#cb5-75" aria-hidden="true" tabindex="-1"></a><span class="vs">        target="_blank"</span></span>
<span id="cb5-76"><a href="#cb5-76" aria-hidden="true" tabindex="-1"></a><span class="vs">        rel="noopener noreferrer"</span></span>
<span id="cb5-77"><a href="#cb5-77" aria-hidden="true" tabindex="-1"></a><span class="vs">        style="</span></span>
<span id="cb5-78"><a href="#cb5-78" aria-hidden="true" tabindex="-1"></a><span class="vs">          color:#ffffff;</span></span>
<span id="cb5-79"><a href="#cb5-79" aria-hidden="true" tabindex="-1"></a><span class="vs">          font-weight:600;</span></span>
<span id="cb5-80"><a href="#cb5-80" aria-hidden="true" tabindex="-1"></a><span class="vs">          text-decoration:underline;</span></span>
<span id="cb5-81"><a href="#cb5-81" aria-hidden="true" tabindex="-1"></a><span class="vs">          margin-left:4px;</span></span>
<span id="cb5-82"><a href="#cb5-82" aria-hidden="true" tabindex="-1"></a><span class="vs">        "</span></span>
<span id="cb5-83"><a href="#cb5-83" aria-hidden="true" tabindex="-1"></a><span class="vs">      &gt;</span></span>
<span id="cb5-84"><a href="#cb5-84" aria-hidden="true" tabindex="-1"></a><span class="vs">        </span><span class="sc">${</span><span class="fu">_lang</span>({</span>
<span id="cb5-85"><a href="#cb5-85" aria-hidden="true" tabindex="-1"></a>          <span class="dt">en</span><span class="op">:</span> <span class="st">"Open Explore →"</span><span class="op">,</span></span>
<span id="cb5-86"><a href="#cb5-86" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fr</span><span class="op">:</span> <span class="st">"Ouvrir Explorer →"</span><span class="op">,</span></span>
<span id="cb5-87"><a href="#cb5-87" aria-hidden="true" tabindex="-1"></a>        })<span class="sc">}</span></span>
<span id="cb5-88"><a href="#cb5-88" aria-hidden="true" tabindex="-1"></a><span class="vs">      &lt;/a&gt;</span></span>
<span id="cb5-89"><a href="#cb5-89" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;/div&gt;</span></span>
<span id="cb5-90"><a href="#cb5-90" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/div&gt;</span></span>
<span id="cb5-91"><a href="#cb5-91" aria-hidden="true" tabindex="-1"></a><span class="vs">`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-5" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb6" data-startfrom="95" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 94"><span id="cb6-95"><a href="#cb6-95" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`# </span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">selectCategory</span><span class="op">.</span><span class="at">title_main</span>)<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-6" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb7" data-startfrom="99" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 98"><span id="cb7-99"><a href="#cb7-99" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`### </span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">selectCategory</span><span class="op">.</span><span class="at">title</span>)<span class="sc">}</span></span>
<span id="cb7-100"><a href="#cb7-100" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">selectCategory</span><span class="op">.</span><span class="at">text</span>)<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-7" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb8" data-startfrom="104" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 103"><span id="cb8-104"><a href="#cb8-104" aria-hidden="true" tabindex="-1"></a>viewof atlas_cat <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">radio</span>([<span class="st">"Hazard"</span><span class="op">,</span> <span class="st">"Exposure"</span><span class="op">,</span> <span class="st">"Vulnerability"</span>]<span class="op">,</span> {</span>
<span id="cb8-105"><a href="#cb8-105" aria-hidden="true" tabindex="-1"></a>  <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">selectCategory</span><span class="op">.</span><span class="at">selector</span><span class="op">.</span><span class="at">title</span>)<span class="op">,</span></span>
<span id="cb8-106"><a href="#cb8-106" aria-hidden="true" tabindex="-1"></a>  <span class="dt">value</span><span class="op">:</span> <span class="st">"Hazard"</span><span class="op">,</span></span>
<span id="cb8-107"><a href="#cb8-107" aria-hidden="true" tabindex="-1"></a>  <span class="dt">format</span><span class="op">:</span> (l) <span class="kw">=&gt;</span>  <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">selectCategory</span><span class="op">.</span><span class="at">selector</span><span class="op">.</span><span class="at">options</span>[l]<span class="op">.</span><span class="at">title</span>)</span>
<span id="cb8-108"><a href="#cb8-108" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-8" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb9" data-startfrom="112" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 111"><span id="cb9-112"><a href="#cb9-112" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb9-113"><a href="#cb9-113" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="fu">md</span><span class="vs">`</span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">selectCategory</span><span class="op">.</span><span class="at">selector</span><span class="op">.</span><span class="at">options</span>[atlas_cat]<span class="op">.</span><span class="at">description</span>)<span class="sc">}</span><span class="vs">`</span></span>
<span id="cb9-114"><a href="#cb9-114" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-9" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb10" data-startfrom="118" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 117"><span id="cb10-118"><a href="#cb10-118" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`### </span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">selectVars</span><span class="op">.</span><span class="at">title</span>)<span class="sc">}</span></span>
<span id="cb10-119"><a href="#cb10-119" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">selectVars</span><span class="op">.</span><span class="at">text</span>)<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-10" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb11" data-startfrom="123" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 122"><span id="cb11-123"><a href="#cb11-123" aria-hidden="true" tabindex="-1"></a>definitions <span class="op">=</span> <span class="fu">create_definitions</span>(atlas_cat)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-11" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb12" data-startfrom="127" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 126"><span id="cb12-127"><a href="#cb12-127" aria-hidden="true" tabindex="-1"></a>viewof DataSelector_form <span class="op">=</span> {</span>
<span id="cb12-128"><a href="#cb12-128" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> form_elements <span class="op">=</span> {</span>
<span id="cb12-129"><a href="#cb12-129" aria-hidden="true" tabindex="-1"></a>    <span class="dt">hazardGroup_form</span><span class="op">:</span></span>
<span id="cb12-130"><a href="#cb12-130" aria-hidden="true" tabindex="-1"></a>      atlas_cat <span class="op">===</span> <span class="st">"Hazard"</span></span>
<span id="cb12-131"><a href="#cb12-131" aria-hidden="true" tabindex="-1"></a>        <span class="op">?</span> Inputs<span class="op">.</span><span class="fu">form</span>(</span>
<span id="cb12-132"><a href="#cb12-132" aria-hidden="true" tabindex="-1"></a>            {</span>
<span id="cb12-133"><a href="#cb12-133" aria-hidden="true" tabindex="-1"></a>              <span class="dt">hazard_sel</span><span class="op">:</span> <span class="fu">ScrollingMultiSelect_collapsible</span>(</span>
<span id="cb12-134"><a href="#cb12-134" aria-hidden="true" tabindex="-1"></a>                <span class="co">// Object.keys(hazard_dict),</span></span>
<span id="cb12-135"><a href="#cb12-135" aria-hidden="true" tabindex="-1"></a>                <span class="kw">new</span> <span class="bu">Map</span>(</span>
<span id="cb12-136"><a href="#cb12-136" aria-hidden="true" tabindex="-1"></a>                  <span class="bu">Object</span><span class="op">.</span><span class="fu">entries</span>(hazard_dict)<span class="op">.</span><span class="fu">map</span>(([key<span class="op">,</span> value]) <span class="kw">=&gt;</span> [</span>
<span id="cb12-137"><a href="#cb12-137" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">hazards</span>[key])<span class="op">,</span></span>
<span id="cb12-138"><a href="#cb12-138" aria-hidden="true" tabindex="-1"></a>                    key</span>
<span id="cb12-139"><a href="#cb12-139" aria-hidden="true" tabindex="-1"></a>                  ])</span>
<span id="cb12-140"><a href="#cb12-140" aria-hidden="true" tabindex="-1"></a>                )<span class="op">,</span></span>
<span id="cb12-141"><a href="#cb12-141" aria-hidden="true" tabindex="-1"></a>                {</span>
<span id="cb12-142"><a href="#cb12-142" aria-hidden="true" tabindex="-1"></a>                  <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">selectVars</span><span class="op">.</span><span class="at">forms</span><span class="op">.</span><span class="at">Hazard</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">hazard</span><span class="op">.</span><span class="at">title</span>)<span class="op">,</span> </span>
<span id="cb12-143"><a href="#cb12-143" aria-hidden="true" tabindex="-1"></a>                  <span class="dt">values</span><span class="op">:</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">keys</span>(hazard_dict)<span class="op">,</span></span>
<span id="cb12-144"><a href="#cb12-144" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb12-145"><a href="#cb12-145" aria-hidden="true" tabindex="-1"></a>              )<span class="op">,</span></span>
<span id="cb12-146"><a href="#cb12-146" aria-hidden="true" tabindex="-1"></a>              <span class="dt">timeperiod_sel</span><span class="op">:</span> <span class="fu">ScrollingMultiSelect_collapsible</span>(</span>
<span id="cb12-147"><a href="#cb12-147" aria-hidden="true" tabindex="-1"></a>                <span class="kw">new</span> <span class="bu">Map</span>([</span>
<span id="cb12-148"><a href="#cb12-148" aria-hidden="true" tabindex="-1"></a>                  [<span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">selectVars</span><span class="op">.</span><span class="at">forms</span><span class="op">.</span><span class="at">Hazard</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">period</span><span class="op">.</span><span class="at">options</span><span class="op">.</span><span class="at">baseline</span>)<span class="op">,</span> <span class="st">"historic"</span>]<span class="op">,</span></span>
<span id="cb12-149"><a href="#cb12-149" aria-hidden="true" tabindex="-1"></a>                  [<span class="st">"2021-2040"</span><span class="op">,</span> <span class="st">"2021_2040"</span>]<span class="op">,</span></span>
<span id="cb12-150"><a href="#cb12-150" aria-hidden="true" tabindex="-1"></a>                  [<span class="st">"2041-2060"</span><span class="op">,</span> <span class="st">"2041_2060"</span>]</span>
<span id="cb12-151"><a href="#cb12-151" aria-hidden="true" tabindex="-1"></a>                ])<span class="op">,</span></span>
<span id="cb12-152"><a href="#cb12-152" aria-hidden="true" tabindex="-1"></a>                {</span>
<span id="cb12-153"><a href="#cb12-153" aria-hidden="true" tabindex="-1"></a>                  <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">selectVars</span><span class="op">.</span><span class="at">forms</span><span class="op">.</span><span class="at">Hazard</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">period</span><span class="op">.</span><span class="at">title</span>)<span class="op">,</span></span>
<span id="cb12-154"><a href="#cb12-154" aria-hidden="true" tabindex="-1"></a>                  <span class="dt">values</span><span class="op">:</span> [<span class="st">"historic"</span><span class="op">,</span> <span class="st">"2021_2040"</span><span class="op">,</span> <span class="st">"2041_2060"</span> ]</span>
<span id="cb12-155"><a href="#cb12-155" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb12-156"><a href="#cb12-156" aria-hidden="true" tabindex="-1"></a>              )</span>
<span id="cb12-157"><a href="#cb12-157" aria-hidden="true" tabindex="-1"></a>            }<span class="op">,</span></span>
<span id="cb12-158"><a href="#cb12-158" aria-hidden="true" tabindex="-1"></a>            {</span>
<span id="cb12-159"><a href="#cb12-159" aria-hidden="true" tabindex="-1"></a>              <span class="dt">template</span><span class="op">:</span> (inputs) <span class="kw">=&gt;</span></span>
<span id="cb12-160"><a href="#cb12-160" aria-hidden="true" tabindex="-1"></a>                <span class="fu">html</span><span class="vs">`&lt;h4&gt;</span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">selectVars</span><span class="op">.</span><span class="at">forms</span><span class="op">.</span><span class="at">Hazard</span><span class="op">.</span><span class="at">mainTitle</span>)<span class="sc">}</span><span class="vs">&lt;/h4&gt;&lt;div style="display: flex; gap: 2em;"&gt; </span><span class="sc">${</span><span class="bu">Object</span><span class="op">.</span><span class="fu">values</span>(</span>
<span id="cb12-161"><a href="#cb12-161" aria-hidden="true" tabindex="-1"></a>                  inputs</span>
<span id="cb12-162"><a href="#cb12-162" aria-hidden="true" tabindex="-1"></a>                )<span class="sc">}</span><span class="vs">&lt;/div&gt;`</span></span>
<span id="cb12-163"><a href="#cb12-163" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb12-164"><a href="#cb12-164" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb12-165"><a href="#cb12-165" aria-hidden="true" tabindex="-1"></a>        <span class="op">:</span> <span class="st">""</span><span class="op">,</span></span>
<span id="cb12-166"><a href="#cb12-166" aria-hidden="true" tabindex="-1"></a>    <span class="dt">vulnerabilityGroup_form</span><span class="op">:</span></span>
<span id="cb12-167"><a href="#cb12-167" aria-hidden="true" tabindex="-1"></a>      atlas_cat <span class="op">===</span> <span class="st">"Vulnerability"</span></span>
<span id="cb12-168"><a href="#cb12-168" aria-hidden="true" tabindex="-1"></a>        <span class="op">?</span> Inputs<span class="op">.</span><span class="fu">form</span>(</span>
<span id="cb12-169"><a href="#cb12-169" aria-hidden="true" tabindex="-1"></a>            {</span>
<span id="cb12-170"><a href="#cb12-170" aria-hidden="true" tabindex="-1"></a>              <span class="dt">vulnerability_sel</span><span class="op">:</span> <span class="fu">ScrollingMultiSelect_collapsible</span>(</span>
<span id="cb12-171"><a href="#cb12-171" aria-hidden="true" tabindex="-1"></a>                [<span class="st">"Education"</span><span class="op">,</span> <span class="st">"Poverty"</span><span class="op">,</span> <span class="st">"Gender"</span>]<span class="op">,</span></span>
<span id="cb12-172"><a href="#cb12-172" aria-hidden="true" tabindex="-1"></a>                {</span>
<span id="cb12-173"><a href="#cb12-173" aria-hidden="true" tabindex="-1"></a>                  <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">selectVars</span><span class="op">.</span><span class="at">forms</span><span class="op">.</span><span class="at">Vulnerability</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">variable</span><span class="op">.</span><span class="at">title</span>)<span class="op">,</span></span>
<span id="cb12-174"><a href="#cb12-174" aria-hidden="true" tabindex="-1"></a>                  <span class="dt">values</span><span class="op">:</span> [<span class="st">"Education"</span><span class="op">,</span> <span class="st">"Poverty"</span><span class="op">,</span> <span class="st">"Gender"</span>]<span class="op">,</span></span>
<span id="cb12-175"><a href="#cb12-175" aria-hidden="true" tabindex="-1"></a>                  <span class="dt">format</span><span class="op">:</span> (l) <span class="kw">=&gt;</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">selectVars</span><span class="op">.</span><span class="at">forms</span><span class="op">.</span><span class="at">Vulnerability</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">variable</span><span class="op">.</span><span class="at">options</span>[l])</span>
<span id="cb12-176"><a href="#cb12-176" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb12-177"><a href="#cb12-177" aria-hidden="true" tabindex="-1"></a>              )</span>
<span id="cb12-178"><a href="#cb12-178" aria-hidden="true" tabindex="-1"></a>            }<span class="op">,</span></span>
<span id="cb12-179"><a href="#cb12-179" aria-hidden="true" tabindex="-1"></a>            {</span>
<span id="cb12-180"><a href="#cb12-180" aria-hidden="true" tabindex="-1"></a>              <span class="dt">template</span><span class="op">:</span> (inputs) <span class="kw">=&gt;</span></span>
<span id="cb12-181"><a href="#cb12-181" aria-hidden="true" tabindex="-1"></a>                <span class="fu">html</span><span class="vs">`&lt;h4&gt;</span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">selectVars</span><span class="op">.</span><span class="at">forms</span><span class="op">.</span><span class="at">Vulnerability</span><span class="op">.</span><span class="at">mainTitle</span>)<span class="sc">}</span><span class="vs">&lt;/h4&gt;&lt;div style="display: flex; gap: 2em;"&gt; </span><span class="sc">${</span><span class="bu">Object</span><span class="op">.</span><span class="fu">values</span>(</span>
<span id="cb12-182"><a href="#cb12-182" aria-hidden="true" tabindex="-1"></a>                  inputs</span>
<span id="cb12-183"><a href="#cb12-183" aria-hidden="true" tabindex="-1"></a>                )<span class="sc">}</span><span class="vs">&lt;/div&gt;`</span></span>
<span id="cb12-184"><a href="#cb12-184" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb12-185"><a href="#cb12-185" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb12-186"><a href="#cb12-186" aria-hidden="true" tabindex="-1"></a>        <span class="op">:</span> <span class="st">""</span><span class="op">,</span></span>
<span id="cb12-187"><a href="#cb12-187" aria-hidden="true" tabindex="-1"></a>    <span class="dt">exposureGroup_form</span><span class="op">:</span></span>
<span id="cb12-188"><a href="#cb12-188" aria-hidden="true" tabindex="-1"></a>      atlas_cat <span class="op">===</span> <span class="st">"Exposure"</span></span>
<span id="cb12-189"><a href="#cb12-189" aria-hidden="true" tabindex="-1"></a>        <span class="op">?</span> Inputs<span class="op">.</span><span class="fu">form</span>(</span>
<span id="cb12-190"><a href="#cb12-190" aria-hidden="true" tabindex="-1"></a>            {</span>
<span id="cb12-191"><a href="#cb12-191" aria-hidden="true" tabindex="-1"></a>              <span class="dt">exposureGroup_sel</span><span class="op">:</span> <span class="fu">ScrollingMultiSelect_collapsible</span>(</span>
<span id="cb12-192"><a href="#cb12-192" aria-hidden="true" tabindex="-1"></a>                <span class="co">// Object.values(commodities).flat(),</span></span>
<span id="cb12-193"><a href="#cb12-193" aria-hidden="true" tabindex="-1"></a>                [<span class="st">"Crop"</span><span class="op">,</span> <span class="st">"Livestock"</span><span class="op">,</span> <span class="st">"Population"</span>]<span class="op">,</span></span>
<span id="cb12-194"><a href="#cb12-194" aria-hidden="true" tabindex="-1"></a>                {</span>
<span id="cb12-195"><a href="#cb12-195" aria-hidden="true" tabindex="-1"></a>                  <span class="dt">label</span><span class="op">:</span> <span class="st">"Exposure Category"</span><span class="op">,</span></span>
<span id="cb12-196"><a href="#cb12-196" aria-hidden="true" tabindex="-1"></a>                  <span class="dt">values</span><span class="op">:</span> [<span class="st">"Crop"</span><span class="op">,</span> <span class="st">"Livestock"</span><span class="op">,</span> <span class="st">"Population"</span>]<span class="op">,</span></span>
<span id="cb12-197"><a href="#cb12-197" aria-hidden="true" tabindex="-1"></a>                  <span class="dt">format</span><span class="op">:</span> (l) <span class="kw">=&gt;</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">selectVars</span><span class="op">.</span><span class="at">forms</span><span class="op">.</span><span class="at">Exposure</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">variable</span><span class="op">.</span><span class="at">options</span>[l])</span>
<span id="cb12-198"><a href="#cb12-198" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb12-199"><a href="#cb12-199" aria-hidden="true" tabindex="-1"></a>              )</span>
<span id="cb12-200"><a href="#cb12-200" aria-hidden="true" tabindex="-1"></a>            }<span class="op">,</span></span>
<span id="cb12-201"><a href="#cb12-201" aria-hidden="true" tabindex="-1"></a>            {</span>
<span id="cb12-202"><a href="#cb12-202" aria-hidden="true" tabindex="-1"></a>              <span class="dt">template</span><span class="op">:</span> (inputs) <span class="kw">=&gt;</span></span>
<span id="cb12-203"><a href="#cb12-203" aria-hidden="true" tabindex="-1"></a>                <span class="fu">html</span><span class="vs">`&lt;h4&gt;</span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">selectVars</span><span class="op">.</span><span class="at">forms</span><span class="op">.</span><span class="at">Exposure</span><span class="op">.</span><span class="at">mainTitle</span>)<span class="sc">}</span><span class="vs">&lt;/h4&gt;&lt;div style="display: flex; gap: 2em;"&gt; </span><span class="sc">${</span><span class="bu">Object</span><span class="op">.</span><span class="fu">values</span>(</span>
<span id="cb12-204"><a href="#cb12-204" aria-hidden="true" tabindex="-1"></a>                  inputs</span>
<span id="cb12-205"><a href="#cb12-205" aria-hidden="true" tabindex="-1"></a>                )<span class="sc">}</span><span class="vs">&lt;/div&gt;`</span></span>
<span id="cb12-206"><a href="#cb12-206" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb12-207"><a href="#cb12-207" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb12-208"><a href="#cb12-208" aria-hidden="true" tabindex="-1"></a>        <span class="op">:</span> <span class="st">""</span></span>
<span id="cb12-209"><a href="#cb12-209" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb12-210"><a href="#cb12-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-211"><a href="#cb12-211" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> Inputs<span class="op">.</span><span class="fu">form</span>(form_elements)<span class="op">;</span></span>
<span id="cb12-212"><a href="#cb12-212" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-12" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb13" data-startfrom="216" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 215"><span id="cb13-216"><a href="#cb13-216" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`### </span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">selectGeog</span><span class="op">.</span><span class="at">title</span>)<span class="sc">}</span></span>
<span id="cb13-217"><a href="#cb13-217" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">selectGeog</span><span class="op">.</span><span class="at">text</span>)<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-13" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb14" data-startfrom="221" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 220"><span id="cb14-221"><a href="#cb14-221" aria-hidden="true" tabindex="-1"></a>viewof admin_aggregationLevel <span class="op">=</span> {</span>
<span id="cb14-222"><a href="#cb14-222" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> admin_choices <span class="op">=</span> [<span class="st">'admin0_name'</span><span class="op">,</span> <span class="st">'admin1_name'</span><span class="op">,</span> <span class="st">'admin2_name'</span>]</span>
<span id="cb14-223"><a href="#cb14-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-224"><a href="#cb14-224" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> radio <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">radio</span>(admin_choices<span class="op">,</span> {</span>
<span id="cb14-225"><a href="#cb14-225" aria-hidden="true" tabindex="-1"></a>    <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">selectGeog</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">aggregationLvl</span><span class="op">.</span><span class="at">title</span>)<span class="op">,</span></span>
<span id="cb14-226"><a href="#cb14-226" aria-hidden="true" tabindex="-1"></a>    <span class="dt">value</span><span class="op">:</span> <span class="st">"admin1_name"</span><span class="op">,</span></span>
<span id="cb14-227"><a href="#cb14-227" aria-hidden="true" tabindex="-1"></a>    <span class="dt">format</span><span class="op">:</span> (l) <span class="kw">=&gt;</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">selectGeog</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">aggregationLvl</span><span class="op">.</span><span class="at">options</span>[l])</span>
<span id="cb14-228"><a href="#cb14-228" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb14-229"><a href="#cb14-229" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> selectors <span class="op">=</span> radio<span class="op">.</span><span class="fu">querySelectorAll</span>(<span class="st">"input[name=input]"</span>)<span class="op">;</span></span>
<span id="cb14-230"><a href="#cb14-230" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> labels <span class="op">=</span> radio<span class="op">.</span><span class="fu">querySelectorAll</span>(<span class="st">"label"</span>)<span class="op">;</span></span>
<span id="cb14-231"><a href="#cb14-231" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (selectors <span class="op">&amp;&amp;</span> selectors[<span class="dv">2</span>] <span class="op">&amp;&amp;</span> country <span class="op">===</span> <span class="st">'SSA'</span>) {</span>
<span id="cb14-232"><a href="#cb14-232" aria-hidden="true" tabindex="-1"></a>    selectors[<span class="dv">2</span>]<span class="op">.</span><span class="at">title</span> <span class="op">=</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">selectGeog</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">aggregationLvl</span><span class="op">.</span><span class="at">warning</span>)<span class="op">;</span></span>
<span id="cb14-233"><a href="#cb14-233" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb14-234"><a href="#cb14-234" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (labels <span class="op">&amp;&amp;</span> labels[<span class="dv">2</span>] <span class="op">&amp;&amp;</span> country <span class="op">===</span> <span class="st">'SSA'</span>) {</span>
<span id="cb14-235"><a href="#cb14-235" aria-hidden="true" tabindex="-1"></a>    labels[<span class="dv">3</span>]<span class="op">.</span><span class="at">title</span> <span class="op">=</span></span>
<span id="cb14-236"><a href="#cb14-236" aria-hidden="true" tabindex="-1"></a>      <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">selectGeog</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">aggregationLvl</span><span class="op">.</span><span class="at">warning</span>)<span class="op">;</span></span>
<span id="cb14-237"><a href="#cb14-237" aria-hidden="true" tabindex="-1"></a>  labels[<span class="dv">3</span>]<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">color</span> <span class="op">=</span> <span class="st">"#b8310f"</span><span class="op">;</span></span>
<span id="cb14-238"><a href="#cb14-238" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb14-239"><a href="#cb14-239" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> radio<span class="op">;</span></span>
<span id="cb14-240"><a href="#cb14-240" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-14" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb15" data-startfrom="244" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 243"><span id="cb15-244"><a href="#cb15-244" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb15-245"><a href="#cb15-245" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> adminOptions <span class="op">=</span> [</span>
<span id="cb15-246"><a href="#cb15-246" aria-hidden="true" tabindex="-1"></a>    Inputs<span class="op">.</span><span class="fu">bind</span>(</span>
<span id="cb15-247"><a href="#cb15-247" aria-hidden="true" tabindex="-1"></a>      Inputs<span class="op">.</span><span class="fu">select</span>(admin0_names<span class="op">,</span> { <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">selectGeog</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">admin0_name</span><span class="op">.</span><span class="at">title</span>)<span class="op">,</span></span>
<span id="cb15-248"><a href="#cb15-248" aria-hidden="true" tabindex="-1"></a>                                   <span class="dt">value</span><span class="op">:</span> <span class="st">"SSA"</span><span class="op">,</span></span>
<span id="cb15-249"><a href="#cb15-249" aria-hidden="true" tabindex="-1"></a>                                  <span class="dt">format</span><span class="op">:</span> l <span class="kw">=&gt;</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">adminNames</span>[l]) <span class="op">||</span> l})<span class="op">,</span></span>
<span id="cb15-250"><a href="#cb15-250" aria-hidden="true" tabindex="-1"></a>      viewof country</span>
<span id="cb15-251"><a href="#cb15-251" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb15-252"><a href="#cb15-252" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">;</span></span>
<span id="cb15-253"><a href="#cb15-253" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-254"><a href="#cb15-254" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> ([<span class="st">"admin1_name"</span><span class="op">,</span> <span class="st">"admin2_name"</span>]<span class="op">.</span><span class="fu">includes</span>(admin_aggregationLevel)) {</span>
<span id="cb15-255"><a href="#cb15-255" aria-hidden="true" tabindex="-1"></a>    adminOptions<span class="op">.</span><span class="fu">push</span>(</span>
<span id="cb15-256"><a href="#cb15-256" aria-hidden="true" tabindex="-1"></a>      Inputs<span class="op">.</span><span class="fu">bind</span>(</span>
<span id="cb15-257"><a href="#cb15-257" aria-hidden="true" tabindex="-1"></a>        Inputs<span class="op">.</span><span class="fu">select</span>(admin1_names<span class="op">,</span> </span>
<span id="cb15-258"><a href="#cb15-258" aria-hidden="true" tabindex="-1"></a>                      { </span>
<span id="cb15-259"><a href="#cb15-259" aria-hidden="true" tabindex="-1"></a>                        <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">selectGeog</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">admin1_name</span><span class="op">.</span><span class="at">title</span>)<span class="op">,</span></span>
<span id="cb15-260"><a href="#cb15-260" aria-hidden="true" tabindex="-1"></a>                        <span class="dt">format</span><span class="op">:</span> l <span class="kw">=&gt;</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">adminNames</span>[l]) <span class="op">||</span> l</span>
<span id="cb15-261"><a href="#cb15-261" aria-hidden="true" tabindex="-1"></a>                      })<span class="op">,</span></span>
<span id="cb15-262"><a href="#cb15-262" aria-hidden="true" tabindex="-1"></a>        viewof admin1_sel</span>
<span id="cb15-263"><a href="#cb15-263" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb15-264"><a href="#cb15-264" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb15-265"><a href="#cb15-265" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb15-266"><a href="#cb15-266" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-267"><a href="#cb15-267" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (admin_aggregationLevel <span class="op">===</span> <span class="st">"admin2_name"</span>) {</span>
<span id="cb15-268"><a href="#cb15-268" aria-hidden="true" tabindex="-1"></a>    adminOptions<span class="op">.</span><span class="fu">push</span>(</span>
<span id="cb15-269"><a href="#cb15-269" aria-hidden="true" tabindex="-1"></a>      Inputs<span class="op">.</span><span class="fu">bind</span>(</span>
<span id="cb15-270"><a href="#cb15-270" aria-hidden="true" tabindex="-1"></a>        Inputs<span class="op">.</span><span class="fu">select</span>(admin2_names<span class="op">,</span> { <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">selectGeog</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">admin2_name</span><span class="op">.</span><span class="at">title</span>)<span class="op">,</span></span>
<span id="cb15-271"><a href="#cb15-271" aria-hidden="true" tabindex="-1"></a>                     <span class="dt">format</span><span class="op">:</span> l <span class="kw">=&gt;</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">adminNames</span>[l]) <span class="op">||</span> l</span>
<span id="cb15-272"><a href="#cb15-272" aria-hidden="true" tabindex="-1"></a>                                    })<span class="op">,</span></span>
<span id="cb15-273"><a href="#cb15-273" aria-hidden="true" tabindex="-1"></a>        viewof admin2_sel</span>
<span id="cb15-274"><a href="#cb15-274" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb15-275"><a href="#cb15-275" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb15-276"><a href="#cb15-276" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb15-277"><a href="#cb15-277" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> Inputs<span class="op">.</span><span class="fu">form</span>(adminOptions<span class="op">,</span> {</span>
<span id="cb15-278"><a href="#cb15-278" aria-hidden="true" tabindex="-1"></a>    <span class="dt">template</span><span class="op">:</span> (inputs) <span class="kw">=&gt;</span></span>
<span id="cb15-279"><a href="#cb15-279" aria-hidden="true" tabindex="-1"></a>      htl<span class="op">.</span><span class="fu">html</span><span class="vs">`&lt;div style="display: flex; gap: 3em"&gt;</span><span class="sc">${</span>inputs<span class="sc">}</span><span class="vs">&lt;/div&gt;`</span></span>
<span id="cb15-280"><a href="#cb15-280" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb15-281"><a href="#cb15-281" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-15" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb16" data-startfrom="285" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 284"><span id="cb16-285"><a href="#cb16-285" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb16-286"><a href="#cb16-286" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> levelLabel <span class="op">=</span> <span class="fu">_lang</span>(</span>
<span id="cb16-287"><a href="#cb16-287" aria-hidden="true" tabindex="-1"></a>    nbText<span class="op">.</span><span class="at">selectGeog</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">aggregationLvl</span><span class="op">.</span><span class="at">options</span>[admin_aggregationLevel]</span>
<span id="cb16-288"><a href="#cb16-288" aria-hidden="true" tabindex="-1"></a>  )<span class="op">.</span><span class="fu">toLowerCase</span>()</span>
<span id="cb16-289"><a href="#cb16-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-290"><a href="#cb16-290" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> levelText <span class="op">=</span> <span class="fu">_lang</span>({</span>
<span id="cb16-291"><a href="#cb16-291" aria-hidden="true" tabindex="-1"></a>    <span class="dt">en</span><span class="op">:</span> <span class="vs">`at the </span><span class="sc">${</span>levelLabel<span class="sc">}</span><span class="vs"> level`</span><span class="op">,</span></span>
<span id="cb16-292"><a href="#cb16-292" aria-hidden="true" tabindex="-1"></a>    <span class="dt">fr</span><span class="op">:</span> <span class="vs">`au niveau </span><span class="sc">${</span>levelLabel<span class="sc">}</span><span class="vs">`</span></span>
<span id="cb16-293"><a href="#cb16-293" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb16-294"><a href="#cb16-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-295"><a href="#cb16-295" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> mainText <span class="op">=</span> <span class="fu">_lang</span>({</span>
<span id="cb16-296"><a href="#cb16-296" aria-hidden="true" tabindex="-1"></a>    <span class="dt">en</span><span class="op">:</span> <span class="vs">`Viewing </span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">adminNames</span>[country])<span class="sc">}</span><span class="vs">`</span><span class="op">,</span></span>
<span id="cb16-297"><a href="#cb16-297" aria-hidden="true" tabindex="-1"></a>    <span class="dt">fr</span><span class="op">:</span> <span class="vs">`Affichage de </span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">adminNames</span>[country])<span class="sc">}</span><span class="vs">`</span></span>
<span id="cb16-298"><a href="#cb16-298" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb16-299"><a href="#cb16-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-300"><a href="#cb16-300" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (admin_aggregationLevel <span class="op">===</span> <span class="st">"admin2_name"</span> <span class="op">&amp;&amp;</span> admin1_sel <span class="op">!==</span> <span class="st">"Full Country"</span>) {</span>
<span id="cb16-301"><a href="#cb16-301" aria-hidden="true" tabindex="-1"></a>    mainText <span class="op">+=</span> <span class="fu">_lang</span>({</span>
<span id="cb16-302"><a href="#cb16-302" aria-hidden="true" tabindex="-1"></a>      <span class="dt">en</span><span class="op">:</span> <span class="vs">`, </span><span class="sc">${</span>admin1_sel<span class="sc">}</span><span class="vs">`</span><span class="op">,</span></span>
<span id="cb16-303"><a href="#cb16-303" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fr</span><span class="op">:</span> <span class="vs">`, </span><span class="sc">${</span>admin1_sel<span class="sc">}</span><span class="vs">`</span></span>
<span id="cb16-304"><a href="#cb16-304" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb16-305"><a href="#cb16-305" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-306"><a href="#cb16-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-307"><a href="#cb16-307" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> highlightText <span class="op">=</span> <span class="st">""</span></span>
<span id="cb16-308"><a href="#cb16-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-309"><a href="#cb16-309" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (admin_aggregationLevel <span class="op">===</span> <span class="st">"admin1_name"</span> <span class="op">&amp;&amp;</span> admin1_sel <span class="op">!==</span> <span class="st">"Full Country"</span>) {</span>
<span id="cb16-310"><a href="#cb16-310" aria-hidden="true" tabindex="-1"></a>    highlightText <span class="op">=</span> <span class="fu">_lang</span>({</span>
<span id="cb16-311"><a href="#cb16-311" aria-hidden="true" tabindex="-1"></a>      <span class="dt">en</span><span class="op">:</span> <span class="vs">`</span><span class="sc">${</span>admin1_sel<span class="sc">}</span><span class="vs"> is highlighted`</span><span class="op">,</span></span>
<span id="cb16-312"><a href="#cb16-312" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fr</span><span class="op">:</span> <span class="vs">`</span><span class="sc">${</span>admin1_sel<span class="sc">}</span><span class="vs"> est mis en surbrillance`</span></span>
<span id="cb16-313"><a href="#cb16-313" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb16-314"><a href="#cb16-314" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (</span>
<span id="cb16-315"><a href="#cb16-315" aria-hidden="true" tabindex="-1"></a>    admin_aggregationLevel <span class="op">===</span> <span class="st">"admin2_name"</span> <span class="op">&amp;&amp;</span></span>
<span id="cb16-316"><a href="#cb16-316" aria-hidden="true" tabindex="-1"></a>    admin2_sel <span class="op">!==</span> <span class="st">"Full Region"</span></span>
<span id="cb16-317"><a href="#cb16-317" aria-hidden="true" tabindex="-1"></a>  ) {</span>
<span id="cb16-318"><a href="#cb16-318" aria-hidden="true" tabindex="-1"></a>    highlightText <span class="op">=</span> <span class="fu">_lang</span>({</span>
<span id="cb16-319"><a href="#cb16-319" aria-hidden="true" tabindex="-1"></a>      <span class="dt">en</span><span class="op">:</span> <span class="vs">`</span><span class="sc">${</span>admin2_sel<span class="sc">}</span><span class="vs"> is highlighted`</span><span class="op">,</span></span>
<span id="cb16-320"><a href="#cb16-320" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fr</span><span class="op">:</span> <span class="vs">`</span><span class="sc">${</span>admin2_sel<span class="sc">}</span><span class="vs"> est mis en surbrillance`</span></span>
<span id="cb16-321"><a href="#cb16-321" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb16-322"><a href="#cb16-322" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-323"><a href="#cb16-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-324"><a href="#cb16-324" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="fu">html</span><span class="vs">`</span></span>
<span id="cb16-325"><a href="#cb16-325" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;p style="font-size:1.3rem; font-weight:600; margin:0 0 4px 0;"&gt;</span></span>
<span id="cb16-326"><a href="#cb16-326" aria-hidden="true" tabindex="-1"></a><span class="vs">      </span><span class="sc">${</span><span class="fu">_lang</span>({</span>
<span id="cb16-327"><a href="#cb16-327" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Selection overview:"</span><span class="op">,</span></span>
<span id="cb16-328"><a href="#cb16-328" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Aperçu de la sélection :"</span></span>
<span id="cb16-329"><a href="#cb16-329" aria-hidden="true" tabindex="-1"></a>      })<span class="sc">}</span></span>
<span id="cb16-330"><a href="#cb16-330" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;/p&gt;</span></span>
<span id="cb16-331"><a href="#cb16-331" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;p style="font-size:1.15rem; margin:0; padding-left:0.75rem;"&gt;</span></span>
<span id="cb16-332"><a href="#cb16-332" aria-hidden="true" tabindex="-1"></a><span class="vs">      &lt;strong&gt;</span></span>
<span id="cb16-333"><a href="#cb16-333" aria-hidden="true" tabindex="-1"></a><span class="vs">        </span><span class="sc">${</span>mainText<span class="sc">}</span><span class="vs"> </span><span class="sc">${</span>levelText<span class="sc">}</span><span class="vs">. &lt;br&gt;</span></span>
<span id="cb16-334"><a href="#cb16-334" aria-hidden="true" tabindex="-1"></a><span class="vs">        </span><span class="sc">${</span>highlightText <span class="op">?</span> <span class="vs">`</span><span class="sc">${</span>highlightText<span class="sc">}</span><span class="vs">.`</span> <span class="op">:</span> <span class="st">""</span><span class="sc">}</span></span>
<span id="cb16-335"><a href="#cb16-335" aria-hidden="true" tabindex="-1"></a><span class="vs">      &lt;/strong&gt;</span></span>
<span id="cb16-336"><a href="#cb16-336" aria-hidden="true" tabindex="-1"></a><span class="vs">    &lt;/p&gt;</span></span>
<span id="cb16-337"><a href="#cb16-337" aria-hidden="true" tabindex="-1"></a><span class="vs">  `</span></span>
<span id="cb16-338"><a href="#cb16-338" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-16" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb17" data-startfrom="342" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 341"><span id="cb17-342"><a href="#cb17-342" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`# </span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">ViewExplore</span><span class="op">.</span><span class="at">title</span>)<span class="sc">}</span></span>
<span id="cb17-343"><a href="#cb17-343" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">ViewExplore</span><span class="op">.</span><span class="at">text</span>)<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-17" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb18" data-startfrom="347" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 346"><span id="cb18-347"><a href="#cb18-347" aria-hidden="true" tabindex="-1"></a>viewof previewType <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">radio</span>([<span class="st">"Map"</span><span class="op">,</span> <span class="st">"Table"</span><span class="op">,</span> <span class="st">"Plot"</span>]<span class="op">,</span> {</span>
<span id="cb18-348"><a href="#cb18-348" aria-hidden="true" tabindex="-1"></a>  <span class="co">//, "Interactive Map",</span></span>
<span id="cb18-349"><a href="#cb18-349" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Icons to these would be pretty</span></span>
<span id="cb18-350"><a href="#cb18-350" aria-hidden="true" tabindex="-1"></a>  <span class="dt">value</span><span class="op">:</span> <span class="st">"Map"</span><span class="op">,</span></span>
<span id="cb18-351"><a href="#cb18-351" aria-hidden="true" tabindex="-1"></a>  <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">ViewExplore</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">preview</span><span class="op">.</span><span class="at">title</span>)<span class="op">,</span></span>
<span id="cb18-352"><a href="#cb18-352" aria-hidden="true" tabindex="-1"></a>  <span class="dt">format</span><span class="op">:</span> (l) <span class="kw">=&gt;</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">ViewExplore</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">preview</span><span class="op">.</span><span class="at">options</span>[l])</span>
<span id="cb18-353"><a href="#cb18-353" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-18" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb19" data-startfrom="357" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 356"><span id="cb19-357"><a href="#cb19-357" aria-hidden="true" tabindex="-1"></a>viewof data_to_visualise <span class="op">=</span> {</span>
<span id="cb19-358"><a href="#cb19-358" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (previewType <span class="op">===</span> <span class="st">"Map"</span>) {</span>
<span id="cb19-359"><a href="#cb19-359" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">generateMapForm</span>()</span>
<span id="cb19-360"><a href="#cb19-360" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (previewType <span class="op">===</span> <span class="st">"Table"</span>) {</span>
<span id="cb19-361"><a href="#cb19-361" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> Inputs<span class="op">.</span><span class="fu">search</span>(NbData[<span class="st">"explore_data"</span>]<span class="op">,</span> {<span class="dt">placeholder</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">search</span>)})<span class="op">;</span></span>
<span id="cb19-362"><a href="#cb19-362" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (previewType <span class="op">===</span> <span class="st">"Plot"</span>) {</span>
<span id="cb19-363"><a href="#cb19-363" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">generatePlotForm</span>()</span>
<span id="cb19-364"><a href="#cb19-364" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb19-365"><a href="#cb19-365" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-366"><a href="#cb19-366" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">generateMapForm</span>() {</span>
<span id="cb19-367"><a href="#cb19-367" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> form_elements <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb19-368"><a href="#cb19-368" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (atlas_cat <span class="op">===</span> <span class="st">"Hazard"</span>) {</span>
<span id="cb19-369"><a href="#cb19-369" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> hazardOptions <span class="op">=</span> DataSelector_form<span class="op">.</span><span class="at">hazardGroup_form</span><span class="op">.</span><span class="at">hazard_sel</span><span class="op">;</span></span>
<span id="cb19-370"><a href="#cb19-370" aria-hidden="true" tabindex="-1"></a>      form_elements<span class="op">.</span><span class="fu">push</span>(</span>
<span id="cb19-371"><a href="#cb19-371" aria-hidden="true" tabindex="-1"></a>        Inputs<span class="op">.</span><span class="fu">bind</span>(</span>
<span id="cb19-372"><a href="#cb19-372" aria-hidden="true" tabindex="-1"></a>          Inputs<span class="op">.</span><span class="fu">select</span>(</span>
<span id="cb19-373"><a href="#cb19-373" aria-hidden="true" tabindex="-1"></a>            hazardOptions<span class="op">.</span><span class="fu">map</span>((value) <span class="kw">=&gt;</span> value)<span class="op">,</span></span>
<span id="cb19-374"><a href="#cb19-374" aria-hidden="true" tabindex="-1"></a>            <span class="co">// new Map(</span></span>
<span id="cb19-375"><a href="#cb19-375" aria-hidden="true" tabindex="-1"></a>            <span class="co">//   hazardOptions.map((value) =&gt; [_lang(nbText.selectVars.forms.Hazard.selectors.hazard.options[value]), value])</span></span>
<span id="cb19-376"><a href="#cb19-376" aria-hidden="true" tabindex="-1"></a>            <span class="co">// ),</span></span>
<span id="cb19-377"><a href="#cb19-377" aria-hidden="true" tabindex="-1"></a>            { <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">selectVars</span><span class="op">.</span><span class="at">forms</span><span class="op">.</span><span class="at">Hazard</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">hazard</span><span class="op">.</span><span class="at">title</span>)<span class="op">,</span></span>
<span id="cb19-378"><a href="#cb19-378" aria-hidden="true" tabindex="-1"></a>              <span class="dt">format</span><span class="op">:</span> l <span class="kw">=&gt;</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">hazards</span>[l])</span>
<span id="cb19-379"><a href="#cb19-379" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb19-380"><a href="#cb19-380" aria-hidden="true" tabindex="-1"></a>          )<span class="op">,</span></span>
<span id="cb19-381"><a href="#cb19-381" aria-hidden="true" tabindex="-1"></a>          viewof hazard_sel</span>
<span id="cb19-382"><a href="#cb19-382" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb19-383"><a href="#cb19-383" aria-hidden="true" tabindex="-1"></a>      )<span class="op">;</span></span>
<span id="cb19-384"><a href="#cb19-384" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> timePeriodOptions <span class="op">=</span> DataSelector_form<span class="op">.</span><span class="at">hazardGroup_form</span><span class="op">.</span><span class="at">timeperiod_sel</span><span class="op">;</span></span>
<span id="cb19-385"><a href="#cb19-385" aria-hidden="true" tabindex="-1"></a>      form_elements<span class="op">.</span><span class="fu">push</span>(</span>
<span id="cb19-386"><a href="#cb19-386" aria-hidden="true" tabindex="-1"></a>        Inputs<span class="op">.</span><span class="fu">bind</span>(</span>
<span id="cb19-387"><a href="#cb19-387" aria-hidden="true" tabindex="-1"></a>          Inputs<span class="op">.</span><span class="fu">select</span>(</span>
<span id="cb19-388"><a href="#cb19-388" aria-hidden="true" tabindex="-1"></a>            timePeriodOptions<span class="op">.</span><span class="fu">map</span>((value) <span class="kw">=&gt;</span> value)<span class="op">,</span></span>
<span id="cb19-389"><a href="#cb19-389" aria-hidden="true" tabindex="-1"></a>            <span class="co">// new Map(</span></span>
<span id="cb19-390"><a href="#cb19-390" aria-hidden="true" tabindex="-1"></a>            <span class="co">//   timePeriodOptions.map((value) =&gt; [timePeriod_dict[value], value])</span></span>
<span id="cb19-391"><a href="#cb19-391" aria-hidden="true" tabindex="-1"></a>            <span class="co">// ),</span></span>
<span id="cb19-392"><a href="#cb19-392" aria-hidden="true" tabindex="-1"></a>            { <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">selectVars</span><span class="op">.</span><span class="at">forms</span><span class="op">.</span><span class="at">Hazard</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">period</span><span class="op">.</span><span class="at">title</span>)<span class="op">,</span></span>
<span id="cb19-393"><a href="#cb19-393" aria-hidden="true" tabindex="-1"></a>              <span class="dt">format</span><span class="op">:</span> l <span class="kw">=&gt;</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">selectVars</span><span class="op">.</span><span class="at">forms</span><span class="op">.</span><span class="at">Hazard</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">period</span><span class="op">.</span><span class="at">options</span>[l]) <span class="op">||</span> l</span>
<span id="cb19-394"><a href="#cb19-394" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb19-395"><a href="#cb19-395" aria-hidden="true" tabindex="-1"></a>          )<span class="op">,</span></span>
<span id="cb19-396"><a href="#cb19-396" aria-hidden="true" tabindex="-1"></a>          viewof time_sel</span>
<span id="cb19-397"><a href="#cb19-397" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb19-398"><a href="#cb19-398" aria-hidden="true" tabindex="-1"></a>      )<span class="op">;</span></span>
<span id="cb19-399"><a href="#cb19-399" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (time_sel <span class="op">!==</span> <span class="st">"historic"</span>) {</span>
<span id="cb19-400"><a href="#cb19-400" aria-hidden="true" tabindex="-1"></a>        form_elements<span class="op">.</span><span class="fu">push</span>(</span>
<span id="cb19-401"><a href="#cb19-401" aria-hidden="true" tabindex="-1"></a>          Inputs<span class="op">.</span><span class="fu">bind</span>(</span>
<span id="cb19-402"><a href="#cb19-402" aria-hidden="true" tabindex="-1"></a>            Inputs<span class="op">.</span><span class="fu">select</span>([<span class="st">"SSP245"</span><span class="op">,</span> <span class="st">"SSP585"</span>]<span class="op">,</span> { <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">ViewExplore</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">visualiseVars</span><span class="op">.</span><span class="at">hazards</span><span class="op">.</span><span class="at">scenario</span><span class="op">.</span><span class="at">title</span>)})<span class="op">,</span></span>
<span id="cb19-403"><a href="#cb19-403" aria-hidden="true" tabindex="-1"></a>            viewof ssp_sel</span>
<span id="cb19-404"><a href="#cb19-404" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb19-405"><a href="#cb19-405" aria-hidden="true" tabindex="-1"></a>        )<span class="op">;</span></span>
<span id="cb19-406"><a href="#cb19-406" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb19-407"><a href="#cb19-407" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb19-408"><a href="#cb19-408" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-409"><a href="#cb19-409" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (atlas_cat <span class="op">===</span> <span class="st">"Vulnerability"</span>) {</span>
<span id="cb19-410"><a href="#cb19-410" aria-hidden="true" tabindex="-1"></a>      form_elements<span class="op">.</span><span class="fu">push</span>(</span>
<span id="cb19-411"><a href="#cb19-411" aria-hidden="true" tabindex="-1"></a>        Inputs<span class="op">.</span><span class="fu">bind</span>(</span>
<span id="cb19-412"><a href="#cb19-412" aria-hidden="true" tabindex="-1"></a>          Inputs<span class="op">.</span><span class="fu">select</span>(</span>
<span id="cb19-413"><a href="#cb19-413" aria-hidden="true" tabindex="-1"></a>            DataSelector_form<span class="op">.</span><span class="at">vulnerabilityGroup_form</span><span class="op">.</span><span class="at">vulnerability_sel</span><span class="op">,</span></span>
<span id="cb19-414"><a href="#cb19-414" aria-hidden="true" tabindex="-1"></a>            {</span>
<span id="cb19-415"><a href="#cb19-415" aria-hidden="true" tabindex="-1"></a>              <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">selectCategory</span><span class="op">.</span><span class="at">selector</span><span class="op">.</span><span class="at">options</span><span class="op">.</span><span class="at">Vulnerability</span><span class="op">.</span><span class="at">title</span>)<span class="op">,</span></span>
<span id="cb19-416"><a href="#cb19-416" aria-hidden="true" tabindex="-1"></a>              <span class="dt">format</span><span class="op">:</span> l <span class="kw">=&gt;</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">selectVars</span><span class="op">.</span><span class="at">forms</span><span class="op">.</span><span class="at">Vulnerability</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">variable</span><span class="op">.</span><span class="at">options</span>[l])<span class="op">||</span>l</span>
<span id="cb19-417"><a href="#cb19-417" aria-hidden="true" tabindex="-1"></a>              <span class="co">// label: "Adaptive Capacity"</span></span>
<span id="cb19-418"><a href="#cb19-418" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb19-419"><a href="#cb19-419" aria-hidden="true" tabindex="-1"></a>          )<span class="op">,</span></span>
<span id="cb19-420"><a href="#cb19-420" aria-hidden="true" tabindex="-1"></a>          viewof ac_cat</span>
<span id="cb19-421"><a href="#cb19-421" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb19-422"><a href="#cb19-422" aria-hidden="true" tabindex="-1"></a>      )<span class="op">;</span></span>
<span id="cb19-423"><a href="#cb19-423" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (ac_cat <span class="op">===</span> <span class="st">"Gender"</span>) {</span>
<span id="cb19-424"><a href="#cb19-424" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> ac_subcats <span class="op">=</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">keys</span>(vulnerability_dict[<span class="st">"gender"</span>])</span>
<span id="cb19-425"><a href="#cb19-425" aria-hidden="true" tabindex="-1"></a>        form_elements<span class="op">.</span><span class="fu">push</span>(</span>
<span id="cb19-426"><a href="#cb19-426" aria-hidden="true" tabindex="-1"></a>          Inputs<span class="op">.</span><span class="fu">bind</span>(</span>
<span id="cb19-427"><a href="#cb19-427" aria-hidden="true" tabindex="-1"></a>            Inputs<span class="op">.</span><span class="fu">select</span>(ac_subcats<span class="op">,</span> {</span>
<span id="cb19-428"><a href="#cb19-428" aria-hidden="true" tabindex="-1"></a>              <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">ViewExplore</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">visualiseVars</span><span class="op">.</span><span class="at">vulnerability</span><span class="op">.</span><span class="at">gender</span><span class="op">.</span><span class="at">title</span>)<span class="op">,</span></span>
<span id="cb19-429"><a href="#cb19-429" aria-hidden="true" tabindex="-1"></a>              <span class="dt">format</span><span class="op">:</span> l <span class="kw">=&gt;</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">ViewExplore</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">visualiseVars</span><span class="op">.</span><span class="at">vulnerability</span><span class="op">.</span><span class="at">gender</span><span class="op">.</span><span class="at">options</span>[l])</span>
<span id="cb19-430"><a href="#cb19-430" aria-hidden="true" tabindex="-1"></a>            })<span class="op">,</span></span>
<span id="cb19-431"><a href="#cb19-431" aria-hidden="true" tabindex="-1"></a>            viewof ac_subcat</span>
<span id="cb19-432"><a href="#cb19-432" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb19-433"><a href="#cb19-433" aria-hidden="true" tabindex="-1"></a>        )<span class="op">;</span></span>
<span id="cb19-434"><a href="#cb19-434" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span> (ac_cat <span class="op">===</span> <span class="st">"Poverty"</span>) {</span>
<span id="cb19-435"><a href="#cb19-435" aria-hidden="true" tabindex="-1"></a>        <span class="co">// let ac_subcats = new Map(</span></span>
<span id="cb19-436"><a href="#cb19-436" aria-hidden="true" tabindex="-1"></a>        <span class="co">//   Object.entries(vulnerability_dict["poverty"]).map(([key, value]) =&gt; [</span></span>
<span id="cb19-437"><a href="#cb19-437" aria-hidden="true" tabindex="-1"></a>        <span class="co">//     value,</span></span>
<span id="cb19-438"><a href="#cb19-438" aria-hidden="true" tabindex="-1"></a>        <span class="co">//     key</span></span>
<span id="cb19-439"><a href="#cb19-439" aria-hidden="true" tabindex="-1"></a>        <span class="co">//   ])</span></span>
<span id="cb19-440"><a href="#cb19-440" aria-hidden="true" tabindex="-1"></a>        <span class="co">// );</span></span>
<span id="cb19-441"><a href="#cb19-441" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> ac_subcats <span class="op">=</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">keys</span>(vulnerability_dict[<span class="st">"poverty"</span>])</span>
<span id="cb19-442"><a href="#cb19-442" aria-hidden="true" tabindex="-1"></a>        form_elements<span class="op">.</span><span class="fu">push</span>(</span>
<span id="cb19-443"><a href="#cb19-443" aria-hidden="true" tabindex="-1"></a>          Inputs<span class="op">.</span><span class="fu">bind</span>(</span>
<span id="cb19-444"><a href="#cb19-444" aria-hidden="true" tabindex="-1"></a>            Inputs<span class="op">.</span><span class="fu">select</span>(ac_subcats<span class="op">,</span> {</span>
<span id="cb19-445"><a href="#cb19-445" aria-hidden="true" tabindex="-1"></a>              <span class="dt">label</span><span class="op">:</span>  <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">ViewExplore</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">visualiseVars</span><span class="op">.</span><span class="at">vulnerability</span><span class="op">.</span><span class="at">poverty</span><span class="op">.</span><span class="at">title</span>)<span class="op">,</span></span>
<span id="cb19-446"><a href="#cb19-446" aria-hidden="true" tabindex="-1"></a>              <span class="dt">format</span><span class="op">:</span> l <span class="kw">=&gt;</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">ViewExplore</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">visualiseVars</span><span class="op">.</span><span class="at">vulnerability</span><span class="op">.</span><span class="at">poverty</span><span class="op">.</span><span class="at">options</span>[l])</span>
<span id="cb19-447"><a href="#cb19-447" aria-hidden="true" tabindex="-1"></a>            })<span class="op">,</span></span>
<span id="cb19-448"><a href="#cb19-448" aria-hidden="true" tabindex="-1"></a>            viewof ac_subcat</span>
<span id="cb19-449"><a href="#cb19-449" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb19-450"><a href="#cb19-450" aria-hidden="true" tabindex="-1"></a>        )<span class="op">;</span></span>
<span id="cb19-451"><a href="#cb19-451" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb19-452"><a href="#cb19-452" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb19-453"><a href="#cb19-453" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (atlas_cat <span class="op">===</span> <span class="st">"Exposure"</span>) {</span>
<span id="cb19-454"><a href="#cb19-454" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> subTitle<span class="op">;</span></span>
<span id="cb19-455"><a href="#cb19-455" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> subSelections<span class="op">;</span></span>
<span id="cb19-456"><a href="#cb19-456" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (exposure_cat <span class="op">===</span> <span class="st">"Population"</span>) {</span>
<span id="cb19-457"><a href="#cb19-457" aria-hidden="true" tabindex="-1"></a>        subTitle <span class="op">=</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">ViewExplore</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">visualiseVars</span><span class="op">.</span><span class="at">exposure</span><span class="op">.</span><span class="at">population</span><span class="op">.</span><span class="at">title</span>)<span class="op">;</span></span>
<span id="cb19-458"><a href="#cb19-458" aria-hidden="true" tabindex="-1"></a>        subSelections <span class="op">=</span> [<span class="st">"total_pop"</span><span class="op">,</span> <span class="st">"rural_pop"</span><span class="op">,</span> <span class="st">"urban_pop"</span>]</span>
<span id="cb19-459"><a href="#cb19-459" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb19-460"><a href="#cb19-460" aria-hidden="true" tabindex="-1"></a>        subTitle <span class="op">=</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">ViewExplore</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">visualiseVars</span><span class="op">.</span><span class="at">exposure</span><span class="op">.</span><span class="at">commodity</span><span class="op">.</span><span class="at">title</span>)<span class="op">;</span></span>
<span id="cb19-461"><a href="#cb19-461" aria-hidden="true" tabindex="-1"></a>        subSelections <span class="op">=</span> commodities[exposure_cat]<span class="op">;</span></span>
<span id="cb19-462"><a href="#cb19-462" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb19-463"><a href="#cb19-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-464"><a href="#cb19-464" aria-hidden="true" tabindex="-1"></a>      form_elements<span class="op">.</span><span class="fu">push</span>(</span>
<span id="cb19-465"><a href="#cb19-465" aria-hidden="true" tabindex="-1"></a>        Inputs<span class="op">.</span><span class="fu">bind</span>(</span>
<span id="cb19-466"><a href="#cb19-466" aria-hidden="true" tabindex="-1"></a>          Inputs<span class="op">.</span><span class="fu">select</span>(</span>
<span id="cb19-467"><a href="#cb19-467" aria-hidden="true" tabindex="-1"></a>            DataSelector_form<span class="op">.</span><span class="at">exposureGroup_form</span><span class="op">.</span><span class="at">exposureGroup_sel</span><span class="op">,</span></span>
<span id="cb19-468"><a href="#cb19-468" aria-hidden="true" tabindex="-1"></a>            {</span>
<span id="cb19-469"><a href="#cb19-469" aria-hidden="true" tabindex="-1"></a>              <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">ViewExplore</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">visualiseVars</span><span class="op">.</span><span class="at">exposure</span><span class="op">.</span><span class="at">title</span>)<span class="op">,</span></span>
<span id="cb19-470"><a href="#cb19-470" aria-hidden="true" tabindex="-1"></a>              <span class="dt">format</span><span class="op">:</span> l <span class="kw">=&gt;</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">selectVars</span><span class="op">.</span><span class="at">forms</span><span class="op">.</span><span class="at">Exposure</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">variable</span><span class="op">.</span><span class="at">options</span>[l])</span>
<span id="cb19-471"><a href="#cb19-471" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb19-472"><a href="#cb19-472" aria-hidden="true" tabindex="-1"></a>          )<span class="op">,</span></span>
<span id="cb19-473"><a href="#cb19-473" aria-hidden="true" tabindex="-1"></a>          viewof exposure_cat</span>
<span id="cb19-474"><a href="#cb19-474" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb19-475"><a href="#cb19-475" aria-hidden="true" tabindex="-1"></a>      )<span class="op">;</span></span>
<span id="cb19-476"><a href="#cb19-476" aria-hidden="true" tabindex="-1"></a>      form_elements<span class="op">.</span><span class="fu">push</span>(</span>
<span id="cb19-477"><a href="#cb19-477" aria-hidden="true" tabindex="-1"></a>        Inputs<span class="op">.</span><span class="fu">bind</span>(</span>
<span id="cb19-478"><a href="#cb19-478" aria-hidden="true" tabindex="-1"></a>          Inputs<span class="op">.</span><span class="fu">select</span>(subSelections<span class="op">,</span> {</span>
<span id="cb19-479"><a href="#cb19-479" aria-hidden="true" tabindex="-1"></a>            <span class="dt">label</span><span class="op">:</span> subTitle<span class="op">,</span></span>
<span id="cb19-480"><a href="#cb19-480" aria-hidden="true" tabindex="-1"></a>            <span class="dt">format</span><span class="op">:</span> l <span class="kw">=&gt;</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">ViewExplore</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">visualiseVars</span><span class="op">.</span><span class="at">exposure</span><span class="op">.</span><span class="at">population</span><span class="op">.</span><span class="at">options</span>[l] <span class="op">||</span> nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">commodities</span>[l])</span>
<span id="cb19-481"><a href="#cb19-481" aria-hidden="true" tabindex="-1"></a>          })<span class="op">,</span></span>
<span id="cb19-482"><a href="#cb19-482" aria-hidden="true" tabindex="-1"></a>          viewof exposure_subCat</span>
<span id="cb19-483"><a href="#cb19-483" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb19-484"><a href="#cb19-484" aria-hidden="true" tabindex="-1"></a>      )<span class="op">;</span></span>
<span id="cb19-485"><a href="#cb19-485" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (exposure_cat <span class="op">!==</span> <span class="st">"Population"</span>) {</span>
<span id="cb19-486"><a href="#cb19-486" aria-hidden="true" tabindex="-1"></a>        form_elements<span class="op">.</span><span class="fu">push</span>(</span>
<span id="cb19-487"><a href="#cb19-487" aria-hidden="true" tabindex="-1"></a>                    Inputs<span class="op">.</span><span class="fu">bind</span>(</span>
<span id="cb19-488"><a href="#cb19-488" aria-hidden="true" tabindex="-1"></a>              Inputs<span class="op">.</span><span class="fu">select</span>(exposure_var_choices<span class="op">,</span> {</span>
<span id="cb19-489"><a href="#cb19-489" aria-hidden="true" tabindex="-1"></a>                <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">ViewExplore</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">visualiseVars</span><span class="op">.</span><span class="at">exposure</span><span class="op">.</span><span class="at">exposureVariable</span><span class="op">.</span><span class="at">title</span>)<span class="op">,</span></span>
<span id="cb19-490"><a href="#cb19-490" aria-hidden="true" tabindex="-1"></a>                <span class="dt">format</span><span class="op">:</span> (t) <span class="kw">=&gt;</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">ViewExplore</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">visualiseVars</span><span class="op">.</span><span class="at">exposure</span><span class="op">.</span><span class="at">exposureVariable</span><span class="op">.</span><span class="at">options</span>[t])</span>
<span id="cb19-491"><a href="#cb19-491" aria-hidden="true" tabindex="-1"></a>              })<span class="op">,</span></span>
<span id="cb19-492"><a href="#cb19-492" aria-hidden="true" tabindex="-1"></a>              viewof exposure_var</span>
<span id="cb19-493"><a href="#cb19-493" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb19-494"><a href="#cb19-494" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb19-495"><a href="#cb19-495" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb19-496"><a href="#cb19-496" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb19-497"><a href="#cb19-497" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> Inputs<span class="op">.</span><span class="fu">form</span>(form_elements<span class="op">,</span> {</span>
<span id="cb19-498"><a href="#cb19-498" aria-hidden="true" tabindex="-1"></a>      <span class="dt">template</span><span class="op">:</span> (inputs) <span class="kw">=&gt;</span></span>
<span id="cb19-499"><a href="#cb19-499" aria-hidden="true" tabindex="-1"></a>        htl<span class="op">.</span><span class="fu">html</span><span class="vs">`&lt;h3&gt;</span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">ViewExplore</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">visualiseVars</span><span class="op">.</span><span class="at">titleMap</span>)<span class="sc">}</span><span class="vs">&lt;/h3&gt; &lt;div style="display: flex; gap: 3em"&gt;</span><span class="sc">${</span>inputs<span class="sc">}</span><span class="vs">&lt;/div&gt;`</span></span>
<span id="cb19-500"><a href="#cb19-500" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb19-501"><a href="#cb19-501" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb19-502"><a href="#cb19-502" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-503"><a href="#cb19-503" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">generatePlotForm</span>() {</span>
<span id="cb19-504"><a href="#cb19-504" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> form_elements <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb19-505"><a href="#cb19-505" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> title <span class="op">=</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">ViewExplore</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">visualiseVars</span><span class="op">.</span><span class="at">titlePlot</span>)<span class="op">;</span></span>
<span id="cb19-506"><a href="#cb19-506" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (atlas_cat <span class="op">===</span> <span class="st">"Exposure"</span>) {</span>
<span id="cb19-507"><a href="#cb19-507" aria-hidden="true" tabindex="-1"></a>      form_elements<span class="op">.</span><span class="fu">push</span>(</span>
<span id="cb19-508"><a href="#cb19-508" aria-hidden="true" tabindex="-1"></a>        Inputs<span class="op">.</span><span class="fu">bind</span>(</span>
<span id="cb19-509"><a href="#cb19-509" aria-hidden="true" tabindex="-1"></a>          Inputs<span class="op">.</span><span class="fu">select</span>(</span>
<span id="cb19-510"><a href="#cb19-510" aria-hidden="true" tabindex="-1"></a>            DataSelector_form<span class="op">.</span><span class="at">exposureGroup_form</span><span class="op">.</span><span class="at">exposureGroup_sel</span><span class="op">,</span></span>
<span id="cb19-511"><a href="#cb19-511" aria-hidden="true" tabindex="-1"></a>            {</span>
<span id="cb19-512"><a href="#cb19-512" aria-hidden="true" tabindex="-1"></a>              <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">ViewExplore</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">visualiseVars</span><span class="op">.</span><span class="at">exposure</span><span class="op">.</span><span class="at">title</span>)<span class="op">,</span></span>
<span id="cb19-513"><a href="#cb19-513" aria-hidden="true" tabindex="-1"></a>              <span class="dt">format</span><span class="op">:</span> l <span class="kw">=&gt;</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">selectVars</span><span class="op">.</span><span class="at">forms</span><span class="op">.</span><span class="at">Exposure</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">variable</span><span class="op">.</span><span class="at">options</span>[l])</span>
<span id="cb19-514"><a href="#cb19-514" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb19-515"><a href="#cb19-515" aria-hidden="true" tabindex="-1"></a>          )<span class="op">,</span></span>
<span id="cb19-516"><a href="#cb19-516" aria-hidden="true" tabindex="-1"></a>          viewof exposure_cat</span>
<span id="cb19-517"><a href="#cb19-517" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb19-518"><a href="#cb19-518" aria-hidden="true" tabindex="-1"></a>      )<span class="op">;</span></span>
<span id="cb19-519"><a href="#cb19-519" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (exposure_cat<span class="op">.</span><span class="fu">includes</span>(<span class="st">"Crop"</span>) <span class="op">||</span> exposure_cat<span class="op">.</span><span class="fu">includes</span>(<span class="st">"Livestock"</span>)) {</span>
<span id="cb19-520"><a href="#cb19-520" aria-hidden="true" tabindex="-1"></a>        form_elements<span class="op">.</span><span class="fu">push</span>(</span>
<span id="cb19-521"><a href="#cb19-521" aria-hidden="true" tabindex="-1"></a>          Inputs<span class="op">.</span><span class="fu">bind</span>(</span>
<span id="cb19-522"><a href="#cb19-522" aria-hidden="true" tabindex="-1"></a>            Inputs<span class="op">.</span><span class="fu">select</span>(exposure_var_choices<span class="op">,</span> {</span>
<span id="cb19-523"><a href="#cb19-523" aria-hidden="true" tabindex="-1"></a>              <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">ViewExplore</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">visualiseVars</span><span class="op">.</span><span class="at">exposure</span><span class="op">.</span><span class="at">exposureVariable</span><span class="op">.</span><span class="at">title</span>)<span class="op">,</span></span>
<span id="cb19-524"><a href="#cb19-524" aria-hidden="true" tabindex="-1"></a>              <span class="dt">format</span><span class="op">:</span> (t) <span class="kw">=&gt;</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">ViewExplore</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">visualiseVars</span><span class="op">.</span><span class="at">exposure</span><span class="op">.</span><span class="at">exposureVariable</span><span class="op">.</span><span class="at">options</span>[t])</span>
<span id="cb19-525"><a href="#cb19-525" aria-hidden="true" tabindex="-1"></a>            })<span class="op">,</span></span>
<span id="cb19-526"><a href="#cb19-526" aria-hidden="true" tabindex="-1"></a>            viewof exposure_var</span>
<span id="cb19-527"><a href="#cb19-527" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb19-528"><a href="#cb19-528" aria-hidden="true" tabindex="-1"></a>        )<span class="op">;</span></span>
<span id="cb19-529"><a href="#cb19-529" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb19-530"><a href="#cb19-530" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb19-531"><a href="#cb19-531" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (atlas_cat <span class="op">===</span> <span class="st">"Hazard"</span>) {</span>
<span id="cb19-532"><a href="#cb19-532" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> hazardOptions <span class="op">=</span> DataSelector_form<span class="op">.</span><span class="at">hazardGroup_form</span><span class="op">.</span><span class="at">hazard_sel</span><span class="op">;</span></span>
<span id="cb19-533"><a href="#cb19-533" aria-hidden="true" tabindex="-1"></a>      form_elements<span class="op">.</span><span class="fu">push</span>(</span>
<span id="cb19-534"><a href="#cb19-534" aria-hidden="true" tabindex="-1"></a>        Inputs<span class="op">.</span><span class="fu">bind</span>(</span>
<span id="cb19-535"><a href="#cb19-535" aria-hidden="true" tabindex="-1"></a>          Inputs<span class="op">.</span><span class="fu">select</span>(</span>
<span id="cb19-536"><a href="#cb19-536" aria-hidden="true" tabindex="-1"></a>            hazardOptions<span class="op">.</span><span class="fu">map</span>((value) <span class="kw">=&gt;</span> value)<span class="op">,</span></span>
<span id="cb19-537"><a href="#cb19-537" aria-hidden="true" tabindex="-1"></a>            { <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">selectVars</span><span class="op">.</span><span class="at">forms</span><span class="op">.</span><span class="at">Hazard</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">hazard</span><span class="op">.</span><span class="at">title</span>)<span class="op">,</span></span>
<span id="cb19-538"><a href="#cb19-538" aria-hidden="true" tabindex="-1"></a>              <span class="dt">format</span><span class="op">:</span> l <span class="kw">=&gt;</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">hazards</span>[l])</span>
<span id="cb19-539"><a href="#cb19-539" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb19-540"><a href="#cb19-540" aria-hidden="true" tabindex="-1"></a>          )<span class="op">,</span></span>
<span id="cb19-541"><a href="#cb19-541" aria-hidden="true" tabindex="-1"></a>          viewof hazard_sel</span>
<span id="cb19-542"><a href="#cb19-542" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb19-543"><a href="#cb19-543" aria-hidden="true" tabindex="-1"></a>      )<span class="op">;</span></span>
<span id="cb19-544"><a href="#cb19-544" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb19-545"><a href="#cb19-545" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (atlas_cat <span class="op">===</span> <span class="st">"Vulnerability"</span>) {</span>
<span id="cb19-546"><a href="#cb19-546" aria-hidden="true" tabindex="-1"></a>      title <span class="op">=</span> <span class="st">""</span><span class="op">;</span></span>
<span id="cb19-547"><a href="#cb19-547" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb19-548"><a href="#cb19-548" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> Inputs<span class="op">.</span><span class="fu">form</span>(form_elements<span class="op">,</span> {</span>
<span id="cb19-549"><a href="#cb19-549" aria-hidden="true" tabindex="-1"></a>      <span class="dt">template</span><span class="op">:</span> (inputs) <span class="kw">=&gt;</span></span>
<span id="cb19-550"><a href="#cb19-550" aria-hidden="true" tabindex="-1"></a>        htl<span class="op">.</span><span class="fu">html</span><span class="vs">`&lt;h3&gt;</span><span class="sc">${</span>title<span class="sc">}</span><span class="vs">&lt;/h3&gt; &lt;div style="display: flex; gap: 3em"&gt;</span><span class="sc">${</span>inputs<span class="sc">}</span><span class="vs">&lt;/div&gt;`</span></span>
<span id="cb19-551"><a href="#cb19-551" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb19-552"><a href="#cb19-552" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb19-553"><a href="#cb19-553" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-19" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb20" data-startfrom="557" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 556"><span id="cb20-557"><a href="#cb20-557" aria-hidden="true" tabindex="-1"></a>data_preview <span class="op">=</span> {</span>
<span id="cb20-558"><a href="#cb20-558" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (previewType <span class="op">===</span> <span class="st">"Map"</span>) {</span>
<span id="cb20-559"><a href="#cb20-559" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">html</span><span class="vs">`&lt;div&gt;</span><span class="sc">${</span><span class="fu">map</span>()<span class="sc">}</span><span class="vs">&lt;/div&gt;`</span><span class="op">;</span></span>
<span id="cb20-560"><a href="#cb20-560" aria-hidden="true" tabindex="-1"></a>    <span class="co">// } else if (previewType === "Interactive Map") {</span></span>
<span id="cb20-561"><a href="#cb20-561" aria-hidden="true" tabindex="-1"></a>    <span class="co">//   return html`&lt;div&gt;${MapInfo.MapLegend}&lt;/div&gt; &lt;div&gt;${MapContainer}&lt;/div&gt;`;</span></span>
<span id="cb20-562"><a href="#cb20-562" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (previewType <span class="op">===</span> <span class="st">"Table"</span>) {</span>
<span id="cb20-563"><a href="#cb20-563" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">html</span><span class="vs">`&lt;div&gt;</span><span class="sc">${</span><span class="fu">createTable</span>()<span class="sc">}</span><span class="vs">&lt;/div&gt;`</span><span class="op">;</span></span>
<span id="cb20-564"><a href="#cb20-564" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (previewType <span class="op">===</span> <span class="st">"Plot"</span>) {</span>
<span id="cb20-565"><a href="#cb20-565" aria-hidden="true" tabindex="-1"></a>    <span class="co">// return html`&lt;div&gt;${container2}&lt;/div&gt;`;</span></span>
<span id="cb20-566"><a href="#cb20-566" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">html</span><span class="vs">`&lt;div&gt;</span><span class="sc">${</span><span class="cf">await</span> <span class="fu">createPlot</span>()<span class="sc">}</span><span class="vs">&lt;/div&gt;`</span><span class="op">;</span></span>
<span id="cb20-567"><a href="#cb20-567" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb20-568"><a href="#cb20-568" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-20" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb21" data-startfrom="572" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 571"><span id="cb21-572"><a href="#cb21-572" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`# </span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">download</span><span class="op">.</span><span class="at">title</span>)<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-21" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb22" data-startfrom="576" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 575"><span id="cb22-576"><a href="#cb22-576" aria-hidden="true" tabindex="-1"></a>viewof download_format <span class="op">=</span> {</span>
<span id="cb22-577"><a href="#cb22-577" aria-hidden="true" tabindex="-1"></a>  <span class="co">// let downlaod_options;</span></span>
<span id="cb22-578"><a href="#cb22-578" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> download_options <span class="op">=</span> [<span class="st">"Parquet"</span><span class="op">,</span> <span class="st">"CSV"</span><span class="op">,</span> <span class="st">"JSON"</span>]<span class="op">;</span> <span class="co">//, "GEOPARQUET", "GEOJSON"];</span></span>
<span id="cb22-579"><a href="#cb22-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-580"><a href="#cb22-580" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> Inputs<span class="op">.</span><span class="fu">radio</span>(download_options<span class="op">,</span> {</span>
<span id="cb22-581"><a href="#cb22-581" aria-hidden="true" tabindex="-1"></a>    <span class="dt">label</span><span class="op">:</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">download</span><span class="op">.</span><span class="at">selector</span><span class="op">.</span><span class="at">title</span>)<span class="op">,</span></span>
<span id="cb22-582"><a href="#cb22-582" aria-hidden="true" tabindex="-1"></a>    <span class="dt">value</span><span class="op">:</span> <span class="st">"Parquet"</span></span>
<span id="cb22-583"><a href="#cb22-583" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb22-584"><a href="#cb22-584" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-22" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb23" data-startfrom="588" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 587"><span id="cb23-588"><a href="#cb23-588" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`&lt;div &gt;</span><span class="sc">${</span><span class="fu">download_button_initiate</span>()<span class="sc">}</span><span class="vs">&lt;/div&gt;`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-23" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb24" data-startfrom="592" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 591"><span id="cb24-592"><a href="#cb24-592" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`### </span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">download</span><span class="op">.</span><span class="at">boundaries</span><span class="op">.</span><span class="at">title</span>)<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-24" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb25" data-startfrom="596" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 595"><span id="cb25-596"><a href="#cb25-596" aria-hidden="true" tabindex="-1"></a><span class="fu">download_spatial_button</span>()<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-25" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb26" data-startfrom="600" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 599"><span id="cb26-600"><a href="#cb26-600" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`# </span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">STAC</span><span class="op">.</span><span class="at">title</span>)<span class="sc">}</span></span>
<span id="cb26-601"><a href="#cb26-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-602"><a href="#cb26-602" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">STAC</span><span class="op">.</span><span class="at">text</span>)<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-26" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb27" data-startfrom="606" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 605"><span id="cb27-606"><a href="#cb27-606" aria-hidden="true" tabindex="-1"></a>viewof codeLanguage <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">radio</span>([<span class="st">"R"</span><span class="op">,</span> <span class="st">"Python"</span><span class="op">,</span> <span class="st">"NoCode"</span>]<span class="op">,</span> {</span>
<span id="cb27-607"><a href="#cb27-607" aria-hidden="true" tabindex="-1"></a>  <span class="dt">label</span><span class="op">:</span> <span class="st">"Language"</span><span class="op">,</span></span>
<span id="cb27-608"><a href="#cb27-608" aria-hidden="true" tabindex="-1"></a>  <span class="dt">value</span><span class="op">:</span> <span class="st">"NoCode"</span><span class="op">,</span></span>
<span id="cb27-609"><a href="#cb27-609" aria-hidden="true" tabindex="-1"></a>  <span class="dt">format</span><span class="op">:</span> l <span class="kw">=&gt;</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span>[l]) <span class="op">||</span> l</span>
<span id="cb27-610"><a href="#cb27-610" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-27" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb28" data-startfrom="614" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 613"><span id="cb28-614"><a href="#cb28-614" aria-hidden="true" tabindex="-1"></a>codechunk <span class="op">=</span> {</span>
<span id="cb28-615"><a href="#cb28-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-616"><a href="#cb28-616" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (codeLanguage <span class="op">===</span> <span class="st">"NoCode"</span>) {</span>
<span id="cb28-617"><a href="#cb28-617" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">html</span><span class="vs">`&lt;iframe src ='https://radiantearth.github.io/stac-browser/#/external/digital-atlas.s3.amazonaws.com/stac/public_stac/catalog.json?.language=</span><span class="sc">${</span>language<span class="op">.</span><span class="at">key</span><span class="sc">}</span><span class="vs">' style="width:100%; height: 800px;"&gt;`</span></span>
<span id="cb28-618"><a href="#cb28-618" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb28-619"><a href="#cb28-619" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> code_text <span class="op">=</span> <span class="fu">generate_codeText</span>(codeLanguage)</span>
<span id="cb28-620"><a href="#cb28-620" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> markdown_code <span class="op">=</span> <span class="fu">md</span><span class="vs">`</span></span>
<span id="cb28-621"><a href="#cb28-621" aria-hidden="true" tabindex="-1"></a><span class="sc">\`\`\`</span><span class="vs"> </span><span class="sc">${</span>codeLanguage<span class="op">.</span><span class="fu">toLowerCase</span>()<span class="sc">}</span></span>
<span id="cb28-622"><a href="#cb28-622" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span>code_text<span class="sc">}</span></span>
<span id="cb28-623"><a href="#cb28-623" aria-hidden="true" tabindex="-1"></a><span class="sc">\`\`\`</span><span class="vs">`</span></span>
<span id="cb28-624"><a href="#cb28-624" aria-hidden="true" tabindex="-1"></a>     <span class="cf">return</span> <span class="fu">html</span><span class="vs">`&lt;div style='overflow: auto; max-height: 800px; background-color:#F8F8F8;padding-left: 10px'&gt;</span><span class="sc">${</span>markdown_code<span class="sc">}</span><span class="vs">&lt;/div&gt;`</span></span>
<span id="cb28-625"><a href="#cb28-625" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb28-626"><a href="#cb28-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-627"><a href="#cb28-627" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">generate_codeText</span>(codeLang) {</span>
<span id="cb28-628"><a href="#cb28-628" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> code_text</span>
<span id="cb28-629"><a href="#cb28-629" aria-hidden="true" tabindex="-1"></a>  <span class="cf">switch</span> (codeLang) {</span>
<span id="cb28-630"><a href="#cb28-630" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> <span class="st">"R"</span><span class="op">:</span></span>
<span id="cb28-631"><a href="#cb28-631" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> r_adminQuery <span class="op">=</span> country <span class="op">!==</span> <span class="st">'SSA'</span> <span class="op">?</span> <span class="vs">`admin_query &lt;- 'SELECT * from "atlas-region_admin0_harmonized" WHERE admin0_name = </span><span class="sc">\\</span><span class="vs">'</span><span class="sc">${</span>country<span class="sc">}\\</span><span class="vs">''`</span> <span class="op">:</span> <span class="vs">`admin_query &lt;- 'SELECT * from "atlas-region_admin0_harmonized"'`</span></span>
<span id="cb28-632"><a href="#cb28-632" aria-hidden="true" tabindex="-1"></a>    code_text <span class="op">=</span> <span class="vs">`library(terra)</span></span>
<span id="cb28-633"><a href="#cb28-633" aria-hidden="true" tabindex="-1"></a><span class="vs">library(rstac)</span></span>
<span id="cb28-634"><a href="#cb28-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-635"><a href="#cb28-635" aria-hidden="true" tabindex="-1"></a><span class="vs">admin_path &lt;- '/vsis3/digital-atlas/boundaries/atlas-region_admin0_harmonized.parquet' </span></span>
<span id="cb28-636"><a href="#cb28-636" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span>r_adminQuery<span class="sc">}</span></span>
<span id="cb28-637"><a href="#cb28-637" aria-hidden="true" tabindex="-1"></a><span class="vs">adminBounds &lt;- vect(admin_path, query = admin_query)</span></span>
<span id="cb28-638"><a href="#cb28-638" aria-hidden="true" tabindex="-1"></a><span class="vs">stac_path &lt;- "https:///digital-atlas.s3.amazonaws.com/stac/public_stac/catalog.json"</span></span>
<span id="cb28-639"><a href="#cb28-639" aria-hidden="true" tabindex="-1"></a><span class="vs">stac_catalog &lt;- read_stac(stac_path)</span></span>
<span id="cb28-640"><a href="#cb28-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-641"><a href="#cb28-641" aria-hidden="true" tabindex="-1"></a><span class="vs">children &lt;- links(stac_catalog, rel == 'child')</span></span>
<span id="cb28-642"><a href="#cb28-642" aria-hidden="true" tabindex="-1"></a><span class="vs">children_df &lt;- do.call("rbind", lapply(children, as.data.frame))</span></span>
<span id="cb28-643"><a href="#cb28-643" aria-hidden="true" tabindex="-1"></a><span class="vs">print(children_df$title)</span></span>
<span id="cb28-644"><a href="#cb28-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-645"><a href="#cb28-645" aria-hidden="true" tabindex="-1"></a><span class="vs">hazardCatalog &lt;- link_open(children[[grep("Hazard", children)]])</span></span>
<span id="cb28-646"><a href="#cb28-646" aria-hidden="true" tabindex="-1"></a><span class="vs">print(hazardCatalog$description)</span></span>
<span id="cb28-647"><a href="#cb28-647" aria-hidden="true" tabindex="-1"></a><span class="vs">haz_children &lt;- links(hazardCatalog, rel == 'child')</span></span>
<span id="cb28-648"><a href="#cb28-648" aria-hidden="true" tabindex="-1"></a><span class="vs">haz_children_df &lt;- do.call("rbind", lapply(haz_children, as.data.frame))</span></span>
<span id="cb28-649"><a href="#cb28-649" aria-hidden="true" tabindex="-1"></a><span class="vs">haz_children_df$description &lt;- sapply(haz_children, </span><span class="sc">\(</span><span class="vs">x) {</span></span>
<span id="cb28-650"><a href="#cb28-650" aria-hidden="true" tabindex="-1"></a><span class="vs">  child &lt;- link_open(x)</span></span>
<span id="cb28-651"><a href="#cb28-651" aria-hidden="true" tabindex="-1"></a><span class="vs">  child$description</span></span>
<span id="cb28-652"><a href="#cb28-652" aria-hidden="true" tabindex="-1"></a><span class="vs">})</span></span>
<span id="cb28-653"><a href="#cb28-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-654"><a href="#cb28-654" aria-hidden="true" tabindex="-1"></a><span class="vs">hazard_items &lt;- link_open(haz_children[[1]]) |&gt; </span></span>
<span id="cb28-655"><a href="#cb28-655" aria-hidden="true" tabindex="-1"></a><span class="vs">    rstac::read_items(limit = 10)</span></span>
<span id="cb28-656"><a href="#cb28-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-657"><a href="#cb28-657" aria-hidden="true" tabindex="-1"></a><span class="vs">hazard_items |&gt; </span></span>
<span id="cb28-658"><a href="#cb28-658" aria-hidden="true" tabindex="-1"></a><span class="vs">    rstac::items_as_tibble()</span></span>
<span id="cb28-659"><a href="#cb28-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-660"><a href="#cb28-660" aria-hidden="true" tabindex="-1"></a><span class="vs">possible_filters &lt;- items_properties(hazard_items)</span></span>
<span id="cb28-661"><a href="#cb28-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-662"><a href="#cb28-662" aria-hidden="true" tabindex="-1"></a><span class="vs">meanNDWS_tifs &lt;- hazard_items |&gt; </span></span>
<span id="cb28-663"><a href="#cb28-663" aria-hidden="true" tabindex="-1"></a><span class="vs">    rstac::items_filter(filter_fn = </span><span class="sc">\(</span><span class="vs">x) {</span></span>
<span id="cb28-664"><a href="#cb28-664" aria-hidden="true" tabindex="-1"></a><span class="vs">        (x$properties$</span><span class="sc">\`</span><span class="vs">atlas:hazard</span><span class="sc">\`</span><span class="vs"> == "NDWS" </span></span>
<span id="cb28-665"><a href="#cb28-665" aria-hidden="true" tabindex="-1"></a><span class="vs">        &amp; x$properties$</span><span class="sc">\`</span><span class="vs">atlas:statistic</span><span class="sc">\`</span><span class="vs"> == "mean") }) |&gt;</span></span>
<span id="cb28-666"><a href="#cb28-666" aria-hidden="true" tabindex="-1"></a><span class="vs">    rstac::assets_url()</span></span>
<span id="cb28-667"><a href="#cb28-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-668"><a href="#cb28-668" aria-hidden="true" tabindex="-1"></a><span class="vs">country_data &lt;- meanNDWS_tifs |&gt; </span></span>
<span id="cb28-669"><a href="#cb28-669" aria-hidden="true" tabindex="-1"></a><span class="vs">    gsub(x= _, 'https://digital-atlas.s3.amazonaws.com/', '/vsis3/digital-atlas') |&gt;</span></span>
<span id="cb28-670"><a href="#cb28-670" aria-hidden="true" tabindex="-1"></a><span class="vs">    terra::rast() |&gt; </span></span>
<span id="cb28-671"><a href="#cb28-671" aria-hidden="true" tabindex="-1"></a><span class="vs">    crop(adminBounds, mask = T)</span></span>
<span id="cb28-672"><a href="#cb28-672" aria-hidden="true" tabindex="-1"></a><span class="vs">    </span></span>
<span id="cb28-673"><a href="#cb28-673" aria-hidden="true" tabindex="-1"></a><span class="vs">plot(country_data)`</span><span class="op">;</span></span>
<span id="cb28-674"><a href="#cb28-674" aria-hidden="true" tabindex="-1"></a>      <span class="cf">break</span></span>
<span id="cb28-675"><a href="#cb28-675" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> <span class="st">'Python'</span><span class="op">:</span></span>
<span id="cb28-676"><a href="#cb28-676" aria-hidden="true" tabindex="-1"></a>      code_text <span class="op">=</span> <span class="vs">`import pystac</span></span>
<span id="cb28-677"><a href="#cb28-677" aria-hidden="true" tabindex="-1"></a><span class="vs">import rasterio</span></span>
<span id="cb28-678"><a href="#cb28-678" aria-hidden="true" tabindex="-1"></a><span class="vs">import pandas as pd</span></span>
<span id="cb28-679"><a href="#cb28-679" aria-hidden="true" tabindex="-1"></a><span class="vs">from matplotlib import pyplot</span></span>
<span id="cb28-680"><a href="#cb28-680" aria-hidden="true" tabindex="-1"></a><span class="vs">from pystac_client import Client</span></span>
<span id="cb28-681"><a href="#cb28-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-682"><a href="#cb28-682" aria-hidden="true" tabindex="-1"></a><span class="vs">stac_path = "https://digital-atlas.s3.amazonaws.com/stac/public_stac/catalog.json"</span></span>
<span id="cb28-683"><a href="#cb28-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-684"><a href="#cb28-684" aria-hidden="true" tabindex="-1"></a><span class="vs">catalog = Client.open(stac_path)</span></span>
<span id="cb28-685"><a href="#cb28-685" aria-hidden="true" tabindex="-1"></a><span class="vs">print(catalog.title)</span></span>
<span id="cb28-686"><a href="#cb28-686" aria-hidden="true" tabindex="-1"></a><span class="vs">print(catalog.description)</span></span>
<span id="cb28-687"><a href="#cb28-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-688"><a href="#cb28-688" aria-hidden="true" tabindex="-1"></a><span class="vs">children = []</span></span>
<span id="cb28-689"><a href="#cb28-689" aria-hidden="true" tabindex="-1"></a><span class="vs">for child in catalog.get_children():</span></span>
<span id="cb28-690"><a href="#cb28-690" aria-hidden="true" tabindex="-1"></a><span class="vs">    print(child)</span></span>
<span id="cb28-691"><a href="#cb28-691" aria-hidden="true" tabindex="-1"></a><span class="vs">    title = child.title</span></span>
<span id="cb28-692"><a href="#cb28-692" aria-hidden="true" tabindex="-1"></a><span class="vs">    id = child.id</span></span>
<span id="cb28-693"><a href="#cb28-693" aria-hidden="true" tabindex="-1"></a><span class="vs">    description = child.description</span></span>
<span id="cb28-694"><a href="#cb28-694" aria-hidden="true" tabindex="-1"></a><span class="vs">    self_href = child.self_href</span></span>
<span id="cb28-695"><a href="#cb28-695" aria-hidden="true" tabindex="-1"></a><span class="vs">    keywords = child.extra_fields.get('keywords') or None</span></span>
<span id="cb28-696"><a href="#cb28-696" aria-hidden="true" tabindex="-1"></a><span class="vs">    children.append({</span></span>
<span id="cb28-697"><a href="#cb28-697" aria-hidden="true" tabindex="-1"></a><span class="vs">        'title': title,</span></span>
<span id="cb28-698"><a href="#cb28-698" aria-hidden="true" tabindex="-1"></a><span class="vs">        'id': child.id,</span></span>
<span id="cb28-699"><a href="#cb28-699" aria-hidden="true" tabindex="-1"></a><span class="vs">        'description': description,</span></span>
<span id="cb28-700"><a href="#cb28-700" aria-hidden="true" tabindex="-1"></a><span class="vs">        'keywords': keywords,</span></span>
<span id="cb28-701"><a href="#cb28-701" aria-hidden="true" tabindex="-1"></a><span class="vs">        'self_href': self_href</span></span>
<span id="cb28-702"><a href="#cb28-702" aria-hidden="true" tabindex="-1"></a><span class="vs">    })</span></span>
<span id="cb28-703"><a href="#cb28-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-704"><a href="#cb28-704" aria-hidden="true" tabindex="-1"></a><span class="vs">catalog_df = pd.DataFrame(children)</span></span>
<span id="cb28-705"><a href="#cb28-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-706"><a href="#cb28-706" aria-hidden="true" tabindex="-1"></a><span class="vs">hazardCatalog = catalog.get_child('hazard_catalog')</span></span>
<span id="cb28-707"><a href="#cb28-707" aria-hidden="true" tabindex="-1"></a><span class="vs">print(hazardCatalog.description)</span></span>
<span id="cb28-708"><a href="#cb28-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-709"><a href="#cb28-709" aria-hidden="true" tabindex="-1"></a><span class="vs">hazard_items = []</span></span>
<span id="cb28-710"><a href="#cb28-710" aria-hidden="true" tabindex="-1"></a><span class="vs">for child in hazardCatalog.get_children():</span></span>
<span id="cb28-711"><a href="#cb28-711" aria-hidden="true" tabindex="-1"></a><span class="vs">    print(child)</span></span>
<span id="cb28-712"><a href="#cb28-712" aria-hidden="true" tabindex="-1"></a><span class="vs">    title = child.title</span></span>
<span id="cb28-713"><a href="#cb28-713" aria-hidden="true" tabindex="-1"></a><span class="vs">    id = child.id</span></span>
<span id="cb28-714"><a href="#cb28-714" aria-hidden="true" tabindex="-1"></a><span class="vs">    description = child.description</span></span>
<span id="cb28-715"><a href="#cb28-715" aria-hidden="true" tabindex="-1"></a><span class="vs">    self_href = child.self_href</span></span>
<span id="cb28-716"><a href="#cb28-716" aria-hidden="true" tabindex="-1"></a><span class="vs">    keywords = child.extra_fields.get('keywords') or None</span></span>
<span id="cb28-717"><a href="#cb28-717" aria-hidden="true" tabindex="-1"></a><span class="vs">    hazard_items.append({</span></span>
<span id="cb28-718"><a href="#cb28-718" aria-hidden="true" tabindex="-1"></a><span class="vs">        'title': title,</span></span>
<span id="cb28-719"><a href="#cb28-719" aria-hidden="true" tabindex="-1"></a><span class="vs">        'id': child.id,</span></span>
<span id="cb28-720"><a href="#cb28-720" aria-hidden="true" tabindex="-1"></a><span class="vs">        'description': description,</span></span>
<span id="cb28-721"><a href="#cb28-721" aria-hidden="true" tabindex="-1"></a><span class="vs">        'keywords': keywords,</span></span>
<span id="cb28-722"><a href="#cb28-722" aria-hidden="true" tabindex="-1"></a><span class="vs">        'self_href': self_href</span></span>
<span id="cb28-723"><a href="#cb28-723" aria-hidden="true" tabindex="-1"></a><span class="vs">    })</span></span>
<span id="cb28-724"><a href="#cb28-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-725"><a href="#cb28-725" aria-hidden="true" tabindex="-1"></a><span class="vs">hazardCatalog_df = pd.DataFrame(hazard_items)</span></span>
<span id="cb28-726"><a href="#cb28-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-727"><a href="#cb28-727" aria-hidden="true" tabindex="-1"></a><span class="vs">hazard_timeseries = hazardCatalog.get_child('hazard_timeseries_annual')</span></span>
<span id="cb28-728"><a href="#cb28-728" aria-hidden="true" tabindex="-1"></a><span class="vs">print(hazard_timeseries.description)</span></span>
<span id="cb28-729"><a href="#cb28-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-730"><a href="#cb28-730" aria-hidden="true" tabindex="-1"></a><span class="vs">possible_filters = next(hazard_timeseries.get_items()).properties.keys()</span></span>
<span id="cb28-731"><a href="#cb28-731" aria-hidden="true" tabindex="-1"></a><span class="vs">print(possible_filters)</span></span>
<span id="cb28-732"><a href="#cb28-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-733"><a href="#cb28-733" aria-hidden="true" tabindex="-1"></a><span class="vs">def filter_items(item_generator:pystac.ItemCollection, filters:dict, limit:int=10):</span></span>
<span id="cb28-734"><a href="#cb28-734" aria-hidden="true" tabindex="-1"></a><span class="vs">    count = 0</span></span>
<span id="cb28-735"><a href="#cb28-735" aria-hidden="true" tabindex="-1"></a><span class="vs">    for item in item_generator:</span></span>
<span id="cb28-736"><a href="#cb28-736" aria-hidden="true" tabindex="-1"></a><span class="vs">        for key, value in filters.items():</span></span>
<span id="cb28-737"><a href="#cb28-737" aria-hidden="true" tabindex="-1"></a><span class="vs">            if item.properties.get(key) != value:</span></span>
<span id="cb28-738"><a href="#cb28-738" aria-hidden="true" tabindex="-1"></a><span class="vs">                break</span></span>
<span id="cb28-739"><a href="#cb28-739" aria-hidden="true" tabindex="-1"></a><span class="vs">        else:</span></span>
<span id="cb28-740"><a href="#cb28-740" aria-hidden="true" tabindex="-1"></a><span class="vs">            yield item</span></span>
<span id="cb28-741"><a href="#cb28-741" aria-hidden="true" tabindex="-1"></a><span class="vs">            count += 1</span></span>
<span id="cb28-742"><a href="#cb28-742" aria-hidden="true" tabindex="-1"></a><span class="vs">            if count &gt;= limit:</span></span>
<span id="cb28-743"><a href="#cb28-743" aria-hidden="true" tabindex="-1"></a><span class="vs">                break</span></span>
<span id="cb28-744"><a href="#cb28-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-745"><a href="#cb28-745" aria-hidden="true" tabindex="-1"></a><span class="vs">item_filters: {'atlas:hazard': 'NDWS', 'atlas:statistic': 'mean'}</span></span>
<span id="cb28-746"><a href="#cb28-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-747"><a href="#cb28-747" aria-hidden="true" tabindex="-1"></a><span class="vs">meanNDWS_items = filter_items(hazard_timeseries.get_items(), {'atlas:hazard': 'NDWS', 'atlas:statistic': 'mean'}, limit=10)</span></span>
<span id="cb28-748"><a href="#cb28-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-749"><a href="#cb28-749" aria-hidden="true" tabindex="-1"></a><span class="vs">NDWS_assets = []</span></span>
<span id="cb28-750"><a href="#cb28-750" aria-hidden="true" tabindex="-1"></a><span class="vs">for item in meanNDWS_items:</span></span>
<span id="cb28-751"><a href="#cb28-751" aria-hidden="true" tabindex="-1"></a><span class="vs">    print(item)</span></span>
<span id="cb28-752"><a href="#cb28-752" aria-hidden="true" tabindex="-1"></a><span class="vs">    assets = item.get_assets()</span></span>
<span id="cb28-753"><a href="#cb28-753" aria-hidden="true" tabindex="-1"></a><span class="vs">    for key in assets.keys():</span></span>
<span id="cb28-754"><a href="#cb28-754" aria-hidden="true" tabindex="-1"></a><span class="vs">        print(key)</span></span>
<span id="cb28-755"><a href="#cb28-755" aria-hidden="true" tabindex="-1"></a><span class="vs">        NDWS_assets.append(assets.get(key).href)</span></span>
<span id="cb28-756"><a href="#cb28-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-757"><a href="#cb28-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-758"><a href="#cb28-758" aria-hidden="true" tabindex="-1"></a><span class="vs">with rasterio.open(NDWS_assets[0].replace('https://digital-atlas.s3.amazonaws.com/', 's3://digital-atlas')) as src:</span></span>
<span id="cb28-759"><a href="#cb28-759" aria-hidden="true" tabindex="-1"></a><span class="vs">    print(src.meta)</span></span>
<span id="cb28-760"><a href="#cb28-760" aria-hidden="true" tabindex="-1"></a><span class="vs">    pyplot.imshow(src.read(12))</span></span>
<span id="cb28-761"><a href="#cb28-761" aria-hidden="true" tabindex="-1"></a><span class="vs">    pyplot.show()`</span></span>
<span id="cb28-762"><a href="#cb28-762" aria-hidden="true" tabindex="-1"></a>      <span class="cf">break</span></span>
<span id="cb28-763"><a href="#cb28-763" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb28-764"><a href="#cb28-764" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> code_text</span>
<span id="cb28-765"><a href="#cb28-765" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-766"><a href="#cb28-766" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-767"><a href="#cb28-767" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-28" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb29" data-startfrom="771" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 770"><span id="cb29-771"><a href="#cb29-771" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`# </span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">methods_sources</span><span class="op">.</span><span class="at">title</span>)<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-29" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb30" data-startfrom="775" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 774"><span id="cb30-775"><a href="#cb30-775" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`## </span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">methods_sources</span><span class="op">.</span><span class="at">datasets</span><span class="op">.</span><span class="at">title</span>)<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-30" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb31" data-startfrom="779" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 778"><span id="cb31-779"><a href="#cb31-779" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`### </span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">methods_sources</span><span class="op">.</span><span class="at">datasets</span><span class="op">.</span><span class="at">boundaries</span><span class="op">.</span><span class="at">title</span>)<span class="sc">}</span></span>
<span id="cb31-780"><a href="#cb31-780" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">methods_sources</span><span class="op">.</span><span class="at">datasets</span><span class="op">.</span><span class="at">boundaries</span><span class="op">.</span><span class="at">text</span>)<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-31" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb32" data-startfrom="784" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 783"><span id="cb32-784"><a href="#cb32-784" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`### </span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">methods_sources</span><span class="op">.</span><span class="at">datasets</span><span class="op">.</span><span class="at">Hazards</span><span class="op">.</span><span class="at">title</span>)<span class="sc">}</span></span>
<span id="cb32-785"><a href="#cb32-785" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">methods_sources</span><span class="op">.</span><span class="at">datasets</span><span class="op">.</span><span class="at">Hazards</span><span class="op">.</span><span class="at">text</span>)<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-32" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb33" data-startfrom="789" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 788"><span id="cb33-789"><a href="#cb33-789" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`### </span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">methods_sources</span><span class="op">.</span><span class="at">datasets</span><span class="op">.</span><span class="at">exposureDS</span><span class="op">.</span><span class="at">title</span>)<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-33" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb34" data-startfrom="793" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 792"><span id="cb34-793"><a href="#cb34-793" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`#### </span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">methods_sources</span><span class="op">.</span><span class="at">datasets</span><span class="op">.</span><span class="at">exposureDS</span><span class="op">.</span><span class="at">vopHA</span><span class="op">.</span><span class="at">title</span>)<span class="sc">}</span></span>
<span id="cb34-794"><a href="#cb34-794" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">methods_sources</span><span class="op">.</span><span class="at">datasets</span><span class="op">.</span><span class="at">exposureDS</span><span class="op">.</span><span class="at">vopHA</span><span class="op">.</span><span class="at">text</span>)<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-34" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb35" data-startfrom="798" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 797"><span id="cb35-798"><a href="#cb35-798" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`#### </span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">methods_sources</span><span class="op">.</span><span class="at">datasets</span><span class="op">.</span><span class="at">exposureDS</span><span class="op">.</span><span class="at">population</span><span class="op">.</span><span class="at">title</span>)<span class="sc">}</span></span>
<span id="cb35-799"><a href="#cb35-799" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">methods_sources</span><span class="op">.</span><span class="at">datasets</span><span class="op">.</span><span class="at">exposureDS</span><span class="op">.</span><span class="at">population</span><span class="op">.</span><span class="at">text</span>)<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-35" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb36" data-startfrom="803" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 802"><span id="cb36-803"><a href="#cb36-803" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`### </span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">methods_sources</span><span class="op">.</span><span class="at">datasets</span><span class="op">.</span><span class="at">acDS</span><span class="op">.</span><span class="at">title</span>)<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-36" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb37" data-startfrom="807" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 806"><span id="cb37-807"><a href="#cb37-807" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`#### </span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">methods_sources</span><span class="op">.</span><span class="at">datasets</span><span class="op">.</span><span class="at">acDS</span><span class="op">.</span><span class="at">FemaleWellbeing</span><span class="op">.</span><span class="at">title</span>)<span class="sc">}</span></span>
<span id="cb37-808"><a href="#cb37-808" aria-hidden="true" tabindex="-1"></a><span class="vs"> </span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">methods_sources</span><span class="op">.</span><span class="at">datasets</span><span class="op">.</span><span class="at">acDS</span><span class="op">.</span><span class="at">FemaleWellbeing</span><span class="op">.</span><span class="at">text</span>)<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-37" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb38" data-startfrom="812" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 811"><span id="cb38-812"><a href="#cb38-812" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`#### </span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">methods_sources</span><span class="op">.</span><span class="at">datasets</span><span class="op">.</span><span class="at">acDS</span><span class="op">.</span><span class="at">poverty</span><span class="op">.</span><span class="at">title</span>)<span class="sc">}</span></span>
<span id="cb38-813"><a href="#cb38-813" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">methods_sources</span><span class="op">.</span><span class="at">datasets</span><span class="op">.</span><span class="at">acDS</span><span class="op">.</span><span class="at">poverty</span><span class="op">.</span><span class="at">text</span>)<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-38" data-nodetype="expression"></div></div></div><section id="appendix" class="level1 hidden"><h1 class="hidden">Appendix</h1><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb39" data-startfrom="819" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 818"><span id="cb39-819"><a href="#cb39-819" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`## Imports`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-39" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb40" data-startfrom="823" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 822"><span id="cb40-823"><a href="#cb40-823" aria-hidden="true" tabindex="-1"></a>GEOS <span class="op">=</span> {</span>
<span id="cb40-824"><a href="#cb40-824" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> initgeosJs <span class="op">=</span> (<span class="cf">await</span> <span class="im">import</span>(<span class="st">"https://cdn.skypack.dev/geos-wasm@2.0.0"</span>))</span>
<span id="cb40-825"><a href="#cb40-825" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="at">default</span><span class="op">;</span></span>
<span id="cb40-826"><a href="#cb40-826" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> geos <span class="op">=</span> <span class="cf">await</span> <span class="fu">initgeosJs</span>()<span class="op">;</span></span>
<span id="cb40-827"><a href="#cb40-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-828"><a href="#cb40-828" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">geosGeomFromWKB</span>(wkb) {</span>
<span id="cb40-829"><a href="#cb40-829" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> wkbPtr <span class="op">=</span> geos<span class="op">.</span><span class="at">Module</span><span class="op">.</span><span class="fu">_malloc</span>(wkb<span class="op">.</span><span class="at">length</span>)<span class="op">;</span> <span class="co">//Allocate memory for the geom</span></span>
<span id="cb40-830"><a href="#cb40-830" aria-hidden="true" tabindex="-1"></a>    geos<span class="op">.</span><span class="at">Module</span><span class="op">.</span><span class="at">HEAPU8</span><span class="op">.</span><span class="fu">set</span>(wkb<span class="op">,</span> wkbPtr)<span class="op">;</span></span>
<span id="cb40-831"><a href="#cb40-831" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> geomPtr <span class="op">=</span> geos<span class="op">.</span><span class="fu">GEOSGeomFromWKB_buf</span>(wkbPtr<span class="op">,</span> wkb<span class="op">.</span><span class="at">length</span>)<span class="op">;</span></span>
<span id="cb40-832"><a href="#cb40-832" aria-hidden="true" tabindex="-1"></a>    geos<span class="op">.</span><span class="at">Module</span><span class="op">.</span><span class="fu">_free</span>(wkbPtr)<span class="op">;</span></span>
<span id="cb40-833"><a href="#cb40-833" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> geomPtr<span class="op">;</span></span>
<span id="cb40-834"><a href="#cb40-834" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb40-835"><a href="#cb40-835" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-836"><a href="#cb40-836" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> geosGeomToGeojson <span class="op">=</span> (</span>
<span id="cb40-837"><a href="#cb40-837" aria-hidden="true" tabindex="-1"></a>    <span class="cf">await</span> <span class="im">import</span>(<span class="st">"https://cdn.skypack.dev/geos-wasm/helpers"</span>)</span>
<span id="cb40-838"><a href="#cb40-838" aria-hidden="true" tabindex="-1"></a>  )<span class="op">.</span><span class="at">geosGeomToGeojson</span><span class="op">;</span></span>
<span id="cb40-839"><a href="#cb40-839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-840"><a href="#cb40-840" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> { geosGeomToGeojson<span class="op">,</span> geosGeomFromWKB<span class="op">,</span> geos }<span class="op">;</span></span>
<span id="cb40-841"><a href="#cb40-841" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-40" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb41" data-startfrom="845" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 844"><span id="cb41-845"><a href="#cb41-845" aria-hidden="true" tabindex="-1"></a>geo_db <span class="op">=</span> {</span>
<span id="cb41-846"><a href="#cb41-846" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> db <span class="op">=</span> <span class="cf">await</span> DuckDBClient<span class="op">.</span><span class="fu">of</span>({</span>
<span id="cb41-847"><a href="#cb41-847" aria-hidden="true" tabindex="-1"></a>    <span class="co">// admin0_geom: FileAttachment("atlas-region_admin0_simplified.parquet"),</span></span>
<span id="cb41-848"><a href="#cb41-848" aria-hidden="true" tabindex="-1"></a>    <span class="dt">admin1_geom</span><span class="op">:</span> <span class="fu">FileAttachment</span>(<span class="st">"atlas-region_admin1_simplified.parquet"</span>)</span>
<span id="cb41-849"><a href="#cb41-849" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb41-850"><a href="#cb41-850" aria-hidden="true" tabindex="-1"></a>  <span class="cf">await</span> db<span class="op">.</span><span class="fu">query</span>(<span class="vs">`</span></span>
<span id="cb41-851"><a href="#cb41-851" aria-hidden="true" tabindex="-1"></a><span class="vs">    CREATE VIEW admin2_geom AS</span></span>
<span id="cb41-852"><a href="#cb41-852" aria-hidden="true" tabindex="-1"></a><span class="vs">    SELECT *</span></span>
<span id="cb41-853"><a href="#cb41-853" aria-hidden="true" tabindex="-1"></a><span class="vs">    FROM read_parquet("</span><span class="sc">${</span><span class="fu">resolveWindowsCacheIssue</span>(</span>
<span id="cb41-854"><a href="#cb41-854" aria-hidden="true" tabindex="-1"></a>      <span class="st">"https://digital-atlas.s3.amazonaws.com/boundaries/atlas-region_admin2_simplified.parquet"</span></span>
<span id="cb41-855"><a href="#cb41-855" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">}</span><span class="vs">")`</span>)<span class="op">;</span></span>
<span id="cb41-856"><a href="#cb41-856" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> db<span class="op">;</span></span>
<span id="cb41-857"><a href="#cb41-857" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-41" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb42" data-startfrom="861" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 860"><span id="cb42-861"><a href="#cb42-861" aria-hidden="true" tabindex="-1"></a>db <span class="op">=</span> {</span>
<span id="cb42-862"><a href="#cb42-862" aria-hidden="true" tabindex="-1"></a>  <span class="co">// const db = await DuckDBClient.of();</span></span>
<span id="cb42-863"><a href="#cb42-863" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> db <span class="op">=</span> <span class="cf">await</span> DuckDBClient<span class="op">.</span><span class="fu">of</span>({</span>
<span id="cb42-864"><a href="#cb42-864" aria-hidden="true" tabindex="-1"></a>    <span class="co">// admin0_geom: FileAttachment("atlas-region_admin0_simplified.parquet"),</span></span>
<span id="cb42-865"><a href="#cb42-865" aria-hidden="true" tabindex="-1"></a>    <span class="co">// admin1_geom: FileAttachment("atlas-region_admin1_simplified.parquet")</span></span>
<span id="cb42-866"><a href="#cb42-866" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb42-867"><a href="#cb42-867" aria-hidden="true" tabindex="-1"></a>  <span class="co">// await db.query(`</span></span>
<span id="cb42-868"><a href="#cb42-868" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   CREATE VIEW admin2_geom AS</span></span>
<span id="cb42-869"><a href="#cb42-869" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   SELECT *</span></span>
<span id="cb42-870"><a href="#cb42-870" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   FROM read_parquet("https://digital-atlas.s3.amazonaws.com/boundaries/atlas-region_admin2_simplified.parquet")`);</span></span>
<span id="cb42-871"><a href="#cb42-871" aria-hidden="true" tabindex="-1"></a>  <span class="co">// await db.query(`</span></span>
<span id="cb42-872"><a href="#cb42-872" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   CREATE VIEW exposurePopulation AS</span></span>
<span id="cb42-873"><a href="#cb42-873" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   SELECT *</span></span>
<span id="cb42-874"><a href="#cb42-874" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   FROM read_parquet('${s3Paths["Population"]}')`);</span></span>
<span id="cb42-875"><a href="#cb42-875" aria-hidden="true" tabindex="-1"></a>  <span class="co">// await db.query(`</span></span>
<span id="cb42-876"><a href="#cb42-876" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   CREATE VIEW Exposure AS</span></span>
<span id="cb42-877"><a href="#cb42-877" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   SELECT *</span></span>
<span id="cb42-878"><a href="#cb42-878" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   FROM read_parquet('${s3Paths["Exposure"]["exposure"]}')`);</span></span>
<span id="cb42-879"><a href="#cb42-879" aria-hidden="true" tabindex="-1"></a>  <span class="co">// // await build_DB(db, atlas_cat);</span></span>
<span id="cb42-880"><a href="#cb42-880" aria-hidden="true" tabindex="-1"></a>  <span class="co">// await db.query(`</span></span>
<span id="cb42-881"><a href="#cb42-881" aria-hidden="true" tabindex="-1"></a>  <span class="co">//     CREATE VIEW exposureCrop AS</span></span>
<span id="cb42-882"><a href="#cb42-882" aria-hidden="true" tabindex="-1"></a>  <span class="co">//     SELECT *</span></span>
<span id="cb42-883"><a href="#cb42-883" aria-hidden="true" tabindex="-1"></a>  <span class="co">//     FROM read_parquet('${s3Paths["Exposure"]["cropVOP"]}')</span></span>
<span id="cb42-884"><a href="#cb42-884" aria-hidden="true" tabindex="-1"></a>  <span class="co">//     UNION ALL</span></span>
<span id="cb42-885"><a href="#cb42-885" aria-hidden="true" tabindex="-1"></a>  <span class="co">//     SELECT *</span></span>
<span id="cb42-886"><a href="#cb42-886" aria-hidden="true" tabindex="-1"></a>  <span class="co">//     FROM read_parquet('${s3Paths["Exposure"]["cropHA"]}')</span></span>
<span id="cb42-887"><a href="#cb42-887" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   `);</span></span>
<span id="cb42-888"><a href="#cb42-888" aria-hidden="true" tabindex="-1"></a>  <span class="co">// await db.query(`</span></span>
<span id="cb42-889"><a href="#cb42-889" aria-hidden="true" tabindex="-1"></a>  <span class="co">//     CREATE VIEW exposureLivestock AS</span></span>
<span id="cb42-890"><a href="#cb42-890" aria-hidden="true" tabindex="-1"></a>  <span class="co">//     SELECT *</span></span>
<span id="cb42-891"><a href="#cb42-891" aria-hidden="true" tabindex="-1"></a>  <span class="co">//     FROM read_parquet('${s3Paths["Exposure"]["livestockVOP"]}')</span></span>
<span id="cb42-892"><a href="#cb42-892" aria-hidden="true" tabindex="-1"></a>  <span class="co">//     WHERE "crop" NOT LIKE '%total%'</span></span>
<span id="cb42-893"><a href="#cb42-893" aria-hidden="true" tabindex="-1"></a>  <span class="co">//     UNION ALL</span></span>
<span id="cb42-894"><a href="#cb42-894" aria-hidden="true" tabindex="-1"></a>  <span class="co">//     SELECT *</span></span>
<span id="cb42-895"><a href="#cb42-895" aria-hidden="true" tabindex="-1"></a>  <span class="co">//     FROM read_parquet('${s3Paths["Exposure"]["livestockNum"]}')</span></span>
<span id="cb42-896"><a href="#cb42-896" aria-hidden="true" tabindex="-1"></a>  <span class="co">//     WHERE "crop" NOT LIKE '%total%'</span></span>
<span id="cb42-897"><a href="#cb42-897" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   `);</span></span>
<span id="cb42-898"><a href="#cb42-898" aria-hidden="true" tabindex="-1"></a>  <span class="cf">await</span> db<span class="op">.</span><span class="fu">query</span>(<span class="vs">`</span></span>
<span id="cb42-899"><a href="#cb42-899" aria-hidden="true" tabindex="-1"></a><span class="vs">      CREATE VIEW Hazard AS</span></span>
<span id="cb42-900"><a href="#cb42-900" aria-hidden="true" tabindex="-1"></a><span class="vs">      SELECT admin0_name, admin1_name, admin2_name, scenario, timeframe, hazard, value</span></span>
<span id="cb42-901"><a href="#cb42-901" aria-hidden="true" tabindex="-1"></a><span class="vs">      FROM read_parquet('</span><span class="sc">${</span>s3Paths[<span class="st">"Hazard"</span>]<span class="sc">}</span><span class="vs">')</span></span>
<span id="cb42-902"><a href="#cb42-902" aria-hidden="true" tabindex="-1"></a><span class="vs">    `</span>)<span class="op">;</span></span>
<span id="cb42-903"><a href="#cb42-903" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="cf">await</span> db<span class="op">;</span></span>
<span id="cb42-904"><a href="#cb42-904" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-42" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb43" data-startfrom="908" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 907"><span id="cb43-908"><a href="#cb43-908" aria-hidden="true" tabindex="-1"></a>CheckORAdd_ExposureTable <span class="op">=</span> <span class="kw">async</span> (db) <span class="kw">=&gt;</span> {</span>
<span id="cb43-909"><a href="#cb43-909" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> tables <span class="op">=</span> <span class="cf">await</span> db<span class="op">.</span><span class="fu">describeTables</span>()<span class="op">.</span><span class="fu">then</span>((r) <span class="kw">=&gt;</span> r<span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">name</span>))<span class="op">;</span></span>
<span id="cb43-910"><a href="#cb43-910" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="op">!</span>tables<span class="op">.</span><span class="fu">includes</span>(<span class="st">"Exposure"</span>)) {</span>
<span id="cb43-911"><a href="#cb43-911" aria-hidden="true" tabindex="-1"></a>    <span class="cf">await</span> db<span class="op">.</span><span class="fu">query</span>(<span class="vs">`</span></span>
<span id="cb43-912"><a href="#cb43-912" aria-hidden="true" tabindex="-1"></a><span class="vs">    CREATE VIEW exposurePopulation AS</span></span>
<span id="cb43-913"><a href="#cb43-913" aria-hidden="true" tabindex="-1"></a><span class="vs">    SELECT *</span></span>
<span id="cb43-914"><a href="#cb43-914" aria-hidden="true" tabindex="-1"></a><span class="vs">    FROM read_parquet('</span><span class="sc">${</span>s3Paths[<span class="st">"Population"</span>]<span class="sc">}</span><span class="vs">')`</span>)<span class="op">;</span></span>
<span id="cb43-915"><a href="#cb43-915" aria-hidden="true" tabindex="-1"></a>    <span class="cf">await</span> db<span class="op">.</span><span class="fu">query</span>(<span class="vs">`</span></span>
<span id="cb43-916"><a href="#cb43-916" aria-hidden="true" tabindex="-1"></a><span class="vs">    CREATE VIEW Exposure AS</span></span>
<span id="cb43-917"><a href="#cb43-917" aria-hidden="true" tabindex="-1"></a><span class="vs">    SELECT *</span></span>
<span id="cb43-918"><a href="#cb43-918" aria-hidden="true" tabindex="-1"></a><span class="vs">    FROM read_parquet('</span><span class="sc">${</span>s3Paths[<span class="st">"Exposure"</span>][<span class="st">"exposure"</span>]<span class="sc">}</span><span class="vs">')`</span>)<span class="op">;</span></span>
<span id="cb43-919"><a href="#cb43-919" aria-hidden="true" tabindex="-1"></a>    <span class="cf">await</span> db<span class="op">.</span><span class="fu">query</span>(<span class="vs">`</span></span>
<span id="cb43-920"><a href="#cb43-920" aria-hidden="true" tabindex="-1"></a><span class="vs">      CREATE VIEW exposureCrop AS</span></span>
<span id="cb43-921"><a href="#cb43-921" aria-hidden="true" tabindex="-1"></a><span class="vs">          SELECT admin0_name, admin1_name, admin2_name, crop, exposure, "value" as old_value, CASE </span></span>
<span id="cb43-922"><a href="#cb43-922" aria-hidden="true" tabindex="-1"></a><span class="vs">            WHEN value &lt; 1000 THEN 0</span></span>
<span id="cb43-923"><a href="#cb43-923" aria-hidden="true" tabindex="-1"></a><span class="vs">              ELSE value</span></span>
<span id="cb43-924"><a href="#cb43-924" aria-hidden="true" tabindex="-1"></a><span class="vs">            END AS value</span></span>
<span id="cb43-925"><a href="#cb43-925" aria-hidden="true" tabindex="-1"></a><span class="vs">          FROM read_parquet('</span><span class="sc">${</span>s3Paths[<span class="st">"Exposure"</span>][<span class="st">"cropVOP"</span>]<span class="sc">}</span><span class="vs">')</span></span>
<span id="cb43-926"><a href="#cb43-926" aria-hidden="true" tabindex="-1"></a><span class="vs">          UNION ALL</span></span>
<span id="cb43-927"><a href="#cb43-927" aria-hidden="true" tabindex="-1"></a><span class="vs">          SELECT admin0_name, admin1_name, admin2_name, crop, exposure, "value" as old_value, CASE</span></span>
<span id="cb43-928"><a href="#cb43-928" aria-hidden="true" tabindex="-1"></a><span class="vs">            WHEN value &lt; 1000 THEN 0</span></span>
<span id="cb43-929"><a href="#cb43-929" aria-hidden="true" tabindex="-1"></a><span class="vs">              ELSE value</span></span>
<span id="cb43-930"><a href="#cb43-930" aria-hidden="true" tabindex="-1"></a><span class="vs">            END AS value</span></span>
<span id="cb43-931"><a href="#cb43-931" aria-hidden="true" tabindex="-1"></a><span class="vs">          FROM read_parquet('</span><span class="sc">${</span>s3Paths[<span class="st">"Exposure"</span>][<span class="st">"cropHA"</span>]<span class="sc">}</span><span class="vs">')`</span>)<span class="op">;</span></span>
<span id="cb43-932"><a href="#cb43-932" aria-hidden="true" tabindex="-1"></a>    <span class="cf">await</span> db<span class="op">.</span><span class="fu">query</span>(<span class="vs">`</span></span>
<span id="cb43-933"><a href="#cb43-933" aria-hidden="true" tabindex="-1"></a><span class="vs">      CREATE VIEW exposureLivestock AS</span></span>
<span id="cb43-934"><a href="#cb43-934" aria-hidden="true" tabindex="-1"></a><span class="vs">      SELECT *</span></span>
<span id="cb43-935"><a href="#cb43-935" aria-hidden="true" tabindex="-1"></a><span class="vs">      FROM read_parquet('</span><span class="sc">${</span>s3Paths[<span class="st">"Exposure"</span>][<span class="st">"livestockVOP"</span>]<span class="sc">}</span><span class="vs">')</span></span>
<span id="cb43-936"><a href="#cb43-936" aria-hidden="true" tabindex="-1"></a><span class="vs">      WHERE "crop" NOT LIKE '%total%'</span></span>
<span id="cb43-937"><a href="#cb43-937" aria-hidden="true" tabindex="-1"></a><span class="vs">      UNION ALL</span></span>
<span id="cb43-938"><a href="#cb43-938" aria-hidden="true" tabindex="-1"></a><span class="vs">      SELECT *</span></span>
<span id="cb43-939"><a href="#cb43-939" aria-hidden="true" tabindex="-1"></a><span class="vs">      FROM read_parquet('</span><span class="sc">${</span>s3Paths[<span class="st">"Exposure"</span>][<span class="st">"livestockNum"</span>]<span class="sc">}</span><span class="vs">')</span></span>
<span id="cb43-940"><a href="#cb43-940" aria-hidden="true" tabindex="-1"></a><span class="vs">      WHERE "crop" NOT LIKE '%total%'</span></span>
<span id="cb43-941"><a href="#cb43-941" aria-hidden="true" tabindex="-1"></a><span class="vs">    `</span>)<span class="op">;</span></span>
<span id="cb43-942"><a href="#cb43-942" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb43-943"><a href="#cb43-943" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-43" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb44" data-startfrom="947" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 946"><span id="cb44-947"><a href="#cb44-947" aria-hidden="true" tabindex="-1"></a>CheckORAdd_VulnTable <span class="op">=</span> <span class="kw">async</span> (db) <span class="kw">=&gt;</span> {</span>
<span id="cb44-948"><a href="#cb44-948" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> tables <span class="op">=</span> <span class="cf">await</span> db<span class="op">.</span><span class="fu">describeTables</span>()<span class="op">.</span><span class="fu">then</span>((r) <span class="kw">=&gt;</span> r<span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">name</span>))<span class="op">;</span></span>
<span id="cb44-949"><a href="#cb44-949" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="op">!</span>tables<span class="op">.</span><span class="fu">includes</span>(<span class="st">"Vulnerability"</span>)) {</span>
<span id="cb44-950"><a href="#cb44-950" aria-hidden="true" tabindex="-1"></a>    <span class="cf">await</span> db<span class="op">.</span><span class="fu">query</span>(<span class="vs">`</span></span>
<span id="cb44-951"><a href="#cb44-951" aria-hidden="true" tabindex="-1"></a><span class="vs">      CREATE VIEW Vulnerability AS</span></span>
<span id="cb44-952"><a href="#cb44-952" aria-hidden="true" tabindex="-1"></a><span class="vs">      SELECT *</span></span>
<span id="cb44-953"><a href="#cb44-953" aria-hidden="true" tabindex="-1"></a><span class="vs">      FROM read_parquet('</span><span class="sc">${</span>s3Paths[<span class="st">"Vulnerability"</span>]<span class="sc">}</span><span class="vs">')</span></span>
<span id="cb44-954"><a href="#cb44-954" aria-hidden="true" tabindex="-1"></a><span class="vs">    `</span>)<span class="op">;</span></span>
<span id="cb44-955"><a href="#cb44-955" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb44-956"><a href="#cb44-956" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-44" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb45" data-startfrom="960" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 959"><span id="cb45-960"><a href="#cb45-960" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { ScrollingMultiSelect_collapsible } <span class="im">from</span> <span class="st">"@brayden-youngberg/scrolling-multi-select"</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-45" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb46" data-startfrom="964" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 963"><span id="cb46-964"><a href="#cb46-964" aria-hidden="true" tabindex="-1"></a>turfRewind <span class="op">=</span> <span class="pp">require</span>(<span class="st">"@turf/turf"</span>)<span class="op">.</span><span class="fu">then</span>((t) <span class="kw">=&gt;</span> t<span class="op">.</span><span class="at">rewind</span>)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-46" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb47" data-startfrom="968" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 967"><span id="cb47-968"><a href="#cb47-968" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { resolveWindowsCacheIssue } <span class="im">from</span> <span class="st">"72281be2f13a0a72"</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-47" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb48" data-startfrom="972" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 971"><span id="cb48-972"><a href="#cb48-972" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`## Notebook Variables`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-48" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb49" data-startfrom="976" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 975"><span id="cb49-976"><a href="#cb49-976" aria-hidden="true" tabindex="-1"></a>notebookTitle <span class="op">=</span> <span class="fu">_lang</span>({</span>
<span id="cb49-977"><a href="#cb49-977" aria-hidden="true" tabindex="-1"></a>  <span class="dt">en</span><span class="op">:</span> <span class="st">"Explore the Datasets"</span><span class="op">,</span></span>
<span id="cb49-978"><a href="#cb49-978" aria-hidden="true" tabindex="-1"></a>  <span class="dt">fr</span><span class="op">:</span> <span class="st">"Explorer les jeux de données"</span><span class="op">,</span></span>
<span id="cb49-979"><a href="#cb49-979" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-49" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb50" data-startfrom="983" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 982"><span id="cb50-983"><a href="#cb50-983" aria-hidden="true" tabindex="-1"></a>timePeriod_dict <span class="op">=</span> <span class="kw">new</span> <span class="bu">Object</span>({</span>
<span id="cb50-984"><a href="#cb50-984" aria-hidden="true" tabindex="-1"></a>  <span class="dt">historic</span><span class="op">:</span> <span class="st">"Baseline"</span><span class="op">,</span></span>
<span id="cb50-985"><a href="#cb50-985" aria-hidden="true" tabindex="-1"></a>  <span class="st">"2021_2040"</span><span class="op">:</span> <span class="st">"2040"</span><span class="op">,</span></span>
<span id="cb50-986"><a href="#cb50-986" aria-hidden="true" tabindex="-1"></a>  <span class="st">"2041_2060"</span><span class="op">:</span> <span class="st">"2060"</span><span class="op">,</span></span>
<span id="cb50-987"><a href="#cb50-987" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-50" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb51" data-startfrom="991" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 990"><span id="cb51-991"><a href="#cb51-991" aria-hidden="true" tabindex="-1"></a>s3Paths <span class="op">=</span> <span class="kw">new</span> <span class="bu">Object</span>({</span>
<span id="cb51-992"><a href="#cb51-992" aria-hidden="true" tabindex="-1"></a>  <span class="dt">Population</span><span class="op">:</span> <span class="fu">resolveWindowsCacheIssue</span>(</span>
<span id="cb51-993"><a href="#cb51-993" aria-hidden="true" tabindex="-1"></a>    <span class="st">"s3://digital-atlas/population/worldpop_2020/population_adminALL.parquet"</span><span class="op">,</span></span>
<span id="cb51-994"><a href="#cb51-994" aria-hidden="true" tabindex="-1"></a>  )<span class="op">,</span></span>
<span id="cb51-995"><a href="#cb51-995" aria-hidden="true" tabindex="-1"></a>  <span class="dt">Exposure</span><span class="op">:</span> {</span>
<span id="cb51-996"><a href="#cb51-996" aria-hidden="true" tabindex="-1"></a>    <span class="dt">exposure</span><span class="op">:</span> <span class="fu">resolveWindowsCacheIssue</span>(</span>
<span id="cb51-997"><a href="#cb51-997" aria-hidden="true" tabindex="-1"></a>      <span class="st">"s3://digital-atlas/exposure/exposure_adminALL.parquet"</span><span class="op">,</span></span>
<span id="cb51-998"><a href="#cb51-998" aria-hidden="true" tabindex="-1"></a>    )<span class="op">,</span></span>
<span id="cb51-999"><a href="#cb51-999" aria-hidden="true" tabindex="-1"></a>    <span class="dt">cropVOP</span><span class="op">:</span> <span class="fu">resolveWindowsCacheIssue</span>(</span>
<span id="cb51-1000"><a href="#cb51-1000" aria-hidden="true" tabindex="-1"></a>      <span class="st">"s3://digital-atlas/exposure/mapspam/processed/crop_ha_adm.parquet"</span><span class="op">,</span></span>
<span id="cb51-1001"><a href="#cb51-1001" aria-hidden="true" tabindex="-1"></a>    )<span class="op">,</span></span>
<span id="cb51-1002"><a href="#cb51-1002" aria-hidden="true" tabindex="-1"></a>    <span class="dt">cropHA</span><span class="op">:</span> <span class="fu">resolveWindowsCacheIssue</span>(</span>
<span id="cb51-1003"><a href="#cb51-1003" aria-hidden="true" tabindex="-1"></a>      <span class="st">"s3://digital-atlas/exposure/mapspam/processed/crop_vop_adm.parquet"</span><span class="op">,</span></span>
<span id="cb51-1004"><a href="#cb51-1004" aria-hidden="true" tabindex="-1"></a>    )<span class="op">,</span></span>
<span id="cb51-1005"><a href="#cb51-1005" aria-hidden="true" tabindex="-1"></a>    <span class="dt">livestockVOP</span><span class="op">:</span> <span class="fu">resolveWindowsCacheIssue</span>(</span>
<span id="cb51-1006"><a href="#cb51-1006" aria-hidden="true" tabindex="-1"></a>      <span class="st">"s3://digital-atlas/exposure/livestock/processed/livestock_vop_adm.parquet"</span><span class="op">,</span></span>
<span id="cb51-1007"><a href="#cb51-1007" aria-hidden="true" tabindex="-1"></a>    )<span class="op">,</span></span>
<span id="cb51-1008"><a href="#cb51-1008" aria-hidden="true" tabindex="-1"></a>    <span class="dt">livestockNum</span><span class="op">:</span> <span class="fu">resolveWindowsCacheIssue</span>(</span>
<span id="cb51-1009"><a href="#cb51-1009" aria-hidden="true" tabindex="-1"></a>      <span class="st">"s3://digital-atlas/exposure/livestock/processed/livestock_no_adm.parquet"</span><span class="op">,</span></span>
<span id="cb51-1010"><a href="#cb51-1010" aria-hidden="true" tabindex="-1"></a>    )<span class="op">,</span></span>
<span id="cb51-1011"><a href="#cb51-1011" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb51-1012"><a href="#cb51-1012" aria-hidden="true" tabindex="-1"></a>  <span class="dt">Hazard</span><span class="op">:</span> <span class="fu">resolveWindowsCacheIssue</span>(</span>
<span id="cb51-1013"><a href="#cb51-1013" aria-hidden="true" tabindex="-1"></a>    <span class="st">"s3://digital-atlas/hazards/hazard_timeseries_mean/annual/haz_means_adm.parquet"</span><span class="op">,</span></span>
<span id="cb51-1014"><a href="#cb51-1014" aria-hidden="true" tabindex="-1"></a>  )<span class="op">,</span></span>
<span id="cb51-1015"><a href="#cb51-1015" aria-hidden="true" tabindex="-1"></a>  <span class="dt">Vulnerability</span><span class="op">:</span></span>
<span id="cb51-1016"><a href="#cb51-1016" aria-hidden="true" tabindex="-1"></a>    <span class="co">// "https://digital-atlas.s3.amazonaws.com/vulnerability/vulnerability_adm0-1-2.parquet"</span></span>
<span id="cb51-1017"><a href="#cb51-1017" aria-hidden="true" tabindex="-1"></a>    <span class="fu">resolveWindowsCacheIssue</span>(</span>
<span id="cb51-1018"><a href="#cb51-1018" aria-hidden="true" tabindex="-1"></a>      <span class="st">"s3://digital-atlas/vulnerability/vulnerability_adminALL.parquet"</span><span class="op">,</span></span>
<span id="cb51-1019"><a href="#cb51-1019" aria-hidden="true" tabindex="-1"></a>    )<span class="op">,</span></span>
<span id="cb51-1020"><a href="#cb51-1020" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-51" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb52" data-startfrom="1024" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1023"><span id="cb52-1024"><a href="#cb52-1024" aria-hidden="true" tabindex="-1"></a>merged_scale <span class="op">=</span> [<span class="st">"#EC5A47"</span><span class="op">,</span> <span class="st">"#ffb347"</span><span class="op">,</span> <span class="st">"#F7D732"</span><span class="op">,</span> <span class="st">"#a3ab2e"</span>]<span class="op">.</span><span class="fu">reverse</span>()<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-52" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb53" data-startfrom="1028" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1027"><span id="cb53-1028"><a href="#cb53-1028" aria-hidden="true" tabindex="-1"></a>hazard_dict <span class="op">=</span> <span class="kw">new</span> <span class="bu">Object</span>({</span>
<span id="cb53-1029"><a href="#cb53-1029" aria-hidden="true" tabindex="-1"></a>  <span class="dt">HSH_max</span><span class="op">:</span> {</span>
<span id="cb53-1030"><a href="#cb53-1030" aria-hidden="true" tabindex="-1"></a>    <span class="dt">name</span><span class="op">:</span> <span class="st">"Max Human Heat Stress"</span><span class="op">,</span></span>
<span id="cb53-1031"><a href="#cb53-1031" aria-hidden="true" tabindex="-1"></a>    <span class="dt">thresholds</span><span class="op">:</span> [<span class="dv">27</span><span class="op">,</span> <span class="dv">32</span><span class="op">,</span> <span class="dv">41</span><span class="op">,</span> <span class="dv">54</span>]<span class="op">,</span></span>
<span id="cb53-1032"><a href="#cb53-1032" aria-hidden="true" tabindex="-1"></a>    <span class="co">// colours: ["#b7e3c9", "#ffec80", "#ffb347", "#f78154", "#db3a34"]</span></span>
<span id="cb53-1033"><a href="#cb53-1033" aria-hidden="true" tabindex="-1"></a>    <span class="dt">colours</span><span class="op">:</span> merged_scale<span class="op">.</span><span class="fu">concat</span>([<span class="st">"#B8547F"</span>])<span class="op">,</span></span>
<span id="cb53-1034"><a href="#cb53-1034" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb53-1035"><a href="#cb53-1035" aria-hidden="true" tabindex="-1"></a>  <span class="dt">HSH_mean</span><span class="op">:</span> {</span>
<span id="cb53-1036"><a href="#cb53-1036" aria-hidden="true" tabindex="-1"></a>    <span class="dt">name</span><span class="op">:</span> <span class="st">"Mean Human Heat Stress"</span><span class="op">,</span></span>
<span id="cb53-1037"><a href="#cb53-1037" aria-hidden="true" tabindex="-1"></a>    <span class="dt">thresholds</span><span class="op">:</span> [<span class="dv">27</span><span class="op">,</span> <span class="dv">32</span><span class="op">,</span> <span class="dv">41</span><span class="op">,</span> <span class="dv">54</span>]<span class="op">,</span></span>
<span id="cb53-1038"><a href="#cb53-1038" aria-hidden="true" tabindex="-1"></a>    <span class="co">// colours: ["#b7e3c9", "#ffec80", "#ffb347", "#f78154", "#db3a34"]</span></span>
<span id="cb53-1039"><a href="#cb53-1039" aria-hidden="true" tabindex="-1"></a>    <span class="dt">colours</span><span class="op">:</span> merged_scale<span class="op">.</span><span class="fu">concat</span>([<span class="st">"#B8547F"</span>])<span class="op">,</span></span>
<span id="cb53-1040"><a href="#cb53-1040" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb53-1041"><a href="#cb53-1041" aria-hidden="true" tabindex="-1"></a>  <span class="dt">NDWL0</span><span class="op">:</span> {</span>
<span id="cb53-1042"><a href="#cb53-1042" aria-hidden="true" tabindex="-1"></a>    <span class="dt">name</span><span class="op">:</span> <span class="st">"Number of Waterlogging Days"</span><span class="op">,</span></span>
<span id="cb53-1043"><a href="#cb53-1043" aria-hidden="true" tabindex="-1"></a>    <span class="dt">thresholds</span><span class="op">:</span> [<span class="dv">2</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">8</span>]<span class="op">,</span></span>
<span id="cb53-1044"><a href="#cb53-1044" aria-hidden="true" tabindex="-1"></a>    <span class="co">// colours: ["#b7e3c9", "#ffec80", "#ffb347", "#f78154"]</span></span>
<span id="cb53-1045"><a href="#cb53-1045" aria-hidden="true" tabindex="-1"></a>    <span class="dt">colours</span><span class="op">:</span> merged_scale<span class="op">,</span></span>
<span id="cb53-1046"><a href="#cb53-1046" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb53-1047"><a href="#cb53-1047" aria-hidden="true" tabindex="-1"></a>  <span class="dt">NDWS</span><span class="op">:</span> {</span>
<span id="cb53-1048"><a href="#cb53-1048" aria-hidden="true" tabindex="-1"></a>    <span class="dt">name</span><span class="op">:</span> <span class="st">"Number of Days of Water Stress"</span><span class="op">,</span></span>
<span id="cb53-1049"><a href="#cb53-1049" aria-hidden="true" tabindex="-1"></a>    <span class="dt">thresholds</span><span class="op">:</span> [<span class="dv">15</span><span class="op">,</span> <span class="dv">20</span><span class="op">,</span> <span class="dv">25</span>]<span class="op">,</span></span>
<span id="cb53-1050"><a href="#cb53-1050" aria-hidden="true" tabindex="-1"></a>    <span class="co">// colours: ["#b7e3c9", "#ffec80", "#ffb347", "#f78154"]</span></span>
<span id="cb53-1051"><a href="#cb53-1051" aria-hidden="true" tabindex="-1"></a>    <span class="dt">colours</span><span class="op">:</span> merged_scale<span class="op">,</span></span>
<span id="cb53-1052"><a href="#cb53-1052" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb53-1053"><a href="#cb53-1053" aria-hidden="true" tabindex="-1"></a>  <span class="dt">NTx35</span><span class="op">:</span> {</span>
<span id="cb53-1054"><a href="#cb53-1054" aria-hidden="true" tabindex="-1"></a>    <span class="dt">name</span><span class="op">:</span> <span class="st">"Number of Heat Stress Days for Maize"</span><span class="op">,</span></span>
<span id="cb53-1055"><a href="#cb53-1055" aria-hidden="true" tabindex="-1"></a>    <span class="dt">thresholds</span><span class="op">:</span> [<span class="dv">10</span><span class="op">,</span> <span class="dv">20</span><span class="op">,</span> <span class="dv">25</span>]<span class="op">,</span></span>
<span id="cb53-1056"><a href="#cb53-1056" aria-hidden="true" tabindex="-1"></a>    <span class="co">// colours: ["#b7e3c9", "#ffec80", "#ffb347", "#f78154"]</span></span>
<span id="cb53-1057"><a href="#cb53-1057" aria-hidden="true" tabindex="-1"></a>    <span class="dt">colours</span><span class="op">:</span> merged_scale<span class="op">,</span></span>
<span id="cb53-1058"><a href="#cb53-1058" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb53-1059"><a href="#cb53-1059" aria-hidden="true" tabindex="-1"></a>  <span class="dt">NTx40</span><span class="op">:</span> {</span>
<span id="cb53-1060"><a href="#cb53-1060" aria-hidden="true" tabindex="-1"></a>    <span class="dt">name</span><span class="op">:</span> <span class="st">"Number of Heat Stress Days for Generic Crops"</span><span class="op">,</span></span>
<span id="cb53-1061"><a href="#cb53-1061" aria-hidden="true" tabindex="-1"></a>    <span class="dt">thresholds</span><span class="op">:</span> [<span class="dv">1</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">10</span>]<span class="op">,</span></span>
<span id="cb53-1062"><a href="#cb53-1062" aria-hidden="true" tabindex="-1"></a>    <span class="co">// colours: ["#b7e3c9", "#ffec80", "#ffb347", "#f78154"]</span></span>
<span id="cb53-1063"><a href="#cb53-1063" aria-hidden="true" tabindex="-1"></a>    <span class="dt">colours</span><span class="op">:</span> merged_scale<span class="op">,</span></span>
<span id="cb53-1064"><a href="#cb53-1064" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb53-1065"><a href="#cb53-1065" aria-hidden="true" tabindex="-1"></a>  <span class="dt">TAI</span><span class="op">:</span> {</span>
<span id="cb53-1066"><a href="#cb53-1066" aria-hidden="true" tabindex="-1"></a>    <span class="dt">name</span><span class="op">:</span> <span class="st">"Thornthwaite's Aridity Index"</span><span class="op">,</span></span>
<span id="cb53-1067"><a href="#cb53-1067" aria-hidden="true" tabindex="-1"></a>    <span class="dt">thresholds</span><span class="op">:</span> [<span class="dv">40</span><span class="op">,</span> <span class="dv">60</span><span class="op">,</span> <span class="dv">80</span>]<span class="op">,</span></span>
<span id="cb53-1068"><a href="#cb53-1068" aria-hidden="true" tabindex="-1"></a>    <span class="co">// colours: ["#b7e3c9", "#ffec80", "#ffb347", "#f78154"]</span></span>
<span id="cb53-1069"><a href="#cb53-1069" aria-hidden="true" tabindex="-1"></a>    <span class="dt">colours</span><span class="op">:</span> merged_scale<span class="op">,</span></span>
<span id="cb53-1070"><a href="#cb53-1070" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb53-1071"><a href="#cb53-1071" aria-hidden="true" tabindex="-1"></a>  <span class="dt">THI_max</span><span class="op">:</span> {</span>
<span id="cb53-1072"><a href="#cb53-1072" aria-hidden="true" tabindex="-1"></a>    <span class="dt">name</span><span class="op">:</span> <span class="st">"Max Cattle Thermal Humidity Index"</span><span class="op">,</span></span>
<span id="cb53-1073"><a href="#cb53-1073" aria-hidden="true" tabindex="-1"></a>    <span class="dt">thresholds</span><span class="op">:</span> [<span class="dv">72</span><span class="op">,</span> <span class="dv">78</span><span class="op">,</span> <span class="dv">90</span>]<span class="op">,</span></span>
<span id="cb53-1074"><a href="#cb53-1074" aria-hidden="true" tabindex="-1"></a>    <span class="co">// colours: ["#b7e3c9", "#ffec80", "#ffb347", "#f78154"]</span></span>
<span id="cb53-1075"><a href="#cb53-1075" aria-hidden="true" tabindex="-1"></a>    <span class="dt">colours</span><span class="op">:</span> merged_scale<span class="op">,</span></span>
<span id="cb53-1076"><a href="#cb53-1076" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb53-1077"><a href="#cb53-1077" aria-hidden="true" tabindex="-1"></a>  <span class="dt">THI_mean</span><span class="op">:</span> {</span>
<span id="cb53-1078"><a href="#cb53-1078" aria-hidden="true" tabindex="-1"></a>    <span class="dt">name</span><span class="op">:</span> <span class="st">"Mean Cattle Thermal Humidity Index"</span><span class="op">,</span></span>
<span id="cb53-1079"><a href="#cb53-1079" aria-hidden="true" tabindex="-1"></a>    <span class="dt">thresholds</span><span class="op">:</span> [<span class="dv">72</span><span class="op">,</span> <span class="dv">78</span><span class="op">,</span> <span class="dv">90</span>]<span class="op">,</span></span>
<span id="cb53-1080"><a href="#cb53-1080" aria-hidden="true" tabindex="-1"></a>    <span class="co">// colours: ["#b7e3c9", "#ffec80", "#ffb347", "#f78154"]</span></span>
<span id="cb53-1081"><a href="#cb53-1081" aria-hidden="true" tabindex="-1"></a>    <span class="dt">colours</span><span class="op">:</span> merged_scale<span class="op">,</span></span>
<span id="cb53-1082"><a href="#cb53-1082" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb53-1083"><a href="#cb53-1083" aria-hidden="true" tabindex="-1"></a>  <span class="dt">TAVG</span><span class="op">:</span> {</span>
<span id="cb53-1084"><a href="#cb53-1084" aria-hidden="true" tabindex="-1"></a>    <span class="dt">name</span><span class="op">:</span> <span class="st">"Average Temperature"</span><span class="op">,</span></span>
<span id="cb53-1085"><a href="#cb53-1085" aria-hidden="true" tabindex="-1"></a>    <span class="dt">thresholds</span><span class="op">:</span> [<span class="dv">33</span><span class="op">,</span> <span class="dv">36</span><span class="op">,</span> <span class="dv">47</span>]<span class="op">,</span></span>
<span id="cb53-1086"><a href="#cb53-1086" aria-hidden="true" tabindex="-1"></a>    <span class="dt">colours</span><span class="op">:</span> merged_scale<span class="op">,</span></span>
<span id="cb53-1087"><a href="#cb53-1087" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb53-1088"><a href="#cb53-1088" aria-hidden="true" tabindex="-1"></a>  <span class="dt">PTOT</span><span class="op">:</span> {</span>
<span id="cb53-1089"><a href="#cb53-1089" aria-hidden="true" tabindex="-1"></a>    <span class="dt">name</span><span class="op">:</span> <span class="st">"Total Precipitation"</span><span class="op">,</span></span>
<span id="cb53-1090"><a href="#cb53-1090" aria-hidden="true" tabindex="-1"></a>    <span class="dt">thresholds</span><span class="op">:</span> [<span class="dv">1200</span><span class="op">,</span> <span class="dv">1600</span><span class="op">,</span> <span class="dv">1800</span>]<span class="op">,</span></span>
<span id="cb53-1091"><a href="#cb53-1091" aria-hidden="true" tabindex="-1"></a>    <span class="dt">colours</span><span class="op">:</span> merged_scale<span class="op">,</span></span>
<span id="cb53-1092"><a href="#cb53-1092" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb53-1093"><a href="#cb53-1093" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-53" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb54" data-startfrom="1097" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1096"><span id="cb54-1097"><a href="#cb54-1097" aria-hidden="true" tabindex="-1"></a>vulnerability_dict <span class="op">=</span> <span class="kw">new</span> <span class="bu">Object</span>({</span>
<span id="cb54-1098"><a href="#cb54-1098" aria-hidden="true" tabindex="-1"></a>  <span class="dt">gender</span><span class="op">:</span> {</span>
<span id="cb54-1099"><a href="#cb54-1099" aria-hidden="true" tabindex="-1"></a>    <span class="dt">domestic_violence</span><span class="op">:</span> <span class="st">"Lack of Domestic Violence"</span><span class="op">,</span></span>
<span id="cb54-1100"><a href="#cb54-1100" aria-hidden="true" tabindex="-1"></a>    <span class="dt">gender_equity</span><span class="op">:</span> <span class="st">"Gender Equity"</span><span class="op">,</span> <span class="co">// leaving out the 1995-2015 equity index, as the rest of the AC vars are from ~2015, which is this</span></span>
<span id="cb54-1101"><a href="#cb54-1101" aria-hidden="true" tabindex="-1"></a>    <span class="dt">decision_making</span><span class="op">:</span> <span class="st">"Decision Making Power"</span><span class="op">,</span></span>
<span id="cb54-1102"><a href="#cb54-1102" aria-hidden="true" tabindex="-1"></a>    <span class="dt">education</span><span class="op">:</span> <span class="st">"Womens Education"</span><span class="op">,</span></span>
<span id="cb54-1103"><a href="#cb54-1103" aria-hidden="true" tabindex="-1"></a>    <span class="dt">family_planning</span><span class="op">:</span> <span class="st">"Access to Family Planning"</span><span class="op">,</span></span>
<span id="cb54-1104"><a href="#cb54-1104" aria-hidden="true" tabindex="-1"></a>    <span class="dt">reproductive_health</span><span class="op">:</span> <span class="st">"Reproductive Health"</span><span class="op">,</span></span>
<span id="cb54-1105"><a href="#cb54-1105" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb54-1106"><a href="#cb54-1106" aria-hidden="true" tabindex="-1"></a>  <span class="dt">poverty</span><span class="op">:</span> {</span>
<span id="cb54-1107"><a href="#cb54-1107" aria-hidden="true" tabindex="-1"></a>    <span class="dt">GSAP_poor215</span><span class="op">:</span> <span class="st">"% under $2.15 poverty line"</span><span class="op">,</span></span>
<span id="cb54-1108"><a href="#cb54-1108" aria-hidden="true" tabindex="-1"></a>    <span class="dt">GSAP_poor365</span><span class="op">:</span> <span class="st">"% under $3.65 poverty line"</span><span class="op">,</span></span>
<span id="cb54-1109"><a href="#cb54-1109" aria-hidden="true" tabindex="-1"></a>    <span class="dt">GSAP_poor685</span><span class="op">:</span> <span class="st">"% under $6.85 poverty line"</span><span class="op">,</span></span>
<span id="cb54-1110"><a href="#cb54-1110" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb54-1111"><a href="#cb54-1111" aria-hidden="true" tabindex="-1"></a>  <span class="dt">education</span><span class="op">:</span> {</span>
<span id="cb54-1112"><a href="#cb54-1112" aria-hidden="true" tabindex="-1"></a>    <span class="dt">educationYrs</span><span class="op">:</span> <span class="st">"Education(Yrs)"</span><span class="op">,</span></span>
<span id="cb54-1113"><a href="#cb54-1113" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb54-1114"><a href="#cb54-1114" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-54" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb55" data-startfrom="1118" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1117"><span id="cb55-1118"><a href="#cb55-1118" aria-hidden="true" tabindex="-1"></a>plotQuery_admin <span class="op">=</span> {</span>
<span id="cb55-1119"><a href="#cb55-1119" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (country <span class="op">===</span> <span class="st">"SSA"</span>) {</span>
<span id="cb55-1120"><a href="#cb55-1120" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="vs">`WHERE admin1_name IS NULL`</span><span class="op">;</span></span>
<span id="cb55-1121"><a href="#cb55-1121" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (country <span class="op">!==</span> <span class="st">"SSA"</span> <span class="op">&amp;&amp;</span> admin1_sel <span class="op">===</span> <span class="st">"Full Country"</span>) {</span>
<span id="cb55-1122"><a href="#cb55-1122" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="vs">`WHERE admin0_name = '</span><span class="sc">${</span>country<span class="sc">}</span><span class="vs">' AND admin1_name IS NULL`</span><span class="op">;</span></span>
<span id="cb55-1123"><a href="#cb55-1123" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (admin1_sel <span class="op">!==</span> <span class="st">"Full Country"</span> <span class="op">&amp;&amp;</span> admin2_sel <span class="op">===</span> <span class="st">"Full Region"</span>) {</span>
<span id="cb55-1124"><a href="#cb55-1124" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="vs">`WHERE admin0_name = '</span><span class="sc">${</span>country<span class="sc">}</span><span class="vs">' AND admin1_name = </span><span class="sc">${</span>admin1_sel<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span>
<span id="cb55-1125"><a href="#cb55-1125" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (admin2_sel <span class="op">!==</span> <span class="st">"Full Region"</span>) {</span>
<span id="cb55-1126"><a href="#cb55-1126" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="vs">`Where admin admin0_name = '</span><span class="sc">${</span>country<span class="sc">}</span><span class="vs">' AND admin1_name = </span><span class="sc">${</span>admin1_sel<span class="sc">}</span><span class="vs"> AND admin2_name = </span><span class="sc">${</span>admin2_sel<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span>
<span id="cb55-1127"><a href="#cb55-1127" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb55-1128"><a href="#cb55-1128" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-55" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb56" data-startfrom="1132" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1131"><span id="cb56-1132"><a href="#cb56-1132" aria-hidden="true" tabindex="-1"></a>mapDataQuery_admin <span class="op">=</span> {</span>
<span id="cb56-1133"><a href="#cb56-1133" aria-hidden="true" tabindex="-1"></a>  <span class="co">// if (country === "SSA") {</span></span>
<span id="cb56-1134"><a href="#cb56-1134" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   return `WHERE admin1_name IS NULL`;</span></span>
<span id="cb56-1135"><a href="#cb56-1135" aria-hidden="true" tabindex="-1"></a>  <span class="co">// } else if (country !== "SSA" &amp;&amp; admin1_sel === "Full Country") {</span></span>
<span id="cb56-1136"><a href="#cb56-1136" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   return `WHERE admin0_name = '${country}' AND admin1_name IS NULL`;</span></span>
<span id="cb56-1137"><a href="#cb56-1137" aria-hidden="true" tabindex="-1"></a>  <span class="co">// } else if (admin1_sel !== "Full Country" &amp;&amp; admin2_sel === "Full Region") {</span></span>
<span id="cb56-1138"><a href="#cb56-1138" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   return `WHERE admin0_name = '${country}' AND admin1_name = ${admin1_sel}`;</span></span>
<span id="cb56-1139"><a href="#cb56-1139" aria-hidden="true" tabindex="-1"></a>  <span class="co">// } else if (admin2_sel !== "Full Region") {</span></span>
<span id="cb56-1140"><a href="#cb56-1140" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   return `Where admin admin0_name = '${country}' AND admin1_name = ${admin1_sel} AND admin2_name = ${admin2_sel}`;</span></span>
<span id="cb56-1141"><a href="#cb56-1141" aria-hidden="true" tabindex="-1"></a>  <span class="co">// }</span></span>
<span id="cb56-1142"><a href="#cb56-1142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1143"><a href="#cb56-1143" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> admin_query<span class="op">;</span></span>
<span id="cb56-1144"><a href="#cb56-1144" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (country <span class="op">===</span> <span class="st">"SSA"</span>) {</span>
<span id="cb56-1145"><a href="#cb56-1145" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (admin_aggregationLevel <span class="op">===</span> <span class="st">"admin0_name"</span>) {</span>
<span id="cb56-1146"><a href="#cb56-1146" aria-hidden="true" tabindex="-1"></a>      admin_query <span class="op">=</span> <span class="vs">`WHERE admin1_name IS NULL`</span><span class="op">;</span></span>
<span id="cb56-1147"><a href="#cb56-1147" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (admin_aggregationLevel <span class="op">===</span> <span class="st">"admin1_name"</span>) {</span>
<span id="cb56-1148"><a href="#cb56-1148" aria-hidden="true" tabindex="-1"></a>      admin_query <span class="op">=</span> <span class="vs">`WHERE admin1_name IS NOT NULL AND admin2_name IS NULL`</span><span class="op">;</span></span>
<span id="cb56-1149"><a href="#cb56-1149" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (admin_aggregationLevel <span class="op">===</span> <span class="st">"admin2_name"</span>) {</span>
<span id="cb56-1150"><a href="#cb56-1150" aria-hidden="true" tabindex="-1"></a>      admin_query <span class="op">=</span> <span class="vs">`WHERE admin2_name IS NOT NULL`</span><span class="op">;</span></span>
<span id="cb56-1151"><a href="#cb56-1151" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb56-1152"><a href="#cb56-1152" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (country <span class="op">!==</span> <span class="st">"SSA"</span> <span class="op">&amp;&amp;</span> admin1_sel <span class="op">===</span> <span class="st">"Full Country"</span>) {</span>
<span id="cb56-1153"><a href="#cb56-1153" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (admin_aggregationLevel <span class="op">===</span> <span class="st">"admin0_name"</span>) {</span>
<span id="cb56-1154"><a href="#cb56-1154" aria-hidden="true" tabindex="-1"></a>      admin_query <span class="op">=</span> <span class="vs">`WHERE admin0_name = '</span><span class="sc">${</span>country<span class="sc">}</span><span class="vs">' AND admin1_name IS NULL`</span><span class="op">;</span></span>
<span id="cb56-1155"><a href="#cb56-1155" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (admin_aggregationLevel <span class="op">===</span> <span class="st">"admin1_name"</span>) {</span>
<span id="cb56-1156"><a href="#cb56-1156" aria-hidden="true" tabindex="-1"></a>      admin_query <span class="op">=</span> <span class="vs">`WHERE admin0_name = '</span><span class="sc">${</span>country<span class="sc">}</span><span class="vs">' AND admin1_name IS NOT NULL AND admin2_name IS NULL`</span><span class="op">;</span></span>
<span id="cb56-1157"><a href="#cb56-1157" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (admin_aggregationLevel <span class="op">===</span> <span class="st">"admin2_name"</span>) {</span>
<span id="cb56-1158"><a href="#cb56-1158" aria-hidden="true" tabindex="-1"></a>      admin_query <span class="op">=</span> <span class="vs">`WHERE admin0_name = '</span><span class="sc">${</span>country<span class="sc">}</span><span class="vs">' AND admin1_name IS NOT NULL AND admin2_name IS NOT NULL`</span><span class="op">;</span></span>
<span id="cb56-1159"><a href="#cb56-1159" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb56-1160"><a href="#cb56-1160" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (admin1_sel <span class="op">!==</span> <span class="st">"Full Country"</span> <span class="op">&amp;&amp;</span> admin2_sel <span class="op">===</span> <span class="st">"Full Region"</span>) {</span>
<span id="cb56-1161"><a href="#cb56-1161" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (admin_aggregationLevel <span class="op">===</span> <span class="st">"admin1_name"</span>) {</span>
<span id="cb56-1162"><a href="#cb56-1162" aria-hidden="true" tabindex="-1"></a>      admin_query <span class="op">=</span> <span class="vs">`WHERE admin0_name = '</span><span class="sc">${</span>country<span class="sc">}</span><span class="vs">' AND admin1_name ='</span><span class="sc">${</span>admin1_sel<span class="sc">}</span><span class="vs">' AND admin2_name IS NULL`</span><span class="op">;</span></span>
<span id="cb56-1163"><a href="#cb56-1163" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (admin_aggregationLevel <span class="op">===</span> <span class="st">"admin2_name"</span>) {</span>
<span id="cb56-1164"><a href="#cb56-1164" aria-hidden="true" tabindex="-1"></a>      admin_query <span class="op">=</span> <span class="vs">`WHERE admin0_name = '</span><span class="sc">${</span>country<span class="sc">}</span><span class="vs">' AND admin1_name ='</span><span class="sc">${</span>admin1_sel<span class="sc">}</span><span class="vs">' AND admin2_name IS NOT NULL`</span><span class="op">;</span></span>
<span id="cb56-1165"><a href="#cb56-1165" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb56-1166"><a href="#cb56-1166" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (admin2_sel <span class="op">!==</span> <span class="st">"Full Region"</span>) {</span>
<span id="cb56-1167"><a href="#cb56-1167" aria-hidden="true" tabindex="-1"></a>    admin_query <span class="op">=</span> <span class="vs">`WHERE admin0_name = '</span><span class="sc">${</span>country<span class="sc">}</span><span class="vs">' AND admin1_name ='</span><span class="sc">${</span>admin1_sel<span class="sc">}</span><span class="vs">' AND admin2_name ='</span><span class="sc">${</span>admin2_sel<span class="sc">}</span><span class="vs">'`</span><span class="op">;</span></span>
<span id="cb56-1168"><a href="#cb56-1168" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb56-1169"><a href="#cb56-1169" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> admin_query<span class="op">;</span></span>
<span id="cb56-1170"><a href="#cb56-1170" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-56" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb57" data-startfrom="1174" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1173"><span id="cb57-1174"><a href="#cb57-1174" aria-hidden="true" tabindex="-1"></a>plotQuery2_admin <span class="op">=</span> {</span>
<span id="cb57-1175"><a href="#cb57-1175" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (country <span class="op">===</span> <span class="st">"SSA"</span>) {</span>
<span id="cb57-1176"><a href="#cb57-1176" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="vs">`WHERE admin1_name IS NULL`</span><span class="op">;</span></span>
<span id="cb57-1177"><a href="#cb57-1177" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (country <span class="op">!==</span> <span class="st">"SSA"</span> <span class="op">&amp;&amp;</span> admin1_sel <span class="op">===</span> <span class="st">"Full Country"</span>) {</span>
<span id="cb57-1178"><a href="#cb57-1178" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="vs">`WHERE admin0_name = '</span><span class="sc">${</span>country<span class="sc">}</span><span class="vs">' AND admin1_name IS NOT NULL AND admin2_name IS NULL`</span><span class="op">;</span></span>
<span id="cb57-1179"><a href="#cb57-1179" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (admin1_sel <span class="op">!==</span> <span class="st">"Full Country"</span> <span class="op">&amp;&amp;</span> admin2_sel <span class="op">===</span> <span class="st">"Full Region"</span>) {</span>
<span id="cb57-1180"><a href="#cb57-1180" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="vs">`WHERE admin0_name = '</span><span class="sc">${</span>country<span class="sc">}</span><span class="vs">' AND admin1_name = '</span><span class="sc">${</span>admin1_sel<span class="sc">}</span><span class="vs">' AND admin2_name IS NOT NULL`</span><span class="op">;</span></span>
<span id="cb57-1181"><a href="#cb57-1181" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (admin2_sel <span class="op">!==</span> <span class="st">"Full Region"</span>) {</span>
<span id="cb57-1182"><a href="#cb57-1182" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="vs">`WHERE admin0_name = '</span><span class="sc">${</span>country<span class="sc">}</span><span class="vs">' AND admin1_name = '</span><span class="sc">${</span>admin1_sel<span class="sc">}</span><span class="vs">' AND admin2_name = '</span><span class="sc">${</span>admin2_sel<span class="sc">}</span><span class="vs">'`</span><span class="op">;</span></span>
<span id="cb57-1183"><a href="#cb57-1183" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb57-1184"><a href="#cb57-1184" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-57" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb58" data-startfrom="1188" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1187"><span id="cb58-1188"><a href="#cb58-1188" aria-hidden="true" tabindex="-1"></a>all_data_query <span class="op">=</span> {</span>
<span id="cb58-1189"><a href="#cb58-1189" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> db_query<span class="op">;</span></span>
<span id="cb58-1190"><a href="#cb58-1190" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (atlas_cat <span class="op">===</span> <span class="st">"Vulnerability"</span>) {</span>
<span id="cb58-1191"><a href="#cb58-1191" aria-hidden="true" tabindex="-1"></a>    db_query <span class="op">=</span> <span class="vs">`</span></span>
<span id="cb58-1192"><a href="#cb58-1192" aria-hidden="true" tabindex="-1"></a><span class="vs">      SELECT *,</span></span>
<span id="cb58-1193"><a href="#cb58-1193" aria-hidden="true" tabindex="-1"></a><span class="vs">      FROM Vulnerability</span></span>
<span id="cb58-1194"><a href="#cb58-1194" aria-hidden="true" tabindex="-1"></a><span class="vs">      </span><span class="sc">${</span>mapDataQuery_admin<span class="sc">}</span></span>
<span id="cb58-1195"><a href="#cb58-1195" aria-hidden="true" tabindex="-1"></a><span class="vs">      AND "group" in ('</span><span class="sc">${</span>DataSelector_form<span class="op">.</span><span class="at">vulnerabilityGroup_form</span><span class="op">.</span><span class="at">vulnerability_sel</span></span>
<span id="cb58-1196"><a href="#cb58-1196" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">join</span>(<span class="st">"', '"</span>)</span>
<span id="cb58-1197"><a href="#cb58-1197" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">toLowerCase</span>()<span class="sc">}</span><span class="vs">')`</span><span class="op">;</span></span>
<span id="cb58-1198"><a href="#cb58-1198" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (atlas_cat <span class="op">===</span> <span class="st">"Exposure"</span>) {</span>
<span id="cb58-1199"><a href="#cb58-1199" aria-hidden="true" tabindex="-1"></a>    db_query <span class="op">=</span> <span class="vs">`</span></span>
<span id="cb58-1200"><a href="#cb58-1200" aria-hidden="true" tabindex="-1"></a><span class="vs">      SELECT *</span></span>
<span id="cb58-1201"><a href="#cb58-1201" aria-hidden="true" tabindex="-1"></a><span class="vs">      FROM Exposure</span></span>
<span id="cb58-1202"><a href="#cb58-1202" aria-hidden="true" tabindex="-1"></a><span class="vs">      </span><span class="sc">${</span>mapDataQuery_admin<span class="sc">}</span></span>
<span id="cb58-1203"><a href="#cb58-1203" aria-hidden="true" tabindex="-1"></a><span class="vs">      AND "group" in ('</span><span class="sc">${</span>DataSelector_form<span class="op">.</span><span class="at">exposureGroup_form</span><span class="op">.</span><span class="at">exposureGroup_sel</span></span>
<span id="cb58-1204"><a href="#cb58-1204" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">join</span>(<span class="st">"', '"</span>)</span>
<span id="cb58-1205"><a href="#cb58-1205" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">toLowerCase</span>()<span class="sc">}</span><span class="vs">')`</span><span class="op">;</span></span>
<span id="cb58-1206"><a href="#cb58-1206" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (atlas_cat <span class="op">===</span> <span class="st">"Hazard"</span>) {</span>
<span id="cb58-1207"><a href="#cb58-1207" aria-hidden="true" tabindex="-1"></a>    db_query <span class="op">=</span> <span class="vs">`</span></span>
<span id="cb58-1208"><a href="#cb58-1208" aria-hidden="true" tabindex="-1"></a><span class="vs">    SELECT *</span></span>
<span id="cb58-1209"><a href="#cb58-1209" aria-hidden="true" tabindex="-1"></a><span class="vs">    FROM Hazard</span></span>
<span id="cb58-1210"><a href="#cb58-1210" aria-hidden="true" tabindex="-1"></a><span class="vs">    </span><span class="sc">${</span>mapDataQuery_admin<span class="sc">}</span></span>
<span id="cb58-1211"><a href="#cb58-1211" aria-hidden="true" tabindex="-1"></a><span class="vs">    AND "hazard" IN ('</span><span class="sc">${</span>DataSelector_form<span class="op">.</span><span class="at">hazardGroup_form</span><span class="op">.</span><span class="at">hazard_sel</span><span class="op">.</span><span class="fu">join</span>(</span>
<span id="cb58-1212"><a href="#cb58-1212" aria-hidden="true" tabindex="-1"></a>      <span class="st">"', '"</span></span>
<span id="cb58-1213"><a href="#cb58-1213" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">}</span><span class="vs">')</span></span>
<span id="cb58-1214"><a href="#cb58-1214" aria-hidden="true" tabindex="-1"></a><span class="vs">    AND "timeframe" IN ('</span><span class="sc">${</span>DataSelector_form<span class="op">.</span><span class="at">hazardGroup_form</span><span class="op">.</span><span class="at">timeperiod_sel</span><span class="op">.</span><span class="fu">join</span>(</span>
<span id="cb58-1215"><a href="#cb58-1215" aria-hidden="true" tabindex="-1"></a>      <span class="st">"', '"</span></span>
<span id="cb58-1216"><a href="#cb58-1216" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">}</span><span class="vs">')`</span><span class="op">;</span></span>
<span id="cb58-1217"><a href="#cb58-1217" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb58-1218"><a href="#cb58-1218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-1219"><a href="#cb58-1219" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> db_query<span class="op">;</span></span>
<span id="cb58-1220"><a href="#cb58-1220" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-58" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb59" data-startfrom="1224" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1223"><span id="cb59-1224"><a href="#cb59-1224" aria-hidden="true" tabindex="-1"></a>map_query <span class="op">=</span> {</span>
<span id="cb59-1225"><a href="#cb59-1225" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> db_query<span class="op">;</span></span>
<span id="cb59-1226"><a href="#cb59-1226" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (atlas_cat <span class="op">===</span> <span class="st">"Exposure"</span>) {</span>
<span id="cb59-1227"><a href="#cb59-1227" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (exposure_cat <span class="op">===</span> <span class="st">"Population"</span>) {</span>
<span id="cb59-1228"><a href="#cb59-1228" aria-hidden="true" tabindex="-1"></a>      <span class="co">// const pop_group = exposure_subCat.split(" ")[0].toLowerCase() + "_pop";</span></span>
<span id="cb59-1229"><a href="#cb59-1229" aria-hidden="true" tabindex="-1"></a>      db_query <span class="op">=</span> <span class="vs">`</span></span>
<span id="cb59-1230"><a href="#cb59-1230" aria-hidden="true" tabindex="-1"></a><span class="vs">      SELECT admin0_name, admin1_name, admin2_name, </span><span class="sc">${</span>exposure_subCat<span class="sc">}</span><span class="vs"> AS value</span></span>
<span id="cb59-1231"><a href="#cb59-1231" aria-hidden="true" tabindex="-1"></a><span class="vs">      FROM "</span><span class="sc">${</span>atlas_cat<span class="op">.</span><span class="fu">toLowerCase</span>() <span class="op">+</span> exposure_cat<span class="sc">}</span><span class="vs">"</span></span>
<span id="cb59-1232"><a href="#cb59-1232" aria-hidden="true" tabindex="-1"></a><span class="vs">      `</span><span class="op">;</span></span>
<span id="cb59-1233"><a href="#cb59-1233" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb59-1234"><a href="#cb59-1234" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> exposure<span class="op">;</span></span>
<span id="cb59-1235"><a href="#cb59-1235" aria-hidden="true" tabindex="-1"></a>      exposure <span class="op">=</span> exposure_var<span class="op">;</span></span>
<span id="cb59-1236"><a href="#cb59-1236" aria-hidden="true" tabindex="-1"></a>      db_query <span class="op">=</span> <span class="vs">`</span></span>
<span id="cb59-1237"><a href="#cb59-1237" aria-hidden="true" tabindex="-1"></a><span class="vs">      SELECT *</span></span>
<span id="cb59-1238"><a href="#cb59-1238" aria-hidden="true" tabindex="-1"></a><span class="vs">      FROM "</span><span class="sc">${</span>atlas_cat<span class="op">.</span><span class="fu">toLowerCase</span>() <span class="op">+</span> exposure_cat<span class="sc">}</span><span class="vs">"</span></span>
<span id="cb59-1239"><a href="#cb59-1239" aria-hidden="true" tabindex="-1"></a><span class="vs">      WHERE "exposure" LIKE '</span><span class="sc">${</span>exposure<span class="sc">}</span><span class="vs">'</span></span>
<span id="cb59-1240"><a href="#cb59-1240" aria-hidden="true" tabindex="-1"></a><span class="vs">      AND "crop" LIKE '</span><span class="sc">${</span>exposure_subCat<span class="sc">}</span><span class="vs">'`</span><span class="op">;</span></span>
<span id="cb59-1241"><a href="#cb59-1241" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb59-1242"><a href="#cb59-1242" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (atlas_cat <span class="op">===</span> <span class="st">"Vulnerability"</span>) {</span>
<span id="cb59-1243"><a href="#cb59-1243" aria-hidden="true" tabindex="-1"></a>    db_query <span class="op">=</span> <span class="vs">`</span></span>
<span id="cb59-1244"><a href="#cb59-1244" aria-hidden="true" tabindex="-1"></a><span class="vs">      SELECT *</span></span>
<span id="cb59-1245"><a href="#cb59-1245" aria-hidden="true" tabindex="-1"></a><span class="vs">      FROM Vulnerability</span></span>
<span id="cb59-1246"><a href="#cb59-1246" aria-hidden="true" tabindex="-1"></a><span class="vs">      WHERE "group" LIKE '</span><span class="sc">${</span>ac_cat<span class="op">.</span><span class="fu">toLocaleLowerCase</span>()<span class="sc">}</span><span class="vs">'</span></span>
<span id="cb59-1247"><a href="#cb59-1247" aria-hidden="true" tabindex="-1"></a><span class="vs">  `</span><span class="op">;</span></span>
<span id="cb59-1248"><a href="#cb59-1248" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (ac_cat <span class="op">===</span> <span class="st">"Gender"</span> <span class="op">||</span> ac_cat <span class="op">===</span> <span class="st">"Poverty"</span>) {</span>
<span id="cb59-1249"><a href="#cb59-1249" aria-hidden="true" tabindex="-1"></a>      db_query <span class="op">=</span> db_query <span class="op">+</span> <span class="vs">`AND "variable" LIKE '</span><span class="sc">${</span>ac_subcat<span class="sc">}</span><span class="vs">'`</span><span class="op">;</span></span>
<span id="cb59-1250"><a href="#cb59-1250" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb59-1251"><a href="#cb59-1251" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (atlas_cat <span class="op">===</span> <span class="st">"Hazard"</span>) {</span>
<span id="cb59-1252"><a href="#cb59-1252" aria-hidden="true" tabindex="-1"></a>    db_query <span class="op">=</span> <span class="vs">`</span></span>
<span id="cb59-1253"><a href="#cb59-1253" aria-hidden="true" tabindex="-1"></a><span class="vs">    SELECT *</span></span>
<span id="cb59-1254"><a href="#cb59-1254" aria-hidden="true" tabindex="-1"></a><span class="vs">    FROM Hazard</span></span>
<span id="cb59-1255"><a href="#cb59-1255" aria-hidden="true" tabindex="-1"></a><span class="vs">    WHERE "hazard" LIKE '</span><span class="sc">${</span>hazard_sel<span class="sc">}</span><span class="vs">'</span></span>
<span id="cb59-1256"><a href="#cb59-1256" aria-hidden="true" tabindex="-1"></a><span class="vs">    AND "scenario" LIKE '</span><span class="sc">${</span>ssp_sel<span class="op">.</span><span class="fu">toLowerCase</span>()<span class="sc">}</span><span class="vs">' AND "timeframe" LIKE '</span><span class="sc">${</span>time_sel<span class="op">.</span><span class="fu">toLowerCase</span>()<span class="sc">}</span><span class="vs">'`</span><span class="op">;</span></span>
<span id="cb59-1257"><a href="#cb59-1257" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb59-1258"><a href="#cb59-1258" aria-hidden="true" tabindex="-1"></a>    db_query <span class="op">=</span> <span class="kw">null</span></span>
<span id="cb59-1259"><a href="#cb59-1259" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb59-1260"><a href="#cb59-1260" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> db_query<span class="op">;</span></span>
<span id="cb59-1261"><a href="#cb59-1261" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-59" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb60" data-startfrom="1265" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1264"><span id="cb60-1265"><a href="#cb60-1265" aria-hidden="true" tabindex="-1"></a>NbData <span class="op">=</span> {</span>
<span id="cb60-1266"><a href="#cb60-1266" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (atlas_cat <span class="op">===</span> <span class="st">"Vulnerability"</span>) {</span>
<span id="cb60-1267"><a href="#cb60-1267" aria-hidden="true" tabindex="-1"></a>    <span class="cf">await</span> <span class="fu">CheckORAdd_VulnTable</span>(db)<span class="op">;</span></span>
<span id="cb60-1268"><a href="#cb60-1268" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (atlas_cat <span class="op">===</span> <span class="st">"Exposure"</span>) {</span>
<span id="cb60-1269"><a href="#cb60-1269" aria-hidden="true" tabindex="-1"></a>    <span class="cf">await</span> <span class="fu">CheckORAdd_ExposureTable</span>(db)<span class="op">;</span></span>
<span id="cb60-1270"><a href="#cb60-1270" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb60-1271"><a href="#cb60-1271" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb60-1272"><a href="#cb60-1272" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> {</span>
<span id="cb60-1273"><a href="#cb60-1273" aria-hidden="true" tabindex="-1"></a>    <span class="dt">explore_data</span><span class="op">:</span> <span class="cf">await</span> db<span class="op">.</span><span class="fu">query</span>(all_data_query)<span class="op">,</span></span>
<span id="cb60-1274"><a href="#cb60-1274" aria-hidden="true" tabindex="-1"></a>    <span class="dt">map_data</span><span class="op">:</span> <span class="cf">await</span> db<span class="op">.</span><span class="fu">query</span>(map_query)</span>
<span id="cb60-1275"><a href="#cb60-1275" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb60-1276"><a href="#cb60-1276" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-60" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb61" data-startfrom="1280" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1279"><span id="cb61-1280"><a href="#cb61-1280" aria-hidden="true" tabindex="-1"></a>admin_index <span class="op">=</span> d3<span class="op">.</span><span class="fu">index</span>(</span>
<span id="cb61-1281"><a href="#cb61-1281" aria-hidden="true" tabindex="-1"></a>  NbData[<span class="st">"map_data"</span>]<span class="op">,</span></span>
<span id="cb61-1282"><a href="#cb61-1282" aria-hidden="true" tabindex="-1"></a>  (d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">admin0_name</span><span class="op">,</span></span>
<span id="cb61-1283"><a href="#cb61-1283" aria-hidden="true" tabindex="-1"></a>  (d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">admin1_name</span><span class="op">,</span></span>
<span id="cb61-1284"><a href="#cb61-1284" aria-hidden="true" tabindex="-1"></a>  (d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">admin2_name</span><span class="op">,</span></span>
<span id="cb61-1285"><a href="#cb61-1285" aria-hidden="true" tabindex="-1"></a>)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-61" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb62" data-startfrom="1289" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1288"><span id="cb62-1289"><a href="#cb62-1289" aria-hidden="true" tabindex="-1"></a>crop_groups <span class="op">=</span> <span class="kw">new</span> <span class="bu">Object</span>({</span>
<span id="cb62-1290"><a href="#cb62-1290" aria-hidden="true" tabindex="-1"></a>  <span class="dt">cattle</span><span class="op">:</span> [<span class="st">"cattle_tropical"</span><span class="op">,</span> <span class="st">"cattle_highland"</span>]<span class="op">,</span></span>
<span id="cb62-1291"><a href="#cb62-1291" aria-hidden="true" tabindex="-1"></a>  <span class="dt">poultry</span><span class="op">:</span> [<span class="st">"poultry_tropical"</span><span class="op">,</span> <span class="st">"poultry_highland"</span>]<span class="op">,</span></span>
<span id="cb62-1292"><a href="#cb62-1292" aria-hidden="true" tabindex="-1"></a>  <span class="dt">pigs</span><span class="op">:</span> [<span class="st">"pigs_tropical"</span><span class="op">,</span> <span class="st">"pigs_highland"</span>]<span class="op">,</span></span>
<span id="cb62-1293"><a href="#cb62-1293" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Small Ruminants"</span><span class="op">:</span> [</span>
<span id="cb62-1294"><a href="#cb62-1294" aria-hidden="true" tabindex="-1"></a>    <span class="st">"sheep_tropical"</span><span class="op">,</span></span>
<span id="cb62-1295"><a href="#cb62-1295" aria-hidden="true" tabindex="-1"></a>    <span class="st">"sheep_highland"</span><span class="op">,</span></span>
<span id="cb62-1296"><a href="#cb62-1296" aria-hidden="true" tabindex="-1"></a>    <span class="st">"goats_tropical"</span><span class="op">,</span></span>
<span id="cb62-1297"><a href="#cb62-1297" aria-hidden="true" tabindex="-1"></a>    <span class="st">"goats_highland"</span><span class="op">,</span></span>
<span id="cb62-1298"><a href="#cb62-1298" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">,</span></span>
<span id="cb62-1299"><a href="#cb62-1299" aria-hidden="true" tabindex="-1"></a>  <span class="dt">rootsTuber</span><span class="op">:</span> [<span class="st">"potato"</span><span class="op">,</span> <span class="st">"sweet potato"</span><span class="op">,</span> <span class="st">"yams"</span><span class="op">,</span> <span class="st">"cassava"</span>]<span class="op">,</span></span>
<span id="cb62-1300"><a href="#cb62-1300" aria-hidden="true" tabindex="-1"></a>  <span class="dt">cereals</span><span class="op">:</span> [</span>
<span id="cb62-1301"><a href="#cb62-1301" aria-hidden="true" tabindex="-1"></a>    <span class="st">"wheat"</span><span class="op">,</span></span>
<span id="cb62-1302"><a href="#cb62-1302" aria-hidden="true" tabindex="-1"></a>    <span class="st">"rice"</span><span class="op">,</span></span>
<span id="cb62-1303"><a href="#cb62-1303" aria-hidden="true" tabindex="-1"></a>    <span class="st">"maize"</span><span class="op">,</span></span>
<span id="cb62-1304"><a href="#cb62-1304" aria-hidden="true" tabindex="-1"></a>    <span class="st">"barley"</span><span class="op">,</span></span>
<span id="cb62-1305"><a href="#cb62-1305" aria-hidden="true" tabindex="-1"></a>    <span class="st">"pearl millet"</span><span class="op">,</span></span>
<span id="cb62-1306"><a href="#cb62-1306" aria-hidden="true" tabindex="-1"></a>    <span class="st">"small millet"</span><span class="op">,</span></span>
<span id="cb62-1307"><a href="#cb62-1307" aria-hidden="true" tabindex="-1"></a>    <span class="st">"sorghum"</span><span class="op">,</span></span>
<span id="cb62-1308"><a href="#cb62-1308" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">,</span></span>
<span id="cb62-1309"><a href="#cb62-1309" aria-hidden="true" tabindex="-1"></a>  <span class="dt">legumes</span><span class="op">:</span> [</span>
<span id="cb62-1310"><a href="#cb62-1310" aria-hidden="true" tabindex="-1"></a>    <span class="st">"bean"</span><span class="op">,</span></span>
<span id="cb62-1311"><a href="#cb62-1311" aria-hidden="true" tabindex="-1"></a>    <span class="st">"chickpea"</span><span class="op">,</span></span>
<span id="cb62-1312"><a href="#cb62-1312" aria-hidden="true" tabindex="-1"></a>    <span class="st">"cowpea"</span><span class="op">,</span></span>
<span id="cb62-1313"><a href="#cb62-1313" aria-hidden="true" tabindex="-1"></a>    <span class="st">"pigeonpea"</span><span class="op">,</span></span>
<span id="cb62-1314"><a href="#cb62-1314" aria-hidden="true" tabindex="-1"></a>    <span class="st">"lentil"</span><span class="op">,</span></span>
<span id="cb62-1315"><a href="#cb62-1315" aria-hidden="true" tabindex="-1"></a>    <span class="st">"groundnut"</span><span class="op">,</span></span>
<span id="cb62-1316"><a href="#cb62-1316" aria-hidden="true" tabindex="-1"></a>    <span class="st">"soybean"</span><span class="op">,</span></span>
<span id="cb62-1317"><a href="#cb62-1317" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">,</span></span>
<span id="cb62-1318"><a href="#cb62-1318" aria-hidden="true" tabindex="-1"></a>  <span class="dt">fruitVeg</span><span class="op">:</span> [<span class="st">"plantain"</span><span class="op">,</span> <span class="st">"coconut"</span><span class="op">,</span> <span class="st">"banana"</span>]<span class="op">,</span></span>
<span id="cb62-1319"><a href="#cb62-1319" aria-hidden="true" tabindex="-1"></a>  <span class="dt">nonEdible</span><span class="op">:</span> [</span>
<span id="cb62-1320"><a href="#cb62-1320" aria-hidden="true" tabindex="-1"></a>    <span class="st">"cocoa"</span><span class="op">,</span></span>
<span id="cb62-1321"><a href="#cb62-1321" aria-hidden="true" tabindex="-1"></a>    <span class="st">"rapeseed"</span><span class="op">,</span></span>
<span id="cb62-1322"><a href="#cb62-1322" aria-hidden="true" tabindex="-1"></a>    <span class="st">"sesameseed"</span><span class="op">,</span></span>
<span id="cb62-1323"><a href="#cb62-1323" aria-hidden="true" tabindex="-1"></a>    <span class="st">"oilpalm"</span><span class="op">,</span></span>
<span id="cb62-1324"><a href="#cb62-1324" aria-hidden="true" tabindex="-1"></a>    <span class="st">"cotton"</span><span class="op">,</span></span>
<span id="cb62-1325"><a href="#cb62-1325" aria-hidden="true" tabindex="-1"></a>    <span class="st">"tea"</span><span class="op">,</span></span>
<span id="cb62-1326"><a href="#cb62-1326" aria-hidden="true" tabindex="-1"></a>    <span class="st">"tobacco"</span><span class="op">,</span></span>
<span id="cb62-1327"><a href="#cb62-1327" aria-hidden="true" tabindex="-1"></a>    <span class="st">"arabica coffee"</span><span class="op">,</span></span>
<span id="cb62-1328"><a href="#cb62-1328" aria-hidden="true" tabindex="-1"></a>    <span class="st">"sunflower"</span><span class="op">,</span></span>
<span id="cb62-1329"><a href="#cb62-1329" aria-hidden="true" tabindex="-1"></a>    <span class="st">"sugarcane"</span><span class="op">,</span></span>
<span id="cb62-1330"><a href="#cb62-1330" aria-hidden="true" tabindex="-1"></a>    <span class="st">"sugarbeet"</span><span class="op">,</span></span>
<span id="cb62-1331"><a href="#cb62-1331" aria-hidden="true" tabindex="-1"></a>    <span class="st">"robusta coffee"</span><span class="op">,</span></span>
<span id="cb62-1332"><a href="#cb62-1332" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">,</span></span>
<span id="cb62-1333"><a href="#cb62-1333" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-62" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb63" data-startfrom="1337" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1336"><span id="cb63-1337"><a href="#cb63-1337" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`## Format helpers`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-63" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb64" data-startfrom="1341" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1340"><span id="cb64-1341"><a href="#cb64-1341" aria-hidden="true" tabindex="-1"></a>formatDollar <span class="op">=</span> <span class="kw">new</span> <span class="bu">Intl</span><span class="op">.</span><span class="fu">NumberFormat</span>(<span class="st">"en-US"</span><span class="op">,</span> {</span>
<span id="cb64-1342"><a href="#cb64-1342" aria-hidden="true" tabindex="-1"></a>  <span class="dt">notation</span><span class="op">:</span> <span class="st">"compact"</span><span class="op">,</span></span>
<span id="cb64-1343"><a href="#cb64-1343" aria-hidden="true" tabindex="-1"></a>  <span class="dt">compactDisplay</span><span class="op">:</span> <span class="st">"short"</span><span class="op">,</span></span>
<span id="cb64-1344"><a href="#cb64-1344" aria-hidden="true" tabindex="-1"></a>  <span class="dt">style</span><span class="op">:</span> <span class="st">"currency"</span><span class="op">,</span></span>
<span id="cb64-1345"><a href="#cb64-1345" aria-hidden="true" tabindex="-1"></a>  <span class="dt">currency</span><span class="op">:</span> <span class="st">"usd"</span><span class="op">,</span></span>
<span id="cb64-1346"><a href="#cb64-1346" aria-hidden="true" tabindex="-1"></a>})<span class="op">.</span><span class="at">format</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-64" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb65" data-startfrom="1350" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1349"><span id="cb65-1350"><a href="#cb65-1350" aria-hidden="true" tabindex="-1"></a>formatBigNums <span class="op">=</span> <span class="kw">new</span> <span class="bu">Intl</span><span class="op">.</span><span class="fu">NumberFormat</span>(<span class="st">"en-US"</span><span class="op">,</span> {</span>
<span id="cb65-1351"><a href="#cb65-1351" aria-hidden="true" tabindex="-1"></a>  <span class="dt">notation</span><span class="op">:</span> <span class="st">"compact"</span><span class="op">,</span></span>
<span id="cb65-1352"><a href="#cb65-1352" aria-hidden="true" tabindex="-1"></a>  <span class="dt">compactDisplay</span><span class="op">:</span> <span class="st">"short"</span><span class="op">,</span></span>
<span id="cb65-1353"><a href="#cb65-1353" aria-hidden="true" tabindex="-1"></a>})<span class="op">.</span><span class="at">format</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-65" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb66" data-startfrom="1357" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1356"><span id="cb66-1357"><a href="#cb66-1357" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">format_val</span>(val<span class="op">,</span> unit) {</span>
<span id="cb66-1358"><a href="#cb66-1358" aria-hidden="true" tabindex="-1"></a>  <span class="cf">switch</span> (unit) {</span>
<span id="cb66-1359"><a href="#cb66-1359" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> <span class="st">"dollar"</span><span class="op">:</span></span>
<span id="cb66-1360"><a href="#cb66-1360" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> <span class="fu">formatDollar</span>(val)<span class="op">;</span></span>
<span id="cb66-1361"><a href="#cb66-1361" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> <span class="st">"total"</span><span class="op">:</span></span>
<span id="cb66-1362"><a href="#cb66-1362" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> <span class="fu">formatBigNums</span>(val)<span class="op">;</span></span>
<span id="cb66-1363"><a href="#cb66-1363" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> <span class="st">"total_ha"</span><span class="op">:</span></span>
<span id="cb66-1364"><a href="#cb66-1364" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> <span class="vs">`</span><span class="sc">${</span><span class="fu">formatBigNums</span>(val)<span class="sc">}</span><span class="vs"> /ha`</span><span class="op">;</span></span>
<span id="cb66-1365"><a href="#cb66-1365" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> <span class="st">"index"</span><span class="op">:</span></span>
<span id="cb66-1366"><a href="#cb66-1366" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> val<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">2</span>)<span class="op">;</span></span>
<span id="cb66-1367"><a href="#cb66-1367" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> <span class="st">"percent"</span><span class="op">:</span></span>
<span id="cb66-1368"><a href="#cb66-1368" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> <span class="vs">`</span><span class="sc">${</span>(val <span class="op">*</span> <span class="dv">100</span>)<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">2</span>)<span class="sc">}</span><span class="vs">%`</span><span class="op">;</span></span>
<span id="cb66-1369"><a href="#cb66-1369" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> <span class="st">"percent_NoDecimal"</span><span class="op">:</span></span>
<span id="cb66-1370"><a href="#cb66-1370" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> <span class="vs">`</span><span class="sc">${</span>(val <span class="op">*</span> <span class="dv">100</span>)<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">0</span>)<span class="sc">}</span><span class="vs">%`</span><span class="op">;</span></span>
<span id="cb66-1371"><a href="#cb66-1371" aria-hidden="true" tabindex="-1"></a>    <span class="cf">default</span><span class="op">:</span></span>
<span id="cb66-1372"><a href="#cb66-1372" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="kw">typeof</span> unit <span class="op">===</span> <span class="st">"number"</span>) {</span>
<span id="cb66-1373"><a href="#cb66-1373" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (val <span class="op">*</span> unit)<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb66-1374"><a href="#cb66-1374" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb66-1375"><a href="#cb66-1375" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> val<span class="op">;</span> <span class="co">// Default case if unit doesn't match any condition</span></span>
<span id="cb66-1376"><a href="#cb66-1376" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb66-1377"><a href="#cb66-1377" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-66" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb67" data-startfrom="1381" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1380"><span id="cb67-1381"><a href="#cb67-1381" aria-hidden="true" tabindex="-1"></a>var_unit <span class="op">=</span> {</span>
<span id="cb67-1382"><a href="#cb67-1382" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (atlas_cat <span class="op">===</span> <span class="st">"Hazard"</span>) {</span>
<span id="cb67-1383"><a href="#cb67-1383" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> clean_haz <span class="op">=</span> hazard_sel<span class="op">.</span><span class="fu">split</span>(<span class="st">"_"</span>)[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb67-1384"><a href="#cb67-1384" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> unit_dict[atlas_cat][clean_haz]<span class="op">;</span></span>
<span id="cb67-1385"><a href="#cb67-1385" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb67-1386"><a href="#cb67-1386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1387"><a href="#cb67-1387" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (atlas_cat <span class="op">===</span> <span class="st">"Exposure"</span>) {</span>
<span id="cb67-1388"><a href="#cb67-1388" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (exposure_var <span class="op">===</span> <span class="st">"vop"</span>) {</span>
<span id="cb67-1389"><a href="#cb67-1389" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> unit_dict[atlas_cat][exposure_var]<span class="op">;</span></span>
<span id="cb67-1390"><a href="#cb67-1390" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (exposure_cat <span class="op">===</span> <span class="st">"Population"</span>) {</span>
<span id="cb67-1391"><a href="#cb67-1391" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> unit_dict[atlas_cat][<span class="st">"populationTotal"</span>]<span class="op">;</span></span>
<span id="cb67-1392"><a href="#cb67-1392" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb67-1393"><a href="#cb67-1393" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> clean_var <span class="op">=</span> exposure_var<span class="op">;</span></span>
<span id="cb67-1394"><a href="#cb67-1394" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> full_var <span class="op">=</span> exposure_cat<span class="op">.</span><span class="fu">toLowerCase</span>() <span class="op">+</span> clean_var<span class="op">;</span></span>
<span id="cb67-1395"><a href="#cb67-1395" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> unit_dict[atlas_cat][full_var]<span class="op">;</span> <span class="co">//.toLowerCase()</span></span>
<span id="cb67-1396"><a href="#cb67-1396" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb67-1397"><a href="#cb67-1397" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb67-1398"><a href="#cb67-1398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1399"><a href="#cb67-1399" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (atlas_cat <span class="op">===</span> <span class="st">"Vulnerability"</span>) {</span>
<span id="cb67-1400"><a href="#cb67-1400" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> unit_dict[atlas_cat][ac_cat]<span class="op">;</span></span>
<span id="cb67-1401"><a href="#cb67-1401" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb67-1402"><a href="#cb67-1402" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-67" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb68" data-startfrom="1406" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1405"><span id="cb68-1406"><a href="#cb68-1406" aria-hidden="true" tabindex="-1"></a>unit_dict <span class="op">=</span> {</span>
<span id="cb68-1407"><a href="#cb68-1407" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> day_lab <span class="op">=</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">units</span><span class="op">.</span><span class="at">days</span>)</span>
<span id="cb68-1408"><a href="#cb68-1408" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> index_lab <span class="op">=</span>  <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">units</span><span class="op">.</span><span class="at">index</span>)</span>
<span id="cb68-1409"><a href="#cb68-1409" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> yr_lab <span class="op">=</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">units</span><span class="op">.</span><span class="at">yrs</span>)</span>
<span id="cb68-1410"><a href="#cb68-1410" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> pop_lab <span class="op">=</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">units</span><span class="op">.</span><span class="at">num_people</span>)</span>
<span id="cb68-1411"><a href="#cb68-1411" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> numAnimal_lab <span class="op">=</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">units</span><span class="op">.</span><span class="at">num_animals</span>)</span>
<span id="cb68-1412"><a href="#cb68-1412" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-1413"><a href="#cb68-1413" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> {</span>
<span id="cb68-1414"><a href="#cb68-1414" aria-hidden="true" tabindex="-1"></a>    <span class="dt">Exposure</span><span class="op">:</span> {</span>
<span id="cb68-1415"><a href="#cb68-1415" aria-hidden="true" tabindex="-1"></a>      <span class="dt">vop</span><span class="op">:</span> { <span class="dt">label</span><span class="op">:</span> <span class="st">"IND2005"</span><span class="op">,</span> <span class="dt">category</span><span class="op">:</span> <span class="st">"dollar"</span> }<span class="op">,</span></span>
<span id="cb68-1416"><a href="#cb68-1416" aria-hidden="true" tabindex="-1"></a>      <span class="dt">livestocknumber</span><span class="op">:</span> { <span class="dt">label</span><span class="op">:</span> numAnimal_lab<span class="op">,</span> <span class="dt">category</span><span class="op">:</span> <span class="st">"total"</span> }<span class="op">,</span></span>
<span id="cb68-1417"><a href="#cb68-1417" aria-hidden="true" tabindex="-1"></a>      <span class="dt">cropha</span><span class="op">:</span> { <span class="dt">label</span><span class="op">:</span> <span class="st">"Ha"</span><span class="op">,</span> <span class="dt">category</span><span class="op">:</span> <span class="st">"total"</span> }<span class="op">,</span></span>
<span id="cb68-1418"><a href="#cb68-1418" aria-hidden="true" tabindex="-1"></a>      <span class="dt">populationTotal</span><span class="op">:</span> { <span class="dt">label</span><span class="op">:</span> pop_lab<span class="op">,</span> <span class="dt">category</span><span class="op">:</span> <span class="st">"total"</span> }</span>
<span id="cb68-1419"><a href="#cb68-1419" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb68-1420"><a href="#cb68-1420" aria-hidden="true" tabindex="-1"></a>    <span class="dt">Hazard</span><span class="op">:</span> {</span>
<span id="cb68-1421"><a href="#cb68-1421" aria-hidden="true" tabindex="-1"></a>      <span class="dt">THI</span><span class="op">:</span> { <span class="dt">label</span><span class="op">:</span> index_lab<span class="op">,</span> <span class="dt">category</span><span class="op">:</span> <span class="st">"total"</span> }<span class="op">,</span></span>
<span id="cb68-1422"><a href="#cb68-1422" aria-hidden="true" tabindex="-1"></a>      <span class="dt">TAVG</span><span class="op">:</span> { <span class="dt">label</span><span class="op">:</span> <span class="st">"ºC"</span><span class="op">,</span> <span class="dt">category</span><span class="op">:</span> <span class="st">"total"</span> }<span class="op">,</span></span>
<span id="cb68-1423"><a href="#cb68-1423" aria-hidden="true" tabindex="-1"></a>      <span class="dt">TAI</span><span class="op">:</span> { <span class="dt">label</span><span class="op">:</span> <span class="st">"%"</span><span class="op">,</span> <span class="dt">category</span><span class="op">:</span> <span class="st">"total"</span> }<span class="op">,</span></span>
<span id="cb68-1424"><a href="#cb68-1424" aria-hidden="true" tabindex="-1"></a>      <span class="dt">PTOT</span><span class="op">:</span> { <span class="dt">label</span><span class="op">:</span> <span class="st">"mm"</span><span class="op">,</span> <span class="dt">category</span><span class="op">:</span> <span class="st">"total"</span> }<span class="op">,</span></span>
<span id="cb68-1425"><a href="#cb68-1425" aria-hidden="true" tabindex="-1"></a>      <span class="dt">NTx35</span><span class="op">:</span> { <span class="dt">label</span><span class="op">:</span> day_lab<span class="op">,</span> <span class="dt">category</span><span class="op">:</span> <span class="st">"total"</span> }<span class="op">,</span></span>
<span id="cb68-1426"><a href="#cb68-1426" aria-hidden="true" tabindex="-1"></a>      <span class="dt">NTx40</span><span class="op">:</span> { <span class="dt">label</span><span class="op">:</span> day_lab<span class="op">,</span> <span class="dt">category</span><span class="op">:</span> <span class="st">"total"</span> }<span class="op">,</span></span>
<span id="cb68-1427"><a href="#cb68-1427" aria-hidden="true" tabindex="-1"></a>      <span class="dt">NDWS</span><span class="op">:</span> { <span class="dt">label</span><span class="op">:</span> day_lab<span class="op">,</span> <span class="dt">category</span><span class="op">:</span> <span class="st">"total"</span> }<span class="op">,</span></span>
<span id="cb68-1428"><a href="#cb68-1428" aria-hidden="true" tabindex="-1"></a>      <span class="dt">NDWL0</span><span class="op">:</span> { <span class="dt">label</span><span class="op">:</span> day_lab<span class="op">,</span> <span class="dt">category</span><span class="op">:</span> <span class="st">"total"</span> }<span class="op">,</span></span>
<span id="cb68-1429"><a href="#cb68-1429" aria-hidden="true" tabindex="-1"></a>      <span class="dt">HSH</span><span class="op">:</span> { <span class="dt">label</span><span class="op">:</span> index_lab<span class="op">,</span> <span class="dt">category</span><span class="op">:</span> <span class="st">"total"</span> }</span>
<span id="cb68-1430"><a href="#cb68-1430" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb68-1431"><a href="#cb68-1431" aria-hidden="true" tabindex="-1"></a>    <span class="dt">Vulnerability</span><span class="op">:</span> {</span>
<span id="cb68-1432"><a href="#cb68-1432" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Gender</span><span class="op">:</span> { <span class="dt">label</span><span class="op">:</span> index_lab<span class="op">,</span> <span class="dt">category</span><span class="op">:</span> <span class="st">"index"</span> }<span class="op">,</span></span>
<span id="cb68-1433"><a href="#cb68-1433" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Education</span><span class="op">:</span> { <span class="dt">label</span><span class="op">:</span> yr_lab<span class="op">,</span> <span class="dt">category</span><span class="op">:</span> <span class="st">"total"</span> }<span class="op">,</span></span>
<span id="cb68-1434"><a href="#cb68-1434" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Poverty</span><span class="op">:</span> { <span class="dt">label</span><span class="op">:</span> <span class="st">"%"</span><span class="op">,</span> <span class="dt">category</span><span class="op">:</span> <span class="st">"percent"</span> }</span>
<span id="cb68-1435"><a href="#cb68-1435" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb68-1436"><a href="#cb68-1436" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb68-1437"><a href="#cb68-1437" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-68" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb69" data-startfrom="1441" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1440"><span id="cb69-1441"><a href="#cb69-1441" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`## Download Helpers`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-69" data-nodetype="expression"></div></div></div><style>.atlas_button{text-decoration:none!important;background:#fff;border:1px solid #000;padding:10px 20px}</style><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb70" data-startfrom="1459" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1458"><span id="cb70-1459"><a href="#cb70-1459" aria-hidden="true" tabindex="-1"></a>download_button_initiate <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb70-1460"><a href="#cb70-1460" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> button <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;a class=atlas_button&gt;</span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">download</span><span class="op">.</span><span class="at">button</span><span class="op">.</span><span class="at">prepare</span>)<span class="sc">}</span><span class="vs">&lt;/a&gt;`</span><span class="op">;</span></span>
<span id="cb70-1461"><a href="#cb70-1461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1462"><a href="#cb70-1462" aria-hidden="true" tabindex="-1"></a>  button<span class="op">.</span><span class="at">onclick</span> <span class="op">=</span> <span class="kw">async</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb70-1463"><a href="#cb70-1463" aria-hidden="true" tabindex="-1"></a>    <span class="bu">document</span><span class="op">.</span><span class="at">body</span><span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">cursor</span> <span class="op">=</span> <span class="st">"wait"</span><span class="op">;</span></span>
<span id="cb70-1464"><a href="#cb70-1464" aria-hidden="true" tabindex="-1"></a>    button<span class="op">.</span><span class="at">textContent</span> <span class="op">=</span> <span class="st">"Loading..."</span><span class="op">;</span></span>
<span id="cb70-1465"><a href="#cb70-1465" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> utc_date <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span>()<span class="op">.</span><span class="fu">toISOString</span>()<span class="op">;</span></span>
<span id="cb70-1466"><a href="#cb70-1466" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> dateregex <span class="op">=</span> <span class="ss">/</span><span class="sc">^(\d{4})</span><span class="ss">-</span><span class="sc">(\d{2})</span><span class="ss">-</span><span class="sc">(\d{2})</span><span class="ss">/</span><span class="op">;</span></span>
<span id="cb70-1467"><a href="#cb70-1467" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> yyyymmdd <span class="op">=</span> utc_date<span class="op">.</span><span class="fu">match</span>(dateregex)[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb70-1468"><a href="#cb70-1468" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> file_name <span class="op">=</span> <span class="st">"adaptation-atlas_"</span> <span class="op">+</span> atlas_cat <span class="op">+</span> <span class="st">"_"</span> <span class="op">+</span> yyyymmdd<span class="op">;</span></span>
<span id="cb70-1469"><a href="#cb70-1469" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> file_ext <span class="op">=</span> download_format<span class="op">.</span><span class="fu">toLowerCase</span>()<span class="op">;</span></span>
<span id="cb70-1470"><a href="#cb70-1470" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> full_name <span class="op">=</span> file_name <span class="op">+</span> <span class="st">"."</span> <span class="op">+</span> file_ext<span class="op">;</span></span>
<span id="cb70-1471"><a href="#cb70-1471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1472"><a href="#cb70-1472" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> downloadBlob<span class="op">;</span></span>
<span id="cb70-1473"><a href="#cb70-1473" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (download_format <span class="op">===</span> <span class="st">"Parquet"</span> <span class="op">||</span> download_format <span class="op">===</span> <span class="st">"CSV"</span>) {</span>
<span id="cb70-1474"><a href="#cb70-1474" aria-hidden="true" tabindex="-1"></a>      downloadBlob <span class="op">=</span> <span class="cf">await</span> <span class="fu">downloadTabular</span>(</span>
<span id="cb70-1475"><a href="#cb70-1475" aria-hidden="true" tabindex="-1"></a>        file_name<span class="op">,</span></span>
<span id="cb70-1476"><a href="#cb70-1476" aria-hidden="true" tabindex="-1"></a>        file_ext<span class="op">,</span></span>
<span id="cb70-1477"><a href="#cb70-1477" aria-hidden="true" tabindex="-1"></a>        db<span class="op">,</span></span>
<span id="cb70-1478"><a href="#cb70-1478" aria-hidden="true" tabindex="-1"></a>        download_format<span class="op">,</span></span>
<span id="cb70-1479"><a href="#cb70-1479" aria-hidden="true" tabindex="-1"></a>        full_name<span class="op">,</span></span>
<span id="cb70-1480"><a href="#cb70-1480" aria-hidden="true" tabindex="-1"></a>      )<span class="op">;</span></span>
<span id="cb70-1481"><a href="#cb70-1481" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (download_format <span class="op">===</span> <span class="st">"JSON"</span>) {</span>
<span id="cb70-1482"><a href="#cb70-1482" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> cleanJSON <span class="op">=</span> <span class="cf">await</span> NbData[<span class="st">"explore_data"</span>]<span class="op">.</span><span class="fu">map</span>((row) <span class="kw">=&gt;</span></span>
<span id="cb70-1483"><a href="#cb70-1483" aria-hidden="true" tabindex="-1"></a>        <span class="bu">Object</span><span class="op">.</span><span class="fu">fromEntries</span>(row)<span class="op">,</span></span>
<span id="cb70-1484"><a href="#cb70-1484" aria-hidden="true" tabindex="-1"></a>      )<span class="op">;</span> <span class="co">// not a totally valid json, needs fixing.</span></span>
<span id="cb70-1485"><a href="#cb70-1485" aria-hidden="true" tabindex="-1"></a>      downloadBlob <span class="op">=</span> <span class="kw">new</span> <span class="bu">Blob</span>([NbData[<span class="st">"explore_data"</span>]]<span class="op">,</span> {</span>
<span id="cb70-1486"><a href="#cb70-1486" aria-hidden="true" tabindex="-1"></a>        <span class="dt">type</span><span class="op">:</span> <span class="st">"application/json"</span><span class="op">,</span></span>
<span id="cb70-1487"><a href="#cb70-1487" aria-hidden="true" tabindex="-1"></a>      })<span class="op">;</span></span>
<span id="cb70-1488"><a href="#cb70-1488" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb70-1489"><a href="#cb70-1489" aria-hidden="true" tabindex="-1"></a>    <span class="co">// const size = (downloadBlob.size / 1000000).toFixed(0);</span></span>
<span id="cb70-1490"><a href="#cb70-1490" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> url <span class="op">=</span> URL<span class="op">.</span><span class="fu">createObjectURL</span>(downloadBlob)<span class="op">;</span></span>
<span id="cb70-1491"><a href="#cb70-1491" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> downloadButton <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;a href="</span><span class="sc">${</span>url<span class="sc">}</span><span class="vs">" download="</span><span class="sc">${</span>full_name<span class="sc">}</span><span class="vs">" target="_blank" class="atlas_button"&gt;</span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">download</span><span class="op">.</span><span class="at">button</span><span class="op">.</span><span class="at">download</span>)<span class="sc">}</span><span class="vs"> </span><span class="sc">${</span>download_format<span class="sc">}</span><span class="vs"> &lt;/a&gt;`</span><span class="op">;</span> <span class="co">//(~${size} mb)</span></span>
<span id="cb70-1492"><a href="#cb70-1492" aria-hidden="true" tabindex="-1"></a>    button<span class="op">.</span><span class="fu">replaceWith</span>(downloadButton)<span class="op">;</span></span>
<span id="cb70-1493"><a href="#cb70-1493" aria-hidden="true" tabindex="-1"></a>    <span class="bu">document</span><span class="op">.</span><span class="at">body</span><span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">cursor</span> <span class="op">=</span> <span class="st">"default"</span><span class="op">;</span></span>
<span id="cb70-1494"><a href="#cb70-1494" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb70-1495"><a href="#cb70-1495" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> button<span class="op">;</span></span>
<span id="cb70-1496"><a href="#cb70-1496" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-70" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb71" data-startfrom="1500" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1499"><span id="cb71-1500"><a href="#cb71-1500" aria-hidden="true" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">downloadTabular</span>(</span>
<span id="cb71-1501"><a href="#cb71-1501" aria-hidden="true" tabindex="-1"></a>  file_name<span class="op">,</span></span>
<span id="cb71-1502"><a href="#cb71-1502" aria-hidden="true" tabindex="-1"></a>  file_ext<span class="op">,</span></span>
<span id="cb71-1503"><a href="#cb71-1503" aria-hidden="true" tabindex="-1"></a>  db<span class="op">,</span></span>
<span id="cb71-1504"><a href="#cb71-1504" aria-hidden="true" tabindex="-1"></a>  download_format<span class="op">,</span></span>
<span id="cb71-1505"><a href="#cb71-1505" aria-hidden="true" tabindex="-1"></a>  full_name<span class="op">,</span></span>
<span id="cb71-1506"><a href="#cb71-1506" aria-hidden="true" tabindex="-1"></a>) {</span>
<span id="cb71-1507"><a href="#cb71-1507" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> regex <span class="op">=</span> <span class="kw">new</span> <span class="bu">RegExp</span>(<span class="vs">`</span><span class="sc">${</span>file_name<span class="sc">}\\</span><span class="vs">.</span><span class="sc">${</span>file_ext<span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span></span>
<span id="cb71-1508"><a href="#cb71-1508" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> db_connect <span class="op">=</span> <span class="cf">await</span> db<span class="op">.</span><span class="at">_db</span><span class="op">;</span></span>
<span id="cb71-1509"><a href="#cb71-1509" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> files <span class="op">=</span> <span class="cf">await</span> db_connect<span class="op">.</span><span class="fu">globFiles</span>(<span class="st">"/tmp/*"</span> <span class="op">+</span> <span class="st">"."</span> <span class="op">+</span> file_ext)<span class="op">;</span></span>
<span id="cb71-1510"><a href="#cb71-1510" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> file <span class="op">=</span> files<span class="op">.</span><span class="fu">find</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">fileName</span><span class="op">.</span><span class="fu">match</span>(regex))<span class="op">;</span></span>
<span id="cb71-1511"><a href="#cb71-1511" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (files<span class="op">.</span><span class="at">length</span> <span class="op">===</span> <span class="dv">0</span> <span class="op">||</span> file <span class="op">===</span> <span class="kw">undefined</span>) {</span>
<span id="cb71-1512"><a href="#cb71-1512" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (download_format <span class="op">===</span> <span class="st">"PARQUET"</span>) {</span>
<span id="cb71-1513"><a href="#cb71-1513" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> copied <span class="op">=</span> <span class="cf">await</span> db<span class="op">.</span><span class="fu">query</span>(</span>
<span id="cb71-1514"><a href="#cb71-1514" aria-hidden="true" tabindex="-1"></a>        <span class="vs">`COPY (</span><span class="sc">${</span>all_data_query<span class="sc">}</span><span class="vs">) to '/tmp/</span><span class="sc">${</span>full_name<span class="sc">}</span><span class="vs">' (FORMAT 'PARQUET', COMPRESSION 'snappy')`</span><span class="op">,</span></span>
<span id="cb71-1515"><a href="#cb71-1515" aria-hidden="true" tabindex="-1"></a>      )<span class="op">;</span></span>
<span id="cb71-1516"><a href="#cb71-1516" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb71-1517"><a href="#cb71-1517" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> copied <span class="op">=</span> <span class="cf">await</span> db<span class="op">.</span><span class="fu">query</span>(</span>
<span id="cb71-1518"><a href="#cb71-1518" aria-hidden="true" tabindex="-1"></a>        <span class="vs">`COPY (</span><span class="sc">${</span>all_data_query<span class="sc">}</span><span class="vs">) to '/tmp/</span><span class="sc">${</span>full_name<span class="sc">}</span><span class="vs">' (FORMAT 'CSV', HEADER, DELIMITER ',')`</span><span class="op">,</span></span>
<span id="cb71-1519"><a href="#cb71-1519" aria-hidden="true" tabindex="-1"></a>      )<span class="op">;</span></span>
<span id="cb71-1520"><a href="#cb71-1520" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb71-1521"><a href="#cb71-1521" aria-hidden="true" tabindex="-1"></a>    files <span class="op">=</span> <span class="cf">await</span> db_connect<span class="op">.</span><span class="fu">globFiles</span>(<span class="st">"/tmp/*"</span> <span class="op">+</span> <span class="st">"."</span> <span class="op">+</span> file_ext)<span class="op">;</span></span>
<span id="cb71-1522"><a href="#cb71-1522" aria-hidden="true" tabindex="-1"></a>    file <span class="op">=</span> files<span class="op">.</span><span class="fu">find</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">fileName</span><span class="op">.</span><span class="fu">match</span>(regex))<span class="op">;</span></span>
<span id="cb71-1523"><a href="#cb71-1523" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb71-1524"><a href="#cb71-1524" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> app_type <span class="op">=</span></span>
<span id="cb71-1525"><a href="#cb71-1525" aria-hidden="true" tabindex="-1"></a>    download_format <span class="op">===</span> <span class="st">"PARQUET"</span> <span class="op">?</span> <span class="st">"application/octet-stream"</span> <span class="op">:</span> <span class="st">"text/csv"</span><span class="op">;</span></span>
<span id="cb71-1526"><a href="#cb71-1526" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> buffer <span class="op">=</span> <span class="cf">await</span> db_connect<span class="op">.</span><span class="fu">copyFileToBuffer</span>(file<span class="op">.</span><span class="at">fileName</span>)<span class="op">;</span></span>
<span id="cb71-1527"><a href="#cb71-1527" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> downloadData <span class="op">=</span> <span class="kw">new</span> <span class="bu">Blob</span>([buffer]<span class="op">,</span> {</span>
<span id="cb71-1528"><a href="#cb71-1528" aria-hidden="true" tabindex="-1"></a>    <span class="dt">type</span><span class="op">:</span> app_type<span class="op">,</span></span>
<span id="cb71-1529"><a href="#cb71-1529" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb71-1530"><a href="#cb71-1530" aria-hidden="true" tabindex="-1"></a>  db_connect<span class="op">.</span><span class="fu">dropFile</span>(<span class="vs">`/tmp/</span><span class="sc">${</span>full_name<span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span></span>
<span id="cb71-1531"><a href="#cb71-1531" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> downloadData<span class="op">;</span></span>
<span id="cb71-1532"><a href="#cb71-1532" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-71" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb72" data-startfrom="1536" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1535"><span id="cb72-1536"><a href="#cb72-1536" aria-hidden="true" tabindex="-1"></a><span class="kw">async</span> <span class="kw">function</span> <span class="fu">downloadSpatial</span>(</span>
<span id="cb72-1537"><a href="#cb72-1537" aria-hidden="true" tabindex="-1"></a>  <span class="co">// The issue with this one is that it needs to be long format somehow...</span></span>
<span id="cb72-1538"><a href="#cb72-1538" aria-hidden="true" tabindex="-1"></a>  file_name<span class="op">,</span></span>
<span id="cb72-1539"><a href="#cb72-1539" aria-hidden="true" tabindex="-1"></a>  file_ext<span class="op">,</span></span>
<span id="cb72-1540"><a href="#cb72-1540" aria-hidden="true" tabindex="-1"></a>  download_format<span class="op">,</span></span>
<span id="cb72-1541"><a href="#cb72-1541" aria-hidden="true" tabindex="-1"></a>  full_name<span class="op">,</span></span>
<span id="cb72-1542"><a href="#cb72-1542" aria-hidden="true" tabindex="-1"></a>) {</span>
<span id="cb72-1543"><a href="#cb72-1543" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (download_format <span class="op">===</span> <span class="st">"PARQUET"</span>) {</span>
<span id="cb72-1544"><a href="#cb72-1544" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb72-1545"><a href="#cb72-1545" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-72" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb73" data-startfrom="1549" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1548"><span id="cb73-1549"><a href="#cb73-1549" aria-hidden="true" tabindex="-1"></a>download_spatial_button <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb73-1550"><a href="#cb73-1550" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> adm_level <span class="op">=</span> admin_aggregationLevel<span class="op">.</span><span class="fu">match</span>(<span class="ss">/</span><span class="sc">\d+</span><span class="ss">/</span>)[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb73-1551"><a href="#cb73-1551" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> downloadBlob <span class="op">=</span> <span class="kw">new</span> <span class="bu">Blob</span>([<span class="bu">JSON</span><span class="op">.</span><span class="fu">stringify</span>(adminLevel_spatial)]<span class="op">,</span> {</span>
<span id="cb73-1552"><a href="#cb73-1552" aria-hidden="true" tabindex="-1"></a>    <span class="dt">type</span><span class="op">:</span> <span class="st">"application/geo+json"</span><span class="op">,</span></span>
<span id="cb73-1553"><a href="#cb73-1553" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb73-1554"><a href="#cb73-1554" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> size <span class="op">=</span> (downloadBlob<span class="op">.</span><span class="at">size</span> <span class="op">/</span> <span class="dv">1000000</span>)<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb73-1555"><a href="#cb73-1555" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> url <span class="op">=</span> URL<span class="op">.</span><span class="fu">createObjectURL</span>(downloadBlob)<span class="op">;</span></span>
<span id="cb73-1556"><a href="#cb73-1556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1557"><a href="#cb73-1557" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> button_template <span class="op">=</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">download</span><span class="op">.</span><span class="at">boundaries</span><span class="op">.</span><span class="at">button</span>)<span class="op">;</span></span>
<span id="cb73-1558"><a href="#cb73-1558" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> btn_txt <span class="op">=</span> Lang<span class="op">.</span><span class="fu">reduceReplaceTemplateItems</span>(button_template<span class="op">,</span> [</span>
<span id="cb73-1559"><a href="#cb73-1559" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">name</span><span class="op">:</span> <span class="st">"adminLvl"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> adm_level }<span class="op">,</span></span>
<span id="cb73-1560"><a href="#cb73-1560" aria-hidden="true" tabindex="-1"></a>  ])<span class="op">;</span></span>
<span id="cb73-1561"><a href="#cb73-1561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1562"><a href="#cb73-1562" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> downloadButton <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;a href="</span><span class="sc">${</span>url<span class="sc">}</span><span class="vs">" download="Atlas-boundaries_admin</span><span class="sc">${</span>adm_level<span class="sc">}</span><span class="vs">.json" target="_blank" class=atlas_button&gt;</span><span class="sc">${</span>btn_txt<span class="sc">}</span><span class="vs">&lt;/a&gt;`</span><span class="op">;</span></span>
<span id="cb73-1563"><a href="#cb73-1563" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> downloadButton<span class="op">;</span></span>
<span id="cb73-1564"><a href="#cb73-1564" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-73" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb74" data-startfrom="1568" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1567"><span id="cb74-1568"><a href="#cb74-1568" aria-hidden="true" tabindex="-1"></a>download_metadata_button <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb74-1569"><a href="#cb74-1569" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> downloadBlob <span class="op">=</span> <span class="kw">new</span> <span class="bu">Blob</span>([<span class="st">","</span>]<span class="op">,</span> {</span>
<span id="cb74-1570"><a href="#cb74-1570" aria-hidden="true" tabindex="-1"></a>    <span class="dt">type</span><span class="op">:</span> <span class="st">"text/csv"</span><span class="op">,</span></span>
<span id="cb74-1571"><a href="#cb74-1571" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb74-1572"><a href="#cb74-1572" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> size <span class="op">=</span> (downloadBlob<span class="op">.</span><span class="at">size</span> <span class="op">/</span> <span class="dv">1000000</span>)<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb74-1573"><a href="#cb74-1573" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> url <span class="op">=</span> URL<span class="op">.</span><span class="fu">createObjectURL</span>(downloadBlob)<span class="op">;</span></span>
<span id="cb74-1574"><a href="#cb74-1574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-1575"><a href="#cb74-1575" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> downloadButton <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;a href="</span><span class="sc">${</span>url<span class="sc">}</span><span class="vs">" download="AdaptationAtlas_metadata.csv" target="_blank" style="background: grey; color: white; padding: 10px 20px; border-radius: 50px; text-decoration: none;"&gt;Download Metadata&lt;/a&gt;`</span><span class="op">;</span></span>
<span id="cb74-1576"><a href="#cb74-1576" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> downloadButton<span class="op">;</span></span>
<span id="cb74-1577"><a href="#cb74-1577" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-74" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb75" data-startfrom="1581" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1580"><span id="cb75-1581"><a href="#cb75-1581" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`## Geography`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-75" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb76" data-startfrom="1585" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1584"><span id="cb76-1585"><a href="#cb76-1585" aria-hidden="true" tabindex="-1"></a>adminLevel_spatial <span class="op">=</span> {</span>
<span id="cb76-1586"><a href="#cb76-1586" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> admFeatures<span class="op">;</span></span>
<span id="cb76-1587"><a href="#cb76-1587" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (country <span class="op">===</span> <span class="st">"SSA"</span>) {</span>
<span id="cb76-1588"><a href="#cb76-1588" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (admin_aggregationLevel <span class="op">===</span> <span class="st">"admin0_name"</span>) {</span>
<span id="cb76-1589"><a href="#cb76-1589" aria-hidden="true" tabindex="-1"></a>      admFeatures <span class="op">=</span> admin0_load<span class="op">;</span></span>
<span id="cb76-1590"><a href="#cb76-1590" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (admin_aggregationLevel <span class="op">===</span> <span class="st">"admin1_name"</span>) {</span>
<span id="cb76-1591"><a href="#cb76-1591" aria-hidden="true" tabindex="-1"></a>      admFeatures <span class="op">=</span> admin1<span class="op">;</span></span>
<span id="cb76-1592"><a href="#cb76-1592" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (admin_aggregationLevel <span class="op">===</span> <span class="st">"admin2_name"</span>) {</span>
<span id="cb76-1593"><a href="#cb76-1593" aria-hidden="true" tabindex="-1"></a>      admFeatures <span class="op">=</span> admin2<span class="op">;</span></span>
<span id="cb76-1594"><a href="#cb76-1594" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb76-1595"><a href="#cb76-1595" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (country <span class="op">!==</span> <span class="st">"SSA"</span> <span class="op">&amp;&amp;</span> admin1_sel <span class="op">===</span> <span class="st">"Full Country"</span>) {</span>
<span id="cb76-1596"><a href="#cb76-1596" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (admin_aggregationLevel <span class="op">===</span> <span class="st">"admin0_name"</span>) {</span>
<span id="cb76-1597"><a href="#cb76-1597" aria-hidden="true" tabindex="-1"></a>      admFeatures <span class="op">=</span> admin0_load<span class="op">;</span></span>
<span id="cb76-1598"><a href="#cb76-1598" aria-hidden="true" tabindex="-1"></a>      <span class="co">// let filtered = admin0_load.features.filter(</span></span>
<span id="cb76-1599"><a href="#cb76-1599" aria-hidden="true" tabindex="-1"></a>      <span class="co">//   (d) =&gt; d.properties.admin0_name === country</span></span>
<span id="cb76-1600"><a href="#cb76-1600" aria-hidden="true" tabindex="-1"></a>      <span class="co">// );</span></span>
<span id="cb76-1601"><a href="#cb76-1601" aria-hidden="true" tabindex="-1"></a>      <span class="co">// // Create a new GeoJSON object with the filtered features</span></span>
<span id="cb76-1602"><a href="#cb76-1602" aria-hidden="true" tabindex="-1"></a>      <span class="co">// admFeatures = {</span></span>
<span id="cb76-1603"><a href="#cb76-1603" aria-hidden="true" tabindex="-1"></a>      <span class="co">//   type: admin0_filtered.type,</span></span>
<span id="cb76-1604"><a href="#cb76-1604" aria-hidden="true" tabindex="-1"></a>      <span class="co">//   features: filtered</span></span>
<span id="cb76-1605"><a href="#cb76-1605" aria-hidden="true" tabindex="-1"></a>      <span class="co">// };</span></span>
<span id="cb76-1606"><a href="#cb76-1606" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (admin_aggregationLevel <span class="op">===</span> <span class="st">"admin1_name"</span>) {</span>
<span id="cb76-1607"><a href="#cb76-1607" aria-hidden="true" tabindex="-1"></a>      admFeatures <span class="op">=</span> admin1<span class="op">;</span></span>
<span id="cb76-1608"><a href="#cb76-1608" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (admin_aggregationLevel <span class="op">===</span> <span class="st">"admin2_name"</span>) {</span>
<span id="cb76-1609"><a href="#cb76-1609" aria-hidden="true" tabindex="-1"></a>      admFeatures <span class="op">=</span> admin2<span class="op">;</span></span>
<span id="cb76-1610"><a href="#cb76-1610" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb76-1611"><a href="#cb76-1611" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (country <span class="op">!==</span> <span class="st">"SSA"</span> <span class="op">&amp;&amp;</span> admin1_sel <span class="op">!==</span> <span class="st">"Full Country"</span>) {</span>
<span id="cb76-1612"><a href="#cb76-1612" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (admin_aggregationLevel <span class="op">===</span> <span class="st">"admin1_name"</span>) {</span>
<span id="cb76-1613"><a href="#cb76-1613" aria-hidden="true" tabindex="-1"></a>      admFeatures <span class="op">=</span> admin1<span class="op">;</span></span>
<span id="cb76-1614"><a href="#cb76-1614" aria-hidden="true" tabindex="-1"></a>      <span class="co">// let filtered = admin1.features.filter(</span></span>
<span id="cb76-1615"><a href="#cb76-1615" aria-hidden="true" tabindex="-1"></a>      <span class="co">//   (d) =&gt; d.properties.admin1_name === admin1_sel</span></span>
<span id="cb76-1616"><a href="#cb76-1616" aria-hidden="true" tabindex="-1"></a>      <span class="co">// );</span></span>
<span id="cb76-1617"><a href="#cb76-1617" aria-hidden="true" tabindex="-1"></a>      <span class="co">// // Create a new GeoJSON object with the filtered features</span></span>
<span id="cb76-1618"><a href="#cb76-1618" aria-hidden="true" tabindex="-1"></a>      <span class="co">// admFeatures = {</span></span>
<span id="cb76-1619"><a href="#cb76-1619" aria-hidden="true" tabindex="-1"></a>      <span class="co">//   type: admin1.type,</span></span>
<span id="cb76-1620"><a href="#cb76-1620" aria-hidden="true" tabindex="-1"></a>      <span class="co">//   features: filtered</span></span>
<span id="cb76-1621"><a href="#cb76-1621" aria-hidden="true" tabindex="-1"></a>      <span class="co">// };</span></span>
<span id="cb76-1622"><a href="#cb76-1622" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (admin_aggregationLevel <span class="op">===</span> <span class="st">"admin2_name"</span>) {</span>
<span id="cb76-1623"><a href="#cb76-1623" aria-hidden="true" tabindex="-1"></a>      admFeatures <span class="op">=</span> admin2<span class="op">;</span></span>
<span id="cb76-1624"><a href="#cb76-1624" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb76-1625"><a href="#cb76-1625" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb76-1626"><a href="#cb76-1626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-1627"><a href="#cb76-1627" aria-hidden="true" tabindex="-1"></a>  admFeatures<span class="op">.</span><span class="at">features</span><span class="op">.</span><span class="fu">forEach</span>((d) <span class="kw">=&gt;</span> {</span>
<span id="cb76-1628"><a href="#cb76-1628" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> data <span class="op">=</span> admin_index</span>
<span id="cb76-1629"><a href="#cb76-1629" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">get</span>(d<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">admin0_name</span> <span class="op">||</span> <span class="kw">null</span>)</span>
<span id="cb76-1630"><a href="#cb76-1630" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">get</span>(d<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">admin1_name</span> <span class="op">||</span> <span class="kw">null</span>)</span>
<span id="cb76-1631"><a href="#cb76-1631" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">get</span>(d<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">admin2_name</span> <span class="op">||</span> <span class="kw">null</span>)<span class="op">;</span></span>
<span id="cb76-1632"><a href="#cb76-1632" aria-hidden="true" tabindex="-1"></a>    d<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">value</span> <span class="op">=</span> data[<span class="st">"value"</span>]<span class="op">;</span></span>
<span id="cb76-1633"><a href="#cb76-1633" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb76-1634"><a href="#cb76-1634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-1635"><a href="#cb76-1635" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   admFeatures.features.forEach((d) =&gt; {</span></span>
<span id="cb76-1636"><a href="#cb76-1636" aria-hidden="true" tabindex="-1"></a>  <span class="co">//     const a2_data = index</span></span>
<span id="cb76-1637"><a href="#cb76-1637" aria-hidden="true" tabindex="-1"></a>  <span class="co">//       .get(d.properties.admin0_name)</span></span>
<span id="cb76-1638"><a href="#cb76-1638" aria-hidden="true" tabindex="-1"></a>  <span class="co">//       .get(d.properties.admin1_name)</span></span>
<span id="cb76-1639"><a href="#cb76-1639" aria-hidden="true" tabindex="-1"></a>  <span class="co">//       .get(d.properties.admin2_name);</span></span>
<span id="cb76-1640"><a href="#cb76-1640" aria-hidden="true" tabindex="-1"></a>  <span class="co">//     d.properties.value = a2_data["value"];</span></span>
<span id="cb76-1641"><a href="#cb76-1641" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   });</span></span>
<span id="cb76-1642"><a href="#cb76-1642" aria-hidden="true" tabindex="-1"></a>  <span class="co">// }</span></span>
<span id="cb76-1643"><a href="#cb76-1643" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> admFeatures<span class="op">;</span> <span class="co">// Will return either the updated features or undefined if 'country' is not "SSA"</span></span>
<span id="cb76-1644"><a href="#cb76-1644" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-76" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb77" data-startfrom="1648" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1647"><span id="cb77-1648"><a href="#cb77-1648" aria-hidden="true" tabindex="-1"></a>admin0_load <span class="op">=</span> { </span>
<span id="cb77-1649"><a href="#cb77-1649" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Admin 2 is a geojson so that initial page load can be faster(not wait for DB setup)</span></span>
<span id="cb77-1650"><a href="#cb77-1650" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> geojson <span class="op">=</span> <span class="cf">await</span> <span class="fu">FileAttachment</span>(</span>
<span id="cb77-1651"><a href="#cb77-1651" aria-hidden="true" tabindex="-1"></a>    <span class="st">"atlas-region_admin0_simplified.geojson"</span></span>
<span id="cb77-1652"><a href="#cb77-1652" aria-hidden="true" tabindex="-1"></a>  )<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span>
<span id="cb77-1653"><a href="#cb77-1653" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> a0_names <span class="op">=</span> geojson<span class="op">.</span><span class="at">features</span><span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">admin0_name</span>)<span class="op">;</span></span>
<span id="cb77-1654"><a href="#cb77-1654" aria-hidden="true" tabindex="-1"></a>  mutable admin0_names <span class="op">=</span> [<span class="st">"SSA"</span>]<span class="op">.</span><span class="fu">concat</span>(a0_names)<span class="op">;</span></span>
<span id="cb77-1655"><a href="#cb77-1655" aria-hidden="true" tabindex="-1"></a>  <span class="co">// if (country !== "SSA") {</span></span>
<span id="cb77-1656"><a href="#cb77-1656" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   let filtered = geojson.features.filter(</span></span>
<span id="cb77-1657"><a href="#cb77-1657" aria-hidden="true" tabindex="-1"></a>  <span class="co">//     (d) =&gt; d.properties.admin0_name === country</span></span>
<span id="cb77-1658"><a href="#cb77-1658" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   );</span></span>
<span id="cb77-1659"><a href="#cb77-1659" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   geojson.features = filtered;</span></span>
<span id="cb77-1660"><a href="#cb77-1660" aria-hidden="true" tabindex="-1"></a>  <span class="co">// } else {</span></span>
<span id="cb77-1661"><a href="#cb77-1661" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   return geojson;</span></span>
<span id="cb77-1662"><a href="#cb77-1662" aria-hidden="true" tabindex="-1"></a>  <span class="co">// }</span></span>
<span id="cb77-1663"><a href="#cb77-1663" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> geojson<span class="op">;</span></span>
<span id="cb77-1664"><a href="#cb77-1664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-1665"><a href="#cb77-1665" aria-hidden="true" tabindex="-1"></a>  <span class="co">// let response = await db.query(`</span></span>
<span id="cb77-1666"><a href="#cb77-1666" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   SELECT *</span></span>
<span id="cb77-1667"><a href="#cb77-1667" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   FROM admin0_geom`);</span></span>
<span id="cb77-1668"><a href="#cb77-1668" aria-hidden="true" tabindex="-1"></a>  <span class="co">// let a0_names = response.map((d) =&gt; d.admin0_name);</span></span>
<span id="cb77-1669"><a href="#cb77-1669" aria-hidden="true" tabindex="-1"></a>  <span class="co">// mutable admin0_names = ["SSA"].concat(a0_names);</span></span>
<span id="cb77-1670"><a href="#cb77-1670" aria-hidden="true" tabindex="-1"></a>  <span class="co">// let wkb_list = response.map((d) =&gt; d.geometry);</span></span>
<span id="cb77-1671"><a href="#cb77-1671" aria-hidden="true" tabindex="-1"></a>  <span class="co">// let data = await response.map(({ geometry, ...rest }) =&gt; rest);</span></span>
<span id="cb77-1672"><a href="#cb77-1672" aria-hidden="true" tabindex="-1"></a>  <span class="co">// const features = [];</span></span>
<span id="cb77-1673"><a href="#cb77-1673" aria-hidden="true" tabindex="-1"></a>  <span class="co">// for (let i = 0; i &lt; wkb_list.length; i++) {</span></span>
<span id="cb77-1674"><a href="#cb77-1674" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   const pointer = GEOS.geosGeomFromWKB(wkb_list[i]);</span></span>
<span id="cb77-1675"><a href="#cb77-1675" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   const geojson = await GEOS.geosGeomToGeojson(pointer, GEOS.geos);</span></span>
<span id="cb77-1676"><a href="#cb77-1676" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   geojson.coordinates.forEach((polygon) =&gt; {</span></span>
<span id="cb77-1677"><a href="#cb77-1677" aria-hidden="true" tabindex="-1"></a>  <span class="co">//     polygon.forEach((ring) =&gt; {</span></span>
<span id="cb77-1678"><a href="#cb77-1678" aria-hidden="true" tabindex="-1"></a>  <span class="co">//       ring.reverse();</span></span>
<span id="cb77-1679"><a href="#cb77-1679" aria-hidden="true" tabindex="-1"></a>  <span class="co">//     });</span></span>
<span id="cb77-1680"><a href="#cb77-1680" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   });</span></span>
<span id="cb77-1681"><a href="#cb77-1681" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   const feature = {</span></span>
<span id="cb77-1682"><a href="#cb77-1682" aria-hidden="true" tabindex="-1"></a>  <span class="co">//     type: "Feature",</span></span>
<span id="cb77-1683"><a href="#cb77-1683" aria-hidden="true" tabindex="-1"></a>  <span class="co">//     geometry: geojson,</span></span>
<span id="cb77-1684"><a href="#cb77-1684" aria-hidden="true" tabindex="-1"></a>  <span class="co">//     properties: data[i]</span></span>
<span id="cb77-1685"><a href="#cb77-1685" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   };</span></span>
<span id="cb77-1686"><a href="#cb77-1686" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   features.push(feature);</span></span>
<span id="cb77-1687"><a href="#cb77-1687" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   GEOS.geos.GEOSGeom_destroy(pointer);</span></span>
<span id="cb77-1688"><a href="#cb77-1688" aria-hidden="true" tabindex="-1"></a>  <span class="co">// }</span></span>
<span id="cb77-1689"><a href="#cb77-1689" aria-hidden="true" tabindex="-1"></a>  <span class="co">// const geojson = {</span></span>
<span id="cb77-1690"><a href="#cb77-1690" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   type: "FeatureCollection",</span></span>
<span id="cb77-1691"><a href="#cb77-1691" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   features: features</span></span>
<span id="cb77-1692"><a href="#cb77-1692" aria-hidden="true" tabindex="-1"></a>  <span class="co">// };</span></span>
<span id="cb77-1693"><a href="#cb77-1693" aria-hidden="true" tabindex="-1"></a>  <span class="co">// return { names: ["SSA"].concat(a0_names), GEOJSON: geojson };</span></span>
<span id="cb77-1694"><a href="#cb77-1694" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-77" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb78" data-startfrom="1698" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1697"><span id="cb78-1698"><a href="#cb78-1698" aria-hidden="true" tabindex="-1"></a>admin0_filtered <span class="op">=</span> {</span>
<span id="cb78-1699"><a href="#cb78-1699" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (country <span class="op">!==</span> <span class="st">"SSA"</span>) {</span>
<span id="cb78-1700"><a href="#cb78-1700" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> filtered <span class="op">=</span> admin0_load<span class="op">.</span><span class="at">features</span><span class="op">.</span><span class="fu">filter</span>((d) <span class="kw">=&gt;</span> {</span>
<span id="cb78-1701"><a href="#cb78-1701" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> d<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">admin0_name</span> <span class="op">===</span> country<span class="op">;</span></span>
<span id="cb78-1702"><a href="#cb78-1702" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb78-1703"><a href="#cb78-1703" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Create a new GeoJSON object with the filtered features</span></span>
<span id="cb78-1704"><a href="#cb78-1704" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {</span>
<span id="cb78-1705"><a href="#cb78-1705" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> admin0_load<span class="op">.</span><span class="at">type</span><span class="op">,</span></span>
<span id="cb78-1706"><a href="#cb78-1706" aria-hidden="true" tabindex="-1"></a>      <span class="dt">features</span><span class="op">:</span> filtered</span>
<span id="cb78-1707"><a href="#cb78-1707" aria-hidden="true" tabindex="-1"></a>    }<span class="op">;</span></span>
<span id="cb78-1708"><a href="#cb78-1708" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb78-1709"><a href="#cb78-1709" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> admin0_load<span class="op">;</span></span>
<span id="cb78-1710"><a href="#cb78-1710" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb78-1711"><a href="#cb78-1711" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-78" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb79" data-startfrom="1715" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1714"><span id="cb79-1715"><a href="#cb79-1715" aria-hidden="true" tabindex="-1"></a>admin1 <span class="op">=</span> {</span>
<span id="cb79-1716"><a href="#cb79-1716" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> admin1_query<span class="op">;</span></span>
<span id="cb79-1717"><a href="#cb79-1717" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (country <span class="op">===</span> <span class="st">"SSA"</span> <span class="op">&amp;&amp;</span> admin_aggregationLevel <span class="op">===</span> <span class="st">"admin1_name"</span>) {</span>
<span id="cb79-1718"><a href="#cb79-1718" aria-hidden="true" tabindex="-1"></a>    admin1_query <span class="op">=</span> <span class="vs">``</span><span class="op">;</span></span>
<span id="cb79-1719"><a href="#cb79-1719" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (</span>
<span id="cb79-1720"><a href="#cb79-1720" aria-hidden="true" tabindex="-1"></a>    admin_aggregationLevel <span class="op">===</span> <span class="st">"admin1_name"</span> <span class="op">||</span></span>
<span id="cb79-1721"><a href="#cb79-1721" aria-hidden="true" tabindex="-1"></a>    admin_aggregationLevel <span class="op">===</span> <span class="st">"admin2_name"</span></span>
<span id="cb79-1722"><a href="#cb79-1722" aria-hidden="true" tabindex="-1"></a>  ) {</span>
<span id="cb79-1723"><a href="#cb79-1723" aria-hidden="true" tabindex="-1"></a>    admin1_query <span class="op">=</span> <span class="vs">`WHERE admin0_name = '</span><span class="sc">${</span>country<span class="sc">}</span><span class="vs">'`</span><span class="op">;</span></span>
<span id="cb79-1724"><a href="#cb79-1724" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb79-1725"><a href="#cb79-1725" aria-hidden="true" tabindex="-1"></a>    admin1_query <span class="op">=</span> <span class="vs">`WHERE admin1_name = ''`</span><span class="op">;</span> <span class="co">// This will always return empty, so response will be empty geojson</span></span>
<span id="cb79-1726"><a href="#cb79-1726" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb79-1727"><a href="#cb79-1727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1728"><a href="#cb79-1728" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> response <span class="op">=</span> <span class="cf">await</span> geo_db<span class="op">.</span><span class="fu">query</span>(<span class="vs">`</span></span>
<span id="cb79-1729"><a href="#cb79-1729" aria-hidden="true" tabindex="-1"></a><span class="vs">    SELECT *</span></span>
<span id="cb79-1730"><a href="#cb79-1730" aria-hidden="true" tabindex="-1"></a><span class="vs">    FROM admin1_geom</span></span>
<span id="cb79-1731"><a href="#cb79-1731" aria-hidden="true" tabindex="-1"></a><span class="vs">    </span><span class="sc">${</span>admin1_query<span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span></span>
<span id="cb79-1732"><a href="#cb79-1732" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> a1_names <span class="op">=</span> response<span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">admin1_name</span>)<span class="op">;</span></span>
<span id="cb79-1733"><a href="#cb79-1733" aria-hidden="true" tabindex="-1"></a>  mutable admin1_names <span class="op">=</span> [<span class="st">"Full Country"</span>]<span class="op">.</span><span class="fu">concat</span>(a1_names)<span class="op">;</span></span>
<span id="cb79-1734"><a href="#cb79-1734" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> wkb_list <span class="op">=</span> response<span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">geometry</span>)<span class="op">;</span></span>
<span id="cb79-1735"><a href="#cb79-1735" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> data <span class="op">=</span> <span class="cf">await</span> response<span class="op">.</span><span class="fu">map</span>(({ geometry<span class="op">,</span> <span class="op">...</span>rest }) <span class="kw">=&gt;</span> rest)<span class="op">;</span></span>
<span id="cb79-1736"><a href="#cb79-1736" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> features <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb79-1737"><a href="#cb79-1737" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> wkb_list<span class="op">.</span><span class="at">length</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb79-1738"><a href="#cb79-1738" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> pointer <span class="op">=</span> GEOS<span class="op">.</span><span class="fu">geosGeomFromWKB</span>(wkb_list[i])<span class="op">;</span></span>
<span id="cb79-1739"><a href="#cb79-1739" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> geojson <span class="op">=</span> <span class="cf">await</span> GEOS<span class="op">.</span><span class="fu">geosGeomToGeojson</span>(pointer<span class="op">,</span> GEOS<span class="op">.</span><span class="at">geos</span>)<span class="op">;</span></span>
<span id="cb79-1740"><a href="#cb79-1740" aria-hidden="true" tabindex="-1"></a>    geojson <span class="op">=</span> <span class="fu">turfRewind</span>(geojson<span class="op">,</span> { <span class="dt">reverse</span><span class="op">:</span> <span class="kw">true</span> })<span class="op">;</span></span>
<span id="cb79-1741"><a href="#cb79-1741" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> feature <span class="op">=</span> {</span>
<span id="cb79-1742"><a href="#cb79-1742" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">"Feature"</span><span class="op">,</span></span>
<span id="cb79-1743"><a href="#cb79-1743" aria-hidden="true" tabindex="-1"></a>      <span class="dt">geometry</span><span class="op">:</span> geojson<span class="op">,</span></span>
<span id="cb79-1744"><a href="#cb79-1744" aria-hidden="true" tabindex="-1"></a>      <span class="dt">properties</span><span class="op">:</span> data[i]</span>
<span id="cb79-1745"><a href="#cb79-1745" aria-hidden="true" tabindex="-1"></a>    }<span class="op">;</span></span>
<span id="cb79-1746"><a href="#cb79-1746" aria-hidden="true" tabindex="-1"></a>    features<span class="op">.</span><span class="fu">push</span>(feature)<span class="op">;</span></span>
<span id="cb79-1747"><a href="#cb79-1747" aria-hidden="true" tabindex="-1"></a>    GEOS<span class="op">.</span><span class="at">geos</span><span class="op">.</span><span class="fu">GEOSGeom_destroy</span>(pointer)<span class="op">;</span></span>
<span id="cb79-1748"><a href="#cb79-1748" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb79-1749"><a href="#cb79-1749" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> geojson <span class="op">=</span> {</span>
<span id="cb79-1750"><a href="#cb79-1750" aria-hidden="true" tabindex="-1"></a>    <span class="dt">type</span><span class="op">:</span> <span class="st">"FeatureCollection"</span><span class="op">,</span></span>
<span id="cb79-1751"><a href="#cb79-1751" aria-hidden="true" tabindex="-1"></a>    <span class="dt">features</span><span class="op">:</span> features</span>
<span id="cb79-1752"><a href="#cb79-1752" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb79-1753"><a href="#cb79-1753" aria-hidden="true" tabindex="-1"></a>  <span class="co">// return { names: ["Full Country"].concat(a1_names), GEOJSON: geojson };</span></span>
<span id="cb79-1754"><a href="#cb79-1754" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> geojson<span class="op">;</span></span>
<span id="cb79-1755"><a href="#cb79-1755" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-79" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb80" data-startfrom="1759" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1758"><span id="cb80-1759"><a href="#cb80-1759" aria-hidden="true" tabindex="-1"></a>admin2 <span class="op">=</span> {</span>
<span id="cb80-1760"><a href="#cb80-1760" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> admin2_query<span class="op">;</span></span>
<span id="cb80-1761"><a href="#cb80-1761" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (admin2_sel <span class="op">!==</span> <span class="st">"Full Region"</span>) {</span>
<span id="cb80-1762"><a href="#cb80-1762" aria-hidden="true" tabindex="-1"></a>    admin2_query <span class="op">=</span> <span class="vs">`WHERE admin0_name = '</span><span class="sc">${</span>country<span class="sc">}</span><span class="vs">' and admin1_name = '</span><span class="sc">${</span>admin1_sel<span class="sc">}</span><span class="vs">'`</span><span class="op">;</span> <span class="co">// and admin2_name = '${admin2_sel}'</span></span>
<span id="cb80-1763"><a href="#cb80-1763" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (</span>
<span id="cb80-1764"><a href="#cb80-1764" aria-hidden="true" tabindex="-1"></a>    admin2_sel <span class="op">===</span> <span class="st">"Full Region"</span> <span class="op">&amp;&amp;</span></span>
<span id="cb80-1765"><a href="#cb80-1765" aria-hidden="true" tabindex="-1"></a>    admin1_sel <span class="op">!==</span> <span class="st">"Full Country"</span> <span class="op">&amp;&amp;</span></span>
<span id="cb80-1766"><a href="#cb80-1766" aria-hidden="true" tabindex="-1"></a>    admin_aggregationLevel <span class="op">===</span> <span class="st">"admin2_name"</span></span>
<span id="cb80-1767"><a href="#cb80-1767" aria-hidden="true" tabindex="-1"></a>  ) {</span>
<span id="cb80-1768"><a href="#cb80-1768" aria-hidden="true" tabindex="-1"></a>    admin2_query <span class="op">=</span> <span class="vs">`WHERE admin0_name = '</span><span class="sc">${</span>country<span class="sc">}</span><span class="vs">' and admin1_name = '</span><span class="sc">${</span>admin1_sel<span class="sc">}</span><span class="vs">'`</span><span class="op">;</span></span>
<span id="cb80-1769"><a href="#cb80-1769" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (</span>
<span id="cb80-1770"><a href="#cb80-1770" aria-hidden="true" tabindex="-1"></a>    admin1_sel <span class="op">===</span> <span class="st">"Full Country"</span> <span class="op">&amp;&amp;</span></span>
<span id="cb80-1771"><a href="#cb80-1771" aria-hidden="true" tabindex="-1"></a>    country <span class="op">!==</span> <span class="st">"SSA"</span> <span class="op">&amp;&amp;</span></span>
<span id="cb80-1772"><a href="#cb80-1772" aria-hidden="true" tabindex="-1"></a>    admin_aggregationLevel <span class="op">===</span> <span class="st">"admin2_name"</span></span>
<span id="cb80-1773"><a href="#cb80-1773" aria-hidden="true" tabindex="-1"></a>  ) {</span>
<span id="cb80-1774"><a href="#cb80-1774" aria-hidden="true" tabindex="-1"></a>    admin2_query <span class="op">=</span> <span class="vs">`WHERE admin0_name = '</span><span class="sc">${</span>country<span class="sc">}</span><span class="vs">'`</span><span class="op">;</span></span>
<span id="cb80-1775"><a href="#cb80-1775" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (country <span class="op">===</span> <span class="st">"SSA"</span> <span class="op">&amp;&amp;</span> admin_aggregationLevel <span class="op">===</span> <span class="st">"admin2_name"</span>) {</span>
<span id="cb80-1776"><a href="#cb80-1776" aria-hidden="true" tabindex="-1"></a>    admin2_query <span class="op">=</span> <span class="vs">``</span><span class="op">;</span></span>
<span id="cb80-1777"><a href="#cb80-1777" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb80-1778"><a href="#cb80-1778" aria-hidden="true" tabindex="-1"></a>    admin2_query <span class="op">=</span> <span class="vs">`where admin2_name = ''`</span><span class="op">;</span></span>
<span id="cb80-1779"><a href="#cb80-1779" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb80-1780"><a href="#cb80-1780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1781"><a href="#cb80-1781" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> response <span class="op">=</span> <span class="cf">await</span> geo_db<span class="op">.</span><span class="fu">query</span>(<span class="vs">`</span></span>
<span id="cb80-1782"><a href="#cb80-1782" aria-hidden="true" tabindex="-1"></a><span class="vs">    SELECT *</span></span>
<span id="cb80-1783"><a href="#cb80-1783" aria-hidden="true" tabindex="-1"></a><span class="vs">    FROM admin2_geom</span></span>
<span id="cb80-1784"><a href="#cb80-1784" aria-hidden="true" tabindex="-1"></a><span class="vs">    </span><span class="sc">${</span>admin2_query<span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span> <span class="co">// WHERE admin0_name = '${country}' AND admin1_name = '${admin1_sel}'`);</span></span>
<span id="cb80-1785"><a href="#cb80-1785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-1786"><a href="#cb80-1786" aria-hidden="true" tabindex="-1"></a>  <span class="co">//// THIS IS WHRE YOU ARE AT&gt;&gt;&gt;</span></span>
<span id="cb80-1787"><a href="#cb80-1787" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> wkb_list <span class="op">=</span> response<span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">geometry</span>)<span class="op">;</span></span>
<span id="cb80-1788"><a href="#cb80-1788" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> data <span class="op">=</span> <span class="cf">await</span> response<span class="op">.</span><span class="fu">map</span>(({ geometry<span class="op">,</span> <span class="op">...</span>rest }) <span class="kw">=&gt;</span> rest)<span class="op">;</span></span>
<span id="cb80-1789"><a href="#cb80-1789" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> features <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb80-1790"><a href="#cb80-1790" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> wkb_list<span class="op">.</span><span class="at">length</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb80-1791"><a href="#cb80-1791" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> pointer <span class="op">=</span> GEOS<span class="op">.</span><span class="fu">geosGeomFromWKB</span>(wkb_list[i])<span class="op">;</span></span>
<span id="cb80-1792"><a href="#cb80-1792" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> geojson <span class="op">=</span> <span class="cf">await</span> GEOS<span class="op">.</span><span class="fu">geosGeomToGeojson</span>(pointer<span class="op">,</span> GEOS<span class="op">.</span><span class="at">geos</span>)<span class="op">;</span></span>
<span id="cb80-1793"><a href="#cb80-1793" aria-hidden="true" tabindex="-1"></a>    geojson <span class="op">=</span> <span class="fu">turfRewind</span>(geojson<span class="op">,</span> { <span class="dt">reverse</span><span class="op">:</span> <span class="kw">true</span> })<span class="op">;</span></span>
<span id="cb80-1794"><a href="#cb80-1794" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> feature <span class="op">=</span> {</span>
<span id="cb80-1795"><a href="#cb80-1795" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">"Feature"</span><span class="op">,</span></span>
<span id="cb80-1796"><a href="#cb80-1796" aria-hidden="true" tabindex="-1"></a>      <span class="dt">geometry</span><span class="op">:</span> geojson<span class="op">,</span></span>
<span id="cb80-1797"><a href="#cb80-1797" aria-hidden="true" tabindex="-1"></a>      <span class="dt">properties</span><span class="op">:</span> data[i]</span>
<span id="cb80-1798"><a href="#cb80-1798" aria-hidden="true" tabindex="-1"></a>    }<span class="op">;</span></span>
<span id="cb80-1799"><a href="#cb80-1799" aria-hidden="true" tabindex="-1"></a>    features<span class="op">.</span><span class="fu">push</span>(feature)<span class="op">;</span></span>
<span id="cb80-1800"><a href="#cb80-1800" aria-hidden="true" tabindex="-1"></a>    GEOS<span class="op">.</span><span class="at">geos</span><span class="op">.</span><span class="fu">GEOSGeom_destroy</span>(pointer)<span class="op">;</span></span>
<span id="cb80-1801"><a href="#cb80-1801" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb80-1802"><a href="#cb80-1802" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> geojson <span class="op">=</span> {</span>
<span id="cb80-1803"><a href="#cb80-1803" aria-hidden="true" tabindex="-1"></a>    <span class="dt">type</span><span class="op">:</span> <span class="st">"FeatureCollection"</span><span class="op">,</span></span>
<span id="cb80-1804"><a href="#cb80-1804" aria-hidden="true" tabindex="-1"></a>    <span class="dt">features</span><span class="op">:</span> features</span>
<span id="cb80-1805"><a href="#cb80-1805" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb80-1806"><a href="#cb80-1806" aria-hidden="true" tabindex="-1"></a>  <span class="co">// return { names: ["Full Region"].concat(a2_names), GEOJSON: geojson };</span></span>
<span id="cb80-1807"><a href="#cb80-1807" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> geojson<span class="op">;</span></span>
<span id="cb80-1808"><a href="#cb80-1808" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-80" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb81" data-startfrom="1812" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1811"><span id="cb81-1812"><a href="#cb81-1812" aria-hidden="true" tabindex="-1"></a>append_a2Names <span class="op">=</span> {</span>
<span id="cb81-1813"><a href="#cb81-1813" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> response <span class="op">=</span> <span class="cf">await</span> geo_db<span class="op">.</span><span class="fu">query</span>(<span class="vs">`</span></span>
<span id="cb81-1814"><a href="#cb81-1814" aria-hidden="true" tabindex="-1"></a><span class="vs">    SELECT admin2_name</span></span>
<span id="cb81-1815"><a href="#cb81-1815" aria-hidden="true" tabindex="-1"></a><span class="vs">    FROM admin2_geom</span></span>
<span id="cb81-1816"><a href="#cb81-1816" aria-hidden="true" tabindex="-1"></a><span class="vs">    where admin0_name = '</span><span class="sc">${</span>country<span class="sc">}</span><span class="vs">' and admin1_name = '</span><span class="sc">${</span>admin1_sel<span class="sc">}</span><span class="vs">'`</span>)<span class="op">;</span> <span class="co">// WHERE admin0_name = '${country}' AND admin1_name = '${admin1_sel}'`);</span></span>
<span id="cb81-1817"><a href="#cb81-1817" aria-hidden="true" tabindex="-1"></a>  <span class="co">//// THIS IS WHRE YOU ARE AT&gt;&gt;&gt;</span></span>
<span id="cb81-1818"><a href="#cb81-1818" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> a2_names <span class="op">=</span> response<span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">admin2_name</span>)<span class="op">;</span></span>
<span id="cb81-1819"><a href="#cb81-1819" aria-hidden="true" tabindex="-1"></a>  mutable admin2_names <span class="op">=</span> [<span class="st">"Full Region"</span>]<span class="op">.</span><span class="fu">concat</span>(a2_names)<span class="op">;</span></span>
<span id="cb81-1820"><a href="#cb81-1820" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> a2_names<span class="op">;</span></span>
<span id="cb81-1821"><a href="#cb81-1821" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-81" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb82" data-startfrom="1825" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1824"><span id="cb82-1825"><a href="#cb82-1825" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`### Geography Selectors`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-82" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb83" data-startfrom="1829" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1828"><span id="cb83-1829"><a href="#cb83-1829" aria-hidden="true" tabindex="-1"></a>mutable admin0_names <span class="op">=</span> [<span class="st">"SSA"</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-83" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb84" data-startfrom="1833" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1832"><span id="cb84-1833"><a href="#cb84-1833" aria-hidden="true" tabindex="-1"></a>mutable admin1_names <span class="op">=</span> [<span class="st">"Full Country"</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-84" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb85" data-startfrom="1837" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1836"><span id="cb85-1837"><a href="#cb85-1837" aria-hidden="true" tabindex="-1"></a>mutable admin2_names <span class="op">=</span> [<span class="st">"Full Region"</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-85" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb86" data-startfrom="1841" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1840"><span id="cb86-1841"><a href="#cb86-1841" aria-hidden="true" tabindex="-1"></a>viewof country <span class="op">=</span> {</span>
<span id="cb86-1842"><a href="#cb86-1842" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> country <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">select</span>(admin0_names<span class="op">,</span> {</span>
<span id="cb86-1843"><a href="#cb86-1843" aria-hidden="true" tabindex="-1"></a>    <span class="dt">label</span><span class="op">:</span> <span class="st">"Select Country"</span></span>
<span id="cb86-1844"><a href="#cb86-1844" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb86-1845"><a href="#cb86-1845" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> country<span class="op">;</span></span>
<span id="cb86-1846"><a href="#cb86-1846" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-86" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb87" data-startfrom="1850" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1849"><span id="cb87-1850"><a href="#cb87-1850" aria-hidden="true" tabindex="-1"></a>viewof admin1_sel <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">select</span>(admin1_names<span class="op">,</span> { <span class="dt">label</span><span class="op">:</span> <span class="st">"admin1"</span> })</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-87" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb88" data-startfrom="1854" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1853"><span id="cb88-1854"><a href="#cb88-1854" aria-hidden="true" tabindex="-1"></a>viewof admin2_sel <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">select</span>(admin2_names<span class="op">,</span> { <span class="dt">label</span><span class="op">:</span> <span class="st">"admin2"</span> })</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-88" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb89" data-startfrom="1858" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1857"><span id="cb89-1858"><a href="#cb89-1858" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`## Selector Forms`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-89" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb90" data-startfrom="1862" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1861"><span id="cb90-1862"><a href="#cb90-1862" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`### Hazard`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-90" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb91" data-startfrom="1866" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1865"><span id="cb91-1866"><a href="#cb91-1866" aria-hidden="true" tabindex="-1"></a>viewof hazard_sel <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">select</span>(</span>
<span id="cb91-1867"><a href="#cb91-1867" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Inputs.select(</span></span>
<span id="cb91-1868"><a href="#cb91-1868" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   new Map(</span></span>
<span id="cb91-1869"><a href="#cb91-1869" aria-hidden="true" tabindex="-1"></a>  <span class="co">//     DataSelector_form.hazardGroup_form.hazard_sel.map((value) =&gt; [</span></span>
<span id="cb91-1870"><a href="#cb91-1870" aria-hidden="true" tabindex="-1"></a>  <span class="co">//       hazard_dict[value].name,</span></span>
<span id="cb91-1871"><a href="#cb91-1871" aria-hidden="true" tabindex="-1"></a>  <span class="co">//       value</span></span>
<span id="cb91-1872"><a href="#cb91-1872" aria-hidden="true" tabindex="-1"></a>  <span class="co">//     ])</span></span>
<span id="cb91-1873"><a href="#cb91-1873" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   ),</span></span>
<span id="cb91-1874"><a href="#cb91-1874" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   { label: "Hazard" }</span></span>
<span id="cb91-1875"><a href="#cb91-1875" aria-hidden="true" tabindex="-1"></a>  <span class="co">// ),</span></span>
<span id="cb91-1876"><a href="#cb91-1876" aria-hidden="true" tabindex="-1"></a>  <span class="kw">new</span> <span class="bu">Map</span>(<span class="bu">Object</span><span class="op">.</span><span class="fu">entries</span>(hazard_dict)<span class="op">.</span><span class="fu">map</span>(([key<span class="op">,</span> value]) <span class="kw">=&gt;</span> [value<span class="op">.</span><span class="at">name</span><span class="op">,</span> key]))<span class="op">,</span></span>
<span id="cb91-1877"><a href="#cb91-1877" aria-hidden="true" tabindex="-1"></a>  { <span class="dt">label</span><span class="op">:</span> <span class="st">"Hazard"</span> } <span class="co">//, format: ([name]) =&gt; `${name}`</span></span>
<span id="cb91-1878"><a href="#cb91-1878" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-91" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb92" data-startfrom="1882" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1881"><span id="cb92-1882"><a href="#cb92-1882" aria-hidden="true" tabindex="-1"></a>viewof time_sel <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">select</span>(</span>
<span id="cb92-1883"><a href="#cb92-1883" aria-hidden="true" tabindex="-1"></a>  <span class="kw">new</span> <span class="bu">Map</span>([</span>
<span id="cb92-1884"><a href="#cb92-1884" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"Baseline"</span><span class="op">,</span> <span class="st">"historic"</span>]<span class="op">,</span></span>
<span id="cb92-1885"><a href="#cb92-1885" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"2040"</span><span class="op">,</span> <span class="st">"2021_2040"</span>]<span class="op">,</span></span>
<span id="cb92-1886"><a href="#cb92-1886" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"2060"</span><span class="op">,</span> <span class="st">"2041_2060"</span>]</span>
<span id="cb92-1887"><a href="#cb92-1887" aria-hidden="true" tabindex="-1"></a>  ])<span class="op">,</span></span>
<span id="cb92-1888"><a href="#cb92-1888" aria-hidden="true" tabindex="-1"></a>  { <span class="dt">label</span><span class="op">:</span> <span class="st">"Time Period"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="st">"historic"</span> } <span class="co">//, format: ([name]) =&gt; `${name}`</span></span>
<span id="cb92-1889"><a href="#cb92-1889" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-92" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb93" data-startfrom="1893" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1892"><span id="cb93-1893"><a href="#cb93-1893" aria-hidden="true" tabindex="-1"></a>viewof ssp_sel <span class="op">=</span> {</span>
<span id="cb93-1894"><a href="#cb93-1894" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> choices <span class="op">=</span> time_sel <span class="op">===</span> <span class="st">"historic"</span> <span class="op">?</span> [<span class="st">"Historic"</span>] <span class="op">:</span> [<span class="st">"SSP245"</span><span class="op">,</span> <span class="st">"SSP585"</span>]<span class="op">;</span></span>
<span id="cb93-1895"><a href="#cb93-1895" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> Inputs<span class="op">.</span><span class="fu">select</span>(choices<span class="op">,</span> { <span class="dt">label</span><span class="op">:</span> <span class="st">"Scenario"</span> })<span class="op">;</span></span>
<span id="cb93-1896"><a href="#cb93-1896" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-93" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb94" data-startfrom="1900" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1899"><span id="cb94-1900"><a href="#cb94-1900" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`### Adaptive Capacity`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-94" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb95" data-startfrom="1904" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1903"><span id="cb95-1904"><a href="#cb95-1904" aria-hidden="true" tabindex="-1"></a>viewof ac_cat <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">select</span>([<span class="st">"Education"</span><span class="op">,</span> <span class="st">"Poverty"</span><span class="op">,</span> <span class="st">"Gender"</span>]<span class="op">,</span> {</span>
<span id="cb95-1905"><a href="#cb95-1905" aria-hidden="true" tabindex="-1"></a>  <span class="co">// value: "Poverty",</span></span>
<span id="cb95-1906"><a href="#cb95-1906" aria-hidden="true" tabindex="-1"></a>  <span class="dt">label</span><span class="op">:</span> <span class="st">"Adaptive Capacity"</span></span>
<span id="cb95-1907"><a href="#cb95-1907" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-95" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb96" data-startfrom="1911" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1910"><span id="cb96-1911"><a href="#cb96-1911" aria-hidden="true" tabindex="-1"></a>viewof ac_subcat <span class="op">=</span> {</span>
<span id="cb96-1912"><a href="#cb96-1912" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> subcats<span class="op">;</span></span>
<span id="cb96-1913"><a href="#cb96-1913" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (ac_cat <span class="op">===</span> <span class="st">"Gender"</span>) {</span>
<span id="cb96-1914"><a href="#cb96-1914" aria-hidden="true" tabindex="-1"></a>    subcats <span class="op">=</span> <span class="kw">new</span> <span class="bu">Map</span>(</span>
<span id="cb96-1915"><a href="#cb96-1915" aria-hidden="true" tabindex="-1"></a>      <span class="bu">Object</span><span class="op">.</span><span class="fu">entries</span>(vulnerability_dict[<span class="st">"gender"</span>])<span class="op">.</span><span class="fu">map</span>(([key<span class="op">,</span> value]) <span class="kw">=&gt;</span> [</span>
<span id="cb96-1916"><a href="#cb96-1916" aria-hidden="true" tabindex="-1"></a>        value<span class="op">,</span></span>
<span id="cb96-1917"><a href="#cb96-1917" aria-hidden="true" tabindex="-1"></a>        key</span>
<span id="cb96-1918"><a href="#cb96-1918" aria-hidden="true" tabindex="-1"></a>      ])</span>
<span id="cb96-1919"><a href="#cb96-1919" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb96-1920"><a href="#cb96-1920" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (ac_cat <span class="op">===</span> <span class="st">"Poverty"</span>) {</span>
<span id="cb96-1921"><a href="#cb96-1921" aria-hidden="true" tabindex="-1"></a>    subcats <span class="op">=</span> <span class="kw">new</span> <span class="bu">Map</span>(</span>
<span id="cb96-1922"><a href="#cb96-1922" aria-hidden="true" tabindex="-1"></a>      <span class="bu">Object</span><span class="op">.</span><span class="fu">entries</span>(vulnerability_dict[<span class="st">"poverty"</span>])<span class="op">.</span><span class="fu">map</span>(([key<span class="op">,</span> value]) <span class="kw">=&gt;</span> [</span>
<span id="cb96-1923"><a href="#cb96-1923" aria-hidden="true" tabindex="-1"></a>        value<span class="op">,</span></span>
<span id="cb96-1924"><a href="#cb96-1924" aria-hidden="true" tabindex="-1"></a>        key</span>
<span id="cb96-1925"><a href="#cb96-1925" aria-hidden="true" tabindex="-1"></a>      ])</span>
<span id="cb96-1926"><a href="#cb96-1926" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb96-1927"><a href="#cb96-1927" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb96-1928"><a href="#cb96-1928" aria-hidden="true" tabindex="-1"></a>    subcats <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb96-1929"><a href="#cb96-1929" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb96-1930"><a href="#cb96-1930" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> Inputs<span class="op">.</span><span class="fu">select</span>(subcats<span class="op">,</span> {</span>
<span id="cb96-1931"><a href="#cb96-1931" aria-hidden="true" tabindex="-1"></a>    <span class="dt">label</span><span class="op">:</span> <span class="vs">`</span><span class="sc">${</span>ac_cat<span class="sc">}</span><span class="vs"> Category`</span></span>
<span id="cb96-1932"><a href="#cb96-1932" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb96-1933"><a href="#cb96-1933" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-96" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb97" data-startfrom="1937" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1936"><span id="cb97-1937"><a href="#cb97-1937" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`## Exposure`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-97" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb98" data-startfrom="1941" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1940"><span id="cb98-1941"><a href="#cb98-1941" aria-hidden="true" tabindex="-1"></a>viewof exposure_cat <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">select</span>([<span class="st">"Crop"</span><span class="op">,</span> <span class="st">"Livestock"</span><span class="op">,</span> <span class="st">"Population"</span>]<span class="op">,</span> {</span>
<span id="cb98-1942"><a href="#cb98-1942" aria-hidden="true" tabindex="-1"></a>  <span class="dt">value</span><span class="op">:</span> <span class="st">"Crop"</span><span class="op">,</span></span>
<span id="cb98-1943"><a href="#cb98-1943" aria-hidden="true" tabindex="-1"></a>  <span class="dt">label</span><span class="op">:</span> <span class="st">"Exposure Category"</span></span>
<span id="cb98-1944"><a href="#cb98-1944" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-98" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb99" data-startfrom="1948" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1947"><span id="cb99-1948"><a href="#cb99-1948" aria-hidden="true" tabindex="-1"></a>commodities <span class="op">=</span> <span class="kw">new</span> <span class="bu">Object</span>({</span>
<span id="cb99-1949"><a href="#cb99-1949" aria-hidden="true" tabindex="-1"></a>  <span class="dt">Crop</span><span class="op">:</span> [</span>
<span id="cb99-1950"><a href="#cb99-1950" aria-hidden="true" tabindex="-1"></a>    <span class="st">"wheat"</span><span class="op">,</span></span>
<span id="cb99-1951"><a href="#cb99-1951" aria-hidden="true" tabindex="-1"></a>    <span class="st">"rice"</span><span class="op">,</span></span>
<span id="cb99-1952"><a href="#cb99-1952" aria-hidden="true" tabindex="-1"></a>    <span class="st">"maize"</span><span class="op">,</span></span>
<span id="cb99-1953"><a href="#cb99-1953" aria-hidden="true" tabindex="-1"></a>    <span class="st">"barley"</span><span class="op">,</span></span>
<span id="cb99-1954"><a href="#cb99-1954" aria-hidden="true" tabindex="-1"></a>    <span class="st">"pearl millet"</span><span class="op">,</span></span>
<span id="cb99-1955"><a href="#cb99-1955" aria-hidden="true" tabindex="-1"></a>    <span class="st">"small millet"</span><span class="op">,</span></span>
<span id="cb99-1956"><a href="#cb99-1956" aria-hidden="true" tabindex="-1"></a>    <span class="st">"sorghum"</span><span class="op">,</span></span>
<span id="cb99-1957"><a href="#cb99-1957" aria-hidden="true" tabindex="-1"></a>    <span class="st">"potato"</span><span class="op">,</span></span>
<span id="cb99-1958"><a href="#cb99-1958" aria-hidden="true" tabindex="-1"></a>    <span class="st">"sweet potato"</span><span class="op">,</span></span>
<span id="cb99-1959"><a href="#cb99-1959" aria-hidden="true" tabindex="-1"></a>    <span class="st">"yams"</span><span class="op">,</span></span>
<span id="cb99-1960"><a href="#cb99-1960" aria-hidden="true" tabindex="-1"></a>    <span class="st">"cassava"</span><span class="op">,</span></span>
<span id="cb99-1961"><a href="#cb99-1961" aria-hidden="true" tabindex="-1"></a>    <span class="st">"bean"</span><span class="op">,</span></span>
<span id="cb99-1962"><a href="#cb99-1962" aria-hidden="true" tabindex="-1"></a>    <span class="st">"chickpea"</span><span class="op">,</span></span>
<span id="cb99-1963"><a href="#cb99-1963" aria-hidden="true" tabindex="-1"></a>    <span class="st">"cowpea"</span><span class="op">,</span></span>
<span id="cb99-1964"><a href="#cb99-1964" aria-hidden="true" tabindex="-1"></a>    <span class="st">"pigeonpea"</span><span class="op">,</span></span>
<span id="cb99-1965"><a href="#cb99-1965" aria-hidden="true" tabindex="-1"></a>    <span class="st">"lentil"</span><span class="op">,</span></span>
<span id="cb99-1966"><a href="#cb99-1966" aria-hidden="true" tabindex="-1"></a>    <span class="st">"soybean"</span><span class="op">,</span></span>
<span id="cb99-1967"><a href="#cb99-1967" aria-hidden="true" tabindex="-1"></a>    <span class="st">"groundnut"</span><span class="op">,</span></span>
<span id="cb99-1968"><a href="#cb99-1968" aria-hidden="true" tabindex="-1"></a>    <span class="st">"coconut"</span><span class="op">,</span></span>
<span id="cb99-1969"><a href="#cb99-1969" aria-hidden="true" tabindex="-1"></a>    <span class="st">"oilpalm"</span><span class="op">,</span></span>
<span id="cb99-1970"><a href="#cb99-1970" aria-hidden="true" tabindex="-1"></a>    <span class="st">"sunflower"</span><span class="op">,</span></span>
<span id="cb99-1971"><a href="#cb99-1971" aria-hidden="true" tabindex="-1"></a>    <span class="st">"rapeseed"</span><span class="op">,</span></span>
<span id="cb99-1972"><a href="#cb99-1972" aria-hidden="true" tabindex="-1"></a>    <span class="st">"sesameseed"</span><span class="op">,</span></span>
<span id="cb99-1973"><a href="#cb99-1973" aria-hidden="true" tabindex="-1"></a>    <span class="st">"sugarcane"</span><span class="op">,</span></span>
<span id="cb99-1974"><a href="#cb99-1974" aria-hidden="true" tabindex="-1"></a>    <span class="st">"sugarbeet"</span><span class="op">,</span></span>
<span id="cb99-1975"><a href="#cb99-1975" aria-hidden="true" tabindex="-1"></a>    <span class="st">"cotton"</span><span class="op">,</span></span>
<span id="cb99-1976"><a href="#cb99-1976" aria-hidden="true" tabindex="-1"></a>    <span class="st">"arabica coffee"</span><span class="op">,</span></span>
<span id="cb99-1977"><a href="#cb99-1977" aria-hidden="true" tabindex="-1"></a>    <span class="st">"robusta coffee"</span><span class="op">,</span></span>
<span id="cb99-1978"><a href="#cb99-1978" aria-hidden="true" tabindex="-1"></a>    <span class="st">"cocoa"</span><span class="op">,</span></span>
<span id="cb99-1979"><a href="#cb99-1979" aria-hidden="true" tabindex="-1"></a>    <span class="st">"tea"</span><span class="op">,</span></span>
<span id="cb99-1980"><a href="#cb99-1980" aria-hidden="true" tabindex="-1"></a>    <span class="st">"tobacco"</span><span class="op">,</span></span>
<span id="cb99-1981"><a href="#cb99-1981" aria-hidden="true" tabindex="-1"></a>    <span class="st">"banana"</span><span class="op">,</span></span>
<span id="cb99-1982"><a href="#cb99-1982" aria-hidden="true" tabindex="-1"></a>    <span class="st">"plantain"</span><span class="op">,</span></span>
<span id="cb99-1983"><a href="#cb99-1983" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">,</span></span>
<span id="cb99-1984"><a href="#cb99-1984" aria-hidden="true" tabindex="-1"></a>  <span class="dt">Livestock</span><span class="op">:</span> [</span>
<span id="cb99-1985"><a href="#cb99-1985" aria-hidden="true" tabindex="-1"></a>    <span class="st">"cattle_tropical"</span><span class="op">,</span></span>
<span id="cb99-1986"><a href="#cb99-1986" aria-hidden="true" tabindex="-1"></a>    <span class="st">"poultry_tropical"</span><span class="op">,</span></span>
<span id="cb99-1987"><a href="#cb99-1987" aria-hidden="true" tabindex="-1"></a>    <span class="st">"pigs_tropical"</span><span class="op">,</span></span>
<span id="cb99-1988"><a href="#cb99-1988" aria-hidden="true" tabindex="-1"></a>    <span class="st">"sheep_tropical"</span><span class="op">,</span></span>
<span id="cb99-1989"><a href="#cb99-1989" aria-hidden="true" tabindex="-1"></a>    <span class="st">"goats_tropical"</span><span class="op">,</span></span>
<span id="cb99-1990"><a href="#cb99-1990" aria-hidden="true" tabindex="-1"></a>    <span class="st">"cattle_highland"</span><span class="op">,</span></span>
<span id="cb99-1991"><a href="#cb99-1991" aria-hidden="true" tabindex="-1"></a>    <span class="st">"poultry_highland"</span><span class="op">,</span></span>
<span id="cb99-1992"><a href="#cb99-1992" aria-hidden="true" tabindex="-1"></a>    <span class="st">"pigs_highland"</span><span class="op">,</span></span>
<span id="cb99-1993"><a href="#cb99-1993" aria-hidden="true" tabindex="-1"></a>    <span class="st">"sheep_highland"</span><span class="op">,</span></span>
<span id="cb99-1994"><a href="#cb99-1994" aria-hidden="true" tabindex="-1"></a>    <span class="st">"goats_highland"</span><span class="op">,</span></span>
<span id="cb99-1995"><a href="#cb99-1995" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">,</span></span>
<span id="cb99-1996"><a href="#cb99-1996" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-99" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb100" data-startfrom="2000" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 1999"><span id="cb100-2000"><a href="#cb100-2000" aria-hidden="true" tabindex="-1"></a>viewof exposure_subCat <span class="op">=</span> {</span>
<span id="cb100-2001"><a href="#cb100-2001" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> title<span class="op">;</span></span>
<span id="cb100-2002"><a href="#cb100-2002" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> selections<span class="op">;</span></span>
<span id="cb100-2003"><a href="#cb100-2003" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (exposure_cat <span class="op">===</span> <span class="st">"Population"</span>) {</span>
<span id="cb100-2004"><a href="#cb100-2004" aria-hidden="true" tabindex="-1"></a>    title <span class="op">=</span> <span class="st">"Population Group"</span><span class="op">;</span></span>
<span id="cb100-2005"><a href="#cb100-2005" aria-hidden="true" tabindex="-1"></a>    selections <span class="op">=</span> <span class="kw">new</span> <span class="bu">Map</span>([</span>
<span id="cb100-2006"><a href="#cb100-2006" aria-hidden="true" tabindex="-1"></a>      [<span class="st">"Total Population"</span><span class="op">,</span> <span class="st">"total_pop"</span>]<span class="op">,</span></span>
<span id="cb100-2007"><a href="#cb100-2007" aria-hidden="true" tabindex="-1"></a>      [<span class="st">"Rural Population"</span><span class="op">,</span> <span class="st">"rural_pop"</span>]<span class="op">,</span></span>
<span id="cb100-2008"><a href="#cb100-2008" aria-hidden="true" tabindex="-1"></a>      [<span class="st">"Urban Population"</span><span class="op">,</span> <span class="st">"urban_pop"</span>]</span>
<span id="cb100-2009"><a href="#cb100-2009" aria-hidden="true" tabindex="-1"></a>    ])<span class="op">;</span></span>
<span id="cb100-2010"><a href="#cb100-2010" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb100-2011"><a href="#cb100-2011" aria-hidden="true" tabindex="-1"></a>    title <span class="op">=</span> <span class="st">"Commodity"</span><span class="op">;</span></span>
<span id="cb100-2012"><a href="#cb100-2012" aria-hidden="true" tabindex="-1"></a>    selections <span class="op">=</span> commodities[exposure_cat]<span class="op">;</span></span>
<span id="cb100-2013"><a href="#cb100-2013" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb100-2014"><a href="#cb100-2014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-2015"><a href="#cb100-2015" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> Inputs<span class="op">.</span><span class="fu">select</span>(selections<span class="op">,</span> {</span>
<span id="cb100-2016"><a href="#cb100-2016" aria-hidden="true" tabindex="-1"></a>    <span class="dt">label</span><span class="op">:</span> title</span>
<span id="cb100-2017"><a href="#cb100-2017" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb100-2018"><a href="#cb100-2018" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-100" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb101" data-startfrom="2022" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2021"><span id="cb101-2022"><a href="#cb101-2022" aria-hidden="true" tabindex="-1"></a>exposure_var_choices <span class="op">=</span> {</span>
<span id="cb101-2023"><a href="#cb101-2023" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> choices<span class="op">;</span></span>
<span id="cb101-2024"><a href="#cb101-2024" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (exposure_cat <span class="op">===</span> <span class="st">"Population"</span>) {</span>
<span id="cb101-2025"><a href="#cb101-2025" aria-hidden="true" tabindex="-1"></a>    choices <span class="op">=</span> [</span>
<span id="cb101-2026"><a href="#cb101-2026" aria-hidden="true" tabindex="-1"></a>      <span class="st">"total_pop"</span><span class="op">,</span></span>
<span id="cb101-2027"><a href="#cb101-2027" aria-hidden="true" tabindex="-1"></a>      <span class="st">"rural_pop"</span><span class="op">,</span></span>
<span id="cb101-2028"><a href="#cb101-2028" aria-hidden="true" tabindex="-1"></a>      <span class="st">"urban_pop"</span></span>
<span id="cb101-2029"><a href="#cb101-2029" aria-hidden="true" tabindex="-1"></a>      <span class="co">// { name: "Total Population", variable: "total_pop" },</span></span>
<span id="cb101-2030"><a href="#cb101-2030" aria-hidden="true" tabindex="-1"></a>      <span class="co">// { name: "Rural Population", variable: "rural_pop" },</span></span>
<span id="cb101-2031"><a href="#cb101-2031" aria-hidden="true" tabindex="-1"></a>      <span class="co">// { name: "Urban Population", variable: "urban_pop" }</span></span>
<span id="cb101-2032"><a href="#cb101-2032" aria-hidden="true" tabindex="-1"></a>    ]<span class="op">;</span> <span class="co">//add density to raster</span></span>
<span id="cb101-2033"><a href="#cb101-2033" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (exposure_cat <span class="op">===</span> <span class="st">"Crop"</span>) {</span>
<span id="cb101-2034"><a href="#cb101-2034" aria-hidden="true" tabindex="-1"></a>    choices <span class="op">=</span> [</span>
<span id="cb101-2035"><a href="#cb101-2035" aria-hidden="true" tabindex="-1"></a>      <span class="st">'vop'</span><span class="op">,</span></span>
<span id="cb101-2036"><a href="#cb101-2036" aria-hidden="true" tabindex="-1"></a>      <span class="st">'ha'</span></span>
<span id="cb101-2037"><a href="#cb101-2037" aria-hidden="true" tabindex="-1"></a>      <span class="co">// { name: "Value of Production", variable: "vop" },</span></span>
<span id="cb101-2038"><a href="#cb101-2038" aria-hidden="true" tabindex="-1"></a>      <span class="co">// { name: "Harvested Area", variable: "ha" }</span></span>
<span id="cb101-2039"><a href="#cb101-2039" aria-hidden="true" tabindex="-1"></a>    ]<span class="op">;</span></span>
<span id="cb101-2040"><a href="#cb101-2040" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb101-2041"><a href="#cb101-2041" aria-hidden="true" tabindex="-1"></a>    choices <span class="op">=</span> [</span>
<span id="cb101-2042"><a href="#cb101-2042" aria-hidden="true" tabindex="-1"></a>      <span class="st">'vop'</span><span class="op">,</span></span>
<span id="cb101-2043"><a href="#cb101-2043" aria-hidden="true" tabindex="-1"></a>      <span class="st">'number'</span></span>
<span id="cb101-2044"><a href="#cb101-2044" aria-hidden="true" tabindex="-1"></a>      <span class="co">// { name: "Value of Production", variable: "vop" },</span></span>
<span id="cb101-2045"><a href="#cb101-2045" aria-hidden="true" tabindex="-1"></a>      <span class="co">// { name: "Number of Animals", variable: "number" }</span></span>
<span id="cb101-2046"><a href="#cb101-2046" aria-hidden="true" tabindex="-1"></a>    ]<span class="op">;</span></span>
<span id="cb101-2047"><a href="#cb101-2047" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb101-2048"><a href="#cb101-2048" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> choices<span class="op">;</span></span>
<span id="cb101-2049"><a href="#cb101-2049" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-101" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb102" data-startfrom="2053" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2052"><span id="cb102-2053"><a href="#cb102-2053" aria-hidden="true" tabindex="-1"></a>viewof exposure_var <span class="op">=</span> {</span>
<span id="cb102-2054"><a href="#cb102-2054" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> Inputs<span class="op">.</span><span class="fu">select</span>(exposure_var_choices<span class="op">,</span> {</span>
<span id="cb102-2055"><a href="#cb102-2055" aria-hidden="true" tabindex="-1"></a>    <span class="dt">label</span><span class="op">:</span> <span class="st">"Variable"</span><span class="op">,</span></span>
<span id="cb102-2056"><a href="#cb102-2056" aria-hidden="true" tabindex="-1"></a>    <span class="dt">format</span><span class="op">:</span> (t) <span class="kw">=&gt;</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">ViewExplore</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">visualiseVars</span><span class="op">.</span><span class="at">exposure</span><span class="op">.</span><span class="at">exposureVariable</span><span class="op">.</span><span class="at">options</span>[t])</span>
<span id="cb102-2057"><a href="#cb102-2057" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb102-2058"><a href="#cb102-2058" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-102" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb103" data-startfrom="2062" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2061"><span id="cb103-2062"><a href="#cb103-2062" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`## Map Setup`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-103" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb104" data-startfrom="2066" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2065"><span id="cb104-2066"><a href="#cb104-2066" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`### D3 map`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-104" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb105" data-startfrom="2070" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2069"><span id="cb105-2070"><a href="#cb105-2070" aria-hidden="true" tabindex="-1"></a>map <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb105-2071"><a href="#cb105-2071" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> width <span class="op">=</span> <span class="dv">950</span><span class="op">;</span></span>
<span id="cb105-2072"><a href="#cb105-2072" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> height <span class="op">=</span> <span class="dv">600</span><span class="op">;</span></span>
<span id="cb105-2073"><a href="#cb105-2073" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-2074"><a href="#cb105-2074" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> minValue<span class="op">;</span></span>
<span id="cb105-2075"><a href="#cb105-2075" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> maxValue<span class="op">;</span></span>
<span id="cb105-2076"><a href="#cb105-2076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-2077"><a href="#cb105-2077" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (var_unit[<span class="st">"category"</span>] <span class="op">===</span> <span class="st">"index"</span>) {</span>
<span id="cb105-2078"><a href="#cb105-2078" aria-hidden="true" tabindex="-1"></a>    minValue <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb105-2079"><a href="#cb105-2079" aria-hidden="true" tabindex="-1"></a>    maxValue <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb105-2080"><a href="#cb105-2080" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb105-2081"><a href="#cb105-2081" aria-hidden="true" tabindex="-1"></a>    minValue <span class="op">=</span> d3<span class="op">.</span><span class="fu">min</span>(adminLevel_spatial<span class="op">.</span><span class="at">features</span><span class="op">,</span> (d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">value</span>)<span class="op">;</span></span>
<span id="cb105-2082"><a href="#cb105-2082" aria-hidden="true" tabindex="-1"></a>    maxValue <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(adminLevel_spatial<span class="op">.</span><span class="at">features</span><span class="op">,</span> (d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">value</span>)<span class="op">;</span></span>
<span id="cb105-2083"><a href="#cb105-2083" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb105-2084"><a href="#cb105-2084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-2085"><a href="#cb105-2085" aria-hidden="true" tabindex="-1"></a>  d3<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".mapTip"</span>)<span class="op">.</span><span class="fu">remove</span>()<span class="op">;</span></span>
<span id="cb105-2086"><a href="#cb105-2086" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> tooltip <span class="op">=</span> d3</span>
<span id="cb105-2087"><a href="#cb105-2087" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">select</span>(<span class="st">"body"</span>)</span>
<span id="cb105-2088"><a href="#cb105-2088" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"div"</span>)</span>
<span id="cb105-2089"><a href="#cb105-2089" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"plotTooltip mapTip"</span>)</span>
<span id="cb105-2090"><a href="#cb105-2090" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"position"</span><span class="op">,</span> <span class="st">"absolute"</span>)<span class="op">;</span></span>
<span id="cb105-2091"><a href="#cb105-2091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-2092"><a href="#cb105-2092" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> color<span class="op">;</span></span>
<span id="cb105-2093"><a href="#cb105-2093" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (atlas_cat <span class="op">===</span> <span class="st">"Hazard"</span>) {</span>
<span id="cb105-2094"><a href="#cb105-2094" aria-hidden="true" tabindex="-1"></a>    color <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleThreshold</span>(</span>
<span id="cb105-2095"><a href="#cb105-2095" aria-hidden="true" tabindex="-1"></a>      hazard_dict[hazard_sel][<span class="st">"thresholds"</span>]<span class="op">,</span></span>
<span id="cb105-2096"><a href="#cb105-2096" aria-hidden="true" tabindex="-1"></a>      hazard_dict[hazard_sel][<span class="st">"colours"</span>]<span class="op">,</span></span>
<span id="cb105-2097"><a href="#cb105-2097" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb105-2098"><a href="#cb105-2098" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (</span>
<span id="cb105-2099"><a href="#cb105-2099" aria-hidden="true" tabindex="-1"></a>    atlas_cat <span class="op">===</span> <span class="st">"Exposure"</span> <span class="op">&amp;&amp;</span></span>
<span id="cb105-2100"><a href="#cb105-2100" aria-hidden="true" tabindex="-1"></a>    (exposure_cat <span class="op">===</span> <span class="st">"Crop"</span> <span class="op">||</span> exposure_cat <span class="op">===</span> <span class="st">"Livestock"</span>)</span>
<span id="cb105-2101"><a href="#cb105-2101" aria-hidden="true" tabindex="-1"></a>  ) {</span>
<span id="cb105-2102"><a href="#cb105-2102" aria-hidden="true" tabindex="-1"></a>    color <span class="op">=</span> <span class="kw">function</span> (v) {</span>
<span id="cb105-2103"><a href="#cb105-2103" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> nonZero_min <span class="op">=</span> (minValue <span class="op">=</span> d3<span class="op">.</span><span class="fu">min</span>(adminLevel_spatial<span class="op">.</span><span class="at">features</span><span class="op">,</span> (d) <span class="kw">=&gt;</span></span>
<span id="cb105-2104"><a href="#cb105-2104" aria-hidden="true" tabindex="-1"></a>        d<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">value</span> <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">value</span> <span class="op">!==</span> <span class="dv">0</span></span>
<span id="cb105-2105"><a href="#cb105-2105" aria-hidden="true" tabindex="-1"></a>          <span class="op">?</span> d<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">value</span></span>
<span id="cb105-2106"><a href="#cb105-2106" aria-hidden="true" tabindex="-1"></a>          <span class="op">:</span> <span class="kw">Infinity</span><span class="op">,</span></span>
<span id="cb105-2107"><a href="#cb105-2107" aria-hidden="true" tabindex="-1"></a>      ))<span class="op">;</span></span>
<span id="cb105-2108"><a href="#cb105-2108" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> d3color <span class="op">=</span> d3</span>
<span id="cb105-2109"><a href="#cb105-2109" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">scaleLog</span>()</span>
<span id="cb105-2110"><a href="#cb105-2110" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">domain</span>([nonZero_min<span class="op">,</span> maxValue])</span>
<span id="cb105-2111"><a href="#cb105-2111" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">range</span>([<span class="st">"#F7D732"</span><span class="op">,</span> <span class="st">"#216729"</span>])<span class="op">;</span></span>
<span id="cb105-2112"><a href="#cb105-2112" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> v <span class="op">===</span> <span class="dv">0</span> <span class="op">?</span> <span class="st">"lightgrey"</span> <span class="op">:</span> <span class="fu">d3color</span>(v)<span class="op">;</span></span>
<span id="cb105-2113"><a href="#cb105-2113" aria-hidden="true" tabindex="-1"></a>    }<span class="op">;</span></span>
<span id="cb105-2114"><a href="#cb105-2114" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb105-2115"><a href="#cb105-2115" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Add a ability to flip color</span></span>
<span id="cb105-2116"><a href="#cb105-2116" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> color_hex <span class="op">=</span></span>
<span id="cb105-2117"><a href="#cb105-2117" aria-hidden="true" tabindex="-1"></a>      atlas_cat <span class="op">===</span> <span class="st">"Vulnerability"</span> <span class="op">&amp;&amp;</span> ac_cat <span class="op">===</span> <span class="st">"Poverty"</span></span>
<span id="cb105-2118"><a href="#cb105-2118" aria-hidden="true" tabindex="-1"></a>        <span class="op">?</span> [<span class="st">"#216729"</span><span class="op">,</span> <span class="st">"#F7D732"</span>]</span>
<span id="cb105-2119"><a href="#cb105-2119" aria-hidden="true" tabindex="-1"></a>        <span class="op">:</span> [<span class="st">"#F7D732"</span><span class="op">,</span> <span class="st">"#216729"</span>]<span class="op">;</span></span>
<span id="cb105-2120"><a href="#cb105-2120" aria-hidden="true" tabindex="-1"></a>    color <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()<span class="op">.</span><span class="fu">domain</span>([minValue<span class="op">,</span> maxValue])<span class="op">.</span><span class="fu">range</span>(color_hex)<span class="op">;</span></span>
<span id="cb105-2121"><a href="#cb105-2121" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb105-2122"><a href="#cb105-2122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-2123"><a href="#cb105-2123" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> projection <span class="op">=</span> d3</span>
<span id="cb105-2124"><a href="#cb105-2124" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">geoAzimuthalEqualArea</span>()</span>
<span id="cb105-2125"><a href="#cb105-2125" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">fitSize</span>([width<span class="op">,</span> <span class="dv">600</span>]<span class="op">,</span> adminLevel_spatial)<span class="op">;</span></span>
<span id="cb105-2126"><a href="#cb105-2126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-2127"><a href="#cb105-2127" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> path <span class="op">=</span> d3<span class="op">.</span><span class="fu">geoPath</span>(projection)<span class="op">;</span></span>
<span id="cb105-2128"><a href="#cb105-2128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-2129"><a href="#cb105-2129" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> padding <span class="op">=</span> <span class="dv">75</span><span class="op">;</span></span>
<span id="cb105-2130"><a href="#cb105-2130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-2131"><a href="#cb105-2131" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> svg <span class="op">=</span> d3</span>
<span id="cb105-2132"><a href="#cb105-2132" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">create</span>(<span class="st">"svg"</span>)</span>
<span id="cb105-2133"><a href="#cb105-2133" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> width <span class="op">+</span> <span class="dv">50</span>)</span>
<span id="cb105-2134"><a href="#cb105-2134" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"viewBox"</span><span class="op">,</span> [<span class="dv">0</span><span class="op">,</span> <span class="op">-</span>padding<span class="op">,</span> width<span class="op">,</span> <span class="dv">600</span> <span class="op">+</span> padding])</span>
<span id="cb105-2135"><a href="#cb105-2135" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"background"</span><span class="op">,</span> <span class="st">"lightblue"</span>) <span class="co">// set the background color</span></span>
<span id="cb105-2136"><a href="#cb105-2136" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"cursor"</span><span class="op">,</span> <span class="st">"grab"</span>)<span class="op">;</span></span>
<span id="cb105-2137"><a href="#cb105-2137" aria-hidden="true" tabindex="-1"></a>  <span class="co">// .style("border", "1px solid black");</span></span>
<span id="cb105-2138"><a href="#cb105-2138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-2139"><a href="#cb105-2139" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> map <span class="op">=</span> svg</span>
<span id="cb105-2140"><a href="#cb105-2140" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb105-2141"><a href="#cb105-2141" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"path"</span>)</span>
<span id="cb105-2142"><a href="#cb105-2142" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(adminLevel_spatial<span class="op">.</span><span class="at">features</span>)</span>
<span id="cb105-2143"><a href="#cb105-2143" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">join</span>(<span class="st">"path"</span>)</span>
<span id="cb105-2144"><a href="#cb105-2144" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> (d) <span class="kw">=&gt;</span> <span class="fu">color</span>(d<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">value</span>))</span>
<span id="cb105-2145"><a href="#cb105-2145" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"#fff"</span>)</span>
<span id="cb105-2146"><a href="#cb105-2146" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="st">"1"</span>)</span>
<span id="cb105-2147"><a href="#cb105-2147" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-linejoin"</span><span class="op">,</span> <span class="st">"round"</span>)</span>
<span id="cb105-2148"><a href="#cb105-2148" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"d"</span><span class="op">,</span> path)<span class="op">;</span></span>
<span id="cb105-2149"><a href="#cb105-2149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-2150"><a href="#cb105-2150" aria-hidden="true" tabindex="-1"></a>  map</span>
<span id="cb105-2151"><a href="#cb105-2151" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"mouseover"</span><span class="op">,</span> (<span class="bu">event</span><span class="op">,</span> d) <span class="kw">=&gt;</span> {</span>
<span id="cb105-2152"><a href="#cb105-2152" aria-hidden="true" tabindex="-1"></a>      d3<span class="op">.</span><span class="fu">select</span>(<span class="bu">event</span><span class="op">.</span><span class="at">currentTarget</span>)<span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"black"</span>)<span class="op">.</span><span class="fu">raise</span>()<span class="op">;</span></span>
<span id="cb105-2153"><a href="#cb105-2153" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb105-2154"><a href="#cb105-2154" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"mousemove"</span><span class="op">,</span> (<span class="bu">event</span><span class="op">,</span> d) <span class="kw">=&gt;</span> {</span>
<span id="cb105-2155"><a href="#cb105-2155" aria-hidden="true" tabindex="-1"></a>      tooltip</span>
<span id="cb105-2156"><a href="#cb105-2156" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"top"</span><span class="op">,</span> <span class="bu">event</span><span class="op">.</span><span class="at">pageY</span> <span class="op">-</span> <span class="dv">10</span> <span class="op">+</span> <span class="st">"px"</span>)</span>
<span id="cb105-2157"><a href="#cb105-2157" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"left"</span><span class="op">,</span> <span class="bu">event</span><span class="op">.</span><span class="at">pageX</span> <span class="op">+</span> <span class="dv">10</span> <span class="op">+</span> <span class="st">"px"</span>)</span>
<span id="cb105-2158"><a href="#cb105-2158" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"opacity"</span><span class="op">,</span> <span class="dv">1</span>)</span>
<span id="cb105-2159"><a href="#cb105-2159" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"display"</span><span class="op">,</span> <span class="st">"block"</span>)</span>
<span id="cb105-2160"><a href="#cb105-2160" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">html</span>(</span>
<span id="cb105-2161"><a href="#cb105-2161" aria-hidden="true" tabindex="-1"></a>          <span class="vs">`</span><span class="sc">${</span><span class="fu">make_tooltip_admin</span>(d<span class="op">.</span><span class="at">properties</span>)<span class="sc">}</span><span class="vs">&lt;br&gt;</span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">ViewExplore</span><span class="op">.</span><span class="at">exploreMap</span><span class="op">.</span><span class="at">value</span>)<span class="sc">}</span><span class="vs">: </span><span class="sc">${</span><span class="fu">format_val</span>(</span>
<span id="cb105-2162"><a href="#cb105-2162" aria-hidden="true" tabindex="-1"></a>            d<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">value</span><span class="op">,</span></span>
<span id="cb105-2163"><a href="#cb105-2163" aria-hidden="true" tabindex="-1"></a>            var_unit[<span class="st">"category"</span>]<span class="op">,</span></span>
<span id="cb105-2164"><a href="#cb105-2164" aria-hidden="true" tabindex="-1"></a>          )<span class="sc">}</span><span class="vs"> (</span><span class="sc">${</span>var_unit<span class="op">.</span><span class="at">label</span><span class="sc">}</span><span class="vs">)`</span><span class="op">,</span></span>
<span id="cb105-2165"><a href="#cb105-2165" aria-hidden="true" tabindex="-1"></a>        )<span class="op">;</span></span>
<span id="cb105-2166"><a href="#cb105-2166" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb105-2167"><a href="#cb105-2167" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"mouseout"</span><span class="op">,</span> <span class="kw">function</span> (<span class="bu">event</span>) {</span>
<span id="cb105-2168"><a href="#cb105-2168" aria-hidden="true" tabindex="-1"></a>      d3<span class="op">.</span><span class="fu">select</span>(<span class="st">".mapTip"</span>)<span class="op">.</span><span class="fu">style</span>(<span class="st">"display"</span><span class="op">,</span> <span class="st">"none"</span>)<span class="op">;</span></span>
<span id="cb105-2169"><a href="#cb105-2169" aria-hidden="true" tabindex="-1"></a>      d3<span class="op">.</span><span class="fu">select</span>(<span class="bu">event</span><span class="op">.</span><span class="at">currentTarget</span>)<span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"#fff"</span>)<span class="op">;</span></span>
<span id="cb105-2170"><a href="#cb105-2170" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb105-2171"><a href="#cb105-2171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-2172"><a href="#cb105-2172" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Section to add highlights for selected country when admin at limit</span></span>
<span id="cb105-2173"><a href="#cb105-2173" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> selectedArea<span class="op">;</span></span>
<span id="cb105-2174"><a href="#cb105-2174" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (admin_aggregationLevel <span class="op">===</span> <span class="st">"admin0_name"</span> <span class="op">&amp;&amp;</span> country <span class="op">!==</span> <span class="st">"SSA"</span>) {</span>
<span id="cb105-2175"><a href="#cb105-2175" aria-hidden="true" tabindex="-1"></a>    selectedArea <span class="op">=</span> adminLevel_spatial<span class="op">.</span><span class="at">features</span><span class="op">.</span><span class="fu">filter</span>(</span>
<span id="cb105-2176"><a href="#cb105-2176" aria-hidden="true" tabindex="-1"></a>      (d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">admin0_name</span> <span class="op">===</span> country<span class="op">,</span></span>
<span id="cb105-2177"><a href="#cb105-2177" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb105-2178"><a href="#cb105-2178" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (</span>
<span id="cb105-2179"><a href="#cb105-2179" aria-hidden="true" tabindex="-1"></a>    admin_aggregationLevel <span class="op">===</span> <span class="st">"admin1_name"</span> <span class="op">&amp;&amp;</span></span>
<span id="cb105-2180"><a href="#cb105-2180" aria-hidden="true" tabindex="-1"></a>    admin1_sel <span class="op">!==</span> <span class="st">"Full Country"</span></span>
<span id="cb105-2181"><a href="#cb105-2181" aria-hidden="true" tabindex="-1"></a>  ) {</span>
<span id="cb105-2182"><a href="#cb105-2182" aria-hidden="true" tabindex="-1"></a>    selectedArea <span class="op">=</span> adminLevel_spatial<span class="op">.</span><span class="at">features</span><span class="op">.</span><span class="fu">filter</span>(</span>
<span id="cb105-2183"><a href="#cb105-2183" aria-hidden="true" tabindex="-1"></a>      (d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">admin1_name</span> <span class="op">===</span> admin1_sel<span class="op">,</span></span>
<span id="cb105-2184"><a href="#cb105-2184" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb105-2185"><a href="#cb105-2185" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (admin2_sel <span class="op">!==</span> <span class="st">"Full Region"</span>) {</span>
<span id="cb105-2186"><a href="#cb105-2186" aria-hidden="true" tabindex="-1"></a>    selectedArea <span class="op">=</span> adminLevel_spatial<span class="op">.</span><span class="at">features</span><span class="op">.</span><span class="fu">filter</span>(</span>
<span id="cb105-2187"><a href="#cb105-2187" aria-hidden="true" tabindex="-1"></a>      (d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">admin2_name</span> <span class="op">===</span> admin2_sel<span class="op">,</span></span>
<span id="cb105-2188"><a href="#cb105-2188" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb105-2189"><a href="#cb105-2189" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb105-2190"><a href="#cb105-2190" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> outline<span class="op">;</span></span>
<span id="cb105-2191"><a href="#cb105-2191" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (selectedArea) {</span>
<span id="cb105-2192"><a href="#cb105-2192" aria-hidden="true" tabindex="-1"></a>    outline <span class="op">=</span> svg</span>
<span id="cb105-2193"><a href="#cb105-2193" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"path"</span>)</span>
<span id="cb105-2194"><a href="#cb105-2194" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(selectedArea)</span>
<span id="cb105-2195"><a href="#cb105-2195" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"none"</span>)</span>
<span id="cb105-2196"><a href="#cb105-2196" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"red"</span>)</span>
<span id="cb105-2197"><a href="#cb105-2197" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="st">"2"</span>)</span>
<span id="cb105-2198"><a href="#cb105-2198" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-linejoin"</span><span class="op">,</span> <span class="st">"round"</span>)</span>
<span id="cb105-2199"><a href="#cb105-2199" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"d"</span><span class="op">,</span> path)<span class="op">;</span></span>
<span id="cb105-2200"><a href="#cb105-2200" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb105-2201"><a href="#cb105-2201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-2202"><a href="#cb105-2202" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> legend_bg <span class="op">=</span> svg <span class="co">// add a white bg box for the legend so it doesn't overlap on zoom</span></span>
<span id="cb105-2203"><a href="#cb105-2203" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb105-2204"><a href="#cb105-2204" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"rect"</span>)</span>
<span id="cb105-2205"><a href="#cb105-2205" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> width)</span>
<span id="cb105-2206"><a href="#cb105-2206" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> <span class="dv">70</span>)</span>
<span id="cb105-2207"><a href="#cb105-2207" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> <span class="op">-</span><span class="dv">75</span>)</span>
<span id="cb105-2208"><a href="#cb105-2208" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"white"</span>)</span>
<span id="cb105-2209"><a href="#cb105-2209" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"opacity"</span><span class="op">,</span> <span class="fl">0.9</span>)<span class="op">;</span></span>
<span id="cb105-2210"><a href="#cb105-2210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-2211"><a href="#cb105-2211" aria-hidden="true" tabindex="-1"></a>  <span class="co">// createLinearLegend(svg, minValue, maxValue, width, height, color);</span></span>
<span id="cb105-2212"><a href="#cb105-2212" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (atlas_cat <span class="op">===</span> <span class="st">"Hazard"</span>) {</span>
<span id="cb105-2213"><a href="#cb105-2213" aria-hidden="true" tabindex="-1"></a>    <span class="fu">createThresholdLegend</span>(</span>
<span id="cb105-2214"><a href="#cb105-2214" aria-hidden="true" tabindex="-1"></a>      svg<span class="op">,</span></span>
<span id="cb105-2215"><a href="#cb105-2215" aria-hidden="true" tabindex="-1"></a>      hazard_dict[hazard_sel][<span class="st">"thresholds"</span>]<span class="op">,</span></span>
<span id="cb105-2216"><a href="#cb105-2216" aria-hidden="true" tabindex="-1"></a>      hazard_dict[hazard_sel][<span class="st">"colours"</span>]<span class="op">,</span></span>
<span id="cb105-2217"><a href="#cb105-2217" aria-hidden="true" tabindex="-1"></a>      height<span class="op">,</span></span>
<span id="cb105-2218"><a href="#cb105-2218" aria-hidden="true" tabindex="-1"></a>      format_val<span class="op">,</span></span>
<span id="cb105-2219"><a href="#cb105-2219" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb105-2220"><a href="#cb105-2220" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb105-2221"><a href="#cb105-2221" aria-hidden="true" tabindex="-1"></a>    <span class="fu">createLinearLegend</span>(svg<span class="op">,</span> minValue<span class="op">,</span> maxValue<span class="op">,</span> width<span class="op">,</span> height<span class="op">,</span> color)<span class="op">;</span></span>
<span id="cb105-2222"><a href="#cb105-2222" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb105-2223"><a href="#cb105-2223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-2224"><a href="#cb105-2224" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">call</span>(</span>
<span id="cb105-2225"><a href="#cb105-2225" aria-hidden="true" tabindex="-1"></a>    d3</span>
<span id="cb105-2226"><a href="#cb105-2226" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">zoom</span>()</span>
<span id="cb105-2227"><a href="#cb105-2227" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">extent</span>([</span>
<span id="cb105-2228"><a href="#cb105-2228" aria-hidden="true" tabindex="-1"></a>        [<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span>]<span class="op">,</span></span>
<span id="cb105-2229"><a href="#cb105-2229" aria-hidden="true" tabindex="-1"></a>        [width<span class="op">,</span> height]<span class="op">,</span></span>
<span id="cb105-2230"><a href="#cb105-2230" aria-hidden="true" tabindex="-1"></a>      ])</span>
<span id="cb105-2231"><a href="#cb105-2231" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">scaleExtent</span>([<span class="dv">1</span><span class="op">,</span> <span class="dv">8</span>])</span>
<span id="cb105-2232"><a href="#cb105-2232" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">on</span>(<span class="st">"zoom"</span><span class="op">,</span> zoomed)<span class="op">,</span></span>
<span id="cb105-2233"><a href="#cb105-2233" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb105-2234"><a href="#cb105-2234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-2235"><a href="#cb105-2235" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> resetButton <span class="op">=</span> svg</span>
<span id="cb105-2236"><a href="#cb105-2236" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"foreignObject"</span>)</span>
<span id="cb105-2237"><a href="#cb105-2237" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> <span class="dv">150</span>)</span>
<span id="cb105-2238"><a href="#cb105-2238" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> <span class="dv">50</span>)</span>
<span id="cb105-2239"><a href="#cb105-2239" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> <span class="dv">750</span>)</span>
<span id="cb105-2240"><a href="#cb105-2240" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> <span class="op">-</span><span class="dv">65</span>)</span>
<span id="cb105-2241"><a href="#cb105-2241" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">html</span>(</span>
<span id="cb105-2242"><a href="#cb105-2242" aria-hidden="true" tabindex="-1"></a>      <span class="vs">`&lt;button id=reset_button style="color: black;"&gt;</span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">ViewExplore</span><span class="op">.</span><span class="at">exploreMap</span><span class="op">.</span><span class="at">resetBtn</span>)<span class="sc">}</span><span class="vs">&lt;/button&gt;`</span><span class="op">,</span></span>
<span id="cb105-2243"><a href="#cb105-2243" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb105-2244"><a href="#cb105-2244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-2245"><a href="#cb105-2245" aria-hidden="true" tabindex="-1"></a>  resetButton<span class="op">.</span><span class="fu">select</span>(<span class="st">"button"</span>)<span class="op">.</span><span class="fu">on</span>(<span class="st">"click"</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb105-2246"><a href="#cb105-2246" aria-hidden="true" tabindex="-1"></a>    svg</span>
<span id="cb105-2247"><a href="#cb105-2247" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb105-2248"><a href="#cb105-2248" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">duration</span>(<span class="dv">750</span>)</span>
<span id="cb105-2249"><a href="#cb105-2249" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">call</span>(</span>
<span id="cb105-2250"><a href="#cb105-2250" aria-hidden="true" tabindex="-1"></a>        d3</span>
<span id="cb105-2251"><a href="#cb105-2251" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">zoom</span>()</span>
<span id="cb105-2252"><a href="#cb105-2252" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">extent</span>([</span>
<span id="cb105-2253"><a href="#cb105-2253" aria-hidden="true" tabindex="-1"></a>            [<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span>]<span class="op">,</span></span>
<span id="cb105-2254"><a href="#cb105-2254" aria-hidden="true" tabindex="-1"></a>            [width<span class="op">,</span> height]<span class="op">,</span></span>
<span id="cb105-2255"><a href="#cb105-2255" aria-hidden="true" tabindex="-1"></a>          ])</span>
<span id="cb105-2256"><a href="#cb105-2256" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">scaleExtent</span>([<span class="dv">1</span><span class="op">,</span> <span class="dv">8</span>])</span>
<span id="cb105-2257"><a href="#cb105-2257" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">on</span>(<span class="st">"zoom"</span><span class="op">,</span> zoomed)<span class="op">.</span><span class="at">transform</span><span class="op">,</span></span>
<span id="cb105-2258"><a href="#cb105-2258" aria-hidden="true" tabindex="-1"></a>        d3<span class="op">.</span><span class="at">zoomIdentity</span><span class="op">,</span></span>
<span id="cb105-2259"><a href="#cb105-2259" aria-hidden="true" tabindex="-1"></a>      )<span class="op">;</span></span>
<span id="cb105-2260"><a href="#cb105-2260" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb105-2261"><a href="#cb105-2261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-2262"><a href="#cb105-2262" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> svg<span class="op">.</span><span class="fu">node</span>()<span class="op">;</span></span>
<span id="cb105-2263"><a href="#cb105-2263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-2264"><a href="#cb105-2264" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">zoomed</span>({ transform }) {</span>
<span id="cb105-2265"><a href="#cb105-2265" aria-hidden="true" tabindex="-1"></a>    map<span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> transform)<span class="op">;</span></span>
<span id="cb105-2266"><a href="#cb105-2266" aria-hidden="true" tabindex="-1"></a>    map<span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="dv">1</span> <span class="op">/</span> transform<span class="op">.</span><span class="at">k</span>)<span class="op">;</span></span>
<span id="cb105-2267"><a href="#cb105-2267" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (outline) {</span>
<span id="cb105-2268"><a href="#cb105-2268" aria-hidden="true" tabindex="-1"></a>      outline<span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> transform)<span class="op">;</span></span>
<span id="cb105-2269"><a href="#cb105-2269" aria-hidden="true" tabindex="-1"></a>      outline<span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="dv">1</span> <span class="op">/</span> transform<span class="op">.</span><span class="at">k</span>)<span class="op">;</span></span>
<span id="cb105-2270"><a href="#cb105-2270" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb105-2271"><a href="#cb105-2271" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb105-2272"><a href="#cb105-2272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-2273"><a href="#cb105-2273" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">make_tooltip_admin</span>(d) {</span>
<span id="cb105-2274"><a href="#cb105-2274" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> admin_text<span class="op">;</span></span>
<span id="cb105-2275"><a href="#cb105-2275" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (d<span class="op">.</span><span class="at">admin1_name</span> <span class="op">===</span> <span class="kw">undefined</span>) {</span>
<span id="cb105-2276"><a href="#cb105-2276" aria-hidden="true" tabindex="-1"></a>      admin_text <span class="op">=</span> <span class="vs">`</span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">adminlevels</span><span class="op">.</span><span class="at">admin0_name</span>)<span class="sc">}</span><span class="vs">: </span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">adminNames</span>[d<span class="op">.</span><span class="at">admin0_name</span>])<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span>
<span id="cb105-2277"><a href="#cb105-2277" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (d<span class="op">.</span><span class="at">admin1_name</span> <span class="op">!==</span> <span class="kw">undefined</span> <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">admin2_name</span> <span class="op">===</span> <span class="kw">undefined</span>) {</span>
<span id="cb105-2278"><a href="#cb105-2278" aria-hidden="true" tabindex="-1"></a>      admin_text <span class="op">=</span> <span class="vs">`</span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">adminlevels</span><span class="op">.</span><span class="at">admin0_name</span>)<span class="sc">}</span><span class="vs">: </span><span class="sc">${</span>d<span class="op">.</span><span class="at">admin0_name</span><span class="sc">}</span><span class="vs">&lt;br&gt;</span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">adminlevels</span><span class="op">.</span><span class="at">admin1_name</span>)<span class="sc">}</span><span class="vs">: </span><span class="sc">${</span>d<span class="op">.</span><span class="at">admin1_name</span><span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span>
<span id="cb105-2279"><a href="#cb105-2279" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (d<span class="op">.</span><span class="at">admin1_name</span> <span class="op">!==</span> <span class="kw">undefined</span> <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">admin2_name</span> <span class="op">!==</span> <span class="kw">undefined</span>) {</span>
<span id="cb105-2280"><a href="#cb105-2280" aria-hidden="true" tabindex="-1"></a>      admin_text <span class="op">=</span> <span class="vs">`</span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">adminlevels</span><span class="op">.</span><span class="at">admin0_name</span>)<span class="sc">}</span><span class="vs">: </span><span class="sc">${</span>d<span class="op">.</span><span class="at">admin0_name</span><span class="sc">}</span><span class="vs">&lt;br&gt;</span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">adminlevels</span><span class="op">.</span><span class="at">admin1_name</span>)<span class="sc">}</span><span class="vs">: </span><span class="sc">${</span>d<span class="op">.</span><span class="at">admin1_name</span><span class="sc">}</span><span class="vs">&lt;br&gt;</span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">adminlevels</span><span class="op">.</span><span class="at">admin2_name</span>)<span class="sc">}</span><span class="vs">: </span><span class="sc">${</span>d<span class="op">.</span><span class="at">admin2_name</span><span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span>
<span id="cb105-2281"><a href="#cb105-2281" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb105-2282"><a href="#cb105-2282" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> admin_text<span class="op">;</span></span>
<span id="cb105-2283"><a href="#cb105-2283" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb105-2284"><a href="#cb105-2284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-2285"><a href="#cb105-2285" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">createLinearLegend</span>(svg<span class="op">,</span> minValue<span class="op">,</span> maxValue<span class="op">,</span> width<span class="op">,</span> height<span class="op">,</span> color) {</span>
<span id="cb105-2286"><a href="#cb105-2286" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> padding <span class="op">=</span> <span class="dv">65</span><span class="op">;</span></span>
<span id="cb105-2287"><a href="#cb105-2287" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> defs <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"defs"</span>)<span class="op">;</span></span>
<span id="cb105-2288"><a href="#cb105-2288" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> linearGradient <span class="op">=</span> defs</span>
<span id="cb105-2289"><a href="#cb105-2289" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"linearGradient"</span>)</span>
<span id="cb105-2290"><a href="#cb105-2290" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"linear-gradient"</span>)<span class="op">;</span></span>
<span id="cb105-2291"><a href="#cb105-2291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-2292"><a href="#cb105-2292" aria-hidden="true" tabindex="-1"></a>    linearGradient</span>
<span id="cb105-2293"><a href="#cb105-2293" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"stop"</span>)</span>
<span id="cb105-2294"><a href="#cb105-2294" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>([minValue<span class="op">,</span> maxValue])</span>
<span id="cb105-2295"><a href="#cb105-2295" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">join</span>(<span class="st">"stop"</span>)</span>
<span id="cb105-2296"><a href="#cb105-2296" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"offset"</span><span class="op">,</span> (d<span class="op">,</span> i<span class="op">,</span> n) <span class="kw">=&gt;</span> <span class="vs">`</span><span class="sc">${</span>(<span class="dv">100</span> <span class="op">*</span> i) <span class="op">/</span> (n<span class="op">.</span><span class="at">length</span> <span class="op">-</span> <span class="dv">1</span>)<span class="sc">}</span><span class="vs">%`</span>)</span>
<span id="cb105-2297"><a href="#cb105-2297" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stop-color"</span><span class="op">,</span> color)<span class="op">;</span></span>
<span id="cb105-2298"><a href="#cb105-2298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-2299"><a href="#cb105-2299" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> legend <span class="op">=</span> svg</span>
<span id="cb105-2300"><a href="#cb105-2300" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb105-2301"><a href="#cb105-2301" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(</span>
<span id="cb105-2302"><a href="#cb105-2302" aria-hidden="true" tabindex="-1"></a>        <span class="st">"transform"</span><span class="op">,</span></span>
<span id="cb105-2303"><a href="#cb105-2303" aria-hidden="true" tabindex="-1"></a>        <span class="vs">`translate(</span><span class="sc">${</span>width <span class="op">-</span> <span class="dv">700</span><span class="sc">}</span><span class="vs">, </span><span class="sc">${</span>height <span class="op">-</span> padding <span class="op">-</span> <span class="dv">575</span><span class="sc">}</span><span class="vs">)`</span><span class="op">,</span></span>
<span id="cb105-2304"><a href="#cb105-2304" aria-hidden="true" tabindex="-1"></a>      )<span class="op">;</span></span>
<span id="cb105-2305"><a href="#cb105-2305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-2306"><a href="#cb105-2306" aria-hidden="true" tabindex="-1"></a>    legend</span>
<span id="cb105-2307"><a href="#cb105-2307" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"rect"</span>)</span>
<span id="cb105-2308"><a href="#cb105-2308" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="st">"translate(0, -10)"</span>)</span>
<span id="cb105-2309"><a href="#cb105-2309" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> <span class="dv">250</span>)</span>
<span id="cb105-2310"><a href="#cb105-2310" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> <span class="dv">10</span>)</span>
<span id="cb105-2311"><a href="#cb105-2311" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">style</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"url(#linear-gradient)"</span>)<span class="op">;</span></span>
<span id="cb105-2312"><a href="#cb105-2312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-2313"><a href="#cb105-2313" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> midValue <span class="op">=</span> (minValue <span class="op">+</span> maxValue) <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb105-2314"><a href="#cb105-2314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-2315"><a href="#cb105-2315" aria-hidden="true" tabindex="-1"></a>    legend</span>
<span id="cb105-2316"><a href="#cb105-2316" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb105-2317"><a href="#cb105-2317" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">call</span>(</span>
<span id="cb105-2318"><a href="#cb105-2318" aria-hidden="true" tabindex="-1"></a>        d3</span>
<span id="cb105-2319"><a href="#cb105-2319" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">axisBottom</span>(</span>
<span id="cb105-2320"><a href="#cb105-2320" aria-hidden="true" tabindex="-1"></a>            d3<span class="op">.</span><span class="fu">scaleLinear</span>()<span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">250</span>])<span class="op">.</span><span class="fu">domain</span>([minValue<span class="op">,</span> maxValue])<span class="op">,</span></span>
<span id="cb105-2321"><a href="#cb105-2321" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb105-2322"><a href="#cb105-2322" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">tickValues</span>([minValue<span class="op">,</span> midValue<span class="op">,</span> maxValue])</span>
<span id="cb105-2323"><a href="#cb105-2323" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">tickFormat</span>(</span>
<span id="cb105-2324"><a href="#cb105-2324" aria-hidden="true" tabindex="-1"></a>            (v) <span class="kw">=&gt;</span></span>
<span id="cb105-2325"><a href="#cb105-2325" aria-hidden="true" tabindex="-1"></a>              <span class="vs">`</span><span class="sc">${</span><span class="fu">format_val</span>(v<span class="op">,</span> var_unit[<span class="st">"category"</span>])<span class="sc">}</span><span class="vs"> </span><span class="sc">${</span>var_unit<span class="op">.</span><span class="at">label</span> <span class="op">===</span> <span class="st">"%"</span> <span class="op">?</span> <span class="st">""</span> <span class="op">:</span> var_unit<span class="op">.</span><span class="at">label</span><span class="sc">}</span><span class="vs">`</span><span class="op">,</span></span>
<span id="cb105-2326"><a href="#cb105-2326" aria-hidden="true" tabindex="-1"></a>          )<span class="op">,</span></span>
<span id="cb105-2327"><a href="#cb105-2327" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb105-2328"><a href="#cb105-2328" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">select</span>(<span class="st">".domain"</span>)<span class="op">;</span></span>
<span id="cb105-2329"><a href="#cb105-2329" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb105-2330"><a href="#cb105-2330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-2331"><a href="#cb105-2331" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">createThresholdLegend</span>(svg<span class="op">,</span> thresholds<span class="op">,</span> colors<span class="op">,</span> height<span class="op">,</span> format_val) {</span>
<span id="cb105-2332"><a href="#cb105-2332" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> padding <span class="op">=</span> <span class="dv">65</span><span class="op">;</span></span>
<span id="cb105-2333"><a href="#cb105-2333" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> legendWidth <span class="op">=</span> <span class="dv">230</span><span class="op">;</span></span>
<span id="cb105-2334"><a href="#cb105-2334" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> bandWidth <span class="op">=</span> legendWidth <span class="op">/</span> (thresholds<span class="op">.</span><span class="at">length</span> <span class="op">-</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb105-2335"><a href="#cb105-2335" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> legend <span class="op">=</span> svg</span>
<span id="cb105-2336"><a href="#cb105-2336" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb105-2337"><a href="#cb105-2337" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(</span>
<span id="cb105-2338"><a href="#cb105-2338" aria-hidden="true" tabindex="-1"></a>        <span class="st">"transform"</span><span class="op">,</span></span>
<span id="cb105-2339"><a href="#cb105-2339" aria-hidden="true" tabindex="-1"></a>        <span class="vs">`translate(</span><span class="sc">${</span>width <span class="op">-</span> <span class="dv">700</span><span class="sc">}</span><span class="vs">, </span><span class="sc">${</span>height <span class="op">-</span> padding <span class="op">-</span> <span class="dv">575</span><span class="sc">}</span><span class="vs">)`</span><span class="op">,</span></span>
<span id="cb105-2340"><a href="#cb105-2340" aria-hidden="true" tabindex="-1"></a>      )<span class="op">;</span></span>
<span id="cb105-2341"><a href="#cb105-2341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-2342"><a href="#cb105-2342" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Append color bands to legend</span></span>
<span id="cb105-2343"><a href="#cb105-2343" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> labels <span class="op">=</span> [<span class="st">"low"</span><span class="op">,</span> <span class="st">"moderate"</span><span class="op">,</span> <span class="st">"severe"</span><span class="op">,</span> <span class="st">"extreme"</span><span class="op">,</span> <span class="st">"Vextreme"</span>]<span class="op">;</span></span>
<span id="cb105-2344"><a href="#cb105-2344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-2345"><a href="#cb105-2345" aria-hidden="true" tabindex="-1"></a>    colors<span class="op">.</span><span class="fu">forEach</span>((threshold<span class="op">,</span> index) <span class="kw">=&gt;</span> {</span>
<span id="cb105-2346"><a href="#cb105-2346" aria-hidden="true" tabindex="-1"></a>      legend</span>
<span id="cb105-2347"><a href="#cb105-2347" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">append</span>(<span class="st">"rect"</span>)</span>
<span id="cb105-2348"><a href="#cb105-2348" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> index <span class="op">*</span> bandWidth)</span>
<span id="cb105-2349"><a href="#cb105-2349" aria-hidden="true" tabindex="-1"></a>        <span class="co">// .attr("y", -10)</span></span>
<span id="cb105-2350"><a href="#cb105-2350" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> bandWidth)</span>
<span id="cb105-2351"><a href="#cb105-2351" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> <span class="dv">10</span>)</span>
<span id="cb105-2352"><a href="#cb105-2352" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"fill"</span><span class="op">,</span> colors[index])<span class="op">;</span></span>
<span id="cb105-2353"><a href="#cb105-2353" aria-hidden="true" tabindex="-1"></a>      <span class="co">// Add label</span></span>
<span id="cb105-2354"><a href="#cb105-2354" aria-hidden="true" tabindex="-1"></a>      legend</span>
<span id="cb105-2355"><a href="#cb105-2355" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb105-2356"><a href="#cb105-2356" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> index <span class="op">*</span> bandWidth <span class="op">+</span> bandWidth <span class="op">/</span> <span class="dv">2</span>)</span>
<span id="cb105-2357"><a href="#cb105-2357" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> <span class="op">-</span><span class="dv">15</span>) <span class="co">// Adjust this value as needed for label positioning</span></span>
<span id="cb105-2358"><a href="#cb105-2358" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb105-2359"><a href="#cb105-2359" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">text</span>(<span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">levels</span>[labels[index]]))</span>
<span id="cb105-2360"><a href="#cb105-2360" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="st">"12px"</span>)</span>
<span id="cb105-2361"><a href="#cb105-2361" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"black"</span>)<span class="op">;</span> <span class="co">// Set the color of the label text</span></span>
<span id="cb105-2362"><a href="#cb105-2362" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb105-2363"><a href="#cb105-2363" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb105-2364"><a href="#cb105-2364" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-105" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb106" data-startfrom="2368" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2367"><span id="cb106-2368"><a href="#cb106-2368" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`## Definition boxes`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-106" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb107" data-startfrom="2372" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2371"><span id="cb107-2372"><a href="#cb107-2372" aria-hidden="true" tabindex="-1"></a>create_definitions <span class="op">=</span> (category) <span class="kw">=&gt;</span> {</span>
<span id="cb107-2373"><a href="#cb107-2373" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> def_text <span class="op">=</span> <span class="fu">_lang</span>(definitionText[category]<span class="op">.</span><span class="at">text</span>)<span class="op">;</span></span>
<span id="cb107-2374"><a href="#cb107-2374" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="fu">html</span><span class="vs">`&lt;details style="padding: 0, 0 ;border-radius:5px;background:none;max-width:600px"&gt;</span></span>
<span id="cb107-2375"><a href="#cb107-2375" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;summary style="cursor:pointer"&gt;</span><span class="sc">${</span><span class="fu">_lang</span>(definitionText[category]<span class="op">.</span><span class="at">title</span>)<span class="sc">}</span><span class="vs">&lt;/summary&gt;</span></span>
<span id="cb107-2376"><a href="#cb107-2376" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;div style="margin:.5em 0;border-top:1px dashed #888"&gt;</span></span>
<span id="cb107-2377"><a href="#cb107-2377" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span><span class="fu">md</span><span class="vs">`</span><span class="sc">${</span>def_text<span class="sc">}</span><span class="vs">`</span><span class="sc">}</span></span>
<span id="cb107-2378"><a href="#cb107-2378" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;div&gt;&lt;/details&gt;`</span><span class="op">;</span></span>
<span id="cb107-2379"><a href="#cb107-2379" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-107" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb108" data-startfrom="2383" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2382"><span id="cb108-2383"><a href="#cb108-2383" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`## Plot Functions`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-108" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb109" data-startfrom="2387" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2386"><span id="cb109-2387"><a href="#cb109-2387" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">createPlot</span>() {</span>
<span id="cb109-2388"><a href="#cb109-2388" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (atlas_cat <span class="op">===</span> <span class="st">"Exposure"</span>) {</span>
<span id="cb109-2389"><a href="#cb109-2389" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (exposure_cat<span class="op">.</span><span class="fu">includes</span>(<span class="st">"Livestock"</span>) <span class="op">||</span> exposure_cat<span class="op">.</span><span class="fu">includes</span>(<span class="st">"Crop"</span>)) {</span>
<span id="cb109-2390"><a href="#cb109-2390" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> <span class="fu">exposure_treeplot</span>()<span class="op">;</span></span>
<span id="cb109-2391"><a href="#cb109-2391" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (exposure_cat <span class="op">===</span> <span class="st">"Population"</span>) {</span>
<span id="cb109-2392"><a href="#cb109-2392" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> <span class="fu">population_stackbars</span>()<span class="op">;</span></span>
<span id="cb109-2393"><a href="#cb109-2393" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb109-2394"><a href="#cb109-2394" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (atlas_cat <span class="op">===</span> <span class="st">"Hazard"</span>) {</span>
<span id="cb109-2395"><a href="#cb109-2395" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">hazard_stackBar</span>(hazard_sel)<span class="op">;</span></span>
<span id="cb109-2396"><a href="#cb109-2396" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (atlas_cat <span class="op">===</span> <span class="st">"Vulnerability"</span>) {</span>
<span id="cb109-2397"><a href="#cb109-2397" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">parallelCoordinatesScatterPlot</span>()<span class="op">;</span></span>
<span id="cb109-2398"><a href="#cb109-2398" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb109-2399"><a href="#cb109-2399" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-109" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb110" data-startfrom="2403" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2402"><span id="cb110-2403"><a href="#cb110-2403" aria-hidden="true" tabindex="-1"></a>createTable <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb110-2404"><a href="#cb110-2404" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> table <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">table</span>(data_to_visualise<span class="op">,</span> {</span>
<span id="cb110-2405"><a href="#cb110-2405" aria-hidden="true" tabindex="-1"></a>    <span class="dt">rows</span><span class="op">:</span> <span class="dv">25</span><span class="op">,</span></span>
<span id="cb110-2406"><a href="#cb110-2406" aria-hidden="true" tabindex="-1"></a>    <span class="dt">maxWidth</span><span class="op">:</span> <span class="st">"1000px"</span><span class="op">,</span></span>
<span id="cb110-2407"><a href="#cb110-2407" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb110-2408"><a href="#cb110-2408" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> style <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">createElement</span>(<span class="st">"style"</span>)<span class="op">;</span></span>
<span id="cb110-2409"><a href="#cb110-2409" aria-hidden="true" tabindex="-1"></a>  style<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> <span class="vs">`</span></span>
<span id="cb110-2410"><a href="#cb110-2410" aria-hidden="true" tabindex="-1"></a><span class="vs">    .exploreTable th {</span></span>
<span id="cb110-2411"><a href="#cb110-2411" aria-hidden="true" tabindex="-1"></a><span class="vs">      background-color: lightgrey !important;</span></span>
<span id="cb110-2412"><a href="#cb110-2412" aria-hidden="true" tabindex="-1"></a><span class="vs">    }</span></span>
<span id="cb110-2413"><a href="#cb110-2413" aria-hidden="true" tabindex="-1"></a><span class="vs">    .exploreTable tr:nth-child(odd) {</span></span>
<span id="cb110-2414"><a href="#cb110-2414" aria-hidden="true" tabindex="-1"></a><span class="vs">      background: #f2f2f2!important;</span></span>
<span id="cb110-2415"><a href="#cb110-2415" aria-hidden="true" tabindex="-1"></a><span class="vs">    }</span></span>
<span id="cb110-2416"><a href="#cb110-2416" aria-hidden="true" tabindex="-1"></a><span class="vs">    .exploreTable td {</span></span>
<span id="cb110-2417"><a href="#cb110-2417" aria-hidden="true" tabindex="-1"></a><span class="vs">      padding-left: 15px !important;</span></span>
<span id="cb110-2418"><a href="#cb110-2418" aria-hidden="true" tabindex="-1"></a><span class="vs">    }</span></span>
<span id="cb110-2419"><a href="#cb110-2419" aria-hidden="true" tabindex="-1"></a><span class="vs">  `</span><span class="op">;</span></span>
<span id="cb110-2420"><a href="#cb110-2420" aria-hidden="true" tabindex="-1"></a>  table<span class="op">.</span><span class="at">classList</span><span class="op">.</span><span class="fu">add</span>(<span class="st">"exploreTable"</span>)<span class="op">;</span></span>
<span id="cb110-2421"><a href="#cb110-2421" aria-hidden="true" tabindex="-1"></a>  table<span class="op">.</span><span class="fu">appendChild</span>(style)<span class="op">;</span></span>
<span id="cb110-2422"><a href="#cb110-2422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2423"><a href="#cb110-2423" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> checkboxes <span class="op">=</span> table<span class="op">.</span><span class="fu">querySelectorAll</span>(<span class="st">'table input[type="checkbox"]'</span>)<span class="op">;</span></span>
<span id="cb110-2424"><a href="#cb110-2424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2425"><a href="#cb110-2425" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Remove all checkboxes</span></span>
<span id="cb110-2426"><a href="#cb110-2426" aria-hidden="true" tabindex="-1"></a>  checkboxes<span class="op">.</span><span class="fu">forEach</span>(<span class="kw">function</span> (checkbox) {</span>
<span id="cb110-2427"><a href="#cb110-2427" aria-hidden="true" tabindex="-1"></a>    checkbox<span class="op">.</span><span class="at">parentNode</span><span class="op">.</span><span class="fu">removeChild</span>(checkbox)<span class="op">;</span></span>
<span id="cb110-2428"><a href="#cb110-2428" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb110-2429"><a href="#cb110-2429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-2430"><a href="#cb110-2430" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> table<span class="op">;</span></span>
<span id="cb110-2431"><a href="#cb110-2431" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-110" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb111" data-startfrom="2435" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2434"><span id="cb111-2435"><a href="#cb111-2435" aria-hidden="true" tabindex="-1"></a>exposure_treeplot <span class="op">=</span> <span class="kw">async</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb111-2436"><a href="#cb111-2436" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> admin_query<span class="op">;</span></span>
<span id="cb111-2437"><a href="#cb111-2437" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (country <span class="op">===</span> <span class="st">"SSA"</span>) {</span>
<span id="cb111-2438"><a href="#cb111-2438" aria-hidden="true" tabindex="-1"></a>    admin_query <span class="op">=</span> <span class="vs">`"admin1_name" IS NULL`</span><span class="op">;</span></span>
<span id="cb111-2439"><a href="#cb111-2439" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (country <span class="op">!==</span> <span class="st">"SSA"</span> <span class="op">&amp;&amp;</span> admin1_sel <span class="op">===</span> <span class="st">"Full Country"</span>) {</span>
<span id="cb111-2440"><a href="#cb111-2440" aria-hidden="true" tabindex="-1"></a>    admin_query <span class="op">=</span> <span class="vs">`"admin0_name" LIKE '</span><span class="sc">${</span>country<span class="sc">}</span><span class="vs">' AND "admin1_name" IS NOT NULL AND "admin2_name" IS NULL`</span><span class="op">;</span></span>
<span id="cb111-2441"><a href="#cb111-2441" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (country <span class="op">!==</span> <span class="st">"SSA"</span> <span class="op">&amp;&amp;</span> admin1_sel <span class="op">!==</span> <span class="st">"Full Country"</span>) {</span>
<span id="cb111-2442"><a href="#cb111-2442" aria-hidden="true" tabindex="-1"></a>    admin_query <span class="op">=</span> <span class="vs">`"admin0_name" LIKE '</span><span class="sc">${</span>country<span class="sc">}</span><span class="vs">' AND "admin1_name" LIKE '</span><span class="sc">${</span>admin1_sel<span class="sc">}</span><span class="vs">' AND "admin1_name" IS NOT NULL AND "admin2_name" IS NOT NULL`</span><span class="op">;</span></span>
<span id="cb111-2443"><a href="#cb111-2443" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb111-2444"><a href="#cb111-2444" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> formatTree <span class="op">=</span> exposure_var <span class="op">===</span> <span class="st">"number"</span> <span class="op">?</span> formatBigNums <span class="op">:</span> formatDollar<span class="op">;</span></span>
<span id="cb111-2445"><a href="#cb111-2445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-2446"><a href="#cb111-2446" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> translateCrop <span class="op">=</span> (d) <span class="kw">=&gt;</span> {</span>
<span id="cb111-2447"><a href="#cb111-2447" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (</span>
<span id="cb111-2448"><a href="#cb111-2448" aria-hidden="true" tabindex="-1"></a>      <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">ViewExplore</span><span class="op">.</span><span class="at">exposureTreemap</span><span class="op">.</span><span class="at">cropGroups</span>[d]) <span class="op">||</span></span>
<span id="cb111-2449"><a href="#cb111-2449" aria-hidden="true" tabindex="-1"></a>      <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">commodities</span>[d]) <span class="op">||</span></span>
<span id="cb111-2450"><a href="#cb111-2450" aria-hidden="true" tabindex="-1"></a>      d</span>
<span id="cb111-2451"><a href="#cb111-2451" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb111-2452"><a href="#cb111-2452" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb111-2453"><a href="#cb111-2453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-2454"><a href="#cb111-2454" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> data_unformatted <span class="op">=</span> <span class="cf">await</span> db<span class="op">.</span><span class="fu">query</span>(<span class="vs">`</span></span>
<span id="cb111-2455"><a href="#cb111-2455" aria-hidden="true" tabindex="-1"></a><span class="vs">SELECT crop, SUM(value) as VOP, FROM Exposure</span></span>
<span id="cb111-2456"><a href="#cb111-2456" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span>plotQuery_admin<span class="sc">}</span></span>
<span id="cb111-2457"><a href="#cb111-2457" aria-hidden="true" tabindex="-1"></a><span class="vs">AND "exposure" = '</span><span class="sc">${</span>exposure_var<span class="sc">}</span><span class="vs">'</span></span>
<span id="cb111-2458"><a href="#cb111-2458" aria-hidden="true" tabindex="-1"></a><span class="vs">AND "crop" NOT IN ('total_highland', 'total_tropical')</span></span>
<span id="cb111-2459"><a href="#cb111-2459" aria-hidden="true" tabindex="-1"></a><span class="vs">and "group" = '</span><span class="sc">${</span>exposure_cat<span class="op">.</span><span class="fu">toLocaleLowerCase</span>()<span class="sc">}</span><span class="vs">'</span></span>
<span id="cb111-2460"><a href="#cb111-2460" aria-hidden="true" tabindex="-1"></a><span class="vs">GROUP BY crop`</span>)<span class="op">;</span></span>
<span id="cb111-2461"><a href="#cb111-2461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-2462"><a href="#cb111-2462" aria-hidden="true" tabindex="-1"></a>  d3<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".plotTooltip"</span>)<span class="op">.</span><span class="fu">remove</span>()<span class="op">;</span></span>
<span id="cb111-2463"><a href="#cb111-2463" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> tooltip <span class="op">=</span> d3</span>
<span id="cb111-2464"><a href="#cb111-2464" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">select</span>(<span class="st">"body"</span>)</span>
<span id="cb111-2465"><a href="#cb111-2465" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"div"</span>)</span>
<span id="cb111-2466"><a href="#cb111-2466" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"plotTooltip TreeTip"</span>)</span>
<span id="cb111-2467"><a href="#cb111-2467" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"position"</span><span class="op">,</span> <span class="st">"absolute"</span>)<span class="op">;</span></span>
<span id="cb111-2468"><a href="#cb111-2468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-2469"><a href="#cb111-2469" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> data <span class="op">=</span> <span class="kw">new</span> <span class="bu">Object</span>({</span>
<span id="cb111-2470"><a href="#cb111-2470" aria-hidden="true" tabindex="-1"></a>    <span class="dt">name</span><span class="op">:</span> <span class="st">"total"</span><span class="op">,</span></span>
<span id="cb111-2471"><a href="#cb111-2471" aria-hidden="true" tabindex="-1"></a>    <span class="dt">children</span><span class="op">:</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">entries</span>(crop_groups)<span class="op">.</span><span class="fu">map</span>(([groupName<span class="op">,</span> crops]) <span class="kw">=&gt;</span> ({</span>
<span id="cb111-2472"><a href="#cb111-2472" aria-hidden="true" tabindex="-1"></a>      <span class="dt">name</span><span class="op">:</span> groupName<span class="op">,</span></span>
<span id="cb111-2473"><a href="#cb111-2473" aria-hidden="true" tabindex="-1"></a>      <span class="dt">children</span><span class="op">:</span> crops<span class="op">.</span><span class="fu">map</span>((cropName) <span class="kw">=&gt;</span> {</span>
<span id="cb111-2474"><a href="#cb111-2474" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> cropData <span class="op">=</span> data_unformatted<span class="op">.</span><span class="fu">find</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">crop</span> <span class="op">===</span> cropName)<span class="op">;</span></span>
<span id="cb111-2475"><a href="#cb111-2475" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> { <span class="dt">name</span><span class="op">:</span> cropName<span class="op">,</span> <span class="dt">value</span><span class="op">:</span> cropData <span class="op">?</span> cropData<span class="op">.</span><span class="at">VOP</span> <span class="op">:</span> <span class="dv">0</span> }<span class="op">;</span></span>
<span id="cb111-2476"><a href="#cb111-2476" aria-hidden="true" tabindex="-1"></a>      })<span class="op">,</span></span>
<span id="cb111-2477"><a href="#cb111-2477" aria-hidden="true" tabindex="-1"></a>    }))<span class="op">,</span></span>
<span id="cb111-2478"><a href="#cb111-2478" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb111-2479"><a href="#cb111-2479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-2480"><a href="#cb111-2480" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> width <span class="op">=</span> <span class="dv">1000</span><span class="op">;</span></span>
<span id="cb111-2481"><a href="#cb111-2481" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> height <span class="op">=</span> <span class="dv">600</span><span class="op">;</span></span>
<span id="cb111-2482"><a href="#cb111-2482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-2483"><a href="#cb111-2483" aria-hidden="true" tabindex="-1"></a>  <span class="co">// This custom tiling function adapts the built-in binary tiling function</span></span>
<span id="cb111-2484"><a href="#cb111-2484" aria-hidden="true" tabindex="-1"></a>  <span class="co">// for the appropriate aspect ratio when the treemap is zoomed-in.</span></span>
<span id="cb111-2485"><a href="#cb111-2485" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">tile</span>(node<span class="op">,</span> x0<span class="op">,</span> y0<span class="op">,</span> x1<span class="op">,</span> y1) {</span>
<span id="cb111-2486"><a href="#cb111-2486" aria-hidden="true" tabindex="-1"></a>    d3<span class="op">.</span><span class="fu">treemapBinary</span>(node<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> width<span class="op">,</span> height)<span class="op">;</span></span>
<span id="cb111-2487"><a href="#cb111-2487" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (<span class="kw">const</span> child <span class="kw">of</span> node<span class="op">.</span><span class="at">children</span>) {</span>
<span id="cb111-2488"><a href="#cb111-2488" aria-hidden="true" tabindex="-1"></a>      child<span class="op">.</span><span class="at">x0</span> <span class="op">=</span> x0 <span class="op">+</span> (child<span class="op">.</span><span class="at">x0</span> <span class="op">/</span> width) <span class="op">*</span> (x1 <span class="op">-</span> x0)<span class="op">;</span></span>
<span id="cb111-2489"><a href="#cb111-2489" aria-hidden="true" tabindex="-1"></a>      child<span class="op">.</span><span class="at">x1</span> <span class="op">=</span> x0 <span class="op">+</span> (child<span class="op">.</span><span class="at">x1</span> <span class="op">/</span> width) <span class="op">*</span> (x1 <span class="op">-</span> x0)<span class="op">;</span></span>
<span id="cb111-2490"><a href="#cb111-2490" aria-hidden="true" tabindex="-1"></a>      child<span class="op">.</span><span class="at">y0</span> <span class="op">=</span> y0 <span class="op">+</span> (child<span class="op">.</span><span class="at">y0</span> <span class="op">/</span> height) <span class="op">*</span> (y1 <span class="op">-</span> y0)<span class="op">;</span></span>
<span id="cb111-2491"><a href="#cb111-2491" aria-hidden="true" tabindex="-1"></a>      child<span class="op">.</span><span class="at">y1</span> <span class="op">=</span> y0 <span class="op">+</span> (child<span class="op">.</span><span class="at">y1</span> <span class="op">/</span> height) <span class="op">*</span> (y1 <span class="op">-</span> y0)<span class="op">;</span></span>
<span id="cb111-2492"><a href="#cb111-2492" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb111-2493"><a href="#cb111-2493" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb111-2494"><a href="#cb111-2494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-2495"><a href="#cb111-2495" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Compute the layout.</span></span>
<span id="cb111-2496"><a href="#cb111-2496" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> hierarchy <span class="op">=</span> d3</span>
<span id="cb111-2497"><a href="#cb111-2497" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">hierarchy</span>(data)</span>
<span id="cb111-2498"><a href="#cb111-2498" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">sum</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">value</span>)</span>
<span id="cb111-2499"><a href="#cb111-2499" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">sort</span>((a<span class="op">,</span> b) <span class="kw">=&gt;</span> b<span class="op">.</span><span class="at">value</span> <span class="op">-</span> a<span class="op">.</span><span class="at">value</span>)<span class="op">;</span></span>
<span id="cb111-2500"><a href="#cb111-2500" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> <span class="bu">root</span> <span class="op">=</span> d3<span class="op">.</span><span class="fu">treemap</span>()<span class="op">.</span><span class="fu">tile</span>(tile)(hierarchy)<span class="op">;</span></span>
<span id="cb111-2501"><a href="#cb111-2501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-2502"><a href="#cb111-2502" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> smallest_crop <span class="op">=</span> d3<span class="op">.</span><span class="fu">min</span>(data_unformatted<span class="op">,</span> (d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">VOP</span>)<span class="op">;</span></span>
<span id="cb111-2503"><a href="#cb111-2503" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> largest_group <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(hierarchy<span class="op">.</span><span class="at">children</span><span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">value</span>))<span class="op">;</span></span>
<span id="cb111-2504"><a href="#cb111-2504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-2505"><a href="#cb111-2505" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> colorScale <span class="op">=</span> d3</span>
<span id="cb111-2506"><a href="#cb111-2506" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb111-2507"><a href="#cb111-2507" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([smallest_crop<span class="op">,</span> largest_group])</span>
<span id="cb111-2508"><a href="#cb111-2508" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>([<span class="st">"#F7D732"</span><span class="op">,</span> <span class="st">"#71913D"</span>])<span class="op">;</span></span>
<span id="cb111-2509"><a href="#cb111-2509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-2510"><a href="#cb111-2510" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Create the scales.</span></span>
<span id="cb111-2511"><a href="#cb111-2511" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> x <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()<span class="op">.</span><span class="fu">rangeRound</span>([<span class="dv">0</span><span class="op">,</span> width])<span class="op">;</span></span>
<span id="cb111-2512"><a href="#cb111-2512" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> y <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()<span class="op">.</span><span class="fu">rangeRound</span>([<span class="dv">0</span><span class="op">,</span> height])<span class="op">;</span></span>
<span id="cb111-2513"><a href="#cb111-2513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-2514"><a href="#cb111-2514" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Formatting utilities.</span></span>
<span id="cb111-2515"><a href="#cb111-2515" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> format <span class="op">=</span> d3<span class="op">.</span><span class="fu">format</span>(<span class="st">",d"</span>)<span class="op">;</span></span>
<span id="cb111-2516"><a href="#cb111-2516" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> name <span class="op">=</span> (d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">data</span><span class="op">.</span><span class="at">name</span><span class="op">;</span></span>
<span id="cb111-2517"><a href="#cb111-2517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-2518"><a href="#cb111-2518" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Create the SVG container.</span></span>
<span id="cb111-2519"><a href="#cb111-2519" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> svg <span class="op">=</span> d3</span>
<span id="cb111-2520"><a href="#cb111-2520" aria-hidden="true" tabindex="-1"></a>    <span class="co">// .select(container)</span></span>
<span id="cb111-2521"><a href="#cb111-2521" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">create</span>(<span class="st">"svg"</span>)</span>
<span id="cb111-2522"><a href="#cb111-2522" aria-hidden="true" tabindex="-1"></a>    <span class="co">// .append("svg")</span></span>
<span id="cb111-2523"><a href="#cb111-2523" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"viewBox"</span><span class="op">,</span> [<span class="fl">0.5</span><span class="op">,</span> <span class="op">-</span><span class="fl">50.5</span><span class="op">,</span> width<span class="op">,</span> height <span class="op">+</span> <span class="dv">50</span>])</span>
<span id="cb111-2524"><a href="#cb111-2524" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> width)</span>
<span id="cb111-2525"><a href="#cb111-2525" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> height <span class="op">+</span> <span class="dv">50</span>)</span>
<span id="cb111-2526"><a href="#cb111-2526" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"style"</span><span class="op">,</span> <span class="st">"max-width: 100%; height: auto;"</span>)<span class="op">;</span></span>
<span id="cb111-2527"><a href="#cb111-2527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-2528"><a href="#cb111-2528" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Display the root.</span></span>
<span id="cb111-2529"><a href="#cb111-2529" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> group <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)<span class="op">.</span><span class="fu">call</span>(render<span class="op">,</span> <span class="bu">root</span>)<span class="op">;</span></span>
<span id="cb111-2530"><a href="#cb111-2530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-2531"><a href="#cb111-2531" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">render</span>(group<span class="op">,</span> <span class="bu">root</span>) {</span>
<span id="cb111-2532"><a href="#cb111-2532" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> node <span class="op">=</span> group</span>
<span id="cb111-2533"><a href="#cb111-2533" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"g"</span>)</span>
<span id="cb111-2534"><a href="#cb111-2534" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(<span class="bu">root</span><span class="op">.</span><span class="at">children</span><span class="op">.</span><span class="fu">concat</span>(<span class="bu">root</span>))</span>
<span id="cb111-2535"><a href="#cb111-2535" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">join</span>(<span class="st">"g"</span>)<span class="op">;</span></span>
<span id="cb111-2536"><a href="#cb111-2536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-2537"><a href="#cb111-2537" aria-hidden="true" tabindex="-1"></a>    node</span>
<span id="cb111-2538"><a href="#cb111-2538" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">filter</span>((d) <span class="kw">=&gt;</span> (d <span class="op">===</span> <span class="bu">root</span> <span class="op">?</span> d<span class="op">.</span><span class="at">parent</span> <span class="op">:</span> d<span class="op">.</span><span class="at">children</span>))</span>
<span id="cb111-2539"><a href="#cb111-2539" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cursor"</span><span class="op">,</span> <span class="st">"pointer"</span>)</span>
<span id="cb111-2540"><a href="#cb111-2540" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">on</span>(<span class="st">"click"</span><span class="op">,</span> (<span class="bu">event</span><span class="op">,</span> d) <span class="kw">=&gt;</span> (d <span class="op">===</span> <span class="bu">root</span> <span class="op">?</span> <span class="fu">zoomout</span>(<span class="bu">root</span>) <span class="op">:</span> <span class="fu">zoomin</span>(d)))<span class="op">;</span></span>
<span id="cb111-2541"><a href="#cb111-2541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-2542"><a href="#cb111-2542" aria-hidden="true" tabindex="-1"></a>    <span class="co">// node.append("title").text((d) =&gt; `${name(d)}\n${formatTree(d.value)}`);</span></span>
<span id="cb111-2543"><a href="#cb111-2543" aria-hidden="true" tabindex="-1"></a>    node</span>
<span id="cb111-2544"><a href="#cb111-2544" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">on</span>(<span class="st">"mousemove"</span><span class="op">,</span> (<span class="bu">event</span><span class="op">,</span> d) <span class="kw">=&gt;</span> {</span>
<span id="cb111-2545"><a href="#cb111-2545" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> tipData <span class="op">=</span> d<span class="op">.</span><span class="at">data</span><span class="op">;</span></span>
<span id="cb111-2546"><a href="#cb111-2546" aria-hidden="true" tabindex="-1"></a>        tooltip</span>
<span id="cb111-2547"><a href="#cb111-2547" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">style</span>(<span class="st">"top"</span><span class="op">,</span> <span class="bu">event</span><span class="op">.</span><span class="at">pageY</span> <span class="op">-</span> <span class="dv">10</span> <span class="op">+</span> <span class="st">"px"</span>)</span>
<span id="cb111-2548"><a href="#cb111-2548" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">style</span>(<span class="st">"left"</span><span class="op">,</span> <span class="bu">event</span><span class="op">.</span><span class="at">pageX</span> <span class="op">+</span> <span class="dv">10</span> <span class="op">+</span> <span class="st">"px"</span>)</span>
<span id="cb111-2549"><a href="#cb111-2549" aria-hidden="true" tabindex="-1"></a>          <span class="co">// .transition()</span></span>
<span id="cb111-2550"><a href="#cb111-2550" aria-hidden="true" tabindex="-1"></a>          <span class="co">// .duration(200)</span></span>
<span id="cb111-2551"><a href="#cb111-2551" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">style</span>(<span class="st">"opacity"</span><span class="op">,</span> <span class="dv">1</span>)</span>
<span id="cb111-2552"><a href="#cb111-2552" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">style</span>(<span class="st">"display"</span><span class="op">,</span> <span class="st">"block"</span>)</span>
<span id="cb111-2553"><a href="#cb111-2553" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">html</span>(<span class="vs">`</span><span class="sc">${</span><span class="fu">translateCrop</span>(<span class="fu">name</span>(d))<span class="sc">}</span><span class="vs"> - </span><span class="sc">${</span><span class="fu">formatTree</span>(d<span class="op">.</span><span class="at">value</span>)<span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span></span>
<span id="cb111-2554"><a href="#cb111-2554" aria-hidden="true" tabindex="-1"></a>      })</span>
<span id="cb111-2555"><a href="#cb111-2555" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">on</span>(<span class="st">"mouseout"</span><span class="op">,</span> <span class="kw">function</span> (<span class="bu">event</span>) {</span>
<span id="cb111-2556"><a href="#cb111-2556" aria-hidden="true" tabindex="-1"></a>        d3<span class="op">.</span><span class="fu">select</span>(<span class="st">".plotTooltip"</span>)</span>
<span id="cb111-2557"><a href="#cb111-2557" aria-hidden="true" tabindex="-1"></a>          <span class="co">// .transition()</span></span>
<span id="cb111-2558"><a href="#cb111-2558" aria-hidden="true" tabindex="-1"></a>          <span class="co">// .duration(200)</span></span>
<span id="cb111-2559"><a href="#cb111-2559" aria-hidden="true" tabindex="-1"></a>          <span class="co">// .style("opacity", 0)</span></span>
<span id="cb111-2560"><a href="#cb111-2560" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">style</span>(<span class="st">"display"</span><span class="op">,</span> <span class="st">"none"</span>)<span class="op">;</span></span>
<span id="cb111-2561"><a href="#cb111-2561" aria-hidden="true" tabindex="-1"></a>      })<span class="op">;</span></span>
<span id="cb111-2562"><a href="#cb111-2562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-2563"><a href="#cb111-2563" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> rects <span class="op">=</span> node</span>
<span id="cb111-2564"><a href="#cb111-2564" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"rect"</span>)</span>
<span id="cb111-2565"><a href="#cb111-2565" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> (d) <span class="kw">=&gt;</span> (d<span class="op">.</span><span class="at">leafUid</span> <span class="op">=</span> DOM<span class="op">.</span><span class="fu">uid</span>(<span class="st">"leaf"</span>))<span class="op">.</span><span class="at">id</span>)</span>
<span id="cb111-2566"><a href="#cb111-2566" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> (d) <span class="kw">=&gt;</span></span>
<span id="cb111-2567"><a href="#cb111-2567" aria-hidden="true" tabindex="-1"></a>        d <span class="op">===</span> <span class="bu">root</span></span>
<span id="cb111-2568"><a href="#cb111-2568" aria-hidden="true" tabindex="-1"></a>          <span class="op">?</span> <span class="st">"#e6e6e6"</span></span>
<span id="cb111-2569"><a href="#cb111-2569" aria-hidden="true" tabindex="-1"></a>          <span class="op">:</span> d<span class="op">.</span><span class="at">children</span></span>
<span id="cb111-2570"><a href="#cb111-2570" aria-hidden="true" tabindex="-1"></a>            <span class="op">?</span> <span class="fu">colorScale</span>(d<span class="op">.</span><span class="at">value</span>)</span>
<span id="cb111-2571"><a href="#cb111-2571" aria-hidden="true" tabindex="-1"></a>            <span class="op">:</span> <span class="fu">colorScale</span>(d<span class="op">.</span><span class="at">value</span>)<span class="op">,</span></span>
<span id="cb111-2572"><a href="#cb111-2572" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb111-2573"><a href="#cb111-2573" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"#e6e6e6"</span>)<span class="op">;</span></span>
<span id="cb111-2574"><a href="#cb111-2574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-2575"><a href="#cb111-2575" aria-hidden="true" tabindex="-1"></a>    node</span>
<span id="cb111-2576"><a href="#cb111-2576" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"clipPath"</span>)</span>
<span id="cb111-2577"><a href="#cb111-2577" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> (d) <span class="kw">=&gt;</span> (d<span class="op">.</span><span class="at">clipUid</span> <span class="op">=</span> DOM<span class="op">.</span><span class="fu">uid</span>(<span class="st">"clip"</span>))<span class="op">.</span><span class="at">id</span>)</span>
<span id="cb111-2578"><a href="#cb111-2578" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"use"</span>)</span>
<span id="cb111-2579"><a href="#cb111-2579" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"xlink:href"</span><span class="op">,</span> (d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">leafUid</span><span class="op">.</span><span class="at">href</span>)<span class="op">;</span></span>
<span id="cb111-2580"><a href="#cb111-2580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-2581"><a href="#cb111-2581" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> text <span class="op">=</span> node</span>
<span id="cb111-2582"><a href="#cb111-2582" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb111-2583"><a href="#cb111-2583" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"clip-path"</span><span class="op">,</span> (d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">clipUid</span>)</span>
<span id="cb111-2584"><a href="#cb111-2584" aria-hidden="true" tabindex="-1"></a>      <span class="co">// .attr("font-weight", (d) =&gt; (d === root ? "bold" : null))</span></span>
<span id="cb111-2585"><a href="#cb111-2585" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> (d) <span class="kw">=&gt;</span></span>
<span id="cb111-2586"><a href="#cb111-2586" aria-hidden="true" tabindex="-1"></a>        d <span class="op">===</span> <span class="bu">root</span> <span class="op">?</span> <span class="st">"20px"</span> <span class="op">:</span> d<span class="op">.</span><span class="at">children</span> <span class="op">?</span> <span class="st">"15px"</span> <span class="op">:</span> <span class="st">"14px"</span><span class="op">,</span></span>
<span id="cb111-2587"><a href="#cb111-2587" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb111-2588"><a href="#cb111-2588" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"tspan"</span>)</span>
<span id="cb111-2589"><a href="#cb111-2589" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>((d) <span class="kw">=&gt;</span></span>
<span id="cb111-2590"><a href="#cb111-2590" aria-hidden="true" tabindex="-1"></a>        (d <span class="op">===</span> <span class="bu">root</span></span>
<span id="cb111-2591"><a href="#cb111-2591" aria-hidden="true" tabindex="-1"></a>          <span class="op">?</span> (</span>
<span id="cb111-2592"><a href="#cb111-2592" aria-hidden="true" tabindex="-1"></a>              <span class="fu">translateCrop</span>(<span class="fu">name</span>(d)) <span class="op">+</span></span>
<span id="cb111-2593"><a href="#cb111-2593" aria-hidden="true" tabindex="-1"></a>              <span class="st">" "</span> <span class="op">+</span></span>
<span id="cb111-2594"><a href="#cb111-2594" aria-hidden="true" tabindex="-1"></a>              <span class="fu">_lang</span>(</span>
<span id="cb111-2595"><a href="#cb111-2595" aria-hidden="true" tabindex="-1"></a>                nbText<span class="op">.</span><span class="at">ViewExplore</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">visualiseVars</span><span class="op">.</span><span class="at">exposure</span></span>
<span id="cb111-2596"><a href="#cb111-2596" aria-hidden="true" tabindex="-1"></a>                  <span class="op">.</span><span class="at">exposureVariable</span><span class="op">.</span><span class="at">options</span>[exposure_var]<span class="op">,</span></span>
<span id="cb111-2597"><a href="#cb111-2597" aria-hidden="true" tabindex="-1"></a>              ) <span class="op">+</span></span>
<span id="cb111-2598"><a href="#cb111-2598" aria-hidden="true" tabindex="-1"></a>              <span class="st">":"</span></span>
<span id="cb111-2599"><a href="#cb111-2599" aria-hidden="true" tabindex="-1"></a>            )<span class="op">.</span><span class="fu">split</span>(<span class="ss">/</span><span class="sc">(?</span><span class="ss">=</span><span class="sc">[A-Z][&amp;][^A-Z])</span><span class="ss">/g</span>)</span>
<span id="cb111-2600"><a href="#cb111-2600" aria-hidden="true" tabindex="-1"></a>          <span class="op">:</span> <span class="co">// : d.data.name.split(/(?=[A-Z][^A-Z])/g)</span></span>
<span id="cb111-2601"><a href="#cb111-2601" aria-hidden="true" tabindex="-1"></a>            <span class="fu">translateCrop</span>(<span class="fu">name</span>(d))<span class="op">.</span><span class="fu">split</span>(<span class="ss">/</span><span class="sc">(?</span><span class="ss">=</span><span class="sc">[A-Z][^A-Z])</span><span class="ss">/g</span>)</span>
<span id="cb111-2602"><a href="#cb111-2602" aria-hidden="true" tabindex="-1"></a>        ) <span class="co">//.concat(d.value)</span></span>
<span id="cb111-2603"><a href="#cb111-2603" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">concat</span>(<span class="fu">formatTree</span>(d<span class="op">.</span><span class="at">value</span>))<span class="op">,</span></span>
<span id="cb111-2604"><a href="#cb111-2604" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb111-2605"><a href="#cb111-2605" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">join</span>(<span class="st">"tspan"</span>)</span>
<span id="cb111-2606"><a href="#cb111-2606" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> <span class="dv">3</span>)</span>
<span id="cb111-2607"><a href="#cb111-2607" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(</span>
<span id="cb111-2608"><a href="#cb111-2608" aria-hidden="true" tabindex="-1"></a>        <span class="st">"y"</span><span class="op">,</span></span>
<span id="cb111-2609"><a href="#cb111-2609" aria-hidden="true" tabindex="-1"></a>        (d<span class="op">,</span> i<span class="op">,</span> nodes) <span class="kw">=&gt;</span> <span class="vs">`</span><span class="sc">${</span>(i <span class="op">===</span> nodes<span class="op">.</span><span class="at">length</span> <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> <span class="fl">0.3</span> <span class="op">+</span> <span class="fl">1.1</span> <span class="op">+</span> i <span class="op">*</span> <span class="fl">0.9</span><span class="sc">}</span><span class="vs">em`</span><span class="op">,</span></span>
<span id="cb111-2610"><a href="#cb111-2610" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb111-2611"><a href="#cb111-2611" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill-opacity"</span><span class="op">,</span> (d<span class="op">,</span> i<span class="op">,</span> nodes) <span class="kw">=&gt;</span></span>
<span id="cb111-2612"><a href="#cb111-2612" aria-hidden="true" tabindex="-1"></a>        i <span class="op">===</span> nodes<span class="op">.</span><span class="at">length</span> <span class="op">-</span> <span class="dv">1</span> <span class="op">?</span> <span class="fl">0.7</span> <span class="op">:</span> <span class="kw">null</span><span class="op">,</span></span>
<span id="cb111-2613"><a href="#cb111-2613" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb111-2614"><a href="#cb111-2614" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-weight"</span><span class="op">,</span> (d<span class="op">,</span> i<span class="op">,</span> nodes) <span class="kw">=&gt;</span></span>
<span id="cb111-2615"><a href="#cb111-2615" aria-hidden="true" tabindex="-1"></a>        i <span class="op">===</span> nodes<span class="op">.</span><span class="at">length</span> <span class="op">-</span> <span class="dv">1</span> <span class="op">?</span> <span class="st">"normal"</span> <span class="op">:</span> <span class="kw">null</span><span class="op">,</span></span>
<span id="cb111-2616"><a href="#cb111-2616" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb111-2617"><a href="#cb111-2617" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">text</span>((d) <span class="kw">=&gt;</span> d)<span class="op">;</span></span>
<span id="cb111-2618"><a href="#cb111-2618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-2619"><a href="#cb111-2619" aria-hidden="true" tabindex="-1"></a>    group<span class="op">.</span><span class="fu">call</span>(position<span class="op">,</span> <span class="bu">root</span>)<span class="op">;</span></span>
<span id="cb111-2620"><a href="#cb111-2620" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb111-2621"><a href="#cb111-2621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-2622"><a href="#cb111-2622" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">position</span>(group<span class="op">,</span> <span class="bu">root</span>) {</span>
<span id="cb111-2623"><a href="#cb111-2623" aria-hidden="true" tabindex="-1"></a>    group</span>
<span id="cb111-2624"><a href="#cb111-2624" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"g"</span>)</span>
<span id="cb111-2625"><a href="#cb111-2625" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> (d) <span class="kw">=&gt;</span></span>
<span id="cb111-2626"><a href="#cb111-2626" aria-hidden="true" tabindex="-1"></a>        d <span class="op">===</span> <span class="bu">root</span> <span class="op">?</span> <span class="vs">`translate(0,-55)`</span> <span class="op">:</span> <span class="vs">`translate(</span><span class="sc">${</span><span class="fu">x</span>(d<span class="op">.</span><span class="at">x0</span>)<span class="sc">}</span><span class="vs">,</span><span class="sc">${</span><span class="fu">y</span>(d<span class="op">.</span><span class="at">y0</span>)<span class="sc">}</span><span class="vs">)`</span><span class="op">,</span></span>
<span id="cb111-2627"><a href="#cb111-2627" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb111-2628"><a href="#cb111-2628" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"rect"</span>)</span>
<span id="cb111-2629"><a href="#cb111-2629" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> (d) <span class="kw">=&gt;</span> (d <span class="op">===</span> <span class="bu">root</span> <span class="op">?</span> width <span class="op">:</span> <span class="fu">x</span>(d<span class="op">.</span><span class="at">x1</span>) <span class="op">-</span> <span class="fu">x</span>(d<span class="op">.</span><span class="at">x0</span>)))</span>
<span id="cb111-2630"><a href="#cb111-2630" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> (d) <span class="kw">=&gt;</span> (d <span class="op">===</span> <span class="bu">root</span> <span class="op">?</span> <span class="dv">55</span> <span class="op">:</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">y1</span>) <span class="op">-</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">y0</span>)))<span class="op">;</span></span>
<span id="cb111-2631"><a href="#cb111-2631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-2632"><a href="#cb111-2632" aria-hidden="true" tabindex="-1"></a>    group<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"text"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"opacity"</span><span class="op">,</span> (d) <span class="kw">=&gt;</span> {</span>
<span id="cb111-2633"><a href="#cb111-2633" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> rect_width <span class="op">=</span> <span class="fu">x</span>(d<span class="op">.</span><span class="at">x1</span>) <span class="op">-</span> <span class="fu">x</span>(d<span class="op">.</span><span class="at">x0</span>)<span class="op">;</span></span>
<span id="cb111-2634"><a href="#cb111-2634" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> rect_height <span class="op">=</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">y1</span>) <span class="op">-</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">y0</span>)<span class="op">;</span></span>
<span id="cb111-2635"><a href="#cb111-2635" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> rect_height <span class="op">&lt;</span> <span class="dv">70</span> <span class="op">||</span> rect_width <span class="op">&lt;</span> <span class="dv">70</span> <span class="op">?</span> <span class="dv">0</span> <span class="op">:</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb111-2636"><a href="#cb111-2636" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb111-2637"><a href="#cb111-2637" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb111-2638"><a href="#cb111-2638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-2639"><a href="#cb111-2639" aria-hidden="true" tabindex="-1"></a>  <span class="co">// When zooming in, draw the new nodes on top, and fade them in.</span></span>
<span id="cb111-2640"><a href="#cb111-2640" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">zoomin</span>(d) {</span>
<span id="cb111-2641"><a href="#cb111-2641" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> group0 <span class="op">=</span> group<span class="op">.</span><span class="fu">attr</span>(<span class="st">"pointer-events"</span><span class="op">,</span> <span class="st">"none"</span>)<span class="op">;</span></span>
<span id="cb111-2642"><a href="#cb111-2642" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> group1 <span class="op">=</span> (group <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)<span class="op">.</span><span class="fu">call</span>(render<span class="op">,</span> d))<span class="op">;</span></span>
<span id="cb111-2643"><a href="#cb111-2643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-2644"><a href="#cb111-2644" aria-hidden="true" tabindex="-1"></a>    x<span class="op">.</span><span class="fu">domain</span>([d<span class="op">.</span><span class="at">x0</span><span class="op">,</span> d<span class="op">.</span><span class="at">x1</span>])<span class="op">;</span></span>
<span id="cb111-2645"><a href="#cb111-2645" aria-hidden="true" tabindex="-1"></a>    y<span class="op">.</span><span class="fu">domain</span>([d<span class="op">.</span><span class="at">y0</span><span class="op">,</span> d<span class="op">.</span><span class="at">y1</span>])<span class="op">;</span></span>
<span id="cb111-2646"><a href="#cb111-2646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-2647"><a href="#cb111-2647" aria-hidden="true" tabindex="-1"></a>    svg</span>
<span id="cb111-2648"><a href="#cb111-2648" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb111-2649"><a href="#cb111-2649" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">duration</span>(<span class="dv">750</span>)</span>
<span id="cb111-2650"><a href="#cb111-2650" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">call</span>((t) <span class="kw">=&gt;</span> group0<span class="op">.</span><span class="fu">transition</span>(t)<span class="op">.</span><span class="fu">remove</span>()<span class="op">.</span><span class="fu">call</span>(position<span class="op">,</span> d<span class="op">.</span><span class="at">parent</span>))</span>
<span id="cb111-2651"><a href="#cb111-2651" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">call</span>((t) <span class="kw">=&gt;</span></span>
<span id="cb111-2652"><a href="#cb111-2652" aria-hidden="true" tabindex="-1"></a>        group1</span>
<span id="cb111-2653"><a href="#cb111-2653" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">transition</span>(t)</span>
<span id="cb111-2654"><a href="#cb111-2654" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attrTween</span>(<span class="st">"opacity"</span><span class="op">,</span> () <span class="kw">=&gt;</span> d3<span class="op">.</span><span class="fu">interpolate</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">1</span>))</span>
<span id="cb111-2655"><a href="#cb111-2655" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">call</span>(position<span class="op">,</span> d)<span class="op">,</span></span>
<span id="cb111-2656"><a href="#cb111-2656" aria-hidden="true" tabindex="-1"></a>      )<span class="op">;</span></span>
<span id="cb111-2657"><a href="#cb111-2657" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb111-2658"><a href="#cb111-2658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-2659"><a href="#cb111-2659" aria-hidden="true" tabindex="-1"></a>  <span class="co">// When zooming out, draw the old nodes on top, and fade them out.</span></span>
<span id="cb111-2660"><a href="#cb111-2660" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">zoomout</span>(d) {</span>
<span id="cb111-2661"><a href="#cb111-2661" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> group0 <span class="op">=</span> group<span class="op">.</span><span class="fu">attr</span>(<span class="st">"pointer-events"</span><span class="op">,</span> <span class="st">"none"</span>)<span class="op">;</span></span>
<span id="cb111-2662"><a href="#cb111-2662" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> group1 <span class="op">=</span> (group <span class="op">=</span> svg<span class="op">.</span><span class="fu">insert</span>(<span class="st">"g"</span><span class="op">,</span> <span class="st">"*"</span>)<span class="op">.</span><span class="fu">call</span>(render<span class="op">,</span> d<span class="op">.</span><span class="at">parent</span>))<span class="op">;</span></span>
<span id="cb111-2663"><a href="#cb111-2663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-2664"><a href="#cb111-2664" aria-hidden="true" tabindex="-1"></a>    x<span class="op">.</span><span class="fu">domain</span>([d<span class="op">.</span><span class="at">parent</span><span class="op">.</span><span class="at">x0</span><span class="op">,</span> d<span class="op">.</span><span class="at">parent</span><span class="op">.</span><span class="at">x1</span>])<span class="op">;</span></span>
<span id="cb111-2665"><a href="#cb111-2665" aria-hidden="true" tabindex="-1"></a>    y<span class="op">.</span><span class="fu">domain</span>([d<span class="op">.</span><span class="at">parent</span><span class="op">.</span><span class="at">y0</span><span class="op">,</span> d<span class="op">.</span><span class="at">parent</span><span class="op">.</span><span class="at">y1</span>])<span class="op">;</span></span>
<span id="cb111-2666"><a href="#cb111-2666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-2667"><a href="#cb111-2667" aria-hidden="true" tabindex="-1"></a>    svg</span>
<span id="cb111-2668"><a href="#cb111-2668" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb111-2669"><a href="#cb111-2669" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">duration</span>(<span class="dv">750</span>)</span>
<span id="cb111-2670"><a href="#cb111-2670" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">call</span>((t) <span class="kw">=&gt;</span></span>
<span id="cb111-2671"><a href="#cb111-2671" aria-hidden="true" tabindex="-1"></a>        group0</span>
<span id="cb111-2672"><a href="#cb111-2672" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">transition</span>(t)</span>
<span id="cb111-2673"><a href="#cb111-2673" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">remove</span>()</span>
<span id="cb111-2674"><a href="#cb111-2674" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attrTween</span>(<span class="st">"opacity"</span><span class="op">,</span> () <span class="kw">=&gt;</span> d3<span class="op">.</span><span class="fu">interpolate</span>(<span class="dv">1</span><span class="op">,</span> <span class="dv">0</span>))</span>
<span id="cb111-2675"><a href="#cb111-2675" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">call</span>(position<span class="op">,</span> d)<span class="op">,</span></span>
<span id="cb111-2676"><a href="#cb111-2676" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb111-2677"><a href="#cb111-2677" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">call</span>((t) <span class="kw">=&gt;</span> group1<span class="op">.</span><span class="fu">transition</span>(t)<span class="op">.</span><span class="fu">call</span>(position<span class="op">,</span> d<span class="op">.</span><span class="at">parent</span>))<span class="op">;</span></span>
<span id="cb111-2678"><a href="#cb111-2678" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb111-2679"><a href="#cb111-2679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-2680"><a href="#cb111-2680" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> svg<span class="op">.</span><span class="fu">node</span>()<span class="op">;</span></span>
<span id="cb111-2681"><a href="#cb111-2681" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-111" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb112" data-startfrom="2685" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2684"><span id="cb112-2685"><a href="#cb112-2685" aria-hidden="true" tabindex="-1"></a>hazard_stackBar <span class="op">=</span> <span class="kw">async</span> (hazard) <span class="kw">=&gt;</span> {</span>
<span id="cb112-2686"><a href="#cb112-2686" aria-hidden="true" tabindex="-1"></a>  <span class="co">// const data = bar_data[hazard];</span></span>
<span id="cb112-2687"><a href="#cb112-2687" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> data <span class="op">=</span> <span class="fu">classifyAndCount</span>(</span>
<span id="cb112-2688"><a href="#cb112-2688" aria-hidden="true" tabindex="-1"></a>    <span class="cf">await</span> db<span class="op">.</span><span class="fu">query</span>(</span>
<span id="cb112-2689"><a href="#cb112-2689" aria-hidden="true" tabindex="-1"></a>      <span class="vs">`SELECT * From Hazard </span><span class="sc">${</span>mapDataQuery_admin<span class="sc">}</span><span class="vs"> and "hazard" = '</span><span class="sc">${</span>hazard<span class="sc">}</span><span class="vs">' and "timeframe" in ('</span><span class="sc">${</span>DataSelector_form<span class="op">.</span><span class="at">hazardGroup_form</span><span class="op">.</span><span class="at">timeperiod_sel</span><span class="op">.</span><span class="fu">join</span>(</span>
<span id="cb112-2690"><a href="#cb112-2690" aria-hidden="true" tabindex="-1"></a>        <span class="st">"', '"</span><span class="op">,</span></span>
<span id="cb112-2691"><a href="#cb112-2691" aria-hidden="true" tabindex="-1"></a>      )<span class="sc">}</span><span class="vs">')`</span><span class="op">,</span></span>
<span id="cb112-2692"><a href="#cb112-2692" aria-hidden="true" tabindex="-1"></a>    )<span class="op">,</span></span>
<span id="cb112-2693"><a href="#cb112-2693" aria-hidden="true" tabindex="-1"></a>  )[hazard]<span class="op">;</span></span>
<span id="cb112-2694"><a href="#cb112-2694" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> colors <span class="op">=</span> hazard_dict[hazard]<span class="op">.</span><span class="at">colours</span><span class="op">;</span></span>
<span id="cb112-2695"><a href="#cb112-2695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-2696"><a href="#cb112-2696" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> labels <span class="op">=</span> [<span class="st">"low"</span><span class="op">,</span> <span class="st">"moderate"</span><span class="op">,</span> <span class="st">"severe"</span><span class="op">,</span> <span class="st">"extreme"</span><span class="op">,</span> <span class="st">"Vextreme"</span>]<span class="op">.</span><span class="fu">slice</span>(</span>
<span id="cb112-2697"><a href="#cb112-2697" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span><span class="op">,</span></span>
<span id="cb112-2698"><a href="#cb112-2698" aria-hidden="true" tabindex="-1"></a>    colors<span class="op">.</span><span class="at">length</span><span class="op">,</span></span>
<span id="cb112-2699"><a href="#cb112-2699" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb112-2700"><a href="#cb112-2700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-2701"><a href="#cb112-2701" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> transformedData <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb112-2702"><a href="#cb112-2702" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">const</span> scenario <span class="kw">in</span> data) {</span>
<span id="cb112-2703"><a href="#cb112-2703" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (<span class="kw">const</span> period <span class="kw">in</span> data[scenario]) {</span>
<span id="cb112-2704"><a href="#cb112-2704" aria-hidden="true" tabindex="-1"></a>      transformedData<span class="op">.</span><span class="fu">push</span>({</span>
<span id="cb112-2705"><a href="#cb112-2705" aria-hidden="true" tabindex="-1"></a>        scenario<span class="op">,</span></span>
<span id="cb112-2706"><a href="#cb112-2706" aria-hidden="true" tabindex="-1"></a>        period<span class="op">,</span></span>
<span id="cb112-2707"><a href="#cb112-2707" aria-hidden="true" tabindex="-1"></a>        <span class="dt">values</span><span class="op">:</span> data[scenario][period]<span class="op">,</span></span>
<span id="cb112-2708"><a href="#cb112-2708" aria-hidden="true" tabindex="-1"></a>      })<span class="op">;</span></span>
<span id="cb112-2709"><a href="#cb112-2709" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb112-2710"><a href="#cb112-2710" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb112-2711"><a href="#cb112-2711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-2712"><a href="#cb112-2712" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> width <span class="op">=</span> <span class="dv">750</span><span class="op">;</span></span>
<span id="cb112-2713"><a href="#cb112-2713" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> height <span class="op">=</span> <span class="dv">600</span><span class="op">;</span></span>
<span id="cb112-2714"><a href="#cb112-2714" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> margin <span class="op">=</span> { <span class="dt">top</span><span class="op">:</span> <span class="dv">30</span><span class="op">,</span> <span class="dt">right</span><span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dt">bottom</span><span class="op">:</span> <span class="dv">15</span><span class="op">,</span> <span class="dt">left</span><span class="op">:</span> <span class="dv">40</span> }<span class="op">;</span></span>
<span id="cb112-2715"><a href="#cb112-2715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-2716"><a href="#cb112-2716" aria-hidden="true" tabindex="-1"></a>  <span class="co">// SVG Container</span></span>
<span id="cb112-2717"><a href="#cb112-2717" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> svg <span class="op">=</span> d3</span>
<span id="cb112-2718"><a href="#cb112-2718" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">create</span>(<span class="st">"svg"</span>)</span>
<span id="cb112-2719"><a href="#cb112-2719" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"viewBox"</span><span class="op">,</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> width<span class="op">,</span> height])</span>
<span id="cb112-2720"><a href="#cb112-2720" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> width)</span>
<span id="cb112-2721"><a href="#cb112-2721" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> height)<span class="op">;</span></span>
<span id="cb112-2722"><a href="#cb112-2722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-2723"><a href="#cb112-2723" aria-hidden="true" tabindex="-1"></a>  d3<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".plotTooltip"</span>)<span class="op">.</span><span class="fu">remove</span>()<span class="op">;</span></span>
<span id="cb112-2724"><a href="#cb112-2724" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> tooltip <span class="op">=</span> d3</span>
<span id="cb112-2725"><a href="#cb112-2725" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">select</span>(<span class="st">"body"</span>)</span>
<span id="cb112-2726"><a href="#cb112-2726" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"div"</span>)</span>
<span id="cb112-2727"><a href="#cb112-2727" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"plotTooltip barTip"</span>)</span>
<span id="cb112-2728"><a href="#cb112-2728" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"position"</span><span class="op">,</span> <span class="st">"absolute"</span>)<span class="op">;</span></span>
<span id="cb112-2729"><a href="#cb112-2729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-2730"><a href="#cb112-2730" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Set up x and y scales</span></span>
<span id="cb112-2731"><a href="#cb112-2731" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> sortOrder <span class="op">=</span> [</span>
<span id="cb112-2732"><a href="#cb112-2732" aria-hidden="true" tabindex="-1"></a>    <span class="st">"historic_historic"</span><span class="op">,</span></span>
<span id="cb112-2733"><a href="#cb112-2733" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ssp245_2021_2040"</span><span class="op">,</span></span>
<span id="cb112-2734"><a href="#cb112-2734" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ssp585_2021_2040"</span><span class="op">,</span></span>
<span id="cb112-2735"><a href="#cb112-2735" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ssp245_2041_2060"</span><span class="op">,</span></span>
<span id="cb112-2736"><a href="#cb112-2736" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ssp585_2041_2060"</span><span class="op">,</span></span>
<span id="cb112-2737"><a href="#cb112-2737" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">;</span></span>
<span id="cb112-2738"><a href="#cb112-2738" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> x <span class="op">=</span> d3</span>
<span id="cb112-2739"><a href="#cb112-2739" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">scaleBand</span>()</span>
<span id="cb112-2740"><a href="#cb112-2740" aria-hidden="true" tabindex="-1"></a>    <span class="co">// .domain(transformedData.map((d) =&gt; `${d.scenario}_${d.period}`))</span></span>
<span id="cb112-2741"><a href="#cb112-2741" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>(</span>
<span id="cb112-2742"><a href="#cb112-2742" aria-hidden="true" tabindex="-1"></a>      sortOrder<span class="op">.</span><span class="fu">filter</span>((d) <span class="kw">=&gt;</span></span>
<span id="cb112-2743"><a href="#cb112-2743" aria-hidden="true" tabindex="-1"></a>        transformedData<span class="op">.</span><span class="fu">some</span>((e) <span class="kw">=&gt;</span> e<span class="op">.</span><span class="at">scenario</span> <span class="op">+</span> <span class="st">"_"</span> <span class="op">+</span> e<span class="op">.</span><span class="at">period</span> <span class="op">===</span> d)<span class="op">,</span></span>
<span id="cb112-2744"><a href="#cb112-2744" aria-hidden="true" tabindex="-1"></a>      )<span class="op">,</span></span>
<span id="cb112-2745"><a href="#cb112-2745" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb112-2746"><a href="#cb112-2746" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>([margin<span class="op">.</span><span class="at">left</span><span class="op">,</span> width])</span>
<span id="cb112-2747"><a href="#cb112-2747" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">padding</span>(<span class="fl">0.1</span>)<span class="op">;</span></span>
<span id="cb112-2748"><a href="#cb112-2748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-2749"><a href="#cb112-2749" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> y <span class="op">=</span> d3</span>
<span id="cb112-2750"><a href="#cb112-2750" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb112-2751"><a href="#cb112-2751" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="dv">0</span><span class="op">,</span> d3<span class="op">.</span><span class="fu">max</span>(transformedData<span class="op">,</span> (d) <span class="kw">=&gt;</span> d3<span class="op">.</span><span class="fu">sum</span>(d<span class="op">.</span><span class="at">values</span>))])</span>
<span id="cb112-2752"><a href="#cb112-2752" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">nice</span>()</span>
<span id="cb112-2753"><a href="#cb112-2753" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>([height <span class="op">-</span> margin<span class="op">.</span><span class="at">bottom</span><span class="op">,</span> margin<span class="op">.</span><span class="at">top</span>])<span class="op">;</span></span>
<span id="cb112-2754"><a href="#cb112-2754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-2755"><a href="#cb112-2755" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Add x and y axes</span></span>
<span id="cb112-2756"><a href="#cb112-2756" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb112-2757"><a href="#cb112-2757" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb112-2758"><a href="#cb112-2758" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"x-axis"</span>)</span>
<span id="cb112-2759"><a href="#cb112-2759" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(0,</span><span class="sc">${</span>height <span class="op">-</span> margin<span class="op">.</span><span class="at">bottom</span><span class="sc">}</span><span class="vs">)`</span>)</span>
<span id="cb112-2760"><a href="#cb112-2760" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>(</span>
<span id="cb112-2761"><a href="#cb112-2761" aria-hidden="true" tabindex="-1"></a>      d3</span>
<span id="cb112-2762"><a href="#cb112-2762" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">axisBottom</span>(x)</span>
<span id="cb112-2763"><a href="#cb112-2763" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">tickSize</span>(<span class="dv">0</span>)</span>
<span id="cb112-2764"><a href="#cb112-2764" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">tickFormat</span>((d) <span class="kw">=&gt;</span> {</span>
<span id="cb112-2765"><a href="#cb112-2765" aria-hidden="true" tabindex="-1"></a>          <span class="cf">return</span> d <span class="op">===</span> <span class="st">"historic_historic"</span></span>
<span id="cb112-2766"><a href="#cb112-2766" aria-hidden="true" tabindex="-1"></a>            <span class="op">?</span> <span class="fu">_lang</span>(</span>
<span id="cb112-2767"><a href="#cb112-2767" aria-hidden="true" tabindex="-1"></a>                nbText<span class="op">.</span><span class="at">selectVars</span><span class="op">.</span><span class="at">forms</span><span class="op">.</span><span class="at">Hazard</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">period</span><span class="op">.</span><span class="at">options</span></span>
<span id="cb112-2768"><a href="#cb112-2768" aria-hidden="true" tabindex="-1"></a>                  <span class="op">.</span><span class="at">historic</span><span class="op">,</span></span>
<span id="cb112-2769"><a href="#cb112-2769" aria-hidden="true" tabindex="-1"></a>              )</span>
<span id="cb112-2770"><a href="#cb112-2770" aria-hidden="true" tabindex="-1"></a>            <span class="op">:</span> <span class="vs">`</span><span class="sc">${</span>d<span class="op">.</span><span class="fu">split</span>(<span class="st">"_"</span>)[<span class="dv">2</span>]<span class="sc">}</span><span class="vs"> (</span><span class="sc">${</span>d<span class="op">.</span><span class="fu">split</span>(<span class="st">"_"</span>)[<span class="dv">0</span>]<span class="op">.</span><span class="fu">toUpperCase</span>()<span class="sc">}</span><span class="vs">)`</span><span class="op">;</span></span>
<span id="cb112-2771"><a href="#cb112-2771" aria-hidden="true" tabindex="-1"></a>        })<span class="op">,</span></span>
<span id="cb112-2772"><a href="#cb112-2772" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb112-2773"><a href="#cb112-2773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-2774"><a href="#cb112-2774" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb112-2775"><a href="#cb112-2775" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb112-2776"><a href="#cb112-2776" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"y-axis"</span>)</span>
<span id="cb112-2777"><a href="#cb112-2777" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>margin<span class="op">.</span><span class="at">left</span><span class="sc">}</span><span class="vs">,0)`</span>)</span>
<span id="cb112-2778"><a href="#cb112-2778" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>(d3<span class="op">.</span><span class="fu">axisLeft</span>(y)<span class="op">.</span><span class="fu">tickSize</span>(<span class="dv">0</span>))</span>
<span id="cb112-2779"><a href="#cb112-2779" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".tick text"</span>) <span class="co">// select the text elements of the ticks</span></span>
<span id="cb112-2780"><a href="#cb112-2780" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dy"</span><span class="op">,</span> <span class="st">"0.5em"</span>)</span>
<span id="cb112-2781"><a href="#cb112-2781" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"end"</span>)<span class="op">;</span></span>
<span id="cb112-2782"><a href="#cb112-2782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-2783"><a href="#cb112-2783" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Create stacks</span></span>
<span id="cb112-2784"><a href="#cb112-2784" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> stack <span class="op">=</span> d3</span>
<span id="cb112-2785"><a href="#cb112-2785" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">stack</span>()</span>
<span id="cb112-2786"><a href="#cb112-2786" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">keys</span>(d3<span class="op">.</span><span class="fu">range</span>(transformedData[<span class="dv">0</span>]<span class="op">.</span><span class="at">values</span><span class="op">.</span><span class="at">length</span>))</span>
<span id="cb112-2787"><a href="#cb112-2787" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">value</span>((d<span class="op">,</span> key) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">values</span>[key])<span class="op">;</span></span>
<span id="cb112-2788"><a href="#cb112-2788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-2789"><a href="#cb112-2789" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> series <span class="op">=</span> <span class="fu">stack</span>(transformedData)<span class="op">;</span></span>
<span id="cb112-2790"><a href="#cb112-2790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-2791"><a href="#cb112-2791" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Add bars</span></span>
<span id="cb112-2792"><a href="#cb112-2792" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> bars <span class="op">=</span> svg</span>
<span id="cb112-2793"><a href="#cb112-2793" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb112-2794"><a href="#cb112-2794" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"g"</span>)</span>
<span id="cb112-2795"><a href="#cb112-2795" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(series)</span>
<span id="cb112-2796"><a href="#cb112-2796" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">join</span>(<span class="st">"g"</span>)</span>
<span id="cb112-2797"><a href="#cb112-2797" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> (d<span class="op">,</span> i) <span class="kw">=&gt;</span> colors[i])</span>
<span id="cb112-2798"><a href="#cb112-2798" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"rect"</span>)</span>
<span id="cb112-2799"><a href="#cb112-2799" aria-hidden="true" tabindex="-1"></a>    <span class="co">// .data((d) =&gt; d)</span></span>
<span id="cb112-2800"><a href="#cb112-2800" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="fu">map</span>((value) <span class="kw">=&gt;</span> ({ <span class="op">...</span>value<span class="op">,</span> <span class="dt">index</span><span class="op">:</span> d<span class="op">.</span><span class="at">index</span> })))</span>
<span id="cb112-2801"><a href="#cb112-2801" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">join</span>(<span class="st">"rect"</span>)</span>
<span id="cb112-2802"><a href="#cb112-2802" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> (d) <span class="kw">=&gt;</span> <span class="fu">x</span>(<span class="vs">`</span><span class="sc">${</span>d<span class="op">.</span><span class="at">data</span><span class="op">.</span><span class="at">scenario</span><span class="sc">}</span><span class="vs">_</span><span class="sc">${</span>d<span class="op">.</span><span class="at">data</span><span class="op">.</span><span class="at">period</span><span class="sc">}</span><span class="vs">`</span>))</span>
<span id="cb112-2803"><a href="#cb112-2803" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> (d) <span class="kw">=&gt;</span> <span class="fu">y</span>(d[<span class="dv">1</span>]))</span>
<span id="cb112-2804"><a href="#cb112-2804" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> (d) <span class="kw">=&gt;</span> <span class="fu">y</span>(d[<span class="dv">0</span>]) <span class="op">-</span> <span class="fu">y</span>(d[<span class="dv">1</span>]))</span>
<span id="cb112-2805"><a href="#cb112-2805" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> x<span class="op">.</span><span class="fu">bandwidth</span>())<span class="op">;</span></span>
<span id="cb112-2806"><a href="#cb112-2806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-2807"><a href="#cb112-2807" aria-hidden="true" tabindex="-1"></a>  bars</span>
<span id="cb112-2808"><a href="#cb112-2808" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"mouseover"</span><span class="op">,</span> (<span class="bu">event</span><span class="op">,</span> d) <span class="kw">=&gt;</span> {</span>
<span id="cb112-2809"><a href="#cb112-2809" aria-hidden="true" tabindex="-1"></a>      d3<span class="op">.</span><span class="fu">select</span>(<span class="bu">event</span><span class="op">.</span><span class="at">currentTarget</span>)<span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"black"</span>)<span class="op">.</span><span class="fu">raise</span>()<span class="op">;</span></span>
<span id="cb112-2810"><a href="#cb112-2810" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb112-2811"><a href="#cb112-2811" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"mousemove"</span><span class="op">,</span> (<span class="bu">event</span><span class="op">,</span> d) <span class="kw">=&gt;</span> {</span>
<span id="cb112-2812"><a href="#cb112-2812" aria-hidden="true" tabindex="-1"></a>      tooltip</span>
<span id="cb112-2813"><a href="#cb112-2813" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"top"</span><span class="op">,</span> <span class="bu">event</span><span class="op">.</span><span class="at">pageY</span> <span class="op">-</span> <span class="dv">10</span> <span class="op">+</span> <span class="st">"px"</span>)</span>
<span id="cb112-2814"><a href="#cb112-2814" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"left"</span><span class="op">,</span> <span class="bu">event</span><span class="op">.</span><span class="at">pageX</span> <span class="op">+</span> <span class="dv">10</span> <span class="op">+</span> <span class="st">"px"</span>)</span>
<span id="cb112-2815"><a href="#cb112-2815" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"opacity"</span><span class="op">,</span> <span class="dv">1</span>)</span>
<span id="cb112-2816"><a href="#cb112-2816" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"display"</span><span class="op">,</span> <span class="st">"block"</span>)</span>
<span id="cb112-2817"><a href="#cb112-2817" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">html</span>(</span>
<span id="cb112-2818"><a href="#cb112-2818" aria-hidden="true" tabindex="-1"></a>          <span class="vs">`&lt;b&gt;</span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">hazards</span>[hazard])<span class="sc">}</span><span class="vs">&lt;/b&gt; &lt;br&gt; </span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">ViewExplore</span><span class="op">.</span><span class="at">hazardBars</span><span class="op">.</span><span class="at">lvl</span>)<span class="sc">}</span><span class="vs">: </span><span class="sc">${</span><span class="fu">_lang</span>(</span>
<span id="cb112-2819"><a href="#cb112-2819" aria-hidden="true" tabindex="-1"></a>            nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">levels</span>[labels[d<span class="op">.</span><span class="at">index</span>]]<span class="op">,</span></span>
<span id="cb112-2820"><a href="#cb112-2820" aria-hidden="true" tabindex="-1"></a>          )<span class="sc">}</span><span class="vs"> &lt;br&gt; </span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">ViewExplore</span><span class="op">.</span><span class="at">hazardBars</span><span class="op">.</span><span class="at">numAreas</span>)<span class="sc">}</span><span class="vs">: </span><span class="sc">${</span>d<span class="op">.</span><span class="at">data</span><span class="op">.</span><span class="at">values</span>[d<span class="op">.</span><span class="at">index</span>]<span class="sc">}</span><span class="vs">`</span><span class="op">,</span></span>
<span id="cb112-2821"><a href="#cb112-2821" aria-hidden="true" tabindex="-1"></a>        )<span class="op">;</span></span>
<span id="cb112-2822"><a href="#cb112-2822" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb112-2823"><a href="#cb112-2823" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"mouseout"</span><span class="op">,</span> <span class="kw">function</span> (<span class="bu">event</span>) {</span>
<span id="cb112-2824"><a href="#cb112-2824" aria-hidden="true" tabindex="-1"></a>      d3<span class="op">.</span><span class="fu">select</span>(<span class="st">".plotTooltip"</span>)<span class="op">.</span><span class="fu">style</span>(<span class="st">"display"</span><span class="op">,</span> <span class="st">"none"</span>)<span class="op">;</span></span>
<span id="cb112-2825"><a href="#cb112-2825" aria-hidden="true" tabindex="-1"></a>      d3<span class="op">.</span><span class="fu">select</span>(<span class="bu">event</span><span class="op">.</span><span class="at">currentTarget</span>)<span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"none"</span>)<span class="op">;</span></span>
<span id="cb112-2826"><a href="#cb112-2826" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb112-2827"><a href="#cb112-2827" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Add y axis title</span></span>
<span id="cb112-2828"><a href="#cb112-2828" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb112-2829"><a href="#cb112-2829" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb112-2830"><a href="#cb112-2830" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="st">"rotate(-90)"</span>)</span>
<span id="cb112-2831"><a href="#cb112-2831" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb112-2832"><a href="#cb112-2832" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> <span class="dv">0</span> <span class="op">-</span> height <span class="op">/</span> <span class="dv">2</span>)</span>
<span id="cb112-2833"><a href="#cb112-2833" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dy"</span><span class="op">,</span> <span class="st">"1em"</span>)</span>
<span id="cb112-2834"><a href="#cb112-2834" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"fontSize"</span><span class="op">,</span> <span class="st">"12px"</span>)</span>
<span id="cb112-2835"><a href="#cb112-2835" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb112-2836"><a href="#cb112-2836" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(<span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">ViewExplore</span><span class="op">.</span><span class="at">hazardBars</span><span class="op">.</span><span class="at">yaxis</span>))<span class="op">;</span></span>
<span id="cb112-2837"><a href="#cb112-2837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-2838"><a href="#cb112-2838" aria-hidden="true" tabindex="-1"></a>  <span class="co">// append legend</span></span>
<span id="cb112-2839"><a href="#cb112-2839" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> Legendpadding <span class="op">=</span> <span class="dv">65</span><span class="op">;</span></span>
<span id="cb112-2840"><a href="#cb112-2840" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> legendWidth <span class="op">=</span> <span class="dv">200</span><span class="op">;</span></span>
<span id="cb112-2841"><a href="#cb112-2841" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> bandWidth <span class="op">=</span> legendWidth <span class="op">/</span> (hazard_dict[hazard]<span class="op">.</span><span class="at">thresholds</span><span class="op">.</span><span class="at">length</span> <span class="op">-</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb112-2842"><a href="#cb112-2842" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> legend <span class="op">=</span> svg</span>
<span id="cb112-2843"><a href="#cb112-2843" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb112-2844"><a href="#cb112-2844" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>margin<span class="op">.</span><span class="at">left</span> <span class="op">+</span> <span class="dv">11</span><span class="sc">}</span><span class="vs">, </span><span class="sc">${</span>margin<span class="op">.</span><span class="at">top</span> <span class="op">-</span> <span class="dv">5</span><span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb112-2845"><a href="#cb112-2845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-2846"><a href="#cb112-2846" aria-hidden="true" tabindex="-1"></a>  colors<span class="op">.</span><span class="fu">forEach</span>((threshold<span class="op">,</span> index) <span class="kw">=&gt;</span> {</span>
<span id="cb112-2847"><a href="#cb112-2847" aria-hidden="true" tabindex="-1"></a>    legend</span>
<span id="cb112-2848"><a href="#cb112-2848" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"rect"</span>)</span>
<span id="cb112-2849"><a href="#cb112-2849" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> index <span class="op">*</span> bandWidth)</span>
<span id="cb112-2850"><a href="#cb112-2850" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> <span class="op">-</span><span class="dv">10</span>)</span>
<span id="cb112-2851"><a href="#cb112-2851" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> bandWidth)</span>
<span id="cb112-2852"><a href="#cb112-2852" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> <span class="dv">10</span>)</span>
<span id="cb112-2853"><a href="#cb112-2853" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">style</span>(<span class="st">"fill"</span><span class="op">,</span> colors[index])<span class="op">;</span></span>
<span id="cb112-2854"><a href="#cb112-2854" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Add label</span></span>
<span id="cb112-2855"><a href="#cb112-2855" aria-hidden="true" tabindex="-1"></a>    legend</span>
<span id="cb112-2856"><a href="#cb112-2856" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb112-2857"><a href="#cb112-2857" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> index <span class="op">*</span> bandWidth <span class="op">+</span> bandWidth <span class="op">/</span> <span class="dv">2</span>)</span>
<span id="cb112-2858"><a href="#cb112-2858" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> <span class="op">-</span><span class="dv">15</span>) <span class="co">// Adjust this value as needed for label positioning</span></span>
<span id="cb112-2859"><a href="#cb112-2859" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">style</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb112-2860"><a href="#cb112-2860" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">text</span>(<span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">levels</span>[labels[index]]))</span>
<span id="cb112-2861"><a href="#cb112-2861" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="st">"12px"</span>)</span>
<span id="cb112-2862"><a href="#cb112-2862" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"black"</span>)<span class="op">;</span> <span class="co">// Set the color of the label text</span></span>
<span id="cb112-2863"><a href="#cb112-2863" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb112-2864"><a href="#cb112-2864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-2865"><a href="#cb112-2865" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> svg<span class="op">.</span><span class="fu">node</span>()<span class="op">;</span></span>
<span id="cb112-2866"><a href="#cb112-2866" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-112" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb113" data-startfrom="2870" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2869"><span id="cb113-2870"><a href="#cb113-2870" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">classifyAndCount</span>(data) {</span>
<span id="cb113-2871"><a href="#cb113-2871" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> result <span class="op">=</span> {}<span class="op">;</span></span>
<span id="cb113-2872"><a href="#cb113-2872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-2873"><a href="#cb113-2873" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Helper function to classify a number based on thresholds</span></span>
<span id="cb113-2874"><a href="#cb113-2874" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">classifyNumber</span>(number<span class="op">,</span> thresholds) {</span>
<span id="cb113-2875"><a href="#cb113-2875" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> thresholds<span class="op">.</span><span class="at">length</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb113-2876"><a href="#cb113-2876" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (number <span class="op">&lt;</span> thresholds[i]) {</span>
<span id="cb113-2877"><a href="#cb113-2877" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> i<span class="op">;</span></span>
<span id="cb113-2878"><a href="#cb113-2878" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb113-2879"><a href="#cb113-2879" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb113-2880"><a href="#cb113-2880" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> thresholds<span class="op">.</span><span class="at">length</span><span class="op">;</span></span>
<span id="cb113-2881"><a href="#cb113-2881" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb113-2882"><a href="#cb113-2882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-2883"><a href="#cb113-2883" aria-hidden="true" tabindex="-1"></a>  data<span class="op">.</span><span class="fu">forEach</span>((row) <span class="kw">=&gt;</span> {</span>
<span id="cb113-2884"><a href="#cb113-2884" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> { admin0_name<span class="op">,</span> scenario<span class="op">,</span> timeframe<span class="op">,</span> hazard<span class="op">,</span> value } <span class="op">=</span> row<span class="op">;</span></span>
<span id="cb113-2885"><a href="#cb113-2885" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> thresholds <span class="op">=</span> hazard_dict[hazard]<span class="op">.</span><span class="at">thresholds</span><span class="op">;</span></span>
<span id="cb113-2886"><a href="#cb113-2886" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="op">!</span>thresholds) {</span>
<span id="cb113-2887"><a href="#cb113-2887" aria-hidden="true" tabindex="-1"></a>      <span class="bu">console</span><span class="op">.</span><span class="fu">error</span>(<span class="vs">`No thresholds found for hazard: </span><span class="sc">${</span>hazard<span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span></span>
<span id="cb113-2888"><a href="#cb113-2888" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span><span class="op">;</span></span>
<span id="cb113-2889"><a href="#cb113-2889" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb113-2890"><a href="#cb113-2890" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> classification <span class="op">=</span> <span class="fu">classifyNumber</span>(value<span class="op">,</span> thresholds)<span class="op">;</span></span>
<span id="cb113-2891"><a href="#cb113-2891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-2892"><a href="#cb113-2892" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="op">!</span>result[hazard]) {</span>
<span id="cb113-2893"><a href="#cb113-2893" aria-hidden="true" tabindex="-1"></a>      result[hazard] <span class="op">=</span> {}<span class="op">;</span></span>
<span id="cb113-2894"><a href="#cb113-2894" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb113-2895"><a href="#cb113-2895" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="op">!</span>result[hazard][scenario]) {</span>
<span id="cb113-2896"><a href="#cb113-2896" aria-hidden="true" tabindex="-1"></a>      result[hazard][scenario] <span class="op">=</span> {}<span class="op">;</span></span>
<span id="cb113-2897"><a href="#cb113-2897" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb113-2898"><a href="#cb113-2898" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="op">!</span>result[hazard][scenario][timeframe]) {</span>
<span id="cb113-2899"><a href="#cb113-2899" aria-hidden="true" tabindex="-1"></a>      result[hazard][scenario][timeframe] <span class="op">=</span> <span class="bu">Array</span>(thresholds<span class="op">.</span><span class="at">length</span> <span class="op">+</span> <span class="dv">1</span>)<span class="op">.</span><span class="fu">fill</span>(</span>
<span id="cb113-2900"><a href="#cb113-2900" aria-hidden="true" tabindex="-1"></a>        <span class="dv">0</span><span class="op">,</span></span>
<span id="cb113-2901"><a href="#cb113-2901" aria-hidden="true" tabindex="-1"></a>      )<span class="op">;</span></span>
<span id="cb113-2902"><a href="#cb113-2902" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb113-2903"><a href="#cb113-2903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-2904"><a href="#cb113-2904" aria-hidden="true" tabindex="-1"></a>    result[hazard][scenario][timeframe][classification]<span class="op">++;</span></span>
<span id="cb113-2905"><a href="#cb113-2905" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb113-2906"><a href="#cb113-2906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-2907"><a href="#cb113-2907" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> result<span class="op">;</span></span>
<span id="cb113-2908"><a href="#cb113-2908" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-113" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb114" data-startfrom="2912" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 2911"><span id="cb114-2912"><a href="#cb114-2912" aria-hidden="true" tabindex="-1"></a>population_stackbars <span class="op">=</span> <span class="kw">async</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb114-2913"><a href="#cb114-2913" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> width <span class="op">=</span> <span class="dv">750</span><span class="op">;</span></span>
<span id="cb114-2914"><a href="#cb114-2914" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> height <span class="op">=</span> <span class="dv">560</span><span class="op">;</span></span>
<span id="cb114-2915"><a href="#cb114-2915" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> margin <span class="op">=</span> { <span class="dt">top</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">right</span><span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dt">bottom</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">left</span><span class="op">:</span> <span class="dv">120</span> }<span class="op">;</span></span>
<span id="cb114-2916"><a href="#cb114-2916" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> barHeight <span class="op">=</span> <span class="dv">30</span><span class="op">;</span> <span class="co">// Height of each bar</span></span>
<span id="cb114-2917"><a href="#cb114-2917" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Calculate the total height needed for all bars</span></span>
<span id="cb114-2918"><a href="#cb114-2918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-2919"><a href="#cb114-2919" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> data <span class="op">=</span> <span class="cf">await</span> db<span class="op">.</span><span class="fu">query</span>(<span class="vs">`</span></span>
<span id="cb114-2920"><a href="#cb114-2920" aria-hidden="true" tabindex="-1"></a><span class="vs">    SELECT admin0_name, admin1_name, admin2_name, rural_pop, urban_pop, total_pop </span></span>
<span id="cb114-2921"><a href="#cb114-2921" aria-hidden="true" tabindex="-1"></a><span class="vs">    FROM exposurePopulation </span></span>
<span id="cb114-2922"><a href="#cb114-2922" aria-hidden="true" tabindex="-1"></a><span class="vs">    </span><span class="sc">${</span>plotQuery_admin<span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span></span>
<span id="cb114-2923"><a href="#cb114-2923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-2924"><a href="#cb114-2924" aria-hidden="true" tabindex="-1"></a>  data<span class="op">.</span><span class="fu">sort</span>((a<span class="op">,</span> b) <span class="kw">=&gt;</span> b<span class="op">.</span><span class="at">total_pop</span> <span class="op">-</span> a<span class="op">.</span><span class="at">total_pop</span>)<span class="op">;</span></span>
<span id="cb114-2925"><a href="#cb114-2925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-2926"><a href="#cb114-2926" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> totalHeight <span class="op">=</span> data<span class="op">.</span><span class="at">length</span> <span class="op">*</span> barHeight<span class="op">;</span></span>
<span id="cb114-2927"><a href="#cb114-2927" aria-hidden="true" tabindex="-1"></a>  <span class="co">// SVG Container</span></span>
<span id="cb114-2928"><a href="#cb114-2928" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> svg <span class="op">=</span> d3</span>
<span id="cb114-2929"><a href="#cb114-2929" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">create</span>(<span class="st">"svg"</span>)</span>
<span id="cb114-2930"><a href="#cb114-2930" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"viewBox"</span><span class="op">,</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> width <span class="op">+</span> margin<span class="op">.</span><span class="at">left</span> <span class="op">+</span> margin<span class="op">.</span><span class="at">right</span><span class="op">,</span> totalHeight])</span>
<span id="cb114-2931"><a href="#cb114-2931" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> width <span class="op">+</span> margin<span class="op">.</span><span class="at">left</span> <span class="op">+</span> margin<span class="op">.</span><span class="at">right</span>)</span>
<span id="cb114-2932"><a href="#cb114-2932" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> totalHeight <span class="op">+</span> margin<span class="op">.</span><span class="at">top</span> <span class="op">+</span> margin<span class="op">.</span><span class="at">bottom</span>)<span class="op">;</span></span>
<span id="cb114-2933"><a href="#cb114-2933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-2934"><a href="#cb114-2934" aria-hidden="true" tabindex="-1"></a>  d3<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".plotTooltip"</span>)<span class="op">.</span><span class="fu">remove</span>()<span class="op">;</span></span>
<span id="cb114-2935"><a href="#cb114-2935" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> tooltip <span class="op">=</span> d3</span>
<span id="cb114-2936"><a href="#cb114-2936" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">select</span>(<span class="st">"body"</span>)</span>
<span id="cb114-2937"><a href="#cb114-2937" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"div"</span>)</span>
<span id="cb114-2938"><a href="#cb114-2938" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"plotTooltip barTip"</span>)</span>
<span id="cb114-2939"><a href="#cb114-2939" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"position"</span><span class="op">,</span> <span class="st">"absolute"</span>)<span class="op">;</span></span>
<span id="cb114-2940"><a href="#cb114-2940" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> keys <span class="op">=</span> [<span class="st">"rural_pop"</span><span class="op">,</span> <span class="st">"urban_pop"</span>]<span class="op">;</span></span>
<span id="cb114-2941"><a href="#cb114-2941" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> stackedData <span class="op">=</span> d3</span>
<span id="cb114-2942"><a href="#cb114-2942" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">stack</span>()</span>
<span id="cb114-2943"><a href="#cb114-2943" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">keys</span>(keys)</span>
<span id="cb114-2944"><a href="#cb114-2944" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">value</span>((d<span class="op">,</span> key) <span class="kw">=&gt;</span> d[key])(data)<span class="op">;</span></span>
<span id="cb114-2945"><a href="#cb114-2945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-2946"><a href="#cb114-2946" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Set up scales</span></span>
<span id="cb114-2947"><a href="#cb114-2947" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> x <span class="op">=</span> d3</span>
<span id="cb114-2948"><a href="#cb114-2948" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb114-2949"><a href="#cb114-2949" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>([<span class="dv">0</span><span class="op">,</span> d3<span class="op">.</span><span class="fu">max</span>(data<span class="op">,</span> (d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">total_pop</span>)])</span>
<span id="cb114-2950"><a href="#cb114-2950" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">nice</span>()</span>
<span id="cb114-2951"><a href="#cb114-2951" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>([margin<span class="op">.</span><span class="at">left</span><span class="op">,</span> width <span class="op">-</span> margin<span class="op">.</span><span class="at">right</span>])<span class="op">;</span></span>
<span id="cb114-2952"><a href="#cb114-2952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-2953"><a href="#cb114-2953" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> y <span class="op">=</span> d3</span>
<span id="cb114-2954"><a href="#cb114-2954" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">scaleBand</span>()</span>
<span id="cb114-2955"><a href="#cb114-2955" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>(data<span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> d[admin_aggregationLevel]))</span>
<span id="cb114-2956"><a href="#cb114-2956" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>([margin<span class="op">.</span><span class="at">top</span><span class="op">,</span> totalHeight])</span>
<span id="cb114-2957"><a href="#cb114-2957" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">padding</span>(<span class="fl">0.1</span>)<span class="op">;</span></span>
<span id="cb114-2958"><a href="#cb114-2958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-2959"><a href="#cb114-2959" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> color <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleOrdinal</span>()<span class="op">.</span><span class="fu">domain</span>(keys)<span class="op">.</span><span class="fu">range</span>([<span class="st">"#216729"</span><span class="op">,</span> <span class="st">"#F7D732"</span>])<span class="op">;</span></span>
<span id="cb114-2960"><a href="#cb114-2960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-2961"><a href="#cb114-2961" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Draw the bars</span></span>
<span id="cb114-2962"><a href="#cb114-2962" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> bars <span class="op">=</span> svg</span>
<span id="cb114-2963"><a href="#cb114-2963" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb114-2964"><a href="#cb114-2964" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"g"</span>)</span>
<span id="cb114-2965"><a href="#cb114-2965" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(stackedData)</span>
<span id="cb114-2966"><a href="#cb114-2966" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">join</span>(<span class="st">"g"</span>)</span>
<span id="cb114-2967"><a href="#cb114-2967" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> (d) <span class="kw">=&gt;</span> <span class="fu">color</span>(d<span class="op">.</span><span class="at">key</span>))</span>
<span id="cb114-2968"><a href="#cb114-2968" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"rect"</span>)</span>
<span id="cb114-2969"><a href="#cb114-2969" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>((d) <span class="kw">=&gt;</span> d)</span>
<span id="cb114-2970"><a href="#cb114-2970" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">join</span>(<span class="st">"rect"</span>)</span>
<span id="cb114-2971"><a href="#cb114-2971" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> (d) <span class="kw">=&gt;</span> <span class="fu">x</span>(d[<span class="dv">0</span>]))</span>
<span id="cb114-2972"><a href="#cb114-2972" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> (d) <span class="kw">=&gt;</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">data</span>[admin_aggregationLevel]))</span>
<span id="cb114-2973"><a href="#cb114-2973" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> y<span class="op">.</span><span class="fu">bandwidth</span>())</span>
<span id="cb114-2974"><a href="#cb114-2974" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> (d) <span class="kw">=&gt;</span> <span class="fu">x</span>(d[<span class="dv">1</span>]) <span class="op">-</span> <span class="fu">x</span>(d[<span class="dv">0</span>]))<span class="op">;</span></span>
<span id="cb114-2975"><a href="#cb114-2975" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-2976"><a href="#cb114-2976" aria-hidden="true" tabindex="-1"></a>  bars</span>
<span id="cb114-2977"><a href="#cb114-2977" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"mouseover"</span><span class="op">,</span> (<span class="bu">event</span><span class="op">,</span> d) <span class="kw">=&gt;</span> {</span>
<span id="cb114-2978"><a href="#cb114-2978" aria-hidden="true" tabindex="-1"></a>      d3<span class="op">.</span><span class="fu">select</span>(<span class="bu">event</span><span class="op">.</span><span class="at">currentTarget</span>)<span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"black"</span>)<span class="op">.</span><span class="fu">raise</span>()<span class="op">;</span></span>
<span id="cb114-2979"><a href="#cb114-2979" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb114-2980"><a href="#cb114-2980" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"mousemove"</span><span class="op">,</span> (<span class="bu">event</span><span class="op">,</span> d) <span class="kw">=&gt;</span> {</span>
<span id="cb114-2981"><a href="#cb114-2981" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> key <span class="op">=</span> <span class="bu">event</span><span class="op">.</span><span class="at">target</span><span class="op">.</span><span class="at">parentNode</span><span class="op">.</span><span class="at">__data__</span><span class="op">.</span><span class="fu">key</span><span class="op">;</span></span>
<span id="cb114-2982"><a href="#cb114-2982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-2983"><a href="#cb114-2983" aria-hidden="true" tabindex="-1"></a>      tooltip</span>
<span id="cb114-2984"><a href="#cb114-2984" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"top"</span><span class="op">,</span> <span class="bu">event</span><span class="op">.</span><span class="at">pageY</span> <span class="op">-</span> <span class="dv">10</span> <span class="op">+</span> <span class="st">"px"</span>)</span>
<span id="cb114-2985"><a href="#cb114-2985" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"left"</span><span class="op">,</span> <span class="bu">event</span><span class="op">.</span><span class="at">pageX</span> <span class="op">+</span> <span class="dv">10</span> <span class="op">+</span> <span class="st">"px"</span>)</span>
<span id="cb114-2986"><a href="#cb114-2986" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"opacity"</span><span class="op">,</span> <span class="dv">1</span>)</span>
<span id="cb114-2987"><a href="#cb114-2987" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"display"</span><span class="op">,</span> <span class="st">"block"</span>)</span>
<span id="cb114-2988"><a href="#cb114-2988" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">html</span>(</span>
<span id="cb114-2989"><a href="#cb114-2989" aria-hidden="true" tabindex="-1"></a>          <span class="vs">`</span><span class="sc">${</span></span>
<span id="cb114-2990"><a href="#cb114-2990" aria-hidden="true" tabindex="-1"></a>            d<span class="op">.</span><span class="at">data</span>[admin_aggregationLevel]</span>
<span id="cb114-2991"><a href="#cb114-2991" aria-hidden="true" tabindex="-1"></a>          <span class="sc">}</span><span class="vs"> &lt;br&gt; </span><span class="sc">${</span><span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">ViewExplore</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">visualiseVars</span><span class="op">.</span><span class="at">exposure</span><span class="op">.</span><span class="at">exposureVariable</span><span class="op">.</span><span class="at">options</span>[key])<span class="sc">}</span><span class="vs">: </span><span class="sc">${</span><span class="fu">format_val</span>(d[<span class="dv">1</span>] <span class="op">-</span> d[<span class="dv">0</span>]<span class="op">,</span> <span class="st">"total"</span>)<span class="sc">}</span><span class="vs">`</span><span class="op">,</span></span>
<span id="cb114-2992"><a href="#cb114-2992" aria-hidden="true" tabindex="-1"></a>        )<span class="op">;</span></span>
<span id="cb114-2993"><a href="#cb114-2993" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb114-2994"><a href="#cb114-2994" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"mouseout"</span><span class="op">,</span> <span class="kw">function</span> (<span class="bu">event</span>) {</span>
<span id="cb114-2995"><a href="#cb114-2995" aria-hidden="true" tabindex="-1"></a>      d3<span class="op">.</span><span class="fu">select</span>(<span class="st">".plotTooltip"</span>)<span class="op">.</span><span class="fu">style</span>(<span class="st">"display"</span><span class="op">,</span> <span class="st">"none"</span>)<span class="op">;</span></span>
<span id="cb114-2996"><a href="#cb114-2996" aria-hidden="true" tabindex="-1"></a>      d3<span class="op">.</span><span class="fu">select</span>(<span class="bu">event</span><span class="op">.</span><span class="at">currentTarget</span>)<span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"none"</span>)<span class="op">;</span></span>
<span id="cb114-2997"><a href="#cb114-2997" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb114-2998"><a href="#cb114-2998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-2999"><a href="#cb114-2999" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Add the Y axis</span></span>
<span id="cb114-3000"><a href="#cb114-3000" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb114-3001"><a href="#cb114-3001" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb114-3002"><a href="#cb114-3002" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>margin<span class="op">.</span><span class="at">left</span><span class="sc">}</span><span class="vs">, 0)`</span>)</span>
<span id="cb114-3003"><a href="#cb114-3003" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>(d3<span class="op">.</span><span class="fu">axisLeft</span>(y))<span class="op">;</span></span>
<span id="cb114-3004"><a href="#cb114-3004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-3005"><a href="#cb114-3005" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> legendSvg <span class="op">=</span> d3</span>
<span id="cb114-3006"><a href="#cb114-3006" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">create</span>(<span class="st">"svg"</span>)</span>
<span id="cb114-3007"><a href="#cb114-3007" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> width <span class="op">+</span> <span class="dv">50</span>)</span>
<span id="cb114-3008"><a href="#cb114-3008" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> <span class="dv">75</span>)<span class="op">;</span></span>
<span id="cb114-3009"><a href="#cb114-3009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-3010"><a href="#cb114-3010" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Add legend to the new SVG</span></span>
<span id="cb114-3011"><a href="#cb114-3011" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> legend <span class="op">=</span> legendSvg</span>
<span id="cb114-3012"><a href="#cb114-3012" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb114-3013"><a href="#cb114-3013" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"legend"</span>)</span>
<span id="cb114-3014"><a href="#cb114-3014" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"g"</span>)</span>
<span id="cb114-3015"><a href="#cb114-3015" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(keys)</span>
<span id="cb114-3016"><a href="#cb114-3016" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">join</span>(<span class="st">"g"</span>)</span>
<span id="cb114-3017"><a href="#cb114-3017" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> (d<span class="op">,</span> i) <span class="kw">=&gt;</span> <span class="vs">`translate(10, </span><span class="sc">${</span>i <span class="op">*</span> <span class="dv">20</span><span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb114-3018"><a href="#cb114-3018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-3019"><a href="#cb114-3019" aria-hidden="true" tabindex="-1"></a>  legend</span>
<span id="cb114-3020"><a href="#cb114-3020" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"rect"</span>)</span>
<span id="cb114-3021"><a href="#cb114-3021" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> <span class="dv">18</span>)</span>
<span id="cb114-3022"><a href="#cb114-3022" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> <span class="dv">18</span>)</span>
<span id="cb114-3023"><a href="#cb114-3023" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> color)<span class="op">;</span></span>
<span id="cb114-3024"><a href="#cb114-3024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-3025"><a href="#cb114-3025" aria-hidden="true" tabindex="-1"></a>  legend</span>
<span id="cb114-3026"><a href="#cb114-3026" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb114-3027"><a href="#cb114-3027" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> <span class="dv">24</span>)</span>
<span id="cb114-3028"><a href="#cb114-3028" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> <span class="dv">9</span>)</span>
<span id="cb114-3029"><a href="#cb114-3029" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dy"</span><span class="op">,</span> <span class="st">"0.35em"</span>)</span>
<span id="cb114-3030"><a href="#cb114-3030" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>((d) <span class="kw">=&gt;</span></span>
<span id="cb114-3031"><a href="#cb114-3031" aria-hidden="true" tabindex="-1"></a>      <span class="fu">_lang</span>(</span>
<span id="cb114-3032"><a href="#cb114-3032" aria-hidden="true" tabindex="-1"></a>        nbText<span class="op">.</span><span class="at">ViewExplore</span><span class="op">.</span><span class="at">selectors</span><span class="op">.</span><span class="at">visualiseVars</span><span class="op">.</span><span class="at">exposure</span><span class="op">.</span><span class="at">exposureVariable</span></span>
<span id="cb114-3033"><a href="#cb114-3033" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="at">options</span>[d]<span class="op">,</span></span>
<span id="cb114-3034"><a href="#cb114-3034" aria-hidden="true" tabindex="-1"></a>      )<span class="op">,</span></span>
<span id="cb114-3035"><a href="#cb114-3035" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb114-3036"><a href="#cb114-3036" aria-hidden="true" tabindex="-1"></a>  <span class="co">// .text((d) =&gt; (d === "rural_pop" ? "Rural Population" : "Urban Population"));</span></span>
<span id="cb114-3037"><a href="#cb114-3037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-3038"><a href="#cb114-3038" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Add the X axis</span></span>
<span id="cb114-3039"><a href="#cb114-3039" aria-hidden="true" tabindex="-1"></a>  legendSvg</span>
<span id="cb114-3040"><a href="#cb114-3040" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb114-3041"><a href="#cb114-3041" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(0, 75)`</span>)</span>
<span id="cb114-3042"><a href="#cb114-3042" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">call</span>(d3<span class="op">.</span><span class="fu">axisTop</span>(x)<span class="op">.</span><span class="fu">ticks</span>(<span class="dv">5</span>))<span class="op">;</span></span>
<span id="cb114-3043"><a href="#cb114-3043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-3044"><a href="#cb114-3044" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> legendContainer <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;div style="width: 100%;"&gt;</span><span class="sc">${</span>legendSvg<span class="op">.</span><span class="fu">node</span>()<span class="sc">}</span><span class="vs">&lt;/div&gt;`</span><span class="op">;</span></span>
<span id="cb114-3045"><a href="#cb114-3045" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> scrollableContainer <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;div style="overflow-y: auto; width: 100%; height: </span><span class="sc">${</span></span>
<span id="cb114-3046"><a href="#cb114-3046" aria-hidden="true" tabindex="-1"></a>    height <span class="op">+</span> margin<span class="op">.</span><span class="at">top</span> <span class="op">+</span> margin<span class="op">.</span><span class="at">bottom</span></span>
<span id="cb114-3047"><a href="#cb114-3047" aria-hidden="true" tabindex="-1"></a>  <span class="sc">}</span><span class="vs">px;padding=0px; margin=0px;"&gt;</span><span class="sc">${</span>svg<span class="op">.</span><span class="fu">node</span>()<span class="sc">}</span><span class="vs">&lt;/div&gt;`</span><span class="op">;</span></span>
<span id="cb114-3048"><a href="#cb114-3048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-3049"><a href="#cb114-3049" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> container <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;div&gt;</span><span class="sc">${</span>legendContainer<span class="sc">}${</span>scrollableContainer<span class="sc">}</span><span class="vs">&lt;/div&gt;`</span><span class="op">;</span></span>
<span id="cb114-3050"><a href="#cb114-3050" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> container<span class="op">;</span></span>
<span id="cb114-3051"><a href="#cb114-3051" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-114" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb115" data-startfrom="3055" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3054"><span id="cb115-3055"><a href="#cb115-3055" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">format_slopeData</span>(data) {</span>
<span id="cb115-3056"><a href="#cb115-3056" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> order <span class="op">=</span> [<span class="st">"historic"</span><span class="op">,</span> <span class="st">"2021_2040"</span><span class="op">,</span> <span class="st">"2041_2060"</span>]<span class="op">;</span></span>
<span id="cb115-3057"><a href="#cb115-3057" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-3058"><a href="#cb115-3058" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> admin_grouped <span class="op">=</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">from</span>(</span>
<span id="cb115-3059"><a href="#cb115-3059" aria-hidden="true" tabindex="-1"></a>    d3<span class="op">.</span><span class="fu">group</span>(data<span class="op">,</span> (d) <span class="kw">=&gt;</span> d[<span class="st">"hazard"</span>])<span class="op">,</span></span>
<span id="cb115-3060"><a href="#cb115-3060" aria-hidden="true" tabindex="-1"></a>    ([admin_name<span class="op">,</span> values]) <span class="kw">=&gt;</span> {</span>
<span id="cb115-3061"><a href="#cb115-3061" aria-hidden="true" tabindex="-1"></a>      values<span class="op">.</span><span class="fu">sort</span>(</span>
<span id="cb115-3062"><a href="#cb115-3062" aria-hidden="true" tabindex="-1"></a>        (a<span class="op">,</span> b) <span class="kw">=&gt;</span> order<span class="op">.</span><span class="fu">indexOf</span>(a<span class="op">.</span><span class="at">timeframe</span>) <span class="op">-</span> order<span class="op">.</span><span class="fu">indexOf</span>(b<span class="op">.</span><span class="at">timeframe</span>)<span class="op">,</span></span>
<span id="cb115-3063"><a href="#cb115-3063" aria-hidden="true" tabindex="-1"></a>      )<span class="op">;</span></span>
<span id="cb115-3064"><a href="#cb115-3064" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> {</span>
<span id="cb115-3065"><a href="#cb115-3065" aria-hidden="true" tabindex="-1"></a>        admin_name<span class="op">,</span></span>
<span id="cb115-3066"><a href="#cb115-3066" aria-hidden="true" tabindex="-1"></a>        <span class="dt">values</span><span class="op">:</span> values<span class="op">.</span><span class="fu">map</span>(({ timeframe<span class="op">,</span> scenario<span class="op">,</span> value<span class="op">,</span> percentChange }) <span class="kw">=&gt;</span> ({</span>
<span id="cb115-3067"><a href="#cb115-3067" aria-hidden="true" tabindex="-1"></a>          timeframe<span class="op">,</span></span>
<span id="cb115-3068"><a href="#cb115-3068" aria-hidden="true" tabindex="-1"></a>          scenario<span class="op">,</span></span>
<span id="cb115-3069"><a href="#cb115-3069" aria-hidden="true" tabindex="-1"></a>          value<span class="op">,</span></span>
<span id="cb115-3070"><a href="#cb115-3070" aria-hidden="true" tabindex="-1"></a>          percentChange<span class="op">,</span></span>
<span id="cb115-3071"><a href="#cb115-3071" aria-hidden="true" tabindex="-1"></a>        }))<span class="op">,</span></span>
<span id="cb115-3072"><a href="#cb115-3072" aria-hidden="true" tabindex="-1"></a>      }<span class="op">;</span></span>
<span id="cb115-3073"><a href="#cb115-3073" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb115-3074"><a href="#cb115-3074" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb115-3075"><a href="#cb115-3075" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> admin_grouped<span class="op">;</span></span>
<span id="cb115-3076"><a href="#cb115-3076" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-115" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb116" data-startfrom="3080" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3079"><span id="cb116-3080"><a href="#cb116-3080" aria-hidden="true" tabindex="-1"></a>calculatePercentChange <span class="op">=</span> (data) <span class="kw">=&gt;</span> {</span>
<span id="cb116-3081"><a href="#cb116-3081" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> baseline <span class="op">=</span> {}<span class="op">;</span></span>
<span id="cb116-3082"><a href="#cb116-3082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-3083"><a href="#cb116-3083" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Find historic baseline values</span></span>
<span id="cb116-3084"><a href="#cb116-3084" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">const</span> row <span class="kw">of</span> data) {</span>
<span id="cb116-3085"><a href="#cb116-3085" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (row<span class="op">.</span><span class="at">scenario</span> <span class="op">===</span> <span class="st">"historic"</span> <span class="op">&amp;&amp;</span> row<span class="op">.</span><span class="at">timeframe</span> <span class="op">===</span> <span class="st">"historic"</span>) {</span>
<span id="cb116-3086"><a href="#cb116-3086" aria-hidden="true" tabindex="-1"></a>      baseline[row<span class="op">.</span><span class="at">hazard</span>] <span class="op">=</span> row<span class="op">.</span><span class="at">admin_mean</span><span class="op">;</span></span>
<span id="cb116-3087"><a href="#cb116-3087" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb116-3088"><a href="#cb116-3088" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb116-3089"><a href="#cb116-3089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-3090"><a href="#cb116-3090" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> results <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb116-3091"><a href="#cb116-3091" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">const</span> row <span class="kw">of</span> data) {</span>
<span id="cb116-3092"><a href="#cb116-3092" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> hazard <span class="op">=</span> row<span class="op">.</span><span class="at">hazard</span><span class="op">;</span></span>
<span id="cb116-3093"><a href="#cb116-3093" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> scenario <span class="op">=</span> row<span class="op">.</span><span class="at">scenario</span><span class="op">;</span></span>
<span id="cb116-3094"><a href="#cb116-3094" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> timeframe <span class="op">=</span> row<span class="op">.</span><span class="at">timeframe</span><span class="op">;</span></span>
<span id="cb116-3095"><a href="#cb116-3095" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> value <span class="op">=</span> row<span class="op">.</span><span class="at">admin_mean</span><span class="op">;</span></span>
<span id="cb116-3096"><a href="#cb116-3096" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> baselineValue <span class="op">=</span> baseline[hazard]<span class="op">;</span></span>
<span id="cb116-3097"><a href="#cb116-3097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-3098"><a href="#cb116-3098" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Check if baseline value exists</span></span>
<span id="cb116-3099"><a href="#cb116-3099" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (baselineValue <span class="op">!==</span> <span class="kw">undefined</span> <span class="op">&amp;&amp;</span> scenario <span class="op">!==</span> <span class="st">"historic"</span>) {</span>
<span id="cb116-3100"><a href="#cb116-3100" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> change <span class="op">=</span> value <span class="op">-</span> baselineValue<span class="op">;</span></span>
<span id="cb116-3101"><a href="#cb116-3101" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> percentChange <span class="op">=</span> (change <span class="op">/</span> baselineValue) <span class="op">*</span> <span class="dv">100</span><span class="op">;</span></span>
<span id="cb116-3102"><a href="#cb116-3102" aria-hidden="true" tabindex="-1"></a>      results<span class="op">.</span><span class="fu">push</span>({ hazard<span class="op">,</span> scenario<span class="op">,</span> timeframe<span class="op">,</span> value<span class="op">,</span> percentChange })<span class="op">;</span></span>
<span id="cb116-3103"><a href="#cb116-3103" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb116-3104"><a href="#cb116-3104" aria-hidden="true" tabindex="-1"></a>      results<span class="op">.</span><span class="fu">push</span>({ hazard<span class="op">,</span> scenario<span class="op">,</span> timeframe<span class="op">,</span> value<span class="op">,</span> <span class="dt">percentChange</span><span class="op">:</span> <span class="kw">null</span> })<span class="op">;</span></span>
<span id="cb116-3105"><a href="#cb116-3105" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb116-3106"><a href="#cb116-3106" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb116-3107"><a href="#cb116-3107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-3108"><a href="#cb116-3108" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> results<span class="op">;</span></span>
<span id="cb116-3109"><a href="#cb116-3109" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-116" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb117" data-startfrom="3113" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3112"><span id="cb117-3113"><a href="#cb117-3113" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">scaleHazardValue</span>(value<span class="op">,</span> minValue<span class="op">,</span> maxValue) {</span>
<span id="cb117-3114"><a href="#cb117-3114" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> thresholds <span class="op">=</span> hazard_dict[<span class="st">"HSH_max"</span>][<span class="st">"thresholds"</span>]<span class="op">;</span></span>
<span id="cb117-3115"><a href="#cb117-3115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-3116"><a href="#cb117-3116" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Calculate the range between the minimum and maximum values</span></span>
<span id="cb117-3117"><a href="#cb117-3117" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> range <span class="op">=</span> maxValue <span class="op">-</span> minValue<span class="op">;</span></span>
<span id="cb117-3118"><a href="#cb117-3118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-3119"><a href="#cb117-3119" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Determine the scale based on thresholds</span></span>
<span id="cb117-3120"><a href="#cb117-3120" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (value <span class="op">&lt;=</span> thresholds[<span class="dv">0</span>]) {</span>
<span id="cb117-3121"><a href="#cb117-3121" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb117-3122"><a href="#cb117-3122" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (value <span class="op">&lt;=</span> thresholds[<span class="dv">1</span>]) {</span>
<span id="cb117-3123"><a href="#cb117-3123" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">ceil</span>(</span>
<span id="cb117-3124"><a href="#cb117-3124" aria-hidden="true" tabindex="-1"></a>      <span class="dv">1</span> <span class="op">+</span> ((value <span class="op">-</span> thresholds[<span class="dv">0</span>]) <span class="op">/</span> (thresholds[<span class="dv">1</span>] <span class="op">-</span> thresholds[<span class="dv">0</span>])) <span class="op">*</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb117-3125"><a href="#cb117-3125" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb117-3126"><a href="#cb117-3126" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (value <span class="op">&lt;=</span> thresholds[<span class="dv">2</span>]) {</span>
<span id="cb117-3127"><a href="#cb117-3127" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">ceil</span>(</span>
<span id="cb117-3128"><a href="#cb117-3128" aria-hidden="true" tabindex="-1"></a>      <span class="dv">4</span> <span class="op">+</span> ((value <span class="op">-</span> thresholds[<span class="dv">1</span>]) <span class="op">/</span> (thresholds[<span class="dv">2</span>] <span class="op">-</span> thresholds[<span class="dv">1</span>])) <span class="op">*</span> <span class="dv">3</span><span class="op">,</span></span>
<span id="cb117-3129"><a href="#cb117-3129" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb117-3130"><a href="#cb117-3130" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (value <span class="op">&lt;=</span> thresholds[<span class="dv">3</span>]) {</span>
<span id="cb117-3131"><a href="#cb117-3131" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">ceil</span>(</span>
<span id="cb117-3132"><a href="#cb117-3132" aria-hidden="true" tabindex="-1"></a>      <span class="dv">7</span> <span class="op">+</span> ((value <span class="op">-</span> thresholds[<span class="dv">2</span>]) <span class="op">/</span> (thresholds[<span class="dv">3</span>] <span class="op">-</span> thresholds[<span class="dv">2</span>])) <span class="op">*</span> <span class="dv">3</span><span class="op">,</span></span>
<span id="cb117-3133"><a href="#cb117-3133" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb117-3134"><a href="#cb117-3134" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb117-3135"><a href="#cb117-3135" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">10</span><span class="op">;</span></span>
<span id="cb117-3136"><a href="#cb117-3136" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb117-3137"><a href="#cb117-3137" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-117" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb118" data-startfrom="3141" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3140"><span id="cb118-3141"><a href="#cb118-3141" aria-hidden="true" tabindex="-1"></a>parallelCoordinatesPlot <span class="op">=</span> <span class="kw">async</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb118-3142"><a href="#cb118-3142" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> margin <span class="op">=</span> { <span class="dt">top</span><span class="op">:</span> <span class="dv">30</span><span class="op">,</span> <span class="dt">right</span><span class="op">:</span> <span class="dv">80</span><span class="op">,</span> <span class="dt">bottom</span><span class="op">:</span> <span class="dv">25</span><span class="op">,</span> <span class="dt">left</span><span class="op">:</span> <span class="dv">40</span> }<span class="op">,</span></span>
<span id="cb118-3143"><a href="#cb118-3143" aria-hidden="true" tabindex="-1"></a>    width <span class="op">=</span> <span class="dv">1200</span> <span class="op">-</span> margin<span class="op">.</span><span class="at">left</span> <span class="op">-</span> margin<span class="op">.</span><span class="at">right</span><span class="op">,</span></span>
<span id="cb118-3144"><a href="#cb118-3144" aria-hidden="true" tabindex="-1"></a>    height <span class="op">=</span> <span class="dv">600</span> <span class="op">-</span> margin<span class="op">.</span><span class="at">top</span> <span class="op">-</span> margin<span class="op">.</span><span class="at">bottom</span><span class="op">;</span></span>
<span id="cb118-3145"><a href="#cb118-3145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-3146"><a href="#cb118-3146" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> group_query<span class="op">;</span></span>
<span id="cb118-3147"><a href="#cb118-3147" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (</span>
<span id="cb118-3148"><a href="#cb118-3148" aria-hidden="true" tabindex="-1"></a>    DataSelector_form<span class="op">.</span><span class="at">vulnerabilityGroup_form</span><span class="op">.</span><span class="at">vulnerability_sel</span><span class="op">.</span><span class="fu">every</span>(</span>
<span id="cb118-3149"><a href="#cb118-3149" aria-hidden="true" tabindex="-1"></a>      (d) <span class="kw">=&gt;</span> d <span class="op">===</span> <span class="st">"Education"</span><span class="op">,</span></span>
<span id="cb118-3150"><a href="#cb118-3150" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb118-3151"><a href="#cb118-3151" aria-hidden="true" tabindex="-1"></a>  ) {</span>
<span id="cb118-3152"><a href="#cb118-3152" aria-hidden="true" tabindex="-1"></a>    group_query <span class="op">=</span> <span class="vs">`AND "group" = 'education' OR "variable" = 'education'`</span><span class="op">;</span></span>
<span id="cb118-3153"><a href="#cb118-3153" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb118-3154"><a href="#cb118-3154" aria-hidden="true" tabindex="-1"></a>    group_query <span class="op">=</span> <span class="vs">`AND "group" in (</span><span class="sc">${</span></span>
<span id="cb118-3155"><a href="#cb118-3155" aria-hidden="true" tabindex="-1"></a>      <span class="st">"'"</span> <span class="op">+</span></span>
<span id="cb118-3156"><a href="#cb118-3156" aria-hidden="true" tabindex="-1"></a>      DataSelector_form<span class="op">.</span><span class="at">vulnerabilityGroup_form</span><span class="op">.</span><span class="at">vulnerability_sel</span></span>
<span id="cb118-3157"><a href="#cb118-3157" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">join</span>(<span class="st">"', '"</span>)</span>
<span id="cb118-3158"><a href="#cb118-3158" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">toLowerCase</span>() <span class="op">+</span></span>
<span id="cb118-3159"><a href="#cb118-3159" aria-hidden="true" tabindex="-1"></a>      <span class="st">"'"</span></span>
<span id="cb118-3160"><a href="#cb118-3160" aria-hidden="true" tabindex="-1"></a>    <span class="sc">}</span><span class="vs">)`</span><span class="op">;</span></span>
<span id="cb118-3161"><a href="#cb118-3161" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb118-3162"><a href="#cb118-3162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-3163"><a href="#cb118-3163" aria-hidden="true" tabindex="-1"></a>  <span class="co">// let selected_country = "";</span></span>
<span id="cb118-3164"><a href="#cb118-3164" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> data <span class="op">=</span> <span class="cf">await</span> db<span class="op">.</span><span class="fu">query</span>(</span>
<span id="cb118-3165"><a href="#cb118-3165" aria-hidden="true" tabindex="-1"></a>    <span class="vs">`SELECT "admin0_name", "admin1_name", "admin2_name", "group", "variable", "value"</span></span>
<span id="cb118-3166"><a href="#cb118-3166" aria-hidden="true" tabindex="-1"></a><span class="vs">     FROM Vulnerability </span></span>
<span id="cb118-3167"><a href="#cb118-3167" aria-hidden="true" tabindex="-1"></a><span class="vs">     </span><span class="sc">${</span>mapDataQuery_admin<span class="sc">}</span></span>
<span id="cb118-3168"><a href="#cb118-3168" aria-hidden="true" tabindex="-1"></a><span class="vs">     AND "variable" != 'GenderEquity_1995.2015'</span></span>
<span id="cb118-3169"><a href="#cb118-3169" aria-hidden="true" tabindex="-1"></a><span class="vs">     </span><span class="sc">${</span>group_query<span class="sc">}</span><span class="vs">`</span><span class="op">,</span></span>
<span id="cb118-3170"><a href="#cb118-3170" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb118-3171"><a href="#cb118-3171" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> data_vuln <span class="op">=</span> <span class="fu">pivotData</span>(data)<span class="op">;</span></span>
<span id="cb118-3172"><a href="#cb118-3172" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> means <span class="op">=</span> <span class="fu">calculateMeans</span>(data)<span class="op">;</span></span>
<span id="cb118-3173"><a href="#cb118-3173" aria-hidden="true" tabindex="-1"></a>  means<span class="op">.</span><span class="at">country</span> <span class="op">=</span> <span class="st">"Regional Average"</span><span class="op">;</span></span>
<span id="cb118-3174"><a href="#cb118-3174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-3175"><a href="#cb118-3175" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> color <span class="op">=</span> d3</span>
<span id="cb118-3176"><a href="#cb118-3176" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">scaleOrdinal</span>()</span>
<span id="cb118-3177"><a href="#cb118-3177" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>(data_vuln<span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">country</span>))</span>
<span id="cb118-3178"><a href="#cb118-3178" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>(d3<span class="op">.</span><span class="at">schemeCategory10</span>)<span class="op">;</span></span>
<span id="cb118-3179"><a href="#cb118-3179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-3180"><a href="#cb118-3180" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> svg <span class="op">=</span> d3</span>
<span id="cb118-3181"><a href="#cb118-3181" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">create</span>(<span class="st">"svg"</span>)</span>
<span id="cb118-3182"><a href="#cb118-3182" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"VulnerableParallelLine"</span>)</span>
<span id="cb118-3183"><a href="#cb118-3183" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"viewBox"</span><span class="op">,</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> width<span class="op">,</span> height])</span>
<span id="cb118-3184"><a href="#cb118-3184" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> width)</span>
<span id="cb118-3185"><a href="#cb118-3185" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> height)<span class="op">;</span></span>
<span id="cb118-3186"><a href="#cb118-3186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-3187"><a href="#cb118-3187" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dimensions <span class="op">=</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">keys</span>(data_vuln[<span class="dv">0</span>])<span class="op">.</span><span class="fu">filter</span>((d) <span class="kw">=&gt;</span> d <span class="op">!==</span> <span class="st">"country"</span>)<span class="op">;</span></span>
<span id="cb118-3188"><a href="#cb118-3188" aria-hidden="true" tabindex="-1"></a>  dimensions<span class="op">.</span><span class="fu">sort</span>()<span class="op">;</span></span>
<span id="cb118-3189"><a href="#cb118-3189" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> y <span class="op">=</span> {}<span class="op">;</span></span>
<span id="cb118-3190"><a href="#cb118-3190" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">const</span> dim <span class="kw">of</span> dimensions) {</span>
<span id="cb118-3191"><a href="#cb118-3191" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> y_extent <span class="op">=</span></span>
<span id="cb118-3192"><a href="#cb118-3192" aria-hidden="true" tabindex="-1"></a>      dim <span class="op">===</span> <span class="st">"education-educationYrs"</span></span>
<span id="cb118-3193"><a href="#cb118-3193" aria-hidden="true" tabindex="-1"></a>        <span class="op">?</span> <span class="co">// ? d3.extent(data_vuln, (item) =&gt; item[dim])</span></span>
<span id="cb118-3194"><a href="#cb118-3194" aria-hidden="true" tabindex="-1"></a>          [<span class="dv">0</span><span class="op">,</span> d3<span class="op">.</span><span class="fu">max</span>(data_vuln<span class="op">,</span> (item) <span class="kw">=&gt;</span> item[dim])]</span>
<span id="cb118-3195"><a href="#cb118-3195" aria-hidden="true" tabindex="-1"></a>        <span class="op">:</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">1</span>]<span class="op">;</span></span>
<span id="cb118-3196"><a href="#cb118-3196" aria-hidden="true" tabindex="-1"></a>    y[dim] <span class="op">=</span> d3</span>
<span id="cb118-3197"><a href="#cb118-3197" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb118-3198"><a href="#cb118-3198" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">domain</span>(y_extent)</span>
<span id="cb118-3199"><a href="#cb118-3199" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">range</span>([height <span class="op">-</span> margin<span class="op">.</span><span class="at">bottom</span><span class="op">,</span> margin<span class="op">.</span><span class="at">top</span>])<span class="op">;</span></span>
<span id="cb118-3200"><a href="#cb118-3200" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb118-3201"><a href="#cb118-3201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-3202"><a href="#cb118-3202" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> x <span class="op">=</span> d3</span>
<span id="cb118-3203"><a href="#cb118-3203" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">scalePoint</span>()</span>
<span id="cb118-3204"><a href="#cb118-3204" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>(dimensions)</span>
<span id="cb118-3205"><a href="#cb118-3205" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>([margin<span class="op">.</span><span class="at">left</span><span class="op">,</span> width <span class="op">-</span> margin<span class="op">.</span><span class="at">right</span>])<span class="op">;</span></span>
<span id="cb118-3206"><a href="#cb118-3206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-3207"><a href="#cb118-3207" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> line <span class="op">=</span> d3</span>
<span id="cb118-3208"><a href="#cb118-3208" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">line</span>()</span>
<span id="cb118-3209"><a href="#cb118-3209" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">defined</span>((d) <span class="kw">=&gt;</span> <span class="op">!</span><span class="pp">isNaN</span>(d[<span class="dv">1</span>]))</span>
<span id="cb118-3210"><a href="#cb118-3210" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">x</span>((d) <span class="kw">=&gt;</span> <span class="fu">x</span>(d[<span class="dv">0</span>]))</span>
<span id="cb118-3211"><a href="#cb118-3211" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">y</span>((d) <span class="kw">=&gt;</span> y[d[<span class="dv">0</span>]](d[<span class="dv">1</span>]))<span class="op">;</span></span>
<span id="cb118-3212"><a href="#cb118-3212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-3213"><a href="#cb118-3213" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> tooltip <span class="op">=</span> d3</span>
<span id="cb118-3214"><a href="#cb118-3214" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">select</span>(<span class="st">"body"</span>)</span>
<span id="cb118-3215"><a href="#cb118-3215" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"div"</span>)</span>
<span id="cb118-3216"><a href="#cb118-3216" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"position"</span><span class="op">,</span> <span class="st">"absolute"</span>)</span>
<span id="cb118-3217"><a href="#cb118-3217" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"background-color"</span><span class="op">,</span> <span class="st">"white"</span>)</span>
<span id="cb118-3218"><a href="#cb118-3218" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"padding"</span><span class="op">,</span> <span class="st">"5px"</span>)</span>
<span id="cb118-3219"><a href="#cb118-3219" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"border"</span><span class="op">,</span> <span class="st">"1px solid black"</span>)</span>
<span id="cb118-3220"><a href="#cb118-3220" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"border-radius"</span><span class="op">,</span> <span class="st">"5px"</span>)</span>
<span id="cb118-3221"><a href="#cb118-3221" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"opacity"</span><span class="op">,</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb118-3222"><a href="#cb118-3222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-3223"><a href="#cb118-3223" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> countrylines <span class="op">=</span> svg</span>
<span id="cb118-3224"><a href="#cb118-3224" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".countryLines"</span>)</span>
<span id="cb118-3225"><a href="#cb118-3225" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(data_vuln)</span>
<span id="cb118-3226"><a href="#cb118-3226" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb118-3227"><a href="#cb118-3227" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"path"</span>)</span>
<span id="cb118-3228"><a href="#cb118-3228" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"countryLines"</span>)</span>
<span id="cb118-3229"><a href="#cb118-3229" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"d"</span><span class="op">,</span> (d) <span class="kw">=&gt;</span> <span class="fu">line</span>(dimensions<span class="op">.</span><span class="fu">map</span>((p) <span class="kw">=&gt;</span> [p<span class="op">,</span> d[p]])))</span>
<span id="cb118-3230"><a href="#cb118-3230" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"none"</span>)</span>
<span id="cb118-3231"><a href="#cb118-3231" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(</span>
<span id="cb118-3232"><a href="#cb118-3232" aria-hidden="true" tabindex="-1"></a>      <span class="st">"stroke"</span><span class="op">,</span></span>
<span id="cb118-3233"><a href="#cb118-3233" aria-hidden="true" tabindex="-1"></a>      <span class="st">"lightgrey"</span><span class="op">,</span> <span class="co">// (d.country === selected_country ? "green" : "lightgrey") //color(d.country)</span></span>
<span id="cb118-3234"><a href="#cb118-3234" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb118-3235"><a href="#cb118-3235" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="fl">1.5</span>)</span>
<span id="cb118-3236"><a href="#cb118-3236" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"opacity"</span><span class="op">,</span> <span class="fl">0.2</span>) <span class="co">// (d) =&gt; (d.country === selected_country ? 0.9 : 0.2))</span></span>
<span id="cb118-3237"><a href="#cb118-3237" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"mouseover"</span><span class="op">,</span> <span class="kw">function</span> (<span class="bu">event</span><span class="op">,</span> d) {</span>
<span id="cb118-3238"><a href="#cb118-3238" aria-hidden="true" tabindex="-1"></a>      <span class="co">// svg.selectAll(".countryLines").style("opacity", 0.1);</span></span>
<span id="cb118-3239"><a href="#cb118-3239" aria-hidden="true" tabindex="-1"></a>      d3<span class="op">.</span><span class="fu">select</span>(<span class="kw">this</span>)<span class="op">.</span><span class="fu">style</span>(<span class="st">"opacity"</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"#F29D2D"</span>)<span class="op">;</span></span>
<span id="cb118-3240"><a href="#cb118-3240" aria-hidden="true" tabindex="-1"></a>      tooltip<span class="op">.</span><span class="fu">transition</span>()<span class="op">.</span><span class="fu">duration</span>(<span class="dv">0</span>)<span class="op">.</span><span class="fu">style</span>(<span class="st">"opacity"</span><span class="op">,</span> <span class="fl">0.9</span>)<span class="op">;</span></span>
<span id="cb118-3241"><a href="#cb118-3241" aria-hidden="true" tabindex="-1"></a>      tooltip</span>
<span id="cb118-3242"><a href="#cb118-3242" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">html</span>(<span class="vs">`</span><span class="sc">${</span>d<span class="op">.</span><span class="at">country</span><span class="sc">}</span><span class="vs">`</span>)</span>
<span id="cb118-3243"><a href="#cb118-3243" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"left"</span><span class="op">,</span> <span class="bu">event</span><span class="op">.</span><span class="at">pageX</span> <span class="op">+</span> <span class="dv">10</span> <span class="op">+</span> <span class="st">"px"</span>)</span>
<span id="cb118-3244"><a href="#cb118-3244" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"top"</span><span class="op">,</span> <span class="bu">event</span><span class="op">.</span><span class="at">pageY</span> <span class="op">-</span> <span class="dv">28</span> <span class="op">+</span> <span class="st">"px"</span>)<span class="op">;</span></span>
<span id="cb118-3245"><a href="#cb118-3245" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb118-3246"><a href="#cb118-3246" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"mouseout"</span><span class="op">,</span> <span class="kw">function</span> (d) {</span>
<span id="cb118-3247"><a href="#cb118-3247" aria-hidden="true" tabindex="-1"></a>      svg</span>
<span id="cb118-3248"><a href="#cb118-3248" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".countryLines"</span>)</span>
<span id="cb118-3249"><a href="#cb118-3249" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"opacity"</span><span class="op">,</span> <span class="fl">0.2</span>) <span class="co">// (d) =&gt; (d.country === selected_country ? 0.9 : 0.2));</span></span>
<span id="cb118-3250"><a href="#cb118-3250" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"lightgrey"</span>)<span class="op">;</span></span>
<span id="cb118-3251"><a href="#cb118-3251" aria-hidden="true" tabindex="-1"></a>      tooltip<span class="op">.</span><span class="fu">transition</span>()<span class="op">.</span><span class="fu">duration</span>(<span class="dv">500</span>)<span class="op">.</span><span class="fu">style</span>(<span class="st">"opacity"</span><span class="op">,</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb118-3252"><a href="#cb118-3252" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb118-3253"><a href="#cb118-3253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-3254"><a href="#cb118-3254" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> avg_lines <span class="op">=</span> svg</span>
<span id="cb118-3255"><a href="#cb118-3255" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"avgPath"</span>)</span>
<span id="cb118-3256"><a href="#cb118-3256" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(means)</span>
<span id="cb118-3257"><a href="#cb118-3257" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb118-3258"><a href="#cb118-3258" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"path"</span>)</span>
<span id="cb118-3259"><a href="#cb118-3259" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"d"</span><span class="op">,</span> (d) <span class="kw">=&gt;</span> <span class="fu">line</span>(dimensions<span class="op">.</span><span class="fu">map</span>((p) <span class="kw">=&gt;</span> [p<span class="op">,</span> d[p]])))</span>
<span id="cb118-3260"><a href="#cb118-3260" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"none"</span>)</span>
<span id="cb118-3261"><a href="#cb118-3261" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"#2E7636"</span>)</span>
<span id="cb118-3262"><a href="#cb118-3262" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="fl">1.5</span>)</span>
<span id="cb118-3263"><a href="#cb118-3263" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"opacity"</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb118-3264"><a href="#cb118-3264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-3265"><a href="#cb118-3265" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb118-3266"><a href="#cb118-3266" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"myAxis"</span>)</span>
<span id="cb118-3267"><a href="#cb118-3267" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(dimensions)</span>
<span id="cb118-3268"><a href="#cb118-3268" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb118-3269"><a href="#cb118-3269" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb118-3270"><a href="#cb118-3270" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> (d) <span class="kw">=&gt;</span> <span class="st">"translate("</span> <span class="op">+</span> <span class="fu">x</span>(d) <span class="op">+</span> <span class="st">")"</span>)</span>
<span id="cb118-3271"><a href="#cb118-3271" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"pointer-events"</span><span class="op">,</span> <span class="st">"none"</span>)</span>
<span id="cb118-3272"><a href="#cb118-3272" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">each</span>(<span class="kw">function</span> (d) {</span>
<span id="cb118-3273"><a href="#cb118-3273" aria-hidden="true" tabindex="-1"></a>      d3<span class="op">.</span><span class="fu">select</span>(<span class="kw">this</span>)<span class="op">.</span><span class="fu">call</span>(d3<span class="op">.</span><span class="fu">axisLeft</span>()<span class="op">.</span><span class="fu">scale</span>(y[d]))<span class="op">;</span></span>
<span id="cb118-3274"><a href="#cb118-3274" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb118-3275"><a href="#cb118-3275" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb118-3276"><a href="#cb118-3276" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb118-3277"><a href="#cb118-3277" aria-hidden="true" tabindex="-1"></a>    <span class="co">// .attr("y", 10)</span></span>
<span id="cb118-3278"><a href="#cb118-3278" aria-hidden="true" tabindex="-1"></a>    <span class="co">// .attr("x", 0)</span></span>
<span id="cb118-3279"><a href="#cb118-3279" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> (d<span class="op">,</span> i) <span class="kw">=&gt;</span> {</span>
<span id="cb118-3280"><a href="#cb118-3280" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> i <span class="op">%</span> <span class="dv">2</span> <span class="op">===</span> <span class="dv">0</span> <span class="op">?</span> <span class="dv">10</span> <span class="op">:</span> height <span class="op">-</span> margin<span class="op">.</span><span class="at">bottom</span> <span class="op">+</span> <span class="dv">20</span><span class="op">;</span></span>
<span id="cb118-3281"><a href="#cb118-3281" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb118-3282"><a href="#cb118-3282" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>((d) <span class="kw">=&gt;</span> {</span>
<span id="cb118-3283"><a href="#cb118-3283" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> split <span class="op">=</span> d<span class="op">.</span><span class="fu">split</span>(<span class="st">"-"</span>)<span class="op">;</span></span>
<span id="cb118-3284"><a href="#cb118-3284" aria-hidden="true" tabindex="-1"></a>      <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(d)<span class="op">;</span></span>
<span id="cb118-3285"><a href="#cb118-3285" aria-hidden="true" tabindex="-1"></a>      <span class="co">// let clean_text = vulnerability_dict[split[0]][split[1]];</span></span>
<span id="cb118-3286"><a href="#cb118-3286" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> clean_text <span class="op">=</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">acVars</span>[split[<span class="dv">1</span>]])<span class="op">;</span></span>
<span id="cb118-3287"><a href="#cb118-3287" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> clean_text<span class="op">;</span></span>
<span id="cb118-3288"><a href="#cb118-3288" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb118-3289"><a href="#cb118-3289" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"black"</span>)</span>
<span id="cb118-3290"><a href="#cb118-3290" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="st">"12px"</span>)<span class="op">;</span></span>
<span id="cb118-3291"><a href="#cb118-3291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-3292"><a href="#cb118-3292" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb118-3293"><a href="#cb118-3293" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"avgLabel"</span>)</span>
<span id="cb118-3294"><a href="#cb118-3294" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(means)</span>
<span id="cb118-3295"><a href="#cb118-3295" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb118-3296"><a href="#cb118-3296" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb118-3297"><a href="#cb118-3297" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> width <span class="op">-</span> margin<span class="op">.</span><span class="at">right</span>) <span class="co">// Align it with the right margin</span></span>
<span id="cb118-3298"><a href="#cb118-3298" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> (d) <span class="kw">=&gt;</span></span>
<span id="cb118-3299"><a href="#cb118-3299" aria-hidden="true" tabindex="-1"></a>      y[dimensions[dimensions<span class="op">.</span><span class="at">length</span> <span class="op">-</span> <span class="dv">1</span>]](</span>
<span id="cb118-3300"><a href="#cb118-3300" aria-hidden="true" tabindex="-1"></a>        d[dimensions[dimensions<span class="op">.</span><span class="at">length</span> <span class="op">-</span> <span class="dv">1</span>]]<span class="op">,</span></span>
<span id="cb118-3301"><a href="#cb118-3301" aria-hidden="true" tabindex="-1"></a>      )<span class="op">,</span></span>
<span id="cb118-3302"><a href="#cb118-3302" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb118-3303"><a href="#cb118-3303" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dy"</span><span class="op">,</span> <span class="st">".35em"</span>)</span>
<span id="cb118-3304"><a href="#cb118-3304" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"start"</span>)</span>
<span id="cb118-3305"><a href="#cb118-3305" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"#2E7636"</span>)</span>
<span id="cb118-3306"><a href="#cb118-3306" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"tspan"</span>)</span>
<span id="cb118-3307"><a href="#cb118-3307" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>([country<span class="op">,</span> <span class="st">"Average"</span>])</span>
<span id="cb118-3308"><a href="#cb118-3308" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb118-3309"><a href="#cb118-3309" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"tspan"</span>)</span>
<span id="cb118-3310"><a href="#cb118-3310" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> width <span class="op">-</span> margin<span class="op">.</span><span class="at">right</span> <span class="op">+</span> <span class="dv">5</span>) <span class="co">// Align both lines with the same x position</span></span>
<span id="cb118-3311"><a href="#cb118-3311" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dy"</span><span class="op">,</span> (d<span class="op">,</span> i) <span class="kw">=&gt;</span> (i <span class="op">===</span> <span class="dv">0</span> <span class="op">?</span> <span class="dv">0</span> <span class="op">:</span> <span class="st">"1.2em"</span>)) <span class="co">// Offset the second line</span></span>
<span id="cb118-3312"><a href="#cb118-3312" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>((d) <span class="kw">=&gt;</span> d)<span class="op">;</span></span>
<span id="cb118-3313"><a href="#cb118-3313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-3314"><a href="#cb118-3314" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> svg<span class="op">.</span><span class="fu">node</span>()<span class="op">;</span></span>
<span id="cb118-3315"><a href="#cb118-3315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-3316"><a href="#cb118-3316" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">pivotData</span>(data) {</span>
<span id="cb118-3317"><a href="#cb118-3317" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> pivotedData <span class="op">=</span> {}<span class="op">;</span></span>
<span id="cb118-3318"><a href="#cb118-3318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-3319"><a href="#cb118-3319" aria-hidden="true" tabindex="-1"></a>    data<span class="op">.</span><span class="fu">forEach</span>((row) <span class="kw">=&gt;</span> {</span>
<span id="cb118-3320"><a href="#cb118-3320" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> country <span class="op">=</span> row[admin_aggregationLevel]<span class="op">;</span></span>
<span id="cb118-3321"><a href="#cb118-3321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-3322"><a href="#cb118-3322" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="op">!</span>pivotedData[country]) {</span>
<span id="cb118-3323"><a href="#cb118-3323" aria-hidden="true" tabindex="-1"></a>        pivotedData[country] <span class="op">=</span> { country }<span class="op">;</span></span>
<span id="cb118-3324"><a href="#cb118-3324" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb118-3325"><a href="#cb118-3325" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> combined_name <span class="op">=</span> row<span class="op">.</span><span class="at">group</span> <span class="op">+</span> <span class="st">"-"</span> <span class="op">+</span> row<span class="op">.</span><span class="at">variable</span><span class="op">;</span></span>
<span id="cb118-3326"><a href="#cb118-3326" aria-hidden="true" tabindex="-1"></a>      pivotedData[country][combined_name] <span class="op">=</span> row<span class="op">.</span><span class="at">value</span><span class="op">;</span></span>
<span id="cb118-3327"><a href="#cb118-3327" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb118-3328"><a href="#cb118-3328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-3329"><a href="#cb118-3329" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">values</span>(pivotedData)<span class="op">;</span></span>
<span id="cb118-3330"><a href="#cb118-3330" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb118-3331"><a href="#cb118-3331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-3332"><a href="#cb118-3332" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">calculateMeans</span>(data) {</span>
<span id="cb118-3333"><a href="#cb118-3333" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> groupedData <span class="op">=</span> {}<span class="op">;</span></span>
<span id="cb118-3334"><a href="#cb118-3334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-3335"><a href="#cb118-3335" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Group data by variable</span></span>
<span id="cb118-3336"><a href="#cb118-3336" aria-hidden="true" tabindex="-1"></a>    data<span class="op">.</span><span class="fu">forEach</span>((row) <span class="kw">=&gt;</span> {</span>
<span id="cb118-3337"><a href="#cb118-3337" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> combined_name <span class="op">=</span> row<span class="op">.</span><span class="at">group</span> <span class="op">+</span> <span class="st">"-"</span> <span class="op">+</span> row<span class="op">.</span><span class="at">variable</span><span class="op">;</span></span>
<span id="cb118-3338"><a href="#cb118-3338" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="op">!</span>groupedData[combined_name]) {</span>
<span id="cb118-3339"><a href="#cb118-3339" aria-hidden="true" tabindex="-1"></a>        groupedData[combined_name] <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb118-3340"><a href="#cb118-3340" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb118-3341"><a href="#cb118-3341" aria-hidden="true" tabindex="-1"></a>      groupedData[combined_name]<span class="op">.</span><span class="fu">push</span>(row<span class="op">.</span><span class="at">value</span>)<span class="op">;</span></span>
<span id="cb118-3342"><a href="#cb118-3342" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb118-3343"><a href="#cb118-3343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-3344"><a href="#cb118-3344" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Calculate mean for each variable</span></span>
<span id="cb118-3345"><a href="#cb118-3345" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> means <span class="op">=</span> {}<span class="op">;</span></span>
<span id="cb118-3346"><a href="#cb118-3346" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (<span class="kw">const</span> [variable<span class="op">,</span> values] <span class="kw">of</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">entries</span>(groupedData)) {</span>
<span id="cb118-3347"><a href="#cb118-3347" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> sum <span class="op">=</span> values<span class="op">.</span><span class="fu">reduce</span>((acc<span class="op">,</span> val) <span class="kw">=&gt;</span> acc <span class="op">+</span> val<span class="op">,</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb118-3348"><a href="#cb118-3348" aria-hidden="true" tabindex="-1"></a>      means[variable] <span class="op">=</span> sum <span class="op">/</span> values<span class="op">.</span><span class="at">length</span><span class="op">;</span></span>
<span id="cb118-3349"><a href="#cb118-3349" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb118-3350"><a href="#cb118-3350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-3351"><a href="#cb118-3351" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [means]<span class="op">;</span></span>
<span id="cb118-3352"><a href="#cb118-3352" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb118-3353"><a href="#cb118-3353" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-118" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb119" data-startfrom="3357" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3356"><span id="cb119-3357"><a href="#cb119-3357" aria-hidden="true" tabindex="-1"></a>parallelCoordinatesScatterPlot2 <span class="op">=</span> <span class="kw">async</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb119-3358"><a href="#cb119-3358" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> margin <span class="op">=</span> { <span class="dt">top</span><span class="op">:</span> <span class="dv">60</span><span class="op">,</span> <span class="dt">right</span><span class="op">:</span> <span class="dv">80</span><span class="op">,</span> <span class="dt">bottom</span><span class="op">:</span> <span class="dv">25</span><span class="op">,</span> <span class="dt">left</span><span class="op">:</span> <span class="dv">40</span> }<span class="op">,</span></span>
<span id="cb119-3359"><a href="#cb119-3359" aria-hidden="true" tabindex="-1"></a>    width <span class="op">=</span> <span class="dv">1200</span> <span class="op">-</span> margin<span class="op">.</span><span class="at">left</span> <span class="op">-</span> margin<span class="op">.</span><span class="at">right</span><span class="op">,</span></span>
<span id="cb119-3360"><a href="#cb119-3360" aria-hidden="true" tabindex="-1"></a>    height <span class="op">=</span> <span class="dv">600</span> <span class="op">-</span> margin<span class="op">.</span><span class="at">top</span> <span class="op">-</span> margin<span class="op">.</span><span class="at">bottom</span><span class="op">;</span></span>
<span id="cb119-3361"><a href="#cb119-3361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3362"><a href="#cb119-3362" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> group_query <span class="op">=</span> <span class="vs">`AND "group" in (</span><span class="sc">${</span></span>
<span id="cb119-3363"><a href="#cb119-3363" aria-hidden="true" tabindex="-1"></a>    <span class="st">"'"</span> <span class="op">+</span></span>
<span id="cb119-3364"><a href="#cb119-3364" aria-hidden="true" tabindex="-1"></a>    DataSelector_form<span class="op">.</span><span class="at">vulnerabilityGroup_form</span><span class="op">.</span><span class="at">vulnerability_sel</span></span>
<span id="cb119-3365"><a href="#cb119-3365" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">join</span>(<span class="st">"', '"</span>)</span>
<span id="cb119-3366"><a href="#cb119-3366" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">toLowerCase</span>() <span class="op">+</span></span>
<span id="cb119-3367"><a href="#cb119-3367" aria-hidden="true" tabindex="-1"></a>    <span class="st">"'"</span></span>
<span id="cb119-3368"><a href="#cb119-3368" aria-hidden="true" tabindex="-1"></a>  <span class="sc">}</span><span class="vs">)`</span><span class="op">;</span></span>
<span id="cb119-3369"><a href="#cb119-3369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3370"><a href="#cb119-3370" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> data <span class="op">=</span> <span class="cf">await</span> db<span class="op">.</span><span class="fu">query</span>(</span>
<span id="cb119-3371"><a href="#cb119-3371" aria-hidden="true" tabindex="-1"></a>    <span class="vs">`SELECT "admin0_name", "admin1_name", "admin2_name", "group", "variable", "value"</span></span>
<span id="cb119-3372"><a href="#cb119-3372" aria-hidden="true" tabindex="-1"></a><span class="vs">     FROM Vulnerability </span></span>
<span id="cb119-3373"><a href="#cb119-3373" aria-hidden="true" tabindex="-1"></a><span class="vs">     </span><span class="sc">${</span>plotQuery2_admin<span class="sc">}</span></span>
<span id="cb119-3374"><a href="#cb119-3374" aria-hidden="true" tabindex="-1"></a><span class="vs">     AND "variable" != 'GenderEquity_1995.2015'</span></span>
<span id="cb119-3375"><a href="#cb119-3375" aria-hidden="true" tabindex="-1"></a><span class="vs">     </span><span class="sc">${</span>group_query<span class="sc">}</span><span class="vs">`</span><span class="op">,</span></span>
<span id="cb119-3376"><a href="#cb119-3376" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb119-3377"><a href="#cb119-3377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3378"><a href="#cb119-3378" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> data_vuln <span class="op">=</span> <span class="fu">pivotData</span>(data)<span class="op">;</span></span>
<span id="cb119-3379"><a href="#cb119-3379" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> means <span class="op">=</span> <span class="fu">calculateMeans</span>(data)<span class="op">;</span></span>
<span id="cb119-3380"><a href="#cb119-3380" aria-hidden="true" tabindex="-1"></a>  means<span class="op">.</span><span class="at">country</span> <span class="op">=</span> <span class="st">"Regional Average"</span><span class="op">;</span></span>
<span id="cb119-3381"><a href="#cb119-3381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3382"><a href="#cb119-3382" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dimensions <span class="op">=</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">keys</span>(data_vuln[<span class="dv">0</span>])<span class="op">.</span><span class="fu">filter</span>((d) <span class="kw">=&gt;</span> d <span class="op">!==</span> <span class="st">"country"</span>)<span class="op">;</span></span>
<span id="cb119-3383"><a href="#cb119-3383" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> jitter <span class="op">=</span> d3<span class="op">.</span><span class="fu">randomUniform</span>(<span class="op">-</span><span class="dv">20</span><span class="op">,</span> <span class="dv">20</span>)<span class="op">;</span></span>
<span id="cb119-3384"><a href="#cb119-3384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3385"><a href="#cb119-3385" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> color <span class="op">=</span> d3</span>
<span id="cb119-3386"><a href="#cb119-3386" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">scaleOrdinal</span>()</span>
<span id="cb119-3387"><a href="#cb119-3387" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>(data_vuln<span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">country</span>))</span>
<span id="cb119-3388"><a href="#cb119-3388" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>(d3<span class="op">.</span><span class="at">schemeCategory10</span>)<span class="op">;</span></span>
<span id="cb119-3389"><a href="#cb119-3389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3390"><a href="#cb119-3390" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> svg <span class="op">=</span> d3</span>
<span id="cb119-3391"><a href="#cb119-3391" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">create</span>(<span class="st">"svg"</span>)</span>
<span id="cb119-3392"><a href="#cb119-3392" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"VulnerableParallelScatter"</span>)</span>
<span id="cb119-3393"><a href="#cb119-3393" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"viewBox"</span><span class="op">,</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> width<span class="op">,</span> height])</span>
<span id="cb119-3394"><a href="#cb119-3394" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> width)</span>
<span id="cb119-3395"><a href="#cb119-3395" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> height)<span class="op">;</span></span>
<span id="cb119-3396"><a href="#cb119-3396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3397"><a href="#cb119-3397" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Define the variable categories (gender, poverty, education)</span></span>
<span id="cb119-3398"><a href="#cb119-3398" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> categories <span class="op">=</span> {</span>
<span id="cb119-3399"><a href="#cb119-3399" aria-hidden="true" tabindex="-1"></a>    <span class="dt">gender</span><span class="op">:</span> {</span>
<span id="cb119-3400"><a href="#cb119-3400" aria-hidden="true" tabindex="-1"></a>      <span class="dt">values</span><span class="op">:</span> dimensions<span class="op">.</span><span class="fu">filter</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="fu">startsWith</span>(<span class="st">"gender"</span>))<span class="op">,</span></span>
<span id="cb119-3401"><a href="#cb119-3401" aria-hidden="true" tabindex="-1"></a>      <span class="dt">range</span><span class="op">:</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">1</span>]<span class="op">,</span></span>
<span id="cb119-3402"><a href="#cb119-3402" aria-hidden="true" tabindex="-1"></a>      <span class="dt">unit</span><span class="op">:</span> <span class="dv">10</span><span class="op">,</span></span>
<span id="cb119-3403"><a href="#cb119-3403" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb119-3404"><a href="#cb119-3404" aria-hidden="true" tabindex="-1"></a>    <span class="dt">poverty</span><span class="op">:</span> {</span>
<span id="cb119-3405"><a href="#cb119-3405" aria-hidden="true" tabindex="-1"></a>      <span class="dt">values</span><span class="op">:</span> dimensions<span class="op">.</span><span class="fu">filter</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="fu">startsWith</span>(<span class="st">"poverty"</span>))<span class="op">,</span></span>
<span id="cb119-3406"><a href="#cb119-3406" aria-hidden="true" tabindex="-1"></a>      <span class="dt">range</span><span class="op">:</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">1</span>]<span class="op">,</span></span>
<span id="cb119-3407"><a href="#cb119-3407" aria-hidden="true" tabindex="-1"></a>      <span class="dt">unit</span><span class="op">:</span> <span class="st">"percent_NoDecimal"</span><span class="op">,</span></span>
<span id="cb119-3408"><a href="#cb119-3408" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb119-3409"><a href="#cb119-3409" aria-hidden="true" tabindex="-1"></a>    <span class="dt">education</span><span class="op">:</span> {</span>
<span id="cb119-3410"><a href="#cb119-3410" aria-hidden="true" tabindex="-1"></a>      <span class="dt">values</span><span class="op">:</span> dimensions<span class="op">.</span><span class="fu">filter</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="fu">startsWith</span>(<span class="st">"education"</span>))<span class="op">,</span></span>
<span id="cb119-3411"><a href="#cb119-3411" aria-hidden="true" tabindex="-1"></a>      <span class="dt">range</span><span class="op">:</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">13</span>]<span class="op">,</span></span>
<span id="cb119-3412"><a href="#cb119-3412" aria-hidden="true" tabindex="-1"></a>      <span class="dt">unit</span><span class="op">:</span> <span class="st">"total"</span><span class="op">,</span></span>
<span id="cb119-3413"><a href="#cb119-3413" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb119-3414"><a href="#cb119-3414" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb119-3415"><a href="#cb119-3415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3416"><a href="#cb119-3416" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Flatten the categories into a single array, adding gaps between groups</span></span>
<span id="cb119-3417"><a href="#cb119-3417" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> groupedDimensions <span class="op">=</span> [</span>
<span id="cb119-3418"><a href="#cb119-3418" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span>categories<span class="op">.</span><span class="at">gender</span><span class="op">.</span><span class="at">values</span><span class="op">,</span></span>
<span id="cb119-3419"><a href="#cb119-3419" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span>categories<span class="op">.</span><span class="at">poverty</span><span class="op">.</span><span class="at">values</span><span class="op">,</span></span>
<span id="cb119-3420"><a href="#cb119-3420" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span>categories<span class="op">.</span><span class="at">education</span><span class="op">.</span><span class="at">values</span><span class="op">,</span></span>
<span id="cb119-3421"><a href="#cb119-3421" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">;</span></span>
<span id="cb119-3422"><a href="#cb119-3422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3423"><a href="#cb119-3423" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Define the x scale, with larger spacing for the gaps</span></span>
<span id="cb119-3424"><a href="#cb119-3424" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> x <span class="op">=</span> d3</span>
<span id="cb119-3425"><a href="#cb119-3425" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">scalePoint</span>()</span>
<span id="cb119-3426"><a href="#cb119-3426" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>(groupedDimensions)</span>
<span id="cb119-3427"><a href="#cb119-3427" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>([margin<span class="op">.</span><span class="at">left</span><span class="op">,</span> width <span class="op">-</span> margin<span class="op">.</span><span class="at">right</span>])</span>
<span id="cb119-3428"><a href="#cb119-3428" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">padding</span>(<span class="fl">0.3</span>)<span class="op">;</span> <span class="co">// Add extra padding for the gaps</span></span>
<span id="cb119-3429"><a href="#cb119-3429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3430"><a href="#cb119-3430" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> y <span class="op">=</span> {}<span class="op">;</span></span>
<span id="cb119-3431"><a href="#cb119-3431" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">const</span> dim <span class="kw">of</span> groupedDimensions) {</span>
<span id="cb119-3432"><a href="#cb119-3432" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> group <span class="op">=</span> dim<span class="op">.</span><span class="fu">split</span>(<span class="st">"-"</span>)[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb119-3433"><a href="#cb119-3433" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> y_extent <span class="op">=</span> categories[group]<span class="op">.</span><span class="at">range</span><span class="op">;</span></span>
<span id="cb119-3434"><a href="#cb119-3434" aria-hidden="true" tabindex="-1"></a>    y[dim] <span class="op">=</span> d3</span>
<span id="cb119-3435"><a href="#cb119-3435" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb119-3436"><a href="#cb119-3436" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">domain</span>(y_extent)</span>
<span id="cb119-3437"><a href="#cb119-3437" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">range</span>([height <span class="op">-</span> margin<span class="op">.</span><span class="at">bottom</span><span class="op">,</span> margin<span class="op">.</span><span class="at">top</span>])<span class="op">;</span></span>
<span id="cb119-3438"><a href="#cb119-3438" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb119-3439"><a href="#cb119-3439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3440"><a href="#cb119-3440" aria-hidden="true" tabindex="-1"></a>  d3<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".ParallelCoordTip"</span>)<span class="op">.</span><span class="fu">remove</span>()<span class="op">;</span></span>
<span id="cb119-3441"><a href="#cb119-3441" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> tooltip <span class="op">=</span> d3</span>
<span id="cb119-3442"><a href="#cb119-3442" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">select</span>(<span class="st">"body"</span>)</span>
<span id="cb119-3443"><a href="#cb119-3443" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"div"</span>)</span>
<span id="cb119-3444"><a href="#cb119-3444" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"plotTooltip ParallelCoordTip"</span>)</span>
<span id="cb119-3445"><a href="#cb119-3445" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"position"</span><span class="op">,</span> <span class="st">"absolute"</span>)<span class="op">;</span></span>
<span id="cb119-3446"><a href="#cb119-3446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3447"><a href="#cb119-3447" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Create circles for each data point</span></span>
<span id="cb119-3448"><a href="#cb119-3448" aria-hidden="true" tabindex="-1"></a>  groupedDimensions<span class="op">.</span><span class="fu">forEach</span>((dim) <span class="kw">=&gt;</span> {</span>
<span id="cb119-3449"><a href="#cb119-3449" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (dim <span class="op">===</span> <span class="st">""</span>) <span class="cf">return</span><span class="op">;</span> <span class="co">// Skip gaps</span></span>
<span id="cb119-3450"><a href="#cb119-3450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3451"><a href="#cb119-3451" aria-hidden="true" tabindex="-1"></a>    svg</span>
<span id="cb119-3452"><a href="#cb119-3452" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="vs">`.dot-</span><span class="sc">${</span>dim<span class="sc">}</span><span class="vs">`</span>)</span>
<span id="cb119-3453"><a href="#cb119-3453" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(data_vuln)</span>
<span id="cb119-3454"><a href="#cb119-3454" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">join</span>(<span class="st">"circle"</span>)</span>
<span id="cb119-3455"><a href="#cb119-3455" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(</span>
<span id="cb119-3456"><a href="#cb119-3456" aria-hidden="true" tabindex="-1"></a>        <span class="st">"class"</span><span class="op">,</span></span>
<span id="cb119-3457"><a href="#cb119-3457" aria-hidden="true" tabindex="-1"></a>        (d) <span class="kw">=&gt;</span> <span class="vs">`dot-</span><span class="sc">${</span>dim<span class="sc">}</span><span class="vs"> country-</span><span class="sc">${</span>d<span class="op">.</span><span class="at">country</span><span class="op">.</span><span class="fu">replace</span>(<span class="ss">/</span><span class="sc">\s+</span><span class="ss">/g</span><span class="op">,</span> <span class="st">"-"</span>)<span class="sc">}</span><span class="vs">`</span><span class="op">,</span></span>
<span id="cb119-3458"><a href="#cb119-3458" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb119-3459"><a href="#cb119-3459" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cx"</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="fu">x</span>(dim) <span class="op">+</span> <span class="fu">jitter</span>())</span>
<span id="cb119-3460"><a href="#cb119-3460" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cy"</span><span class="op">,</span> (d) <span class="kw">=&gt;</span> {</span>
<span id="cb119-3461"><a href="#cb119-3461" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> y[dim](d[dim])<span class="op">;</span></span>
<span id="cb119-3462"><a href="#cb119-3462" aria-hidden="true" tabindex="-1"></a>      })</span>
<span id="cb119-3463"><a href="#cb119-3463" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"r"</span><span class="op">,</span> <span class="dv">5</span>)</span>
<span id="cb119-3464"><a href="#cb119-3464" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">style</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"lightgrey"</span>)</span>
<span id="cb119-3465"><a href="#cb119-3465" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">style</span>(<span class="st">"opacity"</span><span class="op">,</span> <span class="fl">0.5</span>)</span>
<span id="cb119-3466"><a href="#cb119-3466" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">on</span>(<span class="st">"mouseover"</span><span class="op">,</span> <span class="kw">function</span> (<span class="bu">event</span><span class="op">,</span> d) {</span>
<span id="cb119-3467"><a href="#cb119-3467" aria-hidden="true" tabindex="-1"></a>        svg</span>
<span id="cb119-3468"><a href="#cb119-3468" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">selectAll</span>(<span class="vs">`.country-</span><span class="sc">${</span>d<span class="op">.</span><span class="at">country</span><span class="op">.</span><span class="fu">replace</span>(<span class="ss">/</span><span class="sc">\s+</span><span class="ss">/g</span><span class="op">,</span> <span class="st">"-"</span>)<span class="sc">}</span><span class="vs">`</span>)</span>
<span id="cb119-3469"><a href="#cb119-3469" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"r"</span><span class="op">,</span> <span class="dv">8</span>)</span>
<span id="cb119-3470"><a href="#cb119-3470" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">style</span>(<span class="st">"opacity"</span><span class="op">,</span> <span class="dv">1</span>)</span>
<span id="cb119-3471"><a href="#cb119-3471" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">style</span>(<span class="st">"fill"</span><span class="op">,</span> (d) <span class="kw">=&gt;</span> <span class="fu">color</span>(d<span class="op">.</span><span class="at">country</span>))</span>
<span id="cb119-3472"><a href="#cb119-3472" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">raise</span>()<span class="op">;</span></span>
<span id="cb119-3473"><a href="#cb119-3473" aria-hidden="true" tabindex="-1"></a>        tooltip</span>
<span id="cb119-3474"><a href="#cb119-3474" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">style</span>(<span class="st">"top"</span><span class="op">,</span> <span class="bu">event</span><span class="op">.</span><span class="at">pageY</span> <span class="op">-</span> <span class="dv">1</span> <span class="op">+</span> <span class="st">"px"</span>)</span>
<span id="cb119-3475"><a href="#cb119-3475" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">style</span>(<span class="st">"left"</span><span class="op">,</span> <span class="bu">event</span><span class="op">.</span><span class="at">pageX</span> <span class="op">+</span> <span class="dv">1</span> <span class="op">+</span> <span class="st">"px"</span>)</span>
<span id="cb119-3476"><a href="#cb119-3476" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">style</span>(<span class="st">"opacity"</span><span class="op">,</span> <span class="fl">0.8</span>)</span>
<span id="cb119-3477"><a href="#cb119-3477" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">style</span>(<span class="st">"display"</span><span class="op">,</span> <span class="st">"block"</span>)</span>
<span id="cb119-3478"><a href="#cb119-3478" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">html</span>(() <span class="kw">=&gt;</span> {</span>
<span id="cb119-3479"><a href="#cb119-3479" aria-hidden="true" tabindex="-1"></a>            <span class="kw">let</span> admin_string <span class="op">=</span> d<span class="op">.</span><span class="at">country</span><span class="op">;</span></span>
<span id="cb119-3480"><a href="#cb119-3480" aria-hidden="true" tabindex="-1"></a>            <span class="kw">let</span> admin_names <span class="op">=</span> admin_string<span class="op">.</span><span class="fu">split</span>(<span class="st">"_"</span>)<span class="op">;</span></span>
<span id="cb119-3481"><a href="#cb119-3481" aria-hidden="true" tabindex="-1"></a>            <span class="kw">let</span> admin0_name <span class="op">=</span> admin_names[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb119-3482"><a href="#cb119-3482" aria-hidden="true" tabindex="-1"></a>            <span class="kw">let</span> admin_join <span class="op">=</span> admin_names</span>
<span id="cb119-3483"><a href="#cb119-3483" aria-hidden="true" tabindex="-1"></a>              <span class="op">.</span><span class="fu">filter</span>((name) <span class="kw">=&gt;</span> name <span class="op">!==</span> <span class="st">"null"</span>)</span>
<span id="cb119-3484"><a href="#cb119-3484" aria-hidden="true" tabindex="-1"></a>              <span class="op">.</span><span class="fu">join</span>(<span class="st">", "</span>)<span class="op">;</span></span>
<span id="cb119-3485"><a href="#cb119-3485" aria-hidden="true" tabindex="-1"></a>            <span class="kw">let</span> splitVar <span class="op">=</span> dim<span class="op">.</span><span class="fu">split</span>(<span class="st">"-"</span>)<span class="op">;</span></span>
<span id="cb119-3486"><a href="#cb119-3486" aria-hidden="true" tabindex="-1"></a>            <span class="kw">let</span> varname <span class="op">=</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">acVars</span>[splitVar[<span class="dv">1</span>]])<span class="op">;</span></span>
<span id="cb119-3487"><a href="#cb119-3487" aria-hidden="true" tabindex="-1"></a>            <span class="kw">let</span> varValue <span class="op">=</span> <span class="fu">format_val</span>(d[dim]<span class="op">,</span> categories[splitVar[<span class="dv">0</span>]]<span class="op">.</span><span class="at">unit</span>)<span class="op">;</span></span>
<span id="cb119-3488"><a href="#cb119-3488" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="vs">`</span><span class="sc">${</span>admin_join<span class="sc">}</span><span class="vs">&lt;br/&gt;</span><span class="sc">${</span>varname<span class="sc">}</span><span class="vs">: </span><span class="sc">${</span>varValue<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span>
<span id="cb119-3489"><a href="#cb119-3489" aria-hidden="true" tabindex="-1"></a>          })<span class="op">;</span></span>
<span id="cb119-3490"><a href="#cb119-3490" aria-hidden="true" tabindex="-1"></a>        <span class="co">// .html(`${d.country}&lt;br/&gt;${dim}: ${d[dim].toFixed(2)}`);</span></span>
<span id="cb119-3491"><a href="#cb119-3491" aria-hidden="true" tabindex="-1"></a>      })</span>
<span id="cb119-3492"><a href="#cb119-3492" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">on</span>(<span class="st">"mouseout"</span><span class="op">,</span> <span class="kw">function</span> (<span class="bu">event</span><span class="op">,</span> d) {</span>
<span id="cb119-3493"><a href="#cb119-3493" aria-hidden="true" tabindex="-1"></a>        svg</span>
<span id="cb119-3494"><a href="#cb119-3494" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">selectAll</span>(<span class="vs">`.country-</span><span class="sc">${</span>d<span class="op">.</span><span class="at">country</span><span class="op">.</span><span class="fu">replace</span>(<span class="ss">/</span><span class="sc">\s+</span><span class="ss">/g</span><span class="op">,</span> <span class="st">"-"</span>)<span class="sc">}</span><span class="vs">`</span>)</span>
<span id="cb119-3495"><a href="#cb119-3495" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"r"</span><span class="op">,</span> <span class="dv">5</span>)</span>
<span id="cb119-3496"><a href="#cb119-3496" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">style</span>(<span class="st">"opacity"</span><span class="op">,</span> <span class="fl">0.5</span>)</span>
<span id="cb119-3497"><a href="#cb119-3497" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">style</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"lightgrey"</span>)</span>
<span id="cb119-3498"><a href="#cb119-3498" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">lower</span>()<span class="op">;</span></span>
<span id="cb119-3499"><a href="#cb119-3499" aria-hidden="true" tabindex="-1"></a>        tooltip<span class="op">.</span><span class="fu">style</span>(<span class="st">"display"</span><span class="op">,</span> <span class="st">"none"</span>)<span class="op">;</span></span>
<span id="cb119-3500"><a href="#cb119-3500" aria-hidden="true" tabindex="-1"></a>      })<span class="op">;</span></span>
<span id="cb119-3501"><a href="#cb119-3501" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb119-3502"><a href="#cb119-3502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3503"><a href="#cb119-3503" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Add average points</span></span>
<span id="cb119-3504"><a href="#cb119-3504" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> avg_points <span class="op">=</span> svg</span>
<span id="cb119-3505"><a href="#cb119-3505" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".avg-dot"</span>)</span>
<span id="cb119-3506"><a href="#cb119-3506" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(groupedDimensions)</span>
<span id="cb119-3507"><a href="#cb119-3507" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb119-3508"><a href="#cb119-3508" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"circle"</span>)</span>
<span id="cb119-3509"><a href="#cb119-3509" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"avg-dot"</span>)</span>
<span id="cb119-3510"><a href="#cb119-3510" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cx"</span><span class="op">,</span> (d) <span class="kw">=&gt;</span> <span class="fu">x</span>(d))</span>
<span id="cb119-3511"><a href="#cb119-3511" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cy"</span><span class="op">,</span> (d) <span class="kw">=&gt;</span> y[d](means[<span class="dv">0</span>][d]))</span>
<span id="cb119-3512"><a href="#cb119-3512" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"r"</span><span class="op">,</span> <span class="dv">7</span>)</span>
<span id="cb119-3513"><a href="#cb119-3513" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"#2E7636"</span>)</span>
<span id="cb119-3514"><a href="#cb119-3514" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"white"</span>)</span>
<span id="cb119-3515"><a href="#cb119-3515" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="dv">2</span>)<span class="op">;</span></span>
<span id="cb119-3516"><a href="#cb119-3516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3517"><a href="#cb119-3517" aria-hidden="true" tabindex="-1"></a>  avg_points</span>
<span id="cb119-3518"><a href="#cb119-3518" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"mouseover"</span><span class="op">,</span> <span class="kw">function</span> (<span class="bu">event</span><span class="op">,</span> d) {</span>
<span id="cb119-3519"><a href="#cb119-3519" aria-hidden="true" tabindex="-1"></a>      svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="vs">`.avg-dot`</span>)<span class="op">.</span><span class="fu">raise</span>()<span class="op">;</span></span>
<span id="cb119-3520"><a href="#cb119-3520" aria-hidden="true" tabindex="-1"></a>      tooltip</span>
<span id="cb119-3521"><a href="#cb119-3521" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"top"</span><span class="op">,</span> <span class="bu">event</span><span class="op">.</span><span class="at">pageY</span> <span class="op">-</span> <span class="dv">1</span> <span class="op">+</span> <span class="st">"px"</span>)</span>
<span id="cb119-3522"><a href="#cb119-3522" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"left"</span><span class="op">,</span> <span class="bu">event</span><span class="op">.</span><span class="at">pageX</span> <span class="op">+</span> <span class="dv">1</span> <span class="op">+</span> <span class="st">"px"</span>)</span>
<span id="cb119-3523"><a href="#cb119-3523" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"opacity"</span><span class="op">,</span> <span class="fl">0.8</span>)</span>
<span id="cb119-3524"><a href="#cb119-3524" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"display"</span><span class="op">,</span> <span class="st">"block"</span>)</span>
<span id="cb119-3525"><a href="#cb119-3525" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">html</span>(() <span class="kw">=&gt;</span> {</span>
<span id="cb119-3526"><a href="#cb119-3526" aria-hidden="true" tabindex="-1"></a>          <span class="kw">let</span> admin_name <span class="op">=</span> means<span class="op">.</span><span class="at">country</span><span class="op">;</span></span>
<span id="cb119-3527"><a href="#cb119-3527" aria-hidden="true" tabindex="-1"></a>          <span class="kw">let</span> splitVar <span class="op">=</span> d<span class="op">.</span><span class="fu">split</span>(<span class="st">"-"</span>)<span class="op">;</span></span>
<span id="cb119-3528"><a href="#cb119-3528" aria-hidden="true" tabindex="-1"></a>          <span class="kw">let</span> varname <span class="op">=</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">acVars</span>[splitVar[<span class="dv">1</span>]])<span class="op">;</span></span>
<span id="cb119-3529"><a href="#cb119-3529" aria-hidden="true" tabindex="-1"></a>          <span class="kw">let</span> varValue <span class="op">=</span> <span class="fu">format_val</span>(means[<span class="dv">0</span>][d]<span class="op">,</span> categories[splitVar[<span class="dv">0</span>]]<span class="op">.</span><span class="at">unit</span>)<span class="op">;</span></span>
<span id="cb119-3530"><a href="#cb119-3530" aria-hidden="true" tabindex="-1"></a>          <span class="cf">return</span> <span class="vs">`</span><span class="sc">${</span>admin_name<span class="sc">}</span><span class="vs">&lt;br/&gt;</span><span class="sc">${</span>varname<span class="sc">}</span><span class="vs">: </span><span class="sc">${</span>varValue<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span>
<span id="cb119-3531"><a href="#cb119-3531" aria-hidden="true" tabindex="-1"></a>        })<span class="op">;</span></span>
<span id="cb119-3532"><a href="#cb119-3532" aria-hidden="true" tabindex="-1"></a>      <span class="co">// .html(`${d.country}&lt;br/&gt;${dim}: ${d[dim].toFixed(2)}`);</span></span>
<span id="cb119-3533"><a href="#cb119-3533" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb119-3534"><a href="#cb119-3534" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"mouseout"</span><span class="op">,</span> <span class="kw">function</span> (<span class="bu">event</span><span class="op">,</span> d) {</span>
<span id="cb119-3535"><a href="#cb119-3535" aria-hidden="true" tabindex="-1"></a>      svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="vs">`.avg-dot`</span>)<span class="op">;</span></span>
<span id="cb119-3536"><a href="#cb119-3536" aria-hidden="true" tabindex="-1"></a>      <span class="co">// .lower();</span></span>
<span id="cb119-3537"><a href="#cb119-3537" aria-hidden="true" tabindex="-1"></a>      tooltip<span class="op">.</span><span class="fu">style</span>(<span class="st">"display"</span><span class="op">,</span> <span class="st">"none"</span>)<span class="op">;</span></span>
<span id="cb119-3538"><a href="#cb119-3538" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb119-3539"><a href="#cb119-3539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3540"><a href="#cb119-3540" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb119-3541"><a href="#cb119-3541" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"myAxis"</span>)</span>
<span id="cb119-3542"><a href="#cb119-3542" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(groupedDimensions)</span>
<span id="cb119-3543"><a href="#cb119-3543" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb119-3544"><a href="#cb119-3544" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb119-3545"><a href="#cb119-3545" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> (d) <span class="kw">=&gt;</span> <span class="st">"translate("</span> <span class="op">+</span> <span class="fu">x</span>(d) <span class="op">+</span> <span class="st">")"</span>)</span>
<span id="cb119-3546"><a href="#cb119-3546" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"pointer-events"</span><span class="op">,</span> <span class="st">"none"</span>)</span>
<span id="cb119-3547"><a href="#cb119-3547" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">each</span>(<span class="kw">function</span> (d) {</span>
<span id="cb119-3548"><a href="#cb119-3548" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> group <span class="op">=</span> d<span class="op">.</span><span class="fu">split</span>(<span class="st">"-"</span>)[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb119-3549"><a href="#cb119-3549" aria-hidden="true" tabindex="-1"></a>      d3<span class="op">.</span><span class="fu">select</span>(<span class="kw">this</span>)<span class="op">.</span><span class="fu">call</span>(</span>
<span id="cb119-3550"><a href="#cb119-3550" aria-hidden="true" tabindex="-1"></a>        d3</span>
<span id="cb119-3551"><a href="#cb119-3551" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">axisLeft</span>()</span>
<span id="cb119-3552"><a href="#cb119-3552" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">scale</span>(y[d])</span>
<span id="cb119-3553"><a href="#cb119-3553" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">tickFormat</span>((v) <span class="kw">=&gt;</span> <span class="fu">format_val</span>(v<span class="op">,</span> categories[group]<span class="op">.</span><span class="at">unit</span>))<span class="op">,</span></span>
<span id="cb119-3554"><a href="#cb119-3554" aria-hidden="true" tabindex="-1"></a>      )<span class="op">;</span></span>
<span id="cb119-3555"><a href="#cb119-3555" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb119-3556"><a href="#cb119-3556" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb119-3557"><a href="#cb119-3557" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb119-3558"><a href="#cb119-3558" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> (d<span class="op">,</span> i) <span class="kw">=&gt;</span> {</span>
<span id="cb119-3559"><a href="#cb119-3559" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> i <span class="op">%</span> <span class="dv">2</span> <span class="op">===</span> <span class="dv">0</span> <span class="op">?</span> margin<span class="op">.</span><span class="at">top</span> <span class="op">-</span> <span class="dv">10</span> <span class="op">:</span> height <span class="op">-</span> margin<span class="op">.</span><span class="at">bottom</span> <span class="op">+</span> <span class="dv">20</span><span class="op">;</span></span>
<span id="cb119-3560"><a href="#cb119-3560" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb119-3561"><a href="#cb119-3561" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>((d) <span class="kw">=&gt;</span> {</span>
<span id="cb119-3562"><a href="#cb119-3562" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> split <span class="op">=</span> d<span class="op">.</span><span class="fu">split</span>(<span class="st">"-"</span>)<span class="op">;</span></span>
<span id="cb119-3563"><a href="#cb119-3563" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> clean_text <span class="op">=</span> <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">acVars</span>[split[<span class="dv">1</span>]])<span class="op">;</span></span>
<span id="cb119-3564"><a href="#cb119-3564" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> clean_text<span class="op">;</span></span>
<span id="cb119-3565"><a href="#cb119-3565" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb119-3566"><a href="#cb119-3566" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"black"</span>)</span>
<span id="cb119-3567"><a href="#cb119-3567" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="st">"12px"</span>)<span class="op">;</span></span>
<span id="cb119-3568"><a href="#cb119-3568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3569"><a href="#cb119-3569" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> legendX <span class="op">=</span> <span class="dv">10</span><span class="op">;</span></span>
<span id="cb119-3570"><a href="#cb119-3570" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> legendY <span class="op">=</span> <span class="dv">5</span><span class="op">;</span></span>
<span id="cb119-3571"><a href="#cb119-3571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3572"><a href="#cb119-3572" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> legend <span class="op">=</span> svg</span>
<span id="cb119-3573"><a href="#cb119-3573" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb119-3574"><a href="#cb119-3574" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>legendX<span class="sc">}</span><span class="vs">, </span><span class="sc">${</span>legendY<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb119-3575"><a href="#cb119-3575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3576"><a href="#cb119-3576" aria-hidden="true" tabindex="-1"></a>  legend</span>
<span id="cb119-3577"><a href="#cb119-3577" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"circle"</span>)</span>
<span id="cb119-3578"><a href="#cb119-3578" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cx"</span><span class="op">,</span> <span class="dv">10</span>)</span>
<span id="cb119-3579"><a href="#cb119-3579" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cy"</span><span class="op">,</span> <span class="dv">10</span>)</span>
<span id="cb119-3580"><a href="#cb119-3580" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"r"</span><span class="op">,</span> <span class="dv">7</span>)</span>
<span id="cb119-3581"><a href="#cb119-3581" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"#2E7636"</span>)<span class="op">;</span></span>
<span id="cb119-3582"><a href="#cb119-3582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3583"><a href="#cb119-3583" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Append text next to the dot</span></span>
<span id="cb119-3584"><a href="#cb119-3584" aria-hidden="true" tabindex="-1"></a>  legend</span>
<span id="cb119-3585"><a href="#cb119-3585" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb119-3586"><a href="#cb119-3586" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> <span class="dv">20</span>)</span>
<span id="cb119-3587"><a href="#cb119-3587" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> <span class="dv">15</span>)</span>
<span id="cb119-3588"><a href="#cb119-3588" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="st">"12px"</span>)</span>
<span id="cb119-3589"><a href="#cb119-3589" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"#000"</span>)</span>
<span id="cb119-3590"><a href="#cb119-3590" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(<span class="st">"Regional Average"</span>)<span class="op">;</span></span>
<span id="cb119-3591"><a href="#cb119-3591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3592"><a href="#cb119-3592" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> svg<span class="op">.</span><span class="fu">node</span>()<span class="op">;</span></span>
<span id="cb119-3593"><a href="#cb119-3593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3594"><a href="#cb119-3594" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">pivotData</span>(data) {</span>
<span id="cb119-3595"><a href="#cb119-3595" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> pivotedData <span class="op">=</span> {}<span class="op">;</span></span>
<span id="cb119-3596"><a href="#cb119-3596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3597"><a href="#cb119-3597" aria-hidden="true" tabindex="-1"></a>    data<span class="op">.</span><span class="fu">forEach</span>((row) <span class="kw">=&gt;</span> {</span>
<span id="cb119-3598"><a href="#cb119-3598" aria-hidden="true" tabindex="-1"></a>      <span class="co">// Use a default value for any missing (NULL) admin field</span></span>
<span id="cb119-3599"><a href="#cb119-3599" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> admin0 <span class="op">=</span> row<span class="op">.</span><span class="at">admin0_name</span><span class="op">;</span></span>
<span id="cb119-3600"><a href="#cb119-3600" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> admin1 <span class="op">=</span> row<span class="op">.</span><span class="at">admin1_name</span><span class="op">;</span> <span class="co">//|| "";</span></span>
<span id="cb119-3601"><a href="#cb119-3601" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> admin2 <span class="op">=</span> row<span class="op">.</span><span class="at">admin2_name</span><span class="op">;</span> <span class="co">//|| ""</span></span>
<span id="cb119-3602"><a href="#cb119-3602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3603"><a href="#cb119-3603" aria-hidden="true" tabindex="-1"></a>      <span class="co">// Create a unique key for each combination of admin0, admin1, admin2, admin3</span></span>
<span id="cb119-3604"><a href="#cb119-3604" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> country <span class="op">=</span> <span class="vs">`</span><span class="sc">${</span>admin0<span class="sc">}</span><span class="vs">_</span><span class="sc">${</span>admin1<span class="sc">}</span><span class="vs">_</span><span class="sc">${</span>admin2<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span>
<span id="cb119-3605"><a href="#cb119-3605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3606"><a href="#cb119-3606" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="op">!</span>pivotedData[country]) {</span>
<span id="cb119-3607"><a href="#cb119-3607" aria-hidden="true" tabindex="-1"></a>        pivotedData[country] <span class="op">=</span> { country }<span class="op">;</span></span>
<span id="cb119-3608"><a href="#cb119-3608" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb119-3609"><a href="#cb119-3609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3610"><a href="#cb119-3610" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> combined_name <span class="op">=</span> row<span class="op">.</span><span class="at">group</span> <span class="op">+</span> <span class="st">"-"</span> <span class="op">+</span> row<span class="op">.</span><span class="at">variable</span><span class="op">;</span></span>
<span id="cb119-3611"><a href="#cb119-3611" aria-hidden="true" tabindex="-1"></a>      pivotedData[country][combined_name] <span class="op">=</span> row<span class="op">.</span><span class="at">value</span><span class="op">;</span></span>
<span id="cb119-3612"><a href="#cb119-3612" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb119-3613"><a href="#cb119-3613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3614"><a href="#cb119-3614" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Return the pivoted data as an array of objects</span></span>
<span id="cb119-3615"><a href="#cb119-3615" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">values</span>(pivotedData)<span class="op">;</span></span>
<span id="cb119-3616"><a href="#cb119-3616" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb119-3617"><a href="#cb119-3617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3618"><a href="#cb119-3618" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">calculateMeans</span>(data) {</span>
<span id="cb119-3619"><a href="#cb119-3619" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> groupedData <span class="op">=</span> {}<span class="op">;</span></span>
<span id="cb119-3620"><a href="#cb119-3620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3621"><a href="#cb119-3621" aria-hidden="true" tabindex="-1"></a>    data<span class="op">.</span><span class="fu">forEach</span>((row) <span class="kw">=&gt;</span> {</span>
<span id="cb119-3622"><a href="#cb119-3622" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> combined_name <span class="op">=</span> row<span class="op">.</span><span class="at">group</span> <span class="op">+</span> <span class="st">"-"</span> <span class="op">+</span> row<span class="op">.</span><span class="at">variable</span><span class="op">;</span></span>
<span id="cb119-3623"><a href="#cb119-3623" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="op">!</span>groupedData[combined_name]) {</span>
<span id="cb119-3624"><a href="#cb119-3624" aria-hidden="true" tabindex="-1"></a>        groupedData[combined_name] <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb119-3625"><a href="#cb119-3625" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb119-3626"><a href="#cb119-3626" aria-hidden="true" tabindex="-1"></a>      groupedData[combined_name]<span class="op">.</span><span class="fu">push</span>(row<span class="op">.</span><span class="at">value</span>)<span class="op">;</span></span>
<span id="cb119-3627"><a href="#cb119-3627" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb119-3628"><a href="#cb119-3628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3629"><a href="#cb119-3629" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> means <span class="op">=</span> {}<span class="op">;</span></span>
<span id="cb119-3630"><a href="#cb119-3630" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (<span class="kw">const</span> [variable<span class="op">,</span> values] <span class="kw">of</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">entries</span>(groupedData)) {</span>
<span id="cb119-3631"><a href="#cb119-3631" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> sum <span class="op">=</span> values<span class="op">.</span><span class="fu">reduce</span>((acc<span class="op">,</span> val) <span class="kw">=&gt;</span> acc <span class="op">+</span> val<span class="op">,</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb119-3632"><a href="#cb119-3632" aria-hidden="true" tabindex="-1"></a>      means[variable] <span class="op">=</span> sum <span class="op">/</span> values<span class="op">.</span><span class="at">length</span><span class="op">;</span></span>
<span id="cb119-3633"><a href="#cb119-3633" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb119-3634"><a href="#cb119-3634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3635"><a href="#cb119-3635" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [means]<span class="op">;</span></span>
<span id="cb119-3636"><a href="#cb119-3636" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb119-3637"><a href="#cb119-3637" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-119" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb120" data-startfrom="3641" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 3640"><span id="cb120-3641"><a href="#cb120-3641" aria-hidden="true" tabindex="-1"></a>parallelCoordinatesScatterPlot <span class="op">=</span> <span class="kw">async</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb120-3642"><a href="#cb120-3642" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> margin <span class="op">=</span> { <span class="dt">top</span><span class="op">:</span> <span class="dv">60</span><span class="op">,</span> <span class="dt">right</span><span class="op">:</span> <span class="dv">80</span><span class="op">,</span> <span class="dt">bottom</span><span class="op">:</span> <span class="dv">55</span><span class="op">,</span> <span class="dt">left</span><span class="op">:</span> <span class="dv">75</span> }<span class="op">,</span></span>
<span id="cb120-3643"><a href="#cb120-3643" aria-hidden="true" tabindex="-1"></a>    width <span class="op">=</span> <span class="dv">1000</span><span class="op">,</span></span>
<span id="cb120-3644"><a href="#cb120-3644" aria-hidden="true" tabindex="-1"></a>    height <span class="op">=</span> <span class="dv">600</span><span class="op">;</span></span>
<span id="cb120-3645"><a href="#cb120-3645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3646"><a href="#cb120-3646" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> group_query <span class="op">=</span> <span class="vs">`AND "group" in (</span><span class="sc">${</span></span>
<span id="cb120-3647"><a href="#cb120-3647" aria-hidden="true" tabindex="-1"></a>    <span class="st">"'"</span> <span class="op">+</span></span>
<span id="cb120-3648"><a href="#cb120-3648" aria-hidden="true" tabindex="-1"></a>    DataSelector_form<span class="op">.</span><span class="at">vulnerabilityGroup_form</span><span class="op">.</span><span class="at">vulnerability_sel</span></span>
<span id="cb120-3649"><a href="#cb120-3649" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">join</span>(<span class="st">"', '"</span>)</span>
<span id="cb120-3650"><a href="#cb120-3650" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">toLowerCase</span>() <span class="op">+</span></span>
<span id="cb120-3651"><a href="#cb120-3651" aria-hidden="true" tabindex="-1"></a>    <span class="st">"'"</span></span>
<span id="cb120-3652"><a href="#cb120-3652" aria-hidden="true" tabindex="-1"></a>  <span class="sc">}</span><span class="vs">)`</span><span class="op">;</span></span>
<span id="cb120-3653"><a href="#cb120-3653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3654"><a href="#cb120-3654" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> data <span class="op">=</span> <span class="cf">await</span> db<span class="op">.</span><span class="fu">query</span>(</span>
<span id="cb120-3655"><a href="#cb120-3655" aria-hidden="true" tabindex="-1"></a>    <span class="vs">`SELECT "admin0_name", "admin1_name", "admin2_name", "group", "variable", "value"</span></span>
<span id="cb120-3656"><a href="#cb120-3656" aria-hidden="true" tabindex="-1"></a><span class="vs">     FROM Vulnerability </span></span>
<span id="cb120-3657"><a href="#cb120-3657" aria-hidden="true" tabindex="-1"></a><span class="vs">     </span><span class="sc">${</span>plotQuery2_admin<span class="sc">}</span></span>
<span id="cb120-3658"><a href="#cb120-3658" aria-hidden="true" tabindex="-1"></a><span class="vs">     AND "variable" != 'GenderEquity_1995.2015'</span></span>
<span id="cb120-3659"><a href="#cb120-3659" aria-hidden="true" tabindex="-1"></a><span class="vs">     </span><span class="sc">${</span>group_query<span class="sc">}</span><span class="vs">`</span><span class="op">,</span></span>
<span id="cb120-3660"><a href="#cb120-3660" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb120-3661"><a href="#cb120-3661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3662"><a href="#cb120-3662" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> data_vuln <span class="op">=</span> <span class="fu">pivotData</span>(data)<span class="op">;</span></span>
<span id="cb120-3663"><a href="#cb120-3663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3664"><a href="#cb120-3664" aria-hidden="true" tabindex="-1"></a>  data_vuln<span class="op">.</span><span class="fu">forEach</span>((entry) <span class="kw">=&gt;</span> {</span>
<span id="cb120-3665"><a href="#cb120-3665" aria-hidden="true" tabindex="-1"></a>    <span class="bu">Object</span><span class="op">.</span><span class="fu">keys</span>(entry)<span class="op">.</span><span class="fu">forEach</span>((key) <span class="kw">=&gt;</span> {</span>
<span id="cb120-3666"><a href="#cb120-3666" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (key<span class="op">.</span><span class="fu">startsWith</span>(<span class="st">"poverty-"</span>)) {</span>
<span id="cb120-3667"><a href="#cb120-3667" aria-hidden="true" tabindex="-1"></a>        entry[key] <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> entry[key]<span class="op">;</span> <span class="co">// Invert value</span></span>
<span id="cb120-3668"><a href="#cb120-3668" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb120-3669"><a href="#cb120-3669" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb120-3670"><a href="#cb120-3670" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb120-3671"><a href="#cb120-3671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3672"><a href="#cb120-3672" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> means <span class="op">=</span> <span class="fu">calculateMeans</span>(data_vuln)<span class="op">;</span></span>
<span id="cb120-3673"><a href="#cb120-3673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3674"><a href="#cb120-3674" aria-hidden="true" tabindex="-1"></a>  means<span class="op">.</span><span class="at">country</span> <span class="op">=</span> <span class="st">"Regional Average"</span><span class="op">;</span></span>
<span id="cb120-3675"><a href="#cb120-3675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3676"><a href="#cb120-3676" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dimensions <span class="op">=</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">keys</span>(data_vuln[<span class="dv">0</span>])<span class="op">.</span><span class="fu">filter</span>((d) <span class="kw">=&gt;</span> d <span class="op">!==</span> <span class="st">"country"</span>)<span class="op">;</span></span>
<span id="cb120-3677"><a href="#cb120-3677" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> jitter <span class="op">=</span> d3<span class="op">.</span><span class="fu">randomUniform</span>(<span class="op">-</span><span class="dv">15</span><span class="op">,</span> <span class="dv">15</span>)<span class="op">;</span></span>
<span id="cb120-3678"><a href="#cb120-3678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3679"><a href="#cb120-3679" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> color_dep <span class="op">=</span> d3</span>
<span id="cb120-3680"><a href="#cb120-3680" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">scaleOrdinal</span>()</span>
<span id="cb120-3681"><a href="#cb120-3681" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>(data_vuln<span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">country</span>))</span>
<span id="cb120-3682"><a href="#cb120-3682" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>(d3<span class="op">.</span><span class="at">schemeCategory10</span>)<span class="op">;</span></span>
<span id="cb120-3683"><a href="#cb120-3683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3684"><a href="#cb120-3684" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> svg <span class="op">=</span> d3</span>
<span id="cb120-3685"><a href="#cb120-3685" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">create</span>(<span class="st">"svg"</span>)</span>
<span id="cb120-3686"><a href="#cb120-3686" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"VulnerableParallelScatter"</span>)</span>
<span id="cb120-3687"><a href="#cb120-3687" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"viewBox"</span><span class="op">,</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> width<span class="op">,</span> height])</span>
<span id="cb120-3688"><a href="#cb120-3688" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> width)</span>
<span id="cb120-3689"><a href="#cb120-3689" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> height)<span class="op">;</span></span>
<span id="cb120-3690"><a href="#cb120-3690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3691"><a href="#cb120-3691" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Define the variable categories (gender, poverty, education)</span></span>
<span id="cb120-3692"><a href="#cb120-3692" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> categories <span class="op">=</span> {</span>
<span id="cb120-3693"><a href="#cb120-3693" aria-hidden="true" tabindex="-1"></a>    <span class="dt">gender</span><span class="op">:</span> {</span>
<span id="cb120-3694"><a href="#cb120-3694" aria-hidden="true" tabindex="-1"></a>      <span class="dt">values</span><span class="op">:</span> dimensions<span class="op">.</span><span class="fu">filter</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="fu">startsWith</span>(<span class="st">"gender"</span>))<span class="op">,</span></span>
<span id="cb120-3695"><a href="#cb120-3695" aria-hidden="true" tabindex="-1"></a>      <span class="dt">range</span><span class="op">:</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">1</span>]<span class="op">,</span></span>
<span id="cb120-3696"><a href="#cb120-3696" aria-hidden="true" tabindex="-1"></a>      <span class="dt">unit</span><span class="op">:</span> <span class="dv">100</span><span class="op">,</span></span>
<span id="cb120-3697"><a href="#cb120-3697" aria-hidden="true" tabindex="-1"></a>      <span class="dt">color</span><span class="op">:</span> <span class="st">"black"</span><span class="op">,</span></span>
<span id="cb120-3698"><a href="#cb120-3698" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb120-3699"><a href="#cb120-3699" aria-hidden="true" tabindex="-1"></a>    <span class="dt">poverty</span><span class="op">:</span> {</span>
<span id="cb120-3700"><a href="#cb120-3700" aria-hidden="true" tabindex="-1"></a>      <span class="dt">values</span><span class="op">:</span> dimensions<span class="op">.</span><span class="fu">filter</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="fu">startsWith</span>(<span class="st">"poverty"</span>))<span class="op">,</span></span>
<span id="cb120-3701"><a href="#cb120-3701" aria-hidden="true" tabindex="-1"></a>      <span class="dt">range</span><span class="op">:</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">1</span>]<span class="op">,</span></span>
<span id="cb120-3702"><a href="#cb120-3702" aria-hidden="true" tabindex="-1"></a>      <span class="dt">unit</span><span class="op">:</span> <span class="st">"percent_NoDecimal"</span><span class="op">,</span></span>
<span id="cb120-3703"><a href="#cb120-3703" aria-hidden="true" tabindex="-1"></a>      <span class="dt">color</span><span class="op">:</span> <span class="st">"black"</span><span class="op">,</span></span>
<span id="cb120-3704"><a href="#cb120-3704" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb120-3705"><a href="#cb120-3705" aria-hidden="true" tabindex="-1"></a>    <span class="dt">education</span><span class="op">:</span> {</span>
<span id="cb120-3706"><a href="#cb120-3706" aria-hidden="true" tabindex="-1"></a>      <span class="dt">values</span><span class="op">:</span> dimensions<span class="op">.</span><span class="fu">filter</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="fu">startsWith</span>(<span class="st">"education"</span>))<span class="op">,</span></span>
<span id="cb120-3707"><a href="#cb120-3707" aria-hidden="true" tabindex="-1"></a>      <span class="dt">range</span><span class="op">:</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">13</span>]<span class="op">,</span></span>
<span id="cb120-3708"><a href="#cb120-3708" aria-hidden="true" tabindex="-1"></a>      <span class="dt">unit</span><span class="op">:</span> <span class="st">"total"</span><span class="op">,</span></span>
<span id="cb120-3709"><a href="#cb120-3709" aria-hidden="true" tabindex="-1"></a>      <span class="dt">color</span><span class="op">:</span> <span class="st">"black"</span><span class="op">,</span></span>
<span id="cb120-3710"><a href="#cb120-3710" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb120-3711"><a href="#cb120-3711" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb120-3712"><a href="#cb120-3712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3713"><a href="#cb120-3713" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> color <span class="op">=</span> (group<span class="op">,</span> value) <span class="kw">=&gt;</span> {</span>
<span id="cb120-3714"><a href="#cb120-3714" aria-hidden="true" tabindex="-1"></a>    <span class="co">// let color_range = group === 'poverty' ? ['green', 'red'] : ['red', 'green']</span></span>
<span id="cb120-3715"><a href="#cb120-3715" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> color_range <span class="op">=</span> [<span class="st">"red"</span><span class="op">,</span> <span class="st">"green"</span>]<span class="op">;</span></span>
<span id="cb120-3716"><a href="#cb120-3716" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()<span class="op">.</span><span class="fu">domain</span>(categories[group]<span class="op">.</span><span class="at">range</span>)<span class="op">.</span><span class="fu">range</span>(color_range)(</span>
<span id="cb120-3717"><a href="#cb120-3717" aria-hidden="true" tabindex="-1"></a>      value<span class="op">,</span></span>
<span id="cb120-3718"><a href="#cb120-3718" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb120-3719"><a href="#cb120-3719" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb120-3720"><a href="#cb120-3720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3721"><a href="#cb120-3721" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Flatten the categories into a single array, adding gaps between groups</span></span>
<span id="cb120-3722"><a href="#cb120-3722" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> groupedDimensions <span class="op">=</span> [</span>
<span id="cb120-3723"><a href="#cb120-3723" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span>categories<span class="op">.</span><span class="at">gender</span><span class="op">.</span><span class="at">values</span><span class="op">.</span><span class="fu">sort</span>()<span class="op">,</span></span>
<span id="cb120-3724"><a href="#cb120-3724" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span>categories<span class="op">.</span><span class="at">poverty</span><span class="op">.</span><span class="at">values</span><span class="op">.</span><span class="fu">sort</span>()<span class="op">,</span></span>
<span id="cb120-3725"><a href="#cb120-3725" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span>categories<span class="op">.</span><span class="at">education</span><span class="op">.</span><span class="at">values</span><span class="op">.</span><span class="fu">sort</span>()<span class="op">,</span></span>
<span id="cb120-3726"><a href="#cb120-3726" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">;</span></span>
<span id="cb120-3727"><a href="#cb120-3727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3728"><a href="#cb120-3728" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> x <span class="op">=</span> d3</span>
<span id="cb120-3729"><a href="#cb120-3729" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">scalePoint</span>()</span>
<span id="cb120-3730"><a href="#cb120-3730" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">domain</span>(groupedDimensions)</span>
<span id="cb120-3731"><a href="#cb120-3731" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">range</span>([margin<span class="op">.</span><span class="at">left</span><span class="op">,</span> width <span class="op">-</span> margin<span class="op">.</span><span class="at">right</span>])<span class="op">;</span></span>
<span id="cb120-3732"><a href="#cb120-3732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3733"><a href="#cb120-3733" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> y_group <span class="op">=</span> {</span>
<span id="cb120-3734"><a href="#cb120-3734" aria-hidden="true" tabindex="-1"></a>    <span class="dt">gender</span><span class="op">:</span> d3</span>
<span id="cb120-3735"><a href="#cb120-3735" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb120-3736"><a href="#cb120-3736" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">domain</span>(categories<span class="op">.</span><span class="at">gender</span><span class="op">.</span><span class="at">range</span>)</span>
<span id="cb120-3737"><a href="#cb120-3737" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">range</span>([height <span class="op">-</span> margin<span class="op">.</span><span class="at">bottom</span><span class="op">,</span> margin<span class="op">.</span><span class="at">top</span>])<span class="op">,</span></span>
<span id="cb120-3738"><a href="#cb120-3738" aria-hidden="true" tabindex="-1"></a>    <span class="dt">poverty</span><span class="op">:</span> d3</span>
<span id="cb120-3739"><a href="#cb120-3739" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb120-3740"><a href="#cb120-3740" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">domain</span>(categories<span class="op">.</span><span class="at">poverty</span><span class="op">.</span><span class="at">range</span>)</span>
<span id="cb120-3741"><a href="#cb120-3741" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">range</span>([height <span class="op">-</span> margin<span class="op">.</span><span class="at">bottom</span><span class="op">,</span> margin<span class="op">.</span><span class="at">top</span>])<span class="op">,</span></span>
<span id="cb120-3742"><a href="#cb120-3742" aria-hidden="true" tabindex="-1"></a>    <span class="dt">education</span><span class="op">:</span> d3</span>
<span id="cb120-3743"><a href="#cb120-3743" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb120-3744"><a href="#cb120-3744" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">domain</span>(categories<span class="op">.</span><span class="at">education</span><span class="op">.</span><span class="at">range</span>)</span>
<span id="cb120-3745"><a href="#cb120-3745" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">range</span>([height <span class="op">-</span> margin<span class="op">.</span><span class="at">bottom</span><span class="op">,</span> margin<span class="op">.</span><span class="at">top</span>])<span class="op">,</span></span>
<span id="cb120-3746"><a href="#cb120-3746" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb120-3747"><a href="#cb120-3747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3748"><a href="#cb120-3748" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> y <span class="op">=</span> {}<span class="op">;</span></span>
<span id="cb120-3749"><a href="#cb120-3749" aria-hidden="true" tabindex="-1"></a>  groupedDimensions</span>
<span id="cb120-3750"><a href="#cb120-3750" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">filter</span>((d) <span class="kw">=&gt;</span> d <span class="op">!==</span> <span class="st">""</span>)</span>
<span id="cb120-3751"><a href="#cb120-3751" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">forEach</span>((dim) <span class="kw">=&gt;</span> {</span>
<span id="cb120-3752"><a href="#cb120-3752" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> group <span class="op">=</span> dim<span class="op">.</span><span class="fu">split</span>(<span class="st">"-"</span>)[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb120-3753"><a href="#cb120-3753" aria-hidden="true" tabindex="-1"></a>      <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(group)<span class="op">;</span></span>
<span id="cb120-3754"><a href="#cb120-3754" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> y_extent <span class="op">=</span> categories[group]<span class="op">.</span><span class="at">range</span><span class="op">;</span></span>
<span id="cb120-3755"><a href="#cb120-3755" aria-hidden="true" tabindex="-1"></a>      y[dim] <span class="op">=</span> d3</span>
<span id="cb120-3756"><a href="#cb120-3756" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb120-3757"><a href="#cb120-3757" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">domain</span>(y_extent)</span>
<span id="cb120-3758"><a href="#cb120-3758" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">range</span>([height <span class="op">-</span> margin<span class="op">.</span><span class="at">bottom</span><span class="op">,</span> margin<span class="op">.</span><span class="at">top</span>])<span class="op">;</span></span>
<span id="cb120-3759"><a href="#cb120-3759" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb120-3760"><a href="#cb120-3760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3761"><a href="#cb120-3761" aria-hidden="true" tabindex="-1"></a>  d3<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".ParallelCoordTip"</span>)<span class="op">.</span><span class="fu">remove</span>()<span class="op">;</span></span>
<span id="cb120-3762"><a href="#cb120-3762" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> tooltip <span class="op">=</span> d3</span>
<span id="cb120-3763"><a href="#cb120-3763" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">select</span>(<span class="st">"body"</span>)</span>
<span id="cb120-3764"><a href="#cb120-3764" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"div"</span>)</span>
<span id="cb120-3765"><a href="#cb120-3765" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"plotTooltip ParallelCoordTip"</span>)</span>
<span id="cb120-3766"><a href="#cb120-3766" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"position"</span><span class="op">,</span> <span class="st">"absolute"</span>)<span class="op">;</span></span>
<span id="cb120-3767"><a href="#cb120-3767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3768"><a href="#cb120-3768" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Create circles for each data point</span></span>
<span id="cb120-3769"><a href="#cb120-3769" aria-hidden="true" tabindex="-1"></a>  groupedDimensions</span>
<span id="cb120-3770"><a href="#cb120-3770" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">filter</span>((d) <span class="kw">=&gt;</span> d <span class="op">!==</span> <span class="st">""</span>)</span>
<span id="cb120-3771"><a href="#cb120-3771" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">forEach</span>((dim) <span class="kw">=&gt;</span> {</span>
<span id="cb120-3772"><a href="#cb120-3772" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> splitVar <span class="op">=</span> dim<span class="op">.</span><span class="fu">split</span>(<span class="st">"-"</span>)<span class="op">;</span></span>
<span id="cb120-3773"><a href="#cb120-3773" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> varname <span class="op">=</span> <span class="fu">_lang</span>(</span>
<span id="cb120-3774"><a href="#cb120-3774" aria-hidden="true" tabindex="-1"></a>        nbText<span class="op">.</span><span class="at">ViewExplore</span><span class="op">.</span><span class="at">parallelCoords</span><span class="op">.</span><span class="at">acVars</span>[splitVar[<span class="dv">1</span>]]<span class="op">,</span></span>
<span id="cb120-3775"><a href="#cb120-3775" aria-hidden="true" tabindex="-1"></a>      )<span class="op">;</span></span>
<span id="cb120-3776"><a href="#cb120-3776" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> group <span class="op">=</span> splitVar[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb120-3777"><a href="#cb120-3777" aria-hidden="true" tabindex="-1"></a>      svg</span>
<span id="cb120-3778"><a href="#cb120-3778" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">selectAll</span>(<span class="vs">`.dot-</span><span class="sc">${</span>dim<span class="sc">}</span><span class="vs">`</span>)</span>
<span id="cb120-3779"><a href="#cb120-3779" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">data</span>(data_vuln)</span>
<span id="cb120-3780"><a href="#cb120-3780" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">join</span>(<span class="st">"circle"</span>)</span>
<span id="cb120-3781"><a href="#cb120-3781" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(</span>
<span id="cb120-3782"><a href="#cb120-3782" aria-hidden="true" tabindex="-1"></a>          <span class="st">"class"</span><span class="op">,</span></span>
<span id="cb120-3783"><a href="#cb120-3783" aria-hidden="true" tabindex="-1"></a>          (d) <span class="kw">=&gt;</span> <span class="vs">`dot-</span><span class="sc">${</span>dim<span class="sc">}</span><span class="vs"> country-</span><span class="sc">${</span>d<span class="op">.</span><span class="at">country</span><span class="op">.</span><span class="fu">replace</span>(<span class="ss">/</span><span class="sc">\s+</span><span class="ss">/g</span><span class="op">,</span> <span class="st">"-"</span>)<span class="sc">}</span><span class="vs">`</span><span class="op">,</span></span>
<span id="cb120-3784"><a href="#cb120-3784" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb120-3785"><a href="#cb120-3785" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cx"</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="fu">x</span>(dim) <span class="op">+</span> <span class="fu">jitter</span>())</span>
<span id="cb120-3786"><a href="#cb120-3786" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cy"</span><span class="op">,</span> (d) <span class="kw">=&gt;</span> {</span>
<span id="cb120-3787"><a href="#cb120-3787" aria-hidden="true" tabindex="-1"></a>          <span class="cf">return</span> y[dim](d[dim])<span class="op">;</span></span>
<span id="cb120-3788"><a href="#cb120-3788" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb120-3789"><a href="#cb120-3789" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"r"</span><span class="op">,</span> <span class="dv">5</span>)</span>
<span id="cb120-3790"><a href="#cb120-3790" aria-hidden="true" tabindex="-1"></a>        <span class="co">// .style("fill", 'lightgrey')</span></span>
<span id="cb120-3791"><a href="#cb120-3791" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"fill"</span><span class="op">,</span> (d) <span class="kw">=&gt;</span> <span class="fu">color</span>(group<span class="op">,</span> d[dim]))</span>
<span id="cb120-3792"><a href="#cb120-3792" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"opacity"</span><span class="op">,</span> <span class="fl">0.1</span>)</span>
<span id="cb120-3793"><a href="#cb120-3793" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">on</span>(<span class="st">"mouseover"</span><span class="op">,</span> <span class="kw">function</span> (<span class="bu">event</span><span class="op">,</span> d) {</span>
<span id="cb120-3794"><a href="#cb120-3794" aria-hidden="true" tabindex="-1"></a>          svg</span>
<span id="cb120-3795"><a href="#cb120-3795" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">selectAll</span>(<span class="vs">`.country-</span><span class="sc">${</span>d<span class="op">.</span><span class="at">country</span><span class="op">.</span><span class="fu">replace</span>(<span class="ss">/</span><span class="sc">\s+</span><span class="ss">/g</span><span class="op">,</span> <span class="st">"-"</span>)<span class="sc">}</span><span class="vs">`</span>)</span>
<span id="cb120-3796"><a href="#cb120-3796" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"r"</span><span class="op">,</span> <span class="dv">8</span>)</span>
<span id="cb120-3797"><a href="#cb120-3797" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">style</span>(<span class="st">"opacity"</span><span class="op">,</span> <span class="dv">1</span>)</span>
<span id="cb120-3798"><a href="#cb120-3798" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">raise</span>()<span class="op">;</span></span>
<span id="cb120-3799"><a href="#cb120-3799" aria-hidden="true" tabindex="-1"></a>          <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="st">"ttip"</span><span class="op">,</span> <span class="vs">`.legend-</span><span class="sc">${</span>group<span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span></span>
<span id="cb120-3800"><a href="#cb120-3800" aria-hidden="true" tabindex="-1"></a>          svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="vs">`.legend-</span><span class="sc">${</span>group<span class="sc">}</span><span class="vs">`</span>)<span class="op">.</span><span class="fu">style</span>(<span class="st">"opacity"</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb120-3801"><a href="#cb120-3801" aria-hidden="true" tabindex="-1"></a>          tooltip</span>
<span id="cb120-3802"><a href="#cb120-3802" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">style</span>(<span class="st">"top"</span><span class="op">,</span> <span class="bu">event</span><span class="op">.</span><span class="at">pageY</span> <span class="op">-</span> <span class="dv">1</span> <span class="op">+</span> <span class="st">"px"</span>)</span>
<span id="cb120-3803"><a href="#cb120-3803" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">style</span>(<span class="st">"left"</span><span class="op">,</span> <span class="bu">event</span><span class="op">.</span><span class="at">pageX</span> <span class="op">+</span> <span class="dv">1</span> <span class="op">+</span> <span class="st">"px"</span>)</span>
<span id="cb120-3804"><a href="#cb120-3804" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">style</span>(<span class="st">"opacity"</span><span class="op">,</span> <span class="fl">0.8</span>)</span>
<span id="cb120-3805"><a href="#cb120-3805" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">style</span>(<span class="st">"display"</span><span class="op">,</span> <span class="st">"block"</span>)</span>
<span id="cb120-3806"><a href="#cb120-3806" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">html</span>(() <span class="kw">=&gt;</span> {</span>
<span id="cb120-3807"><a href="#cb120-3807" aria-hidden="true" tabindex="-1"></a>              <span class="kw">let</span> admin_string <span class="op">=</span> d<span class="op">.</span><span class="at">country</span><span class="op">;</span></span>
<span id="cb120-3808"><a href="#cb120-3808" aria-hidden="true" tabindex="-1"></a>              <span class="kw">let</span> admin_names <span class="op">=</span> admin_string<span class="op">.</span><span class="fu">split</span>(<span class="st">"_"</span>)<span class="op">;</span></span>
<span id="cb120-3809"><a href="#cb120-3809" aria-hidden="true" tabindex="-1"></a>              admin_names[<span class="dv">0</span>] <span class="op">=</span></span>
<span id="cb120-3810"><a href="#cb120-3810" aria-hidden="true" tabindex="-1"></a>                <span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">adminNames</span>[admin_names[<span class="dv">0</span>]]) <span class="op">||</span></span>
<span id="cb120-3811"><a href="#cb120-3811" aria-hidden="true" tabindex="-1"></a>                admin_names[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb120-3812"><a href="#cb120-3812" aria-hidden="true" tabindex="-1"></a>              <span class="co">// let admin0_name = _lang(nbText.general.adminNames[admin_names[0]])</span></span>
<span id="cb120-3813"><a href="#cb120-3813" aria-hidden="true" tabindex="-1"></a>              <span class="kw">let</span> admin_join <span class="op">=</span> admin_names</span>
<span id="cb120-3814"><a href="#cb120-3814" aria-hidden="true" tabindex="-1"></a>                <span class="op">.</span><span class="fu">filter</span>((name) <span class="kw">=&gt;</span> name <span class="op">!==</span> <span class="st">"null"</span>)</span>
<span id="cb120-3815"><a href="#cb120-3815" aria-hidden="true" tabindex="-1"></a>                <span class="op">.</span><span class="fu">join</span>(<span class="st">", "</span>)<span class="op">;</span></span>
<span id="cb120-3816"><a href="#cb120-3816" aria-hidden="true" tabindex="-1"></a>              <span class="kw">let</span> varValue <span class="op">=</span> <span class="fu">format_val</span>(d[dim]<span class="op">,</span> categories[group]<span class="op">.</span><span class="at">unit</span>)<span class="op">;</span></span>
<span id="cb120-3817"><a href="#cb120-3817" aria-hidden="true" tabindex="-1"></a>              <span class="cf">return</span> <span class="vs">`</span><span class="sc">${</span>admin_join<span class="sc">}</span><span class="vs">&lt;br/&gt;</span><span class="sc">${</span>varname<span class="sc">}</span><span class="vs">: </span><span class="sc">${</span>varValue<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span>
<span id="cb120-3818"><a href="#cb120-3818" aria-hidden="true" tabindex="-1"></a>            })<span class="op">;</span></span>
<span id="cb120-3819"><a href="#cb120-3819" aria-hidden="true" tabindex="-1"></a>          <span class="co">// .html(`${d.country}&lt;br/&gt;${dim}: ${d[dim].toFixed(2)}`);</span></span>
<span id="cb120-3820"><a href="#cb120-3820" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb120-3821"><a href="#cb120-3821" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">on</span>(<span class="st">"mouseout"</span><span class="op">,</span> <span class="kw">function</span> (<span class="bu">event</span><span class="op">,</span> d) {</span>
<span id="cb120-3822"><a href="#cb120-3822" aria-hidden="true" tabindex="-1"></a>          svg</span>
<span id="cb120-3823"><a href="#cb120-3823" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">selectAll</span>(<span class="vs">`.country-</span><span class="sc">${</span>d<span class="op">.</span><span class="at">country</span><span class="op">.</span><span class="fu">replace</span>(<span class="ss">/</span><span class="sc">\s+</span><span class="ss">/g</span><span class="op">,</span> <span class="st">"-"</span>)<span class="sc">}</span><span class="vs">`</span>)</span>
<span id="cb120-3824"><a href="#cb120-3824" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"r"</span><span class="op">,</span> <span class="dv">5</span>)</span>
<span id="cb120-3825"><a href="#cb120-3825" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">style</span>(<span class="st">"opacity"</span><span class="op">,</span> <span class="fl">0.1</span>)</span>
<span id="cb120-3826"><a href="#cb120-3826" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">lower</span>()<span class="op">;</span></span>
<span id="cb120-3827"><a href="#cb120-3827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3828"><a href="#cb120-3828" aria-hidden="true" tabindex="-1"></a>          svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="vs">`.legend-</span><span class="sc">${</span>group<span class="sc">}</span><span class="vs">`</span>)<span class="op">.</span><span class="fu">style</span>(<span class="st">"opacity"</span><span class="op">,</span> <span class="fl">0.5</span>)<span class="op">;</span></span>
<span id="cb120-3829"><a href="#cb120-3829" aria-hidden="true" tabindex="-1"></a>          tooltip<span class="op">.</span><span class="fu">style</span>(<span class="st">"display"</span><span class="op">,</span> <span class="st">"none"</span>)<span class="op">;</span></span>
<span id="cb120-3830"><a href="#cb120-3830" aria-hidden="true" tabindex="-1"></a>        })<span class="op">;</span></span>
<span id="cb120-3831"><a href="#cb120-3831" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb120-3832"><a href="#cb120-3832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3833"><a href="#cb120-3833" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Add average points</span></span>
<span id="cb120-3834"><a href="#cb120-3834" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> avg_points <span class="op">=</span> svg</span>
<span id="cb120-3835"><a href="#cb120-3835" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".avg-dot"</span>)</span>
<span id="cb120-3836"><a href="#cb120-3836" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(groupedDimensions<span class="op">.</span><span class="fu">filter</span>((d) <span class="kw">=&gt;</span> d <span class="op">!==</span> <span class="st">""</span>))</span>
<span id="cb120-3837"><a href="#cb120-3837" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb120-3838"><a href="#cb120-3838" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"circle"</span>)</span>
<span id="cb120-3839"><a href="#cb120-3839" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"avg-dot"</span>)</span>
<span id="cb120-3840"><a href="#cb120-3840" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cx"</span><span class="op">,</span> (d) <span class="kw">=&gt;</span> <span class="fu">x</span>(d))</span>
<span id="cb120-3841"><a href="#cb120-3841" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cy"</span><span class="op">,</span> (d) <span class="kw">=&gt;</span> y[d](means[<span class="dv">0</span>][d]))</span>
<span id="cb120-3842"><a href="#cb120-3842" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"r"</span><span class="op">,</span> <span class="dv">7</span>)</span>
<span id="cb120-3843"><a href="#cb120-3843" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"grey"</span>)</span>
<span id="cb120-3844"><a href="#cb120-3844" aria-hidden="true" tabindex="-1"></a>    <span class="co">// .style("fill", "#2E7636")</span></span>
<span id="cb120-3845"><a href="#cb120-3845" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"white"</span>)</span>
<span id="cb120-3846"><a href="#cb120-3846" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="dv">2</span>)<span class="op">;</span></span>
<span id="cb120-3847"><a href="#cb120-3847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3848"><a href="#cb120-3848" aria-hidden="true" tabindex="-1"></a>  avg_points</span>
<span id="cb120-3849"><a href="#cb120-3849" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"mouseover"</span><span class="op">,</span> <span class="kw">function</span> (<span class="bu">event</span><span class="op">,</span> d) {</span>
<span id="cb120-3850"><a href="#cb120-3850" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> splitVar <span class="op">=</span> d<span class="op">.</span><span class="fu">split</span>(<span class="st">"-"</span>)<span class="op">;</span></span>
<span id="cb120-3851"><a href="#cb120-3851" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> varname <span class="op">=</span> <span class="fu">_lang</span>(</span>
<span id="cb120-3852"><a href="#cb120-3852" aria-hidden="true" tabindex="-1"></a>        nbText<span class="op">.</span><span class="at">ViewExplore</span><span class="op">.</span><span class="at">parallelCoords</span><span class="op">.</span><span class="at">acVars</span>[splitVar[<span class="dv">1</span>]]<span class="op">,</span></span>
<span id="cb120-3853"><a href="#cb120-3853" aria-hidden="true" tabindex="-1"></a>      )<span class="op">;</span></span>
<span id="cb120-3854"><a href="#cb120-3854" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> group <span class="op">=</span> splitVar[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb120-3855"><a href="#cb120-3855" aria-hidden="true" tabindex="-1"></a>      svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="vs">`.avg-dot`</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"r"</span><span class="op">,</span> <span class="dv">8</span>)<span class="op">.</span><span class="fu">raise</span>()<span class="op">;</span></span>
<span id="cb120-3856"><a href="#cb120-3856" aria-hidden="true" tabindex="-1"></a>      svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="vs">`.legend-</span><span class="sc">${</span>group<span class="sc">}</span><span class="vs">`</span>)<span class="op">.</span><span class="fu">style</span>(<span class="st">"opacity"</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb120-3857"><a href="#cb120-3857" aria-hidden="true" tabindex="-1"></a>      tooltip</span>
<span id="cb120-3858"><a href="#cb120-3858" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"top"</span><span class="op">,</span> <span class="bu">event</span><span class="op">.</span><span class="at">pageY</span> <span class="op">-</span> <span class="dv">1</span> <span class="op">+</span> <span class="st">"px"</span>)</span>
<span id="cb120-3859"><a href="#cb120-3859" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"left"</span><span class="op">,</span> <span class="bu">event</span><span class="op">.</span><span class="at">pageX</span> <span class="op">+</span> <span class="dv">1</span> <span class="op">+</span> <span class="st">"px"</span>)</span>
<span id="cb120-3860"><a href="#cb120-3860" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"opacity"</span><span class="op">,</span> <span class="fl">0.8</span>)</span>
<span id="cb120-3861"><a href="#cb120-3861" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"display"</span><span class="op">,</span> <span class="st">"block"</span>)</span>
<span id="cb120-3862"><a href="#cb120-3862" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">html</span>(() <span class="kw">=&gt;</span> {</span>
<span id="cb120-3863"><a href="#cb120-3863" aria-hidden="true" tabindex="-1"></a>          <span class="kw">let</span> admin_name <span class="op">=</span> means<span class="op">.</span><span class="at">country</span><span class="op">;</span> <span class="co">// </span><span class="al">TODO</span><span class="co">: Lang add here</span></span>
<span id="cb120-3864"><a href="#cb120-3864" aria-hidden="true" tabindex="-1"></a>          <span class="kw">let</span> varValue <span class="op">=</span> <span class="fu">format_val</span>(means[<span class="dv">0</span>][d]<span class="op">,</span> categories[group]<span class="op">.</span><span class="at">unit</span>)<span class="op">;</span></span>
<span id="cb120-3865"><a href="#cb120-3865" aria-hidden="true" tabindex="-1"></a>          <span class="cf">return</span> <span class="vs">`</span><span class="sc">${</span>admin_name<span class="sc">}</span><span class="vs">&lt;br/&gt;</span><span class="sc">${</span>varname<span class="sc">}</span><span class="vs">: </span><span class="sc">${</span>varValue<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span>
<span id="cb120-3866"><a href="#cb120-3866" aria-hidden="true" tabindex="-1"></a>        })<span class="op">;</span></span>
<span id="cb120-3867"><a href="#cb120-3867" aria-hidden="true" tabindex="-1"></a>      <span class="co">// .html(`${d.country}&lt;br/&gt;${dim}: ${d[dim].toFixed(2)}`);</span></span>
<span id="cb120-3868"><a href="#cb120-3868" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb120-3869"><a href="#cb120-3869" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">on</span>(<span class="st">"mouseout"</span><span class="op">,</span> <span class="kw">function</span> (<span class="bu">event</span><span class="op">,</span> d) {</span>
<span id="cb120-3870"><a href="#cb120-3870" aria-hidden="true" tabindex="-1"></a>      svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="vs">`.legend-</span><span class="sc">${</span>d<span class="op">.</span><span class="fu">split</span>(<span class="st">"-"</span>)[<span class="dv">0</span>]<span class="sc">}</span><span class="vs">`</span>)<span class="op">.</span><span class="fu">style</span>(<span class="st">"opacity"</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb120-3871"><a href="#cb120-3871" aria-hidden="true" tabindex="-1"></a>      svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="vs">`.avg-dot`</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"r"</span><span class="op">,</span> <span class="dv">7</span>)<span class="op">;</span></span>
<span id="cb120-3872"><a href="#cb120-3872" aria-hidden="true" tabindex="-1"></a>      <span class="co">// .lower();</span></span>
<span id="cb120-3873"><a href="#cb120-3873" aria-hidden="true" tabindex="-1"></a>      tooltip<span class="op">.</span><span class="fu">style</span>(<span class="st">"display"</span><span class="op">,</span> <span class="st">"none"</span>)<span class="op">;</span></span>
<span id="cb120-3874"><a href="#cb120-3874" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb120-3875"><a href="#cb120-3875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3876"><a href="#cb120-3876" aria-hidden="true" tabindex="-1"></a>  <span class="bu">Object</span><span class="op">.</span><span class="fu">keys</span>(categories)<span class="op">.</span><span class="fu">forEach</span>((cat) <span class="kw">=&gt;</span> {</span>
<span id="cb120-3877"><a href="#cb120-3877" aria-hidden="true" tabindex="-1"></a>    svg</span>
<span id="cb120-3878"><a href="#cb120-3878" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb120-3879"><a href="#cb120-3879" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="vs">`legend-</span><span class="sc">${</span>cat<span class="sc">}</span><span class="vs">`</span>)</span>
<span id="cb120-3880"><a href="#cb120-3880" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span><span class="fu">x</span>(categories[cat]<span class="op">.</span><span class="at">values</span>[<span class="dv">0</span>]) <span class="op">-</span> <span class="dv">20</span><span class="sc">}</span><span class="vs">,0)`</span>)</span>
<span id="cb120-3881"><a href="#cb120-3881" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">style</span>(<span class="st">"opacity"</span><span class="op">,</span> <span class="fl">0.5</span>)</span>
<span id="cb120-3882"><a href="#cb120-3882" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">call</span>(</span>
<span id="cb120-3883"><a href="#cb120-3883" aria-hidden="true" tabindex="-1"></a>        d3</span>
<span id="cb120-3884"><a href="#cb120-3884" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">axisLeft</span>(y_group[cat])</span>
<span id="cb120-3885"><a href="#cb120-3885" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">tickFormat</span>((v) <span class="kw">=&gt;</span> <span class="fu">format_val</span>(v<span class="op">,</span> categories[cat]<span class="op">.</span><span class="at">unit</span>))<span class="op">,</span></span>
<span id="cb120-3886"><a href="#cb120-3886" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb120-3887"><a href="#cb120-3887" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">call</span>((g) <span class="kw">=&gt;</span> {</span>
<span id="cb120-3888"><a href="#cb120-3888" aria-hidden="true" tabindex="-1"></a>        g<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".tick text"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> categories[cat]<span class="op">.</span><span class="at">color</span>)<span class="op">;</span></span>
<span id="cb120-3889"><a href="#cb120-3889" aria-hidden="true" tabindex="-1"></a>        g<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".tick line"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> categories[cat]<span class="op">.</span><span class="at">color</span>)<span class="op">;</span></span>
<span id="cb120-3890"><a href="#cb120-3890" aria-hidden="true" tabindex="-1"></a>        g<span class="op">.</span><span class="fu">select</span>(<span class="st">".domain"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> categories[cat]<span class="op">.</span><span class="at">color</span>)<span class="op">;</span> <span class="co">// Axis line color</span></span>
<span id="cb120-3891"><a href="#cb120-3891" aria-hidden="true" tabindex="-1"></a>      })<span class="op">;</span></span>
<span id="cb120-3892"><a href="#cb120-3892" aria-hidden="true" tabindex="-1"></a>    <span class="co">// .append("text")  // Vertical title</span></span>
<span id="cb120-3893"><a href="#cb120-3893" aria-hidden="true" tabindex="-1"></a>    <span class="co">// .attr("x", -40)</span></span>
<span id="cb120-3894"><a href="#cb120-3894" aria-hidden="true" tabindex="-1"></a>    <span class="co">// .attr("y", (height / 2))</span></span>
<span id="cb120-3895"><a href="#cb120-3895" aria-hidden="true" tabindex="-1"></a>    <span class="co">// .attr("text-anchor", "middle")</span></span>
<span id="cb120-3896"><a href="#cb120-3896" aria-hidden="true" tabindex="-1"></a>    <span class="co">// .attr("transform", `rotate(-90, -40, ${height / 2})`)</span></span>
<span id="cb120-3897"><a href="#cb120-3897" aria-hidden="true" tabindex="-1"></a>    <span class="co">// .style("font-size", "14px")</span></span>
<span id="cb120-3898"><a href="#cb120-3898" aria-hidden="true" tabindex="-1"></a>    <span class="co">// .style("fill", categories[cat].color)</span></span>
<span id="cb120-3899"><a href="#cb120-3899" aria-hidden="true" tabindex="-1"></a>    <span class="co">// .text(`${Lang.toSentenceCase(cat)} Variables`)</span></span>
<span id="cb120-3900"><a href="#cb120-3900" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb120-3901"><a href="#cb120-3901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3902"><a href="#cb120-3902" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb120-3903"><a href="#cb120-3903" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"myAxis"</span>)</span>
<span id="cb120-3904"><a href="#cb120-3904" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(groupedDimensions)</span>
<span id="cb120-3905"><a href="#cb120-3905" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb120-3906"><a href="#cb120-3906" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb120-3907"><a href="#cb120-3907" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> (d) <span class="kw">=&gt;</span> <span class="st">"translate("</span> <span class="op">+</span> <span class="fu">x</span>(d) <span class="op">+</span> <span class="st">")"</span>)</span>
<span id="cb120-3908"><a href="#cb120-3908" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"pointer-events"</span><span class="op">,</span> <span class="st">"none"</span>)</span>
<span id="cb120-3909"><a href="#cb120-3909" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb120-3910"><a href="#cb120-3910" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb120-3911"><a href="#cb120-3911" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> (d<span class="op">,</span> i) <span class="kw">=&gt;</span> {</span>
<span id="cb120-3912"><a href="#cb120-3912" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> i <span class="op">%</span> <span class="dv">2</span> <span class="op">===</span> <span class="dv">0</span> <span class="op">?</span> margin<span class="op">.</span><span class="at">top</span> <span class="op">-</span> <span class="dv">10</span> <span class="op">:</span> height <span class="op">-</span> margin<span class="op">.</span><span class="at">bottom</span> <span class="op">+</span> <span class="dv">20</span><span class="op">;</span></span>
<span id="cb120-3913"><a href="#cb120-3913" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb120-3914"><a href="#cb120-3914" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>((d) <span class="kw">=&gt;</span> {</span>
<span id="cb120-3915"><a href="#cb120-3915" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> split <span class="op">=</span> d<span class="op">.</span><span class="fu">split</span>(<span class="st">"-"</span>)<span class="op">;</span></span>
<span id="cb120-3916"><a href="#cb120-3916" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> clean_text <span class="op">=</span> <span class="fu">_lang</span>(</span>
<span id="cb120-3917"><a href="#cb120-3917" aria-hidden="true" tabindex="-1"></a>        nbText<span class="op">.</span><span class="at">ViewExplore</span><span class="op">.</span><span class="at">parallelCoords</span><span class="op">.</span><span class="at">acVars</span>[split[<span class="dv">1</span>]]<span class="op">,</span></span>
<span id="cb120-3918"><a href="#cb120-3918" aria-hidden="true" tabindex="-1"></a>      )<span class="op">;</span></span>
<span id="cb120-3919"><a href="#cb120-3919" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> clean_text<span class="op">;</span></span>
<span id="cb120-3920"><a href="#cb120-3920" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb120-3921"><a href="#cb120-3921" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"fill"</span><span class="op">,</span> (d) <span class="kw">=&gt;</span> {</span>
<span id="cb120-3922"><a href="#cb120-3922" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> categories[d<span class="op">.</span><span class="fu">split</span>(<span class="st">"-"</span>)[<span class="dv">0</span>]]<span class="op">.</span><span class="at">color</span><span class="op">;</span></span>
<span id="cb120-3923"><a href="#cb120-3923" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb120-3924"><a href="#cb120-3924" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="st">"10px"</span>)<span class="op">;</span></span>
<span id="cb120-3925"><a href="#cb120-3925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3926"><a href="#cb120-3926" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dotLegendX <span class="op">=</span> <span class="dv">10</span><span class="op">;</span></span>
<span id="cb120-3927"><a href="#cb120-3927" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> dotLegendY <span class="op">=</span> <span class="dv">5</span><span class="op">;</span></span>
<span id="cb120-3928"><a href="#cb120-3928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3929"><a href="#cb120-3929" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> legend <span class="op">=</span> svg</span>
<span id="cb120-3930"><a href="#cb120-3930" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb120-3931"><a href="#cb120-3931" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>dotLegendX<span class="sc">}</span><span class="vs">, </span><span class="sc">${</span>dotLegendY<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb120-3932"><a href="#cb120-3932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3933"><a href="#cb120-3933" aria-hidden="true" tabindex="-1"></a>  legend</span>
<span id="cb120-3934"><a href="#cb120-3934" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"circle"</span>)</span>
<span id="cb120-3935"><a href="#cb120-3935" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cx"</span><span class="op">,</span> <span class="dv">10</span>)</span>
<span id="cb120-3936"><a href="#cb120-3936" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cy"</span><span class="op">,</span> <span class="dv">10</span>)</span>
<span id="cb120-3937"><a href="#cb120-3937" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"r"</span><span class="op">,</span> <span class="dv">8</span>)</span>
<span id="cb120-3938"><a href="#cb120-3938" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"grey"</span>)<span class="op">;</span></span>
<span id="cb120-3939"><a href="#cb120-3939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3940"><a href="#cb120-3940" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Append text next to the dot</span></span>
<span id="cb120-3941"><a href="#cb120-3941" aria-hidden="true" tabindex="-1"></a>  legend</span>
<span id="cb120-3942"><a href="#cb120-3942" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb120-3943"><a href="#cb120-3943" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> <span class="dv">23</span>)</span>
<span id="cb120-3944"><a href="#cb120-3944" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> <span class="dv">15</span>)</span>
<span id="cb120-3945"><a href="#cb120-3945" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="st">"13px"</span>)</span>
<span id="cb120-3946"><a href="#cb120-3946" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"#000"</span>)</span>
<span id="cb120-3947"><a href="#cb120-3947" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(<span class="fu">_lang</span>(nbText<span class="op">.</span><span class="at">general</span><span class="op">.</span><span class="at">regionalAvg</span>))<span class="op">;</span></span>
<span id="cb120-3948"><a href="#cb120-3948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3949"><a href="#cb120-3949" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Add lines and titles for each group</span></span>
<span id="cb120-3950"><a href="#cb120-3950" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addGroupTitleLine</span>(<span class="st">"gender"</span><span class="op">,</span> <span class="st">"Gender"</span><span class="op">,</span> categories<span class="op">.</span><span class="at">gender</span><span class="op">.</span><span class="at">color</span>)<span class="op">;</span></span>
<span id="cb120-3951"><a href="#cb120-3951" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addGroupTitleLine</span>(<span class="st">"poverty"</span><span class="op">,</span> <span class="st">"Poverty"</span><span class="op">,</span> categories<span class="op">.</span><span class="at">poverty</span><span class="op">.</span><span class="at">color</span>)<span class="op">;</span></span>
<span id="cb120-3952"><a href="#cb120-3952" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addGroupTitleLine</span>(<span class="st">"education"</span><span class="op">,</span> <span class="st">"Education"</span><span class="op">,</span> categories<span class="op">.</span><span class="at">education</span><span class="op">.</span><span class="at">color</span>)<span class="op">;</span></span>
<span id="cb120-3953"><a href="#cb120-3953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3954"><a href="#cb120-3954" aria-hidden="true" tabindex="-1"></a>  <span class="co">//// Add a legend from red to green</span></span>
<span id="cb120-3955"><a href="#cb120-3955" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> gradientWidth <span class="op">=</span> <span class="dv">250</span><span class="op">;</span></span>
<span id="cb120-3956"><a href="#cb120-3956" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> gradientHeight <span class="op">=</span> <span class="dv">15</span><span class="op">;</span></span>
<span id="cb120-3957"><a href="#cb120-3957" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> legendX <span class="op">=</span> width <span class="op">/</span> <span class="dv">2</span> <span class="op">-</span> <span class="dv">125</span><span class="op">;</span></span>
<span id="cb120-3958"><a href="#cb120-3958" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> legendY <span class="op">=</span> <span class="dv">5</span><span class="op">;</span></span>
<span id="cb120-3959"><a href="#cb120-3959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3960"><a href="#cb120-3960" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Append a defs element for the gradient</span></span>
<span id="cb120-3961"><a href="#cb120-3961" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> defs <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"defs"</span>)<span class="op">;</span></span>
<span id="cb120-3962"><a href="#cb120-3962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3963"><a href="#cb120-3963" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> linearGradient <span class="op">=</span> defs</span>
<span id="cb120-3964"><a href="#cb120-3964" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"linearGradient"</span>)</span>
<span id="cb120-3965"><a href="#cb120-3965" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="st">"AClinear-gradient"</span>)<span class="op">;</span></span>
<span id="cb120-3966"><a href="#cb120-3966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3967"><a href="#cb120-3967" aria-hidden="true" tabindex="-1"></a>  <span class="co">// linearGradient</span></span>
<span id="cb120-3968"><a href="#cb120-3968" aria-hidden="true" tabindex="-1"></a>  <span class="co">//   .append('stop')</span></span>
<span id="cb120-3969"><a href="#cb120-3969" aria-hidden="true" tabindex="-1"></a>  <span class="co">//     .selectAll("stop")</span></span>
<span id="cb120-3970"><a href="#cb120-3970" aria-hidden="true" tabindex="-1"></a>  <span class="co">//     .data([minValue, maxValue])</span></span>
<span id="cb120-3971"><a href="#cb120-3971" aria-hidden="true" tabindex="-1"></a>  <span class="co">//     .join("stop")</span></span>
<span id="cb120-3972"><a href="#cb120-3972" aria-hidden="true" tabindex="-1"></a>  <span class="co">//     .attr("offset", (d, i, n) =&gt; `${(100 * i) / (n.length - 1)}%`)</span></span>
<span id="cb120-3973"><a href="#cb120-3973" aria-hidden="true" tabindex="-1"></a>  <span class="co">//     .attr("stop-color", color);</span></span>
<span id="cb120-3974"><a href="#cb120-3974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3975"><a href="#cb120-3975" aria-hidden="true" tabindex="-1"></a>  linearGradient<span class="op">.</span><span class="fu">append</span>(<span class="st">"stop"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"offset"</span><span class="op">,</span> <span class="st">"0%"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stop-color"</span><span class="op">,</span> <span class="st">"red"</span>)<span class="op">;</span></span>
<span id="cb120-3976"><a href="#cb120-3976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3977"><a href="#cb120-3977" aria-hidden="true" tabindex="-1"></a>  linearGradient</span>
<span id="cb120-3978"><a href="#cb120-3978" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"stop"</span>)</span>
<span id="cb120-3979"><a href="#cb120-3979" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"offset"</span><span class="op">,</span> <span class="st">"100%"</span>)</span>
<span id="cb120-3980"><a href="#cb120-3980" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stop-color"</span><span class="op">,</span> <span class="st">"green"</span>)<span class="op">;</span></span>
<span id="cb120-3981"><a href="#cb120-3981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3982"><a href="#cb120-3982" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Draw the rectangle using the gradient</span></span>
<span id="cb120-3983"><a href="#cb120-3983" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb120-3984"><a href="#cb120-3984" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"rect"</span>)</span>
<span id="cb120-3985"><a href="#cb120-3985" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> legendX)</span>
<span id="cb120-3986"><a href="#cb120-3986" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> legendY)</span>
<span id="cb120-3987"><a href="#cb120-3987" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> gradientWidth)</span>
<span id="cb120-3988"><a href="#cb120-3988" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> gradientHeight)</span>
<span id="cb120-3989"><a href="#cb120-3989" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"url(#AClinear-gradient)"</span>)<span class="op">;</span></span>
<span id="cb120-3990"><a href="#cb120-3990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3991"><a href="#cb120-3991" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Add labels for the gradient</span></span>
<span id="cb120-3992"><a href="#cb120-3992" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb120-3993"><a href="#cb120-3993" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb120-3994"><a href="#cb120-3994" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> legendX <span class="op">-</span> <span class="dv">5</span>)</span>
<span id="cb120-3995"><a href="#cb120-3995" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> legendY <span class="op">+</span> gradientHeight <span class="op">/</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">5</span>)</span>
<span id="cb120-3996"><a href="#cb120-3996" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"end"</span>)</span>
<span id="cb120-3997"><a href="#cb120-3997" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="st">"12px"</span>)</span>
<span id="cb120-3998"><a href="#cb120-3998" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(<span class="st">"Low adaptive capacity"</span>)<span class="op">;</span></span>
<span id="cb120-3999"><a href="#cb120-3999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-4000"><a href="#cb120-4000" aria-hidden="true" tabindex="-1"></a>  svg</span>
<span id="cb120-4001"><a href="#cb120-4001" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb120-4002"><a href="#cb120-4002" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> legendX <span class="op">+</span> gradientWidth <span class="op">+</span> <span class="dv">5</span>)</span>
<span id="cb120-4003"><a href="#cb120-4003" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> legendY <span class="op">+</span> gradientHeight <span class="op">/</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">5</span>)</span>
<span id="cb120-4004"><a href="#cb120-4004" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"start"</span>)</span>
<span id="cb120-4005"><a href="#cb120-4005" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="st">"13px"</span>)</span>
<span id="cb120-4006"><a href="#cb120-4006" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(<span class="st">"High adaptive capacity"</span>)<span class="op">;</span></span>
<span id="cb120-4007"><a href="#cb120-4007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-4008"><a href="#cb120-4008" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> svg<span class="op">.</span><span class="fu">node</span>()<span class="op">;</span></span>
<span id="cb120-4009"><a href="#cb120-4009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-4010"><a href="#cb120-4010" aria-hidden="true" tabindex="-1"></a>  <span class="co">///// Helper Functions //////</span></span>
<span id="cb120-4011"><a href="#cb120-4011" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-4012"><a href="#cb120-4012" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">pivotData</span>(data) {</span>
<span id="cb120-4013"><a href="#cb120-4013" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> pivotedData <span class="op">=</span> {}<span class="op">;</span></span>
<span id="cb120-4014"><a href="#cb120-4014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-4015"><a href="#cb120-4015" aria-hidden="true" tabindex="-1"></a>    data<span class="op">.</span><span class="fu">forEach</span>((row) <span class="kw">=&gt;</span> {</span>
<span id="cb120-4016"><a href="#cb120-4016" aria-hidden="true" tabindex="-1"></a>      <span class="co">// Use a default value for any missing (NULL) admin field</span></span>
<span id="cb120-4017"><a href="#cb120-4017" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> admin0 <span class="op">=</span> row<span class="op">.</span><span class="at">admin0_name</span><span class="op">;</span></span>
<span id="cb120-4018"><a href="#cb120-4018" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> admin1 <span class="op">=</span> row<span class="op">.</span><span class="at">admin1_name</span><span class="op">;</span> <span class="co">//|| "";</span></span>
<span id="cb120-4019"><a href="#cb120-4019" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> admin2 <span class="op">=</span> row<span class="op">.</span><span class="at">admin2_name</span><span class="op">;</span> <span class="co">//|| ""</span></span>
<span id="cb120-4020"><a href="#cb120-4020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-4021"><a href="#cb120-4021" aria-hidden="true" tabindex="-1"></a>      <span class="co">// Create a unique key for each combination of admin0, admin1, admin2, admin3</span></span>
<span id="cb120-4022"><a href="#cb120-4022" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> country <span class="op">=</span> <span class="vs">`</span><span class="sc">${</span>admin0<span class="sc">}</span><span class="vs">_</span><span class="sc">${</span>admin1<span class="sc">}</span><span class="vs">_</span><span class="sc">${</span>admin2<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span>
<span id="cb120-4023"><a href="#cb120-4023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-4024"><a href="#cb120-4024" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="op">!</span>pivotedData[country]) {</span>
<span id="cb120-4025"><a href="#cb120-4025" aria-hidden="true" tabindex="-1"></a>        pivotedData[country] <span class="op">=</span> { country }<span class="op">;</span></span>
<span id="cb120-4026"><a href="#cb120-4026" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb120-4027"><a href="#cb120-4027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-4028"><a href="#cb120-4028" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> combined_name <span class="op">=</span> row<span class="op">.</span><span class="at">group</span> <span class="op">+</span> <span class="st">"-"</span> <span class="op">+</span> row<span class="op">.</span><span class="at">variable</span><span class="op">;</span></span>
<span id="cb120-4029"><a href="#cb120-4029" aria-hidden="true" tabindex="-1"></a>      pivotedData[country][combined_name] <span class="op">=</span> row<span class="op">.</span><span class="at">value</span><span class="op">;</span></span>
<span id="cb120-4030"><a href="#cb120-4030" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb120-4031"><a href="#cb120-4031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-4032"><a href="#cb120-4032" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Return the pivoted data as an array of objects</span></span>
<span id="cb120-4033"><a href="#cb120-4033" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">values</span>(pivotedData)<span class="op">;</span></span>
<span id="cb120-4034"><a href="#cb120-4034" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb120-4035"><a href="#cb120-4035" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-4036"><a href="#cb120-4036" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">calculateMeans</span>(data) {</span>
<span id="cb120-4037"><a href="#cb120-4037" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> groupedData <span class="op">=</span> {}<span class="op">;</span></span>
<span id="cb120-4038"><a href="#cb120-4038" aria-hidden="true" tabindex="-1"></a>    data<span class="op">.</span><span class="fu">forEach</span>((row) <span class="kw">=&gt;</span> {</span>
<span id="cb120-4039"><a href="#cb120-4039" aria-hidden="true" tabindex="-1"></a>      <span class="co">// Loop through each key in the object (ignoring the 'country' key)</span></span>
<span id="cb120-4040"><a href="#cb120-4040" aria-hidden="true" tabindex="-1"></a>      <span class="bu">Object</span><span class="op">.</span><span class="fu">keys</span>(row)<span class="op">.</span><span class="fu">forEach</span>((key) <span class="kw">=&gt;</span> {</span>
<span id="cb120-4041"><a href="#cb120-4041" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (key <span class="op">!==</span> <span class="st">"country"</span>) {</span>
<span id="cb120-4042"><a href="#cb120-4042" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span> (<span class="op">!</span>groupedData[key]) {</span>
<span id="cb120-4043"><a href="#cb120-4043" aria-hidden="true" tabindex="-1"></a>            groupedData[key] <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb120-4044"><a href="#cb120-4044" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb120-4045"><a href="#cb120-4045" aria-hidden="true" tabindex="-1"></a>          groupedData[key]<span class="op">.</span><span class="fu">push</span>(row[key])<span class="op">;</span></span>
<span id="cb120-4046"><a href="#cb120-4046" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb120-4047"><a href="#cb120-4047" aria-hidden="true" tabindex="-1"></a>      })<span class="op">;</span></span>
<span id="cb120-4048"><a href="#cb120-4048" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb120-4049"><a href="#cb120-4049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-4050"><a href="#cb120-4050" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> means <span class="op">=</span> {}<span class="op">;</span></span>
<span id="cb120-4051"><a href="#cb120-4051" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (<span class="kw">const</span> [variable<span class="op">,</span> values] <span class="kw">of</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">entries</span>(groupedData)) {</span>
<span id="cb120-4052"><a href="#cb120-4052" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> sum <span class="op">=</span> values<span class="op">.</span><span class="fu">reduce</span>((acc<span class="op">,</span> val) <span class="kw">=&gt;</span> acc <span class="op">+</span> val<span class="op">,</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb120-4053"><a href="#cb120-4053" aria-hidden="true" tabindex="-1"></a>      means[variable] <span class="op">=</span> sum <span class="op">/</span> values<span class="op">.</span><span class="at">length</span><span class="op">;</span></span>
<span id="cb120-4054"><a href="#cb120-4054" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb120-4055"><a href="#cb120-4055" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-4056"><a href="#cb120-4056" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [means]<span class="op">;</span></span>
<span id="cb120-4057"><a href="#cb120-4057" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb120-4058"><a href="#cb120-4058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-4059"><a href="#cb120-4059" aria-hidden="true" tabindex="-1"></a>  <span class="kw">function</span> <span class="fu">addGroupTitleLine</span>(group<span class="op">,</span> groupLabel<span class="op">,</span> color) {</span>
<span id="cb120-4060"><a href="#cb120-4060" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> groupValues <span class="op">=</span> categories[group]<span class="op">.</span><span class="at">values</span><span class="op">;</span></span>
<span id="cb120-4061"><a href="#cb120-4061" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> groupStart <span class="op">=</span> <span class="fu">x</span>(groupValues[<span class="dv">0</span>]) <span class="op">-</span> <span class="dv">15</span><span class="op">;</span></span>
<span id="cb120-4062"><a href="#cb120-4062" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> groupEnd <span class="op">=</span> <span class="fu">x</span>(groupValues[groupValues<span class="op">.</span><span class="at">length</span> <span class="op">-</span> <span class="dv">1</span>]) <span class="op">+</span> <span class="dv">15</span><span class="op">;</span></span>
<span id="cb120-4063"><a href="#cb120-4063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-4064"><a href="#cb120-4064" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (groupStart <span class="op">===</span> groupEnd) {</span>
<span id="cb120-4065"><a href="#cb120-4065" aria-hidden="true" tabindex="-1"></a>      groupStart <span class="op">=</span> groupStart <span class="op">-</span> <span class="dv">25</span><span class="op">;</span></span>
<span id="cb120-4066"><a href="#cb120-4066" aria-hidden="true" tabindex="-1"></a>      groupEnd <span class="op">=</span> groupStart <span class="op">+</span> <span class="dv">25</span><span class="op">;</span></span>
<span id="cb120-4067"><a href="#cb120-4067" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb120-4068"><a href="#cb120-4068" aria-hidden="true" tabindex="-1"></a>    svg</span>
<span id="cb120-4069"><a href="#cb120-4069" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"line"</span>)</span>
<span id="cb120-4070"><a href="#cb120-4070" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> groupStart)</span>
<span id="cb120-4071"><a href="#cb120-4071" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> groupEnd)</span>
<span id="cb120-4072"><a href="#cb120-4072" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> height <span class="op">-</span> <span class="dv">20</span>)</span>
<span id="cb120-4073"><a href="#cb120-4073" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> height <span class="op">-</span> <span class="dv">20</span>)</span>
<span id="cb120-4074"><a href="#cb120-4074" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> color)</span>
<span id="cb120-4075"><a href="#cb120-4075" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="dv">2</span>)<span class="op">;</span></span>
<span id="cb120-4076"><a href="#cb120-4076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-4077"><a href="#cb120-4077" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Append the group label centered on the line</span></span>
<span id="cb120-4078"><a href="#cb120-4078" aria-hidden="true" tabindex="-1"></a>    svg</span>
<span id="cb120-4079"><a href="#cb120-4079" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb120-4080"><a href="#cb120-4080" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> (groupStart <span class="op">+</span> groupEnd) <span class="op">/</span> <span class="dv">2</span>) <span class="co">// Center the title between start and end</span></span>
<span id="cb120-4081"><a href="#cb120-4081" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> height <span class="op">-</span> <span class="dv">5</span>) <span class="co">// Position the title above the line</span></span>
<span id="cb120-4082"><a href="#cb120-4082" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb120-4083"><a href="#cb120-4083" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">style</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="st">"14px"</span>)</span>
<span id="cb120-4084"><a href="#cb120-4084" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">style</span>(<span class="st">"font-weight"</span><span class="op">,</span> <span class="st">"bold"</span>)</span>
<span id="cb120-4085"><a href="#cb120-4085" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">style</span>(<span class="st">"fill"</span><span class="op">,</span> color)</span>
<span id="cb120-4086"><a href="#cb120-4086" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">text</span>(groupLabel)<span class="op">;</span></span>
<span id="cb120-4087"><a href="#cb120-4087" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb120-4088"><a href="#cb120-4088" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-120" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb121" data-startfrom="4092" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 4091"><span id="cb121-4092"><a href="#cb121-4092" aria-hidden="true" tabindex="-1"></a>TooltipCSS <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;style&gt;</span></span>
<span id="cb121-4093"><a href="#cb121-4093" aria-hidden="true" tabindex="-1"></a><span class="vs">.plotTooltip {</span></span>
<span id="cb121-4094"><a href="#cb121-4094" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 10px 10px;</span></span>
<span id="cb121-4095"><a href="#cb121-4095" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: black;</span></span>
<span id="cb121-4096"><a href="#cb121-4096" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-radius: 4px;</span></span>
<span id="cb121-4097"><a href="#cb121-4097" aria-hidden="true" tabindex="-1"></a><span class="vs">  border: 1px solid rgba(0,0,0,1);</span></span>
<span id="cb121-4098"><a href="#cb121-4098" aria-hidden="true" tabindex="-1"></a><span class="vs">  pointer-events: none;</span></span>
<span id="cb121-4099"><a href="#cb121-4099" aria-hidden="true" tabindex="-1"></a><span class="vs">  transform: translate(-50%, -100%);</span></span>
<span id="cb121-4100"><a href="#cb121-4100" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: "IBM Plex Sans", "Source Serif Pro";</span></span>
<span id="cb121-4101"><a href="#cb121-4101" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-size: 14px;</span></span>
<span id="cb121-4102"><a href="#cb121-4102" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: rgba(255,255,255, 1);</span></span>
<span id="cb121-4103"><a href="#cb121-4103" aria-hidden="true" tabindex="-1"></a><span class="vs">  transition: 0.3s opacity ease-out, 0.1s border-color ease-out;</span></span>
<span id="cb121-4104"><a href="#cb121-4104" aria-hidden="true" tabindex="-1"></a><span class="vs">  position: relative;</span></span>
<span id="cb121-4105"><a href="#cb121-4105" aria-hidden="true" tabindex="-1"></a><span class="vs">  display: none;</span></span>
<span id="cb121-4106"><a href="#cb121-4106" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb121-4107"><a href="#cb121-4107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-4108"><a href="#cb121-4108" aria-hidden="true" tabindex="-1"></a><span class="vs">.plotTooltip::before {</span></span>
<span id="cb121-4109"><a href="#cb121-4109" aria-hidden="true" tabindex="-1"></a><span class="vs">  content: "";</span></span>
<span id="cb121-4110"><a href="#cb121-4110" aria-hidden="true" tabindex="-1"></a><span class="vs">  position: absolute;</span></span>
<span id="cb121-4111"><a href="#cb121-4111" aria-hidden="true" tabindex="-1"></a><span class="vs">  top: 100%;</span></span>
<span id="cb121-4112"><a href="#cb121-4112" aria-hidden="true" tabindex="-1"></a><span class="vs">  left: 50%;</span></span>
<span id="cb121-4113"><a href="#cb121-4113" aria-hidden="true" tabindex="-1"></a><span class="vs">  margin-left: -5px;</span></span>
<span id="cb121-4114"><a href="#cb121-4114" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-width: 5px;</span></span>
<span id="cb121-4115"><a href="#cb121-4115" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-style: solid;</span></span>
<span id="cb121-4116"><a href="#cb121-4116" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-color: black transparent transparent transparent;</span></span>
<span id="cb121-4117"><a href="#cb121-4117" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb121-4118"><a href="#cb121-4118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-4119"><a href="#cb121-4119" aria-hidden="true" tabindex="-1"></a><span class="vs">.plotTooltip::after {</span></span>
<span id="cb121-4120"><a href="#cb121-4120" aria-hidden="true" tabindex="-1"></a><span class="vs">  content: "";</span></span>
<span id="cb121-4121"><a href="#cb121-4121" aria-hidden="true" tabindex="-1"></a><span class="vs">  position: absolute;</span></span>
<span id="cb121-4122"><a href="#cb121-4122" aria-hidden="true" tabindex="-1"></a><span class="vs">  top: calc(100% - 1px);</span></span>
<span id="cb121-4123"><a href="#cb121-4123" aria-hidden="true" tabindex="-1"></a><span class="vs">  left: 50%;</span></span>
<span id="cb121-4124"><a href="#cb121-4124" aria-hidden="true" tabindex="-1"></a><span class="vs">  margin-left: -4.9px;</span></span>
<span id="cb121-4125"><a href="#cb121-4125" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-width: 4.9px;</span></span>
<span id="cb121-4126"><a href="#cb121-4126" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-style: solid;</span></span>
<span id="cb121-4127"><a href="#cb121-4127" aria-hidden="true" tabindex="-1"></a><span class="vs">  border-color: white transparent transparent transparent;</span></span>
<span id="cb121-4128"><a href="#cb121-4128" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb121-4129"><a href="#cb121-4129" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/style&gt;`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-121" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb122" data-startfrom="4133" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 4132"><span id="cb122-4133"><a href="#cb122-4133" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">tocOneliner</span>({</span>
<span id="cb122-4134"><a href="#cb122-4134" aria-hidden="true" tabindex="-1"></a>  selector <span class="op">=</span> <span class="st">"h1"</span><span class="op">,</span> <span class="co">// selectors to include (can comma-separate, like "h1,h2,h3")</span></span>
<span id="cb122-4135"><a href="#cb122-4135" aria-hidden="true" tabindex="-1"></a>  heading <span class="op">=</span> <span class="st">"&lt;b&gt;In this notebook&lt;/b&gt;"</span><span class="op">,</span> <span class="co">// heading for ToC</span></span>
<span id="cb122-4136"><a href="#cb122-4136" aria-hidden="true" tabindex="-1"></a>  delim <span class="op">=</span> <span class="st">"&amp;nbsp;|&amp;nbsp;"</span><span class="op">,</span> <span class="co">// delimiter between links</span></span>
<span id="cb122-4137"><a href="#cb122-4137" aria-hidden="true" tabindex="-1"></a>  skip <span class="op">=</span> []<span class="op">,</span> <span class="co">// text content for headers to exclude</span></span>
<span id="cb122-4138"><a href="#cb122-4138" aria-hidden="true" tabindex="-1"></a>} <span class="op">=</span> {}) {</span>
<span id="cb122-4139"><a href="#cb122-4139" aria-hidden="true" tabindex="-1"></a>  <span class="co">// return a one-liner table of contents</span></span>
<span id="cb122-4140"><a href="#cb122-4140" aria-hidden="true" tabindex="-1"></a>  <span class="co">// allow for skips</span></span>
<span id="cb122-4141"><a href="#cb122-4141" aria-hidden="true" tabindex="-1"></a>  <span class="co">// modified from https://observablehq.com/@mbostock/toc</span></span>
<span id="cb122-4142"><a href="#cb122-4142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-4143"><a href="#cb122-4143" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> Generators<span class="op">.</span><span class="fu">observe</span>((notify) <span class="kw">=&gt;</span> {</span>
<span id="cb122-4144"><a href="#cb122-4144" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> headings <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb122-4145"><a href="#cb122-4145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-4146"><a href="#cb122-4146" aria-hidden="true" tabindex="-1"></a>    <span class="kw">function</span> <span class="fu">observed</span>() {</span>
<span id="cb122-4147"><a href="#cb122-4147" aria-hidden="true" tabindex="-1"></a>      <span class="kw">let</span> h <span class="op">=</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">from</span>(<span class="bu">document</span><span class="op">.</span><span class="fu">querySelectorAll</span>(selector))<span class="op">;</span></span>
<span id="cb122-4148"><a href="#cb122-4148" aria-hidden="true" tabindex="-1"></a>      h <span class="op">=</span> h<span class="op">.</span><span class="fu">filter</span>((d) <span class="kw">=&gt;</span> <span class="op">!</span>skip<span class="op">.</span><span class="fu">includes</span>(d<span class="op">.</span><span class="at">textContent</span>))<span class="op">;</span></span>
<span id="cb122-4149"><a href="#cb122-4149" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (h<span class="op">.</span><span class="at">length</span> <span class="op">!==</span> headings<span class="op">.</span><span class="at">length</span> <span class="op">||</span> h<span class="op">.</span><span class="fu">some</span>((h<span class="op">,</span> i) <span class="kw">=&gt;</span> headings[i] <span class="op">!==</span> h)) {</span>
<span id="cb122-4150"><a href="#cb122-4150" aria-hidden="true" tabindex="-1"></a>        <span class="fu">notify</span>(</span>
<span id="cb122-4151"><a href="#cb122-4151" aria-hidden="true" tabindex="-1"></a>          <span class="fu">html</span><span class="vs">`</span><span class="sc">${</span>heading<span class="sc">}</span><span class="vs">&lt;br&gt;</span><span class="sc">${</span><span class="bu">Array</span><span class="op">.</span><span class="fu">from</span>((headings <span class="op">=</span> h)<span class="op">,</span> (h<span class="op">,</span> i) <span class="kw">=&gt;</span> {</span>
<span id="cb122-4152"><a href="#cb122-4152" aria-hidden="true" tabindex="-1"></a>            <span class="kw">const</span> end <span class="op">=</span> i <span class="op">===</span> headings<span class="op">.</span><span class="at">length</span> <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb122-4153"><a href="#cb122-4153" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">assign</span>(</span>
<span id="cb122-4154"><a href="#cb122-4154" aria-hidden="true" tabindex="-1"></a>              <span class="fu">html</span><span class="vs">`&lt;a href=#</span><span class="sc">${</span>h<span class="op">.</span><span class="at">id</span><span class="sc">}</span><span class="vs">&gt;</span><span class="sc">${</span>DOM<span class="op">.</span><span class="fu">text</span>(h<span class="op">.</span><span class="at">textContent</span>)<span class="sc">}</span><span class="vs">&lt;/a&gt;</span><span class="sc">${</span></span>
<span id="cb122-4155"><a href="#cb122-4155" aria-hidden="true" tabindex="-1"></a>                end <span class="op">?</span> <span class="st">""</span> <span class="op">:</span> delim</span>
<span id="cb122-4156"><a href="#cb122-4156" aria-hidden="true" tabindex="-1"></a>              <span class="sc">}</span><span class="vs">`</span><span class="op">,</span></span>
<span id="cb122-4157"><a href="#cb122-4157" aria-hidden="true" tabindex="-1"></a>              { <span class="dt">onclick</span><span class="op">:</span> (e) <span class="kw">=&gt;</span> (e<span class="op">.</span><span class="fu">preventDefault</span>()<span class="op">,</span> h<span class="op">.</span><span class="fu">scrollIntoView</span>()) }<span class="op">,</span></span>
<span id="cb122-4158"><a href="#cb122-4158" aria-hidden="true" tabindex="-1"></a>            )<span class="op">;</span></span>
<span id="cb122-4159"><a href="#cb122-4159" aria-hidden="true" tabindex="-1"></a>          })<span class="sc">}</span><span class="vs">`</span><span class="op">,</span></span>
<span id="cb122-4160"><a href="#cb122-4160" aria-hidden="true" tabindex="-1"></a>        )<span class="op">;</span></span>
<span id="cb122-4161"><a href="#cb122-4161" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb122-4162"><a href="#cb122-4162" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb122-4163"><a href="#cb122-4163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-4164"><a href="#cb122-4164" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> observer <span class="op">=</span> <span class="kw">new</span> <span class="bu">MutationObserver</span>(observed)<span class="op">;</span></span>
<span id="cb122-4165"><a href="#cb122-4165" aria-hidden="true" tabindex="-1"></a>    observer<span class="op">.</span><span class="fu">observe</span>(<span class="bu">document</span><span class="op">.</span><span class="at">body</span><span class="op">,</span> { <span class="dt">childList</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="dt">subtree</span><span class="op">:</span> <span class="kw">true</span> })<span class="op">;</span></span>
<span id="cb122-4166"><a href="#cb122-4166" aria-hidden="true" tabindex="-1"></a>    <span class="fu">observed</span>()<span class="op">;</span></span>
<span id="cb122-4167"><a href="#cb122-4167" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> () <span class="kw">=&gt;</span> observer<span class="op">.</span><span class="fu">disconnect</span>()<span class="op">;</span></span>
<span id="cb122-4168"><a href="#cb122-4168" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb122-4169"><a href="#cb122-4169" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-122" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb123" data-startfrom="4173" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 4172"><span id="cb123-4173"><a href="#cb123-4173" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`## Language and Translation tools`</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-123" data-nodetype="expression"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb124" data-startfrom="4177" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 4176"><span id="cb124-4177"><a href="#cb124-4177" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { Lang } <span class="im">from</span> <span class="st">"7d46679f7d0d917e"</span><span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-124" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb125" data-startfrom="4181" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 4180"><span id="cb125-4181"><a href="#cb125-4181" aria-hidden="true" tabindex="-1"></a>_lang <span class="op">=</span> Lang<span class="op">.</span><span class="fu">lg</span>(language<span class="op">.</span><span class="at">key</span>)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-125" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb126" data-startfrom="4185" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 4184"><span id="cb126-4185"><a href="#cb126-4185" aria-hidden="true" tabindex="-1"></a>languages <span class="op">=</span> [</span>
<span id="cb126-4186"><a href="#cb126-4186" aria-hidden="true" tabindex="-1"></a>  { <span class="dt">key</span><span class="op">:</span> <span class="st">"en"</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"English"</span><span class="op">,</span> <span class="dt">locale</span><span class="op">:</span> <span class="st">"en-US"</span> }<span class="op">,</span></span>
<span id="cb126-4187"><a href="#cb126-4187" aria-hidden="true" tabindex="-1"></a>  { <span class="dt">key</span><span class="op">:</span> <span class="st">"fr"</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"Français"</span><span class="op">,</span> <span class="dt">locale</span><span class="op">:</span> <span class="st">"fr-FR"</span> }<span class="op">,</span></span>
<span id="cb126-4188"><a href="#cb126-4188" aria-hidden="true" tabindex="-1"></a>]<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-126" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb127" data-startfrom="4192" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 4191"><span id="cb127-4192"><a href="#cb127-4192" aria-hidden="true" tabindex="-1"></a>defaultLangKey <span class="op">=</span> {</span>
<span id="cb127-4193"><a href="#cb127-4193" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> name <span class="op">=</span> <span class="st">"lang"</span><span class="op">;</span></span>
<span id="cb127-4194"><a href="#cb127-4194" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> list <span class="op">=</span> languages<span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">key</span>)<span class="op">;</span></span>
<span id="cb127-4195"><a href="#cb127-4195" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> defaultKey <span class="op">=</span> <span class="st">"en"</span><span class="op">;</span></span>
<span id="cb127-4196"><a href="#cb127-4196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-4197"><a href="#cb127-4197" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> queryParam <span class="op">=</span> <span class="cf">await</span> Lang<span class="op">.</span><span class="fu">getParamFromList</span>({ name<span class="op">,</span> list })<span class="op">;</span></span>
<span id="cb127-4198"><a href="#cb127-4198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-4199"><a href="#cb127-4199" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> queryParam <span class="op">??</span> defaultKey<span class="op">;</span></span>
<span id="cb127-4200"><a href="#cb127-4200" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-127" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb128" data-startfrom="4204" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 4203"><span id="cb128-4204"><a href="#cb128-4204" aria-hidden="true" tabindex="-1"></a>viewof language <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">radio</span>(languages<span class="op">,</span> {</span>
<span id="cb128-4205"><a href="#cb128-4205" aria-hidden="true" tabindex="-1"></a>  <span class="dt">label</span><span class="op">:</span> <span class="st">"Main language toggle"</span><span class="op">,</span></span>
<span id="cb128-4206"><a href="#cb128-4206" aria-hidden="true" tabindex="-1"></a>  <span class="dt">format</span><span class="op">:</span> (d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">key</span><span class="op">,</span></span>
<span id="cb128-4207"><a href="#cb128-4207" aria-hidden="true" tabindex="-1"></a>  <span class="dt">value</span><span class="op">:</span> languages<span class="op">.</span><span class="fu">find</span>((x) <span class="kw">=&gt;</span> x<span class="op">.</span><span class="at">key</span> <span class="op">===</span> defaultLangKey)<span class="op">,</span></span>
<span id="cb128-4208"><a href="#cb128-4208" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-128" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb129" data-startfrom="4212" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 4211"><span id="cb129-4212"><a href="#cb129-4212" aria-hidden="true" tabindex="-1"></a>nbText <span class="op">=</span> <span class="kw">new</span> <span class="bu">Object</span>({</span>
<span id="cb129-4213"><a href="#cb129-4213" aria-hidden="true" tabindex="-1"></a>  <span class="dt">nbTitle</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Explore The Datasets"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Explorez les données"</span> }<span class="op">,</span></span>
<span id="cb129-4214"><a href="#cb129-4214" aria-hidden="true" tabindex="-1"></a>  <span class="dt">toc</span><span class="op">:</span> {</span>
<span id="cb129-4215"><a href="#cb129-4215" aria-hidden="true" tabindex="-1"></a>    <span class="dt">title</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"In this notebook"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Dans ce notebook"</span> }<span class="op">,</span></span>
<span id="cb129-4216"><a href="#cb129-4216" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb129-4217"><a href="#cb129-4217" aria-hidden="true" tabindex="-1"></a>  <span class="dt">overview</span><span class="op">:</span> {</span>
<span id="cb129-4218"><a href="#cb129-4218" aria-hidden="true" tabindex="-1"></a>    <span class="dt">title</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Overview"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Vue d’Ensemble"</span> }<span class="op">,</span></span>
<span id="cb129-4219"><a href="#cb129-4219" aria-hidden="true" tabindex="-1"></a>    <span class="dt">subTitle</span><span class="op">:</span> {</span>
<span id="cb129-4220"><a href="#cb129-4220" aria-hidden="true" tabindex="-1"></a>      <span class="dt">en</span><span class="op">:</span> <span class="vs">`Explore and export the data in the [Adaptation Atlas](https://adaptationatlas.cgiar.org)`</span><span class="op">,</span></span>
<span id="cb129-4221"><a href="#cb129-4221" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fr</span><span class="op">:</span> <span class="vs">`Explorez et exportez les données de [L’Adaptation l'Atlas](https://adaptationatlas.cgiar.org)`</span><span class="op">,</span></span>
<span id="cb129-4222"><a href="#cb129-4222" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb129-4223"><a href="#cb129-4223" aria-hidden="true" tabindex="-1"></a>    <span class="dt">text</span><span class="op">:</span> {</span>
<span id="cb129-4224"><a href="#cb129-4224" aria-hidden="true" tabindex="-1"></a>      <span class="dt">en</span><span class="op">:</span> <span class="st">"This notebook enables you to explore and download the data that underpins much of the analysis within the African Agricultural Adaptation Atlas. Filter and export the data in multiple formats to perform external analysis or use the tables and plots in this notebook to gain insights into broad continental trends or region-specific statistics."</span><span class="op">,</span></span>
<span id="cb129-4225"><a href="#cb129-4225" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fr</span><span class="op">:</span> <span class="st">"Ce notebook vous permet d'explorer et de télécharger les données qui constituent la base d’une grande partie de l'analyse au sein de African Agricultural Adaptation Atlas. Filtrez et exportez les données dans plusieurs formats pour effectuer des analyses externes ou utilisez les tableaux et graphiques de ce notebook pour obtenir des aperçus sur les tendances continentales générales ou les statistiques spécifiques à une région."</span><span class="op">,</span></span>
<span id="cb129-4226"><a href="#cb129-4226" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb129-4227"><a href="#cb129-4227" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb129-4228"><a href="#cb129-4228" aria-hidden="true" tabindex="-1"></a>  <span class="dt">selectCategory</span><span class="op">:</span> {</span>
<span id="cb129-4229"><a href="#cb129-4229" aria-hidden="true" tabindex="-1"></a>    <span class="dt">title_main</span><span class="op">:</span> {</span>
<span id="cb129-4230"><a href="#cb129-4230" aria-hidden="true" tabindex="-1"></a>      <span class="dt">en</span><span class="op">:</span> <span class="st">"Define The Data Focus"</span><span class="op">,</span></span>
<span id="cb129-4231"><a href="#cb129-4231" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fr</span><span class="op">:</span> <span class="st">"Définir le focus des données"</span><span class="op">,</span></span>
<span id="cb129-4232"><a href="#cb129-4232" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb129-4233"><a href="#cb129-4233" aria-hidden="true" tabindex="-1"></a>    <span class="dt">title</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Select A Category"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Sélectionnez une catégorie"</span> }<span class="op">,</span></span>
<span id="cb129-4234"><a href="#cb129-4234" aria-hidden="true" tabindex="-1"></a>    <span class="dt">text</span><span class="op">:</span> {</span>
<span id="cb129-4235"><a href="#cb129-4235" aria-hidden="true" tabindex="-1"></a>      <span class="dt">en</span><span class="op">:</span> <span class="st">"Choose between these categories: Hazard, Adaptive Capacity, and Exposure. These three categories are essential for a comprehensive understanding of climate risk, enabling effective assessment and management strategies."</span><span class="op">,</span></span>
<span id="cb129-4236"><a href="#cb129-4236" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fr</span><span class="op">:</span> <span class="st">"Choisissez parmi ces catégories : Aléa, Capacité d'adaptation et Exposition. Ces trois catégories sont essentielles pour une compréhension globale du risque climatique, permettant des stratégies d'évaluation et de gestion efficaces."</span><span class="op">,</span></span>
<span id="cb129-4237"><a href="#cb129-4237" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb129-4238"><a href="#cb129-4238" aria-hidden="true" tabindex="-1"></a>    <span class="dt">selector</span><span class="op">:</span> {</span>
<span id="cb129-4239"><a href="#cb129-4239" aria-hidden="true" tabindex="-1"></a>      <span class="dt">title</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Category"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Catégorie "</span> }<span class="op">,</span></span>
<span id="cb129-4240"><a href="#cb129-4240" aria-hidden="true" tabindex="-1"></a>      <span class="dt">options</span><span class="op">:</span> {</span>
<span id="cb129-4241"><a href="#cb129-4241" aria-hidden="true" tabindex="-1"></a>        <span class="dt">Hazard</span><span class="op">:</span> {</span>
<span id="cb129-4242"><a href="#cb129-4242" aria-hidden="true" tabindex="-1"></a>          <span class="dt">title</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Hazard"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Aléa"</span> }<span class="op">,</span></span>
<span id="cb129-4243"><a href="#cb129-4243" aria-hidden="true" tabindex="-1"></a>          <span class="dt">description</span><span class="op">:</span> {</span>
<span id="cb129-4244"><a href="#cb129-4244" aria-hidden="true" tabindex="-1"></a>            <span class="dt">en</span><span class="op">:</span> <span class="st">"Climate Hazards include individual, extreme climate events as well as shifting trends over time. Both acute events and long term changes can pose a serious threat to crops, livestock, people, and other assets."</span><span class="op">,</span></span>
<span id="cb129-4245"><a href="#cb129-4245" aria-hidden="true" tabindex="-1"></a>            <span class="dt">fr</span><span class="op">:</span> <span class="st">"Les aléas climatiques incluent des événements climatiques extrêmes individuels ainsi que des tendances changeantes au fil du temps. Tant les événements aigus que les changements à long terme peuvent représenter une menace sérieuse pour les cultures, le bétail, les personnes et d'autres actifs."</span><span class="op">,</span></span>
<span id="cb129-4246"><a href="#cb129-4246" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb129-4247"><a href="#cb129-4247" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb129-4248"><a href="#cb129-4248" aria-hidden="true" tabindex="-1"></a>        <span class="dt">Vulnerability</span><span class="op">:</span> {</span>
<span id="cb129-4249"><a href="#cb129-4249" aria-hidden="true" tabindex="-1"></a>          <span class="dt">title</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Adaptive Capacity"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Capacité d'adaptation"</span> }<span class="op">,</span></span>
<span id="cb129-4250"><a href="#cb129-4250" aria-hidden="true" tabindex="-1"></a>          <span class="dt">description</span><span class="op">:</span> {</span>
<span id="cb129-4251"><a href="#cb129-4251" aria-hidden="true" tabindex="-1"></a>            <span class="dt">en</span><span class="op">:</span> <span class="st">"A population's ability to adapt to a changing climate is directly influenced by different socio-economic variables. Variables such as education, female empowerment, and poverty can promote or inhibit a person's ability to respond, recover, and adapt to climate related risks."</span><span class="op">,</span></span>
<span id="cb129-4252"><a href="#cb129-4252" aria-hidden="true" tabindex="-1"></a>            <span class="dt">fr</span><span class="op">:</span> <span class="st">"La capacité d'une population à s'adapter à un climat changeant est directement influencée par différentes variables socio-économiques. Des variables telles que l'éducation, l'autonomisation des femmes et la pauvreté peuvent favoriser ou entraver la capacité d'une personne à répondre, se rétablir et s'adapter aux risques liés au climat."</span><span class="op">,</span></span>
<span id="cb129-4253"><a href="#cb129-4253" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb129-4254"><a href="#cb129-4254" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb129-4255"><a href="#cb129-4255" aria-hidden="true" tabindex="-1"></a>        <span class="dt">Exposure</span><span class="op">:</span> {</span>
<span id="cb129-4256"><a href="#cb129-4256" aria-hidden="true" tabindex="-1"></a>          <span class="dt">title</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Exposure"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Exposition"</span> }<span class="op">,</span></span>
<span id="cb129-4257"><a href="#cb129-4257" aria-hidden="true" tabindex="-1"></a>          <span class="dt">description</span><span class="op">:</span> {</span>
<span id="cb129-4258"><a href="#cb129-4258" aria-hidden="true" tabindex="-1"></a>            <span class="dt">en</span><span class="op">:</span> <span class="st">"Crop and livestock production systems are vulnerable to climate hazards such as heat stress, temperature fluctuations, and changes in precipitation patterns. Agriculture in Sub-Saharan Africa is primarily driven by small-holder farmers and plays an important role in both global and local food security. Exposure happens when these livelihoods and commodities are exposed to hazardous climate conditions. To fully understand climate risk, the level and scale of exposure must be understood."</span><span class="op">,</span></span>
<span id="cb129-4259"><a href="#cb129-4259" aria-hidden="true" tabindex="-1"></a>            <span class="dt">fr</span><span class="op">:</span> <span class="st">"Les systèmes de production des cultures et du bétail sont vulnérables aux aléas climatiques tels que le stress thermique, les fluctuations de température et les changements dans les régimes de précipitations. L'agriculture en Afrique subsaharienne est principalement portée par de petits exploitants agricoles et joue un rôle important dans la sécurité alimentaire tant mondiale que locale. L'exposition se produit lorsque ces moyens de subsistance et ces produits sont confrontés à des conditions climatiques dangereuses. Pour comprendre pleinement le risque climatique, le niveau et l'échelle de l'exposition doivent être évalués."</span><span class="op">,</span></span>
<span id="cb129-4260"><a href="#cb129-4260" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb129-4261"><a href="#cb129-4261" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb129-4262"><a href="#cb129-4262" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4263"><a href="#cb129-4263" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb129-4264"><a href="#cb129-4264" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb129-4265"><a href="#cb129-4265" aria-hidden="true" tabindex="-1"></a>  <span class="dt">selectVars</span><span class="op">:</span> {</span>
<span id="cb129-4266"><a href="#cb129-4266" aria-hidden="true" tabindex="-1"></a>    <span class="dt">title</span><span class="op">:</span> {</span>
<span id="cb129-4267"><a href="#cb129-4267" aria-hidden="true" tabindex="-1"></a>      <span class="dt">en</span><span class="op">:</span> <span class="st">"Select the variables of interest"</span><span class="op">,</span></span>
<span id="cb129-4268"><a href="#cb129-4268" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fr</span><span class="op">:</span> <span class="st">"Sélectionnez les variables d'intérêt"</span><span class="op">,</span></span>
<span id="cb129-4269"><a href="#cb129-4269" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb129-4270"><a href="#cb129-4270" aria-hidden="true" tabindex="-1"></a>    <span class="dt">text</span><span class="op">:</span> {</span>
<span id="cb129-4271"><a href="#cb129-4271" aria-hidden="true" tabindex="-1"></a>      <span class="dt">en</span><span class="op">:</span> <span class="st">"There are many different variables within the categories of hazard, exposure, and vulnerability. Use the selector below to choose one or multiple of these variables to explore or download."</span><span class="op">,</span></span>
<span id="cb129-4272"><a href="#cb129-4272" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fr</span><span class="op">:</span> <span class="st">"Il existe de nombreuses variables différentes dans les catégories d'aléa, d'exposition et de vulnérabilité. Utilisez le sélecteur ci-dessous pour choisir une ou plusieurs de ces variables à explorer ou à télécharger."</span><span class="op">,</span></span>
<span id="cb129-4273"><a href="#cb129-4273" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb129-4274"><a href="#cb129-4274" aria-hidden="true" tabindex="-1"></a>    <span class="dt">forms</span><span class="op">:</span> {</span>
<span id="cb129-4275"><a href="#cb129-4275" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Hazard</span><span class="op">:</span> {</span>
<span id="cb129-4276"><a href="#cb129-4276" aria-hidden="true" tabindex="-1"></a>        <span class="dt">mainTitle</span><span class="op">:</span> {</span>
<span id="cb129-4277"><a href="#cb129-4277" aria-hidden="true" tabindex="-1"></a>          <span class="dt">en</span><span class="op">:</span> <span class="st">"Hazard Selectors (One of each must be selected)"</span><span class="op">,</span></span>
<span id="cb129-4278"><a href="#cb129-4278" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fr</span><span class="op">:</span> <span class="st">"Sélecteurs d'Aléas (Un de chaque doit être sélectionné)"</span><span class="op">,</span></span>
<span id="cb129-4279"><a href="#cb129-4279" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb129-4280"><a href="#cb129-4280" aria-hidden="true" tabindex="-1"></a>        <span class="dt">selectors</span><span class="op">:</span> {</span>
<span id="cb129-4281"><a href="#cb129-4281" aria-hidden="true" tabindex="-1"></a>          <span class="dt">hazard</span><span class="op">:</span> {</span>
<span id="cb129-4282"><a href="#cb129-4282" aria-hidden="true" tabindex="-1"></a>            <span class="dt">title</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Hazard"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Aléa"</span> }<span class="op">,</span></span>
<span id="cb129-4283"><a href="#cb129-4283" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb129-4284"><a href="#cb129-4284" aria-hidden="true" tabindex="-1"></a>          <span class="dt">period</span><span class="op">:</span> {</span>
<span id="cb129-4285"><a href="#cb129-4285" aria-hidden="true" tabindex="-1"></a>            <span class="dt">title</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Time Period"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Période de temps"</span> }<span class="op">,</span></span>
<span id="cb129-4286"><a href="#cb129-4286" aria-hidden="true" tabindex="-1"></a>            <span class="dt">options</span><span class="op">:</span> {</span>
<span id="cb129-4287"><a href="#cb129-4287" aria-hidden="true" tabindex="-1"></a>              <span class="dt">baseline</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Baseline"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Référence"</span> }<span class="op">,</span></span>
<span id="cb129-4288"><a href="#cb129-4288" aria-hidden="true" tabindex="-1"></a>              <span class="dt">historic</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Baseline"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Référence"</span> }<span class="op">,</span></span>
<span id="cb129-4289"><a href="#cb129-4289" aria-hidden="true" tabindex="-1"></a>              <span class="st">"2021_2040"</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"2040"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"2040"</span> }<span class="op">,</span></span>
<span id="cb129-4290"><a href="#cb129-4290" aria-hidden="true" tabindex="-1"></a>              <span class="st">"2041_2060"</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"2060"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"2060"</span> }<span class="op">,</span></span>
<span id="cb129-4291"><a href="#cb129-4291" aria-hidden="true" tabindex="-1"></a>            }<span class="op">,</span></span>
<span id="cb129-4292"><a href="#cb129-4292" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb129-4293"><a href="#cb129-4293" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb129-4294"><a href="#cb129-4294" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4295"><a href="#cb129-4295" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Vulnerability</span><span class="op">:</span> {</span>
<span id="cb129-4296"><a href="#cb129-4296" aria-hidden="true" tabindex="-1"></a>        <span class="dt">mainTitle</span><span class="op">:</span> {</span>
<span id="cb129-4297"><a href="#cb129-4297" aria-hidden="true" tabindex="-1"></a>          <span class="dt">en</span><span class="op">:</span> <span class="st">"Adaptive Capacity Selectors"</span><span class="op">,</span></span>
<span id="cb129-4298"><a href="#cb129-4298" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fr</span><span class="op">:</span> <span class="st">"Sélecteurs de capacité d’adaptation"</span><span class="op">,</span></span>
<span id="cb129-4299"><a href="#cb129-4299" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb129-4300"><a href="#cb129-4300" aria-hidden="true" tabindex="-1"></a>        <span class="dt">selectors</span><span class="op">:</span> {</span>
<span id="cb129-4301"><a href="#cb129-4301" aria-hidden="true" tabindex="-1"></a>          <span class="dt">variable</span><span class="op">:</span> {</span>
<span id="cb129-4302"><a href="#cb129-4302" aria-hidden="true" tabindex="-1"></a>            <span class="dt">title</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Variables"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Variables"</span> }<span class="op">,</span></span>
<span id="cb129-4303"><a href="#cb129-4303" aria-hidden="true" tabindex="-1"></a>            <span class="dt">options</span><span class="op">:</span> {</span>
<span id="cb129-4304"><a href="#cb129-4304" aria-hidden="true" tabindex="-1"></a>              <span class="dt">Gender</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Gender"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Genre"</span> }<span class="op">,</span></span>
<span id="cb129-4305"><a href="#cb129-4305" aria-hidden="true" tabindex="-1"></a>              <span class="dt">Education</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Education"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Éducation"</span> }<span class="op">,</span></span>
<span id="cb129-4306"><a href="#cb129-4306" aria-hidden="true" tabindex="-1"></a>              <span class="dt">Poverty</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Poverty"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Pauvreté"</span> }<span class="op">,</span></span>
<span id="cb129-4307"><a href="#cb129-4307" aria-hidden="true" tabindex="-1"></a>            }<span class="op">,</span></span>
<span id="cb129-4308"><a href="#cb129-4308" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb129-4309"><a href="#cb129-4309" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb129-4310"><a href="#cb129-4310" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4311"><a href="#cb129-4311" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Exposure</span><span class="op">:</span> {</span>
<span id="cb129-4312"><a href="#cb129-4312" aria-hidden="true" tabindex="-1"></a>        <span class="dt">mainTitle</span><span class="op">:</span> {</span>
<span id="cb129-4313"><a href="#cb129-4313" aria-hidden="true" tabindex="-1"></a>          <span class="dt">en</span><span class="op">:</span> <span class="st">"Exposure Selectors"</span><span class="op">,</span></span>
<span id="cb129-4314"><a href="#cb129-4314" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fr</span><span class="op">:</span> <span class="st">""</span><span class="op">,</span></span>
<span id="cb129-4315"><a href="#cb129-4315" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb129-4316"><a href="#cb129-4316" aria-hidden="true" tabindex="-1"></a>        <span class="dt">selectors</span><span class="op">:</span> {</span>
<span id="cb129-4317"><a href="#cb129-4317" aria-hidden="true" tabindex="-1"></a>          <span class="dt">variable</span><span class="op">:</span> {</span>
<span id="cb129-4318"><a href="#cb129-4318" aria-hidden="true" tabindex="-1"></a>            <span class="dt">title</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Variables"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Variables"</span> }<span class="op">,</span></span>
<span id="cb129-4319"><a href="#cb129-4319" aria-hidden="true" tabindex="-1"></a>            <span class="dt">options</span><span class="op">:</span> {</span>
<span id="cb129-4320"><a href="#cb129-4320" aria-hidden="true" tabindex="-1"></a>              <span class="dt">Crop</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Crop"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Cultures"</span> }<span class="op">,</span></span>
<span id="cb129-4321"><a href="#cb129-4321" aria-hidden="true" tabindex="-1"></a>              <span class="dt">Livestock</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Livestock"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Bétail"</span> }<span class="op">,</span></span>
<span id="cb129-4322"><a href="#cb129-4322" aria-hidden="true" tabindex="-1"></a>              <span class="dt">Population</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Population"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Population"</span> }<span class="op">,</span></span>
<span id="cb129-4323"><a href="#cb129-4323" aria-hidden="true" tabindex="-1"></a>            }<span class="op">,</span></span>
<span id="cb129-4324"><a href="#cb129-4324" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb129-4325"><a href="#cb129-4325" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb129-4326"><a href="#cb129-4326" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4327"><a href="#cb129-4327" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb129-4328"><a href="#cb129-4328" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb129-4329"><a href="#cb129-4329" aria-hidden="true" tabindex="-1"></a>  <span class="dt">selectGeog</span><span class="op">:</span> {</span>
<span id="cb129-4330"><a href="#cb129-4330" aria-hidden="true" tabindex="-1"></a>    <span class="dt">title</span><span class="op">:</span> {</span>
<span id="cb129-4331"><a href="#cb129-4331" aria-hidden="true" tabindex="-1"></a>      <span class="dt">en</span><span class="op">:</span> <span class="st">"Select Geographies"</span><span class="op">,</span></span>
<span id="cb129-4332"><a href="#cb129-4332" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fr</span><span class="op">:</span> <span class="st">"Sélectionnez les géographies"</span><span class="op">,</span></span>
<span id="cb129-4333"><a href="#cb129-4333" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb129-4334"><a href="#cb129-4334" aria-hidden="true" tabindex="-1"></a>    <span class="dt">text</span><span class="op">:</span> {</span>
<span id="cb129-4335"><a href="#cb129-4335" aria-hidden="true" tabindex="-1"></a>      <span class="dt">en</span><span class="op">:</span> <span class="st">"Use the toggles below to explore data and spatial patterns within your region of interest. Adjust the aggregation level to reveal patterns of hazard, vulnerability, and exposure, both within and between countries. These crucial insights often become clear only when viewed at higher spatial resolutions. Once you've selected an aggregation level, you can use the country, region, and sub-region selectors to focus on specific areas."</span><span class="op">,</span></span>
<span id="cb129-4336"><a href="#cb129-4336" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fr</span><span class="op">:</span> <span class="st">"Utilisez les options ci-dessous pour explorer les données et les modèles spatiaux dans votre région d'intérêt. Ajustez le niveau d'agrégation pour révéler les schémas d'aléa, de vulnérabilité et d'exposition, à la fois au sein des pays et entre eux. Ces informations cruciales deviennent souvent claires uniquement lorsqu'elles sont observées à des résolutions spatiales plus élevées. Une fois que vous avez sélectionné un niveau d'agrégation, vous pouvez utiliser les sélecteurs de pays, de région et de sous-région pour vous concentrer sur des zones spécifiques."</span><span class="op">,</span></span>
<span id="cb129-4337"><a href="#cb129-4337" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb129-4338"><a href="#cb129-4338" aria-hidden="true" tabindex="-1"></a>    <span class="dt">selectors</span><span class="op">:</span> {</span>
<span id="cb129-4339"><a href="#cb129-4339" aria-hidden="true" tabindex="-1"></a>      <span class="dt">aggregationLvl</span><span class="op">:</span> {</span>
<span id="cb129-4340"><a href="#cb129-4340" aria-hidden="true" tabindex="-1"></a>        <span class="dt">title</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Map Level"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Niveau cartographique"</span> }<span class="op">,</span></span>
<span id="cb129-4341"><a href="#cb129-4341" aria-hidden="true" tabindex="-1"></a>        <span class="dt">options</span><span class="op">:</span> {</span>
<span id="cb129-4342"><a href="#cb129-4342" aria-hidden="true" tabindex="-1"></a>          <span class="dt">admin0_name</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Country"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Pays"</span> }<span class="op">,</span></span>
<span id="cb129-4343"><a href="#cb129-4343" aria-hidden="true" tabindex="-1"></a>          <span class="dt">admin1_name</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Region"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Région"</span> }<span class="op">,</span></span>
<span id="cb129-4344"><a href="#cb129-4344" aria-hidden="true" tabindex="-1"></a>          <span class="dt">admin2_name</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Sub-Region"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Sous-région"</span> }<span class="op">,</span></span>
<span id="cb129-4345"><a href="#cb129-4345" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb129-4346"><a href="#cb129-4346" aria-hidden="true" tabindex="-1"></a>        <span class="dt">warning</span><span class="op">:</span> {</span>
<span id="cb129-4347"><a href="#cb129-4347" aria-hidden="true" tabindex="-1"></a>          <span class="dt">en</span><span class="op">:</span> <span class="st">"Warning: Selecting all sub-regions in SSA may affect page performance"</span><span class="op">,</span></span>
<span id="cb129-4348"><a href="#cb129-4348" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fr</span><span class="op">:</span> <span class="st">""</span><span class="op">,</span></span>
<span id="cb129-4349"><a href="#cb129-4349" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb129-4350"><a href="#cb129-4350" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4351"><a href="#cb129-4351" aria-hidden="true" tabindex="-1"></a>      <span class="dt">admin0_name</span><span class="op">:</span> {</span>
<span id="cb129-4352"><a href="#cb129-4352" aria-hidden="true" tabindex="-1"></a>        <span class="dt">title</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Country"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Pays"</span> }<span class="op">,</span></span>
<span id="cb129-4353"><a href="#cb129-4353" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4354"><a href="#cb129-4354" aria-hidden="true" tabindex="-1"></a>      <span class="dt">admin1_name</span><span class="op">:</span> {</span>
<span id="cb129-4355"><a href="#cb129-4355" aria-hidden="true" tabindex="-1"></a>        <span class="dt">title</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Region"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Région"</span> }<span class="op">,</span></span>
<span id="cb129-4356"><a href="#cb129-4356" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4357"><a href="#cb129-4357" aria-hidden="true" tabindex="-1"></a>      <span class="dt">admin2_name</span><span class="op">:</span> {</span>
<span id="cb129-4358"><a href="#cb129-4358" aria-hidden="true" tabindex="-1"></a>        <span class="dt">title</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Sub-Region"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Sous-région"</span> }<span class="op">,</span></span>
<span id="cb129-4359"><a href="#cb129-4359" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4360"><a href="#cb129-4360" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb129-4361"><a href="#cb129-4361" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb129-4362"><a href="#cb129-4362" aria-hidden="true" tabindex="-1"></a>  <span class="dt">ViewExplore</span><span class="op">:</span> {</span>
<span id="cb129-4363"><a href="#cb129-4363" aria-hidden="true" tabindex="-1"></a>    <span class="dt">title</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Interact with the data"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Interagir avec les données"</span> }<span class="op">,</span></span>
<span id="cb129-4364"><a href="#cb129-4364" aria-hidden="true" tabindex="-1"></a>    <span class="dt">text</span><span class="op">:</span> {</span>
<span id="cb129-4365"><a href="#cb129-4365" aria-hidden="true" tabindex="-1"></a>      <span class="dt">en</span><span class="op">:</span> <span class="st">"Use the map below to view spatial patterns in the data, select the table to preview the data before downloading it, or gain quick insights using the plots."</span><span class="op">,</span></span>
<span id="cb129-4366"><a href="#cb129-4366" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fr</span><span class="op">:</span> <span class="st">"Utilisez la carte ci-dessous pour visualiser les modèles spatiaux dans les données, sélectionnez le tableau pour prévisualiser les données avant de les télécharger, ou obtenez rapidement des informations en utilisant les graphiques."</span><span class="op">,</span></span>
<span id="cb129-4367"><a href="#cb129-4367" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb129-4368"><a href="#cb129-4368" aria-hidden="true" tabindex="-1"></a>    <span class="dt">selectors</span><span class="op">:</span> {</span>
<span id="cb129-4369"><a href="#cb129-4369" aria-hidden="true" tabindex="-1"></a>      <span class="dt">preview</span><span class="op">:</span> {</span>
<span id="cb129-4370"><a href="#cb129-4370" aria-hidden="true" tabindex="-1"></a>        <span class="dt">title</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Preview Type"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Type d'Aperçu"</span> }<span class="op">,</span></span>
<span id="cb129-4371"><a href="#cb129-4371" aria-hidden="true" tabindex="-1"></a>        <span class="dt">options</span><span class="op">:</span> {</span>
<span id="cb129-4372"><a href="#cb129-4372" aria-hidden="true" tabindex="-1"></a>          <span class="dt">Map</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Map"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Carte"</span> }<span class="op">,</span></span>
<span id="cb129-4373"><a href="#cb129-4373" aria-hidden="true" tabindex="-1"></a>          <span class="dt">Table</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Table"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Tableau"</span> }<span class="op">,</span></span>
<span id="cb129-4374"><a href="#cb129-4374" aria-hidden="true" tabindex="-1"></a>          <span class="dt">Plot</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Plot"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Graphique"</span> }<span class="op">,</span></span>
<span id="cb129-4375"><a href="#cb129-4375" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb129-4376"><a href="#cb129-4376" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4377"><a href="#cb129-4377" aria-hidden="true" tabindex="-1"></a>      <span class="dt">visualiseVars</span><span class="op">:</span> {</span>
<span id="cb129-4378"><a href="#cb129-4378" aria-hidden="true" tabindex="-1"></a>        <span class="dt">titleMap</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Variable To Map"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Variable à cartographier"</span> }<span class="op">,</span></span>
<span id="cb129-4379"><a href="#cb129-4379" aria-hidden="true" tabindex="-1"></a>        <span class="dt">titlePlot</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Variable To Plot"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">""</span> }<span class="op">,</span></span>
<span id="cb129-4380"><a href="#cb129-4380" aria-hidden="true" tabindex="-1"></a>        <span class="dt">hazards</span><span class="op">:</span> {</span>
<span id="cb129-4381"><a href="#cb129-4381" aria-hidden="true" tabindex="-1"></a>          <span class="co">// hazard and timeperiod can be stolen from other section</span></span>
<span id="cb129-4382"><a href="#cb129-4382" aria-hidden="true" tabindex="-1"></a>          <span class="dt">scenario</span><span class="op">:</span> {</span>
<span id="cb129-4383"><a href="#cb129-4383" aria-hidden="true" tabindex="-1"></a>            <span class="dt">title</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Scenario"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Scénario"</span> }<span class="op">,</span></span>
<span id="cb129-4384"><a href="#cb129-4384" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb129-4385"><a href="#cb129-4385" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb129-4386"><a href="#cb129-4386" aria-hidden="true" tabindex="-1"></a>        <span class="dt">vulnerability</span><span class="op">:</span> {</span>
<span id="cb129-4387"><a href="#cb129-4387" aria-hidden="true" tabindex="-1"></a>          <span class="dt">gender</span><span class="op">:</span> {</span>
<span id="cb129-4388"><a href="#cb129-4388" aria-hidden="true" tabindex="-1"></a>            <span class="dt">title</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Gender Variable"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Variable de Genre"</span> }<span class="op">,</span></span>
<span id="cb129-4389"><a href="#cb129-4389" aria-hidden="true" tabindex="-1"></a>            <span class="dt">options</span><span class="op">:</span> {</span>
<span id="cb129-4390"><a href="#cb129-4390" aria-hidden="true" tabindex="-1"></a>              <span class="dt">domestic_violence</span><span class="op">:</span> {</span>
<span id="cb129-4391"><a href="#cb129-4391" aria-hidden="true" tabindex="-1"></a>                <span class="dt">en</span><span class="op">:</span> <span class="st">"Domestic Safety"</span><span class="op">,</span></span>
<span id="cb129-4392"><a href="#cb129-4392" aria-hidden="true" tabindex="-1"></a>                <span class="dt">fr</span><span class="op">:</span> <span class="st">"Sécurité domestique"</span><span class="op">,</span></span>
<span id="cb129-4393"><a href="#cb129-4393" aria-hidden="true" tabindex="-1"></a>              }<span class="op">,</span></span>
<span id="cb129-4394"><a href="#cb129-4394" aria-hidden="true" tabindex="-1"></a>              <span class="dt">gender_equity</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Gender Equity"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Égalité des sexes"</span> }<span class="op">,</span></span>
<span id="cb129-4395"><a href="#cb129-4395" aria-hidden="true" tabindex="-1"></a>              <span class="dt">decision_making</span><span class="op">:</span> {</span>
<span id="cb129-4396"><a href="#cb129-4396" aria-hidden="true" tabindex="-1"></a>                <span class="dt">en</span><span class="op">:</span> <span class="st">"Decision Making Power"</span><span class="op">,</span></span>
<span id="cb129-4397"><a href="#cb129-4397" aria-hidden="true" tabindex="-1"></a>                <span class="dt">fr</span><span class="op">:</span> <span class="st">"Pouvoir de décision"</span><span class="op">,</span></span>
<span id="cb129-4398"><a href="#cb129-4398" aria-hidden="true" tabindex="-1"></a>              }<span class="op">,</span></span>
<span id="cb129-4399"><a href="#cb129-4399" aria-hidden="true" tabindex="-1"></a>              <span class="dt">education</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Womens Education"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Éducation des femmes"</span> }<span class="op">,</span></span>
<span id="cb129-4400"><a href="#cb129-4400" aria-hidden="true" tabindex="-1"></a>              <span class="dt">family_planning</span><span class="op">:</span> {</span>
<span id="cb129-4401"><a href="#cb129-4401" aria-hidden="true" tabindex="-1"></a>                <span class="dt">en</span><span class="op">:</span> <span class="st">"Access to Family Planning"</span><span class="op">,</span></span>
<span id="cb129-4402"><a href="#cb129-4402" aria-hidden="true" tabindex="-1"></a>                <span class="dt">fr</span><span class="op">:</span> <span class="st">"Accès à la planification familiale"</span><span class="op">,</span></span>
<span id="cb129-4403"><a href="#cb129-4403" aria-hidden="true" tabindex="-1"></a>              }<span class="op">,</span></span>
<span id="cb129-4404"><a href="#cb129-4404" aria-hidden="true" tabindex="-1"></a>              <span class="dt">reproductive_health</span><span class="op">:</span> {</span>
<span id="cb129-4405"><a href="#cb129-4405" aria-hidden="true" tabindex="-1"></a>                <span class="dt">en</span><span class="op">:</span> <span class="st">"Reproductive Health"</span><span class="op">,</span></span>
<span id="cb129-4406"><a href="#cb129-4406" aria-hidden="true" tabindex="-1"></a>                <span class="dt">fr</span><span class="op">:</span> <span class="st">"Santé reproductive"</span><span class="op">,</span></span>
<span id="cb129-4407"><a href="#cb129-4407" aria-hidden="true" tabindex="-1"></a>              }<span class="op">,</span></span>
<span id="cb129-4408"><a href="#cb129-4408" aria-hidden="true" tabindex="-1"></a>            }<span class="op">,</span></span>
<span id="cb129-4409"><a href="#cb129-4409" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb129-4410"><a href="#cb129-4410" aria-hidden="true" tabindex="-1"></a>          <span class="dt">poverty</span><span class="op">:</span> {</span>
<span id="cb129-4411"><a href="#cb129-4411" aria-hidden="true" tabindex="-1"></a>            <span class="dt">title</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Poverty variable"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Variable de Pauvreté"</span> }<span class="op">,</span></span>
<span id="cb129-4412"><a href="#cb129-4412" aria-hidden="true" tabindex="-1"></a>            <span class="dt">options</span><span class="op">:</span> {</span>
<span id="cb129-4413"><a href="#cb129-4413" aria-hidden="true" tabindex="-1"></a>              <span class="dt">GSAP_poor215</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"% under $2.15 poverty line"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">""</span> }<span class="op">,</span></span>
<span id="cb129-4414"><a href="#cb129-4414" aria-hidden="true" tabindex="-1"></a>              <span class="dt">GSAP_poor365</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"% under $3.65 poverty line"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">""</span> }<span class="op">,</span></span>
<span id="cb129-4415"><a href="#cb129-4415" aria-hidden="true" tabindex="-1"></a>              <span class="dt">GSAP_poor685</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"% under $6.85 poverty line"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">""</span> }<span class="op">,</span></span>
<span id="cb129-4416"><a href="#cb129-4416" aria-hidden="true" tabindex="-1"></a>            }<span class="op">,</span></span>
<span id="cb129-4417"><a href="#cb129-4417" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb129-4418"><a href="#cb129-4418" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb129-4419"><a href="#cb129-4419" aria-hidden="true" tabindex="-1"></a>        <span class="dt">exposure</span><span class="op">:</span> {</span>
<span id="cb129-4420"><a href="#cb129-4420" aria-hidden="true" tabindex="-1"></a>          <span class="dt">title</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Exposure Category"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Catégorie d'Exposition"</span> }<span class="op">,</span></span>
<span id="cb129-4421"><a href="#cb129-4421" aria-hidden="true" tabindex="-1"></a>          <span class="dt">population</span><span class="op">:</span> {</span>
<span id="cb129-4422"><a href="#cb129-4422" aria-hidden="true" tabindex="-1"></a>            <span class="dt">title</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Population Group"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Groupe de Population"</span> }<span class="op">,</span></span>
<span id="cb129-4423"><a href="#cb129-4423" aria-hidden="true" tabindex="-1"></a>            <span class="dt">options</span><span class="op">:</span> {</span>
<span id="cb129-4424"><a href="#cb129-4424" aria-hidden="true" tabindex="-1"></a>              <span class="dt">total_pop</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Total Population"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Population Totale"</span> }<span class="op">,</span></span>
<span id="cb129-4425"><a href="#cb129-4425" aria-hidden="true" tabindex="-1"></a>              <span class="dt">rural_pop</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Rural Population"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Population Rurale"</span> }<span class="op">,</span></span>
<span id="cb129-4426"><a href="#cb129-4426" aria-hidden="true" tabindex="-1"></a>              <span class="dt">urban_pop</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Urban Population"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Population Urbaine"</span> }<span class="op">,</span></span>
<span id="cb129-4427"><a href="#cb129-4427" aria-hidden="true" tabindex="-1"></a>            }<span class="op">,</span></span>
<span id="cb129-4428"><a href="#cb129-4428" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb129-4429"><a href="#cb129-4429" aria-hidden="true" tabindex="-1"></a>          <span class="dt">commodity</span><span class="op">:</span> {</span>
<span id="cb129-4430"><a href="#cb129-4430" aria-hidden="true" tabindex="-1"></a>            <span class="dt">title</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Commodity"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Produit"</span> }<span class="op">,</span></span>
<span id="cb129-4431"><a href="#cb129-4431" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb129-4432"><a href="#cb129-4432" aria-hidden="true" tabindex="-1"></a>          <span class="dt">exposureVariable</span><span class="op">:</span> {</span>
<span id="cb129-4433"><a href="#cb129-4433" aria-hidden="true" tabindex="-1"></a>            <span class="dt">title</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Variable"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Variable"</span> }<span class="op">,</span></span>
<span id="cb129-4434"><a href="#cb129-4434" aria-hidden="true" tabindex="-1"></a>            <span class="dt">options</span><span class="op">:</span> {</span>
<span id="cb129-4435"><a href="#cb129-4435" aria-hidden="true" tabindex="-1"></a>              <span class="dt">total_pop</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Total Population"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Population Totale"</span> }<span class="op">,</span></span>
<span id="cb129-4436"><a href="#cb129-4436" aria-hidden="true" tabindex="-1"></a>              <span class="dt">rural_pop</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Rural Population"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Population Rurale"</span> }<span class="op">,</span></span>
<span id="cb129-4437"><a href="#cb129-4437" aria-hidden="true" tabindex="-1"></a>              <span class="dt">urban_pop</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Urban Population"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Population Urbaine"</span> }<span class="op">,</span></span>
<span id="cb129-4438"><a href="#cb129-4438" aria-hidden="true" tabindex="-1"></a>              <span class="dt">vop</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Value of Production"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Valeur de la Production"</span> }<span class="op">,</span></span>
<span id="cb129-4439"><a href="#cb129-4439" aria-hidden="true" tabindex="-1"></a>              <span class="dt">ha</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Harvested Area"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Superficie Récoltée"</span> }<span class="op">,</span></span>
<span id="cb129-4440"><a href="#cb129-4440" aria-hidden="true" tabindex="-1"></a>              <span class="dt">number</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Number of Animals"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Nombre d'Animaux"</span> }<span class="op">,</span></span>
<span id="cb129-4441"><a href="#cb129-4441" aria-hidden="true" tabindex="-1"></a>            }<span class="op">,</span></span>
<span id="cb129-4442"><a href="#cb129-4442" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb129-4443"><a href="#cb129-4443" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb129-4444"><a href="#cb129-4444" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4445"><a href="#cb129-4445" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb129-4446"><a href="#cb129-4446" aria-hidden="true" tabindex="-1"></a>    <span class="dt">exploreMap</span><span class="op">:</span> {</span>
<span id="cb129-4447"><a href="#cb129-4447" aria-hidden="true" tabindex="-1"></a>      <span class="dt">resetBtn</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Reset Zoom"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Réinitialiser le zoom"</span> }<span class="op">,</span></span>
<span id="cb129-4448"><a href="#cb129-4448" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Value"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Valeur"</span> }<span class="op">,</span></span>
<span id="cb129-4449"><a href="#cb129-4449" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb129-4450"><a href="#cb129-4450" aria-hidden="true" tabindex="-1"></a>    <span class="dt">hazardBars</span><span class="op">:</span> {</span>
<span id="cb129-4451"><a href="#cb129-4451" aria-hidden="true" tabindex="-1"></a>      <span class="dt">numAreas</span><span class="op">:</span> {</span>
<span id="cb129-4452"><a href="#cb129-4452" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Number of Areas"</span><span class="op">,</span></span>
<span id="cb129-4453"><a href="#cb129-4453" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Nombre d'Unités Administratives"</span><span class="op">,</span></span>
<span id="cb129-4454"><a href="#cb129-4454" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4455"><a href="#cb129-4455" aria-hidden="true" tabindex="-1"></a>      <span class="dt">yaxis</span><span class="op">:</span> {</span>
<span id="cb129-4456"><a href="#cb129-4456" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Number of Admin Units"</span><span class="op">,</span></span>
<span id="cb129-4457"><a href="#cb129-4457" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Nombre d'Unités Administratives"</span><span class="op">,</span></span>
<span id="cb129-4458"><a href="#cb129-4458" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4459"><a href="#cb129-4459" aria-hidden="true" tabindex="-1"></a>      <span class="dt">lvl</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Level"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">""</span> }<span class="op">,</span></span>
<span id="cb129-4460"><a href="#cb129-4460" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb129-4461"><a href="#cb129-4461" aria-hidden="true" tabindex="-1"></a>    <span class="dt">exposureTreemap</span><span class="op">:</span> {</span>
<span id="cb129-4462"><a href="#cb129-4462" aria-hidden="true" tabindex="-1"></a>      <span class="dt">cropGroups</span><span class="op">:</span> {</span>
<span id="cb129-4463"><a href="#cb129-4463" aria-hidden="true" tabindex="-1"></a>        <span class="dt">total</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Total"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Total"</span> }<span class="op">,</span></span>
<span id="cb129-4464"><a href="#cb129-4464" aria-hidden="true" tabindex="-1"></a>        <span class="dt">cattle</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Cattle"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Bovins"</span> }<span class="op">,</span></span>
<span id="cb129-4465"><a href="#cb129-4465" aria-hidden="true" tabindex="-1"></a>        <span class="dt">poultry</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Poultry"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Volailles"</span> }<span class="op">,</span></span>
<span id="cb129-4466"><a href="#cb129-4466" aria-hidden="true" tabindex="-1"></a>        <span class="dt">pigs</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Pigs"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Porcs"</span> }<span class="op">,</span></span>
<span id="cb129-4467"><a href="#cb129-4467" aria-hidden="true" tabindex="-1"></a>        <span class="dt">cereals</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Cereals"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Céréales"</span> }<span class="op">,</span></span>
<span id="cb129-4468"><a href="#cb129-4468" aria-hidden="true" tabindex="-1"></a>        <span class="dt">rootsTuber</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Roots &amp; Tubers"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Racines et Tubercules"</span> }<span class="op">,</span></span>
<span id="cb129-4469"><a href="#cb129-4469" aria-hidden="true" tabindex="-1"></a>        <span class="dt">legumes</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Legumes"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Légumineuses"</span> }<span class="op">,</span></span>
<span id="cb129-4470"><a href="#cb129-4470" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fruitVeg</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Fruits &amp; Vegetables"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Fruits et Légumes"</span> }<span class="op">,</span></span>
<span id="cb129-4471"><a href="#cb129-4471" aria-hidden="true" tabindex="-1"></a>        <span class="dt">nonEdible</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Non-edible Crops"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Cultures non comestibles"</span> }<span class="op">,</span></span>
<span id="cb129-4472"><a href="#cb129-4472" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4473"><a href="#cb129-4473" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb129-4474"><a href="#cb129-4474" aria-hidden="true" tabindex="-1"></a>    <span class="dt">parallelCoords</span><span class="op">:</span> {</span>
<span id="cb129-4475"><a href="#cb129-4475" aria-hidden="true" tabindex="-1"></a>      <span class="dt">acVars</span><span class="op">:</span> {</span>
<span id="cb129-4476"><a href="#cb129-4476" aria-hidden="true" tabindex="-1"></a>        <span class="dt">domestic_violence</span><span class="op">:</span> {</span>
<span id="cb129-4477"><a href="#cb129-4477" aria-hidden="true" tabindex="-1"></a>          <span class="dt">en</span><span class="op">:</span> <span class="st">"Domestic Safety"</span><span class="op">,</span></span>
<span id="cb129-4478"><a href="#cb129-4478" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fr</span><span class="op">:</span> <span class="st">"Sécurité domestique"</span><span class="op">,</span></span>
<span id="cb129-4479"><a href="#cb129-4479" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb129-4480"><a href="#cb129-4480" aria-hidden="true" tabindex="-1"></a>        <span class="dt">gender_equity</span><span class="op">:</span> {</span>
<span id="cb129-4481"><a href="#cb129-4481" aria-hidden="true" tabindex="-1"></a>          <span class="dt">en</span><span class="op">:</span> <span class="st">"Gender Equity"</span><span class="op">,</span></span>
<span id="cb129-4482"><a href="#cb129-4482" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fr</span><span class="op">:</span> <span class="st">"Égalité des sexes"</span><span class="op">,</span></span>
<span id="cb129-4483"><a href="#cb129-4483" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb129-4484"><a href="#cb129-4484" aria-hidden="true" tabindex="-1"></a>        <span class="dt">decision_making</span><span class="op">:</span> {</span>
<span id="cb129-4485"><a href="#cb129-4485" aria-hidden="true" tabindex="-1"></a>          <span class="dt">en</span><span class="op">:</span> <span class="st">"Decision Making Power"</span><span class="op">,</span></span>
<span id="cb129-4486"><a href="#cb129-4486" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fr</span><span class="op">:</span> <span class="st">"Pouvoir de décision"</span><span class="op">,</span></span>
<span id="cb129-4487"><a href="#cb129-4487" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb129-4488"><a href="#cb129-4488" aria-hidden="true" tabindex="-1"></a>        <span class="dt">education</span><span class="op">:</span> {</span>
<span id="cb129-4489"><a href="#cb129-4489" aria-hidden="true" tabindex="-1"></a>          <span class="dt">en</span><span class="op">:</span> <span class="st">"Womens Education"</span><span class="op">,</span></span>
<span id="cb129-4490"><a href="#cb129-4490" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fr</span><span class="op">:</span> <span class="st">"Éducation des femmes"</span><span class="op">,</span></span>
<span id="cb129-4491"><a href="#cb129-4491" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb129-4492"><a href="#cb129-4492" aria-hidden="true" tabindex="-1"></a>        <span class="dt">family_planning</span><span class="op">:</span> {</span>
<span id="cb129-4493"><a href="#cb129-4493" aria-hidden="true" tabindex="-1"></a>          <span class="dt">en</span><span class="op">:</span> <span class="st">"Access to Family Planning"</span><span class="op">,</span></span>
<span id="cb129-4494"><a href="#cb129-4494" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fr</span><span class="op">:</span> <span class="st">"Accès à la planification familiale"</span><span class="op">,</span></span>
<span id="cb129-4495"><a href="#cb129-4495" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb129-4496"><a href="#cb129-4496" aria-hidden="true" tabindex="-1"></a>        <span class="dt">reproductive_health</span><span class="op">:</span> {</span>
<span id="cb129-4497"><a href="#cb129-4497" aria-hidden="true" tabindex="-1"></a>          <span class="dt">en</span><span class="op">:</span> <span class="st">"Reproductive Health"</span><span class="op">,</span></span>
<span id="cb129-4498"><a href="#cb129-4498" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fr</span><span class="op">:</span> <span class="st">"Santé reproductive"</span><span class="op">,</span></span>
<span id="cb129-4499"><a href="#cb129-4499" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb129-4500"><a href="#cb129-4500" aria-hidden="true" tabindex="-1"></a>        <span class="dt">GSAP_poor215</span><span class="op">:</span> {</span>
<span id="cb129-4501"><a href="#cb129-4501" aria-hidden="true" tabindex="-1"></a>          <span class="dt">en</span><span class="op">:</span> <span class="st">"Above $2.15/day"</span><span class="op">,</span></span>
<span id="cb129-4502"><a href="#cb129-4502" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fr</span><span class="op">:</span> <span class="st">"Au-dessus de 2,15 $/jour"</span><span class="op">,</span></span>
<span id="cb129-4503"><a href="#cb129-4503" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb129-4504"><a href="#cb129-4504" aria-hidden="true" tabindex="-1"></a>        <span class="dt">GSAP_poor365</span><span class="op">:</span> {</span>
<span id="cb129-4505"><a href="#cb129-4505" aria-hidden="true" tabindex="-1"></a>          <span class="dt">en</span><span class="op">:</span> <span class="st">"Above $3.65/day"</span><span class="op">,</span></span>
<span id="cb129-4506"><a href="#cb129-4506" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fr</span><span class="op">:</span> <span class="st">"Au-dessus de 3,65 $/jour"</span><span class="op">,</span></span>
<span id="cb129-4507"><a href="#cb129-4507" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb129-4508"><a href="#cb129-4508" aria-hidden="true" tabindex="-1"></a>        <span class="dt">GSAP_poor685</span><span class="op">:</span> {</span>
<span id="cb129-4509"><a href="#cb129-4509" aria-hidden="true" tabindex="-1"></a>          <span class="dt">en</span><span class="op">:</span> <span class="st">"Above $6.85/day"</span><span class="op">,</span></span>
<span id="cb129-4510"><a href="#cb129-4510" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fr</span><span class="op">:</span> <span class="st">"Au-dessus de 6,85 $/jour"</span><span class="op">,</span></span>
<span id="cb129-4511"><a href="#cb129-4511" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb129-4512"><a href="#cb129-4512" aria-hidden="true" tabindex="-1"></a>        <span class="dt">educationYrs</span><span class="op">:</span> {</span>
<span id="cb129-4513"><a href="#cb129-4513" aria-hidden="true" tabindex="-1"></a>          <span class="dt">en</span><span class="op">:</span> <span class="st">"Education(Yrs)"</span><span class="op">,</span></span>
<span id="cb129-4514"><a href="#cb129-4514" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fr</span><span class="op">:</span> <span class="st">"Éducation (années)"</span><span class="op">,</span></span>
<span id="cb129-4515"><a href="#cb129-4515" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb129-4516"><a href="#cb129-4516" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4517"><a href="#cb129-4517" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb129-4518"><a href="#cb129-4518" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb129-4519"><a href="#cb129-4519" aria-hidden="true" tabindex="-1"></a>  <span class="dt">download</span><span class="op">:</span> {</span>
<span id="cb129-4520"><a href="#cb129-4520" aria-hidden="true" tabindex="-1"></a>    <span class="dt">title</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Download The Data"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Télécharger les données"</span> }<span class="op">,</span></span>
<span id="cb129-4521"><a href="#cb129-4521" aria-hidden="true" tabindex="-1"></a>    <span class="dt">selector</span><span class="op">:</span> {</span>
<span id="cb129-4522"><a href="#cb129-4522" aria-hidden="true" tabindex="-1"></a>      <span class="dt">title</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Download Format"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Format de téléchargement"</span> }<span class="op">,</span></span>
<span id="cb129-4523"><a href="#cb129-4523" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb129-4524"><a href="#cb129-4524" aria-hidden="true" tabindex="-1"></a>    <span class="dt">button</span><span class="op">:</span> {</span>
<span id="cb129-4525"><a href="#cb129-4525" aria-hidden="true" tabindex="-1"></a>      <span class="dt">prepare</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Prepare Download"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Préparer le téléchargement"</span> }<span class="op">,</span></span>
<span id="cb129-4526"><a href="#cb129-4526" aria-hidden="true" tabindex="-1"></a>      <span class="dt">download</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Download"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Télécharger"</span> }<span class="op">,</span></span>
<span id="cb129-4527"><a href="#cb129-4527" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb129-4528"><a href="#cb129-4528" aria-hidden="true" tabindex="-1"></a>    <span class="dt">boundaries</span><span class="op">:</span> {</span>
<span id="cb129-4529"><a href="#cb129-4529" aria-hidden="true" tabindex="-1"></a>      <span class="dt">title</span><span class="op">:</span> {</span>
<span id="cb129-4530"><a href="#cb129-4530" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Download Boundary Data"</span><span class="op">,</span></span>
<span id="cb129-4531"><a href="#cb129-4531" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Télécharger les données des frontières"</span><span class="op">,</span></span>
<span id="cb129-4532"><a href="#cb129-4532" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4533"><a href="#cb129-4533" aria-hidden="true" tabindex="-1"></a>      <span class="dt">button</span><span class="op">:</span> {</span>
<span id="cb129-4534"><a href="#cb129-4534" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Download Admin :::adminLvl::: Boundaries"</span><span class="op">,</span></span>
<span id="cb129-4535"><a href="#cb129-4535" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Télécharger les frontières administratives :::adminLvl:::"</span><span class="op">,</span></span>
<span id="cb129-4536"><a href="#cb129-4536" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4537"><a href="#cb129-4537" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb129-4538"><a href="#cb129-4538" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb129-4539"><a href="#cb129-4539" aria-hidden="true" tabindex="-1"></a>  <span class="dt">methods_sources</span><span class="op">:</span> {</span>
<span id="cb129-4540"><a href="#cb129-4540" aria-hidden="true" tabindex="-1"></a>    <span class="dt">title</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Methods &amp; Sources"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Méthodes &amp; Sources"</span> }<span class="op">,</span></span>
<span id="cb129-4541"><a href="#cb129-4541" aria-hidden="true" tabindex="-1"></a>    <span class="dt">methods</span><span class="op">:</span> {</span>
<span id="cb129-4542"><a href="#cb129-4542" aria-hidden="true" tabindex="-1"></a>      <span class="dt">title</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Methods"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Méthodologie"</span> }<span class="op">,</span></span>
<span id="cb129-4543"><a href="#cb129-4543" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb129-4544"><a href="#cb129-4544" aria-hidden="true" tabindex="-1"></a>    <span class="dt">datasets</span><span class="op">:</span> {</span>
<span id="cb129-4545"><a href="#cb129-4545" aria-hidden="true" tabindex="-1"></a>      <span class="dt">title</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Datasets"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Jeux de données"</span> }<span class="op">,</span></span>
<span id="cb129-4546"><a href="#cb129-4546" aria-hidden="true" tabindex="-1"></a>      <span class="dt">boundaries</span><span class="op">:</span> {</span>
<span id="cb129-4547"><a href="#cb129-4547" aria-hidden="true" tabindex="-1"></a>        <span class="dt">title</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Boundaries"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Délimitations"</span> }<span class="op">,</span></span>
<span id="cb129-4548"><a href="#cb129-4548" aria-hidden="true" tabindex="-1"></a>        <span class="dt">text</span><span class="op">:</span> {</span>
<span id="cb129-4549"><a href="#cb129-4549" aria-hidden="true" tabindex="-1"></a>          <span class="dt">en</span><span class="op">:</span> <span class="vs">`[Administrative areas](https://radiantearth.github.io/stac-browser/#/external/digital-atlas.s3.amazonaws.com/stac/public_stac/boundary_catalog/geoBoundaries_SSA/collection.json) used in this notebook come from [geoBoundaries 6.0.0](https://github.com/wmgeolab/geoBoundaries). The gbHumanitarian boundaries are used and if not available then the gbOpen boundaries are substituted.`</span><span class="op">,</span></span>
<span id="cb129-4550"><a href="#cb129-4550" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fr</span><span class="op">:</span> <span class="vs">`[Les zones administratives](https://radiantearth.github.io/stac-browser/#/external/digital-atlas.s3.amazonaws.com/stac/public_stac/boundary_catalog/geoBoundaries_SSA/collection.json?.language=fr) utilisées dans ce notebook proviennent de [geoBoundaries 6.0.0](https://github.com/wmgeolab/geoBoundaries). Les frontières gbHumanitarian sont utilisées et, si elles ne sont pas disponibles, les frontières gbOpen sont substituées.`</span><span class="op">,</span></span>
<span id="cb129-4551"><a href="#cb129-4551" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb129-4552"><a href="#cb129-4552" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4553"><a href="#cb129-4553" aria-hidden="true" tabindex="-1"></a>      <span class="dt">acDS</span><span class="op">:</span> {</span>
<span id="cb129-4554"><a href="#cb129-4554" aria-hidden="true" tabindex="-1"></a>        <span class="dt">title</span><span class="op">:</span> {</span>
<span id="cb129-4555"><a href="#cb129-4555" aria-hidden="true" tabindex="-1"></a>          <span class="dt">en</span><span class="op">:</span> <span class="st">"Adaptive Capacity Datasets"</span><span class="op">,</span></span>
<span id="cb129-4556"><a href="#cb129-4556" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fr</span><span class="op">:</span> <span class="st">"Jeux de données sur la capacité d’adaptation"</span><span class="op">,</span></span>
<span id="cb129-4557"><a href="#cb129-4557" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb129-4558"><a href="#cb129-4558" aria-hidden="true" tabindex="-1"></a>        <span class="dt">FemaleWellbeing</span><span class="op">:</span> {</span>
<span id="cb129-4559"><a href="#cb129-4559" aria-hidden="true" tabindex="-1"></a>          <span class="dt">title</span><span class="op">:</span> {</span>
<span id="cb129-4560"><a href="#cb129-4560" aria-hidden="true" tabindex="-1"></a>            <span class="dt">en</span><span class="op">:</span> <span class="st">"Female Well-being and Empowerment data"</span><span class="op">,</span></span>
<span id="cb129-4561"><a href="#cb129-4561" aria-hidden="true" tabindex="-1"></a>            <span class="dt">fr</span><span class="op">:</span> <span class="st">"Données sur le bien-être et l'autonomisation des femmes"</span><span class="op">,</span></span>
<span id="cb129-4562"><a href="#cb129-4562" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb129-4563"><a href="#cb129-4563" aria-hidden="true" tabindex="-1"></a>          <span class="dt">text</span><span class="op">:</span> {</span>
<span id="cb129-4564"><a href="#cb129-4564" aria-hidden="true" tabindex="-1"></a>            <span class="dt">en</span><span class="op">:</span> <span class="vs">`The [Female Empowerment Index](https://radiantearth.github.io/stac-browser/#/external/digital-atlas.s3.amazonaws.com/stac/public_stac/adaptive-capacity/women-and-gender/female-empowerment/collection.json) combines data on domestic violence, employment, reproductive healthcare, decision-making power, and family planning. The index, and the variables it is derived from, are from [Rettig, Erica (2022)](https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi:10.7910/DVN/8GJKYW) and are build using data from [DHS Program](https://dhsprogram.com). The individual variables and the Empowerment Index are based on the 2015 calculations. All of these have been normalized between 0 and 1, where 0 represents lowest empowerment and 1 represents highest empowerment`</span><span class="op">,</span></span>
<span id="cb129-4565"><a href="#cb129-4565" aria-hidden="true" tabindex="-1"></a>            <span class="dt">fr</span><span class="op">:</span> <span class="vs">`[L'Indice d'Autonomisation des Femmes](https://radiantearth.github.io/stac-browser/#/external/digital-atlas.s3.amazonaws.com/stac/public_stac/adaptive-capacity/women-and-gender/female-empowerment/collection.json?.language=fr) combine des données sur la violence domestique, l'emploi, les soins de santé reproductive, le pouvoir de décision et la planification familiale. L'indice, et les variables dont il est dérivé, proviennent de [Rettig, Erica (2022)](https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi:10.7910/DVN/8GJKYW) et sont construits à partir des données du [programme DHS](https://dhsprogram.com). Les variables individuelles et l'Indice d'Autonomisation sont basés sur les calculs de 2015. Tous ces éléments ont été normalisés entre 0 et 1, où 0 représente le plus faible niveau d'autonomisation et 1 le plus élevé.`</span><span class="op">,</span></span>
<span id="cb129-4566"><a href="#cb129-4566" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb129-4567"><a href="#cb129-4567" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb129-4568"><a href="#cb129-4568" aria-hidden="true" tabindex="-1"></a>        <span class="dt">poverty</span><span class="op">:</span> {</span>
<span id="cb129-4569"><a href="#cb129-4569" aria-hidden="true" tabindex="-1"></a>          <span class="dt">title</span><span class="op">:</span> {</span>
<span id="cb129-4570"><a href="#cb129-4570" aria-hidden="true" tabindex="-1"></a>            <span class="dt">en</span><span class="op">:</span> <span class="st">"Poverty"</span><span class="op">,</span></span>
<span id="cb129-4571"><a href="#cb129-4571" aria-hidden="true" tabindex="-1"></a>            <span class="dt">fr</span><span class="op">:</span> <span class="st">"Pauvreté"</span><span class="op">,</span></span>
<span id="cb129-4572"><a href="#cb129-4572" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb129-4573"><a href="#cb129-4573" aria-hidden="true" tabindex="-1"></a>          <span class="dt">text</span><span class="op">:</span> {</span>
<span id="cb129-4574"><a href="#cb129-4574" aria-hidden="true" tabindex="-1"></a>            <span class="dt">en</span><span class="op">:</span> <span class="fu">md</span><span class="vs">`Poverty data is derived from the [World Bank global subnational poverty atlas](https://datacatalog.worldbank.org/search/dataset/0042041/global_subnational_poverty_atlas_gsap) dataset.`</span><span class="op">,</span></span>
<span id="cb129-4575"><a href="#cb129-4575" aria-hidden="true" tabindex="-1"></a>            <span class="dt">fr</span><span class="op">:</span> <span class="fu">md</span><span class="vs">`Les données sur la pauvreté sont tirées de [l'ensemble de données de l'atlas mondial de la pauvreté infranationale de la Banque mondiale](https://datacatalog.worldbank.org/search/dataset/0042041/global_subnational_poverty_atlas_gsap).`</span><span class="op">,</span></span>
<span id="cb129-4576"><a href="#cb129-4576" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb129-4577"><a href="#cb129-4577" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb129-4578"><a href="#cb129-4578" aria-hidden="true" tabindex="-1"></a>        <span class="dt">education</span><span class="op">:</span> {</span>
<span id="cb129-4579"><a href="#cb129-4579" aria-hidden="true" tabindex="-1"></a>          <span class="dt">title</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Education"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Éducation"</span> }<span class="op">,</span></span>
<span id="cb129-4580"><a href="#cb129-4580" aria-hidden="true" tabindex="-1"></a>          <span class="dt">text</span><span class="op">:</span> {</span>
<span id="cb129-4581"><a href="#cb129-4581" aria-hidden="true" tabindex="-1"></a>            <span class="dt">en</span><span class="op">:</span> <span class="st">"Years of education is the mean male and female educational attainment from the [2005-2015 IHME Estimates for ages 15-49](https://ghdx.healthdata.org/record/ihme-data/africa-educational-attainment-geospatial-estimates-2000-2015)."</span><span class="op">,</span></span>
<span id="cb129-4582"><a href="#cb129-4582" aria-hidden="true" tabindex="-1"></a>            <span class="dt">fr</span><span class="op">:</span> <span class="st">"Les années d’éducation correspondent à la moyenne de la scolarité des hommes et des femmes, selon les estimations de l’IHME pour la période [2005-2015 pour les personnes âgées de 15 à 49 ans.](https://ghdx.healthdata.org/record/ihme-data/africa-educational-attainment-geospatial-estimates-2000-2015)"</span><span class="op">,</span></span>
<span id="cb129-4583"><a href="#cb129-4583" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb129-4584"><a href="#cb129-4584" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb129-4585"><a href="#cb129-4585" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4586"><a href="#cb129-4586" aria-hidden="true" tabindex="-1"></a>      <span class="dt">exposureDS</span><span class="op">:</span> {</span>
<span id="cb129-4587"><a href="#cb129-4587" aria-hidden="true" tabindex="-1"></a>        <span class="dt">title</span><span class="op">:</span> {</span>
<span id="cb129-4588"><a href="#cb129-4588" aria-hidden="true" tabindex="-1"></a>          <span class="dt">en</span><span class="op">:</span> <span class="st">"Exposure Datasets"</span><span class="op">,</span></span>
<span id="cb129-4589"><a href="#cb129-4589" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fr</span><span class="op">:</span> <span class="st">"Jeux de données sur l’exposition"</span><span class="op">,</span></span>
<span id="cb129-4590"><a href="#cb129-4590" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb129-4591"><a href="#cb129-4591" aria-hidden="true" tabindex="-1"></a>        <span class="dt">population</span><span class="op">:</span> {</span>
<span id="cb129-4592"><a href="#cb129-4592" aria-hidden="true" tabindex="-1"></a>          <span class="dt">title</span><span class="op">:</span> {</span>
<span id="cb129-4593"><a href="#cb129-4593" aria-hidden="true" tabindex="-1"></a>            <span class="dt">en</span><span class="op">:</span> <span class="st">"Population"</span><span class="op">,</span></span>
<span id="cb129-4594"><a href="#cb129-4594" aria-hidden="true" tabindex="-1"></a>            <span class="dt">fr</span><span class="op">:</span> <span class="st">"Population"</span><span class="op">,</span></span>
<span id="cb129-4595"><a href="#cb129-4595" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb129-4596"><a href="#cb129-4596" aria-hidden="true" tabindex="-1"></a>          <span class="dt">text</span><span class="op">:</span> {</span>
<span id="cb129-4597"><a href="#cb129-4597" aria-hidden="true" tabindex="-1"></a>            <span class="dt">en</span><span class="op">:</span> <span class="st">"Population data is from the WorldPop Unconstrained Global Mosaic for 2020. The population data is masked Africapolis data to separate the population groups into rural, urban, and total. The final raster dataset used is at a resolution of 0.083 degrees (5 arc minutes)."</span><span class="op">,</span></span>
<span id="cb129-4598"><a href="#cb129-4598" aria-hidden="true" tabindex="-1"></a>            <span class="dt">fr</span><span class="op">:</span> <span class="st">"Les données démographiques proviennent de la mosaïque mondiale sans contrainte WorldPop pour 2020. Les données démographiques sont des données Africapolis masquées pour séparer les groupes de population en zones rurales, urbaines et totales. Le jeu de données raster final utilisé a une résolution de 0,083 degré (5 minutes d'arc)."</span><span class="op">,</span></span>
<span id="cb129-4599"><a href="#cb129-4599" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb129-4600"><a href="#cb129-4600" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb129-4601"><a href="#cb129-4601" aria-hidden="true" tabindex="-1"></a>        <span class="dt">vopHA</span><span class="op">:</span> {</span>
<span id="cb129-4602"><a href="#cb129-4602" aria-hidden="true" tabindex="-1"></a>          <span class="dt">title</span><span class="op">:</span> {</span>
<span id="cb129-4603"><a href="#cb129-4603" aria-hidden="true" tabindex="-1"></a>            <span class="dt">en</span><span class="op">:</span> <span class="st">"Crop and Livestock data"</span><span class="op">,</span></span>
<span id="cb129-4604"><a href="#cb129-4604" aria-hidden="true" tabindex="-1"></a>            <span class="dt">fr</span><span class="op">:</span> <span class="st">"Données sur les cultures et le bétail"</span><span class="op">,</span></span>
<span id="cb129-4605"><a href="#cb129-4605" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb129-4606"><a href="#cb129-4606" aria-hidden="true" tabindex="-1"></a>          <span class="dt">text</span><span class="op">:</span> {</span>
<span id="cb129-4607"><a href="#cb129-4607" aria-hidden="true" tabindex="-1"></a>            <span class="dt">en</span><span class="op">:</span> <span class="fu">md</span><span class="vs">`[Crop value of production](https://radiantearth.github.io/stac-browser/#/external/digital-atlas.s3.amazonaws.com/stac/public_stac/exposure_catalog/mapspam2017/mapspam2017_vop_parquet/mapspam2017_vop_parquet.json) data comes from MapSPAM 2017 V2r3 (Spatial Production Allocation Model) where production values are multiplied by country specific FAOstat international crop prices in (2005 International Dollars). An [international dollar](https://en.wikipedia.org/wiki/International_dollar) (2005) is a hypothetical unit of currency that has the same purchasing power parity as the U.S. dollar had in the United States in 2005, allowing for comparison of what consumers can buy in different countries with the same amount of money. This dataset is an updated version of MapSPAM specifically tailored for this project. It includes bug fixes and incorporates country-specific values of production instead of global averages.</span></span>
<span id="cb129-4608"><a href="#cb129-4608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-4609"><a href="#cb129-4609" aria-hidden="true" tabindex="-1"></a><span class="vs">[Livestock value of production](https://radiantearth.github.io/stac-browser/#/external/digital-atlas.s3.amazonaws.com/stac/public_stac/exposure_catalog/GLW3_livestock/GLW3_livestock_vopPQ/GLW3_livestock_vopPQ.json) in 2005 International Dollars were provided by the authors of [Herrero et al. (2013)](https://www.pnas.org/doi/full/10.1073/pnas.1308149110/).`</span><span class="op">,</span></span>
<span id="cb129-4610"><a href="#cb129-4610" aria-hidden="true" tabindex="-1"></a>            <span class="dt">fr</span><span class="op">:</span> <span class="fu">md</span><span class="vs">`[Les données sur la valeur de la production des cultures](https://radiantearth.github.io/stac-browser/#/external/digital-atlas.s3.amazonaws.com/stac/public_stac/exposure_catalog/mapspam2017/mapspam2017_vop_parquet/mapspam2017_vop_parquet.json) proviennent de MapSPAM 2017 V2r3 (Modèle d'Allocation de Production Spatiale) où les valeurs de production sont multipliées par les prix internationaux des cultures de la FAOstat spécifiques à chaque pays en (dollars internationaux de 2005). Un [dollar international](https://en.wikipedia.org/wiki/International_dollar) (2005) est une unité monétaire hypothétique qui a la même parité de pouvoir d'achat que le dollar américain aux États-Unis en 2005, ce qui permet de comparer ce que les consommateurs peuvent acheter dans différents pays avec la même somme d'argent. Cet ensemble de données est une version mise à jour de MapSPAM spécialement conçue pour ce projet. Il comprend des corrections de bogues et incorpore des valeurs de production spécifiques à chaque pays au lieu de moyennes mondiales.</span></span>
<span id="cb129-4611"><a href="#cb129-4611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-4612"><a href="#cb129-4612" aria-hidden="true" tabindex="-1"></a><span class="vs">[La valeur de la production animale](https://radiantearth.github.io/stac-browser/#/external/digital-atlas.s3.amazonaws.com/stac/public_stac/exposure_catalog/GLW3_livestock/GLW3_livestock_vopPQ/GLW3_livestock_vopPQ.json) en dollars internationaux de 2005 a été fournie par les auteurs de [Herrero et al. (2013)](https://www.pnas.org/doi/full/10.1073/pnas.1308149110/).</span></span>
<span id="cb129-4613"><a href="#cb129-4613" aria-hidden="true" tabindex="-1"></a><span class="vs">`</span><span class="op">,</span></span>
<span id="cb129-4614"><a href="#cb129-4614" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb129-4615"><a href="#cb129-4615" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb129-4616"><a href="#cb129-4616" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4617"><a href="#cb129-4617" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Hazards</span><span class="op">:</span> {</span>
<span id="cb129-4618"><a href="#cb129-4618" aria-hidden="true" tabindex="-1"></a>        <span class="dt">title</span><span class="op">:</span> {</span>
<span id="cb129-4619"><a href="#cb129-4619" aria-hidden="true" tabindex="-1"></a>          <span class="dt">en</span><span class="op">:</span> <span class="st">"Historic and future climate hazards"</span><span class="op">,</span></span>
<span id="cb129-4620"><a href="#cb129-4620" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fr</span><span class="op">:</span> <span class="st">"Risques climatiques historiques et futurs"</span><span class="op">,</span></span>
<span id="cb129-4621"><a href="#cb129-4621" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb129-4622"><a href="#cb129-4622" aria-hidden="true" tabindex="-1"></a>        <span class="dt">text</span><span class="op">:</span> {</span>
<span id="cb129-4623"><a href="#cb129-4623" aria-hidden="true" tabindex="-1"></a>          <span class="dt">en</span><span class="op">:</span> <span class="fu">md</span><span class="vs">`[Climate hazards](https://radiantearth.github.io/stac-browser/#/external/digital-atlas.s3.amazonaws.com/stac/public_stac/hazard_catalog/catalog.json) were calculated using five datasets [CHIRPS](https://www.chc.ucsb.edu/data/chirps)/[CHIRTS](https://www.chc.ucsb.edu/data/chirtsdaily), [AgERA5](https://doi.org/10.24381/cds.6c68c9bb), [CMIP6 projections](https://github.com/SantanderMetGroup/ATLAS), and [crop calendars](https://zenodo.org/records/5062513). Using the R workflows mentioned below the hazard values were summarized for each 3 month window as well as the annual average and extracted by administrative boundaries to generate a tabular parquet dataset.`</span><span class="op">,</span></span>
<span id="cb129-4624"><a href="#cb129-4624" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fr</span><span class="op">:</span> <span class="fu">md</span><span class="vs">`[Les risques climatiques](https://radiantearth.github.io/stac-browser/#/external/digital-atlas.s3.amazonaws.com/stac/public_stac/hazard_catalog/catalog.json) ont été calculés à l'aide de cinq ensembles de données : [CHIRPS](https://www.chc.ucsb.edu/data/chirps)/[CHIRTS](https://www.chc.ucsb.edu/data/chirtsdaily), [AgERA5](https://doi.org/10.24381/cds.6c68c9bb), [projections CMIP6](https://github.com/SantanderMetGroup/ATLAS) et [calendriers de cultures](https://zenodo.org/records/5062513). À l'aide des flux de travail R mentionnés ci-dessous, les valeurs de risque ont été résumées pour chaque fenêtre de 3 mois ainsi que la moyenne annuelle et extraites par limites administratives pour générer un ensemble de données de parquet tabulaire.`</span><span class="op">,</span></span>
<span id="cb129-4625"><a href="#cb129-4625" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb129-4626"><a href="#cb129-4626" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4627"><a href="#cb129-4627" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb129-4628"><a href="#cb129-4628" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb129-4629"><a href="#cb129-4629" aria-hidden="true" tabindex="-1"></a>  <span class="dt">STAC</span><span class="op">:</span> {</span>
<span id="cb129-4630"><a href="#cb129-4630" aria-hidden="true" tabindex="-1"></a>    <span class="dt">title</span><span class="op">:</span> {</span>
<span id="cb129-4631"><a href="#cb129-4631" aria-hidden="true" tabindex="-1"></a>      <span class="dt">en</span><span class="op">:</span> <span class="st">"Learn about the data in the Atlas STAC"</span><span class="op">,</span></span>
<span id="cb129-4632"><a href="#cb129-4632" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fr</span><span class="op">:</span> <span class="st">"En savoir plus sur les données dans l'Atlas STAC"</span><span class="op">,</span></span>
<span id="cb129-4633"><a href="#cb129-4633" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb129-4634"><a href="#cb129-4634" aria-hidden="true" tabindex="-1"></a>    <span class="dt">text</span><span class="op">:</span> {</span>
<span id="cb129-4635"><a href="#cb129-4635" aria-hidden="true" tabindex="-1"></a>      <span class="dt">en</span><span class="op">:</span> <span class="vs">`Browse and access data through the [STAC (Spatio Temporal Asset Catalog)](https://radiantearth.github.io/stac-browser/#/external/digital-atlas.s3.amazonaws.com/stac/public_stac/catalog.json) for all datasets related to the Africa Agriculture Adaptation Atlas. The data provided in this notebook is limited to our processed and admin level datasets. However, raster data for all of our analysis can be found and downloaded using our STAC and S3 bucket. The below example will walk you through how to explore and access the data using the STAC in R or Python, or explore the data using the no-code interface.`</span><span class="op">,</span></span>
<span id="cb129-4636"><a href="#cb129-4636" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fr</span><span class="op">:</span> <span class="vs">`Parcourez et accédez aux données via le [STAC (Catalogue d'Actifs Spatio-Temporels)](https://radiantearth.github.io/stac-browser/#/external/digital-atlas.s3.amazonaws.com/stac/public_stac/catalog.json) pour tous les ensembles de données liés à l'Atlas Africain d'Adaptation Agricole. Les données fournies dans ce notebook se limitent à nos ensembles de données traités et au niveau administratif. Cependant, les données raster pour toutes nos analyses peuvent être trouvées et téléchargées en utilisant notre STAC et notre bucket S3. L'exemple ci-dessous vous guidera sur la manière d'explorer et d'accéder aux données en utilisant le STAC en R ou Python, ou d'explorer les données en utilisant l'interface sans code.`</span><span class="op">,</span></span>
<span id="cb129-4637"><a href="#cb129-4637" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb129-4638"><a href="#cb129-4638" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb129-4639"><a href="#cb129-4639" aria-hidden="true" tabindex="-1"></a>  <span class="dt">general</span><span class="op">:</span> {</span>
<span id="cb129-4640"><a href="#cb129-4640" aria-hidden="true" tabindex="-1"></a>    <span class="dt">hazards</span><span class="op">:</span> {</span>
<span id="cb129-4641"><a href="#cb129-4641" aria-hidden="true" tabindex="-1"></a>      <span class="dt">HSH_mean</span><span class="op">:</span> {</span>
<span id="cb129-4642"><a href="#cb129-4642" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Mean Human Heat Stress"</span><span class="op">,</span></span>
<span id="cb129-4643"><a href="#cb129-4643" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Stress thermique humain moyen"</span><span class="op">,</span></span>
<span id="cb129-4644"><a href="#cb129-4644" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4645"><a href="#cb129-4645" aria-hidden="true" tabindex="-1"></a>      <span class="dt">HSH_max</span><span class="op">:</span> {</span>
<span id="cb129-4646"><a href="#cb129-4646" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Max Human Heat Stress"</span><span class="op">,</span></span>
<span id="cb129-4647"><a href="#cb129-4647" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Stress thermique humain maximal"</span><span class="op">,</span></span>
<span id="cb129-4648"><a href="#cb129-4648" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4649"><a href="#cb129-4649" aria-hidden="true" tabindex="-1"></a>      <span class="dt">NDWL0</span><span class="op">:</span> {</span>
<span id="cb129-4650"><a href="#cb129-4650" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Number of Waterlogging Days"</span><span class="op">,</span></span>
<span id="cb129-4651"><a href="#cb129-4651" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Nombre de jours de saturation en eau"</span><span class="op">,</span></span>
<span id="cb129-4652"><a href="#cb129-4652" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4653"><a href="#cb129-4653" aria-hidden="true" tabindex="-1"></a>      <span class="dt">NDWS</span><span class="op">:</span> {</span>
<span id="cb129-4654"><a href="#cb129-4654" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Number of Days of Water Stress"</span><span class="op">,</span></span>
<span id="cb129-4655"><a href="#cb129-4655" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Nombre de jours de stress hydrique"</span><span class="op">,</span></span>
<span id="cb129-4656"><a href="#cb129-4656" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4657"><a href="#cb129-4657" aria-hidden="true" tabindex="-1"></a>      <span class="dt">NTx35</span><span class="op">:</span> {</span>
<span id="cb129-4658"><a href="#cb129-4658" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Number of Heat Stress Days for Maize"</span><span class="op">,</span></span>
<span id="cb129-4659"><a href="#cb129-4659" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Nombre de jours de stress thermique pour le maïs"</span><span class="op">,</span></span>
<span id="cb129-4660"><a href="#cb129-4660" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4661"><a href="#cb129-4661" aria-hidden="true" tabindex="-1"></a>      <span class="dt">NTx40</span><span class="op">:</span> {</span>
<span id="cb129-4662"><a href="#cb129-4662" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Number of Heat Stress Days for Generic Crops"</span><span class="op">,</span></span>
<span id="cb129-4663"><a href="#cb129-4663" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Nombre de jours de stress thermique pour les cultures génériques"</span><span class="op">,</span></span>
<span id="cb129-4664"><a href="#cb129-4664" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4665"><a href="#cb129-4665" aria-hidden="true" tabindex="-1"></a>      <span class="dt">TAI</span><span class="op">:</span> {</span>
<span id="cb129-4666"><a href="#cb129-4666" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Thornthwaite's Aridity Index"</span><span class="op">,</span></span>
<span id="cb129-4667"><a href="#cb129-4667" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Indice d'Aridité de Thornthwaite"</span><span class="op">,</span></span>
<span id="cb129-4668"><a href="#cb129-4668" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4669"><a href="#cb129-4669" aria-hidden="true" tabindex="-1"></a>      <span class="dt">THI_max</span><span class="op">:</span> {</span>
<span id="cb129-4670"><a href="#cb129-4670" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Max Cattle Thermal Humidity Index"</span><span class="op">,</span></span>
<span id="cb129-4671"><a href="#cb129-4671" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Indice de Température-Humidité Maximal pour le Bétail"</span><span class="op">,</span></span>
<span id="cb129-4672"><a href="#cb129-4672" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4673"><a href="#cb129-4673" aria-hidden="true" tabindex="-1"></a>      <span class="dt">THI_mean</span><span class="op">:</span> {</span>
<span id="cb129-4674"><a href="#cb129-4674" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Mean Cattle Thermal Humidity Index"</span><span class="op">,</span></span>
<span id="cb129-4675"><a href="#cb129-4675" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Indice de Température-Humidité Moyen pour le Bétail "</span><span class="op">,</span></span>
<span id="cb129-4676"><a href="#cb129-4676" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4677"><a href="#cb129-4677" aria-hidden="true" tabindex="-1"></a>      <span class="dt">TAVG</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Average Temperature"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Température Moyenne"</span> }<span class="op">,</span></span>
<span id="cb129-4678"><a href="#cb129-4678" aria-hidden="true" tabindex="-1"></a>      <span class="dt">PTOT</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Total Precipitation"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Précipitation Totale"</span> }<span class="op">,</span></span>
<span id="cb129-4679"><a href="#cb129-4679" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb129-4680"><a href="#cb129-4680" aria-hidden="true" tabindex="-1"></a>    <span class="dt">commodities</span><span class="op">:</span> {</span>
<span id="cb129-4681"><a href="#cb129-4681" aria-hidden="true" tabindex="-1"></a>      <span class="dt">wheat</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Wheat"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Blé"</span> }<span class="op">,</span></span>
<span id="cb129-4682"><a href="#cb129-4682" aria-hidden="true" tabindex="-1"></a>      <span class="dt">rice</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Rice"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Riz"</span> }<span class="op">,</span></span>
<span id="cb129-4683"><a href="#cb129-4683" aria-hidden="true" tabindex="-1"></a>      <span class="dt">maize</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Maize"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Maïs"</span> }<span class="op">,</span></span>
<span id="cb129-4684"><a href="#cb129-4684" aria-hidden="true" tabindex="-1"></a>      <span class="dt">barley</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Barley"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Orge"</span> }<span class="op">,</span></span>
<span id="cb129-4685"><a href="#cb129-4685" aria-hidden="true" tabindex="-1"></a>      <span class="st">"pearl millet"</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Pearl Millet"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Millet Perlé"</span> }<span class="op">,</span></span>
<span id="cb129-4686"><a href="#cb129-4686" aria-hidden="true" tabindex="-1"></a>      <span class="st">"small millet"</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Small Millet"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Petit Millet"</span> }<span class="op">,</span></span>
<span id="cb129-4687"><a href="#cb129-4687" aria-hidden="true" tabindex="-1"></a>      <span class="dt">sorghum</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Sorghum"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Sorgho"</span> }<span class="op">,</span></span>
<span id="cb129-4688"><a href="#cb129-4688" aria-hidden="true" tabindex="-1"></a>      <span class="dt">potato</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Potato"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Pomme de Terre"</span> }<span class="op">,</span></span>
<span id="cb129-4689"><a href="#cb129-4689" aria-hidden="true" tabindex="-1"></a>      <span class="st">"sweet potato"</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Sweet Potato"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Patate Douce"</span> }<span class="op">,</span></span>
<span id="cb129-4690"><a href="#cb129-4690" aria-hidden="true" tabindex="-1"></a>      <span class="dt">yams</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Yams"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Igname"</span> }<span class="op">,</span></span>
<span id="cb129-4691"><a href="#cb129-4691" aria-hidden="true" tabindex="-1"></a>      <span class="dt">cassava</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Cassava"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Manioc"</span> }<span class="op">,</span></span>
<span id="cb129-4692"><a href="#cb129-4692" aria-hidden="true" tabindex="-1"></a>      <span class="dt">bean</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Bean"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Haricot"</span> }<span class="op">,</span></span>
<span id="cb129-4693"><a href="#cb129-4693" aria-hidden="true" tabindex="-1"></a>      <span class="dt">chickpea</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Chickpea"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Pois Chiche"</span> }<span class="op">,</span></span>
<span id="cb129-4694"><a href="#cb129-4694" aria-hidden="true" tabindex="-1"></a>      <span class="dt">cowpea</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Cowpea"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Niébé"</span> }<span class="op">,</span></span>
<span id="cb129-4695"><a href="#cb129-4695" aria-hidden="true" tabindex="-1"></a>      <span class="dt">pigeonpea</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Pigeonpea"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Pois Cajan"</span> }<span class="op">,</span></span>
<span id="cb129-4696"><a href="#cb129-4696" aria-hidden="true" tabindex="-1"></a>      <span class="dt">lentil</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Lentil"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Lentille"</span> }<span class="op">,</span></span>
<span id="cb129-4697"><a href="#cb129-4697" aria-hidden="true" tabindex="-1"></a>      <span class="dt">soybean</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Soybean"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Soja"</span> }<span class="op">,</span></span>
<span id="cb129-4698"><a href="#cb129-4698" aria-hidden="true" tabindex="-1"></a>      <span class="dt">groundnut</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Groundnut"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Arachide"</span> }<span class="op">,</span></span>
<span id="cb129-4699"><a href="#cb129-4699" aria-hidden="true" tabindex="-1"></a>      <span class="dt">coconut</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Coconut"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Noix de Coco"</span> }<span class="op">,</span></span>
<span id="cb129-4700"><a href="#cb129-4700" aria-hidden="true" tabindex="-1"></a>      <span class="dt">oilpalm</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Oil Palm"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Palmier à Huile"</span> }<span class="op">,</span></span>
<span id="cb129-4701"><a href="#cb129-4701" aria-hidden="true" tabindex="-1"></a>      <span class="dt">sunflower</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Sunflower"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Tournesol"</span> }<span class="op">,</span></span>
<span id="cb129-4702"><a href="#cb129-4702" aria-hidden="true" tabindex="-1"></a>      <span class="dt">rapeseed</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Rapeseed"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Colza"</span> }<span class="op">,</span></span>
<span id="cb129-4703"><a href="#cb129-4703" aria-hidden="true" tabindex="-1"></a>      <span class="dt">sesameseed</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Sesame Seed"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Graines de Sésame"</span> }<span class="op">,</span></span>
<span id="cb129-4704"><a href="#cb129-4704" aria-hidden="true" tabindex="-1"></a>      <span class="dt">sugarcane</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Sugarcane"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Canne à Sucre"</span> }<span class="op">,</span></span>
<span id="cb129-4705"><a href="#cb129-4705" aria-hidden="true" tabindex="-1"></a>      <span class="dt">sugarbeet</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Sugarbeet"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Betterave à Sucre"</span> }<span class="op">,</span></span>
<span id="cb129-4706"><a href="#cb129-4706" aria-hidden="true" tabindex="-1"></a>      <span class="dt">cotton</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Cotton"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Coton"</span> }<span class="op">,</span></span>
<span id="cb129-4707"><a href="#cb129-4707" aria-hidden="true" tabindex="-1"></a>      <span class="st">"arabica coffee"</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Arabica Coffee"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Café Arabica"</span> }<span class="op">,</span></span>
<span id="cb129-4708"><a href="#cb129-4708" aria-hidden="true" tabindex="-1"></a>      <span class="st">"robusta coffee"</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Robusta Coffee"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Café Robusta"</span> }<span class="op">,</span></span>
<span id="cb129-4709"><a href="#cb129-4709" aria-hidden="true" tabindex="-1"></a>      <span class="dt">cocoa</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Cocoa"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Cocoa"</span> }<span class="op">,</span></span>
<span id="cb129-4710"><a href="#cb129-4710" aria-hidden="true" tabindex="-1"></a>      <span class="dt">tea</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Tea"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"thé"</span> }<span class="op">,</span></span>
<span id="cb129-4711"><a href="#cb129-4711" aria-hidden="true" tabindex="-1"></a>      <span class="dt">tobacco</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Tobacco"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Tabac"</span> }<span class="op">,</span></span>
<span id="cb129-4712"><a href="#cb129-4712" aria-hidden="true" tabindex="-1"></a>      <span class="dt">banana</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Banana"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Banane"</span> }<span class="op">,</span></span>
<span id="cb129-4713"><a href="#cb129-4713" aria-hidden="true" tabindex="-1"></a>      <span class="dt">plantain</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Plantain"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Banane Plantain"</span> }<span class="op">,</span></span>
<span id="cb129-4714"><a href="#cb129-4714" aria-hidden="true" tabindex="-1"></a>      <span class="dt">cattle_tropical</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Tropical Cattle"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Bovins tropicaux"</span> }<span class="op">,</span></span>
<span id="cb129-4715"><a href="#cb129-4715" aria-hidden="true" tabindex="-1"></a>      <span class="dt">poultry_tropical</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Tropical Poultry"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Volaille tropicale"</span> }<span class="op">,</span></span>
<span id="cb129-4716"><a href="#cb129-4716" aria-hidden="true" tabindex="-1"></a>      <span class="dt">pigs_tropical</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Tropical Pigs"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Porcs tropicaux"</span> }<span class="op">,</span></span>
<span id="cb129-4717"><a href="#cb129-4717" aria-hidden="true" tabindex="-1"></a>      <span class="dt">sheep_tropical</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Tropical Sheep"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Moutons tropicaux"</span> }<span class="op">,</span></span>
<span id="cb129-4718"><a href="#cb129-4718" aria-hidden="true" tabindex="-1"></a>      <span class="dt">goats_tropical</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Tropical Goats"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Chèvres tropicales"</span> }<span class="op">,</span></span>
<span id="cb129-4719"><a href="#cb129-4719" aria-hidden="true" tabindex="-1"></a>      <span class="dt">cattle_highland</span><span class="op">:</span> {</span>
<span id="cb129-4720"><a href="#cb129-4720" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Highland Cattle"</span><span class="op">,</span></span>
<span id="cb129-4721"><a href="#cb129-4721" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Bovins des hauts plateaux"</span><span class="op">,</span></span>
<span id="cb129-4722"><a href="#cb129-4722" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4723"><a href="#cb129-4723" aria-hidden="true" tabindex="-1"></a>      <span class="dt">poultry_highland</span><span class="op">:</span> {</span>
<span id="cb129-4724"><a href="#cb129-4724" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Highland Poultry"</span><span class="op">,</span></span>
<span id="cb129-4725"><a href="#cb129-4725" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Volaille des hauts plateaux"</span><span class="op">,</span></span>
<span id="cb129-4726"><a href="#cb129-4726" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4727"><a href="#cb129-4727" aria-hidden="true" tabindex="-1"></a>      <span class="dt">pigs_highland</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Highland Pigs"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Porcs des hauts plateaux"</span> }<span class="op">,</span></span>
<span id="cb129-4728"><a href="#cb129-4728" aria-hidden="true" tabindex="-1"></a>      <span class="dt">sheep_highland</span><span class="op">:</span> {</span>
<span id="cb129-4729"><a href="#cb129-4729" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Highland Sheep"</span><span class="op">,</span></span>
<span id="cb129-4730"><a href="#cb129-4730" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Moutons des hauts plateaux"</span><span class="op">,</span></span>
<span id="cb129-4731"><a href="#cb129-4731" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4732"><a href="#cb129-4732" aria-hidden="true" tabindex="-1"></a>      <span class="dt">goats_highland</span><span class="op">:</span> {</span>
<span id="cb129-4733"><a href="#cb129-4733" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Highland Goats"</span><span class="op">,</span></span>
<span id="cb129-4734"><a href="#cb129-4734" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Chèvres des hauts plateaux"</span><span class="op">,</span></span>
<span id="cb129-4735"><a href="#cb129-4735" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4736"><a href="#cb129-4736" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb129-4737"><a href="#cb129-4737" aria-hidden="true" tabindex="-1"></a>    <span class="dt">adminlevels</span><span class="op">:</span> {</span>
<span id="cb129-4738"><a href="#cb129-4738" aria-hidden="true" tabindex="-1"></a>      <span class="dt">admin0_name</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Country"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Pays"</span> }<span class="op">,</span></span>
<span id="cb129-4739"><a href="#cb129-4739" aria-hidden="true" tabindex="-1"></a>      <span class="dt">admin1_name</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Region"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Région"</span> }<span class="op">,</span></span>
<span id="cb129-4740"><a href="#cb129-4740" aria-hidden="true" tabindex="-1"></a>      <span class="dt">admin2_name</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Sub-Region"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Sous-région"</span> }<span class="op">,</span></span>
<span id="cb129-4741"><a href="#cb129-4741" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb129-4742"><a href="#cb129-4742" aria-hidden="true" tabindex="-1"></a>    <span class="dt">levels</span><span class="op">:</span> {</span>
<span id="cb129-4743"><a href="#cb129-4743" aria-hidden="true" tabindex="-1"></a>      <span class="dt">low</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Low"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Faible"</span> }<span class="op">,</span></span>
<span id="cb129-4744"><a href="#cb129-4744" aria-hidden="true" tabindex="-1"></a>      <span class="dt">moderate</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Moderate"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Modéré"</span> }<span class="op">,</span></span>
<span id="cb129-4745"><a href="#cb129-4745" aria-hidden="true" tabindex="-1"></a>      <span class="dt">severe</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Severe"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Sévère"</span> }<span class="op">,</span></span>
<span id="cb129-4746"><a href="#cb129-4746" aria-hidden="true" tabindex="-1"></a>      <span class="dt">extreme</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Extreme"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Extrême"</span> }<span class="op">,</span></span>
<span id="cb129-4747"><a href="#cb129-4747" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Vextreme</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Very Extreme"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Très Extrême"</span> }<span class="op">,</span></span>
<span id="cb129-4748"><a href="#cb129-4748" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb129-4749"><a href="#cb129-4749" aria-hidden="true" tabindex="-1"></a>    <span class="dt">search</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Search"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Rechercher"</span> }<span class="op">,</span></span>
<span id="cb129-4750"><a href="#cb129-4750" aria-hidden="true" tabindex="-1"></a>    <span class="dt">acVars</span><span class="op">:</span> {</span>
<span id="cb129-4751"><a href="#cb129-4751" aria-hidden="true" tabindex="-1"></a>      <span class="dt">domestic_violence</span><span class="op">:</span> {</span>
<span id="cb129-4752"><a href="#cb129-4752" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Domestic Safety"</span><span class="op">,</span></span>
<span id="cb129-4753"><a href="#cb129-4753" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Sécurité Domestique"</span><span class="op">,</span></span>
<span id="cb129-4754"><a href="#cb129-4754" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4755"><a href="#cb129-4755" aria-hidden="true" tabindex="-1"></a>      <span class="dt">gender_equity</span><span class="op">:</span> {</span>
<span id="cb129-4756"><a href="#cb129-4756" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Gender Equity"</span><span class="op">,</span></span>
<span id="cb129-4757"><a href="#cb129-4757" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Égalité des sexes"</span><span class="op">,</span></span>
<span id="cb129-4758"><a href="#cb129-4758" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4759"><a href="#cb129-4759" aria-hidden="true" tabindex="-1"></a>      <span class="dt">decision_making</span><span class="op">:</span> {</span>
<span id="cb129-4760"><a href="#cb129-4760" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Decision Making Power"</span><span class="op">,</span></span>
<span id="cb129-4761"><a href="#cb129-4761" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Pouvoir de décision"</span><span class="op">,</span></span>
<span id="cb129-4762"><a href="#cb129-4762" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4763"><a href="#cb129-4763" aria-hidden="true" tabindex="-1"></a>      <span class="dt">education</span><span class="op">:</span> {</span>
<span id="cb129-4764"><a href="#cb129-4764" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Womens Education"</span><span class="op">,</span></span>
<span id="cb129-4765"><a href="#cb129-4765" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Éducation des femmes"</span><span class="op">,</span></span>
<span id="cb129-4766"><a href="#cb129-4766" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4767"><a href="#cb129-4767" aria-hidden="true" tabindex="-1"></a>      <span class="dt">family_planning</span><span class="op">:</span> {</span>
<span id="cb129-4768"><a href="#cb129-4768" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Access to Family Planning"</span><span class="op">,</span></span>
<span id="cb129-4769"><a href="#cb129-4769" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Accès à la planification familiale"</span><span class="op">,</span></span>
<span id="cb129-4770"><a href="#cb129-4770" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4771"><a href="#cb129-4771" aria-hidden="true" tabindex="-1"></a>      <span class="dt">reproductive_health</span><span class="op">:</span> {</span>
<span id="cb129-4772"><a href="#cb129-4772" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Reproductive Health"</span><span class="op">,</span></span>
<span id="cb129-4773"><a href="#cb129-4773" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Santé reproductive"</span><span class="op">,</span></span>
<span id="cb129-4774"><a href="#cb129-4774" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4775"><a href="#cb129-4775" aria-hidden="true" tabindex="-1"></a>      <span class="dt">GSAP_poor215</span><span class="op">:</span> {</span>
<span id="cb129-4776"><a href="#cb129-4776" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"% population under $2.15"</span><span class="op">,</span></span>
<span id="cb129-4777"><a href="#cb129-4777" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"% de la population sous 2,15$"</span><span class="op">,</span></span>
<span id="cb129-4778"><a href="#cb129-4778" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4779"><a href="#cb129-4779" aria-hidden="true" tabindex="-1"></a>      <span class="dt">GSAP_poor365</span><span class="op">:</span> {</span>
<span id="cb129-4780"><a href="#cb129-4780" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"% population under $3.65"</span><span class="op">,</span></span>
<span id="cb129-4781"><a href="#cb129-4781" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"% de la population sous 3,65$"</span><span class="op">,</span></span>
<span id="cb129-4782"><a href="#cb129-4782" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4783"><a href="#cb129-4783" aria-hidden="true" tabindex="-1"></a>      <span class="dt">GSAP_poor685</span><span class="op">:</span> {</span>
<span id="cb129-4784"><a href="#cb129-4784" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"% population under $6.85"</span><span class="op">,</span></span>
<span id="cb129-4785"><a href="#cb129-4785" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"% de la population sous 6,85$"</span><span class="op">,</span></span>
<span id="cb129-4786"><a href="#cb129-4786" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4787"><a href="#cb129-4787" aria-hidden="true" tabindex="-1"></a>      <span class="dt">educationYrs</span><span class="op">:</span> {</span>
<span id="cb129-4788"><a href="#cb129-4788" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Education(Yrs)"</span><span class="op">,</span></span>
<span id="cb129-4789"><a href="#cb129-4789" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Éducation (années)"</span><span class="op">,</span></span>
<span id="cb129-4790"><a href="#cb129-4790" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4791"><a href="#cb129-4791" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb129-4792"><a href="#cb129-4792" aria-hidden="true" tabindex="-1"></a>    <span class="dt">adminNames</span><span class="op">:</span> {</span>
<span id="cb129-4793"><a href="#cb129-4793" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Full Country"</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Full Country"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Pays Entier"</span> }<span class="op">,</span></span>
<span id="cb129-4794"><a href="#cb129-4794" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Full Region"</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Full Region"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Région complète"</span> }<span class="op">,</span></span>
<span id="cb129-4795"><a href="#cb129-4795" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Angola</span><span class="op">:</span> {</span>
<span id="cb129-4796"><a href="#cb129-4796" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Angola"</span><span class="op">,</span></span>
<span id="cb129-4797"><a href="#cb129-4797" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Angola"</span><span class="op">,</span></span>
<span id="cb129-4798"><a href="#cb129-4798" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4799"><a href="#cb129-4799" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Benin</span><span class="op">:</span> {</span>
<span id="cb129-4800"><a href="#cb129-4800" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Benin"</span><span class="op">,</span></span>
<span id="cb129-4801"><a href="#cb129-4801" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Bénin"</span><span class="op">,</span></span>
<span id="cb129-4802"><a href="#cb129-4802" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4803"><a href="#cb129-4803" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Botswana</span><span class="op">:</span> {</span>
<span id="cb129-4804"><a href="#cb129-4804" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Botswana"</span><span class="op">,</span></span>
<span id="cb129-4805"><a href="#cb129-4805" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Botswana"</span><span class="op">,</span></span>
<span id="cb129-4806"><a href="#cb129-4806" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4807"><a href="#cb129-4807" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Burkina Faso"</span><span class="op">:</span> {</span>
<span id="cb129-4808"><a href="#cb129-4808" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Burkina Faso"</span><span class="op">,</span></span>
<span id="cb129-4809"><a href="#cb129-4809" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Burkina Faso"</span><span class="op">,</span></span>
<span id="cb129-4810"><a href="#cb129-4810" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4811"><a href="#cb129-4811" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Burundi</span><span class="op">:</span> {</span>
<span id="cb129-4812"><a href="#cb129-4812" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Burundi"</span><span class="op">,</span></span>
<span id="cb129-4813"><a href="#cb129-4813" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Burundi"</span><span class="op">,</span></span>
<span id="cb129-4814"><a href="#cb129-4814" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4815"><a href="#cb129-4815" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Cameroon</span><span class="op">:</span> {</span>
<span id="cb129-4816"><a href="#cb129-4816" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Cameroon"</span><span class="op">,</span></span>
<span id="cb129-4817"><a href="#cb129-4817" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Cameroun"</span><span class="op">,</span></span>
<span id="cb129-4818"><a href="#cb129-4818" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4819"><a href="#cb129-4819" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Central African Republic"</span><span class="op">:</span> {</span>
<span id="cb129-4820"><a href="#cb129-4820" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Central African Republic"</span><span class="op">,</span></span>
<span id="cb129-4821"><a href="#cb129-4821" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"République Centrafricaine"</span><span class="op">,</span></span>
<span id="cb129-4822"><a href="#cb129-4822" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4823"><a href="#cb129-4823" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Chad</span><span class="op">:</span> {</span>
<span id="cb129-4824"><a href="#cb129-4824" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Chad"</span><span class="op">,</span></span>
<span id="cb129-4825"><a href="#cb129-4825" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Tchad"</span><span class="op">,</span></span>
<span id="cb129-4826"><a href="#cb129-4826" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4827"><a href="#cb129-4827" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Congo - Brazzaville"</span><span class="op">:</span> {</span>
<span id="cb129-4828"><a href="#cb129-4828" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Congo - Brazzaville"</span><span class="op">,</span></span>
<span id="cb129-4829"><a href="#cb129-4829" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Congo - Brazzaville"</span><span class="op">,</span></span>
<span id="cb129-4830"><a href="#cb129-4830" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4831"><a href="#cb129-4831" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Congo - Kinshasa"</span><span class="op">:</span> {</span>
<span id="cb129-4832"><a href="#cb129-4832" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Congo - Kinshasa"</span><span class="op">,</span></span>
<span id="cb129-4833"><a href="#cb129-4833" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Congo - Kinshasa"</span><span class="op">,</span></span>
<span id="cb129-4834"><a href="#cb129-4834" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4835"><a href="#cb129-4835" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Côte d’Ivoire"</span><span class="op">:</span> {</span>
<span id="cb129-4836"><a href="#cb129-4836" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Côte d’Ivoire"</span><span class="op">,</span></span>
<span id="cb129-4837"><a href="#cb129-4837" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Côte d’Ivoire"</span><span class="op">,</span></span>
<span id="cb129-4838"><a href="#cb129-4838" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4839"><a href="#cb129-4839" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Djibouti</span><span class="op">:</span> {</span>
<span id="cb129-4840"><a href="#cb129-4840" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Djibouti"</span><span class="op">,</span></span>
<span id="cb129-4841"><a href="#cb129-4841" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Djibouti"</span><span class="op">,</span></span>
<span id="cb129-4842"><a href="#cb129-4842" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4843"><a href="#cb129-4843" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Equatorial Guinea"</span><span class="op">:</span> {</span>
<span id="cb129-4844"><a href="#cb129-4844" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Equatorial Guinea"</span><span class="op">,</span></span>
<span id="cb129-4845"><a href="#cb129-4845" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Guinée Équatoriale"</span><span class="op">,</span></span>
<span id="cb129-4846"><a href="#cb129-4846" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4847"><a href="#cb129-4847" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Eritrea</span><span class="op">:</span> {</span>
<span id="cb129-4848"><a href="#cb129-4848" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Eritrea"</span><span class="op">,</span></span>
<span id="cb129-4849"><a href="#cb129-4849" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Érythrée"</span><span class="op">,</span></span>
<span id="cb129-4850"><a href="#cb129-4850" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4851"><a href="#cb129-4851" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Eswatini</span><span class="op">:</span> {</span>
<span id="cb129-4852"><a href="#cb129-4852" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Eswatini"</span><span class="op">,</span></span>
<span id="cb129-4853"><a href="#cb129-4853" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Eswatini"</span><span class="op">,</span></span>
<span id="cb129-4854"><a href="#cb129-4854" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4855"><a href="#cb129-4855" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Ethiopia</span><span class="op">:</span> {</span>
<span id="cb129-4856"><a href="#cb129-4856" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Ethiopia"</span><span class="op">,</span></span>
<span id="cb129-4857"><a href="#cb129-4857" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Éthiopie"</span><span class="op">,</span></span>
<span id="cb129-4858"><a href="#cb129-4858" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4859"><a href="#cb129-4859" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Gabon</span><span class="op">:</span> {</span>
<span id="cb129-4860"><a href="#cb129-4860" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Gabon"</span><span class="op">,</span></span>
<span id="cb129-4861"><a href="#cb129-4861" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Gabon"</span><span class="op">,</span></span>
<span id="cb129-4862"><a href="#cb129-4862" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4863"><a href="#cb129-4863" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Gambia</span><span class="op">:</span> {</span>
<span id="cb129-4864"><a href="#cb129-4864" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Gambia"</span><span class="op">,</span></span>
<span id="cb129-4865"><a href="#cb129-4865" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Gambie"</span><span class="op">,</span></span>
<span id="cb129-4866"><a href="#cb129-4866" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4867"><a href="#cb129-4867" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Ghana</span><span class="op">:</span> {</span>
<span id="cb129-4868"><a href="#cb129-4868" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Ghana"</span><span class="op">,</span></span>
<span id="cb129-4869"><a href="#cb129-4869" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Ghana"</span><span class="op">,</span></span>
<span id="cb129-4870"><a href="#cb129-4870" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4871"><a href="#cb129-4871" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Guinea</span><span class="op">:</span> {</span>
<span id="cb129-4872"><a href="#cb129-4872" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Guinea"</span><span class="op">,</span></span>
<span id="cb129-4873"><a href="#cb129-4873" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Guinée"</span><span class="op">,</span></span>
<span id="cb129-4874"><a href="#cb129-4874" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4875"><a href="#cb129-4875" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Guinea-Bissau"</span><span class="op">:</span> {</span>
<span id="cb129-4876"><a href="#cb129-4876" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Guinea-Bissau"</span><span class="op">,</span></span>
<span id="cb129-4877"><a href="#cb129-4877" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Guinée-Bissau"</span><span class="op">,</span></span>
<span id="cb129-4878"><a href="#cb129-4878" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4879"><a href="#cb129-4879" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Kenya</span><span class="op">:</span> {</span>
<span id="cb129-4880"><a href="#cb129-4880" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Kenya"</span><span class="op">,</span></span>
<span id="cb129-4881"><a href="#cb129-4881" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Kenya"</span><span class="op">,</span></span>
<span id="cb129-4882"><a href="#cb129-4882" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4883"><a href="#cb129-4883" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Lesotho</span><span class="op">:</span> {</span>
<span id="cb129-4884"><a href="#cb129-4884" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Lesotho"</span><span class="op">,</span></span>
<span id="cb129-4885"><a href="#cb129-4885" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Lesotho"</span><span class="op">,</span></span>
<span id="cb129-4886"><a href="#cb129-4886" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4887"><a href="#cb129-4887" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Liberia</span><span class="op">:</span> {</span>
<span id="cb129-4888"><a href="#cb129-4888" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Liberia"</span><span class="op">,</span></span>
<span id="cb129-4889"><a href="#cb129-4889" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Libéria"</span><span class="op">,</span></span>
<span id="cb129-4890"><a href="#cb129-4890" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4891"><a href="#cb129-4891" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Madagascar</span><span class="op">:</span> {</span>
<span id="cb129-4892"><a href="#cb129-4892" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Madagascar"</span><span class="op">,</span></span>
<span id="cb129-4893"><a href="#cb129-4893" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Madagascar"</span><span class="op">,</span></span>
<span id="cb129-4894"><a href="#cb129-4894" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4895"><a href="#cb129-4895" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Malawi</span><span class="op">:</span> {</span>
<span id="cb129-4896"><a href="#cb129-4896" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Malawi"</span><span class="op">,</span></span>
<span id="cb129-4897"><a href="#cb129-4897" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Malawi"</span><span class="op">,</span></span>
<span id="cb129-4898"><a href="#cb129-4898" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4899"><a href="#cb129-4899" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Mali</span><span class="op">:</span> {</span>
<span id="cb129-4900"><a href="#cb129-4900" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Mali"</span><span class="op">,</span></span>
<span id="cb129-4901"><a href="#cb129-4901" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Mali"</span><span class="op">,</span></span>
<span id="cb129-4902"><a href="#cb129-4902" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4903"><a href="#cb129-4903" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Mauritania</span><span class="op">:</span> {</span>
<span id="cb129-4904"><a href="#cb129-4904" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Mauritania"</span><span class="op">,</span></span>
<span id="cb129-4905"><a href="#cb129-4905" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Mauritanie"</span><span class="op">,</span></span>
<span id="cb129-4906"><a href="#cb129-4906" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4907"><a href="#cb129-4907" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Mozambique</span><span class="op">:</span> {</span>
<span id="cb129-4908"><a href="#cb129-4908" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Mozambique"</span><span class="op">,</span></span>
<span id="cb129-4909"><a href="#cb129-4909" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Mozambique"</span><span class="op">,</span></span>
<span id="cb129-4910"><a href="#cb129-4910" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4911"><a href="#cb129-4911" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Namibia</span><span class="op">:</span> {</span>
<span id="cb129-4912"><a href="#cb129-4912" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Namibia"</span><span class="op">,</span></span>
<span id="cb129-4913"><a href="#cb129-4913" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Namibie"</span><span class="op">,</span></span>
<span id="cb129-4914"><a href="#cb129-4914" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4915"><a href="#cb129-4915" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Niger</span><span class="op">:</span> {</span>
<span id="cb129-4916"><a href="#cb129-4916" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Niger"</span><span class="op">,</span></span>
<span id="cb129-4917"><a href="#cb129-4917" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Niger"</span><span class="op">,</span></span>
<span id="cb129-4918"><a href="#cb129-4918" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4919"><a href="#cb129-4919" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Nigeria</span><span class="op">:</span> {</span>
<span id="cb129-4920"><a href="#cb129-4920" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Nigeria"</span><span class="op">,</span></span>
<span id="cb129-4921"><a href="#cb129-4921" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Nigéria"</span><span class="op">,</span></span>
<span id="cb129-4922"><a href="#cb129-4922" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4923"><a href="#cb129-4923" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Rwanda</span><span class="op">:</span> {</span>
<span id="cb129-4924"><a href="#cb129-4924" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Rwanda"</span><span class="op">,</span></span>
<span id="cb129-4925"><a href="#cb129-4925" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Rwanda"</span><span class="op">,</span></span>
<span id="cb129-4926"><a href="#cb129-4926" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4927"><a href="#cb129-4927" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Senegal</span><span class="op">:</span> {</span>
<span id="cb129-4928"><a href="#cb129-4928" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Senegal"</span><span class="op">,</span></span>
<span id="cb129-4929"><a href="#cb129-4929" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Sénégal"</span><span class="op">,</span></span>
<span id="cb129-4930"><a href="#cb129-4930" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4931"><a href="#cb129-4931" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Sierra Leone"</span><span class="op">:</span> {</span>
<span id="cb129-4932"><a href="#cb129-4932" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Sierra Leone"</span><span class="op">,</span></span>
<span id="cb129-4933"><a href="#cb129-4933" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Sierra Leone"</span><span class="op">,</span></span>
<span id="cb129-4934"><a href="#cb129-4934" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4935"><a href="#cb129-4935" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Somalia</span><span class="op">:</span> {</span>
<span id="cb129-4936"><a href="#cb129-4936" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Somalia"</span><span class="op">,</span></span>
<span id="cb129-4937"><a href="#cb129-4937" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Somalie"</span><span class="op">,</span></span>
<span id="cb129-4938"><a href="#cb129-4938" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4939"><a href="#cb129-4939" aria-hidden="true" tabindex="-1"></a>      <span class="st">"South Africa"</span><span class="op">:</span> {</span>
<span id="cb129-4940"><a href="#cb129-4940" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"South Africa"</span><span class="op">,</span></span>
<span id="cb129-4941"><a href="#cb129-4941" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Afrique du Sud"</span><span class="op">,</span></span>
<span id="cb129-4942"><a href="#cb129-4942" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4943"><a href="#cb129-4943" aria-hidden="true" tabindex="-1"></a>      <span class="st">"South Sudan"</span><span class="op">:</span> {</span>
<span id="cb129-4944"><a href="#cb129-4944" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"South Sudan"</span><span class="op">,</span></span>
<span id="cb129-4945"><a href="#cb129-4945" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Soudan du Sud"</span><span class="op">,</span></span>
<span id="cb129-4946"><a href="#cb129-4946" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4947"><a href="#cb129-4947" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Sudan</span><span class="op">:</span> {</span>
<span id="cb129-4948"><a href="#cb129-4948" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Sudan"</span><span class="op">,</span></span>
<span id="cb129-4949"><a href="#cb129-4949" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Soudan"</span><span class="op">,</span></span>
<span id="cb129-4950"><a href="#cb129-4950" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4951"><a href="#cb129-4951" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Tanzania</span><span class="op">:</span> {</span>
<span id="cb129-4952"><a href="#cb129-4952" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Tanzania"</span><span class="op">,</span></span>
<span id="cb129-4953"><a href="#cb129-4953" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Tanzanie"</span><span class="op">,</span></span>
<span id="cb129-4954"><a href="#cb129-4954" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4955"><a href="#cb129-4955" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Togo</span><span class="op">:</span> {</span>
<span id="cb129-4956"><a href="#cb129-4956" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Togo"</span><span class="op">,</span></span>
<span id="cb129-4957"><a href="#cb129-4957" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Togo"</span><span class="op">,</span></span>
<span id="cb129-4958"><a href="#cb129-4958" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4959"><a href="#cb129-4959" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Uganda</span><span class="op">:</span> {</span>
<span id="cb129-4960"><a href="#cb129-4960" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Uganda"</span><span class="op">,</span></span>
<span id="cb129-4961"><a href="#cb129-4961" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Ouganda"</span><span class="op">,</span></span>
<span id="cb129-4962"><a href="#cb129-4962" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4963"><a href="#cb129-4963" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Zambia</span><span class="op">:</span> {</span>
<span id="cb129-4964"><a href="#cb129-4964" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Zambia"</span><span class="op">,</span></span>
<span id="cb129-4965"><a href="#cb129-4965" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Zambie"</span><span class="op">,</span></span>
<span id="cb129-4966"><a href="#cb129-4966" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4967"><a href="#cb129-4967" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Zimbabwe</span><span class="op">:</span> {</span>
<span id="cb129-4968"><a href="#cb129-4968" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Zimbabwe"</span><span class="op">,</span></span>
<span id="cb129-4969"><a href="#cb129-4969" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Zimbabwe"</span><span class="op">,</span></span>
<span id="cb129-4970"><a href="#cb129-4970" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4971"><a href="#cb129-4971" aria-hidden="true" tabindex="-1"></a>      <span class="dt">SSA</span><span class="op">:</span> {</span>
<span id="cb129-4972"><a href="#cb129-4972" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Sub-Saharan Africa"</span><span class="op">,</span></span>
<span id="cb129-4973"><a href="#cb129-4973" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Afrique Subsaharienne"</span><span class="op">,</span></span>
<span id="cb129-4974"><a href="#cb129-4974" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4975"><a href="#cb129-4975" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Sub-Saharan Africa"</span><span class="op">:</span> {</span>
<span id="cb129-4976"><a href="#cb129-4976" aria-hidden="true" tabindex="-1"></a>        <span class="dt">en</span><span class="op">:</span> <span class="st">"Sub-Saharan Africa"</span><span class="op">,</span></span>
<span id="cb129-4977"><a href="#cb129-4977" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fr</span><span class="op">:</span> <span class="st">"Afrique Subsaharienne"</span><span class="op">,</span></span>
<span id="cb129-4978"><a href="#cb129-4978" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb129-4979"><a href="#cb129-4979" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb129-4980"><a href="#cb129-4980" aria-hidden="true" tabindex="-1"></a>    <span class="dt">units</span><span class="op">:</span> {</span>
<span id="cb129-4981"><a href="#cb129-4981" aria-hidden="true" tabindex="-1"></a>      <span class="dt">index</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Index"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Indice"</span> }<span class="op">,</span></span>
<span id="cb129-4982"><a href="#cb129-4982" aria-hidden="true" tabindex="-1"></a>      <span class="dt">days</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Days"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Jours"</span> }<span class="op">,</span></span>
<span id="cb129-4983"><a href="#cb129-4983" aria-hidden="true" tabindex="-1"></a>      <span class="dt">yrs</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Years"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Années"</span> }<span class="op">,</span></span>
<span id="cb129-4984"><a href="#cb129-4984" aria-hidden="true" tabindex="-1"></a>      <span class="dt">num_people</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Num. People"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Nb. Personnes"</span> }<span class="op">,</span></span>
<span id="cb129-4985"><a href="#cb129-4985" aria-hidden="true" tabindex="-1"></a>      <span class="dt">num_animals</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Num. Animals"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Nb. Animaux"</span> }<span class="op">,</span></span>
<span id="cb129-4986"><a href="#cb129-4986" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb129-4987"><a href="#cb129-4987" aria-hidden="true" tabindex="-1"></a>    <span class="dt">NoCode</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"No Code"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Sans Code"</span> }<span class="op">,</span></span>
<span id="cb129-4988"><a href="#cb129-4988" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb129-4989"><a href="#cb129-4989" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-129" data-nodetype="declaration"></div></div></div><div class="cell"><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code hidden" id="cb130" data-startfrom="4993" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset:source-line 4992"><span id="cb130-4993"><a href="#cb130-4993" aria-hidden="true" tabindex="-1"></a>definitionText <span class="op">=</span> <span class="kw">new</span> <span class="bu">Object</span>({</span>
<span id="cb130-4994"><a href="#cb130-4994" aria-hidden="true" tabindex="-1"></a>  <span class="dt">Hazard</span><span class="op">:</span> {</span>
<span id="cb130-4995"><a href="#cb130-4995" aria-hidden="true" tabindex="-1"></a>    <span class="dt">title</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Hazard Definitions"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Définitions des Aléas"</span> }<span class="op">,</span></span>
<span id="cb130-4996"><a href="#cb130-4996" aria-hidden="true" tabindex="-1"></a>    <span class="dt">text</span><span class="op">:</span> {</span>
<span id="cb130-4997"><a href="#cb130-4997" aria-hidden="true" tabindex="-1"></a>      <span class="dt">en</span><span class="op">:</span> <span class="vs">`#### Max Human Heat Stress (HSH_max):  </span></span>
<span id="cb130-4998"><a href="#cb130-4998" aria-hidden="true" tabindex="-1"></a><span class="vs">**Thresholds:**</span></span>
<span id="cb130-4999"><a href="#cb130-4999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5000"><a href="#cb130-5000" aria-hidden="true" tabindex="-1"></a><span class="vs">| Hazard Level | Value |</span></span>
<span id="cb130-5001"><a href="#cb130-5001" aria-hidden="true" tabindex="-1"></a><span class="vs">|--------------|----------------------------|</span></span>
<span id="cb130-5002"><a href="#cb130-5002" aria-hidden="true" tabindex="-1"></a><span class="vs">| Low          | ≤ 27                       |</span></span>
<span id="cb130-5003"><a href="#cb130-5003" aria-hidden="true" tabindex="-1"></a><span class="vs">| Moderate     | &gt; 27 and ≤ 32              |</span></span>
<span id="cb130-5004"><a href="#cb130-5004" aria-hidden="true" tabindex="-1"></a><span class="vs">| High         | &gt; 32 and ≤ 41              |</span></span>
<span id="cb130-5005"><a href="#cb130-5005" aria-hidden="true" tabindex="-1"></a><span class="vs">| Extreme      | &gt; 41 and ≤ 54              |</span></span>
<span id="cb130-5006"><a href="#cb130-5006" aria-hidden="true" tabindex="-1"></a><span class="vs">| Very Extreme | &gt; 54                       |</span></span>
<span id="cb130-5007"><a href="#cb130-5007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5008"><a href="#cb130-5008" aria-hidden="true" tabindex="-1"></a><span class="vs">**Definition:** Human heat stress index, maximum value of the growing season.  </span></span>
<span id="cb130-5009"><a href="#cb130-5009" aria-hidden="true" tabindex="-1"></a><span class="vs">**Description:** The heat index (HI) is calculated using daily data and empirical equations based on Steadman (1979a; 1979b), relating the HI to dry-bulb temperature (°C) and relative humidity (%). The maximum value for each month is first calculated, followed by the climatological mean of each month, and then the maximum, mean, and median of the year.  </span></span>
<span id="cb130-5010"><a href="#cb130-5010" aria-hidden="true" tabindex="-1"></a><span class="vs">**Units:** Index (HI)  </span></span>
<span id="cb130-5011"><a href="#cb130-5011" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5012"><a href="#cb130-5012" aria-hidden="true" tabindex="-1"></a><span class="vs">#### Mean Human Heat Stress (HSH_mean):  </span></span>
<span id="cb130-5013"><a href="#cb130-5013" aria-hidden="true" tabindex="-1"></a><span class="vs">**Thresholds:** </span></span>
<span id="cb130-5014"><a href="#cb130-5014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5015"><a href="#cb130-5015" aria-hidden="true" tabindex="-1"></a><span class="vs">| Hazard Level | Value |</span></span>
<span id="cb130-5016"><a href="#cb130-5016" aria-hidden="true" tabindex="-1"></a><span class="vs">|--------------|----------------------------|</span></span>
<span id="cb130-5017"><a href="#cb130-5017" aria-hidden="true" tabindex="-1"></a><span class="vs">| Low          | ≤ 27                       |</span></span>
<span id="cb130-5018"><a href="#cb130-5018" aria-hidden="true" tabindex="-1"></a><span class="vs">| Moderate     | &gt; 27 and ≤ 32              |</span></span>
<span id="cb130-5019"><a href="#cb130-5019" aria-hidden="true" tabindex="-1"></a><span class="vs">| High         | &gt; 32 and ≤ 41              |</span></span>
<span id="cb130-5020"><a href="#cb130-5020" aria-hidden="true" tabindex="-1"></a><span class="vs">| Extreme      | &gt; 41 and ≤ 54              |</span></span>
<span id="cb130-5021"><a href="#cb130-5021" aria-hidden="true" tabindex="-1"></a><span class="vs">| Very Extreme | &gt; 54                       |</span></span>
<span id="cb130-5022"><a href="#cb130-5022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5023"><a href="#cb130-5023" aria-hidden="true" tabindex="-1"></a><span class="vs">**Definition:** Human heat stress index, mean of the growing season.  </span></span>
<span id="cb130-5024"><a href="#cb130-5024" aria-hidden="true" tabindex="-1"></a><span class="vs">**Description:** The heat index (HI) is calculated using daily data and empirical equations based on Steadman (1979a; 1979b), relating the HI to dry-bulb temperature (°C) and relative humidity (%). The mean value for each month is first calculated, followed by the climatological mean of each month, and then the maximum, mean, and median of the year.  </span></span>
<span id="cb130-5025"><a href="#cb130-5025" aria-hidden="true" tabindex="-1"></a><span class="vs">**Units:** Index (HI)  </span></span>
<span id="cb130-5026"><a href="#cb130-5026" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5027"><a href="#cb130-5027" aria-hidden="true" tabindex="-1"></a><span class="vs">#### Number of Waterlogging Days (NDWL0):  </span></span>
<span id="cb130-5028"><a href="#cb130-5028" aria-hidden="true" tabindex="-1"></a><span class="vs">**Thresholds:**   </span></span>
<span id="cb130-5029"><a href="#cb130-5029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5030"><a href="#cb130-5030" aria-hidden="true" tabindex="-1"></a><span class="vs">| Hazard Level | Value |</span></span>
<span id="cb130-5031"><a href="#cb130-5031" aria-hidden="true" tabindex="-1"></a><span class="vs">|--------------|----------------------------|</span></span>
<span id="cb130-5032"><a href="#cb130-5032" aria-hidden="true" tabindex="-1"></a><span class="vs">| Low          | ≤ 2                        |</span></span>
<span id="cb130-5033"><a href="#cb130-5033" aria-hidden="true" tabindex="-1"></a><span class="vs">| Moderate     | &gt; 2 and ≤ 5                |</span></span>
<span id="cb130-5034"><a href="#cb130-5034" aria-hidden="true" tabindex="-1"></a><span class="vs">| High         | &gt; 2 and ≤ 8                |</span></span>
<span id="cb130-5035"><a href="#cb130-5035" aria-hidden="true" tabindex="-1"></a><span class="vs">| Extreme      | &gt; 8                        |</span></span>
<span id="cb130-5036"><a href="#cb130-5036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5037"><a href="#cb130-5037" aria-hidden="true" tabindex="-1"></a><span class="vs">**Definition:** Total number of waterlogging days (at starting saturation, 0%) per season.  </span></span>
<span id="cb130-5038"><a href="#cb130-5038" aria-hidden="true" tabindex="-1"></a><span class="vs">**Description:** A waterlogging day occurs when the soil moisture is just above field capacity and moving toward saturation. This index is calculated using a simple water balance model that utilizes daily precipitation from CHIRPS, daily temperatures from CHIRTS, and solar radiation from AgERA5.  </span></span>
<span id="cb130-5039"><a href="#cb130-5039" aria-hidden="true" tabindex="-1"></a><span class="vs">**Units:** Days  </span></span>
<span id="cb130-5040"><a href="#cb130-5040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5041"><a href="#cb130-5041" aria-hidden="true" tabindex="-1"></a><span class="vs">#### Number of Days of Water Stress (NDWS):  </span></span>
<span id="cb130-5042"><a href="#cb130-5042" aria-hidden="true" tabindex="-1"></a><span class="vs">**Thresholds:**   </span></span>
<span id="cb130-5043"><a href="#cb130-5043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5044"><a href="#cb130-5044" aria-hidden="true" tabindex="-1"></a><span class="vs">| Hazard Level | Value |</span></span>
<span id="cb130-5045"><a href="#cb130-5045" aria-hidden="true" tabindex="-1"></a><span class="vs">|--------------|----------------------------|</span></span>
<span id="cb130-5046"><a href="#cb130-5046" aria-hidden="true" tabindex="-1"></a><span class="vs">| Low          | ≤ 15                       |</span></span>
<span id="cb130-5047"><a href="#cb130-5047" aria-hidden="true" tabindex="-1"></a><span class="vs">| Moderate     | &gt; 15 and ≤ 20              |</span></span>
<span id="cb130-5048"><a href="#cb130-5048" aria-hidden="true" tabindex="-1"></a><span class="vs">| High         | &gt; 20 and ≤ 25              |</span></span>
<span id="cb130-5049"><a href="#cb130-5049" aria-hidden="true" tabindex="-1"></a><span class="vs">| Extreme      | &gt; 25                       |</span></span>
<span id="cb130-5050"><a href="#cb130-5050" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5051"><a href="#cb130-5051" aria-hidden="true" tabindex="-1"></a><span class="vs">**Definition:** Total number of water stress days per season.  </span></span>
<span id="cb130-5052"><a href="#cb130-5052" aria-hidden="true" tabindex="-1"></a><span class="vs">**Description:** A water stress day is defined as a day in which the ratio of actual to potential evapotranspiration is less than 0.5. This index is calculated using a simple water balance model that utilizes daily precipitation from CHIRPS, daily temperatures from CHIRTS, and solar radiation from AgERA5.  </span></span>
<span id="cb130-5053"><a href="#cb130-5053" aria-hidden="true" tabindex="-1"></a><span class="vs">**Units:** Days  </span></span>
<span id="cb130-5054"><a href="#cb130-5054" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5055"><a href="#cb130-5055" aria-hidden="true" tabindex="-1"></a><span class="vs">#### Number of Heat Stress Days for Maize (NTx35):  </span></span>
<span id="cb130-5056"><a href="#cb130-5056" aria-hidden="true" tabindex="-1"></a><span class="vs">**Thresholds:**  </span></span>
<span id="cb130-5057"><a href="#cb130-5057" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5058"><a href="#cb130-5058" aria-hidden="true" tabindex="-1"></a><span class="vs">| Hazard Level | Value |</span></span>
<span id="cb130-5059"><a href="#cb130-5059" aria-hidden="true" tabindex="-1"></a><span class="vs">|--------------|----------------------------|</span></span>
<span id="cb130-5060"><a href="#cb130-5060" aria-hidden="true" tabindex="-1"></a><span class="vs">| Low          | ≤ 10                       |</span></span>
<span id="cb130-5061"><a href="#cb130-5061" aria-hidden="true" tabindex="-1"></a><span class="vs">| Moderate     | &gt; 10 and ≤ 20              |</span></span>
<span id="cb130-5062"><a href="#cb130-5062" aria-hidden="true" tabindex="-1"></a><span class="vs">| High         | &gt; 20 and ≤ 25              |</span></span>
<span id="cb130-5063"><a href="#cb130-5063" aria-hidden="true" tabindex="-1"></a><span class="vs">| Extreme      | &gt; 25                       |</span></span>
<span id="cb130-5064"><a href="#cb130-5064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5065"><a href="#cb130-5065" aria-hidden="true" tabindex="-1"></a><span class="vs">**Definition:** Total number of heat stress days per season for maize.  </span></span>
<span id="cb130-5066"><a href="#cb130-5066" aria-hidden="true" tabindex="-1"></a><span class="vs">**Description:** The number of days with daily maximum temperatures above 35°C during the growing season, using a maize crop calendar.  </span></span>
<span id="cb130-5067"><a href="#cb130-5067" aria-hidden="true" tabindex="-1"></a><span class="vs">**Units:** Days  </span></span>
<span id="cb130-5068"><a href="#cb130-5068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5069"><a href="#cb130-5069" aria-hidden="true" tabindex="-1"></a><span class="vs">#### Number of Heat Stress Days for Generic Crops (NTx40):  </span></span>
<span id="cb130-5070"><a href="#cb130-5070" aria-hidden="true" tabindex="-1"></a><span class="vs">**Thresholds:**  </span></span>
<span id="cb130-5071"><a href="#cb130-5071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5072"><a href="#cb130-5072" aria-hidden="true" tabindex="-1"></a><span class="vs">| Hazard Level | Value |</span></span>
<span id="cb130-5073"><a href="#cb130-5073" aria-hidden="true" tabindex="-1"></a><span class="vs">|--------------|----------------------------|</span></span>
<span id="cb130-5074"><a href="#cb130-5074" aria-hidden="true" tabindex="-1"></a><span class="vs">| Low          | ≤ 1                        |</span></span>
<span id="cb130-5075"><a href="#cb130-5075" aria-hidden="true" tabindex="-1"></a><span class="vs">| Moderate     | &gt; 1 and ≤ 5                |</span></span>
<span id="cb130-5076"><a href="#cb130-5076" aria-hidden="true" tabindex="-1"></a><span class="vs">| High         | &gt; 5 and ≤ 10               |</span></span>
<span id="cb130-5077"><a href="#cb130-5077" aria-hidden="true" tabindex="-1"></a><span class="vs">| Extreme      | &gt; 10                       |</span></span>
<span id="cb130-5078"><a href="#cb130-5078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5079"><a href="#cb130-5079" aria-hidden="true" tabindex="-1"></a><span class="vs">**Definition:** Total number of heat stress days per season for generic crops.  </span></span>
<span id="cb130-5080"><a href="#cb130-5080" aria-hidden="true" tabindex="-1"></a><span class="vs">**Description:** The number of days with daily maximum temperatures above 40°C per month, without using a crop calendar.  </span></span>
<span id="cb130-5081"><a href="#cb130-5081" aria-hidden="true" tabindex="-1"></a><span class="vs">**Units:** Days  </span></span>
<span id="cb130-5082"><a href="#cb130-5082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5083"><a href="#cb130-5083" aria-hidden="true" tabindex="-1"></a><span class="vs">#### Thornthwaite's Aridity Index (TAI):  </span></span>
<span id="cb130-5084"><a href="#cb130-5084" aria-hidden="true" tabindex="-1"></a><span class="vs">**Thresholds:**   </span></span>
<span id="cb130-5085"><a href="#cb130-5085" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5086"><a href="#cb130-5086" aria-hidden="true" tabindex="-1"></a><span class="vs">| Hazard Level | Value |</span></span>
<span id="cb130-5087"><a href="#cb130-5087" aria-hidden="true" tabindex="-1"></a><span class="vs">|--------------|----------------------------|</span></span>
<span id="cb130-5088"><a href="#cb130-5088" aria-hidden="true" tabindex="-1"></a><span class="vs">| Low          | ≤ 40                       |</span></span>
<span id="cb130-5089"><a href="#cb130-5089" aria-hidden="true" tabindex="-1"></a><span class="vs">| Moderate     | &gt; 40 and ≤ 60              |</span></span>
<span id="cb130-5090"><a href="#cb130-5090" aria-hidden="true" tabindex="-1"></a><span class="vs">| High         | &gt; 60 and ≤ 80              |</span></span>
<span id="cb130-5091"><a href="#cb130-5091" aria-hidden="true" tabindex="-1"></a><span class="vs">| Extreme      | &gt; 80                       |</span></span>
<span id="cb130-5092"><a href="#cb130-5092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5093"><a href="#cb130-5093" aria-hidden="true" tabindex="-1"></a><span class="vs">**Definition:** Thornthwaite's Aridity Index.  </span></span>
<span id="cb130-5094"><a href="#cb130-5094" aria-hidden="true" tabindex="-1"></a><span class="vs">**Description:** The Thornthwaite aridity index is calculated as 100 X (d / n), where d is the sum of monthly differences between precipitation and PET for months where precipitation is less than PET, and n is the sum of monthly PET for those months.  </span></span>
<span id="cb130-5095"><a href="#cb130-5095" aria-hidden="true" tabindex="-1"></a><span class="vs">**Units:** Index  </span></span>
<span id="cb130-5096"><a href="#cb130-5096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5097"><a href="#cb130-5097" aria-hidden="true" tabindex="-1"></a><span class="vs">#### Max Cattle Thermal Humidity Index (THI_max):  </span></span>
<span id="cb130-5098"><a href="#cb130-5098" aria-hidden="true" tabindex="-1"></a><span class="vs">**Thresholds:**   </span></span>
<span id="cb130-5099"><a href="#cb130-5099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5100"><a href="#cb130-5100" aria-hidden="true" tabindex="-1"></a><span class="vs">| Hazard Level | Value |</span></span>
<span id="cb130-5101"><a href="#cb130-5101" aria-hidden="true" tabindex="-1"></a><span class="vs">|--------------|----------------------------|</span></span>
<span id="cb130-5102"><a href="#cb130-5102" aria-hidden="true" tabindex="-1"></a><span class="vs">| Low          | ≤ 72                       |</span></span>
<span id="cb130-5103"><a href="#cb130-5103" aria-hidden="true" tabindex="-1"></a><span class="vs">| Moderate     | &gt; 72 and ≤ 78              |</span></span>
<span id="cb130-5104"><a href="#cb130-5104" aria-hidden="true" tabindex="-1"></a><span class="vs">| High         | &gt; 78 and ≤ 90              |</span></span>
<span id="cb130-5105"><a href="#cb130-5105" aria-hidden="true" tabindex="-1"></a><span class="vs">| Extreme      | &gt; 90                       |</span></span>
<span id="cb130-5106"><a href="#cb130-5106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5107"><a href="#cb130-5107" aria-hidden="true" tabindex="-1"></a><span class="vs">**Definition:** Cattle thermal humidity index, maximum value of the season.  </span></span>
<span id="cb130-5108"><a href="#cb130-5108" aria-hidden="true" tabindex="-1"></a><span class="vs">**Description:** The heat index (HI) for cattle is calculated using daily data and empirical equations based on Rahimi et al. (2020). The THI is calculated as THI1 = (1.8 × Tdb + 32) - [(0.55 - 0.0055 × RH) × (1.8 × Tdb - 26.8)], where Tdb is the dry bulb temperature (maximum temperature, °C), and RH is the relative humidity (%).  </span></span>
<span id="cb130-5109"><a href="#cb130-5109" aria-hidden="true" tabindex="-1"></a><span class="vs">**Units:** Index (THI)  </span></span>
<span id="cb130-5110"><a href="#cb130-5110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5111"><a href="#cb130-5111" aria-hidden="true" tabindex="-1"></a><span class="vs">#### Mean Cattle Thermal Humidity Index (THI_mean):  </span></span>
<span id="cb130-5112"><a href="#cb130-5112" aria-hidden="true" tabindex="-1"></a><span class="vs">**Thresholds:**   </span></span>
<span id="cb130-5113"><a href="#cb130-5113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5114"><a href="#cb130-5114" aria-hidden="true" tabindex="-1"></a><span class="vs">| Hazard Level | Value |</span></span>
<span id="cb130-5115"><a href="#cb130-5115" aria-hidden="true" tabindex="-1"></a><span class="vs">|--------------|----------------------------|</span></span>
<span id="cb130-5116"><a href="#cb130-5116" aria-hidden="true" tabindex="-1"></a><span class="vs">| Low          | ≤ 72                       |</span></span>
<span id="cb130-5117"><a href="#cb130-5117" aria-hidden="true" tabindex="-1"></a><span class="vs">| Moderate     | &gt; 72 and ≤ 78              |</span></span>
<span id="cb130-5118"><a href="#cb130-5118" aria-hidden="true" tabindex="-1"></a><span class="vs">| High         | &gt; 78 and ≤ 90              |</span></span>
<span id="cb130-5119"><a href="#cb130-5119" aria-hidden="true" tabindex="-1"></a><span class="vs">| Extreme      | &gt; 90                       |</span></span>
<span id="cb130-5120"><a href="#cb130-5120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5121"><a href="#cb130-5121" aria-hidden="true" tabindex="-1"></a><span class="vs">**Definition:** Cattle thermal humidity index, mean value of the season.  </span></span>
<span id="cb130-5122"><a href="#cb130-5122" aria-hidden="true" tabindex="-1"></a><span class="vs">**Description:** The heat index (HI) for cattle is calculated using daily data and empirical equations based on Rahimi et al. (2020). The THI is calculated as THI1 = (1.8 × Tdb + 32) - [(0.55 - 0.0055 × RH) × (1.8 × Tdb - 26.8)], where Tdb is the dry bulb temperature (maximum temperature, °C), and RH is the relative humidity (%).  </span></span>
<span id="cb130-5123"><a href="#cb130-5123" aria-hidden="true" tabindex="-1"></a><span class="vs">**Units:** Index (THI)  </span></span>
<span id="cb130-5124"><a href="#cb130-5124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5125"><a href="#cb130-5125" aria-hidden="true" tabindex="-1"></a><span class="vs">#### Average Temperature (TAVG):  </span></span>
<span id="cb130-5126"><a href="#cb130-5126" aria-hidden="true" tabindex="-1"></a><span class="vs">**Thresholds:**  </span></span>
<span id="cb130-5127"><a href="#cb130-5127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5128"><a href="#cb130-5128" aria-hidden="true" tabindex="-1"></a><span class="vs">| Hazard Level | Value |</span></span>
<span id="cb130-5129"><a href="#cb130-5129" aria-hidden="true" tabindex="-1"></a><span class="vs">|--------------|----------------------------|</span></span>
<span id="cb130-5130"><a href="#cb130-5130" aria-hidden="true" tabindex="-1"></a><span class="vs">| Low          | ≤ 33                       |</span></span>
<span id="cb130-5131"><a href="#cb130-5131" aria-hidden="true" tabindex="-1"></a><span class="vs">| Moderate     | &gt; 33 and ≤ 36              |</span></span>
<span id="cb130-5132"><a href="#cb130-5132" aria-hidden="true" tabindex="-1"></a><span class="vs">| High         | &gt; 38 and ≤ 47              |</span></span>
<span id="cb130-5133"><a href="#cb130-5133" aria-hidden="true" tabindex="-1"></a><span class="vs">| Extreme      | &gt; 47                       |</span></span>
<span id="cb130-5134"><a href="#cb130-5134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5135"><a href="#cb130-5135" aria-hidden="true" tabindex="-1"></a><span class="vs">**Definition:** Mean temperature.  </span></span>
<span id="cb130-5136"><a href="#cb130-5136" aria-hidden="true" tabindex="-1"></a><span class="vs">**Description:** The average temperature for a given period, typically calculated as the mean of daily temperatures.  </span></span>
<span id="cb130-5137"><a href="#cb130-5137" aria-hidden="true" tabindex="-1"></a><span class="vs">**Units:** °C  </span></span>
<span id="cb130-5138"><a href="#cb130-5138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5139"><a href="#cb130-5139" aria-hidden="true" tabindex="-1"></a><span class="vs">#### Total Precipitation (PTOT):  </span></span>
<span id="cb130-5140"><a href="#cb130-5140" aria-hidden="true" tabindex="-1"></a><span class="vs">**Thresholds:**  </span></span>
<span id="cb130-5141"><a href="#cb130-5141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5142"><a href="#cb130-5142" aria-hidden="true" tabindex="-1"></a><span class="vs">| Hazard Level | Value |</span></span>
<span id="cb130-5143"><a href="#cb130-5143" aria-hidden="true" tabindex="-1"></a><span class="vs">|--------------|----------------------------|</span></span>
<span id="cb130-5144"><a href="#cb130-5144" aria-hidden="true" tabindex="-1"></a><span class="vs">| Low          | ≤ 1200                     |</span></span>
<span id="cb130-5145"><a href="#cb130-5145" aria-hidden="true" tabindex="-1"></a><span class="vs">| Moderate     | &gt; 1200 and ≤ 1600          |</span></span>
<span id="cb130-5146"><a href="#cb130-5146" aria-hidden="true" tabindex="-1"></a><span class="vs">| High         | &gt; 1600 and ≤ 1800          |</span></span>
<span id="cb130-5147"><a href="#cb130-5147" aria-hidden="true" tabindex="-1"></a><span class="vs">| Extreme      | &gt; 1800                     |</span></span>
<span id="cb130-5148"><a href="#cb130-5148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5149"><a href="#cb130-5149" aria-hidden="true" tabindex="-1"></a><span class="vs">**Definition:** Total precipitation.  </span></span>
<span id="cb130-5150"><a href="#cb130-5150" aria-hidden="true" tabindex="-1"></a><span class="vs">**Description:** The total amount of precipitation accumulated over a specific period, typically a month or year.  </span></span>
<span id="cb130-5151"><a href="#cb130-5151" aria-hidden="true" tabindex="-1"></a><span class="vs">**Units:** mm`</span><span class="op">,</span></span>
<span id="cb130-5152"><a href="#cb130-5152" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fr</span><span class="op">:</span> <span class="vs">`#### Stress thermique humain maximal (HSH_max):  </span></span>
<span id="cb130-5153"><a href="#cb130-5153" aria-hidden="true" tabindex="-1"></a><span class="vs">**Seuils:**  </span></span>
<span id="cb130-5154"><a href="#cb130-5154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5155"><a href="#cb130-5155" aria-hidden="true" tabindex="-1"></a><span class="vs">| Niveau d'Aléas | Valeur |</span></span>
<span id="cb130-5156"><a href="#cb130-5156" aria-hidden="true" tabindex="-1"></a><span class="vs">|----------------|----------------------------|</span></span>
<span id="cb130-5157"><a href="#cb130-5157" aria-hidden="true" tabindex="-1"></a><span class="vs">| Faible         | ≤ 27                       |</span></span>
<span id="cb130-5158"><a href="#cb130-5158" aria-hidden="true" tabindex="-1"></a><span class="vs">| Modéré         | &gt; 27 et ≤ 32               |</span></span>
<span id="cb130-5159"><a href="#cb130-5159" aria-hidden="true" tabindex="-1"></a><span class="vs">| Sévère         | &gt; 32 et ≤ 41               |</span></span>
<span id="cb130-5160"><a href="#cb130-5160" aria-hidden="true" tabindex="-1"></a><span class="vs">| Extrême        | &gt; 41 et ≤ 54               |</span></span>
<span id="cb130-5161"><a href="#cb130-5161" aria-hidden="true" tabindex="-1"></a><span class="vs">| Très Extrême   | &gt; 54                       |</span></span>
<span id="cb130-5162"><a href="#cb130-5162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5163"><a href="#cb130-5163" aria-hidden="true" tabindex="-1"></a><span class="vs">**Définition:** Indice de stress thermique humain, valeur maximale de la saison de croissance.  </span></span>
<span id="cb130-5164"><a href="#cb130-5164" aria-hidden="true" tabindex="-1"></a><span class="vs">**Description:** L'indice de chaleur (HI) est calculé en utilisant des données quotidiennes et des équations empiriques basées sur Steadman (1979a; 1979b), reliant le HI à la température de l'air sec (°C) et à l'humidité relative (%). La valeur maximale pour chaque mois est d'abord calculée, suivie de la moyenne climatologique de chaque mois, puis des valeurs maximale, moyenne et médiane de l'année.  </span></span>
<span id="cb130-5165"><a href="#cb130-5165" aria-hidden="true" tabindex="-1"></a><span class="vs">**Unités:** Indice (HI)  </span></span>
<span id="cb130-5166"><a href="#cb130-5166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5167"><a href="#cb130-5167" aria-hidden="true" tabindex="-1"></a><span class="vs">#### Stress thermique humain moyen (HSH_mean):  </span></span>
<span id="cb130-5168"><a href="#cb130-5168" aria-hidden="true" tabindex="-1"></a><span class="vs">**Seuils:**  </span></span>
<span id="cb130-5169"><a href="#cb130-5169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5170"><a href="#cb130-5170" aria-hidden="true" tabindex="-1"></a><span class="vs">| Niveau d'Aléas | Valeur |</span></span>
<span id="cb130-5171"><a href="#cb130-5171" aria-hidden="true" tabindex="-1"></a><span class="vs">|----------------|----------------------------|</span></span>
<span id="cb130-5172"><a href="#cb130-5172" aria-hidden="true" tabindex="-1"></a><span class="vs">| Faible         | ≤ 27                       |</span></span>
<span id="cb130-5173"><a href="#cb130-5173" aria-hidden="true" tabindex="-1"></a><span class="vs">| Modéré         | &gt; 27 et ≤ 32               |</span></span>
<span id="cb130-5174"><a href="#cb130-5174" aria-hidden="true" tabindex="-1"></a><span class="vs">| Sévère         | &gt; 32 et ≤ 41               |</span></span>
<span id="cb130-5175"><a href="#cb130-5175" aria-hidden="true" tabindex="-1"></a><span class="vs">| Extrême        | &gt; 41 et ≤ 54               |</span></span>
<span id="cb130-5176"><a href="#cb130-5176" aria-hidden="true" tabindex="-1"></a><span class="vs">| Très Extrême   | &gt; 54                       |</span></span>
<span id="cb130-5177"><a href="#cb130-5177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5178"><a href="#cb130-5178" aria-hidden="true" tabindex="-1"></a><span class="vs">**Définition:** Indice de stress thermique humain, moyenne de la saison de croissance.  </span></span>
<span id="cb130-5179"><a href="#cb130-5179" aria-hidden="true" tabindex="-1"></a><span class="vs">**Description:** L'indice de chaleur (HI) est calculé en utilisant des données quotidiennes et des équations empiriques basées sur Steadman (1979a; 1979b), reliant le HI à la température à bulbe sec (°C) et à l'humidité relative (%). La valeur moyenne pour chaque mois est d'abord calculée, suivie de la moyenne climatologique de chaque mois, puis des valeurs maximale, moyenne et médiane de l'année.  </span></span>
<span id="cb130-5180"><a href="#cb130-5180" aria-hidden="true" tabindex="-1"></a><span class="vs">**Unités:** Indice (HI)  </span></span>
<span id="cb130-5181"><a href="#cb130-5181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5182"><a href="#cb130-5182" aria-hidden="true" tabindex="-1"></a><span class="vs">#### Nombre de jours de saturation en eau (NDWL0):  </span></span>
<span id="cb130-5183"><a href="#cb130-5183" aria-hidden="true" tabindex="-1"></a><span class="vs">**Seuils:**    </span></span>
<span id="cb130-5184"><a href="#cb130-5184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5185"><a href="#cb130-5185" aria-hidden="true" tabindex="-1"></a><span class="vs">| Niveau d'Aléas | Valeur |</span></span>
<span id="cb130-5186"><a href="#cb130-5186" aria-hidden="true" tabindex="-1"></a><span class="vs">|----------------|----------------------------|</span></span>
<span id="cb130-5187"><a href="#cb130-5187" aria-hidden="true" tabindex="-1"></a><span class="vs">| Faible         | ≤ 2                        |</span></span>
<span id="cb130-5188"><a href="#cb130-5188" aria-hidden="true" tabindex="-1"></a><span class="vs">| Modéré         | &gt; 2 et ≤ 5                 |</span></span>
<span id="cb130-5189"><a href="#cb130-5189" aria-hidden="true" tabindex="-1"></a><span class="vs">| Sévère         | &gt; 5 et ≤ 8                 |</span></span>
<span id="cb130-5190"><a href="#cb130-5190" aria-hidden="true" tabindex="-1"></a><span class="vs">| Extrême        | &gt; 8                        |</span></span>
<span id="cb130-5191"><a href="#cb130-5191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5192"><a href="#cb130-5192" aria-hidden="true" tabindex="-1"></a><span class="vs">**Définition:** Nombre total de jours de saturation en eau (à saturation initiale, 0 %) par saison.  </span></span>
<span id="cb130-5193"><a href="#cb130-5193" aria-hidden="true" tabindex="-1"></a><span class="vs">**Description:** Un jour de saturation en eau se produit lorsque l'humidité du sol est juste au-dessus de la capacité au champ et se dirige vers la saturation. Cet indice est calculé en utilisant un modèle simple de bilan hydrique qui utilise les précipitations quotidiennes de CHIRPS, les températures quotidiennes de CHIRTS et le rayonnement solaire d'AgERA5.  </span></span>
<span id="cb130-5194"><a href="#cb130-5194" aria-hidden="true" tabindex="-1"></a><span class="vs">**Unités:** Jours  </span></span>
<span id="cb130-5195"><a href="#cb130-5195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5196"><a href="#cb130-5196" aria-hidden="true" tabindex="-1"></a><span class="vs">#### Nombre de jours de stress hydrique (NDWS):  </span></span>
<span id="cb130-5197"><a href="#cb130-5197" aria-hidden="true" tabindex="-1"></a><span class="vs">**Seuils:**  </span></span>
<span id="cb130-5198"><a href="#cb130-5198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5199"><a href="#cb130-5199" aria-hidden="true" tabindex="-1"></a><span class="vs">| Niveau d'Aléas | Valeur |</span></span>
<span id="cb130-5200"><a href="#cb130-5200" aria-hidden="true" tabindex="-1"></a><span class="vs">|----------------|----------------------------|</span></span>
<span id="cb130-5201"><a href="#cb130-5201" aria-hidden="true" tabindex="-1"></a><span class="vs">| Faible         | ≤ 15                       |</span></span>
<span id="cb130-5202"><a href="#cb130-5202" aria-hidden="true" tabindex="-1"></a><span class="vs">| Modéré         | &gt; 15 et ≤ 20               |</span></span>
<span id="cb130-5203"><a href="#cb130-5203" aria-hidden="true" tabindex="-1"></a><span class="vs">| Sévère         | &gt; 20 et ≤ 25               |</span></span>
<span id="cb130-5204"><a href="#cb130-5204" aria-hidden="true" tabindex="-1"></a><span class="vs">| Extrême        | &gt; 25                       |</span></span>
<span id="cb130-5205"><a href="#cb130-5205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5206"><a href="#cb130-5206" aria-hidden="true" tabindex="-1"></a><span class="vs">**Définition:** Nombre total de jours de stress hydrique par saison.  </span></span>
<span id="cb130-5207"><a href="#cb130-5207" aria-hidden="true" tabindex="-1"></a><span class="vs">**Description:** Un jour de stress hydrique est défini comme un jour où le ratio de l'évapotranspiration réelle à l'évapotranspiration potentielle est inférieur à 0,5. Cet indice est calculé en utilisant un modèle simple de bilan hydrique qui utilise les précipitations quotidiennes de CHIRPS, les températures quotidiennes de CHIRTS et le rayonnement solaire d'AgERA5.  </span></span>
<span id="cb130-5208"><a href="#cb130-5208" aria-hidden="true" tabindex="-1"></a><span class="vs">**Unités:** Jours  </span></span>
<span id="cb130-5209"><a href="#cb130-5209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5210"><a href="#cb130-5210" aria-hidden="true" tabindex="-1"></a><span class="vs">#### Nombre de jours de stress thermique pour le maïs (NTx35):  </span></span>
<span id="cb130-5211"><a href="#cb130-5211" aria-hidden="true" tabindex="-1"></a><span class="vs">**Seuils:**   </span></span>
<span id="cb130-5212"><a href="#cb130-5212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5213"><a href="#cb130-5213" aria-hidden="true" tabindex="-1"></a><span class="vs">| Niveau d'Aléas | Valeur |</span></span>
<span id="cb130-5214"><a href="#cb130-5214" aria-hidden="true" tabindex="-1"></a><span class="vs">|----------------|----------------------------|</span></span>
<span id="cb130-5215"><a href="#cb130-5215" aria-hidden="true" tabindex="-1"></a><span class="vs">| Faible         | ≤ 10                       |</span></span>
<span id="cb130-5216"><a href="#cb130-5216" aria-hidden="true" tabindex="-1"></a><span class="vs">| Modéré         | &gt; 10 et ≤ 20               |</span></span>
<span id="cb130-5217"><a href="#cb130-5217" aria-hidden="true" tabindex="-1"></a><span class="vs">| Sévère         | &gt; 20 et ≤ 25               |</span></span>
<span id="cb130-5218"><a href="#cb130-5218" aria-hidden="true" tabindex="-1"></a><span class="vs">| Extrême        | &gt; 25                       |</span></span>
<span id="cb130-5219"><a href="#cb130-5219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5220"><a href="#cb130-5220" aria-hidden="true" tabindex="-1"></a><span class="vs">**Définition:** Nombre total de jours de stress thermique par saison pour le maïs.  </span></span>
<span id="cb130-5221"><a href="#cb130-5221" aria-hidden="true" tabindex="-1"></a><span class="vs">**Description:** Le nombre de jours avec des températures maximales quotidiennes au-dessus de 35 °C pendant la saison de croissance, en utilisant un calendrier de culture du maïs.  </span></span>
<span id="cb130-5222"><a href="#cb130-5222" aria-hidden="true" tabindex="-1"></a><span class="vs">**Unités:** Jours  </span></span>
<span id="cb130-5223"><a href="#cb130-5223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5224"><a href="#cb130-5224" aria-hidden="true" tabindex="-1"></a><span class="vs">#### Nombre de jours de stress thermique pour les cultures génériques (NTx40):  </span></span>
<span id="cb130-5225"><a href="#cb130-5225" aria-hidden="true" tabindex="-1"></a><span class="vs">**Seuils:**   </span></span>
<span id="cb130-5226"><a href="#cb130-5226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5227"><a href="#cb130-5227" aria-hidden="true" tabindex="-1"></a><span class="vs">| Niveau d'Aléas | Valeur |</span></span>
<span id="cb130-5228"><a href="#cb130-5228" aria-hidden="true" tabindex="-1"></a><span class="vs">|----------------|----------------------------|</span></span>
<span id="cb130-5229"><a href="#cb130-5229" aria-hidden="true" tabindex="-1"></a><span class="vs">| Faible         | ≤ 1                        |</span></span>
<span id="cb130-5230"><a href="#cb130-5230" aria-hidden="true" tabindex="-1"></a><span class="vs">| Modéré         | &gt; 1 et ≤ 5                 |</span></span>
<span id="cb130-5231"><a href="#cb130-5231" aria-hidden="true" tabindex="-1"></a><span class="vs">| Sévère         | &gt; 5 et ≤ 10                |</span></span>
<span id="cb130-5232"><a href="#cb130-5232" aria-hidden="true" tabindex="-1"></a><span class="vs">| Extrême        | &gt; 10                       |</span></span>
<span id="cb130-5233"><a href="#cb130-5233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5234"><a href="#cb130-5234" aria-hidden="true" tabindex="-1"></a><span class="vs">**Définition:** Nombre total de jours de stress thermique par saison pour les cultures génériques.  </span></span>
<span id="cb130-5235"><a href="#cb130-5235" aria-hidden="true" tabindex="-1"></a><span class="vs">**Description:** Le nombre de jours avec des températures maximales quotidiennes au-dessus de 40 °C par mois, sans utiliser de calendrier de culture.  </span></span>
<span id="cb130-5236"><a href="#cb130-5236" aria-hidden="true" tabindex="-1"></a><span class="vs">**Unités:** Jours  </span></span>
<span id="cb130-5237"><a href="#cb130-5237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5238"><a href="#cb130-5238" aria-hidden="true" tabindex="-1"></a><span class="vs">#### Indice d'Aridité de Thornthwaite (TAI):  </span></span>
<span id="cb130-5239"><a href="#cb130-5239" aria-hidden="true" tabindex="-1"></a><span class="vs">**Seuils:**   </span></span>
<span id="cb130-5240"><a href="#cb130-5240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5241"><a href="#cb130-5241" aria-hidden="true" tabindex="-1"></a><span class="vs">| Niveau d'Aléas | Valeur |</span></span>
<span id="cb130-5242"><a href="#cb130-5242" aria-hidden="true" tabindex="-1"></a><span class="vs">|----------------|----------------------------|</span></span>
<span id="cb130-5243"><a href="#cb130-5243" aria-hidden="true" tabindex="-1"></a><span class="vs">| Faible         | ≤ 40                       |</span></span>
<span id="cb130-5244"><a href="#cb130-5244" aria-hidden="true" tabindex="-1"></a><span class="vs">| Modéré         | &gt; 40 et ≤ 60               |</span></span>
<span id="cb130-5245"><a href="#cb130-5245" aria-hidden="true" tabindex="-1"></a><span class="vs">| Sévère         | &gt; 60 et ≤ 80               |</span></span>
<span id="cb130-5246"><a href="#cb130-5246" aria-hidden="true" tabindex="-1"></a><span class="vs">| Extrême        | &gt; 80                       |</span></span>
<span id="cb130-5247"><a href="#cb130-5247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5248"><a href="#cb130-5248" aria-hidden="true" tabindex="-1"></a><span class="vs">**Définition:** Indice d'aridité de Thornthwaite.  </span></span>
<span id="cb130-5249"><a href="#cb130-5249" aria-hidden="true" tabindex="-1"></a><span class="vs">**Description:** L'indice d'aridité de Thornthwaite est calculé comme 100 × (d / n), où d est la somme des différences mensuelles entre les précipitations et l'ETP pour les mois où les précipitations sont inférieures à l'ETP, et n est la somme mensuelle de l'ETP pour ces mois.  </span></span>
<span id="cb130-5250"><a href="#cb130-5250" aria-hidden="true" tabindex="-1"></a><span class="vs">**Unités:** Indice  </span></span>
<span id="cb130-5251"><a href="#cb130-5251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5252"><a href="#cb130-5252" aria-hidden="true" tabindex="-1"></a><span class="vs">#### Indice de Température-Humidité Maximal pour le Bétail (THI_max):  </span></span>
<span id="cb130-5253"><a href="#cb130-5253" aria-hidden="true" tabindex="-1"></a><span class="vs">**Seuils:**  </span></span>
<span id="cb130-5254"><a href="#cb130-5254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5255"><a href="#cb130-5255" aria-hidden="true" tabindex="-1"></a><span class="vs">| Niveau d'Aléas | Valeur |</span></span>
<span id="cb130-5256"><a href="#cb130-5256" aria-hidden="true" tabindex="-1"></a><span class="vs">|----------------|----------------------------|</span></span>
<span id="cb130-5257"><a href="#cb130-5257" aria-hidden="true" tabindex="-1"></a><span class="vs">| Faible         | ≤ 72                       |</span></span>
<span id="cb130-5258"><a href="#cb130-5258" aria-hidden="true" tabindex="-1"></a><span class="vs">| Modéré         | &gt; 72 et ≤ 78               |</span></span>
<span id="cb130-5259"><a href="#cb130-5259" aria-hidden="true" tabindex="-1"></a><span class="vs">| Sévère         | &gt; 78 et ≤ 90               |</span></span>
<span id="cb130-5260"><a href="#cb130-5260" aria-hidden="true" tabindex="-1"></a><span class="vs">| Extrême        | &gt; 90                       |</span></span>
<span id="cb130-5261"><a href="#cb130-5261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5262"><a href="#cb130-5262" aria-hidden="true" tabindex="-1"></a><span class="vs">**Définition:** Indice de température-humidité pour le bétail, valeur maximale de la saison.  </span></span>
<span id="cb130-5263"><a href="#cb130-5263" aria-hidden="true" tabindex="-1"></a><span class="vs">**Description:** L'indice de chaleur (HI) pour le bétail est calculé en utilisant des données quotidiennes et des équations empiriques basées sur Rahimi et al. (2020). Le THI est calculé comme THI1 = (1,8 × Tdb + 32) - [(0,55 - 0,0055 × RH) × (1,8 × Tdb - 26,8)], où Tdb est la température à bulbe sec (température maximale, °C), et RH est l'humidité relative (%).  </span></span>
<span id="cb130-5264"><a href="#cb130-5264" aria-hidden="true" tabindex="-1"></a><span class="vs">**Unités:** Indice (THI)  </span></span>
<span id="cb130-5265"><a href="#cb130-5265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5266"><a href="#cb130-5266" aria-hidden="true" tabindex="-1"></a><span class="vs">#### Indice de Température-Humidité Moyen pour le Bétail (THI_mean):  </span></span>
<span id="cb130-5267"><a href="#cb130-5267" aria-hidden="true" tabindex="-1"></a><span class="vs">**Seuils:**  </span></span>
<span id="cb130-5268"><a href="#cb130-5268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5269"><a href="#cb130-5269" aria-hidden="true" tabindex="-1"></a><span class="vs">| Niveau d'Aléas | Valeur |</span></span>
<span id="cb130-5270"><a href="#cb130-5270" aria-hidden="true" tabindex="-1"></a><span class="vs">|----------------|----------------------------|</span></span>
<span id="cb130-5271"><a href="#cb130-5271" aria-hidden="true" tabindex="-1"></a><span class="vs">| Faible         | ≤ 72                       |</span></span>
<span id="cb130-5272"><a href="#cb130-5272" aria-hidden="true" tabindex="-1"></a><span class="vs">| Modéré         | &gt; 72 et ≤ 78               |</span></span>
<span id="cb130-5273"><a href="#cb130-5273" aria-hidden="true" tabindex="-1"></a><span class="vs">| Sévère         | &gt; 78 et ≤ 90               |</span></span>
<span id="cb130-5274"><a href="#cb130-5274" aria-hidden="true" tabindex="-1"></a><span class="vs">| Extrême        | &gt; 90                       |</span></span>
<span id="cb130-5275"><a href="#cb130-5275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5276"><a href="#cb130-5276" aria-hidden="true" tabindex="-1"></a><span class="vs">**Définition:** Indice de température-humidité pour le bétail, valeur moyenne de la saison.  </span></span>
<span id="cb130-5277"><a href="#cb130-5277" aria-hidden="true" tabindex="-1"></a><span class="vs">**Description:** L'indice de chaleur (HI) pour le bétail est calculé en utilisant des données quotidiennes et des équations empiriques basées sur Rahimi et al. (2020). Le THI est calculé comme THI1 = (1,8 × Tdb + 32) - [(0,55 - 0,0055 × RH) × (1,8 × Tdb - 26,8)], où Tdb est la température à bulbe sec (température maximale, °C), et RH est l'humidité relative (%).  </span></span>
<span id="cb130-5278"><a href="#cb130-5278" aria-hidden="true" tabindex="-1"></a><span class="vs">**Unités:** Indice (THI)  </span></span>
<span id="cb130-5279"><a href="#cb130-5279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5280"><a href="#cb130-5280" aria-hidden="true" tabindex="-1"></a><span class="vs">#### Température Moyenne (TAVG):  </span></span>
<span id="cb130-5281"><a href="#cb130-5281" aria-hidden="true" tabindex="-1"></a><span class="vs">**Seuils:**  </span></span>
<span id="cb130-5282"><a href="#cb130-5282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5283"><a href="#cb130-5283" aria-hidden="true" tabindex="-1"></a><span class="vs">| Niveau d'Aléas | Valeur |</span></span>
<span id="cb130-5284"><a href="#cb130-5284" aria-hidden="true" tabindex="-1"></a><span class="vs">|----------------|----------------------------|</span></span>
<span id="cb130-5285"><a href="#cb130-5285" aria-hidden="true" tabindex="-1"></a><span class="vs">| Faible         | ≤ 33                       |</span></span>
<span id="cb130-5286"><a href="#cb130-5286" aria-hidden="true" tabindex="-1"></a><span class="vs">| Modéré         | &gt; 33 et ≤ 36               |</span></span>
<span id="cb130-5287"><a href="#cb130-5287" aria-hidden="true" tabindex="-1"></a><span class="vs">| Sévère         | &gt; 36 et ≤ 47               |</span></span>
<span id="cb130-5288"><a href="#cb130-5288" aria-hidden="true" tabindex="-1"></a><span class="vs">| Extrême        | &gt; 47                       |</span></span>
<span id="cb130-5289"><a href="#cb130-5289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5290"><a href="#cb130-5290" aria-hidden="true" tabindex="-1"></a><span class="vs">**Définition:** Température moyenne.  </span></span>
<span id="cb130-5291"><a href="#cb130-5291" aria-hidden="true" tabindex="-1"></a><span class="vs">**Description:** La température moyenne pour une période donnée, généralement calculée comme la moyenne des températures quotidiennes.  </span></span>
<span id="cb130-5292"><a href="#cb130-5292" aria-hidden="true" tabindex="-1"></a><span class="vs">**Unités:** °C  </span></span>
<span id="cb130-5293"><a href="#cb130-5293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5294"><a href="#cb130-5294" aria-hidden="true" tabindex="-1"></a><span class="vs">#### Précipitation Totale (PTOT):  </span></span>
<span id="cb130-5295"><a href="#cb130-5295" aria-hidden="true" tabindex="-1"></a><span class="vs">**Seuils:**  </span></span>
<span id="cb130-5296"><a href="#cb130-5296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5297"><a href="#cb130-5297" aria-hidden="true" tabindex="-1"></a><span class="vs">| Niveau d'Aléas | Valeur |</span></span>
<span id="cb130-5298"><a href="#cb130-5298" aria-hidden="true" tabindex="-1"></a><span class="vs">|----------------|----------------------------|</span></span>
<span id="cb130-5299"><a href="#cb130-5299" aria-hidden="true" tabindex="-1"></a><span class="vs">| Faible         | ≤ 1200                     |</span></span>
<span id="cb130-5300"><a href="#cb130-5300" aria-hidden="true" tabindex="-1"></a><span class="vs">| Modéré         | &gt; 1200 et ≤ 1600           |</span></span>
<span id="cb130-5301"><a href="#cb130-5301" aria-hidden="true" tabindex="-1"></a><span class="vs">| Sévère         | &gt; 1600 et ≤ 1800           |</span></span>
<span id="cb130-5302"><a href="#cb130-5302" aria-hidden="true" tabindex="-1"></a><span class="vs">| Extrême        | &gt; 1800                     |</span></span>
<span id="cb130-5303"><a href="#cb130-5303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5304"><a href="#cb130-5304" aria-hidden="true" tabindex="-1"></a><span class="vs">**Définition:** Précipitation totale.  </span></span>
<span id="cb130-5305"><a href="#cb130-5305" aria-hidden="true" tabindex="-1"></a><span class="vs">**Description:** La quantité totale de précipitations accumulées sur une période spécifique, généralement un mois ou une année.  </span></span>
<span id="cb130-5306"><a href="#cb130-5306" aria-hidden="true" tabindex="-1"></a><span class="vs">**Unités:** mm`</span><span class="op">,</span></span>
<span id="cb130-5307"><a href="#cb130-5307" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb130-5308"><a href="#cb130-5308" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb130-5309"><a href="#cb130-5309" aria-hidden="true" tabindex="-1"></a>  <span class="dt">Exposure</span><span class="op">:</span> {</span>
<span id="cb130-5310"><a href="#cb130-5310" aria-hidden="true" tabindex="-1"></a>    <span class="dt">title</span><span class="op">:</span> { <span class="dt">en</span><span class="op">:</span> <span class="st">"Exposure Definitions"</span><span class="op">,</span> <span class="dt">fr</span><span class="op">:</span> <span class="st">"Définitions de l'Exposition"</span> }<span class="op">,</span></span>
<span id="cb130-5311"><a href="#cb130-5311" aria-hidden="true" tabindex="-1"></a>    <span class="dt">text</span><span class="op">:</span> {</span>
<span id="cb130-5312"><a href="#cb130-5312" aria-hidden="true" tabindex="-1"></a>      <span class="dt">en</span><span class="op">:</span> <span class="vs">`#### Value Of Production (VOP):  </span></span>
<span id="cb130-5313"><a href="#cb130-5313" aria-hidden="true" tabindex="-1"></a><span class="vs">**Unit:** International Dollar for 2005 (Int$2005)  </span></span>
<span id="cb130-5314"><a href="#cb130-5314" aria-hidden="true" tabindex="-1"></a><span class="vs">**Description:** Value of Production (VOP) represents the total economic value of agricultural goods produced within a specified area.</span></span>
<span id="cb130-5315"><a href="#cb130-5315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5316"><a href="#cb130-5316" aria-hidden="true" tabindex="-1"></a><span class="vs">#### Harvested Area (HA):</span></span>
<span id="cb130-5317"><a href="#cb130-5317" aria-hidden="true" tabindex="-1"></a><span class="vs">**Unit:** Hectare (ha)  </span></span>
<span id="cb130-5318"><a href="#cb130-5318" aria-hidden="true" tabindex="-1"></a><span class="vs">**Description:** Harvested area (HA) is the total land area, measured in hectares (ha), used for the cultivation of a crop within a given region.</span></span>
<span id="cb130-5319"><a href="#cb130-5319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5320"><a href="#cb130-5320" aria-hidden="true" tabindex="-1"></a><span class="vs">#### Livestock Head (number):</span></span>
<span id="cb130-5321"><a href="#cb130-5321" aria-hidden="true" tabindex="-1"></a><span class="vs">**Unit:** Total  </span></span>
<span id="cb130-5322"><a href="#cb130-5322" aria-hidden="true" tabindex="-1"></a><span class="vs">**Description:** Livestock head refers to the total number of animals present in a given area.`</span><span class="op">,</span></span>
<span id="cb130-5323"><a href="#cb130-5323" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fr</span><span class="op">:</span> <span class="vs">`#### La Valeur de la Production (VOP)</span></span>
<span id="cb130-5324"><a href="#cb130-5324" aria-hidden="true" tabindex="-1"></a><span class="vs">**Unité:** Dollar International de 2005 (Int$2005)  </span></span>
<span id="cb130-5325"><a href="#cb130-5325" aria-hidden="true" tabindex="-1"></a><span class="vs">**Description:** La Valeur de la Production représente la valeur économique totale des biens agricoles produits dans une zone spécifiée.  </span></span>
<span id="cb130-5326"><a href="#cb130-5326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5327"><a href="#cb130-5327" aria-hidden="true" tabindex="-1"></a><span class="vs">#### Superficie Récoltée (HA):</span></span>
<span id="cb130-5328"><a href="#cb130-5328" aria-hidden="true" tabindex="-1"></a><span class="vs">**Unité:** Hectare (ha)  </span></span>
<span id="cb130-5329"><a href="#cb130-5329" aria-hidden="true" tabindex="-1"></a><span class="vs">**Description:** La superficie récoltée est la superficie totale des terres, mesurée en hectares (ha), utilisée pour la culture d'une récolte dans une région donnée. </span></span>
<span id="cb130-5330"><a href="#cb130-5330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5331"><a href="#cb130-5331" aria-hidden="true" tabindex="-1"></a><span class="vs">#### Effectif du Bétail (nombre): </span></span>
<span id="cb130-5332"><a href="#cb130-5332" aria-hidden="true" tabindex="-1"></a><span class="vs">**Unité:** Total  </span></span>
<span id="cb130-5333"><a href="#cb130-5333" aria-hidden="true" tabindex="-1"></a><span class="vs">**Description:** L'effectif du bétail fait référence au nombre total d'animaux présents dans une zone administrative donnée.`</span><span class="op">,</span></span>
<span id="cb130-5334"><a href="#cb130-5334" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb130-5335"><a href="#cb130-5335" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb130-5336"><a href="#cb130-5336" aria-hidden="true" tabindex="-1"></a>  <span class="dt">Vulnerability</span><span class="op">:</span> {</span>
<span id="cb130-5337"><a href="#cb130-5337" aria-hidden="true" tabindex="-1"></a>    <span class="dt">title</span><span class="op">:</span> {</span>
<span id="cb130-5338"><a href="#cb130-5338" aria-hidden="true" tabindex="-1"></a>      <span class="dt">en</span><span class="op">:</span> <span class="st">"Adaptive Capacity Definitions"</span><span class="op">,</span></span>
<span id="cb130-5339"><a href="#cb130-5339" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fr</span><span class="op">:</span> <span class="st">"Définitions de la Capacité d'Adaptation"</span><span class="op">,</span></span>
<span id="cb130-5340"><a href="#cb130-5340" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb130-5341"><a href="#cb130-5341" aria-hidden="true" tabindex="-1"></a>    <span class="dt">text</span><span class="op">:</span> {</span>
<span id="cb130-5342"><a href="#cb130-5342" aria-hidden="true" tabindex="-1"></a>      <span class="dt">en</span><span class="op">:</span> <span class="vs">`#### Education: </span></span>
<span id="cb130-5343"><a href="#cb130-5343" aria-hidden="true" tabindex="-1"></a><span class="vs">**Description:** Years of education across the population (combined male and female)  </span></span>
<span id="cb130-5344"><a href="#cb130-5344" aria-hidden="true" tabindex="-1"></a><span class="vs">**Unit:** Years</span></span>
<span id="cb130-5345"><a href="#cb130-5345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5346"><a href="#cb130-5346" aria-hidden="true" tabindex="-1"></a><span class="vs">#### Poverty: </span></span>
<span id="cb130-5347"><a href="#cb130-5347" aria-hidden="true" tabindex="-1"></a><span class="vs">**Description:** Percent of Population underneath the provided poverty line  </span></span>
<span id="cb130-5348"><a href="#cb130-5348" aria-hidden="true" tabindex="-1"></a><span class="vs">**Unit:** % of Population</span></span>
<span id="cb130-5349"><a href="#cb130-5349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5350"><a href="#cb130-5350" aria-hidden="true" tabindex="-1"></a><span class="vs">#### Gender: </span></span>
<span id="cb130-5351"><a href="#cb130-5351" aria-hidden="true" tabindex="-1"></a><span class="vs">**Description:** A set of indexes showing female well-being. All are normalized between 0-1 where 0 is poor and 1 is good.  </span></span>
<span id="cb130-5352"><a href="#cb130-5352" aria-hidden="true" tabindex="-1"></a><span class="vs">**Unit:** Index</span></span>
<span id="cb130-5353"><a href="#cb130-5353" aria-hidden="true" tabindex="-1"></a><span class="vs">`</span><span class="op">,</span></span>
<span id="cb130-5354"><a href="#cb130-5354" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fr</span><span class="op">:</span> <span class="vs">`#### Éducation: </span></span>
<span id="cb130-5355"><a href="#cb130-5355" aria-hidden="true" tabindex="-1"></a><span class="vs">**Description:**  Nombre d'années d'éducation dans la population (hommes et femmes combinés)  </span></span>
<span id="cb130-5356"><a href="#cb130-5356" aria-hidden="true" tabindex="-1"></a><span class="vs">**Unité:** Années</span></span>
<span id="cb130-5357"><a href="#cb130-5357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5358"><a href="#cb130-5358" aria-hidden="true" tabindex="-1"></a><span class="vs">#### Pauvreté: </span></span>
<span id="cb130-5359"><a href="#cb130-5359" aria-hidden="true" tabindex="-1"></a><span class="vs">**Description:** Pourcentage de la population en dessous du seuil de pauvreté fourni.  </span></span>
<span id="cb130-5360"><a href="#cb130-5360" aria-hidden="true" tabindex="-1"></a><span class="vs">**Unité:** % de la population</span></span>
<span id="cb130-5361"><a href="#cb130-5361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-5362"><a href="#cb130-5362" aria-hidden="true" tabindex="-1"></a><span class="vs">#### Genre: </span></span>
<span id="cb130-5363"><a href="#cb130-5363" aria-hidden="true" tabindex="-1"></a><span class="vs">**Description:** Un ensemble d'indices montrant le bien-être des femmes. Tous sont normalisés entre 0 et 1, où 0 est mauvais et 1 est bon.  </span></span>
<span id="cb130-5364"><a href="#cb130-5364" aria-hidden="true" tabindex="-1"></a><span class="vs">**Unité:** Indice</span></span>
<span id="cb130-5365"><a href="#cb130-5365" aria-hidden="true" tabindex="-1"></a><span class="vs">`</span><span class="op">,</span></span>
<span id="cb130-5366"><a href="#cb130-5366" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb130-5367"><a href="#cb130-5367" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb130-5368"><a href="#cb130-5368" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div><div class="cell-output cell-output-display"><div id="ojs-cell-130" data-nodetype="declaration"></div></div></div></section></main><script type="ojs-module-contents">eyJjb250ZW50cyI6W3sibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImltcG9ydCB7IGhlcm9JbWFnZSB9IGZyb20gXCIvaGVscGVycy9oZXJvLmpzXCI7XG5oZXJvX3VybCA9IFwiLi8uLi8uLi9pbWFnZXMvZXhwbG9yZS53ZWJwXCI7XG5cbmhlcm8gPSBoZXJvSW1hZ2Uobm90ZWJvb2tUaXRsZSwgaGVyb191cmwpO1xuaHRtbGAke2hlcm99YDtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImltcG9ydCB7IGF0bGFzVE9DIH0gZnJvbSAnL2hlbHBlcnMvdG9jLm9qcycgXG57XG4gIGF3YWl0IG5iVGV4dCAvLyBmb3JjZSB3YWl0L3JlbG9hZCB3aXRoIG5iVGV4dCB0byBsb2FkIHNvIGhlYWRpbmdzIGhhdmUgY29ycmVjdCBsYWJlbHMvbGFuZ3VhZ2VzXG4gIHJldHVybiBhdGxhc1RPQyh7XG4gICAgICBoZWFkaW5nOiBgPGI+JHtfbGFuZyh7ZW46XCJJbiB0aGlzIG5vdGVib29rXCIsIGZyOlwiRGFucyBjZSBub3RlYm9va1wifSl9PC9iPmAsXG4gICAgICBza2lwOiBbbm90ZWJvb2tUaXRsZSwgXCJub3RlYm9vay10aXRsZVwiLCBcIkFwcGVuZGl4XCIsIFwic291cmNlLWNvZGVcIl1cbiAgICAgIH0pXG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTMiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ2aWV3b2YgcHJldHR5TGFuZ3VhZ2VWaWV3ID0ge1xuICByZXR1cm4gSW5wdXRzLmJpbmQoXG4gICAgSW5wdXRzLnJhZGlvKGxhbmd1YWdlcywge1xuICAgICAgbGFiZWw6IF9sYW5nKHtlbjogXCJMYW5ndWFnZVwiLCBmcjogXCJMYW5ndWVcIn0pLFxuICAgICAgZm9ybWF0OiAoZCkgPT4gZC5sYWJlbFxuICAgIH0pLFxuICAgIHZpZXdvZiBsYW5ndWFnZVxuICApO1xufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC00IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoibWRgIyAke19sYW5nKG5iVGV4dC5vdmVydmlldy50aXRsZSl9XG5cbl8ke19sYW5nKG5iVGV4dC5vdmVydmlldy5zdWJUaXRsZSl9X1xuXG4ke19sYW5nKG5iVGV4dC5vdmVydmlldy50ZXh0KX1gO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC01IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiaHRtbGBcbiAgPGRpdiBzdHlsZT1cIlxuICAgIG1hcmdpbjoxNnB4IDA7XG4gICAgcGFkZGluZzoxNHB4IDE4cHg7XG4gICAgYm9yZGVyLXJhZGl1czo4cHg7XG4gICAgYmFja2dyb3VuZDpsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCAjNGY3YmQ5LCAjNmZhOGRjKTtcbiAgICBjb2xvcjojZmZmZmZmO1xuICBcIj5cbiAgICA8ZGl2IHN0eWxlPVwiXG4gICAgICBmb250LXNpemU6MS4xNXJlbTtcbiAgICAgIGZvbnQtd2VpZ2h0OjYwMDtcbiAgICAgIG1hcmdpbi1ib3R0b206NHB4O1xuICAgIFwiPlxuICAgICAgJHtfbGFuZyh7XG4gICAgICAgIGVuOiBcIkxvb2tpbmcgZm9yIHJhc3RlciBtYXBzP1wiLFxuICAgICAgICBmcjogXCJWb3VzIGNoZXJjaGV6IGRlcyBjYXJ0ZXMgcmFzdGVyID9cIixcbiAgICAgIH0pfVxuICAgIDwvZGl2PlxuXG4gICAgPGRpdiBzdHlsZT1cIlxuICAgICAgZm9udC1zaXplOjAuOTVyZW07XG4gICAgICBsaW5lLWhlaWdodDoxLjQ7XG4gICAgXCI+XG4gICAgICAke19sYW5nKHtcbiAgICAgICAgZW46IFwiUmFzdGVyIGxheWVycyBhcmUgYXZhaWxhYmxlIGluIG91ciBwcmV2aW91cyBFeHBsb3JlIHZpZXcuXCIsXG4gICAgICAgIGZyOiBcIkxlcyBjb3VjaGVzIHJhc3RlciBzb250IGRpc3BvbmlibGVzIGRhbnMgbOKAmWFuY2llbm5lIHZ1ZSBFeHBsb3Jlci5cIixcbiAgICAgIH0pfVxuICAgICAgPGFcbiAgICAgICAgaHJlZj1cImh0dHA6Ly9hZ2FkYXB0YXRpb25hdGxhcy1zdGFnZS5vcmcuczMtd2Vic2l0ZS11cy13ZXN0LTIuYW1hem9uYXdzLmNvbS9leHBsb3JlXCJcbiAgICAgICAgdGFyZ2V0PVwiX2JsYW5rXCJcbiAgICAgICAgcmVsPVwibm9vcGVuZXIgbm9yZWZlcnJlclwiXG4gICAgICAgIHN0eWxlPVwiXG4gICAgICAgICAgY29sb3I6I2ZmZmZmZjtcbiAgICAgICAgICBmb250LXdlaWdodDo2MDA7XG4gICAgICAgICAgdGV4dC1kZWNvcmF0aW9uOnVuZGVybGluZTtcbiAgICAgICAgICBtYXJnaW4tbGVmdDo0cHg7XG4gICAgICAgIFwiXG4gICAgICA+XG4gICAgICAgICR7X2xhbmcoe1xuICAgICAgICAgIGVuOiBcIk9wZW4gRXhwbG9yZSDihpJcIixcbiAgICAgICAgICBmcjogXCJPdXZyaXIgRXhwbG9yZXIg4oaSXCIsXG4gICAgICAgIH0pfVxuICAgICAgPC9hPlxuICAgIDwvZGl2PlxuICA8L2Rpdj5cbmA7XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTYiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJtZGAjICR7X2xhbmcobmJUZXh0LnNlbGVjdENhdGVnb3J5LnRpdGxlX21haW4pfWA7XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTciLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJtZGAjIyMgJHtfbGFuZyhuYlRleHQuc2VsZWN0Q2F0ZWdvcnkudGl0bGUpfVxuJHtfbGFuZyhuYlRleHQuc2VsZWN0Q2F0ZWdvcnkudGV4dCl9YDtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtOCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InZpZXdvZiBhdGxhc19jYXQgPSBJbnB1dHMucmFkaW8oW1wiSGF6YXJkXCIsIFwiRXhwb3N1cmVcIiwgXCJWdWxuZXJhYmlsaXR5XCJdLCB7XG4gIGxhYmVsOiBfbGFuZyhuYlRleHQuc2VsZWN0Q2F0ZWdvcnkuc2VsZWN0b3IudGl0bGUpLFxuICB2YWx1ZTogXCJIYXphcmRcIixcbiAgZm9ybWF0OiAobCkgPT4gIF9sYW5nKG5iVGV4dC5zZWxlY3RDYXRlZ29yeS5zZWxlY3Rvci5vcHRpb25zW2xdLnRpdGxlKVxufSlcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtOSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IntcbiAgcmV0dXJuIG1kYCR7X2xhbmcobmJUZXh0LnNlbGVjdENhdGVnb3J5LnNlbGVjdG9yLm9wdGlvbnNbYXRsYXNfY2F0XS5kZXNjcmlwdGlvbil9YFxufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xMCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Im1kYCMjIyAke19sYW5nKG5iVGV4dC5zZWxlY3RWYXJzLnRpdGxlKX1cbiR7X2xhbmcobmJUZXh0LnNlbGVjdFZhcnMudGV4dCl9YDtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTEiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJkZWZpbml0aW9ucyA9IGNyZWF0ZV9kZWZpbml0aW9ucyhhdGxhc19jYXQpO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xMiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InZpZXdvZiBEYXRhU2VsZWN0b3JfZm9ybSA9IHtcbiAgY29uc3QgZm9ybV9lbGVtZW50cyA9IHtcbiAgICBoYXphcmRHcm91cF9mb3JtOlxuICAgICAgYXRsYXNfY2F0ID09PSBcIkhhemFyZFwiXG4gICAgICAgID8gSW5wdXRzLmZvcm0oXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIGhhemFyZF9zZWw6IFNjcm9sbGluZ011bHRpU2VsZWN0X2NvbGxhcHNpYmxlKFxuICAgICAgICAgICAgICAgIC8vIE9iamVjdC5rZXlzKGhhemFyZF9kaWN0KSxcbiAgICAgICAgICAgICAgICBuZXcgTWFwKFxuICAgICAgICAgICAgICAgICAgT2JqZWN0LmVudHJpZXMoaGF6YXJkX2RpY3QpLm1hcCgoW2tleSwgdmFsdWVdKSA9PiBbXG4gICAgICAgICAgICAgICAgICAgIF9sYW5nKG5iVGV4dC5nZW5lcmFsLmhhemFyZHNba2V5XSksXG4gICAgICAgICAgICAgICAgICAgIGtleVxuICAgICAgICAgICAgICAgICAgXSlcbiAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgIGxhYmVsOiBfbGFuZyhuYlRleHQuc2VsZWN0VmFycy5mb3Jtcy5IYXphcmQuc2VsZWN0b3JzLmhhemFyZC50aXRsZSksIFxuICAgICAgICAgICAgICAgICAgdmFsdWVzOiBPYmplY3Qua2V5cyhoYXphcmRfZGljdCksXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICB0aW1lcGVyaW9kX3NlbDogU2Nyb2xsaW5nTXVsdGlTZWxlY3RfY29sbGFwc2libGUoXG4gICAgICAgICAgICAgICAgbmV3IE1hcChbXG4gICAgICAgICAgICAgICAgICBbX2xhbmcobmJUZXh0LnNlbGVjdFZhcnMuZm9ybXMuSGF6YXJkLnNlbGVjdG9ycy5wZXJpb2Qub3B0aW9ucy5iYXNlbGluZSksIFwiaGlzdG9yaWNcIl0sXG4gICAgICAgICAgICAgICAgICBbXCIyMDIxLTIwNDBcIiwgXCIyMDIxXzIwNDBcIl0sXG4gICAgICAgICAgICAgICAgICBbXCIyMDQxLTIwNjBcIiwgXCIyMDQxXzIwNjBcIl1cbiAgICAgICAgICAgICAgICBdKSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICBsYWJlbDogX2xhbmcobmJUZXh0LnNlbGVjdFZhcnMuZm9ybXMuSGF6YXJkLnNlbGVjdG9ycy5wZXJpb2QudGl0bGUpLFxuICAgICAgICAgICAgICAgICAgdmFsdWVzOiBbXCJoaXN0b3JpY1wiLCBcIjIwMjFfMjA0MFwiLCBcIjIwNDFfMjA2MFwiIF1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIClcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIHRlbXBsYXRlOiAoaW5wdXRzKSA9PlxuICAgICAgICAgICAgICAgIGh0bWxgPGg0PiR7X2xhbmcobmJUZXh0LnNlbGVjdFZhcnMuZm9ybXMuSGF6YXJkLm1haW5UaXRsZSl9PC9oND48ZGl2IHN0eWxlPVwiZGlzcGxheTogZmxleDsgZ2FwOiAyZW07XCI+ICR7T2JqZWN0LnZhbHVlcyhcbiAgICAgICAgICAgICAgICAgIGlucHV0c1xuICAgICAgICAgICAgICAgICl9PC9kaXY+YFxuICAgICAgICAgICAgfVxuICAgICAgICAgIClcbiAgICAgICAgOiBcIlwiLFxuICAgIHZ1bG5lcmFiaWxpdHlHcm91cF9mb3JtOlxuICAgICAgYXRsYXNfY2F0ID09PSBcIlZ1bG5lcmFiaWxpdHlcIlxuICAgICAgICA/IElucHV0cy5mb3JtKFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICB2dWxuZXJhYmlsaXR5X3NlbDogU2Nyb2xsaW5nTXVsdGlTZWxlY3RfY29sbGFwc2libGUoXG4gICAgICAgICAgICAgICAgW1wiRWR1Y2F0aW9uXCIsIFwiUG92ZXJ0eVwiLCBcIkdlbmRlclwiXSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICBsYWJlbDogX2xhbmcobmJUZXh0LnNlbGVjdFZhcnMuZm9ybXMuVnVsbmVyYWJpbGl0eS5zZWxlY3RvcnMudmFyaWFibGUudGl0bGUpLFxuICAgICAgICAgICAgICAgICAgdmFsdWVzOiBbXCJFZHVjYXRpb25cIiwgXCJQb3ZlcnR5XCIsIFwiR2VuZGVyXCJdLFxuICAgICAgICAgICAgICAgICAgZm9ybWF0OiAobCkgPT4gX2xhbmcobmJUZXh0LnNlbGVjdFZhcnMuZm9ybXMuVnVsbmVyYWJpbGl0eS5zZWxlY3RvcnMudmFyaWFibGUub3B0aW9uc1tsXSlcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIClcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIHRlbXBsYXRlOiAoaW5wdXRzKSA9PlxuICAgICAgICAgICAgICAgIGh0bWxgPGg0PiR7X2xhbmcobmJUZXh0LnNlbGVjdFZhcnMuZm9ybXMuVnVsbmVyYWJpbGl0eS5tYWluVGl0bGUpfTwvaDQ+PGRpdiBzdHlsZT1cImRpc3BsYXk6IGZsZXg7IGdhcDogMmVtO1wiPiAke09iamVjdC52YWx1ZXMoXG4gICAgICAgICAgICAgICAgICBpbnB1dHNcbiAgICAgICAgICAgICAgICApfTwvZGl2PmBcbiAgICAgICAgICAgIH1cbiAgICAgICAgICApXG4gICAgICAgIDogXCJcIixcbiAgICBleHBvc3VyZUdyb3VwX2Zvcm06XG4gICAgICBhdGxhc19jYXQgPT09IFwiRXhwb3N1cmVcIlxuICAgICAgICA/IElucHV0cy5mb3JtKFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBleHBvc3VyZUdyb3VwX3NlbDogU2Nyb2xsaW5nTXVsdGlTZWxlY3RfY29sbGFwc2libGUoXG4gICAgICAgICAgICAgICAgLy8gT2JqZWN0LnZhbHVlcyhjb21tb2RpdGllcykuZmxhdCgpLFxuICAgICAgICAgICAgICAgIFtcIkNyb3BcIiwgXCJMaXZlc3RvY2tcIiwgXCJQb3B1bGF0aW9uXCJdLFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgIGxhYmVsOiBcIkV4cG9zdXJlIENhdGVnb3J5XCIsXG4gICAgICAgICAgICAgICAgICB2YWx1ZXM6IFtcIkNyb3BcIiwgXCJMaXZlc3RvY2tcIiwgXCJQb3B1bGF0aW9uXCJdLFxuICAgICAgICAgICAgICAgICAgZm9ybWF0OiAobCkgPT4gX2xhbmcobmJUZXh0LnNlbGVjdFZhcnMuZm9ybXMuRXhwb3N1cmUuc2VsZWN0b3JzLnZhcmlhYmxlLm9wdGlvbnNbbF0pXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICApXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICB0ZW1wbGF0ZTogKGlucHV0cykgPT5cbiAgICAgICAgICAgICAgICBodG1sYDxoND4ke19sYW5nKG5iVGV4dC5zZWxlY3RWYXJzLmZvcm1zLkV4cG9zdXJlLm1haW5UaXRsZSl9PC9oND48ZGl2IHN0eWxlPVwiZGlzcGxheTogZmxleDsgZ2FwOiAyZW07XCI+ICR7T2JqZWN0LnZhbHVlcyhcbiAgICAgICAgICAgICAgICAgIGlucHV0c1xuICAgICAgICAgICAgICAgICl9PC9kaXY+YFxuICAgICAgICAgICAgfVxuICAgICAgICAgIClcbiAgICAgICAgOiBcIlwiXG4gIH07XG5cbiAgcmV0dXJuIElucHV0cy5mb3JtKGZvcm1fZWxlbWVudHMpO1xufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xMyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Im1kYCMjIyAke19sYW5nKG5iVGV4dC5zZWxlY3RHZW9nLnRpdGxlKX1cbiR7X2xhbmcobmJUZXh0LnNlbGVjdEdlb2cudGV4dCl9YDtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTQiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ2aWV3b2YgYWRtaW5fYWdncmVnYXRpb25MZXZlbCA9IHtcbiAgY29uc3QgYWRtaW5fY2hvaWNlcyA9IFsnYWRtaW4wX25hbWUnLCAnYWRtaW4xX25hbWUnLCAnYWRtaW4yX25hbWUnXVxuXG4gIGxldCByYWRpbyA9IElucHV0cy5yYWRpbyhhZG1pbl9jaG9pY2VzLCB7XG4gICAgbGFiZWw6IF9sYW5nKG5iVGV4dC5zZWxlY3RHZW9nLnNlbGVjdG9ycy5hZ2dyZWdhdGlvbkx2bC50aXRsZSksXG4gICAgdmFsdWU6IFwiYWRtaW4xX25hbWVcIixcbiAgICBmb3JtYXQ6IChsKSA9PiBfbGFuZyhuYlRleHQuc2VsZWN0R2VvZy5zZWxlY3RvcnMuYWdncmVnYXRpb25Mdmwub3B0aW9uc1tsXSlcbiAgfSk7XG4gIGxldCBzZWxlY3RvcnMgPSByYWRpby5xdWVyeVNlbGVjdG9yQWxsKFwiaW5wdXRbbmFtZT1pbnB1dF1cIik7XG4gIGxldCBsYWJlbHMgPSByYWRpby5xdWVyeVNlbGVjdG9yQWxsKFwibGFiZWxcIik7XG4gIGlmIChzZWxlY3RvcnMgJiYgc2VsZWN0b3JzWzJdICYmIGNvdW50cnkgPT09ICdTU0EnKSB7XG4gICAgc2VsZWN0b3JzWzJdLnRpdGxlID0gX2xhbmcobmJUZXh0LnNlbGVjdEdlb2cuc2VsZWN0b3JzLmFnZ3JlZ2F0aW9uTHZsLndhcm5pbmcpO1xuICB9XG4gIGlmIChsYWJlbHMgJiYgbGFiZWxzWzJdICYmIGNvdW50cnkgPT09ICdTU0EnKSB7XG4gICAgbGFiZWxzWzNdLnRpdGxlID1cbiAgICAgIF9sYW5nKG5iVGV4dC5zZWxlY3RHZW9nLnNlbGVjdG9ycy5hZ2dyZWdhdGlvbkx2bC53YXJuaW5nKTtcbiAgbGFiZWxzWzNdLnN0eWxlLmNvbG9yID0gXCIjYjgzMTBmXCI7XG4gIH1cbiAgcmV0dXJuIHJhZGlvO1xufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xNSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IntcbiAgbGV0IGFkbWluT3B0aW9ucyA9IFtcbiAgICBJbnB1dHMuYmluZChcbiAgICAgIElucHV0cy5zZWxlY3QoYWRtaW4wX25hbWVzLCB7IGxhYmVsOiBfbGFuZyhuYlRleHQuc2VsZWN0R2VvZy5zZWxlY3RvcnMuYWRtaW4wX25hbWUudGl0bGUpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogXCJTU0FcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXQ6IGwgPT4gX2xhbmcobmJUZXh0LmdlbmVyYWwuYWRtaW5OYW1lc1tsXSkgfHwgbH0pLFxuICAgICAgdmlld29mIGNvdW50cnlcbiAgICApXG4gIF07XG4gIFxuICBpZiAoW1wiYWRtaW4xX25hbWVcIiwgXCJhZG1pbjJfbmFtZVwiXS5pbmNsdWRlcyhhZG1pbl9hZ2dyZWdhdGlvbkxldmVsKSkge1xuICAgIGFkbWluT3B0aW9ucy5wdXNoKFxuICAgICAgSW5wdXRzLmJpbmQoXG4gICAgICAgIElucHV0cy5zZWxlY3QoYWRtaW4xX25hbWVzLCBcbiAgICAgICAgICAgICAgICAgICAgICB7IFxuICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6IF9sYW5nKG5iVGV4dC5zZWxlY3RHZW9nLnNlbGVjdG9ycy5hZG1pbjFfbmFtZS50aXRsZSksXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXQ6IGwgPT4gX2xhbmcobmJUZXh0LmdlbmVyYWwuYWRtaW5OYW1lc1tsXSkgfHwgbFxuICAgICAgICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICB2aWV3b2YgYWRtaW4xX3NlbFxuICAgICAgKVxuICAgICk7XG4gIH0gXG4gIFxuICBpZiAoYWRtaW5fYWdncmVnYXRpb25MZXZlbCA9PT0gXCJhZG1pbjJfbmFtZVwiKSB7XG4gICAgYWRtaW5PcHRpb25zLnB1c2goXG4gICAgICBJbnB1dHMuYmluZChcbiAgICAgICAgSW5wdXRzLnNlbGVjdChhZG1pbjJfbmFtZXMsIHsgbGFiZWw6IF9sYW5nKG5iVGV4dC5zZWxlY3RHZW9nLnNlbGVjdG9ycy5hZG1pbjJfbmFtZS50aXRsZSksXG4gICAgICAgICAgICAgICAgICAgICBmb3JtYXQ6IGwgPT4gX2xhbmcobmJUZXh0LmdlbmVyYWwuYWRtaW5OYW1lc1tsXSkgfHwgbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgIHZpZXdvZiBhZG1pbjJfc2VsXG4gICAgICApXG4gICAgKTtcbiAgfVxuICByZXR1cm4gSW5wdXRzLmZvcm0oYWRtaW5PcHRpb25zLCB7XG4gICAgdGVtcGxhdGU6IChpbnB1dHMpID0+XG4gICAgICBodGwuaHRtbGA8ZGl2IHN0eWxlPVwiZGlzcGxheTogZmxleDsgZ2FwOiAzZW1cIj4ke2lucHV0c308L2Rpdj5gXG4gIH0pO1xufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xNiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IntcbiAgY29uc3QgbGV2ZWxMYWJlbCA9IF9sYW5nKFxuICAgIG5iVGV4dC5zZWxlY3RHZW9nLnNlbGVjdG9ycy5hZ2dyZWdhdGlvbkx2bC5vcHRpb25zW2FkbWluX2FnZ3JlZ2F0aW9uTGV2ZWxdXG4gICkudG9Mb3dlckNhc2UoKVxuXG4gIGNvbnN0IGxldmVsVGV4dCA9IF9sYW5nKHtcbiAgICBlbjogYGF0IHRoZSAke2xldmVsTGFiZWx9IGxldmVsYCxcbiAgICBmcjogYGF1IG5pdmVhdSAke2xldmVsTGFiZWx9YFxuICB9KVxuXG4gIGxldCBtYWluVGV4dCA9IF9sYW5nKHtcbiAgICBlbjogYFZpZXdpbmcgJHtfbGFuZyhuYlRleHQuZ2VuZXJhbC5hZG1pbk5hbWVzW2NvdW50cnldKX1gLFxuICAgIGZyOiBgQWZmaWNoYWdlIGRlICR7X2xhbmcobmJUZXh0LmdlbmVyYWwuYWRtaW5OYW1lc1tjb3VudHJ5XSl9YFxuICB9KVxuXG4gIGlmIChhZG1pbl9hZ2dyZWdhdGlvbkxldmVsID09PSBcImFkbWluMl9uYW1lXCIgJiYgYWRtaW4xX3NlbCAhPT0gXCJGdWxsIENvdW50cnlcIikge1xuICAgIG1haW5UZXh0ICs9IF9sYW5nKHtcbiAgICAgIGVuOiBgLCAke2FkbWluMV9zZWx9YCxcbiAgICAgIGZyOiBgLCAke2FkbWluMV9zZWx9YFxuICAgIH0pXG4gIH1cblxuICBsZXQgaGlnaGxpZ2h0VGV4dCA9IFwiXCJcblxuICBpZiAoYWRtaW5fYWdncmVnYXRpb25MZXZlbCA9PT0gXCJhZG1pbjFfbmFtZVwiICYmIGFkbWluMV9zZWwgIT09IFwiRnVsbCBDb3VudHJ5XCIpIHtcbiAgICBoaWdobGlnaHRUZXh0ID0gX2xhbmcoe1xuICAgICAgZW46IGAke2FkbWluMV9zZWx9IGlzIGhpZ2hsaWdodGVkYCxcbiAgICAgIGZyOiBgJHthZG1pbjFfc2VsfSBlc3QgbWlzIGVuIHN1cmJyaWxsYW5jZWBcbiAgICB9KVxuICB9IGVsc2UgaWYgKFxuICAgIGFkbWluX2FnZ3JlZ2F0aW9uTGV2ZWwgPT09IFwiYWRtaW4yX25hbWVcIiAmJlxuICAgIGFkbWluMl9zZWwgIT09IFwiRnVsbCBSZWdpb25cIlxuICApIHtcbiAgICBoaWdobGlnaHRUZXh0ID0gX2xhbmcoe1xuICAgICAgZW46IGAke2FkbWluMl9zZWx9IGlzIGhpZ2hsaWdodGVkYCxcbiAgICAgIGZyOiBgJHthZG1pbjJfc2VsfSBlc3QgbWlzIGVuIHN1cmJyaWxsYW5jZWBcbiAgICB9KVxuICB9XG5cbiAgcmV0dXJuIGh0bWxgXG4gICAgPHAgc3R5bGU9XCJmb250LXNpemU6MS4zcmVtOyBmb250LXdlaWdodDo2MDA7IG1hcmdpbjowIDAgNHB4IDA7XCI+XG4gICAgICAke19sYW5nKHtcbiAgICAgICAgZW46IFwiU2VsZWN0aW9uIG92ZXJ2aWV3OlwiLFxuICAgICAgICBmcjogXCJBcGVyw6d1IGRlIGxhIHPDqWxlY3Rpb24gOlwiXG4gICAgICB9KX1cbiAgICA8L3A+XG4gICAgPHAgc3R5bGU9XCJmb250LXNpemU6MS4xNXJlbTsgbWFyZ2luOjA7IHBhZGRpbmctbGVmdDowLjc1cmVtO1wiPlxuICAgICAgPHN0cm9uZz5cbiAgICAgICAgJHttYWluVGV4dH0gJHtsZXZlbFRleHR9LiA8YnI+XG4gICAgICAgICR7aGlnaGxpZ2h0VGV4dCA/IGAke2hpZ2hsaWdodFRleHR9LmAgOiBcIlwifVxuICAgICAgPC9zdHJvbmc+XG4gICAgPC9wPlxuICBgXG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTE3IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoibWRgIyAke19sYW5nKG5iVGV4dC5WaWV3RXhwbG9yZS50aXRsZSl9XG4ke19sYW5nKG5iVGV4dC5WaWV3RXhwbG9yZS50ZXh0KX1gO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xOCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InZpZXdvZiBwcmV2aWV3VHlwZSA9IElucHV0cy5yYWRpbyhbXCJNYXBcIiwgXCJUYWJsZVwiLCBcIlBsb3RcIl0sIHtcbiAgLy8sIFwiSW50ZXJhY3RpdmUgTWFwXCIsXG4gIC8vIEljb25zIHRvIHRoZXNlIHdvdWxkIGJlIHByZXR0eVxuICB2YWx1ZTogXCJNYXBcIixcbiAgbGFiZWw6IF9sYW5nKG5iVGV4dC5WaWV3RXhwbG9yZS5zZWxlY3RvcnMucHJldmlldy50aXRsZSksXG4gIGZvcm1hdDogKGwpID0+IF9sYW5nKG5iVGV4dC5WaWV3RXhwbG9yZS5zZWxlY3RvcnMucHJldmlldy5vcHRpb25zW2xdKVxufSlcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTkiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ2aWV3b2YgZGF0YV90b192aXN1YWxpc2UgPSB7XG4gIGlmIChwcmV2aWV3VHlwZSA9PT0gXCJNYXBcIikge1xuICAgIHJldHVybiBnZW5lcmF0ZU1hcEZvcm0oKVxuICB9IGVsc2UgaWYgKHByZXZpZXdUeXBlID09PSBcIlRhYmxlXCIpIHtcbiAgICByZXR1cm4gSW5wdXRzLnNlYXJjaChOYkRhdGFbXCJleHBsb3JlX2RhdGFcIl0sIHtwbGFjZWhvbGRlcjogX2xhbmcobmJUZXh0LmdlbmVyYWwuc2VhcmNoKX0pO1xuICB9IGVsc2UgaWYgKHByZXZpZXdUeXBlID09PSBcIlBsb3RcIikge1xuICAgIHJldHVybiBnZW5lcmF0ZVBsb3RGb3JtKClcbiAgfVxuICBcbiAgZnVuY3Rpb24gZ2VuZXJhdGVNYXBGb3JtKCkge1xuICAgIGNvbnN0IGZvcm1fZWxlbWVudHMgPSBbXTtcbiAgICBpZiAoYXRsYXNfY2F0ID09PSBcIkhhemFyZFwiKSB7XG4gICAgICBsZXQgaGF6YXJkT3B0aW9ucyA9IERhdGFTZWxlY3Rvcl9mb3JtLmhhemFyZEdyb3VwX2Zvcm0uaGF6YXJkX3NlbDtcbiAgICAgIGZvcm1fZWxlbWVudHMucHVzaChcbiAgICAgICAgSW5wdXRzLmJpbmQoXG4gICAgICAgICAgSW5wdXRzLnNlbGVjdChcbiAgICAgICAgICAgIGhhemFyZE9wdGlvbnMubWFwKCh2YWx1ZSkgPT4gdmFsdWUpLFxuICAgICAgICAgICAgLy8gbmV3IE1hcChcbiAgICAgICAgICAgIC8vICAgaGF6YXJkT3B0aW9ucy5tYXAoKHZhbHVlKSA9PiBbX2xhbmcobmJUZXh0LnNlbGVjdFZhcnMuZm9ybXMuSGF6YXJkLnNlbGVjdG9ycy5oYXphcmQub3B0aW9uc1t2YWx1ZV0pLCB2YWx1ZV0pXG4gICAgICAgICAgICAvLyApLFxuICAgICAgICAgICAgeyBsYWJlbDogX2xhbmcobmJUZXh0LnNlbGVjdFZhcnMuZm9ybXMuSGF6YXJkLnNlbGVjdG9ycy5oYXphcmQudGl0bGUpLFxuICAgICAgICAgICAgICBmb3JtYXQ6IGwgPT4gX2xhbmcobmJUZXh0LmdlbmVyYWwuaGF6YXJkc1tsXSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICApLFxuICAgICAgICAgIHZpZXdvZiBoYXphcmRfc2VsXG4gICAgICAgIClcbiAgICAgICk7XG4gICAgICBsZXQgdGltZVBlcmlvZE9wdGlvbnMgPSBEYXRhU2VsZWN0b3JfZm9ybS5oYXphcmRHcm91cF9mb3JtLnRpbWVwZXJpb2Rfc2VsO1xuICAgICAgZm9ybV9lbGVtZW50cy5wdXNoKFxuICAgICAgICBJbnB1dHMuYmluZChcbiAgICAgICAgICBJbnB1dHMuc2VsZWN0KFxuICAgICAgICAgICAgdGltZVBlcmlvZE9wdGlvbnMubWFwKCh2YWx1ZSkgPT4gdmFsdWUpLFxuICAgICAgICAgICAgLy8gbmV3IE1hcChcbiAgICAgICAgICAgIC8vICAgdGltZVBlcmlvZE9wdGlvbnMubWFwKCh2YWx1ZSkgPT4gW3RpbWVQZXJpb2RfZGljdFt2YWx1ZV0sIHZhbHVlXSlcbiAgICAgICAgICAgIC8vICksXG4gICAgICAgICAgICB7IGxhYmVsOiBfbGFuZyhuYlRleHQuc2VsZWN0VmFycy5mb3Jtcy5IYXphcmQuc2VsZWN0b3JzLnBlcmlvZC50aXRsZSksXG4gICAgICAgICAgICAgIGZvcm1hdDogbCA9PiBfbGFuZyhuYlRleHQuc2VsZWN0VmFycy5mb3Jtcy5IYXphcmQuc2VsZWN0b3JzLnBlcmlvZC5vcHRpb25zW2xdKSB8fCBsXG4gICAgICAgICAgICB9XG4gICAgICAgICAgKSxcbiAgICAgICAgICB2aWV3b2YgdGltZV9zZWxcbiAgICAgICAgKVxuICAgICAgKTtcbiAgICAgIGlmICh0aW1lX3NlbCAhPT0gXCJoaXN0b3JpY1wiKSB7XG4gICAgICAgIGZvcm1fZWxlbWVudHMucHVzaChcbiAgICAgICAgICBJbnB1dHMuYmluZChcbiAgICAgICAgICAgIElucHV0cy5zZWxlY3QoW1wiU1NQMjQ1XCIsIFwiU1NQNTg1XCJdLCB7IGxhYmVsOiBfbGFuZyhuYlRleHQuVmlld0V4cGxvcmUuc2VsZWN0b3JzLnZpc3VhbGlzZVZhcnMuaGF6YXJkcy5zY2VuYXJpby50aXRsZSl9KSxcbiAgICAgICAgICAgIHZpZXdvZiBzc3Bfc2VsXG4gICAgICAgICAgKVxuICAgICAgICApO1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICBpZiAoYXRsYXNfY2F0ID09PSBcIlZ1bG5lcmFiaWxpdHlcIikge1xuICAgICAgZm9ybV9lbGVtZW50cy5wdXNoKFxuICAgICAgICBJbnB1dHMuYmluZChcbiAgICAgICAgICBJbnB1dHMuc2VsZWN0KFxuICAgICAgICAgICAgRGF0YVNlbGVjdG9yX2Zvcm0udnVsbmVyYWJpbGl0eUdyb3VwX2Zvcm0udnVsbmVyYWJpbGl0eV9zZWwsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIGxhYmVsOiBfbGFuZyhuYlRleHQuc2VsZWN0Q2F0ZWdvcnkuc2VsZWN0b3Iub3B0aW9ucy5WdWxuZXJhYmlsaXR5LnRpdGxlKSxcbiAgICAgICAgICAgICAgZm9ybWF0OiBsID0+IF9sYW5nKG5iVGV4dC5zZWxlY3RWYXJzLmZvcm1zLlZ1bG5lcmFiaWxpdHkuc2VsZWN0b3JzLnZhcmlhYmxlLm9wdGlvbnNbbF0pfHxsXG4gICAgICAgICAgICAgIC8vIGxhYmVsOiBcIkFkYXB0aXZlIENhcGFjaXR5XCJcbiAgICAgICAgICAgIH1cbiAgICAgICAgICApLFxuICAgICAgICAgIHZpZXdvZiBhY19jYXRcbiAgICAgICAgKVxuICAgICAgKTtcbiAgICAgIGlmIChhY19jYXQgPT09IFwiR2VuZGVyXCIpIHtcbiAgICAgICAgbGV0IGFjX3N1YmNhdHMgPSBPYmplY3Qua2V5cyh2dWxuZXJhYmlsaXR5X2RpY3RbXCJnZW5kZXJcIl0pXG4gICAgICAgIGZvcm1fZWxlbWVudHMucHVzaChcbiAgICAgICAgICBJbnB1dHMuYmluZChcbiAgICAgICAgICAgIElucHV0cy5zZWxlY3QoYWNfc3ViY2F0cywge1xuICAgICAgICAgICAgICBsYWJlbDogX2xhbmcobmJUZXh0LlZpZXdFeHBsb3JlLnNlbGVjdG9ycy52aXN1YWxpc2VWYXJzLnZ1bG5lcmFiaWxpdHkuZ2VuZGVyLnRpdGxlKSxcbiAgICAgICAgICAgICAgZm9ybWF0OiBsID0+IF9sYW5nKG5iVGV4dC5WaWV3RXhwbG9yZS5zZWxlY3RvcnMudmlzdWFsaXNlVmFycy52dWxuZXJhYmlsaXR5LmdlbmRlci5vcHRpb25zW2xdKVxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICB2aWV3b2YgYWNfc3ViY2F0XG4gICAgICAgICAgKVxuICAgICAgICApO1xuICAgICAgfSBlbHNlIGlmIChhY19jYXQgPT09IFwiUG92ZXJ0eVwiKSB7XG4gICAgICAgIC8vIGxldCBhY19zdWJjYXRzID0gbmV3IE1hcChcbiAgICAgICAgLy8gICBPYmplY3QuZW50cmllcyh2dWxuZXJhYmlsaXR5X2RpY3RbXCJwb3ZlcnR5XCJdKS5tYXAoKFtrZXksIHZhbHVlXSkgPT4gW1xuICAgICAgICAvLyAgICAgdmFsdWUsXG4gICAgICAgIC8vICAgICBrZXlcbiAgICAgICAgLy8gICBdKVxuICAgICAgICAvLyApO1xuICAgICAgICBsZXQgYWNfc3ViY2F0cyA9IE9iamVjdC5rZXlzKHZ1bG5lcmFiaWxpdHlfZGljdFtcInBvdmVydHlcIl0pXG4gICAgICAgIGZvcm1fZWxlbWVudHMucHVzaChcbiAgICAgICAgICBJbnB1dHMuYmluZChcbiAgICAgICAgICAgIElucHV0cy5zZWxlY3QoYWNfc3ViY2F0cywge1xuICAgICAgICAgICAgICBsYWJlbDogIF9sYW5nKG5iVGV4dC5WaWV3RXhwbG9yZS5zZWxlY3RvcnMudmlzdWFsaXNlVmFycy52dWxuZXJhYmlsaXR5LnBvdmVydHkudGl0bGUpLFxuICAgICAgICAgICAgICBmb3JtYXQ6IGwgPT4gX2xhbmcobmJUZXh0LlZpZXdFeHBsb3JlLnNlbGVjdG9ycy52aXN1YWxpc2VWYXJzLnZ1bG5lcmFiaWxpdHkucG92ZXJ0eS5vcHRpb25zW2xdKVxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICB2aWV3b2YgYWNfc3ViY2F0XG4gICAgICAgICAgKVxuICAgICAgICApO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoYXRsYXNfY2F0ID09PSBcIkV4cG9zdXJlXCIpIHtcbiAgICAgIGxldCBzdWJUaXRsZTtcbiAgICAgIGxldCBzdWJTZWxlY3Rpb25zO1xuICAgICAgaWYgKGV4cG9zdXJlX2NhdCA9PT0gXCJQb3B1bGF0aW9uXCIpIHtcbiAgICAgICAgc3ViVGl0bGUgPSBfbGFuZyhuYlRleHQuVmlld0V4cGxvcmUuc2VsZWN0b3JzLnZpc3VhbGlzZVZhcnMuZXhwb3N1cmUucG9wdWxhdGlvbi50aXRsZSk7XG4gICAgICAgIHN1YlNlbGVjdGlvbnMgPSBbXCJ0b3RhbF9wb3BcIiwgXCJydXJhbF9wb3BcIiwgXCJ1cmJhbl9wb3BcIl1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHN1YlRpdGxlID0gX2xhbmcobmJUZXh0LlZpZXdFeHBsb3JlLnNlbGVjdG9ycy52aXN1YWxpc2VWYXJzLmV4cG9zdXJlLmNvbW1vZGl0eS50aXRsZSk7XG4gICAgICAgIHN1YlNlbGVjdGlvbnMgPSBjb21tb2RpdGllc1tleHBvc3VyZV9jYXRdO1xuICAgICAgfVxuXG4gICAgICBmb3JtX2VsZW1lbnRzLnB1c2goXG4gICAgICAgIElucHV0cy5iaW5kKFxuICAgICAgICAgIElucHV0cy5zZWxlY3QoXG4gICAgICAgICAgICBEYXRhU2VsZWN0b3JfZm9ybS5leHBvc3VyZUdyb3VwX2Zvcm0uZXhwb3N1cmVHcm91cF9zZWwsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIGxhYmVsOiBfbGFuZyhuYlRleHQuVmlld0V4cGxvcmUuc2VsZWN0b3JzLnZpc3VhbGlzZVZhcnMuZXhwb3N1cmUudGl0bGUpLFxuICAgICAgICAgICAgICBmb3JtYXQ6IGwgPT4gX2xhbmcobmJUZXh0LnNlbGVjdFZhcnMuZm9ybXMuRXhwb3N1cmUuc2VsZWN0b3JzLnZhcmlhYmxlLm9wdGlvbnNbbF0pXG4gICAgICAgICAgICB9XG4gICAgICAgICAgKSxcbiAgICAgICAgICB2aWV3b2YgZXhwb3N1cmVfY2F0XG4gICAgICAgIClcbiAgICAgICk7XG4gICAgICBmb3JtX2VsZW1lbnRzLnB1c2goXG4gICAgICAgIElucHV0cy5iaW5kKFxuICAgICAgICAgIElucHV0cy5zZWxlY3Qoc3ViU2VsZWN0aW9ucywge1xuICAgICAgICAgICAgbGFiZWw6IHN1YlRpdGxlLFxuICAgICAgICAgICAgZm9ybWF0OiBsID0+IF9sYW5nKG5iVGV4dC5WaWV3RXhwbG9yZS5zZWxlY3RvcnMudmlzdWFsaXNlVmFycy5leHBvc3VyZS5wb3B1bGF0aW9uLm9wdGlvbnNbbF0gfHwgbmJUZXh0LmdlbmVyYWwuY29tbW9kaXRpZXNbbF0pXG4gICAgICAgICAgfSksXG4gICAgICAgICAgdmlld29mIGV4cG9zdXJlX3N1YkNhdFxuICAgICAgICApXG4gICAgICApO1xuICAgICAgaWYgKGV4cG9zdXJlX2NhdCAhPT0gXCJQb3B1bGF0aW9uXCIpIHtcbiAgICAgICAgZm9ybV9lbGVtZW50cy5wdXNoKFxuICAgICAgICAgICAgICAgICAgICBJbnB1dHMuYmluZChcbiAgICAgICAgICAgICAgSW5wdXRzLnNlbGVjdChleHBvc3VyZV92YXJfY2hvaWNlcywge1xuICAgICAgICAgICAgICAgIGxhYmVsOiBfbGFuZyhuYlRleHQuVmlld0V4cGxvcmUuc2VsZWN0b3JzLnZpc3VhbGlzZVZhcnMuZXhwb3N1cmUuZXhwb3N1cmVWYXJpYWJsZS50aXRsZSksXG4gICAgICAgICAgICAgICAgZm9ybWF0OiAodCkgPT4gX2xhbmcobmJUZXh0LlZpZXdFeHBsb3JlLnNlbGVjdG9ycy52aXN1YWxpc2VWYXJzLmV4cG9zdXJlLmV4cG9zdXJlVmFyaWFibGUub3B0aW9uc1t0XSlcbiAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgIHZpZXdvZiBleHBvc3VyZV92YXJcbiAgICAgICAgICAgIClcbiAgICAgICAgKVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gSW5wdXRzLmZvcm0oZm9ybV9lbGVtZW50cywge1xuICAgICAgdGVtcGxhdGU6IChpbnB1dHMpID0+XG4gICAgICAgIGh0bC5odG1sYDxoMz4ke19sYW5nKG5iVGV4dC5WaWV3RXhwbG9yZS5zZWxlY3RvcnMudmlzdWFsaXNlVmFycy50aXRsZU1hcCl9PC9oMz4gPGRpdiBzdHlsZT1cImRpc3BsYXk6IGZsZXg7IGdhcDogM2VtXCI+JHtpbnB1dHN9PC9kaXY+YFxuICAgIH0pO1xuICB9XG4gIFxuICBmdW5jdGlvbiBnZW5lcmF0ZVBsb3RGb3JtKCkge1xuICAgIGxldCBmb3JtX2VsZW1lbnRzID0gW107XG4gICAgbGV0IHRpdGxlID0gX2xhbmcobmJUZXh0LlZpZXdFeHBsb3JlLnNlbGVjdG9ycy52aXN1YWxpc2VWYXJzLnRpdGxlUGxvdCk7XG4gICAgaWYgKGF0bGFzX2NhdCA9PT0gXCJFeHBvc3VyZVwiKSB7XG4gICAgICBmb3JtX2VsZW1lbnRzLnB1c2goXG4gICAgICAgIElucHV0cy5iaW5kKFxuICAgICAgICAgIElucHV0cy5zZWxlY3QoXG4gICAgICAgICAgICBEYXRhU2VsZWN0b3JfZm9ybS5leHBvc3VyZUdyb3VwX2Zvcm0uZXhwb3N1cmVHcm91cF9zZWwsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIGxhYmVsOiBfbGFuZyhuYlRleHQuVmlld0V4cGxvcmUuc2VsZWN0b3JzLnZpc3VhbGlzZVZhcnMuZXhwb3N1cmUudGl0bGUpLFxuICAgICAgICAgICAgICBmb3JtYXQ6IGwgPT4gX2xhbmcobmJUZXh0LnNlbGVjdFZhcnMuZm9ybXMuRXhwb3N1cmUuc2VsZWN0b3JzLnZhcmlhYmxlLm9wdGlvbnNbbF0pXG4gICAgICAgICAgICB9XG4gICAgICAgICAgKSxcbiAgICAgICAgICB2aWV3b2YgZXhwb3N1cmVfY2F0XG4gICAgICAgIClcbiAgICAgICk7XG4gICAgICBpZiAoZXhwb3N1cmVfY2F0LmluY2x1ZGVzKFwiQ3JvcFwiKSB8fCBleHBvc3VyZV9jYXQuaW5jbHVkZXMoXCJMaXZlc3RvY2tcIikpIHtcbiAgICAgICAgZm9ybV9lbGVtZW50cy5wdXNoKFxuICAgICAgICAgIElucHV0cy5iaW5kKFxuICAgICAgICAgICAgSW5wdXRzLnNlbGVjdChleHBvc3VyZV92YXJfY2hvaWNlcywge1xuICAgICAgICAgICAgICBsYWJlbDogX2xhbmcobmJUZXh0LlZpZXdFeHBsb3JlLnNlbGVjdG9ycy52aXN1YWxpc2VWYXJzLmV4cG9zdXJlLmV4cG9zdXJlVmFyaWFibGUudGl0bGUpLFxuICAgICAgICAgICAgICBmb3JtYXQ6ICh0KSA9PiBfbGFuZyhuYlRleHQuVmlld0V4cGxvcmUuc2VsZWN0b3JzLnZpc3VhbGlzZVZhcnMuZXhwb3N1cmUuZXhwb3N1cmVWYXJpYWJsZS5vcHRpb25zW3RdKVxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICB2aWV3b2YgZXhwb3N1cmVfdmFyXG4gICAgICAgICAgKVxuICAgICAgICApO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoYXRsYXNfY2F0ID09PSBcIkhhemFyZFwiKSB7XG4gICAgICBsZXQgaGF6YXJkT3B0aW9ucyA9IERhdGFTZWxlY3Rvcl9mb3JtLmhhemFyZEdyb3VwX2Zvcm0uaGF6YXJkX3NlbDtcbiAgICAgIGZvcm1fZWxlbWVudHMucHVzaChcbiAgICAgICAgSW5wdXRzLmJpbmQoXG4gICAgICAgICAgSW5wdXRzLnNlbGVjdChcbiAgICAgICAgICAgIGhhemFyZE9wdGlvbnMubWFwKCh2YWx1ZSkgPT4gdmFsdWUpLFxuICAgICAgICAgICAgeyBsYWJlbDogX2xhbmcobmJUZXh0LnNlbGVjdFZhcnMuZm9ybXMuSGF6YXJkLnNlbGVjdG9ycy5oYXphcmQudGl0bGUpLFxuICAgICAgICAgICAgICBmb3JtYXQ6IGwgPT4gX2xhbmcobmJUZXh0LmdlbmVyYWwuaGF6YXJkc1tsXSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICApLFxuICAgICAgICAgIHZpZXdvZiBoYXphcmRfc2VsXG4gICAgICAgIClcbiAgICAgICk7XG4gICAgfVxuICAgIGlmIChhdGxhc19jYXQgPT09IFwiVnVsbmVyYWJpbGl0eVwiKSB7XG4gICAgICB0aXRsZSA9IFwiXCI7XG4gICAgfVxuICAgIHJldHVybiBJbnB1dHMuZm9ybShmb3JtX2VsZW1lbnRzLCB7XG4gICAgICB0ZW1wbGF0ZTogKGlucHV0cykgPT5cbiAgICAgICAgaHRsLmh0bWxgPGgzPiR7dGl0bGV9PC9oMz4gPGRpdiBzdHlsZT1cImRpc3BsYXk6IGZsZXg7IGdhcDogM2VtXCI+JHtpbnB1dHN9PC9kaXY+YFxuICAgIH0pO1xuICB9XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTIwIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiZGF0YV9wcmV2aWV3ID0ge1xuICBpZiAocHJldmlld1R5cGUgPT09IFwiTWFwXCIpIHtcbiAgICByZXR1cm4gaHRtbGA8ZGl2PiR7bWFwKCl9PC9kaXY+YDtcbiAgICAvLyB9IGVsc2UgaWYgKHByZXZpZXdUeXBlID09PSBcIkludGVyYWN0aXZlIE1hcFwiKSB7XG4gICAgLy8gICByZXR1cm4gaHRtbGA8ZGl2PiR7TWFwSW5mby5NYXBMZWdlbmR9PC9kaXY+IDxkaXY+JHtNYXBDb250YWluZXJ9PC9kaXY+YDtcbiAgfSBlbHNlIGlmIChwcmV2aWV3VHlwZSA9PT0gXCJUYWJsZVwiKSB7XG4gICAgcmV0dXJuIGh0bWxgPGRpdj4ke2NyZWF0ZVRhYmxlKCl9PC9kaXY+YDtcbiAgfSBlbHNlIGlmIChwcmV2aWV3VHlwZSA9PT0gXCJQbG90XCIpIHtcbiAgICAvLyByZXR1cm4gaHRtbGA8ZGl2PiR7Y29udGFpbmVyMn08L2Rpdj5gO1xuICAgIHJldHVybiBodG1sYDxkaXY+JHthd2FpdCBjcmVhdGVQbG90KCl9PC9kaXY+YDtcbiAgfVxufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0yMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Im1kYCMgJHtfbGFuZyhuYlRleHQuZG93bmxvYWQudGl0bGUpfWA7XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTIyIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoidmlld29mIGRvd25sb2FkX2Zvcm1hdCA9IHtcbiAgLy8gbGV0IGRvd25sYW9kX29wdGlvbnM7XG4gIGxldCBkb3dubG9hZF9vcHRpb25zID0gW1wiUGFycXVldFwiLCBcIkNTVlwiLCBcIkpTT05cIl07IC8vLCBcIkdFT1BBUlFVRVRcIiwgXCJHRU9KU09OXCJdO1xuXG4gIHJldHVybiBJbnB1dHMucmFkaW8oZG93bmxvYWRfb3B0aW9ucywge1xuICAgIGxhYmVsOiBfbGFuZyhuYlRleHQuZG93bmxvYWQuc2VsZWN0b3IudGl0bGUpLFxuICAgIHZhbHVlOiBcIlBhcnF1ZXRcIlxuICB9KTtcbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMjMiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJodG1sYDxkaXYgPiR7ZG93bmxvYWRfYnV0dG9uX2luaXRpYXRlKCl9PC9kaXY+YDtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMjQiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJtZGAjIyMgJHtfbGFuZyhuYlRleHQuZG93bmxvYWQuYm91bmRhcmllcy50aXRsZSl9YDtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMjUiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJkb3dubG9hZF9zcGF0aWFsX2J1dHRvbigpO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0yNiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Im1kYCMgJHtfbGFuZyhuYlRleHQuU1RBQy50aXRsZSl9XG5cbiR7X2xhbmcobmJUZXh0LlNUQUMudGV4dCl9YDtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMjciLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ2aWV3b2YgY29kZUxhbmd1YWdlID0gSW5wdXRzLnJhZGlvKFtcIlJcIiwgXCJQeXRob25cIiwgXCJOb0NvZGVcIl0sIHtcbiAgbGFiZWw6IFwiTGFuZ3VhZ2VcIixcbiAgdmFsdWU6IFwiTm9Db2RlXCIsXG4gIGZvcm1hdDogbCA9PiBfbGFuZyhuYlRleHQuZ2VuZXJhbFtsXSkgfHwgbFxufSlcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMjgiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJjb2RlY2h1bmsgPSB7XG5cbiAgaWYgKGNvZGVMYW5ndWFnZSA9PT0gXCJOb0NvZGVcIikge1xuICAgIHJldHVybiBodG1sYDxpZnJhbWUgc3JjID0naHR0cHM6Ly9yYWRpYW50ZWFydGguZ2l0aHViLmlvL3N0YWMtYnJvd3Nlci8jL2V4dGVybmFsL2RpZ2l0YWwtYXRsYXMuczMuYW1hem9uYXdzLmNvbS9zdGFjL3B1YmxpY19zdGFjL2NhdGFsb2cuanNvbj8ubGFuZ3VhZ2U9JHtsYW5ndWFnZS5rZXl9JyBzdHlsZT1cIndpZHRoOjEwMCU7IGhlaWdodDogODAwcHg7XCI+YFxuICB9IGVsc2Uge1xuICAgIGxldCBjb2RlX3RleHQgPSBnZW5lcmF0ZV9jb2RlVGV4dChjb2RlTGFuZ3VhZ2UpXG4gICAgICBsZXQgbWFya2Rvd25fY29kZSA9IG1kYFxuXFxgXFxgXFxgICR7Y29kZUxhbmd1YWdlLnRvTG93ZXJDYXNlKCl9XG4ke2NvZGVfdGV4dH1cblxcYFxcYFxcYGBcbiAgICAgcmV0dXJuIGh0bWxgPGRpdiBzdHlsZT0nb3ZlcmZsb3c6IGF1dG87IG1heC1oZWlnaHQ6IDgwMHB4OyBiYWNrZ3JvdW5kLWNvbG9yOiNGOEY4Rjg7cGFkZGluZy1sZWZ0OiAxMHB4Jz4ke21hcmtkb3duX2NvZGV9PC9kaXY+YFxuICB9XG5cbmZ1bmN0aW9uIGdlbmVyYXRlX2NvZGVUZXh0KGNvZGVMYW5nKSB7XG4gIGxldCBjb2RlX3RleHRcbiAgc3dpdGNoIChjb2RlTGFuZykge1xuICAgIGNhc2UgXCJSXCI6XG4gICAgICBsZXQgcl9hZG1pblF1ZXJ5ID0gY291bnRyeSAhPT0gJ1NTQScgPyBgYWRtaW5fcXVlcnkgPC0gJ1NFTEVDVCAqIGZyb20gXCJhdGxhcy1yZWdpb25fYWRtaW4wX2hhcm1vbml6ZWRcIiBXSEVSRSBhZG1pbjBfbmFtZSA9IFxcXFwnJHtjb3VudHJ5fVxcXFwnJ2AgOiBgYWRtaW5fcXVlcnkgPC0gJ1NFTEVDVCAqIGZyb20gXCJhdGxhcy1yZWdpb25fYWRtaW4wX2hhcm1vbml6ZWRcIidgXG4gICAgY29kZV90ZXh0ID0gYGxpYnJhcnkodGVycmEpXG5saWJyYXJ5KHJzdGFjKVxuXG5hZG1pbl9wYXRoIDwtICcvdnNpczMvZGlnaXRhbC1hdGxhcy9ib3VuZGFyaWVzL2F0bGFzLXJlZ2lvbl9hZG1pbjBfaGFybW9uaXplZC5wYXJxdWV0JyBcbiR7cl9hZG1pblF1ZXJ5fVxuYWRtaW5Cb3VuZHMgPC0gdmVjdChhZG1pbl9wYXRoLCBxdWVyeSA9IGFkbWluX3F1ZXJ5KVxuc3RhY19wYXRoIDwtIFwiaHR0cHM6Ly8vZGlnaXRhbC1hdGxhcy5zMy5hbWF6b25hd3MuY29tL3N0YWMvcHVibGljX3N0YWMvY2F0YWxvZy5qc29uXCJcbnN0YWNfY2F0YWxvZyA8LSByZWFkX3N0YWMoc3RhY19wYXRoKVxuXG5jaGlsZHJlbiA8LSBsaW5rcyhzdGFjX2NhdGFsb2csIHJlbCA9PSAnY2hpbGQnKVxuY2hpbGRyZW5fZGYgPC0gZG8uY2FsbChcInJiaW5kXCIsIGxhcHBseShjaGlsZHJlbiwgYXMuZGF0YS5mcmFtZSkpXG5wcmludChjaGlsZHJlbl9kZiR0aXRsZSlcblxuaGF6YXJkQ2F0YWxvZyA8LSBsaW5rX29wZW4oY2hpbGRyZW5bW2dyZXAoXCJIYXphcmRcIiwgY2hpbGRyZW4pXV0pXG5wcmludChoYXphcmRDYXRhbG9nJGRlc2NyaXB0aW9uKVxuaGF6X2NoaWxkcmVuIDwtIGxpbmtzKGhhemFyZENhdGFsb2csIHJlbCA9PSAnY2hpbGQnKVxuaGF6X2NoaWxkcmVuX2RmIDwtIGRvLmNhbGwoXCJyYmluZFwiLCBsYXBwbHkoaGF6X2NoaWxkcmVuLCBhcy5kYXRhLmZyYW1lKSlcbmhhel9jaGlsZHJlbl9kZiRkZXNjcmlwdGlvbiA8LSBzYXBwbHkoaGF6X2NoaWxkcmVuLCBcXCh4KSB7XG4gIGNoaWxkIDwtIGxpbmtfb3Blbih4KVxuICBjaGlsZCRkZXNjcmlwdGlvblxufSlcblxuaGF6YXJkX2l0ZW1zIDwtIGxpbmtfb3BlbihoYXpfY2hpbGRyZW5bWzFdXSkgfD4gXG4gICAgcnN0YWM6OnJlYWRfaXRlbXMobGltaXQgPSAxMClcblxuaGF6YXJkX2l0ZW1zIHw+IFxuICAgIHJzdGFjOjppdGVtc19hc190aWJibGUoKVxuXG5wb3NzaWJsZV9maWx0ZXJzIDwtIGl0ZW1zX3Byb3BlcnRpZXMoaGF6YXJkX2l0ZW1zKVxuXG5tZWFuTkRXU190aWZzIDwtIGhhemFyZF9pdGVtcyB8PiBcbiAgICByc3RhYzo6aXRlbXNfZmlsdGVyKGZpbHRlcl9mbiA9IFxcKHgpIHtcbiAgICAgICAgKHgkcHJvcGVydGllcyRcXGBhdGxhczpoYXphcmRcXGAgPT0gXCJORFdTXCIgXG4gICAgICAgICYgeCRwcm9wZXJ0aWVzJFxcYGF0bGFzOnN0YXRpc3RpY1xcYCA9PSBcIm1lYW5cIikgfSkgfD5cbiAgICByc3RhYzo6YXNzZXRzX3VybCgpXG5cbmNvdW50cnlfZGF0YSA8LSBtZWFuTkRXU190aWZzIHw+IFxuICAgIGdzdWIoeD0gXywgJ2h0dHBzOi8vZGlnaXRhbC1hdGxhcy5zMy5hbWF6b25hd3MuY29tLycsICcvdnNpczMvZGlnaXRhbC1hdGxhcycpIHw+XG4gICAgdGVycmE6OnJhc3QoKSB8PiBcbiAgICBjcm9wKGFkbWluQm91bmRzLCBtYXNrID0gVClcbiAgICBcbnBsb3QoY291bnRyeV9kYXRhKWA7XG4gICAgICBicmVha1xuICAgIGNhc2UgJ1B5dGhvbic6XG4gICAgICBjb2RlX3RleHQgPSBgaW1wb3J0IHB5c3RhY1xuaW1wb3J0IHJhc3RlcmlvXG5pbXBvcnQgcGFuZGFzIGFzIHBkXG5mcm9tIG1hdHBsb3RsaWIgaW1wb3J0IHB5cGxvdFxuZnJvbSBweXN0YWNfY2xpZW50IGltcG9ydCBDbGllbnRcblxuc3RhY19wYXRoID0gXCJodHRwczovL2RpZ2l0YWwtYXRsYXMuczMuYW1hem9uYXdzLmNvbS9zdGFjL3B1YmxpY19zdGFjL2NhdGFsb2cuanNvblwiXG5cbmNhdGFsb2cgPSBDbGllbnQub3BlbihzdGFjX3BhdGgpXG5wcmludChjYXRhbG9nLnRpdGxlKVxucHJpbnQoY2F0YWxvZy5kZXNjcmlwdGlvbilcblxuY2hpbGRyZW4gPSBbXVxuZm9yIGNoaWxkIGluIGNhdGFsb2cuZ2V0X2NoaWxkcmVuKCk6XG4gICAgcHJpbnQoY2hpbGQpXG4gICAgdGl0bGUgPSBjaGlsZC50aXRsZVxuICAgIGlkID0gY2hpbGQuaWRcbiAgICBkZXNjcmlwdGlvbiA9IGNoaWxkLmRlc2NyaXB0aW9uXG4gICAgc2VsZl9ocmVmID0gY2hpbGQuc2VsZl9ocmVmXG4gICAga2V5d29yZHMgPSBjaGlsZC5leHRyYV9maWVsZHMuZ2V0KCdrZXl3b3JkcycpIG9yIE5vbmVcbiAgICBjaGlsZHJlbi5hcHBlbmQoe1xuICAgICAgICAndGl0bGUnOiB0aXRsZSxcbiAgICAgICAgJ2lkJzogY2hpbGQuaWQsXG4gICAgICAgICdkZXNjcmlwdGlvbic6IGRlc2NyaXB0aW9uLFxuICAgICAgICAna2V5d29yZHMnOiBrZXl3b3JkcyxcbiAgICAgICAgJ3NlbGZfaHJlZic6IHNlbGZfaHJlZlxuICAgIH0pXG5cbmNhdGFsb2dfZGYgPSBwZC5EYXRhRnJhbWUoY2hpbGRyZW4pXG5cbmhhemFyZENhdGFsb2cgPSBjYXRhbG9nLmdldF9jaGlsZCgnaGF6YXJkX2NhdGFsb2cnKVxucHJpbnQoaGF6YXJkQ2F0YWxvZy5kZXNjcmlwdGlvbilcblxuaGF6YXJkX2l0ZW1zID0gW11cbmZvciBjaGlsZCBpbiBoYXphcmRDYXRhbG9nLmdldF9jaGlsZHJlbigpOlxuICAgIHByaW50KGNoaWxkKVxuICAgIHRpdGxlID0gY2hpbGQudGl0bGVcbiAgICBpZCA9IGNoaWxkLmlkXG4gICAgZGVzY3JpcHRpb24gPSBjaGlsZC5kZXNjcmlwdGlvblxuICAgIHNlbGZfaHJlZiA9IGNoaWxkLnNlbGZfaHJlZlxuICAgIGtleXdvcmRzID0gY2hpbGQuZXh0cmFfZmllbGRzLmdldCgna2V5d29yZHMnKSBvciBOb25lXG4gICAgaGF6YXJkX2l0ZW1zLmFwcGVuZCh7XG4gICAgICAgICd0aXRsZSc6IHRpdGxlLFxuICAgICAgICAnaWQnOiBjaGlsZC5pZCxcbiAgICAgICAgJ2Rlc2NyaXB0aW9uJzogZGVzY3JpcHRpb24sXG4gICAgICAgICdrZXl3b3Jkcyc6IGtleXdvcmRzLFxuICAgICAgICAnc2VsZl9ocmVmJzogc2VsZl9ocmVmXG4gICAgfSlcblxuaGF6YXJkQ2F0YWxvZ19kZiA9IHBkLkRhdGFGcmFtZShoYXphcmRfaXRlbXMpXG5cbmhhemFyZF90aW1lc2VyaWVzID0gaGF6YXJkQ2F0YWxvZy5nZXRfY2hpbGQoJ2hhemFyZF90aW1lc2VyaWVzX2FubnVhbCcpXG5wcmludChoYXphcmRfdGltZXNlcmllcy5kZXNjcmlwdGlvbilcblxucG9zc2libGVfZmlsdGVycyA9IG5leHQoaGF6YXJkX3RpbWVzZXJpZXMuZ2V0X2l0ZW1zKCkpLnByb3BlcnRpZXMua2V5cygpXG5wcmludChwb3NzaWJsZV9maWx0ZXJzKVxuXG5kZWYgZmlsdGVyX2l0ZW1zKGl0ZW1fZ2VuZXJhdG9yOnB5c3RhYy5JdGVtQ29sbGVjdGlvbiwgZmlsdGVyczpkaWN0LCBsaW1pdDppbnQ9MTApOlxuICAgIGNvdW50ID0gMFxuICAgIGZvciBpdGVtIGluIGl0ZW1fZ2VuZXJhdG9yOlxuICAgICAgICBmb3Iga2V5LCB2YWx1ZSBpbiBmaWx0ZXJzLml0ZW1zKCk6XG4gICAgICAgICAgICBpZiBpdGVtLnByb3BlcnRpZXMuZ2V0KGtleSkgIT0gdmFsdWU6XG4gICAgICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgZWxzZTpcbiAgICAgICAgICAgIHlpZWxkIGl0ZW1cbiAgICAgICAgICAgIGNvdW50ICs9IDFcbiAgICAgICAgICAgIGlmIGNvdW50ID49IGxpbWl0OlxuICAgICAgICAgICAgICAgIGJyZWFrXG5cbml0ZW1fZmlsdGVyczogeydhdGxhczpoYXphcmQnOiAnTkRXUycsICdhdGxhczpzdGF0aXN0aWMnOiAnbWVhbid9XG5cbm1lYW5ORFdTX2l0ZW1zID0gZmlsdGVyX2l0ZW1zKGhhemFyZF90aW1lc2VyaWVzLmdldF9pdGVtcygpLCB7J2F0bGFzOmhhemFyZCc6ICdORFdTJywgJ2F0bGFzOnN0YXRpc3RpYyc6ICdtZWFuJ30sIGxpbWl0PTEwKVxuXG5ORFdTX2Fzc2V0cyA9IFtdXG5mb3IgaXRlbSBpbiBtZWFuTkRXU19pdGVtczpcbiAgICBwcmludChpdGVtKVxuICAgIGFzc2V0cyA9IGl0ZW0uZ2V0X2Fzc2V0cygpXG4gICAgZm9yIGtleSBpbiBhc3NldHMua2V5cygpOlxuICAgICAgICBwcmludChrZXkpXG4gICAgICAgIE5EV1NfYXNzZXRzLmFwcGVuZChhc3NldHMuZ2V0KGtleSkuaHJlZilcblxuXG53aXRoIHJhc3RlcmlvLm9wZW4oTkRXU19hc3NldHNbMF0ucmVwbGFjZSgnaHR0cHM6Ly9kaWdpdGFsLWF0bGFzLnMzLmFtYXpvbmF3cy5jb20vJywgJ3MzOi8vZGlnaXRhbC1hdGxhcycpKSBhcyBzcmM6XG4gICAgcHJpbnQoc3JjLm1ldGEpXG4gICAgcHlwbG90Lmltc2hvdyhzcmMucmVhZCgxMikpXG4gICAgcHlwbG90LnNob3coKWBcbiAgICAgIGJyZWFrXG4gIH1cbiAgcmV0dXJuIGNvZGVfdGV4dFxufVxuICBcbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMjkiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJtZGAjICR7X2xhbmcobmJUZXh0Lm1ldGhvZHNfc291cmNlcy50aXRsZSl9YDtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMzAiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJtZGAjIyAke19sYW5nKG5iVGV4dC5tZXRob2RzX3NvdXJjZXMuZGF0YXNldHMudGl0bGUpfWA7XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTMxIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoibWRgIyMjICR7X2xhbmcobmJUZXh0Lm1ldGhvZHNfc291cmNlcy5kYXRhc2V0cy5ib3VuZGFyaWVzLnRpdGxlKX1cbiR7X2xhbmcobmJUZXh0Lm1ldGhvZHNfc291cmNlcy5kYXRhc2V0cy5ib3VuZGFyaWVzLnRleHQpfWA7XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTMyIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoibWRgIyMjICR7X2xhbmcobmJUZXh0Lm1ldGhvZHNfc291cmNlcy5kYXRhc2V0cy5IYXphcmRzLnRpdGxlKX1cbiR7X2xhbmcobmJUZXh0Lm1ldGhvZHNfc291cmNlcy5kYXRhc2V0cy5IYXphcmRzLnRleHQpfWA7XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTMzIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoibWRgIyMjICR7X2xhbmcobmJUZXh0Lm1ldGhvZHNfc291cmNlcy5kYXRhc2V0cy5leHBvc3VyZURTLnRpdGxlKX1gO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0zNCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Im1kYCMjIyMgJHtfbGFuZyhuYlRleHQubWV0aG9kc19zb3VyY2VzLmRhdGFzZXRzLmV4cG9zdXJlRFMudm9wSEEudGl0bGUpfVxuJHtfbGFuZyhuYlRleHQubWV0aG9kc19zb3VyY2VzLmRhdGFzZXRzLmV4cG9zdXJlRFMudm9wSEEudGV4dCl9YDtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMzUiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJtZGAjIyMjICR7X2xhbmcobmJUZXh0Lm1ldGhvZHNfc291cmNlcy5kYXRhc2V0cy5leHBvc3VyZURTLnBvcHVsYXRpb24udGl0bGUpfVxuJHtfbGFuZyhuYlRleHQubWV0aG9kc19zb3VyY2VzLmRhdGFzZXRzLmV4cG9zdXJlRFMucG9wdWxhdGlvbi50ZXh0KX1gO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0zNiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Im1kYCMjIyAke19sYW5nKG5iVGV4dC5tZXRob2RzX3NvdXJjZXMuZGF0YXNldHMuYWNEUy50aXRsZSl9YDtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMzciLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJtZGAjIyMjICR7X2xhbmcobmJUZXh0Lm1ldGhvZHNfc291cmNlcy5kYXRhc2V0cy5hY0RTLkZlbWFsZVdlbGxiZWluZy50aXRsZSl9XG4gJHtfbGFuZyhuYlRleHQubWV0aG9kc19zb3VyY2VzLmRhdGFzZXRzLmFjRFMuRmVtYWxlV2VsbGJlaW5nLnRleHQpfWA7XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTM4IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoibWRgIyMjIyAke19sYW5nKG5iVGV4dC5tZXRob2RzX3NvdXJjZXMuZGF0YXNldHMuYWNEUy5wb3ZlcnR5LnRpdGxlKX1cbiR7X2xhbmcobmJUZXh0Lm1ldGhvZHNfc291cmNlcy5kYXRhc2V0cy5hY0RTLnBvdmVydHkudGV4dCl9YDtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMzkiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJtZGAjIyBJbXBvcnRzYDtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNDAiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJHRU9TID0ge1xuICBjb25zdCBpbml0Z2Vvc0pzID0gKGF3YWl0IGltcG9ydChcImh0dHBzOi8vY2RuLnNreXBhY2suZGV2L2dlb3Mtd2FzbUAyLjAuMFwiKSlcbiAgICAuZGVmYXVsdDtcbiAgY29uc3QgZ2VvcyA9IGF3YWl0IGluaXRnZW9zSnMoKTtcblxuICBmdW5jdGlvbiBnZW9zR2VvbUZyb21XS0Iod2tiKSB7XG4gICAgY29uc3Qgd2tiUHRyID0gZ2Vvcy5Nb2R1bGUuX21hbGxvYyh3a2IubGVuZ3RoKTsgLy9BbGxvY2F0ZSBtZW1vcnkgZm9yIHRoZSBnZW9tXG4gICAgZ2Vvcy5Nb2R1bGUuSEVBUFU4LnNldCh3a2IsIHdrYlB0cik7XG4gICAgY29uc3QgZ2VvbVB0ciA9IGdlb3MuR0VPU0dlb21Gcm9tV0tCX2J1Zih3a2JQdHIsIHdrYi5sZW5ndGgpO1xuICAgIGdlb3MuTW9kdWxlLl9mcmVlKHdrYlB0cik7XG4gICAgcmV0dXJuIGdlb21QdHI7XG4gIH1cbiAgXG4gIGNvbnN0IGdlb3NHZW9tVG9HZW9qc29uID0gKFxuICAgIGF3YWl0IGltcG9ydChcImh0dHBzOi8vY2RuLnNreXBhY2suZGV2L2dlb3Mtd2FzbS9oZWxwZXJzXCIpXG4gICkuZ2Vvc0dlb21Ub0dlb2pzb247XG5cbiAgcmV0dXJuIHsgZ2Vvc0dlb21Ub0dlb2pzb24sIGdlb3NHZW9tRnJvbVdLQiwgZ2VvcyB9O1xufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC00MSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Imdlb19kYiA9IHtcbiAgbGV0IGRiID0gYXdhaXQgRHVja0RCQ2xpZW50Lm9mKHtcbiAgICAvLyBhZG1pbjBfZ2VvbTogRmlsZUF0dGFjaG1lbnQoXCJhdGxhcy1yZWdpb25fYWRtaW4wX3NpbXBsaWZpZWQucGFycXVldFwiKSxcbiAgICBhZG1pbjFfZ2VvbTogRmlsZUF0dGFjaG1lbnQoXCJhdGxhcy1yZWdpb25fYWRtaW4xX3NpbXBsaWZpZWQucGFycXVldFwiKVxuICB9KTtcbiAgYXdhaXQgZGIucXVlcnkoYFxuICAgIENSRUFURSBWSUVXIGFkbWluMl9nZW9tIEFTXG4gICAgU0VMRUNUICpcbiAgICBGUk9NIHJlYWRfcGFycXVldChcIiR7cmVzb2x2ZVdpbmRvd3NDYWNoZUlzc3VlKFxuICAgICAgXCJodHRwczovL2RpZ2l0YWwtYXRsYXMuczMuYW1hem9uYXdzLmNvbS9ib3VuZGFyaWVzL2F0bGFzLXJlZ2lvbl9hZG1pbjJfc2ltcGxpZmllZC5wYXJxdWV0XCJcbiAgICApfVwiKWApO1xuICByZXR1cm4gZGI7XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTQyIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiZGIgPSB7XG4gIC8vIGNvbnN0IGRiID0gYXdhaXQgRHVja0RCQ2xpZW50Lm9mKCk7XG4gIGxldCBkYiA9IGF3YWl0IER1Y2tEQkNsaWVudC5vZih7XG4gICAgLy8gYWRtaW4wX2dlb206IEZpbGVBdHRhY2htZW50KFwiYXRsYXMtcmVnaW9uX2FkbWluMF9zaW1wbGlmaWVkLnBhcnF1ZXRcIiksXG4gICAgLy8gYWRtaW4xX2dlb206IEZpbGVBdHRhY2htZW50KFwiYXRsYXMtcmVnaW9uX2FkbWluMV9zaW1wbGlmaWVkLnBhcnF1ZXRcIilcbiAgfSk7XG4gIC8vIGF3YWl0IGRiLnF1ZXJ5KGBcbiAgLy8gICBDUkVBVEUgVklFVyBhZG1pbjJfZ2VvbSBBU1xuICAvLyAgIFNFTEVDVCAqXG4gIC8vICAgRlJPTSByZWFkX3BhcnF1ZXQoXCJodHRwczovL2RpZ2l0YWwtYXRsYXMuczMuYW1hem9uYXdzLmNvbS9ib3VuZGFyaWVzL2F0bGFzLXJlZ2lvbl9hZG1pbjJfc2ltcGxpZmllZC5wYXJxdWV0XCIpYCk7XG4gIC8vIGF3YWl0IGRiLnF1ZXJ5KGBcbiAgLy8gICBDUkVBVEUgVklFVyBleHBvc3VyZVBvcHVsYXRpb24gQVNcbiAgLy8gICBTRUxFQ1QgKlxuICAvLyAgIEZST00gcmVhZF9wYXJxdWV0KCcke3MzUGF0aHNbXCJQb3B1bGF0aW9uXCJdfScpYCk7XG4gIC8vIGF3YWl0IGRiLnF1ZXJ5KGBcbiAgLy8gICBDUkVBVEUgVklFVyBFeHBvc3VyZSBBU1xuICAvLyAgIFNFTEVDVCAqXG4gIC8vICAgRlJPTSByZWFkX3BhcnF1ZXQoJyR7czNQYXRoc1tcIkV4cG9zdXJlXCJdW1wiZXhwb3N1cmVcIl19JylgKTtcbiAgLy8gLy8gYXdhaXQgYnVpbGRfREIoZGIsIGF0bGFzX2NhdCk7XG4gIC8vIGF3YWl0IGRiLnF1ZXJ5KGBcbiAgLy8gICAgIENSRUFURSBWSUVXIGV4cG9zdXJlQ3JvcCBBU1xuICAvLyAgICAgU0VMRUNUICpcbiAgLy8gICAgIEZST00gcmVhZF9wYXJxdWV0KCcke3MzUGF0aHNbXCJFeHBvc3VyZVwiXVtcImNyb3BWT1BcIl19JylcbiAgLy8gICAgIFVOSU9OIEFMTFxuICAvLyAgICAgU0VMRUNUICpcbiAgLy8gICAgIEZST00gcmVhZF9wYXJxdWV0KCcke3MzUGF0aHNbXCJFeHBvc3VyZVwiXVtcImNyb3BIQVwiXX0nKVxuICAvLyAgIGApO1xuICAvLyBhd2FpdCBkYi5xdWVyeShgXG4gIC8vICAgICBDUkVBVEUgVklFVyBleHBvc3VyZUxpdmVzdG9jayBBU1xuICAvLyAgICAgU0VMRUNUICpcbiAgLy8gICAgIEZST00gcmVhZF9wYXJxdWV0KCcke3MzUGF0aHNbXCJFeHBvc3VyZVwiXVtcImxpdmVzdG9ja1ZPUFwiXX0nKVxuICAvLyAgICAgV0hFUkUgXCJjcm9wXCIgTk9UIExJS0UgJyV0b3RhbCUnXG4gIC8vICAgICBVTklPTiBBTExcbiAgLy8gICAgIFNFTEVDVCAqXG4gIC8vICAgICBGUk9NIHJlYWRfcGFycXVldCgnJHtzM1BhdGhzW1wiRXhwb3N1cmVcIl1bXCJsaXZlc3RvY2tOdW1cIl19JylcbiAgLy8gICAgIFdIRVJFIFwiY3JvcFwiIE5PVCBMSUtFICcldG90YWwlJ1xuICAvLyAgIGApO1xuICBhd2FpdCBkYi5xdWVyeShgXG4gICAgICBDUkVBVEUgVklFVyBIYXphcmQgQVNcbiAgICAgIFNFTEVDVCBhZG1pbjBfbmFtZSwgYWRtaW4xX25hbWUsIGFkbWluMl9uYW1lLCBzY2VuYXJpbywgdGltZWZyYW1lLCBoYXphcmQsIHZhbHVlXG4gICAgICBGUk9NIHJlYWRfcGFycXVldCgnJHtzM1BhdGhzW1wiSGF6YXJkXCJdfScpXG4gICAgYCk7XG4gIHJldHVybiBhd2FpdCBkYjtcbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNDMiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJDaGVja09SQWRkX0V4cG9zdXJlVGFibGUgPSBhc3luYyAoZGIpID0+IHtcbiAgbGV0IHRhYmxlcyA9IGF3YWl0IGRiLmRlc2NyaWJlVGFibGVzKCkudGhlbigocikgPT4gci5tYXAoKGQpID0+IGQubmFtZSkpO1xuICBpZiAoIXRhYmxlcy5pbmNsdWRlcyhcIkV4cG9zdXJlXCIpKSB7XG4gICAgYXdhaXQgZGIucXVlcnkoYFxuICAgIENSRUFURSBWSUVXIGV4cG9zdXJlUG9wdWxhdGlvbiBBU1xuICAgIFNFTEVDVCAqXG4gICAgRlJPTSByZWFkX3BhcnF1ZXQoJyR7czNQYXRoc1tcIlBvcHVsYXRpb25cIl19JylgKTtcbiAgICBhd2FpdCBkYi5xdWVyeShgXG4gICAgQ1JFQVRFIFZJRVcgRXhwb3N1cmUgQVNcbiAgICBTRUxFQ1QgKlxuICAgIEZST00gcmVhZF9wYXJxdWV0KCcke3MzUGF0aHNbXCJFeHBvc3VyZVwiXVtcImV4cG9zdXJlXCJdfScpYCk7XG4gICAgYXdhaXQgZGIucXVlcnkoYFxuICAgICAgQ1JFQVRFIFZJRVcgZXhwb3N1cmVDcm9wIEFTXG4gICAgICAgICAgU0VMRUNUIGFkbWluMF9uYW1lLCBhZG1pbjFfbmFtZSwgYWRtaW4yX25hbWUsIGNyb3AsIGV4cG9zdXJlLCBcInZhbHVlXCIgYXMgb2xkX3ZhbHVlLCBDQVNFIFxuICAgICAgICAgICAgV0hFTiB2YWx1ZSA8IDEwMDAgVEhFTiAwXG4gICAgICAgICAgICAgIEVMU0UgdmFsdWVcbiAgICAgICAgICAgIEVORCBBUyB2YWx1ZVxuICAgICAgICAgIEZST00gcmVhZF9wYXJxdWV0KCcke3MzUGF0aHNbXCJFeHBvc3VyZVwiXVtcImNyb3BWT1BcIl19JylcbiAgICAgICAgICBVTklPTiBBTExcbiAgICAgICAgICBTRUxFQ1QgYWRtaW4wX25hbWUsIGFkbWluMV9uYW1lLCBhZG1pbjJfbmFtZSwgY3JvcCwgZXhwb3N1cmUsIFwidmFsdWVcIiBhcyBvbGRfdmFsdWUsIENBU0VcbiAgICAgICAgICAgIFdIRU4gdmFsdWUgPCAxMDAwIFRIRU4gMFxuICAgICAgICAgICAgICBFTFNFIHZhbHVlXG4gICAgICAgICAgICBFTkQgQVMgdmFsdWVcbiAgICAgICAgICBGUk9NIHJlYWRfcGFycXVldCgnJHtzM1BhdGhzW1wiRXhwb3N1cmVcIl1bXCJjcm9wSEFcIl19JylgKTtcbiAgICBhd2FpdCBkYi5xdWVyeShgXG4gICAgICBDUkVBVEUgVklFVyBleHBvc3VyZUxpdmVzdG9jayBBU1xuICAgICAgU0VMRUNUICpcbiAgICAgIEZST00gcmVhZF9wYXJxdWV0KCcke3MzUGF0aHNbXCJFeHBvc3VyZVwiXVtcImxpdmVzdG9ja1ZPUFwiXX0nKVxuICAgICAgV0hFUkUgXCJjcm9wXCIgTk9UIExJS0UgJyV0b3RhbCUnXG4gICAgICBVTklPTiBBTExcbiAgICAgIFNFTEVDVCAqXG4gICAgICBGUk9NIHJlYWRfcGFycXVldCgnJHtzM1BhdGhzW1wiRXhwb3N1cmVcIl1bXCJsaXZlc3RvY2tOdW1cIl19JylcbiAgICAgIFdIRVJFIFwiY3JvcFwiIE5PVCBMSUtFICcldG90YWwlJ1xuICAgIGApO1xuICB9XG59O1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC00NCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IkNoZWNrT1JBZGRfVnVsblRhYmxlID0gYXN5bmMgKGRiKSA9PiB7XG4gIGxldCB0YWJsZXMgPSBhd2FpdCBkYi5kZXNjcmliZVRhYmxlcygpLnRoZW4oKHIpID0+IHIubWFwKChkKSA9PiBkLm5hbWUpKTtcbiAgaWYgKCF0YWJsZXMuaW5jbHVkZXMoXCJWdWxuZXJhYmlsaXR5XCIpKSB7XG4gICAgYXdhaXQgZGIucXVlcnkoYFxuICAgICAgQ1JFQVRFIFZJRVcgVnVsbmVyYWJpbGl0eSBBU1xuICAgICAgU0VMRUNUICpcbiAgICAgIEZST00gcmVhZF9wYXJxdWV0KCcke3MzUGF0aHNbXCJWdWxuZXJhYmlsaXR5XCJdfScpXG4gICAgYCk7XG4gIH1cbn07XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTQ1IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiaW1wb3J0IHsgU2Nyb2xsaW5nTXVsdGlTZWxlY3RfY29sbGFwc2libGUgfSBmcm9tIFwiQGJyYXlkZW4teW91bmdiZXJnL3Njcm9sbGluZy1tdWx0aS1zZWxlY3RcIjtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNDYiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ0dXJmUmV3aW5kID0gcmVxdWlyZShcIkB0dXJmL3R1cmZcIikudGhlbigodCkgPT4gdC5yZXdpbmQpO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC00NyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImltcG9ydCB7IHJlc29sdmVXaW5kb3dzQ2FjaGVJc3N1ZSB9IGZyb20gXCI3MjI4MWJlMmYxM2EwYTcyXCI7XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTQ4IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoibWRgIyMgTm90ZWJvb2sgVmFyaWFibGVzYDtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNDkiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJub3RlYm9va1RpdGxlID0gX2xhbmcoe1xuICBlbjogXCJFeHBsb3JlIHRoZSBEYXRhc2V0c1wiLFxuICBmcjogXCJFeHBsb3JlciBsZXMgamV1eCBkZSBkb25uw6llc1wiLFxufSk7XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTUwIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoidGltZVBlcmlvZF9kaWN0ID0gbmV3IE9iamVjdCh7XG4gIGhpc3RvcmljOiBcIkJhc2VsaW5lXCIsXG4gIFwiMjAyMV8yMDQwXCI6IFwiMjA0MFwiLFxuICBcIjIwNDFfMjA2MFwiOiBcIjIwNjBcIixcbn0pO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC01MSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InMzUGF0aHMgPSBuZXcgT2JqZWN0KHtcbiAgUG9wdWxhdGlvbjogcmVzb2x2ZVdpbmRvd3NDYWNoZUlzc3VlKFxuICAgIFwiczM6Ly9kaWdpdGFsLWF0bGFzL3BvcHVsYXRpb24vd29ybGRwb3BfMjAyMC9wb3B1bGF0aW9uX2FkbWluQUxMLnBhcnF1ZXRcIixcbiAgKSxcbiAgRXhwb3N1cmU6IHtcbiAgICBleHBvc3VyZTogcmVzb2x2ZVdpbmRvd3NDYWNoZUlzc3VlKFxuICAgICAgXCJzMzovL2RpZ2l0YWwtYXRsYXMvZXhwb3N1cmUvZXhwb3N1cmVfYWRtaW5BTEwucGFycXVldFwiLFxuICAgICksXG4gICAgY3JvcFZPUDogcmVzb2x2ZVdpbmRvd3NDYWNoZUlzc3VlKFxuICAgICAgXCJzMzovL2RpZ2l0YWwtYXRsYXMvZXhwb3N1cmUvbWFwc3BhbS9wcm9jZXNzZWQvY3JvcF9oYV9hZG0ucGFycXVldFwiLFxuICAgICksXG4gICAgY3JvcEhBOiByZXNvbHZlV2luZG93c0NhY2hlSXNzdWUoXG4gICAgICBcInMzOi8vZGlnaXRhbC1hdGxhcy9leHBvc3VyZS9tYXBzcGFtL3Byb2Nlc3NlZC9jcm9wX3ZvcF9hZG0ucGFycXVldFwiLFxuICAgICksXG4gICAgbGl2ZXN0b2NrVk9QOiByZXNvbHZlV2luZG93c0NhY2hlSXNzdWUoXG4gICAgICBcInMzOi8vZGlnaXRhbC1hdGxhcy9leHBvc3VyZS9saXZlc3RvY2svcHJvY2Vzc2VkL2xpdmVzdG9ja192b3BfYWRtLnBhcnF1ZXRcIixcbiAgICApLFxuICAgIGxpdmVzdG9ja051bTogcmVzb2x2ZVdpbmRvd3NDYWNoZUlzc3VlKFxuICAgICAgXCJzMzovL2RpZ2l0YWwtYXRsYXMvZXhwb3N1cmUvbGl2ZXN0b2NrL3Byb2Nlc3NlZC9saXZlc3RvY2tfbm9fYWRtLnBhcnF1ZXRcIixcbiAgICApLFxuICB9LFxuICBIYXphcmQ6IHJlc29sdmVXaW5kb3dzQ2FjaGVJc3N1ZShcbiAgICBcInMzOi8vZGlnaXRhbC1hdGxhcy9oYXphcmRzL2hhemFyZF90aW1lc2VyaWVzX21lYW4vYW5udWFsL2hhel9tZWFuc19hZG0ucGFycXVldFwiLFxuICApLFxuICBWdWxuZXJhYmlsaXR5OlxuICAgIC8vIFwiaHR0cHM6Ly9kaWdpdGFsLWF0bGFzLnMzLmFtYXpvbmF3cy5jb20vdnVsbmVyYWJpbGl0eS92dWxuZXJhYmlsaXR5X2FkbTAtMS0yLnBhcnF1ZXRcIlxuICAgIHJlc29sdmVXaW5kb3dzQ2FjaGVJc3N1ZShcbiAgICAgIFwiczM6Ly9kaWdpdGFsLWF0bGFzL3Z1bG5lcmFiaWxpdHkvdnVsbmVyYWJpbGl0eV9hZG1pbkFMTC5wYXJxdWV0XCIsXG4gICAgKSxcbn0pO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC01MiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Im1lcmdlZF9zY2FsZSA9IFtcIiNFQzVBNDdcIiwgXCIjZmZiMzQ3XCIsIFwiI0Y3RDczMlwiLCBcIiNhM2FiMmVcIl0ucmV2ZXJzZSgpO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC01MyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImhhemFyZF9kaWN0ID0gbmV3IE9iamVjdCh7XG4gIEhTSF9tYXg6IHtcbiAgICBuYW1lOiBcIk1heCBIdW1hbiBIZWF0IFN0cmVzc1wiLFxuICAgIHRocmVzaG9sZHM6IFsyNywgMzIsIDQxLCA1NF0sXG4gICAgLy8gY29sb3VyczogW1wiI2I3ZTNjOVwiLCBcIiNmZmVjODBcIiwgXCIjZmZiMzQ3XCIsIFwiI2Y3ODE1NFwiLCBcIiNkYjNhMzRcIl1cbiAgICBjb2xvdXJzOiBtZXJnZWRfc2NhbGUuY29uY2F0KFtcIiNCODU0N0ZcIl0pLFxuICB9LFxuICBIU0hfbWVhbjoge1xuICAgIG5hbWU6IFwiTWVhbiBIdW1hbiBIZWF0IFN0cmVzc1wiLFxuICAgIHRocmVzaG9sZHM6IFsyNywgMzIsIDQxLCA1NF0sXG4gICAgLy8gY29sb3VyczogW1wiI2I3ZTNjOVwiLCBcIiNmZmVjODBcIiwgXCIjZmZiMzQ3XCIsIFwiI2Y3ODE1NFwiLCBcIiNkYjNhMzRcIl1cbiAgICBjb2xvdXJzOiBtZXJnZWRfc2NhbGUuY29uY2F0KFtcIiNCODU0N0ZcIl0pLFxuICB9LFxuICBORFdMMDoge1xuICAgIG5hbWU6IFwiTnVtYmVyIG9mIFdhdGVybG9nZ2luZyBEYXlzXCIsXG4gICAgdGhyZXNob2xkczogWzIsIDUsIDhdLFxuICAgIC8vIGNvbG91cnM6IFtcIiNiN2UzYzlcIiwgXCIjZmZlYzgwXCIsIFwiI2ZmYjM0N1wiLCBcIiNmNzgxNTRcIl1cbiAgICBjb2xvdXJzOiBtZXJnZWRfc2NhbGUsXG4gIH0sXG4gIE5EV1M6IHtcbiAgICBuYW1lOiBcIk51bWJlciBvZiBEYXlzIG9mIFdhdGVyIFN0cmVzc1wiLFxuICAgIHRocmVzaG9sZHM6IFsxNSwgMjAsIDI1XSxcbiAgICAvLyBjb2xvdXJzOiBbXCIjYjdlM2M5XCIsIFwiI2ZmZWM4MFwiLCBcIiNmZmIzNDdcIiwgXCIjZjc4MTU0XCJdXG4gICAgY29sb3VyczogbWVyZ2VkX3NjYWxlLFxuICB9LFxuICBOVHgzNToge1xuICAgIG5hbWU6IFwiTnVtYmVyIG9mIEhlYXQgU3RyZXNzIERheXMgZm9yIE1haXplXCIsXG4gICAgdGhyZXNob2xkczogWzEwLCAyMCwgMjVdLFxuICAgIC8vIGNvbG91cnM6IFtcIiNiN2UzYzlcIiwgXCIjZmZlYzgwXCIsIFwiI2ZmYjM0N1wiLCBcIiNmNzgxNTRcIl1cbiAgICBjb2xvdXJzOiBtZXJnZWRfc2NhbGUsXG4gIH0sXG4gIE5UeDQwOiB7XG4gICAgbmFtZTogXCJOdW1iZXIgb2YgSGVhdCBTdHJlc3MgRGF5cyBmb3IgR2VuZXJpYyBDcm9wc1wiLFxuICAgIHRocmVzaG9sZHM6IFsxLCA1LCAxMF0sXG4gICAgLy8gY29sb3VyczogW1wiI2I3ZTNjOVwiLCBcIiNmZmVjODBcIiwgXCIjZmZiMzQ3XCIsIFwiI2Y3ODE1NFwiXVxuICAgIGNvbG91cnM6IG1lcmdlZF9zY2FsZSxcbiAgfSxcbiAgVEFJOiB7XG4gICAgbmFtZTogXCJUaG9ybnRod2FpdGUncyBBcmlkaXR5IEluZGV4XCIsXG4gICAgdGhyZXNob2xkczogWzQwLCA2MCwgODBdLFxuICAgIC8vIGNvbG91cnM6IFtcIiNiN2UzYzlcIiwgXCIjZmZlYzgwXCIsIFwiI2ZmYjM0N1wiLCBcIiNmNzgxNTRcIl1cbiAgICBjb2xvdXJzOiBtZXJnZWRfc2NhbGUsXG4gIH0sXG4gIFRISV9tYXg6IHtcbiAgICBuYW1lOiBcIk1heCBDYXR0bGUgVGhlcm1hbCBIdW1pZGl0eSBJbmRleFwiLFxuICAgIHRocmVzaG9sZHM6IFs3MiwgNzgsIDkwXSxcbiAgICAvLyBjb2xvdXJzOiBbXCIjYjdlM2M5XCIsIFwiI2ZmZWM4MFwiLCBcIiNmZmIzNDdcIiwgXCIjZjc4MTU0XCJdXG4gICAgY29sb3VyczogbWVyZ2VkX3NjYWxlLFxuICB9LFxuICBUSElfbWVhbjoge1xuICAgIG5hbWU6IFwiTWVhbiBDYXR0bGUgVGhlcm1hbCBIdW1pZGl0eSBJbmRleFwiLFxuICAgIHRocmVzaG9sZHM6IFs3MiwgNzgsIDkwXSxcbiAgICAvLyBjb2xvdXJzOiBbXCIjYjdlM2M5XCIsIFwiI2ZmZWM4MFwiLCBcIiNmZmIzNDdcIiwgXCIjZjc4MTU0XCJdXG4gICAgY29sb3VyczogbWVyZ2VkX3NjYWxlLFxuICB9LFxuICBUQVZHOiB7XG4gICAgbmFtZTogXCJBdmVyYWdlIFRlbXBlcmF0dXJlXCIsXG4gICAgdGhyZXNob2xkczogWzMzLCAzNiwgNDddLFxuICAgIGNvbG91cnM6IG1lcmdlZF9zY2FsZSxcbiAgfSxcbiAgUFRPVDoge1xuICAgIG5hbWU6IFwiVG90YWwgUHJlY2lwaXRhdGlvblwiLFxuICAgIHRocmVzaG9sZHM6IFsxMjAwLCAxNjAwLCAxODAwXSxcbiAgICBjb2xvdXJzOiBtZXJnZWRfc2NhbGUsXG4gIH0sXG59KTtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNTQiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ2dWxuZXJhYmlsaXR5X2RpY3QgPSBuZXcgT2JqZWN0KHtcbiAgZ2VuZGVyOiB7XG4gICAgZG9tZXN0aWNfdmlvbGVuY2U6IFwiTGFjayBvZiBEb21lc3RpYyBWaW9sZW5jZVwiLFxuICAgIGdlbmRlcl9lcXVpdHk6IFwiR2VuZGVyIEVxdWl0eVwiLCAvLyBsZWF2aW5nIG91dCB0aGUgMTk5NS0yMDE1IGVxdWl0eSBpbmRleCwgYXMgdGhlIHJlc3Qgb2YgdGhlIEFDIHZhcnMgYXJlIGZyb20gfjIwMTUsIHdoaWNoIGlzIHRoaXNcbiAgICBkZWNpc2lvbl9tYWtpbmc6IFwiRGVjaXNpb24gTWFraW5nIFBvd2VyXCIsXG4gICAgZWR1Y2F0aW9uOiBcIldvbWVucyBFZHVjYXRpb25cIixcbiAgICBmYW1pbHlfcGxhbm5pbmc6IFwiQWNjZXNzIHRvIEZhbWlseSBQbGFubmluZ1wiLFxuICAgIHJlcHJvZHVjdGl2ZV9oZWFsdGg6IFwiUmVwcm9kdWN0aXZlIEhlYWx0aFwiLFxuICB9LFxuICBwb3ZlcnR5OiB7XG4gICAgR1NBUF9wb29yMjE1OiBcIiUgdW5kZXIgJDIuMTUgcG92ZXJ0eSBsaW5lXCIsXG4gICAgR1NBUF9wb29yMzY1OiBcIiUgdW5kZXIgJDMuNjUgcG92ZXJ0eSBsaW5lXCIsXG4gICAgR1NBUF9wb29yNjg1OiBcIiUgdW5kZXIgJDYuODUgcG92ZXJ0eSBsaW5lXCIsXG4gIH0sXG4gIGVkdWNhdGlvbjoge1xuICAgIGVkdWNhdGlvbllyczogXCJFZHVjYXRpb24oWXJzKVwiLFxuICB9LFxufSk7XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTU1IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoicGxvdFF1ZXJ5X2FkbWluID0ge1xuICBpZiAoY291bnRyeSA9PT0gXCJTU0FcIikge1xuICAgIHJldHVybiBgV0hFUkUgYWRtaW4xX25hbWUgSVMgTlVMTGA7XG4gIH0gZWxzZSBpZiAoY291bnRyeSAhPT0gXCJTU0FcIiAmJiBhZG1pbjFfc2VsID09PSBcIkZ1bGwgQ291bnRyeVwiKSB7XG4gICAgcmV0dXJuIGBXSEVSRSBhZG1pbjBfbmFtZSA9ICcke2NvdW50cnl9JyBBTkQgYWRtaW4xX25hbWUgSVMgTlVMTGA7XG4gIH0gZWxzZSBpZiAoYWRtaW4xX3NlbCAhPT0gXCJGdWxsIENvdW50cnlcIiAmJiBhZG1pbjJfc2VsID09PSBcIkZ1bGwgUmVnaW9uXCIpIHtcbiAgICByZXR1cm4gYFdIRVJFIGFkbWluMF9uYW1lID0gJyR7Y291bnRyeX0nIEFORCBhZG1pbjFfbmFtZSA9ICR7YWRtaW4xX3NlbH1gO1xuICB9IGVsc2UgaWYgKGFkbWluMl9zZWwgIT09IFwiRnVsbCBSZWdpb25cIikge1xuICAgIHJldHVybiBgV2hlcmUgYWRtaW4gYWRtaW4wX25hbWUgPSAnJHtjb3VudHJ5fScgQU5EIGFkbWluMV9uYW1lID0gJHthZG1pbjFfc2VsfSBBTkQgYWRtaW4yX25hbWUgPSAke2FkbWluMl9zZWx9YDtcbiAgfVxufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC01NiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Im1hcERhdGFRdWVyeV9hZG1pbiA9IHtcbiAgLy8gaWYgKGNvdW50cnkgPT09IFwiU1NBXCIpIHtcbiAgLy8gICByZXR1cm4gYFdIRVJFIGFkbWluMV9uYW1lIElTIE5VTExgO1xuICAvLyB9IGVsc2UgaWYgKGNvdW50cnkgIT09IFwiU1NBXCIgJiYgYWRtaW4xX3NlbCA9PT0gXCJGdWxsIENvdW50cnlcIikge1xuICAvLyAgIHJldHVybiBgV0hFUkUgYWRtaW4wX25hbWUgPSAnJHtjb3VudHJ5fScgQU5EIGFkbWluMV9uYW1lIElTIE5VTExgO1xuICAvLyB9IGVsc2UgaWYgKGFkbWluMV9zZWwgIT09IFwiRnVsbCBDb3VudHJ5XCIgJiYgYWRtaW4yX3NlbCA9PT0gXCJGdWxsIFJlZ2lvblwiKSB7XG4gIC8vICAgcmV0dXJuIGBXSEVSRSBhZG1pbjBfbmFtZSA9ICcke2NvdW50cnl9JyBBTkQgYWRtaW4xX25hbWUgPSAke2FkbWluMV9zZWx9YDtcbiAgLy8gfSBlbHNlIGlmIChhZG1pbjJfc2VsICE9PSBcIkZ1bGwgUmVnaW9uXCIpIHtcbiAgLy8gICByZXR1cm4gYFdoZXJlIGFkbWluIGFkbWluMF9uYW1lID0gJyR7Y291bnRyeX0nIEFORCBhZG1pbjFfbmFtZSA9ICR7YWRtaW4xX3NlbH0gQU5EIGFkbWluMl9uYW1lID0gJHthZG1pbjJfc2VsfWA7XG4gIC8vIH1cblxuICBsZXQgYWRtaW5fcXVlcnk7XG4gIGlmIChjb3VudHJ5ID09PSBcIlNTQVwiKSB7XG4gICAgaWYgKGFkbWluX2FnZ3JlZ2F0aW9uTGV2ZWwgPT09IFwiYWRtaW4wX25hbWVcIikge1xuICAgICAgYWRtaW5fcXVlcnkgPSBgV0hFUkUgYWRtaW4xX25hbWUgSVMgTlVMTGA7XG4gICAgfSBlbHNlIGlmIChhZG1pbl9hZ2dyZWdhdGlvbkxldmVsID09PSBcImFkbWluMV9uYW1lXCIpIHtcbiAgICAgIGFkbWluX3F1ZXJ5ID0gYFdIRVJFIGFkbWluMV9uYW1lIElTIE5PVCBOVUxMIEFORCBhZG1pbjJfbmFtZSBJUyBOVUxMYDtcbiAgICB9IGVsc2UgaWYgKGFkbWluX2FnZ3JlZ2F0aW9uTGV2ZWwgPT09IFwiYWRtaW4yX25hbWVcIikge1xuICAgICAgYWRtaW5fcXVlcnkgPSBgV0hFUkUgYWRtaW4yX25hbWUgSVMgTk9UIE5VTExgO1xuICAgIH1cbiAgfSBlbHNlIGlmIChjb3VudHJ5ICE9PSBcIlNTQVwiICYmIGFkbWluMV9zZWwgPT09IFwiRnVsbCBDb3VudHJ5XCIpIHtcbiAgICBpZiAoYWRtaW5fYWdncmVnYXRpb25MZXZlbCA9PT0gXCJhZG1pbjBfbmFtZVwiKSB7XG4gICAgICBhZG1pbl9xdWVyeSA9IGBXSEVSRSBhZG1pbjBfbmFtZSA9ICcke2NvdW50cnl9JyBBTkQgYWRtaW4xX25hbWUgSVMgTlVMTGA7XG4gICAgfSBlbHNlIGlmIChhZG1pbl9hZ2dyZWdhdGlvbkxldmVsID09PSBcImFkbWluMV9uYW1lXCIpIHtcbiAgICAgIGFkbWluX3F1ZXJ5ID0gYFdIRVJFIGFkbWluMF9uYW1lID0gJyR7Y291bnRyeX0nIEFORCBhZG1pbjFfbmFtZSBJUyBOT1QgTlVMTCBBTkQgYWRtaW4yX25hbWUgSVMgTlVMTGA7XG4gICAgfSBlbHNlIGlmIChhZG1pbl9hZ2dyZWdhdGlvbkxldmVsID09PSBcImFkbWluMl9uYW1lXCIpIHtcbiAgICAgIGFkbWluX3F1ZXJ5ID0gYFdIRVJFIGFkbWluMF9uYW1lID0gJyR7Y291bnRyeX0nIEFORCBhZG1pbjFfbmFtZSBJUyBOT1QgTlVMTCBBTkQgYWRtaW4yX25hbWUgSVMgTk9UIE5VTExgO1xuICAgIH1cbiAgfSBlbHNlIGlmIChhZG1pbjFfc2VsICE9PSBcIkZ1bGwgQ291bnRyeVwiICYmIGFkbWluMl9zZWwgPT09IFwiRnVsbCBSZWdpb25cIikge1xuICAgIGlmIChhZG1pbl9hZ2dyZWdhdGlvbkxldmVsID09PSBcImFkbWluMV9uYW1lXCIpIHtcbiAgICAgIGFkbWluX3F1ZXJ5ID0gYFdIRVJFIGFkbWluMF9uYW1lID0gJyR7Y291bnRyeX0nIEFORCBhZG1pbjFfbmFtZSA9JyR7YWRtaW4xX3NlbH0nIEFORCBhZG1pbjJfbmFtZSBJUyBOVUxMYDtcbiAgICB9IGVsc2UgaWYgKGFkbWluX2FnZ3JlZ2F0aW9uTGV2ZWwgPT09IFwiYWRtaW4yX25hbWVcIikge1xuICAgICAgYWRtaW5fcXVlcnkgPSBgV0hFUkUgYWRtaW4wX25hbWUgPSAnJHtjb3VudHJ5fScgQU5EIGFkbWluMV9uYW1lID0nJHthZG1pbjFfc2VsfScgQU5EIGFkbWluMl9uYW1lIElTIE5PVCBOVUxMYDtcbiAgICB9XG4gIH0gZWxzZSBpZiAoYWRtaW4yX3NlbCAhPT0gXCJGdWxsIFJlZ2lvblwiKSB7XG4gICAgYWRtaW5fcXVlcnkgPSBgV0hFUkUgYWRtaW4wX25hbWUgPSAnJHtjb3VudHJ5fScgQU5EIGFkbWluMV9uYW1lID0nJHthZG1pbjFfc2VsfScgQU5EIGFkbWluMl9uYW1lID0nJHthZG1pbjJfc2VsfSdgO1xuICB9XG4gIHJldHVybiBhZG1pbl9xdWVyeTtcbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNTciLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJwbG90UXVlcnkyX2FkbWluID0ge1xuICBpZiAoY291bnRyeSA9PT0gXCJTU0FcIikge1xuICAgIHJldHVybiBgV0hFUkUgYWRtaW4xX25hbWUgSVMgTlVMTGA7XG4gIH0gZWxzZSBpZiAoY291bnRyeSAhPT0gXCJTU0FcIiAmJiBhZG1pbjFfc2VsID09PSBcIkZ1bGwgQ291bnRyeVwiKSB7XG4gICAgcmV0dXJuIGBXSEVSRSBhZG1pbjBfbmFtZSA9ICcke2NvdW50cnl9JyBBTkQgYWRtaW4xX25hbWUgSVMgTk9UIE5VTEwgQU5EIGFkbWluMl9uYW1lIElTIE5VTExgO1xuICB9IGVsc2UgaWYgKGFkbWluMV9zZWwgIT09IFwiRnVsbCBDb3VudHJ5XCIgJiYgYWRtaW4yX3NlbCA9PT0gXCJGdWxsIFJlZ2lvblwiKSB7XG4gICAgcmV0dXJuIGBXSEVSRSBhZG1pbjBfbmFtZSA9ICcke2NvdW50cnl9JyBBTkQgYWRtaW4xX25hbWUgPSAnJHthZG1pbjFfc2VsfScgQU5EIGFkbWluMl9uYW1lIElTIE5PVCBOVUxMYDtcbiAgfSBlbHNlIGlmIChhZG1pbjJfc2VsICE9PSBcIkZ1bGwgUmVnaW9uXCIpIHtcbiAgICByZXR1cm4gYFdIRVJFIGFkbWluMF9uYW1lID0gJyR7Y291bnRyeX0nIEFORCBhZG1pbjFfbmFtZSA9ICcke2FkbWluMV9zZWx9JyBBTkQgYWRtaW4yX25hbWUgPSAnJHthZG1pbjJfc2VsfSdgO1xuICB9XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTU4IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiYWxsX2RhdGFfcXVlcnkgPSB7XG4gIGxldCBkYl9xdWVyeTtcbiAgaWYgKGF0bGFzX2NhdCA9PT0gXCJWdWxuZXJhYmlsaXR5XCIpIHtcbiAgICBkYl9xdWVyeSA9IGBcbiAgICAgIFNFTEVDVCAqLFxuICAgICAgRlJPTSBWdWxuZXJhYmlsaXR5XG4gICAgICAke21hcERhdGFRdWVyeV9hZG1pbn1cbiAgICAgIEFORCBcImdyb3VwXCIgaW4gKCcke0RhdGFTZWxlY3Rvcl9mb3JtLnZ1bG5lcmFiaWxpdHlHcm91cF9mb3JtLnZ1bG5lcmFiaWxpdHlfc2VsXG4gICAgICAgIC5qb2luKFwiJywgJ1wiKVxuICAgICAgICAudG9Mb3dlckNhc2UoKX0nKWA7XG4gIH0gZWxzZSBpZiAoYXRsYXNfY2F0ID09PSBcIkV4cG9zdXJlXCIpIHtcbiAgICBkYl9xdWVyeSA9IGBcbiAgICAgIFNFTEVDVCAqXG4gICAgICBGUk9NIEV4cG9zdXJlXG4gICAgICAke21hcERhdGFRdWVyeV9hZG1pbn1cbiAgICAgIEFORCBcImdyb3VwXCIgaW4gKCcke0RhdGFTZWxlY3Rvcl9mb3JtLmV4cG9zdXJlR3JvdXBfZm9ybS5leHBvc3VyZUdyb3VwX3NlbFxuICAgICAgICAuam9pbihcIicsICdcIilcbiAgICAgICAgLnRvTG93ZXJDYXNlKCl9JylgO1xuICB9IGVsc2UgaWYgKGF0bGFzX2NhdCA9PT0gXCJIYXphcmRcIikge1xuICAgIGRiX3F1ZXJ5ID0gYFxuICAgIFNFTEVDVCAqXG4gICAgRlJPTSBIYXphcmRcbiAgICAke21hcERhdGFRdWVyeV9hZG1pbn1cbiAgICBBTkQgXCJoYXphcmRcIiBJTiAoJyR7RGF0YVNlbGVjdG9yX2Zvcm0uaGF6YXJkR3JvdXBfZm9ybS5oYXphcmRfc2VsLmpvaW4oXG4gICAgICBcIicsICdcIlxuICAgICl9JylcbiAgICBBTkQgXCJ0aW1lZnJhbWVcIiBJTiAoJyR7RGF0YVNlbGVjdG9yX2Zvcm0uaGF6YXJkR3JvdXBfZm9ybS50aW1lcGVyaW9kX3NlbC5qb2luKFxuICAgICAgXCInLCAnXCJcbiAgICApfScpYDtcbiAgfVxuXG4gIHJldHVybiBkYl9xdWVyeTtcbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNTkiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJtYXBfcXVlcnkgPSB7XG4gIGxldCBkYl9xdWVyeTtcbiAgaWYgKGF0bGFzX2NhdCA9PT0gXCJFeHBvc3VyZVwiKSB7XG4gICAgaWYgKGV4cG9zdXJlX2NhdCA9PT0gXCJQb3B1bGF0aW9uXCIpIHtcbiAgICAgIC8vIGNvbnN0IHBvcF9ncm91cCA9IGV4cG9zdXJlX3N1YkNhdC5zcGxpdChcIiBcIilbMF0udG9Mb3dlckNhc2UoKSArIFwiX3BvcFwiO1xuICAgICAgZGJfcXVlcnkgPSBgXG4gICAgICBTRUxFQ1QgYWRtaW4wX25hbWUsIGFkbWluMV9uYW1lLCBhZG1pbjJfbmFtZSwgJHtleHBvc3VyZV9zdWJDYXR9IEFTIHZhbHVlXG4gICAgICBGUk9NIFwiJHthdGxhc19jYXQudG9Mb3dlckNhc2UoKSArIGV4cG9zdXJlX2NhdH1cIlxuICAgICAgYDtcbiAgICB9IGVsc2Uge1xuICAgICAgbGV0IGV4cG9zdXJlO1xuICAgICAgZXhwb3N1cmUgPSBleHBvc3VyZV92YXI7XG4gICAgICBkYl9xdWVyeSA9IGBcbiAgICAgIFNFTEVDVCAqXG4gICAgICBGUk9NIFwiJHthdGxhc19jYXQudG9Mb3dlckNhc2UoKSArIGV4cG9zdXJlX2NhdH1cIlxuICAgICAgV0hFUkUgXCJleHBvc3VyZVwiIExJS0UgJyR7ZXhwb3N1cmV9J1xuICAgICAgQU5EIFwiY3JvcFwiIExJS0UgJyR7ZXhwb3N1cmVfc3ViQ2F0fSdgO1xuICAgIH1cbiAgfSBlbHNlIGlmIChhdGxhc19jYXQgPT09IFwiVnVsbmVyYWJpbGl0eVwiKSB7XG4gICAgZGJfcXVlcnkgPSBgXG4gICAgICBTRUxFQ1QgKlxuICAgICAgRlJPTSBWdWxuZXJhYmlsaXR5XG4gICAgICBXSEVSRSBcImdyb3VwXCIgTElLRSAnJHthY19jYXQudG9Mb2NhbGVMb3dlckNhc2UoKX0nXG4gIGA7XG4gICAgaWYgKGFjX2NhdCA9PT0gXCJHZW5kZXJcIiB8fCBhY19jYXQgPT09IFwiUG92ZXJ0eVwiKSB7XG4gICAgICBkYl9xdWVyeSA9IGRiX3F1ZXJ5ICsgYEFORCBcInZhcmlhYmxlXCIgTElLRSAnJHthY19zdWJjYXR9J2A7XG4gICAgfVxuICB9IGVsc2UgaWYgKGF0bGFzX2NhdCA9PT0gXCJIYXphcmRcIikge1xuICAgIGRiX3F1ZXJ5ID0gYFxuICAgIFNFTEVDVCAqXG4gICAgRlJPTSBIYXphcmRcbiAgICBXSEVSRSBcImhhemFyZFwiIExJS0UgJyR7aGF6YXJkX3NlbH0nXG4gICAgQU5EIFwic2NlbmFyaW9cIiBMSUtFICcke3NzcF9zZWwudG9Mb3dlckNhc2UoKX0nIEFORCBcInRpbWVmcmFtZVwiIExJS0UgJyR7dGltZV9zZWwudG9Mb3dlckNhc2UoKX0nYDtcbiAgfSBlbHNlIHtcbiAgICBkYl9xdWVyeSA9IG51bGxcbiAgfVxuICByZXR1cm4gZGJfcXVlcnk7XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTYwIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiTmJEYXRhID0ge1xuICBpZiAoYXRsYXNfY2F0ID09PSBcIlZ1bG5lcmFiaWxpdHlcIikge1xuICAgIGF3YWl0IENoZWNrT1JBZGRfVnVsblRhYmxlKGRiKTtcbiAgfSBlbHNlIGlmIChhdGxhc19jYXQgPT09IFwiRXhwb3N1cmVcIikge1xuICAgIGF3YWl0IENoZWNrT1JBZGRfRXhwb3N1cmVUYWJsZShkYik7XG4gIH0gZWxzZSB7XG4gIH1cbiAgcmV0dXJuIHtcbiAgICBleHBsb3JlX2RhdGE6IGF3YWl0IGRiLnF1ZXJ5KGFsbF9kYXRhX3F1ZXJ5KSxcbiAgICBtYXBfZGF0YTogYXdhaXQgZGIucXVlcnkobWFwX3F1ZXJ5KVxuICB9O1xufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC02MSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImFkbWluX2luZGV4ID0gZDMuaW5kZXgoXG4gIE5iRGF0YVtcIm1hcF9kYXRhXCJdLFxuICAoZCkgPT4gZC5hZG1pbjBfbmFtZSxcbiAgKGQpID0+IGQuYWRtaW4xX25hbWUsXG4gIChkKSA9PiBkLmFkbWluMl9uYW1lLFxuKTtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNjIiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJjcm9wX2dyb3VwcyA9IG5ldyBPYmplY3Qoe1xuICBjYXR0bGU6IFtcImNhdHRsZV90cm9waWNhbFwiLCBcImNhdHRsZV9oaWdobGFuZFwiXSxcbiAgcG91bHRyeTogW1wicG91bHRyeV90cm9waWNhbFwiLCBcInBvdWx0cnlfaGlnaGxhbmRcIl0sXG4gIHBpZ3M6IFtcInBpZ3NfdHJvcGljYWxcIiwgXCJwaWdzX2hpZ2hsYW5kXCJdLFxuICBcIlNtYWxsIFJ1bWluYW50c1wiOiBbXG4gICAgXCJzaGVlcF90cm9waWNhbFwiLFxuICAgIFwic2hlZXBfaGlnaGxhbmRcIixcbiAgICBcImdvYXRzX3Ryb3BpY2FsXCIsXG4gICAgXCJnb2F0c19oaWdobGFuZFwiLFxuICBdLFxuICByb290c1R1YmVyOiBbXCJwb3RhdG9cIiwgXCJzd2VldCBwb3RhdG9cIiwgXCJ5YW1zXCIsIFwiY2Fzc2F2YVwiXSxcbiAgY2VyZWFsczogW1xuICAgIFwid2hlYXRcIixcbiAgICBcInJpY2VcIixcbiAgICBcIm1haXplXCIsXG4gICAgXCJiYXJsZXlcIixcbiAgICBcInBlYXJsIG1pbGxldFwiLFxuICAgIFwic21hbGwgbWlsbGV0XCIsXG4gICAgXCJzb3JnaHVtXCIsXG4gIF0sXG4gIGxlZ3VtZXM6IFtcbiAgICBcImJlYW5cIixcbiAgICBcImNoaWNrcGVhXCIsXG4gICAgXCJjb3dwZWFcIixcbiAgICBcInBpZ2VvbnBlYVwiLFxuICAgIFwibGVudGlsXCIsXG4gICAgXCJncm91bmRudXRcIixcbiAgICBcInNveWJlYW5cIixcbiAgXSxcbiAgZnJ1aXRWZWc6IFtcInBsYW50YWluXCIsIFwiY29jb251dFwiLCBcImJhbmFuYVwiXSxcbiAgbm9uRWRpYmxlOiBbXG4gICAgXCJjb2NvYVwiLFxuICAgIFwicmFwZXNlZWRcIixcbiAgICBcInNlc2FtZXNlZWRcIixcbiAgICBcIm9pbHBhbG1cIixcbiAgICBcImNvdHRvblwiLFxuICAgIFwidGVhXCIsXG4gICAgXCJ0b2JhY2NvXCIsXG4gICAgXCJhcmFiaWNhIGNvZmZlZVwiLFxuICAgIFwic3VuZmxvd2VyXCIsXG4gICAgXCJzdWdhcmNhbmVcIixcbiAgICBcInN1Z2FyYmVldFwiLFxuICAgIFwicm9idXN0YSBjb2ZmZWVcIixcbiAgXSxcbn0pO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC02MyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Im1kYCMjIEZvcm1hdCBoZWxwZXJzYDtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNjQiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJmb3JtYXREb2xsYXIgPSBuZXcgSW50bC5OdW1iZXJGb3JtYXQoXCJlbi1VU1wiLCB7XG4gIG5vdGF0aW9uOiBcImNvbXBhY3RcIixcbiAgY29tcGFjdERpc3BsYXk6IFwic2hvcnRcIixcbiAgc3R5bGU6IFwiY3VycmVuY3lcIixcbiAgY3VycmVuY3k6IFwidXNkXCIsXG59KS5mb3JtYXQ7XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTY1IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiZm9ybWF0QmlnTnVtcyA9IG5ldyBJbnRsLk51bWJlckZvcm1hdChcImVuLVVTXCIsIHtcbiAgbm90YXRpb246IFwiY29tcGFjdFwiLFxuICBjb21wYWN0RGlzcGxheTogXCJzaG9ydFwiLFxufSkuZm9ybWF0O1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC02NiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImZ1bmN0aW9uIGZvcm1hdF92YWwodmFsLCB1bml0KSB7XG4gIHN3aXRjaCAodW5pdCkge1xuICAgIGNhc2UgXCJkb2xsYXJcIjpcbiAgICAgIHJldHVybiBmb3JtYXREb2xsYXIodmFsKTtcbiAgICBjYXNlIFwidG90YWxcIjpcbiAgICAgIHJldHVybiBmb3JtYXRCaWdOdW1zKHZhbCk7XG4gICAgY2FzZSBcInRvdGFsX2hhXCI6XG4gICAgICByZXR1cm4gYCR7Zm9ybWF0QmlnTnVtcyh2YWwpfSAvaGFgO1xuICAgIGNhc2UgXCJpbmRleFwiOlxuICAgICAgcmV0dXJuIHZhbC50b0ZpeGVkKDIpO1xuICAgIGNhc2UgXCJwZXJjZW50XCI6XG4gICAgICByZXR1cm4gYCR7KHZhbCAqIDEwMCkudG9GaXhlZCgyKX0lYDtcbiAgICBjYXNlIFwicGVyY2VudF9Ob0RlY2ltYWxcIjpcbiAgICAgIHJldHVybiBgJHsodmFsICogMTAwKS50b0ZpeGVkKDApfSVgO1xuICAgIGRlZmF1bHQ6XG4gICAgICBpZiAodHlwZW9mIHVuaXQgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgcmV0dXJuICh2YWwgKiB1bml0KS50b0ZpeGVkKDEpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHZhbDsgLy8gRGVmYXVsdCBjYXNlIGlmIHVuaXQgZG9lc24ndCBtYXRjaCBhbnkgY29uZGl0aW9uXG4gIH1cbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNjciLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ2YXJfdW5pdCA9IHtcbiAgaWYgKGF0bGFzX2NhdCA9PT0gXCJIYXphcmRcIikge1xuICAgIGNvbnN0IGNsZWFuX2hheiA9IGhhemFyZF9zZWwuc3BsaXQoXCJfXCIpWzBdO1xuICAgIHJldHVybiB1bml0X2RpY3RbYXRsYXNfY2F0XVtjbGVhbl9oYXpdO1xuICB9XG5cbiAgaWYgKGF0bGFzX2NhdCA9PT0gXCJFeHBvc3VyZVwiKSB7XG4gICAgaWYgKGV4cG9zdXJlX3ZhciA9PT0gXCJ2b3BcIikge1xuICAgICAgcmV0dXJuIHVuaXRfZGljdFthdGxhc19jYXRdW2V4cG9zdXJlX3Zhcl07XG4gICAgfSBlbHNlIGlmIChleHBvc3VyZV9jYXQgPT09IFwiUG9wdWxhdGlvblwiKSB7XG4gICAgICByZXR1cm4gdW5pdF9kaWN0W2F0bGFzX2NhdF1bXCJwb3B1bGF0aW9uVG90YWxcIl07XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IGNsZWFuX3ZhciA9IGV4cG9zdXJlX3ZhcjtcbiAgICAgIGNvbnN0IGZ1bGxfdmFyID0gZXhwb3N1cmVfY2F0LnRvTG93ZXJDYXNlKCkgKyBjbGVhbl92YXI7XG4gICAgICByZXR1cm4gdW5pdF9kaWN0W2F0bGFzX2NhdF1bZnVsbF92YXJdOyAvLy50b0xvd2VyQ2FzZSgpXG4gICAgfVxuICB9XG5cbiAgaWYgKGF0bGFzX2NhdCA9PT0gXCJWdWxuZXJhYmlsaXR5XCIpIHtcbiAgICByZXR1cm4gdW5pdF9kaWN0W2F0bGFzX2NhdF1bYWNfY2F0XTtcbiAgfVxufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC02OCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InVuaXRfZGljdCA9IHtcbiAgbGV0IGRheV9sYWIgPSBfbGFuZyhuYlRleHQuZ2VuZXJhbC51bml0cy5kYXlzKVxuICBsZXQgaW5kZXhfbGFiID0gIF9sYW5nKG5iVGV4dC5nZW5lcmFsLnVuaXRzLmluZGV4KVxuICBsZXQgeXJfbGFiID0gX2xhbmcobmJUZXh0LmdlbmVyYWwudW5pdHMueXJzKVxuICBsZXQgcG9wX2xhYiA9IF9sYW5nKG5iVGV4dC5nZW5lcmFsLnVuaXRzLm51bV9wZW9wbGUpXG4gIGxldCBudW1BbmltYWxfbGFiID0gX2xhbmcobmJUZXh0LmdlbmVyYWwudW5pdHMubnVtX2FuaW1hbHMpXG4gIFxuICByZXR1cm4ge1xuICAgIEV4cG9zdXJlOiB7XG4gICAgICB2b3A6IHsgbGFiZWw6IFwiSU5EMjAwNVwiLCBjYXRlZ29yeTogXCJkb2xsYXJcIiB9LFxuICAgICAgbGl2ZXN0b2NrbnVtYmVyOiB7IGxhYmVsOiBudW1BbmltYWxfbGFiLCBjYXRlZ29yeTogXCJ0b3RhbFwiIH0sXG4gICAgICBjcm9waGE6IHsgbGFiZWw6IFwiSGFcIiwgY2F0ZWdvcnk6IFwidG90YWxcIiB9LFxuICAgICAgcG9wdWxhdGlvblRvdGFsOiB7IGxhYmVsOiBwb3BfbGFiLCBjYXRlZ29yeTogXCJ0b3RhbFwiIH1cbiAgICB9LFxuICAgIEhhemFyZDoge1xuICAgICAgVEhJOiB7IGxhYmVsOiBpbmRleF9sYWIsIGNhdGVnb3J5OiBcInRvdGFsXCIgfSxcbiAgICAgIFRBVkc6IHsgbGFiZWw6IFwiwrpDXCIsIGNhdGVnb3J5OiBcInRvdGFsXCIgfSxcbiAgICAgIFRBSTogeyBsYWJlbDogXCIlXCIsIGNhdGVnb3J5OiBcInRvdGFsXCIgfSxcbiAgICAgIFBUT1Q6IHsgbGFiZWw6IFwibW1cIiwgY2F0ZWdvcnk6IFwidG90YWxcIiB9LFxuICAgICAgTlR4MzU6IHsgbGFiZWw6IGRheV9sYWIsIGNhdGVnb3J5OiBcInRvdGFsXCIgfSxcbiAgICAgIE5UeDQwOiB7IGxhYmVsOiBkYXlfbGFiLCBjYXRlZ29yeTogXCJ0b3RhbFwiIH0sXG4gICAgICBORFdTOiB7IGxhYmVsOiBkYXlfbGFiLCBjYXRlZ29yeTogXCJ0b3RhbFwiIH0sXG4gICAgICBORFdMMDogeyBsYWJlbDogZGF5X2xhYiwgY2F0ZWdvcnk6IFwidG90YWxcIiB9LFxuICAgICAgSFNIOiB7IGxhYmVsOiBpbmRleF9sYWIsIGNhdGVnb3J5OiBcInRvdGFsXCIgfVxuICAgIH0sXG4gICAgVnVsbmVyYWJpbGl0eToge1xuICAgICAgR2VuZGVyOiB7IGxhYmVsOiBpbmRleF9sYWIsIGNhdGVnb3J5OiBcImluZGV4XCIgfSxcbiAgICAgIEVkdWNhdGlvbjogeyBsYWJlbDogeXJfbGFiLCBjYXRlZ29yeTogXCJ0b3RhbFwiIH0sXG4gICAgICBQb3ZlcnR5OiB7IGxhYmVsOiBcIiVcIiwgY2F0ZWdvcnk6IFwicGVyY2VudFwiIH1cbiAgICB9XG4gIH1cbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNjkiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJtZGAjIyBEb3dubG9hZCBIZWxwZXJzYDtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNzAiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJkb3dubG9hZF9idXR0b25faW5pdGlhdGUgPSAoKSA9PiB7XG4gIGNvbnN0IGJ1dHRvbiA9IGh0bWxgPGEgY2xhc3M9YXRsYXNfYnV0dG9uPiR7X2xhbmcobmJUZXh0LmRvd25sb2FkLmJ1dHRvbi5wcmVwYXJlKX08L2E+YDtcblxuICBidXR0b24ub25jbGljayA9IGFzeW5jICgpID0+IHtcbiAgICBkb2N1bWVudC5ib2R5LnN0eWxlLmN1cnNvciA9IFwid2FpdFwiO1xuICAgIGJ1dHRvbi50ZXh0Q29udGVudCA9IFwiTG9hZGluZy4uLlwiO1xuICAgIGNvbnN0IHV0Y19kYXRlID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpO1xuICAgIGNvbnN0IGRhdGVyZWdleCA9IC9eKFxcZHs0fSktKFxcZHsyfSktKFxcZHsyfSkvO1xuICAgIGNvbnN0IHl5eXltbWRkID0gdXRjX2RhdGUubWF0Y2goZGF0ZXJlZ2V4KVswXTtcbiAgICBsZXQgZmlsZV9uYW1lID0gXCJhZGFwdGF0aW9uLWF0bGFzX1wiICsgYXRsYXNfY2F0ICsgXCJfXCIgKyB5eXl5bW1kZDtcbiAgICBsZXQgZmlsZV9leHQgPSBkb3dubG9hZF9mb3JtYXQudG9Mb3dlckNhc2UoKTtcbiAgICBjb25zdCBmdWxsX25hbWUgPSBmaWxlX25hbWUgKyBcIi5cIiArIGZpbGVfZXh0O1xuXG4gICAgbGV0IGRvd25sb2FkQmxvYjtcbiAgICBpZiAoZG93bmxvYWRfZm9ybWF0ID09PSBcIlBhcnF1ZXRcIiB8fCBkb3dubG9hZF9mb3JtYXQgPT09IFwiQ1NWXCIpIHtcbiAgICAgIGRvd25sb2FkQmxvYiA9IGF3YWl0IGRvd25sb2FkVGFidWxhcihcbiAgICAgICAgZmlsZV9uYW1lLFxuICAgICAgICBmaWxlX2V4dCxcbiAgICAgICAgZGIsXG4gICAgICAgIGRvd25sb2FkX2Zvcm1hdCxcbiAgICAgICAgZnVsbF9uYW1lLFxuICAgICAgKTtcbiAgICB9IGVsc2UgaWYgKGRvd25sb2FkX2Zvcm1hdCA9PT0gXCJKU09OXCIpIHtcbiAgICAgIGxldCBjbGVhbkpTT04gPSBhd2FpdCBOYkRhdGFbXCJleHBsb3JlX2RhdGFcIl0ubWFwKChyb3cpID0+XG4gICAgICAgIE9iamVjdC5mcm9tRW50cmllcyhyb3cpLFxuICAgICAgKTsgLy8gbm90IGEgdG90YWxseSB2YWxpZCBqc29uLCBuZWVkcyBmaXhpbmcuXG4gICAgICBkb3dubG9hZEJsb2IgPSBuZXcgQmxvYihbTmJEYXRhW1wiZXhwbG9yZV9kYXRhXCJdXSwge1xuICAgICAgICB0eXBlOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgIH0pO1xuICAgIH1cbiAgICAvLyBjb25zdCBzaXplID0gKGRvd25sb2FkQmxvYi5zaXplIC8gMTAwMDAwMCkudG9GaXhlZCgwKTtcbiAgICBjb25zdCB1cmwgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGRvd25sb2FkQmxvYik7XG4gICAgY29uc3QgZG93bmxvYWRCdXR0b24gPSBodG1sYDxhIGhyZWY9XCIke3VybH1cIiBkb3dubG9hZD1cIiR7ZnVsbF9uYW1lfVwiIHRhcmdldD1cIl9ibGFua1wiIGNsYXNzPVwiYXRsYXNfYnV0dG9uXCI+JHtfbGFuZyhuYlRleHQuZG93bmxvYWQuYnV0dG9uLmRvd25sb2FkKX0gJHtkb3dubG9hZF9mb3JtYXR9IDwvYT5gOyAvLyh+JHtzaXplfSBtYilcbiAgICBidXR0b24ucmVwbGFjZVdpdGgoZG93bmxvYWRCdXR0b24pO1xuICAgIGRvY3VtZW50LmJvZHkuc3R5bGUuY3Vyc29yID0gXCJkZWZhdWx0XCI7XG4gIH07XG4gIHJldHVybiBidXR0b247XG59O1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC03MSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImFzeW5jIGZ1bmN0aW9uIGRvd25sb2FkVGFidWxhcihcbiAgZmlsZV9uYW1lLFxuICBmaWxlX2V4dCxcbiAgZGIsXG4gIGRvd25sb2FkX2Zvcm1hdCxcbiAgZnVsbF9uYW1lLFxuKSB7XG4gIGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cChgJHtmaWxlX25hbWV9XFxcXC4ke2ZpbGVfZXh0fWApO1xuICBjb25zdCBkYl9jb25uZWN0ID0gYXdhaXQgZGIuX2RiO1xuICBsZXQgZmlsZXMgPSBhd2FpdCBkYl9jb25uZWN0Lmdsb2JGaWxlcyhcIi90bXAvKlwiICsgXCIuXCIgKyBmaWxlX2V4dCk7XG4gIGxldCBmaWxlID0gZmlsZXMuZmluZCgoZCkgPT4gZC5maWxlTmFtZS5tYXRjaChyZWdleCkpO1xuICBpZiAoZmlsZXMubGVuZ3RoID09PSAwIHx8IGZpbGUgPT09IHVuZGVmaW5lZCkge1xuICAgIGlmIChkb3dubG9hZF9mb3JtYXQgPT09IFwiUEFSUVVFVFwiKSB7XG4gICAgICBsZXQgY29waWVkID0gYXdhaXQgZGIucXVlcnkoXG4gICAgICAgIGBDT1BZICgke2FsbF9kYXRhX3F1ZXJ5fSkgdG8gJy90bXAvJHtmdWxsX25hbWV9JyAoRk9STUFUICdQQVJRVUVUJywgQ09NUFJFU1NJT04gJ3NuYXBweScpYCxcbiAgICAgICk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGxldCBjb3BpZWQgPSBhd2FpdCBkYi5xdWVyeShcbiAgICAgICAgYENPUFkgKCR7YWxsX2RhdGFfcXVlcnl9KSB0byAnL3RtcC8ke2Z1bGxfbmFtZX0nIChGT1JNQVQgJ0NTVicsIEhFQURFUiwgREVMSU1JVEVSICcsJylgLFxuICAgICAgKTtcbiAgICB9XG4gICAgZmlsZXMgPSBhd2FpdCBkYl9jb25uZWN0Lmdsb2JGaWxlcyhcIi90bXAvKlwiICsgXCIuXCIgKyBmaWxlX2V4dCk7XG4gICAgZmlsZSA9IGZpbGVzLmZpbmQoKGQpID0+IGQuZmlsZU5hbWUubWF0Y2gocmVnZXgpKTtcbiAgfVxuICBjb25zdCBhcHBfdHlwZSA9XG4gICAgZG93bmxvYWRfZm9ybWF0ID09PSBcIlBBUlFVRVRcIiA/IFwiYXBwbGljYXRpb24vb2N0ZXQtc3RyZWFtXCIgOiBcInRleHQvY3N2XCI7XG4gIGNvbnN0IGJ1ZmZlciA9IGF3YWl0IGRiX2Nvbm5lY3QuY29weUZpbGVUb0J1ZmZlcihmaWxlLmZpbGVOYW1lKTtcbiAgY29uc3QgZG93bmxvYWREYXRhID0gbmV3IEJsb2IoW2J1ZmZlcl0sIHtcbiAgICB0eXBlOiBhcHBfdHlwZSxcbiAgfSk7XG4gIGRiX2Nvbm5lY3QuZHJvcEZpbGUoYC90bXAvJHtmdWxsX25hbWV9YCk7XG4gIHJldHVybiBkb3dubG9hZERhdGE7XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTcyIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiYXN5bmMgZnVuY3Rpb24gZG93bmxvYWRTcGF0aWFsKFxuICAvLyBUaGUgaXNzdWUgd2l0aCB0aGlzIG9uZSBpcyB0aGF0IGl0IG5lZWRzIHRvIGJlIGxvbmcgZm9ybWF0IHNvbWVob3cuLi5cbiAgZmlsZV9uYW1lLFxuICBmaWxlX2V4dCxcbiAgZG93bmxvYWRfZm9ybWF0LFxuICBmdWxsX25hbWUsXG4pIHtcbiAgaWYgKGRvd25sb2FkX2Zvcm1hdCA9PT0gXCJQQVJRVUVUXCIpIHtcbiAgfVxufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC03MyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImRvd25sb2FkX3NwYXRpYWxfYnV0dG9uID0gKCkgPT4ge1xuICBsZXQgYWRtX2xldmVsID0gYWRtaW5fYWdncmVnYXRpb25MZXZlbC5tYXRjaCgvXFxkKy8pWzBdO1xuICBsZXQgZG93bmxvYWRCbG9iID0gbmV3IEJsb2IoW0pTT04uc3RyaW5naWZ5KGFkbWluTGV2ZWxfc3BhdGlhbCldLCB7XG4gICAgdHlwZTogXCJhcHBsaWNhdGlvbi9nZW8ranNvblwiLFxuICB9KTtcbiAgbGV0IHNpemUgPSAoZG93bmxvYWRCbG9iLnNpemUgLyAxMDAwMDAwKS50b0ZpeGVkKDApO1xuICBsZXQgdXJsID0gVVJMLmNyZWF0ZU9iamVjdFVSTChkb3dubG9hZEJsb2IpO1xuXG4gIGxldCBidXR0b25fdGVtcGxhdGUgPSBfbGFuZyhuYlRleHQuZG93bmxvYWQuYm91bmRhcmllcy5idXR0b24pO1xuICBsZXQgYnRuX3R4dCA9IExhbmcucmVkdWNlUmVwbGFjZVRlbXBsYXRlSXRlbXMoYnV0dG9uX3RlbXBsYXRlLCBbXG4gICAgeyBuYW1lOiBcImFkbWluTHZsXCIsIHZhbHVlOiBhZG1fbGV2ZWwgfSxcbiAgXSk7XG5cbiAgbGV0IGRvd25sb2FkQnV0dG9uID0gaHRtbGA8YSBocmVmPVwiJHt1cmx9XCIgZG93bmxvYWQ9XCJBdGxhcy1ib3VuZGFyaWVzX2FkbWluJHthZG1fbGV2ZWx9Lmpzb25cIiB0YXJnZXQ9XCJfYmxhbmtcIiBjbGFzcz1hdGxhc19idXR0b24+JHtidG5fdHh0fTwvYT5gO1xuICByZXR1cm4gZG93bmxvYWRCdXR0b247XG59O1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC03NCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImRvd25sb2FkX21ldGFkYXRhX2J1dHRvbiA9ICgpID0+IHtcbiAgbGV0IGRvd25sb2FkQmxvYiA9IG5ldyBCbG9iKFtcIixcIl0sIHtcbiAgICB0eXBlOiBcInRleHQvY3N2XCIsXG4gIH0pO1xuICBsZXQgc2l6ZSA9IChkb3dubG9hZEJsb2Iuc2l6ZSAvIDEwMDAwMDApLnRvRml4ZWQoMCk7XG4gIGxldCB1cmwgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGRvd25sb2FkQmxvYik7XG5cbiAgbGV0IGRvd25sb2FkQnV0dG9uID0gaHRtbGA8YSBocmVmPVwiJHt1cmx9XCIgZG93bmxvYWQ9XCJBZGFwdGF0aW9uQXRsYXNfbWV0YWRhdGEuY3N2XCIgdGFyZ2V0PVwiX2JsYW5rXCIgc3R5bGU9XCJiYWNrZ3JvdW5kOiBncmV5OyBjb2xvcjogd2hpdGU7IHBhZGRpbmc6IDEwcHggMjBweDsgYm9yZGVyLXJhZGl1czogNTBweDsgdGV4dC1kZWNvcmF0aW9uOiBub25lO1wiPkRvd25sb2FkIE1ldGFkYXRhPC9hPmA7XG4gIHJldHVybiBkb3dubG9hZEJ1dHRvbjtcbn07XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTc1IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoibWRgIyMgR2VvZ3JhcGh5YDtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNzYiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJhZG1pbkxldmVsX3NwYXRpYWwgPSB7XG4gIGxldCBhZG1GZWF0dXJlcztcbiAgaWYgKGNvdW50cnkgPT09IFwiU1NBXCIpIHtcbiAgICBpZiAoYWRtaW5fYWdncmVnYXRpb25MZXZlbCA9PT0gXCJhZG1pbjBfbmFtZVwiKSB7XG4gICAgICBhZG1GZWF0dXJlcyA9IGFkbWluMF9sb2FkO1xuICAgIH0gZWxzZSBpZiAoYWRtaW5fYWdncmVnYXRpb25MZXZlbCA9PT0gXCJhZG1pbjFfbmFtZVwiKSB7XG4gICAgICBhZG1GZWF0dXJlcyA9IGFkbWluMTtcbiAgICB9IGVsc2UgaWYgKGFkbWluX2FnZ3JlZ2F0aW9uTGV2ZWwgPT09IFwiYWRtaW4yX25hbWVcIikge1xuICAgICAgYWRtRmVhdHVyZXMgPSBhZG1pbjI7XG4gICAgfVxuICB9IGVsc2UgaWYgKGNvdW50cnkgIT09IFwiU1NBXCIgJiYgYWRtaW4xX3NlbCA9PT0gXCJGdWxsIENvdW50cnlcIikge1xuICAgIGlmIChhZG1pbl9hZ2dyZWdhdGlvbkxldmVsID09PSBcImFkbWluMF9uYW1lXCIpIHtcbiAgICAgIGFkbUZlYXR1cmVzID0gYWRtaW4wX2xvYWQ7XG4gICAgICAvLyBsZXQgZmlsdGVyZWQgPSBhZG1pbjBfbG9hZC5mZWF0dXJlcy5maWx0ZXIoXG4gICAgICAvLyAgIChkKSA9PiBkLnByb3BlcnRpZXMuYWRtaW4wX25hbWUgPT09IGNvdW50cnlcbiAgICAgIC8vICk7XG4gICAgICAvLyAvLyBDcmVhdGUgYSBuZXcgR2VvSlNPTiBvYmplY3Qgd2l0aCB0aGUgZmlsdGVyZWQgZmVhdHVyZXNcbiAgICAgIC8vIGFkbUZlYXR1cmVzID0ge1xuICAgICAgLy8gICB0eXBlOiBhZG1pbjBfZmlsdGVyZWQudHlwZSxcbiAgICAgIC8vICAgZmVhdHVyZXM6IGZpbHRlcmVkXG4gICAgICAvLyB9O1xuICAgIH0gZWxzZSBpZiAoYWRtaW5fYWdncmVnYXRpb25MZXZlbCA9PT0gXCJhZG1pbjFfbmFtZVwiKSB7XG4gICAgICBhZG1GZWF0dXJlcyA9IGFkbWluMTtcbiAgICB9IGVsc2UgaWYgKGFkbWluX2FnZ3JlZ2F0aW9uTGV2ZWwgPT09IFwiYWRtaW4yX25hbWVcIikge1xuICAgICAgYWRtRmVhdHVyZXMgPSBhZG1pbjI7XG4gICAgfVxuICB9IGVsc2UgaWYgKGNvdW50cnkgIT09IFwiU1NBXCIgJiYgYWRtaW4xX3NlbCAhPT0gXCJGdWxsIENvdW50cnlcIikge1xuICAgIGlmIChhZG1pbl9hZ2dyZWdhdGlvbkxldmVsID09PSBcImFkbWluMV9uYW1lXCIpIHtcbiAgICAgIGFkbUZlYXR1cmVzID0gYWRtaW4xO1xuICAgICAgLy8gbGV0IGZpbHRlcmVkID0gYWRtaW4xLmZlYXR1cmVzLmZpbHRlcihcbiAgICAgIC8vICAgKGQpID0+IGQucHJvcGVydGllcy5hZG1pbjFfbmFtZSA9PT0gYWRtaW4xX3NlbFxuICAgICAgLy8gKTtcbiAgICAgIC8vIC8vIENyZWF0ZSBhIG5ldyBHZW9KU09OIG9iamVjdCB3aXRoIHRoZSBmaWx0ZXJlZCBmZWF0dXJlc1xuICAgICAgLy8gYWRtRmVhdHVyZXMgPSB7XG4gICAgICAvLyAgIHR5cGU6IGFkbWluMS50eXBlLFxuICAgICAgLy8gICBmZWF0dXJlczogZmlsdGVyZWRcbiAgICAgIC8vIH07XG4gICAgfSBlbHNlIGlmIChhZG1pbl9hZ2dyZWdhdGlvbkxldmVsID09PSBcImFkbWluMl9uYW1lXCIpIHtcbiAgICAgIGFkbUZlYXR1cmVzID0gYWRtaW4yO1xuICAgIH1cbiAgfVxuXG4gIGFkbUZlYXR1cmVzLmZlYXR1cmVzLmZvckVhY2goKGQpID0+IHtcbiAgICBjb25zdCBkYXRhID0gYWRtaW5faW5kZXhcbiAgICAgIC5nZXQoZC5wcm9wZXJ0aWVzLmFkbWluMF9uYW1lIHx8IG51bGwpXG4gICAgICAuZ2V0KGQucHJvcGVydGllcy5hZG1pbjFfbmFtZSB8fCBudWxsKVxuICAgICAgLmdldChkLnByb3BlcnRpZXMuYWRtaW4yX25hbWUgfHwgbnVsbCk7XG4gICAgZC5wcm9wZXJ0aWVzLnZhbHVlID0gZGF0YVtcInZhbHVlXCJdO1xuICB9KTtcblxuICAvLyAgIGFkbUZlYXR1cmVzLmZlYXR1cmVzLmZvckVhY2goKGQpID0+IHtcbiAgLy8gICAgIGNvbnN0IGEyX2RhdGEgPSBpbmRleFxuICAvLyAgICAgICAuZ2V0KGQucHJvcGVydGllcy5hZG1pbjBfbmFtZSlcbiAgLy8gICAgICAgLmdldChkLnByb3BlcnRpZXMuYWRtaW4xX25hbWUpXG4gIC8vICAgICAgIC5nZXQoZC5wcm9wZXJ0aWVzLmFkbWluMl9uYW1lKTtcbiAgLy8gICAgIGQucHJvcGVydGllcy52YWx1ZSA9IGEyX2RhdGFbXCJ2YWx1ZVwiXTtcbiAgLy8gICB9KTtcbiAgLy8gfVxuICByZXR1cm4gYWRtRmVhdHVyZXM7IC8vIFdpbGwgcmV0dXJuIGVpdGhlciB0aGUgdXBkYXRlZCBmZWF0dXJlcyBvciB1bmRlZmluZWQgaWYgJ2NvdW50cnknIGlzIG5vdCBcIlNTQVwiXG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTc3IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiYWRtaW4wX2xvYWQgPSB7IFxuICAvLyBBZG1pbiAyIGlzIGEgZ2VvanNvbiBzbyB0aGF0IGluaXRpYWwgcGFnZSBsb2FkIGNhbiBiZSBmYXN0ZXIobm90IHdhaXQgZm9yIERCIHNldHVwKVxuICBsZXQgZ2VvanNvbiA9IGF3YWl0IEZpbGVBdHRhY2htZW50KFxuICAgIFwiYXRsYXMtcmVnaW9uX2FkbWluMF9zaW1wbGlmaWVkLmdlb2pzb25cIlxuICApLmpzb24oKTtcbiAgbGV0IGEwX25hbWVzID0gZ2VvanNvbi5mZWF0dXJlcy5tYXAoKGQpID0+IGQucHJvcGVydGllcy5hZG1pbjBfbmFtZSk7XG4gIG11dGFibGUgYWRtaW4wX25hbWVzID0gW1wiU1NBXCJdLmNvbmNhdChhMF9uYW1lcyk7XG4gIC8vIGlmIChjb3VudHJ5ICE9PSBcIlNTQVwiKSB7XG4gIC8vICAgbGV0IGZpbHRlcmVkID0gZ2VvanNvbi5mZWF0dXJlcy5maWx0ZXIoXG4gIC8vICAgICAoZCkgPT4gZC5wcm9wZXJ0aWVzLmFkbWluMF9uYW1lID09PSBjb3VudHJ5XG4gIC8vICAgKTtcbiAgLy8gICBnZW9qc29uLmZlYXR1cmVzID0gZmlsdGVyZWQ7XG4gIC8vIH0gZWxzZSB7XG4gIC8vICAgcmV0dXJuIGdlb2pzb247XG4gIC8vIH1cbiAgcmV0dXJuIGdlb2pzb247XG5cbiAgLy8gbGV0IHJlc3BvbnNlID0gYXdhaXQgZGIucXVlcnkoYFxuICAvLyAgIFNFTEVDVCAqXG4gIC8vICAgRlJPTSBhZG1pbjBfZ2VvbWApO1xuICAvLyBsZXQgYTBfbmFtZXMgPSByZXNwb25zZS5tYXAoKGQpID0+IGQuYWRtaW4wX25hbWUpO1xuICAvLyBtdXRhYmxlIGFkbWluMF9uYW1lcyA9IFtcIlNTQVwiXS5jb25jYXQoYTBfbmFtZXMpO1xuICAvLyBsZXQgd2tiX2xpc3QgPSByZXNwb25zZS5tYXAoKGQpID0+IGQuZ2VvbWV0cnkpO1xuICAvLyBsZXQgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLm1hcCgoeyBnZW9tZXRyeSwgLi4ucmVzdCB9KSA9PiByZXN0KTtcbiAgLy8gY29uc3QgZmVhdHVyZXMgPSBbXTtcbiAgLy8gZm9yIChsZXQgaSA9IDA7IGkgPCB3a2JfbGlzdC5sZW5ndGg7IGkrKykge1xuICAvLyAgIGNvbnN0IHBvaW50ZXIgPSBHRU9TLmdlb3NHZW9tRnJvbVdLQih3a2JfbGlzdFtpXSk7XG4gIC8vICAgY29uc3QgZ2VvanNvbiA9IGF3YWl0IEdFT1MuZ2Vvc0dlb21Ub0dlb2pzb24ocG9pbnRlciwgR0VPUy5nZW9zKTtcbiAgLy8gICBnZW9qc29uLmNvb3JkaW5hdGVzLmZvckVhY2goKHBvbHlnb24pID0+IHtcbiAgLy8gICAgIHBvbHlnb24uZm9yRWFjaCgocmluZykgPT4ge1xuICAvLyAgICAgICByaW5nLnJldmVyc2UoKTtcbiAgLy8gICAgIH0pO1xuICAvLyAgIH0pO1xuICAvLyAgIGNvbnN0IGZlYXR1cmUgPSB7XG4gIC8vICAgICB0eXBlOiBcIkZlYXR1cmVcIixcbiAgLy8gICAgIGdlb21ldHJ5OiBnZW9qc29uLFxuICAvLyAgICAgcHJvcGVydGllczogZGF0YVtpXVxuICAvLyAgIH07XG4gIC8vICAgZmVhdHVyZXMucHVzaChmZWF0dXJlKTtcbiAgLy8gICBHRU9TLmdlb3MuR0VPU0dlb21fZGVzdHJveShwb2ludGVyKTtcbiAgLy8gfVxuICAvLyBjb25zdCBnZW9qc29uID0ge1xuICAvLyAgIHR5cGU6IFwiRmVhdHVyZUNvbGxlY3Rpb25cIixcbiAgLy8gICBmZWF0dXJlczogZmVhdHVyZXNcbiAgLy8gfTtcbiAgLy8gcmV0dXJuIHsgbmFtZXM6IFtcIlNTQVwiXS5jb25jYXQoYTBfbmFtZXMpLCBHRU9KU09OOiBnZW9qc29uIH07XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTc4IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiYWRtaW4wX2ZpbHRlcmVkID0ge1xuICBpZiAoY291bnRyeSAhPT0gXCJTU0FcIikge1xuICAgIGxldCBmaWx0ZXJlZCA9IGFkbWluMF9sb2FkLmZlYXR1cmVzLmZpbHRlcigoZCkgPT4ge1xuICAgICAgcmV0dXJuIGQucHJvcGVydGllcy5hZG1pbjBfbmFtZSA9PT0gY291bnRyeTtcbiAgICB9KTtcbiAgICAvLyBDcmVhdGUgYSBuZXcgR2VvSlNPTiBvYmplY3Qgd2l0aCB0aGUgZmlsdGVyZWQgZmVhdHVyZXNcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogYWRtaW4wX2xvYWQudHlwZSxcbiAgICAgIGZlYXR1cmVzOiBmaWx0ZXJlZFxuICAgIH07XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIGFkbWluMF9sb2FkO1xuICB9XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTc5IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiYWRtaW4xID0ge1xuICBsZXQgYWRtaW4xX3F1ZXJ5O1xuICBpZiAoY291bnRyeSA9PT0gXCJTU0FcIiAmJiBhZG1pbl9hZ2dyZWdhdGlvbkxldmVsID09PSBcImFkbWluMV9uYW1lXCIpIHtcbiAgICBhZG1pbjFfcXVlcnkgPSBgYDtcbiAgfSBlbHNlIGlmIChcbiAgICBhZG1pbl9hZ2dyZWdhdGlvbkxldmVsID09PSBcImFkbWluMV9uYW1lXCIgfHxcbiAgICBhZG1pbl9hZ2dyZWdhdGlvbkxldmVsID09PSBcImFkbWluMl9uYW1lXCJcbiAgKSB7XG4gICAgYWRtaW4xX3F1ZXJ5ID0gYFdIRVJFIGFkbWluMF9uYW1lID0gJyR7Y291bnRyeX0nYDtcbiAgfSBlbHNlIHtcbiAgICBhZG1pbjFfcXVlcnkgPSBgV0hFUkUgYWRtaW4xX25hbWUgPSAnJ2A7IC8vIFRoaXMgd2lsbCBhbHdheXMgcmV0dXJuIGVtcHR5LCBzbyByZXNwb25zZSB3aWxsIGJlIGVtcHR5IGdlb2pzb25cbiAgfVxuXG4gIGxldCByZXNwb25zZSA9IGF3YWl0IGdlb19kYi5xdWVyeShgXG4gICAgU0VMRUNUICpcbiAgICBGUk9NIGFkbWluMV9nZW9tXG4gICAgJHthZG1pbjFfcXVlcnl9YCk7XG4gIGxldCBhMV9uYW1lcyA9IHJlc3BvbnNlLm1hcCgoZCkgPT4gZC5hZG1pbjFfbmFtZSk7XG4gIG11dGFibGUgYWRtaW4xX25hbWVzID0gW1wiRnVsbCBDb3VudHJ5XCJdLmNvbmNhdChhMV9uYW1lcyk7XG4gIGxldCB3a2JfbGlzdCA9IHJlc3BvbnNlLm1hcCgoZCkgPT4gZC5nZW9tZXRyeSk7XG4gIGxldCBkYXRhID0gYXdhaXQgcmVzcG9uc2UubWFwKCh7IGdlb21ldHJ5LCAuLi5yZXN0IH0pID0+IHJlc3QpO1xuICBjb25zdCBmZWF0dXJlcyA9IFtdO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IHdrYl9saXN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgY29uc3QgcG9pbnRlciA9IEdFT1MuZ2Vvc0dlb21Gcm9tV0tCKHdrYl9saXN0W2ldKTtcbiAgICBsZXQgZ2VvanNvbiA9IGF3YWl0IEdFT1MuZ2Vvc0dlb21Ub0dlb2pzb24ocG9pbnRlciwgR0VPUy5nZW9zKTtcbiAgICBnZW9qc29uID0gdHVyZlJld2luZChnZW9qc29uLCB7IHJldmVyc2U6IHRydWUgfSk7XG4gICAgY29uc3QgZmVhdHVyZSA9IHtcbiAgICAgIHR5cGU6IFwiRmVhdHVyZVwiLFxuICAgICAgZ2VvbWV0cnk6IGdlb2pzb24sXG4gICAgICBwcm9wZXJ0aWVzOiBkYXRhW2ldXG4gICAgfTtcbiAgICBmZWF0dXJlcy5wdXNoKGZlYXR1cmUpO1xuICAgIEdFT1MuZ2Vvcy5HRU9TR2VvbV9kZXN0cm95KHBvaW50ZXIpO1xuICB9XG4gIGNvbnN0IGdlb2pzb24gPSB7XG4gICAgdHlwZTogXCJGZWF0dXJlQ29sbGVjdGlvblwiLFxuICAgIGZlYXR1cmVzOiBmZWF0dXJlc1xuICB9O1xuICAvLyByZXR1cm4geyBuYW1lczogW1wiRnVsbCBDb3VudHJ5XCJdLmNvbmNhdChhMV9uYW1lcyksIEdFT0pTT046IGdlb2pzb24gfTtcbiAgcmV0dXJuIGdlb2pzb247XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTgwIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiYWRtaW4yID0ge1xuICBsZXQgYWRtaW4yX3F1ZXJ5O1xuICBpZiAoYWRtaW4yX3NlbCAhPT0gXCJGdWxsIFJlZ2lvblwiKSB7XG4gICAgYWRtaW4yX3F1ZXJ5ID0gYFdIRVJFIGFkbWluMF9uYW1lID0gJyR7Y291bnRyeX0nIGFuZCBhZG1pbjFfbmFtZSA9ICcke2FkbWluMV9zZWx9J2A7IC8vIGFuZCBhZG1pbjJfbmFtZSA9ICcke2FkbWluMl9zZWx9J1xuICB9IGVsc2UgaWYgKFxuICAgIGFkbWluMl9zZWwgPT09IFwiRnVsbCBSZWdpb25cIiAmJlxuICAgIGFkbWluMV9zZWwgIT09IFwiRnVsbCBDb3VudHJ5XCIgJiZcbiAgICBhZG1pbl9hZ2dyZWdhdGlvbkxldmVsID09PSBcImFkbWluMl9uYW1lXCJcbiAgKSB7XG4gICAgYWRtaW4yX3F1ZXJ5ID0gYFdIRVJFIGFkbWluMF9uYW1lID0gJyR7Y291bnRyeX0nIGFuZCBhZG1pbjFfbmFtZSA9ICcke2FkbWluMV9zZWx9J2A7XG4gIH0gZWxzZSBpZiAoXG4gICAgYWRtaW4xX3NlbCA9PT0gXCJGdWxsIENvdW50cnlcIiAmJlxuICAgIGNvdW50cnkgIT09IFwiU1NBXCIgJiZcbiAgICBhZG1pbl9hZ2dyZWdhdGlvbkxldmVsID09PSBcImFkbWluMl9uYW1lXCJcbiAgKSB7XG4gICAgYWRtaW4yX3F1ZXJ5ID0gYFdIRVJFIGFkbWluMF9uYW1lID0gJyR7Y291bnRyeX0nYDtcbiAgfSBlbHNlIGlmIChjb3VudHJ5ID09PSBcIlNTQVwiICYmIGFkbWluX2FnZ3JlZ2F0aW9uTGV2ZWwgPT09IFwiYWRtaW4yX25hbWVcIikge1xuICAgIGFkbWluMl9xdWVyeSA9IGBgO1xuICB9IGVsc2Uge1xuICAgIGFkbWluMl9xdWVyeSA9IGB3aGVyZSBhZG1pbjJfbmFtZSA9ICcnYDtcbiAgfVxuXG4gIGxldCByZXNwb25zZSA9IGF3YWl0IGdlb19kYi5xdWVyeShgXG4gICAgU0VMRUNUICpcbiAgICBGUk9NIGFkbWluMl9nZW9tXG4gICAgJHthZG1pbjJfcXVlcnl9YCk7IC8vIFdIRVJFIGFkbWluMF9uYW1lID0gJyR7Y291bnRyeX0nIEFORCBhZG1pbjFfbmFtZSA9ICcke2FkbWluMV9zZWx9J2ApO1xuXG4gIC8vLy8gVEhJUyBJUyBXSFJFIFlPVSBBUkUgQVQ+Pj5cbiAgbGV0IHdrYl9saXN0ID0gcmVzcG9uc2UubWFwKChkKSA9PiBkLmdlb21ldHJ5KTtcbiAgbGV0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5tYXAoKHsgZ2VvbWV0cnksIC4uLnJlc3QgfSkgPT4gcmVzdCk7XG4gIGNvbnN0IGZlYXR1cmVzID0gW107XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgd2tiX2xpc3QubGVuZ3RoOyBpKyspIHtcbiAgICBjb25zdCBwb2ludGVyID0gR0VPUy5nZW9zR2VvbUZyb21XS0Iod2tiX2xpc3RbaV0pO1xuICAgIGxldCBnZW9qc29uID0gYXdhaXQgR0VPUy5nZW9zR2VvbVRvR2VvanNvbihwb2ludGVyLCBHRU9TLmdlb3MpO1xuICAgIGdlb2pzb24gPSB0dXJmUmV3aW5kKGdlb2pzb24sIHsgcmV2ZXJzZTogdHJ1ZSB9KTtcbiAgICBjb25zdCBmZWF0dXJlID0ge1xuICAgICAgdHlwZTogXCJGZWF0dXJlXCIsXG4gICAgICBnZW9tZXRyeTogZ2VvanNvbixcbiAgICAgIHByb3BlcnRpZXM6IGRhdGFbaV1cbiAgICB9O1xuICAgIGZlYXR1cmVzLnB1c2goZmVhdHVyZSk7XG4gICAgR0VPUy5nZW9zLkdFT1NHZW9tX2Rlc3Ryb3kocG9pbnRlcik7XG4gIH1cbiAgY29uc3QgZ2VvanNvbiA9IHtcbiAgICB0eXBlOiBcIkZlYXR1cmVDb2xsZWN0aW9uXCIsXG4gICAgZmVhdHVyZXM6IGZlYXR1cmVzXG4gIH07XG4gIC8vIHJldHVybiB7IG5hbWVzOiBbXCJGdWxsIFJlZ2lvblwiXS5jb25jYXQoYTJfbmFtZXMpLCBHRU9KU09OOiBnZW9qc29uIH07XG4gIHJldHVybiBnZW9qc29uO1xufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC04MSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImFwcGVuZF9hMk5hbWVzID0ge1xuICBsZXQgcmVzcG9uc2UgPSBhd2FpdCBnZW9fZGIucXVlcnkoYFxuICAgIFNFTEVDVCBhZG1pbjJfbmFtZVxuICAgIEZST00gYWRtaW4yX2dlb21cbiAgICB3aGVyZSBhZG1pbjBfbmFtZSA9ICcke2NvdW50cnl9JyBhbmQgYWRtaW4xX25hbWUgPSAnJHthZG1pbjFfc2VsfSdgKTsgLy8gV0hFUkUgYWRtaW4wX25hbWUgPSAnJHtjb3VudHJ5fScgQU5EIGFkbWluMV9uYW1lID0gJyR7YWRtaW4xX3NlbH0nYCk7XG4gIC8vLy8gVEhJUyBJUyBXSFJFIFlPVSBBUkUgQVQ+Pj5cbiAgbGV0IGEyX25hbWVzID0gcmVzcG9uc2UubWFwKChkKSA9PiBkLmFkbWluMl9uYW1lKTtcbiAgbXV0YWJsZSBhZG1pbjJfbmFtZXMgPSBbXCJGdWxsIFJlZ2lvblwiXS5jb25jYXQoYTJfbmFtZXMpO1xuICByZXR1cm4gYTJfbmFtZXM7XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTgyIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoibWRgIyMjIEdlb2dyYXBoeSBTZWxlY3RvcnNgO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC04MyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Im11dGFibGUgYWRtaW4wX25hbWVzID0gW1wiU1NBXCJdXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTg0IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoibXV0YWJsZSBhZG1pbjFfbmFtZXMgPSBbXCJGdWxsIENvdW50cnlcIl1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtODUiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJtdXRhYmxlIGFkbWluMl9uYW1lcyA9IFtcIkZ1bGwgUmVnaW9uXCJdXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTg2IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoidmlld29mIGNvdW50cnkgPSB7XG4gIGNvbnN0IGNvdW50cnkgPSBJbnB1dHMuc2VsZWN0KGFkbWluMF9uYW1lcywge1xuICAgIGxhYmVsOiBcIlNlbGVjdCBDb3VudHJ5XCJcbiAgfSk7XG4gIHJldHVybiBjb3VudHJ5O1xufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC04NyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InZpZXdvZiBhZG1pbjFfc2VsID0gSW5wdXRzLnNlbGVjdChhZG1pbjFfbmFtZXMsIHsgbGFiZWw6IFwiYWRtaW4xXCIgfSlcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtODgiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ2aWV3b2YgYWRtaW4yX3NlbCA9IElucHV0cy5zZWxlY3QoYWRtaW4yX25hbWVzLCB7IGxhYmVsOiBcImFkbWluMlwiIH0pXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTg5IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoibWRgIyMgU2VsZWN0b3IgRm9ybXNgO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC05MCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Im1kYCMjIyBIYXphcmRgO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC05MSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InZpZXdvZiBoYXphcmRfc2VsID0gSW5wdXRzLnNlbGVjdChcbiAgLy8gSW5wdXRzLnNlbGVjdChcbiAgLy8gICBuZXcgTWFwKFxuICAvLyAgICAgRGF0YVNlbGVjdG9yX2Zvcm0uaGF6YXJkR3JvdXBfZm9ybS5oYXphcmRfc2VsLm1hcCgodmFsdWUpID0+IFtcbiAgLy8gICAgICAgaGF6YXJkX2RpY3RbdmFsdWVdLm5hbWUsXG4gIC8vICAgICAgIHZhbHVlXG4gIC8vICAgICBdKVxuICAvLyAgICksXG4gIC8vICAgeyBsYWJlbDogXCJIYXphcmRcIiB9XG4gIC8vICksXG4gIG5ldyBNYXAoT2JqZWN0LmVudHJpZXMoaGF6YXJkX2RpY3QpLm1hcCgoW2tleSwgdmFsdWVdKSA9PiBbdmFsdWUubmFtZSwga2V5XSkpLFxuICB7IGxhYmVsOiBcIkhhemFyZFwiIH0gLy8sIGZvcm1hdDogKFtuYW1lXSkgPT4gYCR7bmFtZX1gXG4pXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTkyIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoidmlld29mIHRpbWVfc2VsID0gSW5wdXRzLnNlbGVjdChcbiAgbmV3IE1hcChbXG4gICAgW1wiQmFzZWxpbmVcIiwgXCJoaXN0b3JpY1wiXSxcbiAgICBbXCIyMDQwXCIsIFwiMjAyMV8yMDQwXCJdLFxuICAgIFtcIjIwNjBcIiwgXCIyMDQxXzIwNjBcIl1cbiAgXSksXG4gIHsgbGFiZWw6IFwiVGltZSBQZXJpb2RcIiwgdmFsdWU6IFwiaGlzdG9yaWNcIiB9IC8vLCBmb3JtYXQ6IChbbmFtZV0pID0+IGAke25hbWV9YFxuKVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC05MyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InZpZXdvZiBzc3Bfc2VsID0ge1xuICBjb25zdCBjaG9pY2VzID0gdGltZV9zZWwgPT09IFwiaGlzdG9yaWNcIiA/IFtcIkhpc3RvcmljXCJdIDogW1wiU1NQMjQ1XCIsIFwiU1NQNTg1XCJdO1xuICByZXR1cm4gSW5wdXRzLnNlbGVjdChjaG9pY2VzLCB7IGxhYmVsOiBcIlNjZW5hcmlvXCIgfSk7XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTk0IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoibWRgIyMjIEFkYXB0aXZlIENhcGFjaXR5YDtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtOTUiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ2aWV3b2YgYWNfY2F0ID0gSW5wdXRzLnNlbGVjdChbXCJFZHVjYXRpb25cIiwgXCJQb3ZlcnR5XCIsIFwiR2VuZGVyXCJdLCB7XG4gIC8vIHZhbHVlOiBcIlBvdmVydHlcIixcbiAgbGFiZWw6IFwiQWRhcHRpdmUgQ2FwYWNpdHlcIlxufSlcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtOTYiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ2aWV3b2YgYWNfc3ViY2F0ID0ge1xuICBsZXQgc3ViY2F0cztcbiAgaWYgKGFjX2NhdCA9PT0gXCJHZW5kZXJcIikge1xuICAgIHN1YmNhdHMgPSBuZXcgTWFwKFxuICAgICAgT2JqZWN0LmVudHJpZXModnVsbmVyYWJpbGl0eV9kaWN0W1wiZ2VuZGVyXCJdKS5tYXAoKFtrZXksIHZhbHVlXSkgPT4gW1xuICAgICAgICB2YWx1ZSxcbiAgICAgICAga2V5XG4gICAgICBdKVxuICAgICk7XG4gIH0gZWxzZSBpZiAoYWNfY2F0ID09PSBcIlBvdmVydHlcIikge1xuICAgIHN1YmNhdHMgPSBuZXcgTWFwKFxuICAgICAgT2JqZWN0LmVudHJpZXModnVsbmVyYWJpbGl0eV9kaWN0W1wicG92ZXJ0eVwiXSkubWFwKChba2V5LCB2YWx1ZV0pID0+IFtcbiAgICAgICAgdmFsdWUsXG4gICAgICAgIGtleVxuICAgICAgXSlcbiAgICApO1xuICB9IGVsc2Uge1xuICAgIHN1YmNhdHMgPSBbXTtcbiAgfVxuICByZXR1cm4gSW5wdXRzLnNlbGVjdChzdWJjYXRzLCB7XG4gICAgbGFiZWw6IGAke2FjX2NhdH0gQ2F0ZWdvcnlgXG4gIH0pO1xufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC05NyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Im1kYCMjIEV4cG9zdXJlYDtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtOTgiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ2aWV3b2YgZXhwb3N1cmVfY2F0ID0gSW5wdXRzLnNlbGVjdChbXCJDcm9wXCIsIFwiTGl2ZXN0b2NrXCIsIFwiUG9wdWxhdGlvblwiXSwge1xuICB2YWx1ZTogXCJDcm9wXCIsXG4gIGxhYmVsOiBcIkV4cG9zdXJlIENhdGVnb3J5XCJcbn0pXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTk5IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiY29tbW9kaXRpZXMgPSBuZXcgT2JqZWN0KHtcbiAgQ3JvcDogW1xuICAgIFwid2hlYXRcIixcbiAgICBcInJpY2VcIixcbiAgICBcIm1haXplXCIsXG4gICAgXCJiYXJsZXlcIixcbiAgICBcInBlYXJsIG1pbGxldFwiLFxuICAgIFwic21hbGwgbWlsbGV0XCIsXG4gICAgXCJzb3JnaHVtXCIsXG4gICAgXCJwb3RhdG9cIixcbiAgICBcInN3ZWV0IHBvdGF0b1wiLFxuICAgIFwieWFtc1wiLFxuICAgIFwiY2Fzc2F2YVwiLFxuICAgIFwiYmVhblwiLFxuICAgIFwiY2hpY2twZWFcIixcbiAgICBcImNvd3BlYVwiLFxuICAgIFwicGlnZW9ucGVhXCIsXG4gICAgXCJsZW50aWxcIixcbiAgICBcInNveWJlYW5cIixcbiAgICBcImdyb3VuZG51dFwiLFxuICAgIFwiY29jb251dFwiLFxuICAgIFwib2lscGFsbVwiLFxuICAgIFwic3VuZmxvd2VyXCIsXG4gICAgXCJyYXBlc2VlZFwiLFxuICAgIFwic2VzYW1lc2VlZFwiLFxuICAgIFwic3VnYXJjYW5lXCIsXG4gICAgXCJzdWdhcmJlZXRcIixcbiAgICBcImNvdHRvblwiLFxuICAgIFwiYXJhYmljYSBjb2ZmZWVcIixcbiAgICBcInJvYnVzdGEgY29mZmVlXCIsXG4gICAgXCJjb2NvYVwiLFxuICAgIFwidGVhXCIsXG4gICAgXCJ0b2JhY2NvXCIsXG4gICAgXCJiYW5hbmFcIixcbiAgICBcInBsYW50YWluXCIsXG4gIF0sXG4gIExpdmVzdG9jazogW1xuICAgIFwiY2F0dGxlX3Ryb3BpY2FsXCIsXG4gICAgXCJwb3VsdHJ5X3Ryb3BpY2FsXCIsXG4gICAgXCJwaWdzX3Ryb3BpY2FsXCIsXG4gICAgXCJzaGVlcF90cm9waWNhbFwiLFxuICAgIFwiZ29hdHNfdHJvcGljYWxcIixcbiAgICBcImNhdHRsZV9oaWdobGFuZFwiLFxuICAgIFwicG91bHRyeV9oaWdobGFuZFwiLFxuICAgIFwicGlnc19oaWdobGFuZFwiLFxuICAgIFwic2hlZXBfaGlnaGxhbmRcIixcbiAgICBcImdvYXRzX2hpZ2hsYW5kXCIsXG4gIF0sXG59KTtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTAwIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoidmlld29mIGV4cG9zdXJlX3N1YkNhdCA9IHtcbiAgbGV0IHRpdGxlO1xuICBsZXQgc2VsZWN0aW9ucztcbiAgaWYgKGV4cG9zdXJlX2NhdCA9PT0gXCJQb3B1bGF0aW9uXCIpIHtcbiAgICB0aXRsZSA9IFwiUG9wdWxhdGlvbiBHcm91cFwiO1xuICAgIHNlbGVjdGlvbnMgPSBuZXcgTWFwKFtcbiAgICAgIFtcIlRvdGFsIFBvcHVsYXRpb25cIiwgXCJ0b3RhbF9wb3BcIl0sXG4gICAgICBbXCJSdXJhbCBQb3B1bGF0aW9uXCIsIFwicnVyYWxfcG9wXCJdLFxuICAgICAgW1wiVXJiYW4gUG9wdWxhdGlvblwiLCBcInVyYmFuX3BvcFwiXVxuICAgIF0pO1xuICB9IGVsc2Uge1xuICAgIHRpdGxlID0gXCJDb21tb2RpdHlcIjtcbiAgICBzZWxlY3Rpb25zID0gY29tbW9kaXRpZXNbZXhwb3N1cmVfY2F0XTtcbiAgfVxuXG4gIHJldHVybiBJbnB1dHMuc2VsZWN0KHNlbGVjdGlvbnMsIHtcbiAgICBsYWJlbDogdGl0bGVcbiAgfSk7XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTEwMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImV4cG9zdXJlX3Zhcl9jaG9pY2VzID0ge1xuICBsZXQgY2hvaWNlcztcbiAgaWYgKGV4cG9zdXJlX2NhdCA9PT0gXCJQb3B1bGF0aW9uXCIpIHtcbiAgICBjaG9pY2VzID0gW1xuICAgICAgXCJ0b3RhbF9wb3BcIixcbiAgICAgIFwicnVyYWxfcG9wXCIsXG4gICAgICBcInVyYmFuX3BvcFwiXG4gICAgICAvLyB7IG5hbWU6IFwiVG90YWwgUG9wdWxhdGlvblwiLCB2YXJpYWJsZTogXCJ0b3RhbF9wb3BcIiB9LFxuICAgICAgLy8geyBuYW1lOiBcIlJ1cmFsIFBvcHVsYXRpb25cIiwgdmFyaWFibGU6IFwicnVyYWxfcG9wXCIgfSxcbiAgICAgIC8vIHsgbmFtZTogXCJVcmJhbiBQb3B1bGF0aW9uXCIsIHZhcmlhYmxlOiBcInVyYmFuX3BvcFwiIH1cbiAgICBdOyAvL2FkZCBkZW5zaXR5IHRvIHJhc3RlclxuICB9IGVsc2UgaWYgKGV4cG9zdXJlX2NhdCA9PT0gXCJDcm9wXCIpIHtcbiAgICBjaG9pY2VzID0gW1xuICAgICAgJ3ZvcCcsXG4gICAgICAnaGEnXG4gICAgICAvLyB7IG5hbWU6IFwiVmFsdWUgb2YgUHJvZHVjdGlvblwiLCB2YXJpYWJsZTogXCJ2b3BcIiB9LFxuICAgICAgLy8geyBuYW1lOiBcIkhhcnZlc3RlZCBBcmVhXCIsIHZhcmlhYmxlOiBcImhhXCIgfVxuICAgIF07XG4gIH0gZWxzZSB7XG4gICAgY2hvaWNlcyA9IFtcbiAgICAgICd2b3AnLFxuICAgICAgJ251bWJlcidcbiAgICAgIC8vIHsgbmFtZTogXCJWYWx1ZSBvZiBQcm9kdWN0aW9uXCIsIHZhcmlhYmxlOiBcInZvcFwiIH0sXG4gICAgICAvLyB7IG5hbWU6IFwiTnVtYmVyIG9mIEFuaW1hbHNcIiwgdmFyaWFibGU6IFwibnVtYmVyXCIgfVxuICAgIF07XG4gIH1cbiAgcmV0dXJuIGNob2ljZXM7XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTEwMiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InZpZXdvZiBleHBvc3VyZV92YXIgPSB7XG4gIHJldHVybiBJbnB1dHMuc2VsZWN0KGV4cG9zdXJlX3Zhcl9jaG9pY2VzLCB7XG4gICAgbGFiZWw6IFwiVmFyaWFibGVcIixcbiAgICBmb3JtYXQ6ICh0KSA9PiBfbGFuZyhuYlRleHQuVmlld0V4cGxvcmUuc2VsZWN0b3JzLnZpc3VhbGlzZVZhcnMuZXhwb3N1cmUuZXhwb3N1cmVWYXJpYWJsZS5vcHRpb25zW3RdKVxuICB9KTtcbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTAzIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoibWRgIyMgTWFwIFNldHVwYDtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTA0IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoibWRgIyMjIEQzIG1hcGA7XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTEwNSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Im1hcCA9ICgpID0+IHtcbiAgY29uc3Qgd2lkdGggPSA5NTA7XG4gIGNvbnN0IGhlaWdodCA9IDYwMDtcblxuICBsZXQgbWluVmFsdWU7XG4gIGxldCBtYXhWYWx1ZTtcblxuICBpZiAodmFyX3VuaXRbXCJjYXRlZ29yeVwiXSA9PT0gXCJpbmRleFwiKSB7XG4gICAgbWluVmFsdWUgPSAwO1xuICAgIG1heFZhbHVlID0gMTtcbiAgfSBlbHNlIHtcbiAgICBtaW5WYWx1ZSA9IGQzLm1pbihhZG1pbkxldmVsX3NwYXRpYWwuZmVhdHVyZXMsIChkKSA9PiBkLnByb3BlcnRpZXMudmFsdWUpO1xuICAgIG1heFZhbHVlID0gZDMubWF4KGFkbWluTGV2ZWxfc3BhdGlhbC5mZWF0dXJlcywgKGQpID0+IGQucHJvcGVydGllcy52YWx1ZSk7XG4gIH1cblxuICBkMy5zZWxlY3RBbGwoXCIubWFwVGlwXCIpLnJlbW92ZSgpO1xuICBjb25zdCB0b29sdGlwID0gZDNcbiAgICAuc2VsZWN0KFwiYm9keVwiKVxuICAgIC5hcHBlbmQoXCJkaXZcIilcbiAgICAuYXR0cihcImNsYXNzXCIsIFwicGxvdFRvb2x0aXAgbWFwVGlwXCIpXG4gICAgLnN0eWxlKFwicG9zaXRpb25cIiwgXCJhYnNvbHV0ZVwiKTtcblxuICBsZXQgY29sb3I7XG4gIGlmIChhdGxhc19jYXQgPT09IFwiSGF6YXJkXCIpIHtcbiAgICBjb2xvciA9IGQzLnNjYWxlVGhyZXNob2xkKFxuICAgICAgaGF6YXJkX2RpY3RbaGF6YXJkX3NlbF1bXCJ0aHJlc2hvbGRzXCJdLFxuICAgICAgaGF6YXJkX2RpY3RbaGF6YXJkX3NlbF1bXCJjb2xvdXJzXCJdLFxuICAgICk7XG4gIH0gZWxzZSBpZiAoXG4gICAgYXRsYXNfY2F0ID09PSBcIkV4cG9zdXJlXCIgJiZcbiAgICAoZXhwb3N1cmVfY2F0ID09PSBcIkNyb3BcIiB8fCBleHBvc3VyZV9jYXQgPT09IFwiTGl2ZXN0b2NrXCIpXG4gICkge1xuICAgIGNvbG9yID0gZnVuY3Rpb24gKHYpIHtcbiAgICAgIGxldCBub25aZXJvX21pbiA9IChtaW5WYWx1ZSA9IGQzLm1pbihhZG1pbkxldmVsX3NwYXRpYWwuZmVhdHVyZXMsIChkKSA9PlxuICAgICAgICBkLnByb3BlcnRpZXMudmFsdWUgJiYgZC5wcm9wZXJ0aWVzLnZhbHVlICE9PSAwXG4gICAgICAgICAgPyBkLnByb3BlcnRpZXMudmFsdWVcbiAgICAgICAgICA6IEluZmluaXR5LFxuICAgICAgKSk7XG4gICAgICBsZXQgZDNjb2xvciA9IGQzXG4gICAgICAgIC5zY2FsZUxvZygpXG4gICAgICAgIC5kb21haW4oW25vblplcm9fbWluLCBtYXhWYWx1ZV0pXG4gICAgICAgIC5yYW5nZShbXCIjRjdENzMyXCIsIFwiIzIxNjcyOVwiXSk7XG4gICAgICByZXR1cm4gdiA9PT0gMCA/IFwibGlnaHRncmV5XCIgOiBkM2NvbG9yKHYpO1xuICAgIH07XG4gIH0gZWxzZSB7XG4gICAgLy8gQWRkIGEgYWJpbGl0eSB0byBmbGlwIGNvbG9yXG4gICAgbGV0IGNvbG9yX2hleCA9XG4gICAgICBhdGxhc19jYXQgPT09IFwiVnVsbmVyYWJpbGl0eVwiICYmIGFjX2NhdCA9PT0gXCJQb3ZlcnR5XCJcbiAgICAgICAgPyBbXCIjMjE2NzI5XCIsIFwiI0Y3RDczMlwiXVxuICAgICAgICA6IFtcIiNGN0Q3MzJcIiwgXCIjMjE2NzI5XCJdO1xuICAgIGNvbG9yID0gZDMuc2NhbGVMaW5lYXIoKS5kb21haW4oW21pblZhbHVlLCBtYXhWYWx1ZV0pLnJhbmdlKGNvbG9yX2hleCk7XG4gIH1cblxuICBjb25zdCBwcm9qZWN0aW9uID0gZDNcbiAgICAuZ2VvQXppbXV0aGFsRXF1YWxBcmVhKClcbiAgICAuZml0U2l6ZShbd2lkdGgsIDYwMF0sIGFkbWluTGV2ZWxfc3BhdGlhbCk7XG5cbiAgY29uc3QgcGF0aCA9IGQzLmdlb1BhdGgocHJvamVjdGlvbik7XG5cbiAgY29uc3QgcGFkZGluZyA9IDc1O1xuXG4gIGNvbnN0IHN2ZyA9IGQzXG4gICAgLmNyZWF0ZShcInN2Z1wiKVxuICAgIC5hdHRyKFwid2lkdGhcIiwgd2lkdGggKyA1MClcbiAgICAuYXR0cihcInZpZXdCb3hcIiwgWzAsIC1wYWRkaW5nLCB3aWR0aCwgNjAwICsgcGFkZGluZ10pXG4gICAgLnN0eWxlKFwiYmFja2dyb3VuZFwiLCBcImxpZ2h0Ymx1ZVwiKSAvLyBzZXQgdGhlIGJhY2tncm91bmQgY29sb3JcbiAgICAuc3R5bGUoXCJjdXJzb3JcIiwgXCJncmFiXCIpO1xuICAvLyAuc3R5bGUoXCJib3JkZXJcIiwgXCIxcHggc29saWQgYmxhY2tcIik7XG5cbiAgY29uc3QgbWFwID0gc3ZnXG4gICAgLmFwcGVuZChcImdcIilcbiAgICAuc2VsZWN0QWxsKFwicGF0aFwiKVxuICAgIC5kYXRhKGFkbWluTGV2ZWxfc3BhdGlhbC5mZWF0dXJlcylcbiAgICAuam9pbihcInBhdGhcIilcbiAgICAuYXR0cihcImZpbGxcIiwgKGQpID0+IGNvbG9yKGQucHJvcGVydGllcy52YWx1ZSkpXG4gICAgLmF0dHIoXCJzdHJva2VcIiwgXCIjZmZmXCIpXG4gICAgLmF0dHIoXCJzdHJva2Utd2lkdGhcIiwgXCIxXCIpXG4gICAgLmF0dHIoXCJzdHJva2UtbGluZWpvaW5cIiwgXCJyb3VuZFwiKVxuICAgIC5hdHRyKFwiZFwiLCBwYXRoKTtcblxuICBtYXBcbiAgICAub24oXCJtb3VzZW92ZXJcIiwgKGV2ZW50LCBkKSA9PiB7XG4gICAgICBkMy5zZWxlY3QoZXZlbnQuY3VycmVudFRhcmdldCkuc3R5bGUoXCJzdHJva2VcIiwgXCJibGFja1wiKS5yYWlzZSgpO1xuICAgIH0pXG4gICAgLm9uKFwibW91c2Vtb3ZlXCIsIChldmVudCwgZCkgPT4ge1xuICAgICAgdG9vbHRpcFxuICAgICAgICAuc3R5bGUoXCJ0b3BcIiwgZXZlbnQucGFnZVkgLSAxMCArIFwicHhcIilcbiAgICAgICAgLnN0eWxlKFwibGVmdFwiLCBldmVudC5wYWdlWCArIDEwICsgXCJweFwiKVxuICAgICAgICAuc3R5bGUoXCJvcGFjaXR5XCIsIDEpXG4gICAgICAgIC5zdHlsZShcImRpc3BsYXlcIiwgXCJibG9ja1wiKVxuICAgICAgICAuaHRtbChcbiAgICAgICAgICBgJHttYWtlX3Rvb2x0aXBfYWRtaW4oZC5wcm9wZXJ0aWVzKX08YnI+JHtfbGFuZyhuYlRleHQuVmlld0V4cGxvcmUuZXhwbG9yZU1hcC52YWx1ZSl9OiAke2Zvcm1hdF92YWwoXG4gICAgICAgICAgICBkLnByb3BlcnRpZXMudmFsdWUsXG4gICAgICAgICAgICB2YXJfdW5pdFtcImNhdGVnb3J5XCJdLFxuICAgICAgICAgICl9ICgke3Zhcl91bml0LmxhYmVsfSlgLFxuICAgICAgICApO1xuICAgIH0pXG4gICAgLm9uKFwibW91c2VvdXRcIiwgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICBkMy5zZWxlY3QoXCIubWFwVGlwXCIpLnN0eWxlKFwiZGlzcGxheVwiLCBcIm5vbmVcIik7XG4gICAgICBkMy5zZWxlY3QoZXZlbnQuY3VycmVudFRhcmdldCkuc3R5bGUoXCJzdHJva2VcIiwgXCIjZmZmXCIpO1xuICAgIH0pO1xuXG4gIC8vIFNlY3Rpb24gdG8gYWRkIGhpZ2hsaWdodHMgZm9yIHNlbGVjdGVkIGNvdW50cnkgd2hlbiBhZG1pbiBhdCBsaW1pdFxuICBsZXQgc2VsZWN0ZWRBcmVhO1xuICBpZiAoYWRtaW5fYWdncmVnYXRpb25MZXZlbCA9PT0gXCJhZG1pbjBfbmFtZVwiICYmIGNvdW50cnkgIT09IFwiU1NBXCIpIHtcbiAgICBzZWxlY3RlZEFyZWEgPSBhZG1pbkxldmVsX3NwYXRpYWwuZmVhdHVyZXMuZmlsdGVyKFxuICAgICAgKGQpID0+IGQucHJvcGVydGllcy5hZG1pbjBfbmFtZSA9PT0gY291bnRyeSxcbiAgICApO1xuICB9IGVsc2UgaWYgKFxuICAgIGFkbWluX2FnZ3JlZ2F0aW9uTGV2ZWwgPT09IFwiYWRtaW4xX25hbWVcIiAmJlxuICAgIGFkbWluMV9zZWwgIT09IFwiRnVsbCBDb3VudHJ5XCJcbiAgKSB7XG4gICAgc2VsZWN0ZWRBcmVhID0gYWRtaW5MZXZlbF9zcGF0aWFsLmZlYXR1cmVzLmZpbHRlcihcbiAgICAgIChkKSA9PiBkLnByb3BlcnRpZXMuYWRtaW4xX25hbWUgPT09IGFkbWluMV9zZWwsXG4gICAgKTtcbiAgfSBlbHNlIGlmIChhZG1pbjJfc2VsICE9PSBcIkZ1bGwgUmVnaW9uXCIpIHtcbiAgICBzZWxlY3RlZEFyZWEgPSBhZG1pbkxldmVsX3NwYXRpYWwuZmVhdHVyZXMuZmlsdGVyKFxuICAgICAgKGQpID0+IGQucHJvcGVydGllcy5hZG1pbjJfbmFtZSA9PT0gYWRtaW4yX3NlbCxcbiAgICApO1xuICB9XG4gIGxldCBvdXRsaW5lO1xuICBpZiAoc2VsZWN0ZWRBcmVhKSB7XG4gICAgb3V0bGluZSA9IHN2Z1xuICAgICAgLmFwcGVuZChcInBhdGhcIilcbiAgICAgIC5kYXRhKHNlbGVjdGVkQXJlYSlcbiAgICAgIC5hdHRyKFwiZmlsbFwiLCBcIm5vbmVcIilcbiAgICAgIC5hdHRyKFwic3Ryb2tlXCIsIFwicmVkXCIpXG4gICAgICAuYXR0cihcInN0cm9rZS13aWR0aFwiLCBcIjJcIilcbiAgICAgIC5hdHRyKFwic3Ryb2tlLWxpbmVqb2luXCIsIFwicm91bmRcIilcbiAgICAgIC5hdHRyKFwiZFwiLCBwYXRoKTtcbiAgfVxuXG4gIGxldCBsZWdlbmRfYmcgPSBzdmcgLy8gYWRkIGEgd2hpdGUgYmcgYm94IGZvciB0aGUgbGVnZW5kIHNvIGl0IGRvZXNuJ3Qgb3ZlcmxhcCBvbiB6b29tXG4gICAgLmFwcGVuZChcImdcIilcbiAgICAuYXBwZW5kKFwicmVjdFwiKVxuICAgIC5hdHRyKFwid2lkdGhcIiwgd2lkdGgpXG4gICAgLmF0dHIoXCJoZWlnaHRcIiwgNzApXG4gICAgLmF0dHIoXCJ5XCIsIC03NSlcbiAgICAuYXR0cihcImZpbGxcIiwgXCJ3aGl0ZVwiKVxuICAgIC5hdHRyKFwib3BhY2l0eVwiLCAwLjkpO1xuXG4gIC8vIGNyZWF0ZUxpbmVhckxlZ2VuZChzdmcsIG1pblZhbHVlLCBtYXhWYWx1ZSwgd2lkdGgsIGhlaWdodCwgY29sb3IpO1xuICBpZiAoYXRsYXNfY2F0ID09PSBcIkhhemFyZFwiKSB7XG4gICAgY3JlYXRlVGhyZXNob2xkTGVnZW5kKFxuICAgICAgc3ZnLFxuICAgICAgaGF6YXJkX2RpY3RbaGF6YXJkX3NlbF1bXCJ0aHJlc2hvbGRzXCJdLFxuICAgICAgaGF6YXJkX2RpY3RbaGF6YXJkX3NlbF1bXCJjb2xvdXJzXCJdLFxuICAgICAgaGVpZ2h0LFxuICAgICAgZm9ybWF0X3ZhbCxcbiAgICApO1xuICB9IGVsc2Uge1xuICAgIGNyZWF0ZUxpbmVhckxlZ2VuZChzdmcsIG1pblZhbHVlLCBtYXhWYWx1ZSwgd2lkdGgsIGhlaWdodCwgY29sb3IpO1xuICB9XG5cbiAgc3ZnLmNhbGwoXG4gICAgZDNcbiAgICAgIC56b29tKClcbiAgICAgIC5leHRlbnQoW1xuICAgICAgICBbMCwgMF0sXG4gICAgICAgIFt3aWR0aCwgaGVpZ2h0XSxcbiAgICAgIF0pXG4gICAgICAuc2NhbGVFeHRlbnQoWzEsIDhdKVxuICAgICAgLm9uKFwiem9vbVwiLCB6b29tZWQpLFxuICApO1xuXG4gIGNvbnN0IHJlc2V0QnV0dG9uID0gc3ZnXG4gICAgLmFwcGVuZChcImZvcmVpZ25PYmplY3RcIilcbiAgICAuYXR0cihcIndpZHRoXCIsIDE1MClcbiAgICAuYXR0cihcImhlaWdodFwiLCA1MClcbiAgICAuYXR0cihcInhcIiwgNzUwKVxuICAgIC5hdHRyKFwieVwiLCAtNjUpXG4gICAgLmh0bWwoXG4gICAgICBgPGJ1dHRvbiBpZD1yZXNldF9idXR0b24gc3R5bGU9XCJjb2xvcjogYmxhY2s7XCI+JHtfbGFuZyhuYlRleHQuVmlld0V4cGxvcmUuZXhwbG9yZU1hcC5yZXNldEJ0bil9PC9idXR0b24+YCxcbiAgICApO1xuXG4gIHJlc2V0QnV0dG9uLnNlbGVjdChcImJ1dHRvblwiKS5vbihcImNsaWNrXCIsICgpID0+IHtcbiAgICBzdmdcbiAgICAgIC50cmFuc2l0aW9uKClcbiAgICAgIC5kdXJhdGlvbig3NTApXG4gICAgICAuY2FsbChcbiAgICAgICAgZDNcbiAgICAgICAgICAuem9vbSgpXG4gICAgICAgICAgLmV4dGVudChbXG4gICAgICAgICAgICBbMCwgMF0sXG4gICAgICAgICAgICBbd2lkdGgsIGhlaWdodF0sXG4gICAgICAgICAgXSlcbiAgICAgICAgICAuc2NhbGVFeHRlbnQoWzEsIDhdKVxuICAgICAgICAgIC5vbihcInpvb21cIiwgem9vbWVkKS50cmFuc2Zvcm0sXG4gICAgICAgIGQzLnpvb21JZGVudGl0eSxcbiAgICAgICk7XG4gIH0pO1xuXG4gIHJldHVybiBzdmcubm9kZSgpO1xuXG4gIGZ1bmN0aW9uIHpvb21lZCh7IHRyYW5zZm9ybSB9KSB7XG4gICAgbWFwLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgdHJhbnNmb3JtKTtcbiAgICBtYXAuc3R5bGUoXCJzdHJva2Utd2lkdGhcIiwgMSAvIHRyYW5zZm9ybS5rKTtcbiAgICBpZiAob3V0bGluZSkge1xuICAgICAgb3V0bGluZS5hdHRyKFwidHJhbnNmb3JtXCIsIHRyYW5zZm9ybSk7XG4gICAgICBvdXRsaW5lLnN0eWxlKFwic3Ryb2tlLXdpZHRoXCIsIDEgLyB0cmFuc2Zvcm0uayk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gbWFrZV90b29sdGlwX2FkbWluKGQpIHtcbiAgICBsZXQgYWRtaW5fdGV4dDtcbiAgICBpZiAoZC5hZG1pbjFfbmFtZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICBhZG1pbl90ZXh0ID0gYCR7X2xhbmcobmJUZXh0LmdlbmVyYWwuYWRtaW5sZXZlbHMuYWRtaW4wX25hbWUpfTogJHtfbGFuZyhuYlRleHQuZ2VuZXJhbC5hZG1pbk5hbWVzW2QuYWRtaW4wX25hbWVdKX1gO1xuICAgIH0gZWxzZSBpZiAoZC5hZG1pbjFfbmFtZSAhPT0gdW5kZWZpbmVkICYmIGQuYWRtaW4yX25hbWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgYWRtaW5fdGV4dCA9IGAke19sYW5nKG5iVGV4dC5nZW5lcmFsLmFkbWlubGV2ZWxzLmFkbWluMF9uYW1lKX06ICR7ZC5hZG1pbjBfbmFtZX08YnI+JHtfbGFuZyhuYlRleHQuZ2VuZXJhbC5hZG1pbmxldmVscy5hZG1pbjFfbmFtZSl9OiAke2QuYWRtaW4xX25hbWV9YDtcbiAgICB9IGVsc2UgaWYgKGQuYWRtaW4xX25hbWUgIT09IHVuZGVmaW5lZCAmJiBkLmFkbWluMl9uYW1lICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGFkbWluX3RleHQgPSBgJHtfbGFuZyhuYlRleHQuZ2VuZXJhbC5hZG1pbmxldmVscy5hZG1pbjBfbmFtZSl9OiAke2QuYWRtaW4wX25hbWV9PGJyPiR7X2xhbmcobmJUZXh0LmdlbmVyYWwuYWRtaW5sZXZlbHMuYWRtaW4xX25hbWUpfTogJHtkLmFkbWluMV9uYW1lfTxicj4ke19sYW5nKG5iVGV4dC5nZW5lcmFsLmFkbWlubGV2ZWxzLmFkbWluMl9uYW1lKX06ICR7ZC5hZG1pbjJfbmFtZX1gO1xuICAgIH1cbiAgICByZXR1cm4gYWRtaW5fdGV4dDtcbiAgfVxuXG4gIGZ1bmN0aW9uIGNyZWF0ZUxpbmVhckxlZ2VuZChzdmcsIG1pblZhbHVlLCBtYXhWYWx1ZSwgd2lkdGgsIGhlaWdodCwgY29sb3IpIHtcbiAgICBjb25zdCBwYWRkaW5nID0gNjU7XG4gICAgY29uc3QgZGVmcyA9IHN2Zy5hcHBlbmQoXCJkZWZzXCIpO1xuICAgIGNvbnN0IGxpbmVhckdyYWRpZW50ID0gZGVmc1xuICAgICAgLmFwcGVuZChcImxpbmVhckdyYWRpZW50XCIpXG4gICAgICAuYXR0cihcImlkXCIsIFwibGluZWFyLWdyYWRpZW50XCIpO1xuXG4gICAgbGluZWFyR3JhZGllbnRcbiAgICAgIC5zZWxlY3RBbGwoXCJzdG9wXCIpXG4gICAgICAuZGF0YShbbWluVmFsdWUsIG1heFZhbHVlXSlcbiAgICAgIC5qb2luKFwic3RvcFwiKVxuICAgICAgLmF0dHIoXCJvZmZzZXRcIiwgKGQsIGksIG4pID0+IGAkeygxMDAgKiBpKSAvIChuLmxlbmd0aCAtIDEpfSVgKVxuICAgICAgLmF0dHIoXCJzdG9wLWNvbG9yXCIsIGNvbG9yKTtcblxuICAgIGNvbnN0IGxlZ2VuZCA9IHN2Z1xuICAgICAgLmFwcGVuZChcImdcIilcbiAgICAgIC5hdHRyKFxuICAgICAgICBcInRyYW5zZm9ybVwiLFxuICAgICAgICBgdHJhbnNsYXRlKCR7d2lkdGggLSA3MDB9LCAke2hlaWdodCAtIHBhZGRpbmcgLSA1NzV9KWAsXG4gICAgICApO1xuXG4gICAgbGVnZW5kXG4gICAgICAuYXBwZW5kKFwicmVjdFwiKVxuICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGUoMCwgLTEwKVwiKVxuICAgICAgLmF0dHIoXCJ3aWR0aFwiLCAyNTApXG4gICAgICAuYXR0cihcImhlaWdodFwiLCAxMClcbiAgICAgIC5zdHlsZShcImZpbGxcIiwgXCJ1cmwoI2xpbmVhci1ncmFkaWVudClcIik7XG5cbiAgICBjb25zdCBtaWRWYWx1ZSA9IChtaW5WYWx1ZSArIG1heFZhbHVlKSAvIDI7XG5cbiAgICBsZWdlbmRcbiAgICAgIC5hcHBlbmQoXCJnXCIpXG4gICAgICAuY2FsbChcbiAgICAgICAgZDNcbiAgICAgICAgICAuYXhpc0JvdHRvbShcbiAgICAgICAgICAgIGQzLnNjYWxlTGluZWFyKCkucmFuZ2UoWzAsIDI1MF0pLmRvbWFpbihbbWluVmFsdWUsIG1heFZhbHVlXSksXG4gICAgICAgICAgKVxuICAgICAgICAgIC50aWNrVmFsdWVzKFttaW5WYWx1ZSwgbWlkVmFsdWUsIG1heFZhbHVlXSlcbiAgICAgICAgICAudGlja0Zvcm1hdChcbiAgICAgICAgICAgICh2KSA9PlxuICAgICAgICAgICAgICBgJHtmb3JtYXRfdmFsKHYsIHZhcl91bml0W1wiY2F0ZWdvcnlcIl0pfSAke3Zhcl91bml0LmxhYmVsID09PSBcIiVcIiA/IFwiXCIgOiB2YXJfdW5pdC5sYWJlbH1gLFxuICAgICAgICAgICksXG4gICAgICApXG4gICAgICAuc2VsZWN0KFwiLmRvbWFpblwiKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGNyZWF0ZVRocmVzaG9sZExlZ2VuZChzdmcsIHRocmVzaG9sZHMsIGNvbG9ycywgaGVpZ2h0LCBmb3JtYXRfdmFsKSB7XG4gICAgY29uc3QgcGFkZGluZyA9IDY1O1xuICAgIGNvbnN0IGxlZ2VuZFdpZHRoID0gMjMwO1xuICAgIGNvbnN0IGJhbmRXaWR0aCA9IGxlZ2VuZFdpZHRoIC8gKHRocmVzaG9sZHMubGVuZ3RoIC0gMSk7XG4gICAgY29uc3QgbGVnZW5kID0gc3ZnXG4gICAgICAuYXBwZW5kKFwiZ1wiKVxuICAgICAgLmF0dHIoXG4gICAgICAgIFwidHJhbnNmb3JtXCIsXG4gICAgICAgIGB0cmFuc2xhdGUoJHt3aWR0aCAtIDcwMH0sICR7aGVpZ2h0IC0gcGFkZGluZyAtIDU3NX0pYCxcbiAgICAgICk7XG5cbiAgICAvLyBBcHBlbmQgY29sb3IgYmFuZHMgdG8gbGVnZW5kXG4gICAgY29uc3QgbGFiZWxzID0gW1wibG93XCIsIFwibW9kZXJhdGVcIiwgXCJzZXZlcmVcIiwgXCJleHRyZW1lXCIsIFwiVmV4dHJlbWVcIl07XG5cbiAgICBjb2xvcnMuZm9yRWFjaCgodGhyZXNob2xkLCBpbmRleCkgPT4ge1xuICAgICAgbGVnZW5kXG4gICAgICAgIC5hcHBlbmQoXCJyZWN0XCIpXG4gICAgICAgIC5hdHRyKFwieFwiLCBpbmRleCAqIGJhbmRXaWR0aClcbiAgICAgICAgLy8gLmF0dHIoXCJ5XCIsIC0xMClcbiAgICAgICAgLmF0dHIoXCJ3aWR0aFwiLCBiYW5kV2lkdGgpXG4gICAgICAgIC5hdHRyKFwiaGVpZ2h0XCIsIDEwKVxuICAgICAgICAuc3R5bGUoXCJmaWxsXCIsIGNvbG9yc1tpbmRleF0pO1xuICAgICAgLy8gQWRkIGxhYmVsXG4gICAgICBsZWdlbmRcbiAgICAgICAgLmFwcGVuZChcInRleHRcIilcbiAgICAgICAgLmF0dHIoXCJ4XCIsIGluZGV4ICogYmFuZFdpZHRoICsgYmFuZFdpZHRoIC8gMilcbiAgICAgICAgLmF0dHIoXCJ5XCIsIC0xNSkgLy8gQWRqdXN0IHRoaXMgdmFsdWUgYXMgbmVlZGVkIGZvciBsYWJlbCBwb3NpdGlvbmluZ1xuICAgICAgICAuc3R5bGUoXCJ0ZXh0LWFuY2hvclwiLCBcIm1pZGRsZVwiKVxuICAgICAgICAudGV4dChfbGFuZyhuYlRleHQuZ2VuZXJhbC5sZXZlbHNbbGFiZWxzW2luZGV4XV0pKVxuICAgICAgICAuYXR0cihcImZvbnQtc2l6ZVwiLCBcIjEycHhcIilcbiAgICAgICAgLmF0dHIoXCJmaWxsXCIsIFwiYmxhY2tcIik7IC8vIFNldCB0aGUgY29sb3Igb2YgdGhlIGxhYmVsIHRleHRcbiAgICB9KTtcbiAgfVxufTtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTA2IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoibWRgIyMgRGVmaW5pdGlvbiBib3hlc2A7XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTEwNyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImNyZWF0ZV9kZWZpbml0aW9ucyA9IChjYXRlZ29yeSkgPT4ge1xuICBsZXQgZGVmX3RleHQgPSBfbGFuZyhkZWZpbml0aW9uVGV4dFtjYXRlZ29yeV0udGV4dCk7XG4gIHJldHVybiBodG1sYDxkZXRhaWxzIHN0eWxlPVwicGFkZGluZzogMCwgMCA7Ym9yZGVyLXJhZGl1czo1cHg7YmFja2dyb3VuZDpub25lO21heC13aWR0aDo2MDBweFwiPlxuICA8c3VtbWFyeSBzdHlsZT1cImN1cnNvcjpwb2ludGVyXCI+JHtfbGFuZyhkZWZpbml0aW9uVGV4dFtjYXRlZ29yeV0udGl0bGUpfTwvc3VtbWFyeT5cbiAgPGRpdiBzdHlsZT1cIm1hcmdpbjouNWVtIDA7Ym9yZGVyLXRvcDoxcHggZGFzaGVkICM4ODhcIj5cbiR7bWRgJHtkZWZfdGV4dH1gfVxuPGRpdj48L2RldGFpbHM+YDtcbn07XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTEwOCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Im1kYCMjIFBsb3QgRnVuY3Rpb25zYDtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTA5IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiZnVuY3Rpb24gY3JlYXRlUGxvdCgpIHtcbiAgaWYgKGF0bGFzX2NhdCA9PT0gXCJFeHBvc3VyZVwiKSB7XG4gICAgaWYgKGV4cG9zdXJlX2NhdC5pbmNsdWRlcyhcIkxpdmVzdG9ja1wiKSB8fCBleHBvc3VyZV9jYXQuaW5jbHVkZXMoXCJDcm9wXCIpKSB7XG4gICAgICByZXR1cm4gZXhwb3N1cmVfdHJlZXBsb3QoKTtcbiAgICB9IGVsc2UgaWYgKGV4cG9zdXJlX2NhdCA9PT0gXCJQb3B1bGF0aW9uXCIpIHtcbiAgICAgIHJldHVybiBwb3B1bGF0aW9uX3N0YWNrYmFycygpO1xuICAgIH1cbiAgfSBlbHNlIGlmIChhdGxhc19jYXQgPT09IFwiSGF6YXJkXCIpIHtcbiAgICByZXR1cm4gaGF6YXJkX3N0YWNrQmFyKGhhemFyZF9zZWwpO1xuICB9IGVsc2UgaWYgKGF0bGFzX2NhdCA9PT0gXCJWdWxuZXJhYmlsaXR5XCIpIHtcbiAgICByZXR1cm4gcGFyYWxsZWxDb29yZGluYXRlc1NjYXR0ZXJQbG90KCk7XG4gIH1cbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTEwIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiY3JlYXRlVGFibGUgPSAoKSA9PiB7XG4gIGxldCB0YWJsZSA9IElucHV0cy50YWJsZShkYXRhX3RvX3Zpc3VhbGlzZSwge1xuICAgIHJvd3M6IDI1LFxuICAgIG1heFdpZHRoOiBcIjEwMDBweFwiLFxuICB9KTtcbiAgY29uc3Qgc3R5bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3R5bGVcIik7XG4gIHN0eWxlLmlubmVySFRNTCA9IGBcbiAgICAuZXhwbG9yZVRhYmxlIHRoIHtcbiAgICAgIGJhY2tncm91bmQtY29sb3I6IGxpZ2h0Z3JleSAhaW1wb3J0YW50O1xuICAgIH1cbiAgICAuZXhwbG9yZVRhYmxlIHRyOm50aC1jaGlsZChvZGQpIHtcbiAgICAgIGJhY2tncm91bmQ6ICNmMmYyZjIhaW1wb3J0YW50O1xuICAgIH1cbiAgICAuZXhwbG9yZVRhYmxlIHRkIHtcbiAgICAgIHBhZGRpbmctbGVmdDogMTVweCAhaW1wb3J0YW50O1xuICAgIH1cbiAgYDtcbiAgdGFibGUuY2xhc3NMaXN0LmFkZChcImV4cGxvcmVUYWJsZVwiKTtcbiAgdGFibGUuYXBwZW5kQ2hpbGQoc3R5bGUpO1xuXG4gIGNvbnN0IGNoZWNrYm94ZXMgPSB0YWJsZS5xdWVyeVNlbGVjdG9yQWxsKCd0YWJsZSBpbnB1dFt0eXBlPVwiY2hlY2tib3hcIl0nKTtcblxuICAvLyBSZW1vdmUgYWxsIGNoZWNrYm94ZXNcbiAgY2hlY2tib3hlcy5mb3JFYWNoKGZ1bmN0aW9uIChjaGVja2JveCkge1xuICAgIGNoZWNrYm94LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoY2hlY2tib3gpO1xuICB9KTtcblxuICByZXR1cm4gdGFibGU7XG59O1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xMTEiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJleHBvc3VyZV90cmVlcGxvdCA9IGFzeW5jICgpID0+IHtcbiAgbGV0IGFkbWluX3F1ZXJ5O1xuICBpZiAoY291bnRyeSA9PT0gXCJTU0FcIikge1xuICAgIGFkbWluX3F1ZXJ5ID0gYFwiYWRtaW4xX25hbWVcIiBJUyBOVUxMYDtcbiAgfSBlbHNlIGlmIChjb3VudHJ5ICE9PSBcIlNTQVwiICYmIGFkbWluMV9zZWwgPT09IFwiRnVsbCBDb3VudHJ5XCIpIHtcbiAgICBhZG1pbl9xdWVyeSA9IGBcImFkbWluMF9uYW1lXCIgTElLRSAnJHtjb3VudHJ5fScgQU5EIFwiYWRtaW4xX25hbWVcIiBJUyBOT1QgTlVMTCBBTkQgXCJhZG1pbjJfbmFtZVwiIElTIE5VTExgO1xuICB9IGVsc2UgaWYgKGNvdW50cnkgIT09IFwiU1NBXCIgJiYgYWRtaW4xX3NlbCAhPT0gXCJGdWxsIENvdW50cnlcIikge1xuICAgIGFkbWluX3F1ZXJ5ID0gYFwiYWRtaW4wX25hbWVcIiBMSUtFICcke2NvdW50cnl9JyBBTkQgXCJhZG1pbjFfbmFtZVwiIExJS0UgJyR7YWRtaW4xX3NlbH0nIEFORCBcImFkbWluMV9uYW1lXCIgSVMgTk9UIE5VTEwgQU5EIFwiYWRtaW4yX25hbWVcIiBJUyBOT1QgTlVMTGA7XG4gIH1cbiAgbGV0IGZvcm1hdFRyZWUgPSBleHBvc3VyZV92YXIgPT09IFwibnVtYmVyXCIgPyBmb3JtYXRCaWdOdW1zIDogZm9ybWF0RG9sbGFyO1xuXG4gIGxldCB0cmFuc2xhdGVDcm9wID0gKGQpID0+IHtcbiAgICByZXR1cm4gKFxuICAgICAgX2xhbmcobmJUZXh0LlZpZXdFeHBsb3JlLmV4cG9zdXJlVHJlZW1hcC5jcm9wR3JvdXBzW2RdKSB8fFxuICAgICAgX2xhbmcobmJUZXh0LmdlbmVyYWwuY29tbW9kaXRpZXNbZF0pIHx8XG4gICAgICBkXG4gICAgKTtcbiAgfTtcblxuICBjb25zdCBkYXRhX3VuZm9ybWF0dGVkID0gYXdhaXQgZGIucXVlcnkoYFxuU0VMRUNUIGNyb3AsIFNVTSh2YWx1ZSkgYXMgVk9QLCBGUk9NIEV4cG9zdXJlXG4ke3Bsb3RRdWVyeV9hZG1pbn1cbkFORCBcImV4cG9zdXJlXCIgPSAnJHtleHBvc3VyZV92YXJ9J1xuQU5EIFwiY3JvcFwiIE5PVCBJTiAoJ3RvdGFsX2hpZ2hsYW5kJywgJ3RvdGFsX3Ryb3BpY2FsJylcbmFuZCBcImdyb3VwXCIgPSAnJHtleHBvc3VyZV9jYXQudG9Mb2NhbGVMb3dlckNhc2UoKX0nXG5HUk9VUCBCWSBjcm9wYCk7XG5cbiAgZDMuc2VsZWN0QWxsKFwiLnBsb3RUb29sdGlwXCIpLnJlbW92ZSgpO1xuICBjb25zdCB0b29sdGlwID0gZDNcbiAgICAuc2VsZWN0KFwiYm9keVwiKVxuICAgIC5hcHBlbmQoXCJkaXZcIilcbiAgICAuYXR0cihcImNsYXNzXCIsIFwicGxvdFRvb2x0aXAgVHJlZVRpcFwiKVxuICAgIC5zdHlsZShcInBvc2l0aW9uXCIsIFwiYWJzb2x1dGVcIik7XG5cbiAgY29uc3QgZGF0YSA9IG5ldyBPYmplY3Qoe1xuICAgIG5hbWU6IFwidG90YWxcIixcbiAgICBjaGlsZHJlbjogT2JqZWN0LmVudHJpZXMoY3JvcF9ncm91cHMpLm1hcCgoW2dyb3VwTmFtZSwgY3JvcHNdKSA9PiAoe1xuICAgICAgbmFtZTogZ3JvdXBOYW1lLFxuICAgICAgY2hpbGRyZW46IGNyb3BzLm1hcCgoY3JvcE5hbWUpID0+IHtcbiAgICAgICAgY29uc3QgY3JvcERhdGEgPSBkYXRhX3VuZm9ybWF0dGVkLmZpbmQoKGQpID0+IGQuY3JvcCA9PT0gY3JvcE5hbWUpO1xuICAgICAgICByZXR1cm4geyBuYW1lOiBjcm9wTmFtZSwgdmFsdWU6IGNyb3BEYXRhID8gY3JvcERhdGEuVk9QIDogMCB9O1xuICAgICAgfSksXG4gICAgfSkpLFxuICB9KTtcblxuICBjb25zdCB3aWR0aCA9IDEwMDA7XG4gIGNvbnN0IGhlaWdodCA9IDYwMDtcblxuICAvLyBUaGlzIGN1c3RvbSB0aWxpbmcgZnVuY3Rpb24gYWRhcHRzIHRoZSBidWlsdC1pbiBiaW5hcnkgdGlsaW5nIGZ1bmN0aW9uXG4gIC8vIGZvciB0aGUgYXBwcm9wcmlhdGUgYXNwZWN0IHJhdGlvIHdoZW4gdGhlIHRyZWVtYXAgaXMgem9vbWVkLWluLlxuICBmdW5jdGlvbiB0aWxlKG5vZGUsIHgwLCB5MCwgeDEsIHkxKSB7XG4gICAgZDMudHJlZW1hcEJpbmFyeShub2RlLCAwLCAwLCB3aWR0aCwgaGVpZ2h0KTtcbiAgICBmb3IgKGNvbnN0IGNoaWxkIG9mIG5vZGUuY2hpbGRyZW4pIHtcbiAgICAgIGNoaWxkLngwID0geDAgKyAoY2hpbGQueDAgLyB3aWR0aCkgKiAoeDEgLSB4MCk7XG4gICAgICBjaGlsZC54MSA9IHgwICsgKGNoaWxkLngxIC8gd2lkdGgpICogKHgxIC0geDApO1xuICAgICAgY2hpbGQueTAgPSB5MCArIChjaGlsZC55MCAvIGhlaWdodCkgKiAoeTEgLSB5MCk7XG4gICAgICBjaGlsZC55MSA9IHkwICsgKGNoaWxkLnkxIC8gaGVpZ2h0KSAqICh5MSAtIHkwKTtcbiAgICB9XG4gIH1cblxuICAvLyBDb21wdXRlIHRoZSBsYXlvdXQuXG4gIGNvbnN0IGhpZXJhcmNoeSA9IGQzXG4gICAgLmhpZXJhcmNoeShkYXRhKVxuICAgIC5zdW0oKGQpID0+IGQudmFsdWUpXG4gICAgLnNvcnQoKGEsIGIpID0+IGIudmFsdWUgLSBhLnZhbHVlKTtcbiAgY29uc3Qgcm9vdCA9IGQzLnRyZWVtYXAoKS50aWxlKHRpbGUpKGhpZXJhcmNoeSk7XG5cbiAgY29uc3Qgc21hbGxlc3RfY3JvcCA9IGQzLm1pbihkYXRhX3VuZm9ybWF0dGVkLCAoZCkgPT4gZC5WT1ApO1xuICBjb25zdCBsYXJnZXN0X2dyb3VwID0gZDMubWF4KGhpZXJhcmNoeS5jaGlsZHJlbi5tYXAoKGQpID0+IGQudmFsdWUpKTtcblxuICBjb25zdCBjb2xvclNjYWxlID0gZDNcbiAgICAuc2NhbGVMaW5lYXIoKVxuICAgIC5kb21haW4oW3NtYWxsZXN0X2Nyb3AsIGxhcmdlc3RfZ3JvdXBdKVxuICAgIC5yYW5nZShbXCIjRjdENzMyXCIsIFwiIzcxOTEzRFwiXSk7XG5cbiAgLy8gQ3JlYXRlIHRoZSBzY2FsZXMuXG4gIGNvbnN0IHggPSBkMy5zY2FsZUxpbmVhcigpLnJhbmdlUm91bmQoWzAsIHdpZHRoXSk7XG4gIGNvbnN0IHkgPSBkMy5zY2FsZUxpbmVhcigpLnJhbmdlUm91bmQoWzAsIGhlaWdodF0pO1xuXG4gIC8vIEZvcm1hdHRpbmcgdXRpbGl0aWVzLlxuICBjb25zdCBmb3JtYXQgPSBkMy5mb3JtYXQoXCIsZFwiKTtcbiAgY29uc3QgbmFtZSA9IChkKSA9PiBkLmRhdGEubmFtZTtcblxuICAvLyBDcmVhdGUgdGhlIFNWRyBjb250YWluZXIuXG4gIGNvbnN0IHN2ZyA9IGQzXG4gICAgLy8gLnNlbGVjdChjb250YWluZXIpXG4gICAgLmNyZWF0ZShcInN2Z1wiKVxuICAgIC8vIC5hcHBlbmQoXCJzdmdcIilcbiAgICAuYXR0cihcInZpZXdCb3hcIiwgWzAuNSwgLTUwLjUsIHdpZHRoLCBoZWlnaHQgKyA1MF0pXG4gICAgLmF0dHIoXCJ3aWR0aFwiLCB3aWR0aClcbiAgICAuYXR0cihcImhlaWdodFwiLCBoZWlnaHQgKyA1MClcbiAgICAuYXR0cihcInN0eWxlXCIsIFwibWF4LXdpZHRoOiAxMDAlOyBoZWlnaHQ6IGF1dG87XCIpO1xuXG4gIC8vIERpc3BsYXkgdGhlIHJvb3QuXG4gIGxldCBncm91cCA9IHN2Zy5hcHBlbmQoXCJnXCIpLmNhbGwocmVuZGVyLCByb290KTtcblxuICBmdW5jdGlvbiByZW5kZXIoZ3JvdXAsIHJvb3QpIHtcbiAgICBjb25zdCBub2RlID0gZ3JvdXBcbiAgICAgIC5zZWxlY3RBbGwoXCJnXCIpXG4gICAgICAuZGF0YShyb290LmNoaWxkcmVuLmNvbmNhdChyb290KSlcbiAgICAgIC5qb2luKFwiZ1wiKTtcblxuICAgIG5vZGVcbiAgICAgIC5maWx0ZXIoKGQpID0+IChkID09PSByb290ID8gZC5wYXJlbnQgOiBkLmNoaWxkcmVuKSlcbiAgICAgIC5hdHRyKFwiY3Vyc29yXCIsIFwicG9pbnRlclwiKVxuICAgICAgLm9uKFwiY2xpY2tcIiwgKGV2ZW50LCBkKSA9PiAoZCA9PT0gcm9vdCA/IHpvb21vdXQocm9vdCkgOiB6b29taW4oZCkpKTtcblxuICAgIC8vIG5vZGUuYXBwZW5kKFwidGl0bGVcIikudGV4dCgoZCkgPT4gYCR7bmFtZShkKX1cXG4ke2Zvcm1hdFRyZWUoZC52YWx1ZSl9YCk7XG4gICAgbm9kZVxuICAgICAgLm9uKFwibW91c2Vtb3ZlXCIsIChldmVudCwgZCkgPT4ge1xuICAgICAgICBsZXQgdGlwRGF0YSA9IGQuZGF0YTtcbiAgICAgICAgdG9vbHRpcFxuICAgICAgICAgIC5zdHlsZShcInRvcFwiLCBldmVudC5wYWdlWSAtIDEwICsgXCJweFwiKVxuICAgICAgICAgIC5zdHlsZShcImxlZnRcIiwgZXZlbnQucGFnZVggKyAxMCArIFwicHhcIilcbiAgICAgICAgICAvLyAudHJhbnNpdGlvbigpXG4gICAgICAgICAgLy8gLmR1cmF0aW9uKDIwMClcbiAgICAgICAgICAuc3R5bGUoXCJvcGFjaXR5XCIsIDEpXG4gICAgICAgICAgLnN0eWxlKFwiZGlzcGxheVwiLCBcImJsb2NrXCIpXG4gICAgICAgICAgLmh0bWwoYCR7dHJhbnNsYXRlQ3JvcChuYW1lKGQpKX0gLSAke2Zvcm1hdFRyZWUoZC52YWx1ZSl9YCk7XG4gICAgICB9KVxuICAgICAgLm9uKFwibW91c2VvdXRcIiwgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIGQzLnNlbGVjdChcIi5wbG90VG9vbHRpcFwiKVxuICAgICAgICAgIC8vIC50cmFuc2l0aW9uKClcbiAgICAgICAgICAvLyAuZHVyYXRpb24oMjAwKVxuICAgICAgICAgIC8vIC5zdHlsZShcIm9wYWNpdHlcIiwgMClcbiAgICAgICAgICAuc3R5bGUoXCJkaXNwbGF5XCIsIFwibm9uZVwiKTtcbiAgICAgIH0pO1xuXG4gICAgY29uc3QgcmVjdHMgPSBub2RlXG4gICAgICAuYXBwZW5kKFwicmVjdFwiKVxuICAgICAgLmF0dHIoXCJpZFwiLCAoZCkgPT4gKGQubGVhZlVpZCA9IERPTS51aWQoXCJsZWFmXCIpKS5pZClcbiAgICAgIC5hdHRyKFwiZmlsbFwiLCAoZCkgPT5cbiAgICAgICAgZCA9PT0gcm9vdFxuICAgICAgICAgID8gXCIjZTZlNmU2XCJcbiAgICAgICAgICA6IGQuY2hpbGRyZW5cbiAgICAgICAgICAgID8gY29sb3JTY2FsZShkLnZhbHVlKVxuICAgICAgICAgICAgOiBjb2xvclNjYWxlKGQudmFsdWUpLFxuICAgICAgKVxuICAgICAgLmF0dHIoXCJzdHJva2VcIiwgXCIjZTZlNmU2XCIpO1xuXG4gICAgbm9kZVxuICAgICAgLmFwcGVuZChcImNsaXBQYXRoXCIpXG4gICAgICAuYXR0cihcImlkXCIsIChkKSA9PiAoZC5jbGlwVWlkID0gRE9NLnVpZChcImNsaXBcIikpLmlkKVxuICAgICAgLmFwcGVuZChcInVzZVwiKVxuICAgICAgLmF0dHIoXCJ4bGluazpocmVmXCIsIChkKSA9PiBkLmxlYWZVaWQuaHJlZik7XG5cbiAgICBsZXQgdGV4dCA9IG5vZGVcbiAgICAgIC5hcHBlbmQoXCJ0ZXh0XCIpXG4gICAgICAuYXR0cihcImNsaXAtcGF0aFwiLCAoZCkgPT4gZC5jbGlwVWlkKVxuICAgICAgLy8gLmF0dHIoXCJmb250LXdlaWdodFwiLCAoZCkgPT4gKGQgPT09IHJvb3QgPyBcImJvbGRcIiA6IG51bGwpKVxuICAgICAgLmF0dHIoXCJmb250LXNpemVcIiwgKGQpID0+XG4gICAgICAgIGQgPT09IHJvb3QgPyBcIjIwcHhcIiA6IGQuY2hpbGRyZW4gPyBcIjE1cHhcIiA6IFwiMTRweFwiLFxuICAgICAgKVxuICAgICAgLnNlbGVjdEFsbChcInRzcGFuXCIpXG4gICAgICAuZGF0YSgoZCkgPT5cbiAgICAgICAgKGQgPT09IHJvb3RcbiAgICAgICAgICA/IChcbiAgICAgICAgICAgICAgdHJhbnNsYXRlQ3JvcChuYW1lKGQpKSArXG4gICAgICAgICAgICAgIFwiIFwiICtcbiAgICAgICAgICAgICAgX2xhbmcoXG4gICAgICAgICAgICAgICAgbmJUZXh0LlZpZXdFeHBsb3JlLnNlbGVjdG9ycy52aXN1YWxpc2VWYXJzLmV4cG9zdXJlXG4gICAgICAgICAgICAgICAgICAuZXhwb3N1cmVWYXJpYWJsZS5vcHRpb25zW2V4cG9zdXJlX3Zhcl0sXG4gICAgICAgICAgICAgICkgK1xuICAgICAgICAgICAgICBcIjpcIlxuICAgICAgICAgICAgKS5zcGxpdCgvKD89W0EtWl1bJl1bXkEtWl0pL2cpXG4gICAgICAgICAgOiAvLyA6IGQuZGF0YS5uYW1lLnNwbGl0KC8oPz1bQS1aXVteQS1aXSkvZylcbiAgICAgICAgICAgIHRyYW5zbGF0ZUNyb3AobmFtZShkKSkuc3BsaXQoLyg/PVtBLVpdW15BLVpdKS9nKVxuICAgICAgICApIC8vLmNvbmNhdChkLnZhbHVlKVxuICAgICAgICAgIC5jb25jYXQoZm9ybWF0VHJlZShkLnZhbHVlKSksXG4gICAgICApXG4gICAgICAuam9pbihcInRzcGFuXCIpXG4gICAgICAuYXR0cihcInhcIiwgMylcbiAgICAgIC5hdHRyKFxuICAgICAgICBcInlcIixcbiAgICAgICAgKGQsIGksIG5vZGVzKSA9PiBgJHsoaSA9PT0gbm9kZXMubGVuZ3RoIC0gMSkgKiAwLjMgKyAxLjEgKyBpICogMC45fWVtYCxcbiAgICAgIClcbiAgICAgIC5hdHRyKFwiZmlsbC1vcGFjaXR5XCIsIChkLCBpLCBub2RlcykgPT5cbiAgICAgICAgaSA9PT0gbm9kZXMubGVuZ3RoIC0gMSA/IDAuNyA6IG51bGwsXG4gICAgICApXG4gICAgICAuYXR0cihcImZvbnQtd2VpZ2h0XCIsIChkLCBpLCBub2RlcykgPT5cbiAgICAgICAgaSA9PT0gbm9kZXMubGVuZ3RoIC0gMSA/IFwibm9ybWFsXCIgOiBudWxsLFxuICAgICAgKVxuICAgICAgLnRleHQoKGQpID0+IGQpO1xuXG4gICAgZ3JvdXAuY2FsbChwb3NpdGlvbiwgcm9vdCk7XG4gIH1cblxuICBmdW5jdGlvbiBwb3NpdGlvbihncm91cCwgcm9vdCkge1xuICAgIGdyb3VwXG4gICAgICAuc2VsZWN0QWxsKFwiZ1wiKVxuICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgKGQpID0+XG4gICAgICAgIGQgPT09IHJvb3QgPyBgdHJhbnNsYXRlKDAsLTU1KWAgOiBgdHJhbnNsYXRlKCR7eChkLngwKX0sJHt5KGQueTApfSlgLFxuICAgICAgKVxuICAgICAgLnNlbGVjdEFsbChcInJlY3RcIilcbiAgICAgIC5hdHRyKFwid2lkdGhcIiwgKGQpID0+IChkID09PSByb290ID8gd2lkdGggOiB4KGQueDEpIC0geChkLngwKSkpXG4gICAgICAuYXR0cihcImhlaWdodFwiLCAoZCkgPT4gKGQgPT09IHJvb3QgPyA1NSA6IHkoZC55MSkgLSB5KGQueTApKSk7XG5cbiAgICBncm91cC5zZWxlY3RBbGwoXCJ0ZXh0XCIpLmF0dHIoXCJvcGFjaXR5XCIsIChkKSA9PiB7XG4gICAgICBjb25zdCByZWN0X3dpZHRoID0geChkLngxKSAtIHgoZC54MCk7XG4gICAgICBjb25zdCByZWN0X2hlaWdodCA9IHkoZC55MSkgLSB5KGQueTApO1xuICAgICAgcmV0dXJuIHJlY3RfaGVpZ2h0IDwgNzAgfHwgcmVjdF93aWR0aCA8IDcwID8gMCA6IDE7XG4gICAgfSk7XG4gIH1cblxuICAvLyBXaGVuIHpvb21pbmcgaW4sIGRyYXcgdGhlIG5ldyBub2RlcyBvbiB0b3AsIGFuZCBmYWRlIHRoZW0gaW4uXG4gIGZ1bmN0aW9uIHpvb21pbihkKSB7XG4gICAgY29uc3QgZ3JvdXAwID0gZ3JvdXAuYXR0cihcInBvaW50ZXItZXZlbnRzXCIsIFwibm9uZVwiKTtcbiAgICBjb25zdCBncm91cDEgPSAoZ3JvdXAgPSBzdmcuYXBwZW5kKFwiZ1wiKS5jYWxsKHJlbmRlciwgZCkpO1xuXG4gICAgeC5kb21haW4oW2QueDAsIGQueDFdKTtcbiAgICB5LmRvbWFpbihbZC55MCwgZC55MV0pO1xuXG4gICAgc3ZnXG4gICAgICAudHJhbnNpdGlvbigpXG4gICAgICAuZHVyYXRpb24oNzUwKVxuICAgICAgLmNhbGwoKHQpID0+IGdyb3VwMC50cmFuc2l0aW9uKHQpLnJlbW92ZSgpLmNhbGwocG9zaXRpb24sIGQucGFyZW50KSlcbiAgICAgIC5jYWxsKCh0KSA9PlxuICAgICAgICBncm91cDFcbiAgICAgICAgICAudHJhbnNpdGlvbih0KVxuICAgICAgICAgIC5hdHRyVHdlZW4oXCJvcGFjaXR5XCIsICgpID0+IGQzLmludGVycG9sYXRlKDAsIDEpKVxuICAgICAgICAgIC5jYWxsKHBvc2l0aW9uLCBkKSxcbiAgICAgICk7XG4gIH1cblxuICAvLyBXaGVuIHpvb21pbmcgb3V0LCBkcmF3IHRoZSBvbGQgbm9kZXMgb24gdG9wLCBhbmQgZmFkZSB0aGVtIG91dC5cbiAgZnVuY3Rpb24gem9vbW91dChkKSB7XG4gICAgY29uc3QgZ3JvdXAwID0gZ3JvdXAuYXR0cihcInBvaW50ZXItZXZlbnRzXCIsIFwibm9uZVwiKTtcbiAgICBjb25zdCBncm91cDEgPSAoZ3JvdXAgPSBzdmcuaW5zZXJ0KFwiZ1wiLCBcIipcIikuY2FsbChyZW5kZXIsIGQucGFyZW50KSk7XG5cbiAgICB4LmRvbWFpbihbZC5wYXJlbnQueDAsIGQucGFyZW50LngxXSk7XG4gICAgeS5kb21haW4oW2QucGFyZW50LnkwLCBkLnBhcmVudC55MV0pO1xuXG4gICAgc3ZnXG4gICAgICAudHJhbnNpdGlvbigpXG4gICAgICAuZHVyYXRpb24oNzUwKVxuICAgICAgLmNhbGwoKHQpID0+XG4gICAgICAgIGdyb3VwMFxuICAgICAgICAgIC50cmFuc2l0aW9uKHQpXG4gICAgICAgICAgLnJlbW92ZSgpXG4gICAgICAgICAgLmF0dHJUd2VlbihcIm9wYWNpdHlcIiwgKCkgPT4gZDMuaW50ZXJwb2xhdGUoMSwgMCkpXG4gICAgICAgICAgLmNhbGwocG9zaXRpb24sIGQpLFxuICAgICAgKVxuICAgICAgLmNhbGwoKHQpID0+IGdyb3VwMS50cmFuc2l0aW9uKHQpLmNhbGwocG9zaXRpb24sIGQucGFyZW50KSk7XG4gIH1cblxuICByZXR1cm4gc3ZnLm5vZGUoKTtcbn07XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTExMiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImhhemFyZF9zdGFja0JhciA9IGFzeW5jIChoYXphcmQpID0+IHtcbiAgLy8gY29uc3QgZGF0YSA9IGJhcl9kYXRhW2hhemFyZF07XG4gIGNvbnN0IGRhdGEgPSBjbGFzc2lmeUFuZENvdW50KFxuICAgIGF3YWl0IGRiLnF1ZXJ5KFxuICAgICAgYFNFTEVDVCAqIEZyb20gSGF6YXJkICR7bWFwRGF0YVF1ZXJ5X2FkbWlufSBhbmQgXCJoYXphcmRcIiA9ICcke2hhemFyZH0nIGFuZCBcInRpbWVmcmFtZVwiIGluICgnJHtEYXRhU2VsZWN0b3JfZm9ybS5oYXphcmRHcm91cF9mb3JtLnRpbWVwZXJpb2Rfc2VsLmpvaW4oXG4gICAgICAgIFwiJywgJ1wiLFxuICAgICAgKX0nKWAsXG4gICAgKSxcbiAgKVtoYXphcmRdO1xuICBjb25zdCBjb2xvcnMgPSBoYXphcmRfZGljdFtoYXphcmRdLmNvbG91cnM7XG5cbiAgY29uc3QgbGFiZWxzID0gW1wibG93XCIsIFwibW9kZXJhdGVcIiwgXCJzZXZlcmVcIiwgXCJleHRyZW1lXCIsIFwiVmV4dHJlbWVcIl0uc2xpY2UoXG4gICAgMCxcbiAgICBjb2xvcnMubGVuZ3RoLFxuICApO1xuXG4gIGNvbnN0IHRyYW5zZm9ybWVkRGF0YSA9IFtdO1xuICBmb3IgKGNvbnN0IHNjZW5hcmlvIGluIGRhdGEpIHtcbiAgICBmb3IgKGNvbnN0IHBlcmlvZCBpbiBkYXRhW3NjZW5hcmlvXSkge1xuICAgICAgdHJhbnNmb3JtZWREYXRhLnB1c2goe1xuICAgICAgICBzY2VuYXJpbyxcbiAgICAgICAgcGVyaW9kLFxuICAgICAgICB2YWx1ZXM6IGRhdGFbc2NlbmFyaW9dW3BlcmlvZF0sXG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBjb25zdCB3aWR0aCA9IDc1MDtcbiAgY29uc3QgaGVpZ2h0ID0gNjAwO1xuICBjb25zdCBtYXJnaW4gPSB7IHRvcDogMzAsIHJpZ2h0OiAxMCwgYm90dG9tOiAxNSwgbGVmdDogNDAgfTtcblxuICAvLyBTVkcgQ29udGFpbmVyXG4gIGNvbnN0IHN2ZyA9IGQzXG4gICAgLmNyZWF0ZShcInN2Z1wiKVxuICAgIC5hdHRyKFwidmlld0JveFwiLCBbMCwgMCwgd2lkdGgsIGhlaWdodF0pXG4gICAgLmF0dHIoXCJ3aWR0aFwiLCB3aWR0aClcbiAgICAuYXR0cihcImhlaWdodFwiLCBoZWlnaHQpO1xuXG4gIGQzLnNlbGVjdEFsbChcIi5wbG90VG9vbHRpcFwiKS5yZW1vdmUoKTtcbiAgY29uc3QgdG9vbHRpcCA9IGQzXG4gICAgLnNlbGVjdChcImJvZHlcIilcbiAgICAuYXBwZW5kKFwiZGl2XCIpXG4gICAgLmF0dHIoXCJjbGFzc1wiLCBcInBsb3RUb29sdGlwIGJhclRpcFwiKVxuICAgIC5zdHlsZShcInBvc2l0aW9uXCIsIFwiYWJzb2x1dGVcIik7XG5cbiAgLy8gU2V0IHVwIHggYW5kIHkgc2NhbGVzXG4gIGNvbnN0IHNvcnRPcmRlciA9IFtcbiAgICBcImhpc3RvcmljX2hpc3RvcmljXCIsXG4gICAgXCJzc3AyNDVfMjAyMV8yMDQwXCIsXG4gICAgXCJzc3A1ODVfMjAyMV8yMDQwXCIsXG4gICAgXCJzc3AyNDVfMjA0MV8yMDYwXCIsXG4gICAgXCJzc3A1ODVfMjA0MV8yMDYwXCIsXG4gIF07XG4gIGNvbnN0IHggPSBkM1xuICAgIC5zY2FsZUJhbmQoKVxuICAgIC8vIC5kb21haW4odHJhbnNmb3JtZWREYXRhLm1hcCgoZCkgPT4gYCR7ZC5zY2VuYXJpb31fJHtkLnBlcmlvZH1gKSlcbiAgICAuZG9tYWluKFxuICAgICAgc29ydE9yZGVyLmZpbHRlcigoZCkgPT5cbiAgICAgICAgdHJhbnNmb3JtZWREYXRhLnNvbWUoKGUpID0+IGUuc2NlbmFyaW8gKyBcIl9cIiArIGUucGVyaW9kID09PSBkKSxcbiAgICAgICksXG4gICAgKVxuICAgIC5yYW5nZShbbWFyZ2luLmxlZnQsIHdpZHRoXSlcbiAgICAucGFkZGluZygwLjEpO1xuXG4gIGNvbnN0IHkgPSBkM1xuICAgIC5zY2FsZUxpbmVhcigpXG4gICAgLmRvbWFpbihbMCwgZDMubWF4KHRyYW5zZm9ybWVkRGF0YSwgKGQpID0+IGQzLnN1bShkLnZhbHVlcykpXSlcbiAgICAubmljZSgpXG4gICAgLnJhbmdlKFtoZWlnaHQgLSBtYXJnaW4uYm90dG9tLCBtYXJnaW4udG9wXSk7XG5cbiAgLy8gQWRkIHggYW5kIHkgYXhlc1xuICBzdmdcbiAgICAuYXBwZW5kKFwiZ1wiKVxuICAgIC5hdHRyKFwiY2xhc3NcIiwgXCJ4LWF4aXNcIilcbiAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBgdHJhbnNsYXRlKDAsJHtoZWlnaHQgLSBtYXJnaW4uYm90dG9tfSlgKVxuICAgIC5jYWxsKFxuICAgICAgZDNcbiAgICAgICAgLmF4aXNCb3R0b20oeClcbiAgICAgICAgLnRpY2tTaXplKDApXG4gICAgICAgIC50aWNrRm9ybWF0KChkKSA9PiB7XG4gICAgICAgICAgcmV0dXJuIGQgPT09IFwiaGlzdG9yaWNfaGlzdG9yaWNcIlxuICAgICAgICAgICAgPyBfbGFuZyhcbiAgICAgICAgICAgICAgICBuYlRleHQuc2VsZWN0VmFycy5mb3Jtcy5IYXphcmQuc2VsZWN0b3JzLnBlcmlvZC5vcHRpb25zXG4gICAgICAgICAgICAgICAgICAuaGlzdG9yaWMsXG4gICAgICAgICAgICAgIClcbiAgICAgICAgICAgIDogYCR7ZC5zcGxpdChcIl9cIilbMl19ICgke2Quc3BsaXQoXCJfXCIpWzBdLnRvVXBwZXJDYXNlKCl9KWA7XG4gICAgICAgIH0pLFxuICAgICk7XG5cbiAgc3ZnXG4gICAgLmFwcGVuZChcImdcIilcbiAgICAuYXR0cihcImNsYXNzXCIsIFwieS1heGlzXCIpXG4gICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgYHRyYW5zbGF0ZSgke21hcmdpbi5sZWZ0fSwwKWApXG4gICAgLmNhbGwoZDMuYXhpc0xlZnQoeSkudGlja1NpemUoMCkpXG4gICAgLnNlbGVjdEFsbChcIi50aWNrIHRleHRcIikgLy8gc2VsZWN0IHRoZSB0ZXh0IGVsZW1lbnRzIG9mIHRoZSB0aWNrc1xuICAgIC5hdHRyKFwiZHlcIiwgXCIwLjVlbVwiKVxuICAgIC5zdHlsZShcInRleHQtYW5jaG9yXCIsIFwiZW5kXCIpO1xuXG4gIC8vIENyZWF0ZSBzdGFja3NcbiAgY29uc3Qgc3RhY2sgPSBkM1xuICAgIC5zdGFjaygpXG4gICAgLmtleXMoZDMucmFuZ2UodHJhbnNmb3JtZWREYXRhWzBdLnZhbHVlcy5sZW5ndGgpKVxuICAgIC52YWx1ZSgoZCwga2V5KSA9PiBkLnZhbHVlc1trZXldKTtcblxuICBjb25zdCBzZXJpZXMgPSBzdGFjayh0cmFuc2Zvcm1lZERhdGEpO1xuXG4gIC8vIEFkZCBiYXJzXG4gIGNvbnN0IGJhcnMgPSBzdmdcbiAgICAuYXBwZW5kKFwiZ1wiKVxuICAgIC5zZWxlY3RBbGwoXCJnXCIpXG4gICAgLmRhdGEoc2VyaWVzKVxuICAgIC5qb2luKFwiZ1wiKVxuICAgIC5hdHRyKFwiZmlsbFwiLCAoZCwgaSkgPT4gY29sb3JzW2ldKVxuICAgIC5zZWxlY3RBbGwoXCJyZWN0XCIpXG4gICAgLy8gLmRhdGEoKGQpID0+IGQpXG4gICAgLmRhdGEoKGQpID0+IGQubWFwKCh2YWx1ZSkgPT4gKHsgLi4udmFsdWUsIGluZGV4OiBkLmluZGV4IH0pKSlcbiAgICAuam9pbihcInJlY3RcIilcbiAgICAuYXR0cihcInhcIiwgKGQpID0+IHgoYCR7ZC5kYXRhLnNjZW5hcmlvfV8ke2QuZGF0YS5wZXJpb2R9YCkpXG4gICAgLmF0dHIoXCJ5XCIsIChkKSA9PiB5KGRbMV0pKVxuICAgIC5hdHRyKFwiaGVpZ2h0XCIsIChkKSA9PiB5KGRbMF0pIC0geShkWzFdKSlcbiAgICAuYXR0cihcIndpZHRoXCIsIHguYmFuZHdpZHRoKCkpO1xuXG4gIGJhcnNcbiAgICAub24oXCJtb3VzZW92ZXJcIiwgKGV2ZW50LCBkKSA9PiB7XG4gICAgICBkMy5zZWxlY3QoZXZlbnQuY3VycmVudFRhcmdldCkuc3R5bGUoXCJzdHJva2VcIiwgXCJibGFja1wiKS5yYWlzZSgpO1xuICAgIH0pXG4gICAgLm9uKFwibW91c2Vtb3ZlXCIsIChldmVudCwgZCkgPT4ge1xuICAgICAgdG9vbHRpcFxuICAgICAgICAuc3R5bGUoXCJ0b3BcIiwgZXZlbnQucGFnZVkgLSAxMCArIFwicHhcIilcbiAgICAgICAgLnN0eWxlKFwibGVmdFwiLCBldmVudC5wYWdlWCArIDEwICsgXCJweFwiKVxuICAgICAgICAuc3R5bGUoXCJvcGFjaXR5XCIsIDEpXG4gICAgICAgIC5zdHlsZShcImRpc3BsYXlcIiwgXCJibG9ja1wiKVxuICAgICAgICAuaHRtbChcbiAgICAgICAgICBgPGI+JHtfbGFuZyhuYlRleHQuZ2VuZXJhbC5oYXphcmRzW2hhemFyZF0pfTwvYj4gPGJyPiAke19sYW5nKG5iVGV4dC5WaWV3RXhwbG9yZS5oYXphcmRCYXJzLmx2bCl9OiAke19sYW5nKFxuICAgICAgICAgICAgbmJUZXh0LmdlbmVyYWwubGV2ZWxzW2xhYmVsc1tkLmluZGV4XV0sXG4gICAgICAgICAgKX0gPGJyPiAke19sYW5nKG5iVGV4dC5WaWV3RXhwbG9yZS5oYXphcmRCYXJzLm51bUFyZWFzKX06ICR7ZC5kYXRhLnZhbHVlc1tkLmluZGV4XX1gLFxuICAgICAgICApO1xuICAgIH0pXG4gICAgLm9uKFwibW91c2VvdXRcIiwgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICBkMy5zZWxlY3QoXCIucGxvdFRvb2x0aXBcIikuc3R5bGUoXCJkaXNwbGF5XCIsIFwibm9uZVwiKTtcbiAgICAgIGQzLnNlbGVjdChldmVudC5jdXJyZW50VGFyZ2V0KS5zdHlsZShcInN0cm9rZVwiLCBcIm5vbmVcIik7XG4gICAgfSk7XG4gIC8vIEFkZCB5IGF4aXMgdGl0bGVcbiAgc3ZnXG4gICAgLmFwcGVuZChcInRleHRcIilcbiAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBcInJvdGF0ZSgtOTApXCIpXG4gICAgLmF0dHIoXCJ5XCIsIDApXG4gICAgLmF0dHIoXCJ4XCIsIDAgLSBoZWlnaHQgLyAyKVxuICAgIC5hdHRyKFwiZHlcIiwgXCIxZW1cIilcbiAgICAuc3R5bGUoXCJmb250U2l6ZVwiLCBcIjEycHhcIilcbiAgICAuc3R5bGUoXCJ0ZXh0LWFuY2hvclwiLCBcIm1pZGRsZVwiKVxuICAgIC50ZXh0KF9sYW5nKG5iVGV4dC5WaWV3RXhwbG9yZS5oYXphcmRCYXJzLnlheGlzKSk7XG5cbiAgLy8gYXBwZW5kIGxlZ2VuZFxuICBjb25zdCBMZWdlbmRwYWRkaW5nID0gNjU7XG4gIGNvbnN0IGxlZ2VuZFdpZHRoID0gMjAwO1xuICBjb25zdCBiYW5kV2lkdGggPSBsZWdlbmRXaWR0aCAvIChoYXphcmRfZGljdFtoYXphcmRdLnRocmVzaG9sZHMubGVuZ3RoIC0gMSk7XG4gIGNvbnN0IGxlZ2VuZCA9IHN2Z1xuICAgIC5hcHBlbmQoXCJnXCIpXG4gICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgYHRyYW5zbGF0ZSgke21hcmdpbi5sZWZ0ICsgMTF9LCAke21hcmdpbi50b3AgLSA1fSlgKTtcblxuICBjb2xvcnMuZm9yRWFjaCgodGhyZXNob2xkLCBpbmRleCkgPT4ge1xuICAgIGxlZ2VuZFxuICAgICAgLmFwcGVuZChcInJlY3RcIilcbiAgICAgIC5hdHRyKFwieFwiLCBpbmRleCAqIGJhbmRXaWR0aClcbiAgICAgIC5hdHRyKFwieVwiLCAtMTApXG4gICAgICAuYXR0cihcIndpZHRoXCIsIGJhbmRXaWR0aClcbiAgICAgIC5hdHRyKFwiaGVpZ2h0XCIsIDEwKVxuICAgICAgLnN0eWxlKFwiZmlsbFwiLCBjb2xvcnNbaW5kZXhdKTtcbiAgICAvLyBBZGQgbGFiZWxcbiAgICBsZWdlbmRcbiAgICAgIC5hcHBlbmQoXCJ0ZXh0XCIpXG4gICAgICAuYXR0cihcInhcIiwgaW5kZXggKiBiYW5kV2lkdGggKyBiYW5kV2lkdGggLyAyKVxuICAgICAgLmF0dHIoXCJ5XCIsIC0xNSkgLy8gQWRqdXN0IHRoaXMgdmFsdWUgYXMgbmVlZGVkIGZvciBsYWJlbCBwb3NpdGlvbmluZ1xuICAgICAgLnN0eWxlKFwidGV4dC1hbmNob3JcIiwgXCJtaWRkbGVcIilcbiAgICAgIC50ZXh0KF9sYW5nKG5iVGV4dC5nZW5lcmFsLmxldmVsc1tsYWJlbHNbaW5kZXhdXSkpXG4gICAgICAuYXR0cihcImZvbnQtc2l6ZVwiLCBcIjEycHhcIilcbiAgICAgIC5hdHRyKFwiZmlsbFwiLCBcImJsYWNrXCIpOyAvLyBTZXQgdGhlIGNvbG9yIG9mIHRoZSBsYWJlbCB0ZXh0XG4gIH0pO1xuXG4gIHJldHVybiBzdmcubm9kZSgpO1xufTtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTEzIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiZnVuY3Rpb24gY2xhc3NpZnlBbmRDb3VudChkYXRhKSB7XG4gIGNvbnN0IHJlc3VsdCA9IHt9O1xuXG4gIC8vIEhlbHBlciBmdW5jdGlvbiB0byBjbGFzc2lmeSBhIG51bWJlciBiYXNlZCBvbiB0aHJlc2hvbGRzXG4gIGZ1bmN0aW9uIGNsYXNzaWZ5TnVtYmVyKG51bWJlciwgdGhyZXNob2xkcykge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhyZXNob2xkcy5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKG51bWJlciA8IHRocmVzaG9sZHNbaV0pIHtcbiAgICAgICAgcmV0dXJuIGk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0aHJlc2hvbGRzLmxlbmd0aDtcbiAgfVxuXG4gIGRhdGEuZm9yRWFjaCgocm93KSA9PiB7XG4gICAgY29uc3QgeyBhZG1pbjBfbmFtZSwgc2NlbmFyaW8sIHRpbWVmcmFtZSwgaGF6YXJkLCB2YWx1ZSB9ID0gcm93O1xuICAgIGNvbnN0IHRocmVzaG9sZHMgPSBoYXphcmRfZGljdFtoYXphcmRdLnRocmVzaG9sZHM7XG4gICAgaWYgKCF0aHJlc2hvbGRzKSB7XG4gICAgICBjb25zb2xlLmVycm9yKGBObyB0aHJlc2hvbGRzIGZvdW5kIGZvciBoYXphcmQ6ICR7aGF6YXJkfWApO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBjbGFzc2lmaWNhdGlvbiA9IGNsYXNzaWZ5TnVtYmVyKHZhbHVlLCB0aHJlc2hvbGRzKTtcblxuICAgIGlmICghcmVzdWx0W2hhemFyZF0pIHtcbiAgICAgIHJlc3VsdFtoYXphcmRdID0ge307XG4gICAgfVxuICAgIGlmICghcmVzdWx0W2hhemFyZF1bc2NlbmFyaW9dKSB7XG4gICAgICByZXN1bHRbaGF6YXJkXVtzY2VuYXJpb10gPSB7fTtcbiAgICB9XG4gICAgaWYgKCFyZXN1bHRbaGF6YXJkXVtzY2VuYXJpb11bdGltZWZyYW1lXSkge1xuICAgICAgcmVzdWx0W2hhemFyZF1bc2NlbmFyaW9dW3RpbWVmcmFtZV0gPSBBcnJheSh0aHJlc2hvbGRzLmxlbmd0aCArIDEpLmZpbGwoXG4gICAgICAgIDAsXG4gICAgICApO1xuICAgIH1cblxuICAgIHJlc3VsdFtoYXphcmRdW3NjZW5hcmlvXVt0aW1lZnJhbWVdW2NsYXNzaWZpY2F0aW9uXSsrO1xuICB9KTtcblxuICByZXR1cm4gcmVzdWx0O1xufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xMTQiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJwb3B1bGF0aW9uX3N0YWNrYmFycyA9IGFzeW5jICgpID0+IHtcbiAgY29uc3Qgd2lkdGggPSA3NTA7XG4gIGNvbnN0IGhlaWdodCA9IDU2MDtcbiAgY29uc3QgbWFyZ2luID0geyB0b3A6IDAsIHJpZ2h0OiAxMCwgYm90dG9tOiAwLCBsZWZ0OiAxMjAgfTtcbiAgY29uc3QgYmFySGVpZ2h0ID0gMzA7IC8vIEhlaWdodCBvZiBlYWNoIGJhclxuICAvLyBDYWxjdWxhdGUgdGhlIHRvdGFsIGhlaWdodCBuZWVkZWQgZm9yIGFsbCBiYXJzXG5cbiAgY29uc3QgZGF0YSA9IGF3YWl0IGRiLnF1ZXJ5KGBcbiAgICBTRUxFQ1QgYWRtaW4wX25hbWUsIGFkbWluMV9uYW1lLCBhZG1pbjJfbmFtZSwgcnVyYWxfcG9wLCB1cmJhbl9wb3AsIHRvdGFsX3BvcCBcbiAgICBGUk9NIGV4cG9zdXJlUG9wdWxhdGlvbiBcbiAgICAke3Bsb3RRdWVyeV9hZG1pbn1gKTtcblxuICBkYXRhLnNvcnQoKGEsIGIpID0+IGIudG90YWxfcG9wIC0gYS50b3RhbF9wb3ApO1xuXG4gIGNvbnN0IHRvdGFsSGVpZ2h0ID0gZGF0YS5sZW5ndGggKiBiYXJIZWlnaHQ7XG4gIC8vIFNWRyBDb250YWluZXJcbiAgY29uc3Qgc3ZnID0gZDNcbiAgICAuY3JlYXRlKFwic3ZnXCIpXG4gICAgLmF0dHIoXCJ2aWV3Qm94XCIsIFswLCAwLCB3aWR0aCArIG1hcmdpbi5sZWZ0ICsgbWFyZ2luLnJpZ2h0LCB0b3RhbEhlaWdodF0pXG4gICAgLmF0dHIoXCJ3aWR0aFwiLCB3aWR0aCArIG1hcmdpbi5sZWZ0ICsgbWFyZ2luLnJpZ2h0KVxuICAgIC5hdHRyKFwiaGVpZ2h0XCIsIHRvdGFsSGVpZ2h0ICsgbWFyZ2luLnRvcCArIG1hcmdpbi5ib3R0b20pO1xuXG4gIGQzLnNlbGVjdEFsbChcIi5wbG90VG9vbHRpcFwiKS5yZW1vdmUoKTtcbiAgY29uc3QgdG9vbHRpcCA9IGQzXG4gICAgLnNlbGVjdChcImJvZHlcIilcbiAgICAuYXBwZW5kKFwiZGl2XCIpXG4gICAgLmF0dHIoXCJjbGFzc1wiLCBcInBsb3RUb29sdGlwIGJhclRpcFwiKVxuICAgIC5zdHlsZShcInBvc2l0aW9uXCIsIFwiYWJzb2x1dGVcIik7XG4gIGNvbnN0IGtleXMgPSBbXCJydXJhbF9wb3BcIiwgXCJ1cmJhbl9wb3BcIl07XG4gIGNvbnN0IHN0YWNrZWREYXRhID0gZDNcbiAgICAuc3RhY2soKVxuICAgIC5rZXlzKGtleXMpXG4gICAgLnZhbHVlKChkLCBrZXkpID0+IGRba2V5XSkoZGF0YSk7XG5cbiAgLy8gU2V0IHVwIHNjYWxlc1xuICBjb25zdCB4ID0gZDNcbiAgICAuc2NhbGVMaW5lYXIoKVxuICAgIC5kb21haW4oWzAsIGQzLm1heChkYXRhLCAoZCkgPT4gZC50b3RhbF9wb3ApXSlcbiAgICAubmljZSgpXG4gICAgLnJhbmdlKFttYXJnaW4ubGVmdCwgd2lkdGggLSBtYXJnaW4ucmlnaHRdKTtcblxuICBjb25zdCB5ID0gZDNcbiAgICAuc2NhbGVCYW5kKClcbiAgICAuZG9tYWluKGRhdGEubWFwKChkKSA9PiBkW2FkbWluX2FnZ3JlZ2F0aW9uTGV2ZWxdKSlcbiAgICAucmFuZ2UoW21hcmdpbi50b3AsIHRvdGFsSGVpZ2h0XSlcbiAgICAucGFkZGluZygwLjEpO1xuXG4gIGNvbnN0IGNvbG9yID0gZDMuc2NhbGVPcmRpbmFsKCkuZG9tYWluKGtleXMpLnJhbmdlKFtcIiMyMTY3MjlcIiwgXCIjRjdENzMyXCJdKTtcblxuICAvLyBEcmF3IHRoZSBiYXJzXG4gIGNvbnN0IGJhcnMgPSBzdmdcbiAgICAuYXBwZW5kKFwiZ1wiKVxuICAgIC5zZWxlY3RBbGwoXCJnXCIpXG4gICAgLmRhdGEoc3RhY2tlZERhdGEpXG4gICAgLmpvaW4oXCJnXCIpXG4gICAgLmF0dHIoXCJmaWxsXCIsIChkKSA9PiBjb2xvcihkLmtleSkpXG4gICAgLnNlbGVjdEFsbChcInJlY3RcIilcbiAgICAuZGF0YSgoZCkgPT4gZClcbiAgICAuam9pbihcInJlY3RcIilcbiAgICAuYXR0cihcInhcIiwgKGQpID0+IHgoZFswXSkpXG4gICAgLmF0dHIoXCJ5XCIsIChkKSA9PiB5KGQuZGF0YVthZG1pbl9hZ2dyZWdhdGlvbkxldmVsXSkpXG4gICAgLmF0dHIoXCJoZWlnaHRcIiwgeS5iYW5kd2lkdGgoKSlcbiAgICAuYXR0cihcIndpZHRoXCIsIChkKSA9PiB4KGRbMV0pIC0geChkWzBdKSk7XG5cbiAgYmFyc1xuICAgIC5vbihcIm1vdXNlb3ZlclwiLCAoZXZlbnQsIGQpID0+IHtcbiAgICAgIGQzLnNlbGVjdChldmVudC5jdXJyZW50VGFyZ2V0KS5zdHlsZShcInN0cm9rZVwiLCBcImJsYWNrXCIpLnJhaXNlKCk7XG4gICAgfSlcbiAgICAub24oXCJtb3VzZW1vdmVcIiwgKGV2ZW50LCBkKSA9PiB7XG4gICAgICBjb25zdCBrZXkgPSBldmVudC50YXJnZXQucGFyZW50Tm9kZS5fX2RhdGFfXy5rZXk7XG5cbiAgICAgIHRvb2x0aXBcbiAgICAgICAgLnN0eWxlKFwidG9wXCIsIGV2ZW50LnBhZ2VZIC0gMTAgKyBcInB4XCIpXG4gICAgICAgIC5zdHlsZShcImxlZnRcIiwgZXZlbnQucGFnZVggKyAxMCArIFwicHhcIilcbiAgICAgICAgLnN0eWxlKFwib3BhY2l0eVwiLCAxKVxuICAgICAgICAuc3R5bGUoXCJkaXNwbGF5XCIsIFwiYmxvY2tcIilcbiAgICAgICAgLmh0bWwoXG4gICAgICAgICAgYCR7XG4gICAgICAgICAgICBkLmRhdGFbYWRtaW5fYWdncmVnYXRpb25MZXZlbF1cbiAgICAgICAgICB9IDxicj4gJHtfbGFuZyhuYlRleHQuVmlld0V4cGxvcmUuc2VsZWN0b3JzLnZpc3VhbGlzZVZhcnMuZXhwb3N1cmUuZXhwb3N1cmVWYXJpYWJsZS5vcHRpb25zW2tleV0pfTogJHtmb3JtYXRfdmFsKGRbMV0gLSBkWzBdLCBcInRvdGFsXCIpfWAsXG4gICAgICAgICk7XG4gICAgfSlcbiAgICAub24oXCJtb3VzZW91dFwiLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgIGQzLnNlbGVjdChcIi5wbG90VG9vbHRpcFwiKS5zdHlsZShcImRpc3BsYXlcIiwgXCJub25lXCIpO1xuICAgICAgZDMuc2VsZWN0KGV2ZW50LmN1cnJlbnRUYXJnZXQpLnN0eWxlKFwic3Ryb2tlXCIsIFwibm9uZVwiKTtcbiAgICB9KTtcblxuICAvLyBBZGQgdGhlIFkgYXhpc1xuICBzdmdcbiAgICAuYXBwZW5kKFwiZ1wiKVxuICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIGB0cmFuc2xhdGUoJHttYXJnaW4ubGVmdH0sIDApYClcbiAgICAuY2FsbChkMy5heGlzTGVmdCh5KSk7XG5cbiAgY29uc3QgbGVnZW5kU3ZnID0gZDNcbiAgICAuY3JlYXRlKFwic3ZnXCIpXG4gICAgLmF0dHIoXCJ3aWR0aFwiLCB3aWR0aCArIDUwKVxuICAgIC5hdHRyKFwiaGVpZ2h0XCIsIDc1KTtcblxuICAvLyBBZGQgbGVnZW5kIHRvIHRoZSBuZXcgU1ZHXG4gIGNvbnN0IGxlZ2VuZCA9IGxlZ2VuZFN2Z1xuICAgIC5hcHBlbmQoXCJnXCIpXG4gICAgLmF0dHIoXCJjbGFzc1wiLCBcImxlZ2VuZFwiKVxuICAgIC5zZWxlY3RBbGwoXCJnXCIpXG4gICAgLmRhdGEoa2V5cylcbiAgICAuam9pbihcImdcIilcbiAgICAuYXR0cihcInRyYW5zZm9ybVwiLCAoZCwgaSkgPT4gYHRyYW5zbGF0ZSgxMCwgJHtpICogMjB9KWApO1xuXG4gIGxlZ2VuZFxuICAgIC5hcHBlbmQoXCJyZWN0XCIpXG4gICAgLmF0dHIoXCJ3aWR0aFwiLCAxOClcbiAgICAuYXR0cihcImhlaWdodFwiLCAxOClcbiAgICAuYXR0cihcImZpbGxcIiwgY29sb3IpO1xuXG4gIGxlZ2VuZFxuICAgIC5hcHBlbmQoXCJ0ZXh0XCIpXG4gICAgLmF0dHIoXCJ4XCIsIDI0KVxuICAgIC5hdHRyKFwieVwiLCA5KVxuICAgIC5hdHRyKFwiZHlcIiwgXCIwLjM1ZW1cIilcbiAgICAudGV4dCgoZCkgPT5cbiAgICAgIF9sYW5nKFxuICAgICAgICBuYlRleHQuVmlld0V4cGxvcmUuc2VsZWN0b3JzLnZpc3VhbGlzZVZhcnMuZXhwb3N1cmUuZXhwb3N1cmVWYXJpYWJsZVxuICAgICAgICAgIC5vcHRpb25zW2RdLFxuICAgICAgKSxcbiAgICApO1xuICAvLyAudGV4dCgoZCkgPT4gKGQgPT09IFwicnVyYWxfcG9wXCIgPyBcIlJ1cmFsIFBvcHVsYXRpb25cIiA6IFwiVXJiYW4gUG9wdWxhdGlvblwiKSk7XG5cbiAgLy8gQWRkIHRoZSBYIGF4aXNcbiAgbGVnZW5kU3ZnXG4gICAgLmFwcGVuZChcImdcIilcbiAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBgdHJhbnNsYXRlKDAsIDc1KWApXG4gICAgLmNhbGwoZDMuYXhpc1RvcCh4KS50aWNrcyg1KSk7XG5cbiAgY29uc3QgbGVnZW5kQ29udGFpbmVyID0gaHRtbGA8ZGl2IHN0eWxlPVwid2lkdGg6IDEwMCU7XCI+JHtsZWdlbmRTdmcubm9kZSgpfTwvZGl2PmA7XG4gIGNvbnN0IHNjcm9sbGFibGVDb250YWluZXIgPSBodG1sYDxkaXYgc3R5bGU9XCJvdmVyZmxvdy15OiBhdXRvOyB3aWR0aDogMTAwJTsgaGVpZ2h0OiAke1xuICAgIGhlaWdodCArIG1hcmdpbi50b3AgKyBtYXJnaW4uYm90dG9tXG4gIH1weDtwYWRkaW5nPTBweDsgbWFyZ2luPTBweDtcIj4ke3N2Zy5ub2RlKCl9PC9kaXY+YDtcblxuICBjb25zdCBjb250YWluZXIgPSBodG1sYDxkaXY+JHtsZWdlbmRDb250YWluZXJ9JHtzY3JvbGxhYmxlQ29udGFpbmVyfTwvZGl2PmA7XG4gIHJldHVybiBjb250YWluZXI7XG59O1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xMTUiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJmdW5jdGlvbiBmb3JtYXRfc2xvcGVEYXRhKGRhdGEpIHtcbiAgY29uc3Qgb3JkZXIgPSBbXCJoaXN0b3JpY1wiLCBcIjIwMjFfMjA0MFwiLCBcIjIwNDFfMjA2MFwiXTtcblxuICBjb25zdCBhZG1pbl9ncm91cGVkID0gQXJyYXkuZnJvbShcbiAgICBkMy5ncm91cChkYXRhLCAoZCkgPT4gZFtcImhhemFyZFwiXSksXG4gICAgKFthZG1pbl9uYW1lLCB2YWx1ZXNdKSA9PiB7XG4gICAgICB2YWx1ZXMuc29ydChcbiAgICAgICAgKGEsIGIpID0+IG9yZGVyLmluZGV4T2YoYS50aW1lZnJhbWUpIC0gb3JkZXIuaW5kZXhPZihiLnRpbWVmcmFtZSksXG4gICAgICApO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgYWRtaW5fbmFtZSxcbiAgICAgICAgdmFsdWVzOiB2YWx1ZXMubWFwKCh7IHRpbWVmcmFtZSwgc2NlbmFyaW8sIHZhbHVlLCBwZXJjZW50Q2hhbmdlIH0pID0+ICh7XG4gICAgICAgICAgdGltZWZyYW1lLFxuICAgICAgICAgIHNjZW5hcmlvLFxuICAgICAgICAgIHZhbHVlLFxuICAgICAgICAgIHBlcmNlbnRDaGFuZ2UsXG4gICAgICAgIH0pKSxcbiAgICAgIH07XG4gICAgfSxcbiAgKTtcbiAgcmV0dXJuIGFkbWluX2dyb3VwZWQ7XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTExNiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImNhbGN1bGF0ZVBlcmNlbnRDaGFuZ2UgPSAoZGF0YSkgPT4ge1xuICBjb25zdCBiYXNlbGluZSA9IHt9O1xuXG4gIC8vIEZpbmQgaGlzdG9yaWMgYmFzZWxpbmUgdmFsdWVzXG4gIGZvciAoY29uc3Qgcm93IG9mIGRhdGEpIHtcbiAgICBpZiAocm93LnNjZW5hcmlvID09PSBcImhpc3RvcmljXCIgJiYgcm93LnRpbWVmcmFtZSA9PT0gXCJoaXN0b3JpY1wiKSB7XG4gICAgICBiYXNlbGluZVtyb3cuaGF6YXJkXSA9IHJvdy5hZG1pbl9tZWFuO1xuICAgIH1cbiAgfVxuXG4gIGNvbnN0IHJlc3VsdHMgPSBbXTtcbiAgZm9yIChjb25zdCByb3cgb2YgZGF0YSkge1xuICAgIGNvbnN0IGhhemFyZCA9IHJvdy5oYXphcmQ7XG4gICAgY29uc3Qgc2NlbmFyaW8gPSByb3cuc2NlbmFyaW87XG4gICAgY29uc3QgdGltZWZyYW1lID0gcm93LnRpbWVmcmFtZTtcbiAgICBjb25zdCB2YWx1ZSA9IHJvdy5hZG1pbl9tZWFuO1xuICAgIGNvbnN0IGJhc2VsaW5lVmFsdWUgPSBiYXNlbGluZVtoYXphcmRdO1xuXG4gICAgLy8gQ2hlY2sgaWYgYmFzZWxpbmUgdmFsdWUgZXhpc3RzXG4gICAgaWYgKGJhc2VsaW5lVmFsdWUgIT09IHVuZGVmaW5lZCAmJiBzY2VuYXJpbyAhPT0gXCJoaXN0b3JpY1wiKSB7XG4gICAgICBjb25zdCBjaGFuZ2UgPSB2YWx1ZSAtIGJhc2VsaW5lVmFsdWU7XG4gICAgICBjb25zdCBwZXJjZW50Q2hhbmdlID0gKGNoYW5nZSAvIGJhc2VsaW5lVmFsdWUpICogMTAwO1xuICAgICAgcmVzdWx0cy5wdXNoKHsgaGF6YXJkLCBzY2VuYXJpbywgdGltZWZyYW1lLCB2YWx1ZSwgcGVyY2VudENoYW5nZSB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmVzdWx0cy5wdXNoKHsgaGF6YXJkLCBzY2VuYXJpbywgdGltZWZyYW1lLCB2YWx1ZSwgcGVyY2VudENoYW5nZTogbnVsbCB9KTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gcmVzdWx0cztcbn07XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTExNyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6ImZ1bmN0aW9uIHNjYWxlSGF6YXJkVmFsdWUodmFsdWUsIG1pblZhbHVlLCBtYXhWYWx1ZSkge1xuICBjb25zdCB0aHJlc2hvbGRzID0gaGF6YXJkX2RpY3RbXCJIU0hfbWF4XCJdW1widGhyZXNob2xkc1wiXTtcblxuICAvLyBDYWxjdWxhdGUgdGhlIHJhbmdlIGJldHdlZW4gdGhlIG1pbmltdW0gYW5kIG1heGltdW0gdmFsdWVzXG4gIGNvbnN0IHJhbmdlID0gbWF4VmFsdWUgLSBtaW5WYWx1ZTtcblxuICAvLyBEZXRlcm1pbmUgdGhlIHNjYWxlIGJhc2VkIG9uIHRocmVzaG9sZHNcbiAgaWYgKHZhbHVlIDw9IHRocmVzaG9sZHNbMF0pIHtcbiAgICByZXR1cm4gMTtcbiAgfSBlbHNlIGlmICh2YWx1ZSA8PSB0aHJlc2hvbGRzWzFdKSB7XG4gICAgcmV0dXJuIE1hdGguY2VpbChcbiAgICAgIDEgKyAoKHZhbHVlIC0gdGhyZXNob2xkc1swXSkgLyAodGhyZXNob2xkc1sxXSAtIHRocmVzaG9sZHNbMF0pKSAqIDIsXG4gICAgKTtcbiAgfSBlbHNlIGlmICh2YWx1ZSA8PSB0aHJlc2hvbGRzWzJdKSB7XG4gICAgcmV0dXJuIE1hdGguY2VpbChcbiAgICAgIDQgKyAoKHZhbHVlIC0gdGhyZXNob2xkc1sxXSkgLyAodGhyZXNob2xkc1syXSAtIHRocmVzaG9sZHNbMV0pKSAqIDMsXG4gICAgKTtcbiAgfSBlbHNlIGlmICh2YWx1ZSA8PSB0aHJlc2hvbGRzWzNdKSB7XG4gICAgcmV0dXJuIE1hdGguY2VpbChcbiAgICAgIDcgKyAoKHZhbHVlIC0gdGhyZXNob2xkc1syXSkgLyAodGhyZXNob2xkc1szXSAtIHRocmVzaG9sZHNbMl0pKSAqIDMsXG4gICAgKTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gMTA7XG4gIH1cbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTE4IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoicGFyYWxsZWxDb29yZGluYXRlc1Bsb3QgPSBhc3luYyAoKSA9PiB7XG4gIGNvbnN0IG1hcmdpbiA9IHsgdG9wOiAzMCwgcmlnaHQ6IDgwLCBib3R0b206IDI1LCBsZWZ0OiA0MCB9LFxuICAgIHdpZHRoID0gMTIwMCAtIG1hcmdpbi5sZWZ0IC0gbWFyZ2luLnJpZ2h0LFxuICAgIGhlaWdodCA9IDYwMCAtIG1hcmdpbi50b3AgLSBtYXJnaW4uYm90dG9tO1xuXG4gIGxldCBncm91cF9xdWVyeTtcbiAgaWYgKFxuICAgIERhdGFTZWxlY3Rvcl9mb3JtLnZ1bG5lcmFiaWxpdHlHcm91cF9mb3JtLnZ1bG5lcmFiaWxpdHlfc2VsLmV2ZXJ5KFxuICAgICAgKGQpID0+IGQgPT09IFwiRWR1Y2F0aW9uXCIsXG4gICAgKVxuICApIHtcbiAgICBncm91cF9xdWVyeSA9IGBBTkQgXCJncm91cFwiID0gJ2VkdWNhdGlvbicgT1IgXCJ2YXJpYWJsZVwiID0gJ2VkdWNhdGlvbidgO1xuICB9IGVsc2Uge1xuICAgIGdyb3VwX3F1ZXJ5ID0gYEFORCBcImdyb3VwXCIgaW4gKCR7XG4gICAgICBcIidcIiArXG4gICAgICBEYXRhU2VsZWN0b3JfZm9ybS52dWxuZXJhYmlsaXR5R3JvdXBfZm9ybS52dWxuZXJhYmlsaXR5X3NlbFxuICAgICAgICAuam9pbihcIicsICdcIilcbiAgICAgICAgLnRvTG93ZXJDYXNlKCkgK1xuICAgICAgXCInXCJcbiAgICB9KWA7XG4gIH1cblxuICAvLyBsZXQgc2VsZWN0ZWRfY291bnRyeSA9IFwiXCI7XG4gIGxldCBkYXRhID0gYXdhaXQgZGIucXVlcnkoXG4gICAgYFNFTEVDVCBcImFkbWluMF9uYW1lXCIsIFwiYWRtaW4xX25hbWVcIiwgXCJhZG1pbjJfbmFtZVwiLCBcImdyb3VwXCIsIFwidmFyaWFibGVcIiwgXCJ2YWx1ZVwiXG4gICAgIEZST00gVnVsbmVyYWJpbGl0eSBcbiAgICAgJHttYXBEYXRhUXVlcnlfYWRtaW59XG4gICAgIEFORCBcInZhcmlhYmxlXCIgIT0gJ0dlbmRlckVxdWl0eV8xOTk1LjIwMTUnXG4gICAgICR7Z3JvdXBfcXVlcnl9YCxcbiAgKTtcbiAgY29uc3QgZGF0YV92dWxuID0gcGl2b3REYXRhKGRhdGEpO1xuICBsZXQgbWVhbnMgPSBjYWxjdWxhdGVNZWFucyhkYXRhKTtcbiAgbWVhbnMuY291bnRyeSA9IFwiUmVnaW9uYWwgQXZlcmFnZVwiO1xuXG4gIGNvbnN0IGNvbG9yID0gZDNcbiAgICAuc2NhbGVPcmRpbmFsKClcbiAgICAuZG9tYWluKGRhdGFfdnVsbi5tYXAoKGQpID0+IGQuY291bnRyeSkpXG4gICAgLnJhbmdlKGQzLnNjaGVtZUNhdGVnb3J5MTApO1xuXG4gIGNvbnN0IHN2ZyA9IGQzXG4gICAgLmNyZWF0ZShcInN2Z1wiKVxuICAgIC5hdHRyKFwiaWRcIiwgXCJWdWxuZXJhYmxlUGFyYWxsZWxMaW5lXCIpXG4gICAgLmF0dHIoXCJ2aWV3Qm94XCIsIFswLCAwLCB3aWR0aCwgaGVpZ2h0XSlcbiAgICAuYXR0cihcIndpZHRoXCIsIHdpZHRoKVxuICAgIC5hdHRyKFwiaGVpZ2h0XCIsIGhlaWdodCk7XG5cbiAgY29uc3QgZGltZW5zaW9ucyA9IE9iamVjdC5rZXlzKGRhdGFfdnVsblswXSkuZmlsdGVyKChkKSA9PiBkICE9PSBcImNvdW50cnlcIik7XG4gIGRpbWVuc2lvbnMuc29ydCgpO1xuICBjb25zdCB5ID0ge307XG4gIGZvciAoY29uc3QgZGltIG9mIGRpbWVuc2lvbnMpIHtcbiAgICBsZXQgeV9leHRlbnQgPVxuICAgICAgZGltID09PSBcImVkdWNhdGlvbi1lZHVjYXRpb25ZcnNcIlxuICAgICAgICA/IC8vID8gZDMuZXh0ZW50KGRhdGFfdnVsbiwgKGl0ZW0pID0+IGl0ZW1bZGltXSlcbiAgICAgICAgICBbMCwgZDMubWF4KGRhdGFfdnVsbiwgKGl0ZW0pID0+IGl0ZW1bZGltXSldXG4gICAgICAgIDogWzAsIDFdO1xuICAgIHlbZGltXSA9IGQzXG4gICAgICAuc2NhbGVMaW5lYXIoKVxuICAgICAgLmRvbWFpbih5X2V4dGVudClcbiAgICAgIC5yYW5nZShbaGVpZ2h0IC0gbWFyZ2luLmJvdHRvbSwgbWFyZ2luLnRvcF0pO1xuICB9XG5cbiAgY29uc3QgeCA9IGQzXG4gICAgLnNjYWxlUG9pbnQoKVxuICAgIC5kb21haW4oZGltZW5zaW9ucylcbiAgICAucmFuZ2UoW21hcmdpbi5sZWZ0LCB3aWR0aCAtIG1hcmdpbi5yaWdodF0pO1xuXG4gIGNvbnN0IGxpbmUgPSBkM1xuICAgIC5saW5lKClcbiAgICAuZGVmaW5lZCgoZCkgPT4gIWlzTmFOKGRbMV0pKVxuICAgIC54KChkKSA9PiB4KGRbMF0pKVxuICAgIC55KChkKSA9PiB5W2RbMF1dKGRbMV0pKTtcblxuICBjb25zdCB0b29sdGlwID0gZDNcbiAgICAuc2VsZWN0KFwiYm9keVwiKVxuICAgIC5hcHBlbmQoXCJkaXZcIilcbiAgICAuc3R5bGUoXCJwb3NpdGlvblwiLCBcImFic29sdXRlXCIpXG4gICAgLnN0eWxlKFwiYmFja2dyb3VuZC1jb2xvclwiLCBcIndoaXRlXCIpXG4gICAgLnN0eWxlKFwicGFkZGluZ1wiLCBcIjVweFwiKVxuICAgIC5zdHlsZShcImJvcmRlclwiLCBcIjFweCBzb2xpZCBibGFja1wiKVxuICAgIC5zdHlsZShcImJvcmRlci1yYWRpdXNcIiwgXCI1cHhcIilcbiAgICAuc3R5bGUoXCJvcGFjaXR5XCIsIDApO1xuXG4gIGxldCBjb3VudHJ5bGluZXMgPSBzdmdcbiAgICAuc2VsZWN0QWxsKFwiLmNvdW50cnlMaW5lc1wiKVxuICAgIC5kYXRhKGRhdGFfdnVsbilcbiAgICAuZW50ZXIoKVxuICAgIC5hcHBlbmQoXCJwYXRoXCIpXG4gICAgLmF0dHIoXCJjbGFzc1wiLCBcImNvdW50cnlMaW5lc1wiKVxuICAgIC5hdHRyKFwiZFwiLCAoZCkgPT4gbGluZShkaW1lbnNpb25zLm1hcCgocCkgPT4gW3AsIGRbcF1dKSkpXG4gICAgLnN0eWxlKFwiZmlsbFwiLCBcIm5vbmVcIilcbiAgICAuc3R5bGUoXG4gICAgICBcInN0cm9rZVwiLFxuICAgICAgXCJsaWdodGdyZXlcIiwgLy8gKGQuY291bnRyeSA9PT0gc2VsZWN0ZWRfY291bnRyeSA/IFwiZ3JlZW5cIiA6IFwibGlnaHRncmV5XCIpIC8vY29sb3IoZC5jb3VudHJ5KVxuICAgIClcbiAgICAuc3R5bGUoXCJzdHJva2Utd2lkdGhcIiwgMS41KVxuICAgIC5zdHlsZShcIm9wYWNpdHlcIiwgMC4yKSAvLyAoZCkgPT4gKGQuY291bnRyeSA9PT0gc2VsZWN0ZWRfY291bnRyeSA/IDAuOSA6IDAuMikpXG4gICAgLm9uKFwibW91c2VvdmVyXCIsIGZ1bmN0aW9uIChldmVudCwgZCkge1xuICAgICAgLy8gc3ZnLnNlbGVjdEFsbChcIi5jb3VudHJ5TGluZXNcIikuc3R5bGUoXCJvcGFjaXR5XCIsIDAuMSk7XG4gICAgICBkMy5zZWxlY3QodGhpcykuc3R5bGUoXCJvcGFjaXR5XCIsIDEpLnN0eWxlKFwic3Ryb2tlXCIsIFwiI0YyOUQyRFwiKTtcbiAgICAgIHRvb2x0aXAudHJhbnNpdGlvbigpLmR1cmF0aW9uKDApLnN0eWxlKFwib3BhY2l0eVwiLCAwLjkpO1xuICAgICAgdG9vbHRpcFxuICAgICAgICAuaHRtbChgJHtkLmNvdW50cnl9YClcbiAgICAgICAgLnN0eWxlKFwibGVmdFwiLCBldmVudC5wYWdlWCArIDEwICsgXCJweFwiKVxuICAgICAgICAuc3R5bGUoXCJ0b3BcIiwgZXZlbnQucGFnZVkgLSAyOCArIFwicHhcIik7XG4gICAgfSlcbiAgICAub24oXCJtb3VzZW91dFwiLCBmdW5jdGlvbiAoZCkge1xuICAgICAgc3ZnXG4gICAgICAgIC5zZWxlY3RBbGwoXCIuY291bnRyeUxpbmVzXCIpXG4gICAgICAgIC5zdHlsZShcIm9wYWNpdHlcIiwgMC4yKSAvLyAoZCkgPT4gKGQuY291bnRyeSA9PT0gc2VsZWN0ZWRfY291bnRyeSA/IDAuOSA6IDAuMikpO1xuICAgICAgICAuc3R5bGUoXCJzdHJva2VcIiwgXCJsaWdodGdyZXlcIik7XG4gICAgICB0b29sdGlwLnRyYW5zaXRpb24oKS5kdXJhdGlvbig1MDApLnN0eWxlKFwib3BhY2l0eVwiLCAwKTtcbiAgICB9KTtcblxuICBsZXQgYXZnX2xpbmVzID0gc3ZnXG4gICAgLnNlbGVjdEFsbChcImF2Z1BhdGhcIilcbiAgICAuZGF0YShtZWFucylcbiAgICAuZW50ZXIoKVxuICAgIC5hcHBlbmQoXCJwYXRoXCIpXG4gICAgLmF0dHIoXCJkXCIsIChkKSA9PiBsaW5lKGRpbWVuc2lvbnMubWFwKChwKSA9PiBbcCwgZFtwXV0pKSlcbiAgICAuc3R5bGUoXCJmaWxsXCIsIFwibm9uZVwiKVxuICAgIC5zdHlsZShcInN0cm9rZVwiLCBcIiMyRTc2MzZcIilcbiAgICAuc3R5bGUoXCJzdHJva2Utd2lkdGhcIiwgMS41KVxuICAgIC5zdHlsZShcIm9wYWNpdHlcIiwgMSk7XG5cbiAgc3ZnXG4gICAgLnNlbGVjdEFsbChcIm15QXhpc1wiKVxuICAgIC5kYXRhKGRpbWVuc2lvbnMpXG4gICAgLmVudGVyKClcbiAgICAuYXBwZW5kKFwiZ1wiKVxuICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIChkKSA9PiBcInRyYW5zbGF0ZShcIiArIHgoZCkgKyBcIilcIilcbiAgICAuYXR0cihcInBvaW50ZXItZXZlbnRzXCIsIFwibm9uZVwiKVxuICAgIC5lYWNoKGZ1bmN0aW9uIChkKSB7XG4gICAgICBkMy5zZWxlY3QodGhpcykuY2FsbChkMy5heGlzTGVmdCgpLnNjYWxlKHlbZF0pKTtcbiAgICB9KVxuICAgIC5hcHBlbmQoXCJ0ZXh0XCIpXG4gICAgLnN0eWxlKFwidGV4dC1hbmNob3JcIiwgXCJtaWRkbGVcIilcbiAgICAvLyAuYXR0cihcInlcIiwgMTApXG4gICAgLy8gLmF0dHIoXCJ4XCIsIDApXG4gICAgLmF0dHIoXCJ5XCIsIChkLCBpKSA9PiB7XG4gICAgICByZXR1cm4gaSAlIDIgPT09IDAgPyAxMCA6IGhlaWdodCAtIG1hcmdpbi5ib3R0b20gKyAyMDtcbiAgICB9KVxuICAgIC50ZXh0KChkKSA9PiB7XG4gICAgICBsZXQgc3BsaXQgPSBkLnNwbGl0KFwiLVwiKTtcbiAgICAgIGNvbnNvbGUubG9nKGQpO1xuICAgICAgLy8gbGV0IGNsZWFuX3RleHQgPSB2dWxuZXJhYmlsaXR5X2RpY3Rbc3BsaXRbMF1dW3NwbGl0WzFdXTtcbiAgICAgIGxldCBjbGVhbl90ZXh0ID0gX2xhbmcobmJUZXh0LmdlbmVyYWwuYWNWYXJzW3NwbGl0WzFdXSk7XG4gICAgICByZXR1cm4gY2xlYW5fdGV4dDtcbiAgICB9KVxuICAgIC5zdHlsZShcImZpbGxcIiwgXCJibGFja1wiKVxuICAgIC5zdHlsZShcImZvbnQtc2l6ZVwiLCBcIjEycHhcIik7XG5cbiAgc3ZnXG4gICAgLnNlbGVjdEFsbChcImF2Z0xhYmVsXCIpXG4gICAgLmRhdGEobWVhbnMpXG4gICAgLmVudGVyKClcbiAgICAuYXBwZW5kKFwidGV4dFwiKVxuICAgIC5hdHRyKFwieFwiLCB3aWR0aCAtIG1hcmdpbi5yaWdodCkgLy8gQWxpZ24gaXQgd2l0aCB0aGUgcmlnaHQgbWFyZ2luXG4gICAgLmF0dHIoXCJ5XCIsIChkKSA9PlxuICAgICAgeVtkaW1lbnNpb25zW2RpbWVuc2lvbnMubGVuZ3RoIC0gMV1dKFxuICAgICAgICBkW2RpbWVuc2lvbnNbZGltZW5zaW9ucy5sZW5ndGggLSAxXV0sXG4gICAgICApLFxuICAgIClcbiAgICAuYXR0cihcImR5XCIsIFwiLjM1ZW1cIilcbiAgICAuYXR0cihcInRleHQtYW5jaG9yXCIsIFwic3RhcnRcIilcbiAgICAuc3R5bGUoXCJmaWxsXCIsIFwiIzJFNzYzNlwiKVxuICAgIC5zZWxlY3RBbGwoXCJ0c3BhblwiKVxuICAgIC5kYXRhKFtjb3VudHJ5LCBcIkF2ZXJhZ2VcIl0pXG4gICAgLmVudGVyKClcbiAgICAuYXBwZW5kKFwidHNwYW5cIilcbiAgICAuYXR0cihcInhcIiwgd2lkdGggLSBtYXJnaW4ucmlnaHQgKyA1KSAvLyBBbGlnbiBib3RoIGxpbmVzIHdpdGggdGhlIHNhbWUgeCBwb3NpdGlvblxuICAgIC5hdHRyKFwiZHlcIiwgKGQsIGkpID0+IChpID09PSAwID8gMCA6IFwiMS4yZW1cIikpIC8vIE9mZnNldCB0aGUgc2Vjb25kIGxpbmVcbiAgICAudGV4dCgoZCkgPT4gZCk7XG5cbiAgcmV0dXJuIHN2Zy5ub2RlKCk7XG5cbiAgZnVuY3Rpb24gcGl2b3REYXRhKGRhdGEpIHtcbiAgICBjb25zdCBwaXZvdGVkRGF0YSA9IHt9O1xuXG4gICAgZGF0YS5mb3JFYWNoKChyb3cpID0+IHtcbiAgICAgIGNvbnN0IGNvdW50cnkgPSByb3dbYWRtaW5fYWdncmVnYXRpb25MZXZlbF07XG5cbiAgICAgIGlmICghcGl2b3RlZERhdGFbY291bnRyeV0pIHtcbiAgICAgICAgcGl2b3RlZERhdGFbY291bnRyeV0gPSB7IGNvdW50cnkgfTtcbiAgICAgIH1cbiAgICAgIGxldCBjb21iaW5lZF9uYW1lID0gcm93Lmdyb3VwICsgXCItXCIgKyByb3cudmFyaWFibGU7XG4gICAgICBwaXZvdGVkRGF0YVtjb3VudHJ5XVtjb21iaW5lZF9uYW1lXSA9IHJvdy52YWx1ZTtcbiAgICB9KTtcblxuICAgIHJldHVybiBPYmplY3QudmFsdWVzKHBpdm90ZWREYXRhKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGNhbGN1bGF0ZU1lYW5zKGRhdGEpIHtcbiAgICBjb25zdCBncm91cGVkRGF0YSA9IHt9O1xuXG4gICAgLy8gR3JvdXAgZGF0YSBieSB2YXJpYWJsZVxuICAgIGRhdGEuZm9yRWFjaCgocm93KSA9PiB7XG4gICAgICBsZXQgY29tYmluZWRfbmFtZSA9IHJvdy5ncm91cCArIFwiLVwiICsgcm93LnZhcmlhYmxlO1xuICAgICAgaWYgKCFncm91cGVkRGF0YVtjb21iaW5lZF9uYW1lXSkge1xuICAgICAgICBncm91cGVkRGF0YVtjb21iaW5lZF9uYW1lXSA9IFtdO1xuICAgICAgfVxuICAgICAgZ3JvdXBlZERhdGFbY29tYmluZWRfbmFtZV0ucHVzaChyb3cudmFsdWUpO1xuICAgIH0pO1xuXG4gICAgLy8gQ2FsY3VsYXRlIG1lYW4gZm9yIGVhY2ggdmFyaWFibGVcbiAgICBjb25zdCBtZWFucyA9IHt9O1xuICAgIGZvciAoY29uc3QgW3ZhcmlhYmxlLCB2YWx1ZXNdIG9mIE9iamVjdC5lbnRyaWVzKGdyb3VwZWREYXRhKSkge1xuICAgICAgY29uc3Qgc3VtID0gdmFsdWVzLnJlZHVjZSgoYWNjLCB2YWwpID0+IGFjYyArIHZhbCwgMCk7XG4gICAgICBtZWFuc1t2YXJpYWJsZV0gPSBzdW0gLyB2YWx1ZXMubGVuZ3RoO1xuICAgIH1cblxuICAgIHJldHVybiBbbWVhbnNdO1xuICB9XG59O1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xMTkiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJwYXJhbGxlbENvb3JkaW5hdGVzU2NhdHRlclBsb3QyID0gYXN5bmMgKCkgPT4ge1xuICBjb25zdCBtYXJnaW4gPSB7IHRvcDogNjAsIHJpZ2h0OiA4MCwgYm90dG9tOiAyNSwgbGVmdDogNDAgfSxcbiAgICB3aWR0aCA9IDEyMDAgLSBtYXJnaW4ubGVmdCAtIG1hcmdpbi5yaWdodCxcbiAgICBoZWlnaHQgPSA2MDAgLSBtYXJnaW4udG9wIC0gbWFyZ2luLmJvdHRvbTtcblxuICBsZXQgZ3JvdXBfcXVlcnkgPSBgQU5EIFwiZ3JvdXBcIiBpbiAoJHtcbiAgICBcIidcIiArXG4gICAgRGF0YVNlbGVjdG9yX2Zvcm0udnVsbmVyYWJpbGl0eUdyb3VwX2Zvcm0udnVsbmVyYWJpbGl0eV9zZWxcbiAgICAgIC5qb2luKFwiJywgJ1wiKVxuICAgICAgLnRvTG93ZXJDYXNlKCkgK1xuICAgIFwiJ1wiXG4gIH0pYDtcblxuICBsZXQgZGF0YSA9IGF3YWl0IGRiLnF1ZXJ5KFxuICAgIGBTRUxFQ1QgXCJhZG1pbjBfbmFtZVwiLCBcImFkbWluMV9uYW1lXCIsIFwiYWRtaW4yX25hbWVcIiwgXCJncm91cFwiLCBcInZhcmlhYmxlXCIsIFwidmFsdWVcIlxuICAgICBGUk9NIFZ1bG5lcmFiaWxpdHkgXG4gICAgICR7cGxvdFF1ZXJ5Ml9hZG1pbn1cbiAgICAgQU5EIFwidmFyaWFibGVcIiAhPSAnR2VuZGVyRXF1aXR5XzE5OTUuMjAxNSdcbiAgICAgJHtncm91cF9xdWVyeX1gLFxuICApO1xuXG4gIGNvbnN0IGRhdGFfdnVsbiA9IHBpdm90RGF0YShkYXRhKTtcbiAgbGV0IG1lYW5zID0gY2FsY3VsYXRlTWVhbnMoZGF0YSk7XG4gIG1lYW5zLmNvdW50cnkgPSBcIlJlZ2lvbmFsIEF2ZXJhZ2VcIjtcblxuICBjb25zdCBkaW1lbnNpb25zID0gT2JqZWN0LmtleXMoZGF0YV92dWxuWzBdKS5maWx0ZXIoKGQpID0+IGQgIT09IFwiY291bnRyeVwiKTtcbiAgY29uc3Qgaml0dGVyID0gZDMucmFuZG9tVW5pZm9ybSgtMjAsIDIwKTtcblxuICBjb25zdCBjb2xvciA9IGQzXG4gICAgLnNjYWxlT3JkaW5hbCgpXG4gICAgLmRvbWFpbihkYXRhX3Z1bG4ubWFwKChkKSA9PiBkLmNvdW50cnkpKVxuICAgIC5yYW5nZShkMy5zY2hlbWVDYXRlZ29yeTEwKTtcblxuICBjb25zdCBzdmcgPSBkM1xuICAgIC5jcmVhdGUoXCJzdmdcIilcbiAgICAuYXR0cihcImlkXCIsIFwiVnVsbmVyYWJsZVBhcmFsbGVsU2NhdHRlclwiKVxuICAgIC5hdHRyKFwidmlld0JveFwiLCBbMCwgMCwgd2lkdGgsIGhlaWdodF0pXG4gICAgLmF0dHIoXCJ3aWR0aFwiLCB3aWR0aClcbiAgICAuYXR0cihcImhlaWdodFwiLCBoZWlnaHQpO1xuXG4gIC8vIERlZmluZSB0aGUgdmFyaWFibGUgY2F0ZWdvcmllcyAoZ2VuZGVyLCBwb3ZlcnR5LCBlZHVjYXRpb24pXG4gIGNvbnN0IGNhdGVnb3JpZXMgPSB7XG4gICAgZ2VuZGVyOiB7XG4gICAgICB2YWx1ZXM6IGRpbWVuc2lvbnMuZmlsdGVyKChkKSA9PiBkLnN0YXJ0c1dpdGgoXCJnZW5kZXJcIikpLFxuICAgICAgcmFuZ2U6IFswLCAxXSxcbiAgICAgIHVuaXQ6IDEwLFxuICAgIH0sXG4gICAgcG92ZXJ0eToge1xuICAgICAgdmFsdWVzOiBkaW1lbnNpb25zLmZpbHRlcigoZCkgPT4gZC5zdGFydHNXaXRoKFwicG92ZXJ0eVwiKSksXG4gICAgICByYW5nZTogWzAsIDFdLFxuICAgICAgdW5pdDogXCJwZXJjZW50X05vRGVjaW1hbFwiLFxuICAgIH0sXG4gICAgZWR1Y2F0aW9uOiB7XG4gICAgICB2YWx1ZXM6IGRpbWVuc2lvbnMuZmlsdGVyKChkKSA9PiBkLnN0YXJ0c1dpdGgoXCJlZHVjYXRpb25cIikpLFxuICAgICAgcmFuZ2U6IFswLCAxM10sXG4gICAgICB1bml0OiBcInRvdGFsXCIsXG4gICAgfSxcbiAgfTtcblxuICAvLyBGbGF0dGVuIHRoZSBjYXRlZ29yaWVzIGludG8gYSBzaW5nbGUgYXJyYXksIGFkZGluZyBnYXBzIGJldHdlZW4gZ3JvdXBzXG4gIGNvbnN0IGdyb3VwZWREaW1lbnNpb25zID0gW1xuICAgIC4uLmNhdGVnb3JpZXMuZ2VuZGVyLnZhbHVlcyxcbiAgICAuLi5jYXRlZ29yaWVzLnBvdmVydHkudmFsdWVzLFxuICAgIC4uLmNhdGVnb3JpZXMuZWR1Y2F0aW9uLnZhbHVlcyxcbiAgXTtcblxuICAvLyBEZWZpbmUgdGhlIHggc2NhbGUsIHdpdGggbGFyZ2VyIHNwYWNpbmcgZm9yIHRoZSBnYXBzXG4gIGNvbnN0IHggPSBkM1xuICAgIC5zY2FsZVBvaW50KClcbiAgICAuZG9tYWluKGdyb3VwZWREaW1lbnNpb25zKVxuICAgIC5yYW5nZShbbWFyZ2luLmxlZnQsIHdpZHRoIC0gbWFyZ2luLnJpZ2h0XSlcbiAgICAucGFkZGluZygwLjMpOyAvLyBBZGQgZXh0cmEgcGFkZGluZyBmb3IgdGhlIGdhcHNcblxuICBjb25zdCB5ID0ge307XG4gIGZvciAoY29uc3QgZGltIG9mIGdyb3VwZWREaW1lbnNpb25zKSB7XG4gICAgbGV0IGdyb3VwID0gZGltLnNwbGl0KFwiLVwiKVswXTtcbiAgICBsZXQgeV9leHRlbnQgPSBjYXRlZ29yaWVzW2dyb3VwXS5yYW5nZTtcbiAgICB5W2RpbV0gPSBkM1xuICAgICAgLnNjYWxlTGluZWFyKClcbiAgICAgIC5kb21haW4oeV9leHRlbnQpXG4gICAgICAucmFuZ2UoW2hlaWdodCAtIG1hcmdpbi5ib3R0b20sIG1hcmdpbi50b3BdKTtcbiAgfVxuXG4gIGQzLnNlbGVjdEFsbChcIi5QYXJhbGxlbENvb3JkVGlwXCIpLnJlbW92ZSgpO1xuICBjb25zdCB0b29sdGlwID0gZDNcbiAgICAuc2VsZWN0KFwiYm9keVwiKVxuICAgIC5hcHBlbmQoXCJkaXZcIilcbiAgICAuYXR0cihcImNsYXNzXCIsIFwicGxvdFRvb2x0aXAgUGFyYWxsZWxDb29yZFRpcFwiKVxuICAgIC5zdHlsZShcInBvc2l0aW9uXCIsIFwiYWJzb2x1dGVcIik7XG5cbiAgLy8gQ3JlYXRlIGNpcmNsZXMgZm9yIGVhY2ggZGF0YSBwb2ludFxuICBncm91cGVkRGltZW5zaW9ucy5mb3JFYWNoKChkaW0pID0+IHtcbiAgICBpZiAoZGltID09PSBcIlwiKSByZXR1cm47IC8vIFNraXAgZ2Fwc1xuXG4gICAgc3ZnXG4gICAgICAuc2VsZWN0QWxsKGAuZG90LSR7ZGltfWApXG4gICAgICAuZGF0YShkYXRhX3Z1bG4pXG4gICAgICAuam9pbihcImNpcmNsZVwiKVxuICAgICAgLmF0dHIoXG4gICAgICAgIFwiY2xhc3NcIixcbiAgICAgICAgKGQpID0+IGBkb3QtJHtkaW19IGNvdW50cnktJHtkLmNvdW50cnkucmVwbGFjZSgvXFxzKy9nLCBcIi1cIil9YCxcbiAgICAgIClcbiAgICAgIC5hdHRyKFwiY3hcIiwgKCkgPT4geChkaW0pICsgaml0dGVyKCkpXG4gICAgICAuYXR0cihcImN5XCIsIChkKSA9PiB7XG4gICAgICAgIHJldHVybiB5W2RpbV0oZFtkaW1dKTtcbiAgICAgIH0pXG4gICAgICAuYXR0cihcInJcIiwgNSlcbiAgICAgIC5zdHlsZShcImZpbGxcIiwgXCJsaWdodGdyZXlcIilcbiAgICAgIC5zdHlsZShcIm9wYWNpdHlcIiwgMC41KVxuICAgICAgLm9uKFwibW91c2VvdmVyXCIsIGZ1bmN0aW9uIChldmVudCwgZCkge1xuICAgICAgICBzdmdcbiAgICAgICAgICAuc2VsZWN0QWxsKGAuY291bnRyeS0ke2QuY291bnRyeS5yZXBsYWNlKC9cXHMrL2csIFwiLVwiKX1gKVxuICAgICAgICAgIC5hdHRyKFwiclwiLCA4KVxuICAgICAgICAgIC5zdHlsZShcIm9wYWNpdHlcIiwgMSlcbiAgICAgICAgICAuc3R5bGUoXCJmaWxsXCIsIChkKSA9PiBjb2xvcihkLmNvdW50cnkpKVxuICAgICAgICAgIC5yYWlzZSgpO1xuICAgICAgICB0b29sdGlwXG4gICAgICAgICAgLnN0eWxlKFwidG9wXCIsIGV2ZW50LnBhZ2VZIC0gMSArIFwicHhcIilcbiAgICAgICAgICAuc3R5bGUoXCJsZWZ0XCIsIGV2ZW50LnBhZ2VYICsgMSArIFwicHhcIilcbiAgICAgICAgICAuc3R5bGUoXCJvcGFjaXR5XCIsIDAuOClcbiAgICAgICAgICAuc3R5bGUoXCJkaXNwbGF5XCIsIFwiYmxvY2tcIilcbiAgICAgICAgICAuaHRtbCgoKSA9PiB7XG4gICAgICAgICAgICBsZXQgYWRtaW5fc3RyaW5nID0gZC5jb3VudHJ5O1xuICAgICAgICAgICAgbGV0IGFkbWluX25hbWVzID0gYWRtaW5fc3RyaW5nLnNwbGl0KFwiX1wiKTtcbiAgICAgICAgICAgIGxldCBhZG1pbjBfbmFtZSA9IGFkbWluX25hbWVzWzBdO1xuICAgICAgICAgICAgbGV0IGFkbWluX2pvaW4gPSBhZG1pbl9uYW1lc1xuICAgICAgICAgICAgICAuZmlsdGVyKChuYW1lKSA9PiBuYW1lICE9PSBcIm51bGxcIilcbiAgICAgICAgICAgICAgLmpvaW4oXCIsIFwiKTtcbiAgICAgICAgICAgIGxldCBzcGxpdFZhciA9IGRpbS5zcGxpdChcIi1cIik7XG4gICAgICAgICAgICBsZXQgdmFybmFtZSA9IF9sYW5nKG5iVGV4dC5nZW5lcmFsLmFjVmFyc1tzcGxpdFZhclsxXV0pO1xuICAgICAgICAgICAgbGV0IHZhclZhbHVlID0gZm9ybWF0X3ZhbChkW2RpbV0sIGNhdGVnb3JpZXNbc3BsaXRWYXJbMF1dLnVuaXQpO1xuICAgICAgICAgICAgcmV0dXJuIGAke2FkbWluX2pvaW59PGJyLz4ke3Zhcm5hbWV9OiAke3ZhclZhbHVlfWA7XG4gICAgICAgICAgfSk7XG4gICAgICAgIC8vIC5odG1sKGAke2QuY291bnRyeX08YnIvPiR7ZGltfTogJHtkW2RpbV0udG9GaXhlZCgyKX1gKTtcbiAgICAgIH0pXG4gICAgICAub24oXCJtb3VzZW91dFwiLCBmdW5jdGlvbiAoZXZlbnQsIGQpIHtcbiAgICAgICAgc3ZnXG4gICAgICAgICAgLnNlbGVjdEFsbChgLmNvdW50cnktJHtkLmNvdW50cnkucmVwbGFjZSgvXFxzKy9nLCBcIi1cIil9YClcbiAgICAgICAgICAuYXR0cihcInJcIiwgNSlcbiAgICAgICAgICAuc3R5bGUoXCJvcGFjaXR5XCIsIDAuNSlcbiAgICAgICAgICAuc3R5bGUoXCJmaWxsXCIsIFwibGlnaHRncmV5XCIpXG4gICAgICAgICAgLmxvd2VyKCk7XG4gICAgICAgIHRvb2x0aXAuc3R5bGUoXCJkaXNwbGF5XCIsIFwibm9uZVwiKTtcbiAgICAgIH0pO1xuICB9KTtcblxuICAvLyBBZGQgYXZlcmFnZSBwb2ludHNcbiAgbGV0IGF2Z19wb2ludHMgPSBzdmdcbiAgICAuc2VsZWN0QWxsKFwiLmF2Zy1kb3RcIilcbiAgICAuZGF0YShncm91cGVkRGltZW5zaW9ucylcbiAgICAuZW50ZXIoKVxuICAgIC5hcHBlbmQoXCJjaXJjbGVcIilcbiAgICAuYXR0cihcImNsYXNzXCIsIFwiYXZnLWRvdFwiKVxuICAgIC5hdHRyKFwiY3hcIiwgKGQpID0+IHgoZCkpXG4gICAgLmF0dHIoXCJjeVwiLCAoZCkgPT4geVtkXShtZWFuc1swXVtkXSkpXG4gICAgLmF0dHIoXCJyXCIsIDcpXG4gICAgLnN0eWxlKFwiZmlsbFwiLCBcIiMyRTc2MzZcIilcbiAgICAuc3R5bGUoXCJzdHJva2VcIiwgXCJ3aGl0ZVwiKVxuICAgIC5zdHlsZShcInN0cm9rZS13aWR0aFwiLCAyKTtcblxuICBhdmdfcG9pbnRzXG4gICAgLm9uKFwibW91c2VvdmVyXCIsIGZ1bmN0aW9uIChldmVudCwgZCkge1xuICAgICAgc3ZnLnNlbGVjdEFsbChgLmF2Zy1kb3RgKS5yYWlzZSgpO1xuICAgICAgdG9vbHRpcFxuICAgICAgICAuc3R5bGUoXCJ0b3BcIiwgZXZlbnQucGFnZVkgLSAxICsgXCJweFwiKVxuICAgICAgICAuc3R5bGUoXCJsZWZ0XCIsIGV2ZW50LnBhZ2VYICsgMSArIFwicHhcIilcbiAgICAgICAgLnN0eWxlKFwib3BhY2l0eVwiLCAwLjgpXG4gICAgICAgIC5zdHlsZShcImRpc3BsYXlcIiwgXCJibG9ja1wiKVxuICAgICAgICAuaHRtbCgoKSA9PiB7XG4gICAgICAgICAgbGV0IGFkbWluX25hbWUgPSBtZWFucy5jb3VudHJ5O1xuICAgICAgICAgIGxldCBzcGxpdFZhciA9IGQuc3BsaXQoXCItXCIpO1xuICAgICAgICAgIGxldCB2YXJuYW1lID0gX2xhbmcobmJUZXh0LmdlbmVyYWwuYWNWYXJzW3NwbGl0VmFyWzFdXSk7XG4gICAgICAgICAgbGV0IHZhclZhbHVlID0gZm9ybWF0X3ZhbChtZWFuc1swXVtkXSwgY2F0ZWdvcmllc1tzcGxpdFZhclswXV0udW5pdCk7XG4gICAgICAgICAgcmV0dXJuIGAke2FkbWluX25hbWV9PGJyLz4ke3Zhcm5hbWV9OiAke3ZhclZhbHVlfWA7XG4gICAgICAgIH0pO1xuICAgICAgLy8gLmh0bWwoYCR7ZC5jb3VudHJ5fTxici8+JHtkaW19OiAke2RbZGltXS50b0ZpeGVkKDIpfWApO1xuICAgIH0pXG4gICAgLm9uKFwibW91c2VvdXRcIiwgZnVuY3Rpb24gKGV2ZW50LCBkKSB7XG4gICAgICBzdmcuc2VsZWN0QWxsKGAuYXZnLWRvdGApO1xuICAgICAgLy8gLmxvd2VyKCk7XG4gICAgICB0b29sdGlwLnN0eWxlKFwiZGlzcGxheVwiLCBcIm5vbmVcIik7XG4gICAgfSk7XG5cbiAgc3ZnXG4gICAgLnNlbGVjdEFsbChcIm15QXhpc1wiKVxuICAgIC5kYXRhKGdyb3VwZWREaW1lbnNpb25zKVxuICAgIC5lbnRlcigpXG4gICAgLmFwcGVuZChcImdcIilcbiAgICAuYXR0cihcInRyYW5zZm9ybVwiLCAoZCkgPT4gXCJ0cmFuc2xhdGUoXCIgKyB4KGQpICsgXCIpXCIpXG4gICAgLmF0dHIoXCJwb2ludGVyLWV2ZW50c1wiLCBcIm5vbmVcIilcbiAgICAuZWFjaChmdW5jdGlvbiAoZCkge1xuICAgICAgbGV0IGdyb3VwID0gZC5zcGxpdChcIi1cIilbMF07XG4gICAgICBkMy5zZWxlY3QodGhpcykuY2FsbChcbiAgICAgICAgZDNcbiAgICAgICAgICAuYXhpc0xlZnQoKVxuICAgICAgICAgIC5zY2FsZSh5W2RdKVxuICAgICAgICAgIC50aWNrRm9ybWF0KCh2KSA9PiBmb3JtYXRfdmFsKHYsIGNhdGVnb3JpZXNbZ3JvdXBdLnVuaXQpKSxcbiAgICAgICk7XG4gICAgfSlcbiAgICAuYXBwZW5kKFwidGV4dFwiKVxuICAgIC5zdHlsZShcInRleHQtYW5jaG9yXCIsIFwibWlkZGxlXCIpXG4gICAgLmF0dHIoXCJ5XCIsIChkLCBpKSA9PiB7XG4gICAgICByZXR1cm4gaSAlIDIgPT09IDAgPyBtYXJnaW4udG9wIC0gMTAgOiBoZWlnaHQgLSBtYXJnaW4uYm90dG9tICsgMjA7XG4gICAgfSlcbiAgICAudGV4dCgoZCkgPT4ge1xuICAgICAgbGV0IHNwbGl0ID0gZC5zcGxpdChcIi1cIik7XG4gICAgICBsZXQgY2xlYW5fdGV4dCA9IF9sYW5nKG5iVGV4dC5nZW5lcmFsLmFjVmFyc1tzcGxpdFsxXV0pO1xuICAgICAgcmV0dXJuIGNsZWFuX3RleHQ7XG4gICAgfSlcbiAgICAuc3R5bGUoXCJmaWxsXCIsIFwiYmxhY2tcIilcbiAgICAuc3R5bGUoXCJmb250LXNpemVcIiwgXCIxMnB4XCIpO1xuXG4gIGNvbnN0IGxlZ2VuZFggPSAxMDtcbiAgY29uc3QgbGVnZW5kWSA9IDU7XG5cbiAgY29uc3QgbGVnZW5kID0gc3ZnXG4gICAgLmFwcGVuZChcImdcIilcbiAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBgdHJhbnNsYXRlKCR7bGVnZW5kWH0sICR7bGVnZW5kWX0pYCk7XG5cbiAgbGVnZW5kXG4gICAgLmFwcGVuZChcImNpcmNsZVwiKVxuICAgIC5hdHRyKFwiY3hcIiwgMTApXG4gICAgLmF0dHIoXCJjeVwiLCAxMClcbiAgICAuYXR0cihcInJcIiwgNylcbiAgICAuc3R5bGUoXCJmaWxsXCIsIFwiIzJFNzYzNlwiKTtcblxuICAvLyBBcHBlbmQgdGV4dCBuZXh0IHRvIHRoZSBkb3RcbiAgbGVnZW5kXG4gICAgLmFwcGVuZChcInRleHRcIilcbiAgICAuYXR0cihcInhcIiwgMjApXG4gICAgLmF0dHIoXCJ5XCIsIDE1KVxuICAgIC5zdHlsZShcImZvbnQtc2l6ZVwiLCBcIjEycHhcIilcbiAgICAuc3R5bGUoXCJmaWxsXCIsIFwiIzAwMFwiKVxuICAgIC50ZXh0KFwiUmVnaW9uYWwgQXZlcmFnZVwiKTtcblxuICByZXR1cm4gc3ZnLm5vZGUoKTtcblxuICBmdW5jdGlvbiBwaXZvdERhdGEoZGF0YSkge1xuICAgIGNvbnN0IHBpdm90ZWREYXRhID0ge307XG5cbiAgICBkYXRhLmZvckVhY2goKHJvdykgPT4ge1xuICAgICAgLy8gVXNlIGEgZGVmYXVsdCB2YWx1ZSBmb3IgYW55IG1pc3NpbmcgKE5VTEwpIGFkbWluIGZpZWxkXG4gICAgICBjb25zdCBhZG1pbjAgPSByb3cuYWRtaW4wX25hbWU7XG4gICAgICBjb25zdCBhZG1pbjEgPSByb3cuYWRtaW4xX25hbWU7IC8vfHwgXCJcIjtcbiAgICAgIGNvbnN0IGFkbWluMiA9IHJvdy5hZG1pbjJfbmFtZTsgLy98fCBcIlwiXG5cbiAgICAgIC8vIENyZWF0ZSBhIHVuaXF1ZSBrZXkgZm9yIGVhY2ggY29tYmluYXRpb24gb2YgYWRtaW4wLCBhZG1pbjEsIGFkbWluMiwgYWRtaW4zXG4gICAgICBjb25zdCBjb3VudHJ5ID0gYCR7YWRtaW4wfV8ke2FkbWluMX1fJHthZG1pbjJ9YDtcblxuICAgICAgaWYgKCFwaXZvdGVkRGF0YVtjb3VudHJ5XSkge1xuICAgICAgICBwaXZvdGVkRGF0YVtjb3VudHJ5XSA9IHsgY291bnRyeSB9O1xuICAgICAgfVxuXG4gICAgICBsZXQgY29tYmluZWRfbmFtZSA9IHJvdy5ncm91cCArIFwiLVwiICsgcm93LnZhcmlhYmxlO1xuICAgICAgcGl2b3RlZERhdGFbY291bnRyeV1bY29tYmluZWRfbmFtZV0gPSByb3cudmFsdWU7XG4gICAgfSk7XG5cbiAgICAvLyBSZXR1cm4gdGhlIHBpdm90ZWQgZGF0YSBhcyBhbiBhcnJheSBvZiBvYmplY3RzXG4gICAgcmV0dXJuIE9iamVjdC52YWx1ZXMocGl2b3RlZERhdGEpO1xuICB9XG5cbiAgZnVuY3Rpb24gY2FsY3VsYXRlTWVhbnMoZGF0YSkge1xuICAgIGNvbnN0IGdyb3VwZWREYXRhID0ge307XG5cbiAgICBkYXRhLmZvckVhY2goKHJvdykgPT4ge1xuICAgICAgbGV0IGNvbWJpbmVkX25hbWUgPSByb3cuZ3JvdXAgKyBcIi1cIiArIHJvdy52YXJpYWJsZTtcbiAgICAgIGlmICghZ3JvdXBlZERhdGFbY29tYmluZWRfbmFtZV0pIHtcbiAgICAgICAgZ3JvdXBlZERhdGFbY29tYmluZWRfbmFtZV0gPSBbXTtcbiAgICAgIH1cbiAgICAgIGdyb3VwZWREYXRhW2NvbWJpbmVkX25hbWVdLnB1c2gocm93LnZhbHVlKTtcbiAgICB9KTtcblxuICAgIGNvbnN0IG1lYW5zID0ge307XG4gICAgZm9yIChjb25zdCBbdmFyaWFibGUsIHZhbHVlc10gb2YgT2JqZWN0LmVudHJpZXMoZ3JvdXBlZERhdGEpKSB7XG4gICAgICBjb25zdCBzdW0gPSB2YWx1ZXMucmVkdWNlKChhY2MsIHZhbCkgPT4gYWNjICsgdmFsLCAwKTtcbiAgICAgIG1lYW5zW3ZhcmlhYmxlXSA9IHN1bSAvIHZhbHVlcy5sZW5ndGg7XG4gICAgfVxuXG4gICAgcmV0dXJuIFttZWFuc107XG4gIH1cbn07XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTEyMCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InBhcmFsbGVsQ29vcmRpbmF0ZXNTY2F0dGVyUGxvdCA9IGFzeW5jICgpID0+IHtcbiAgY29uc3QgbWFyZ2luID0geyB0b3A6IDYwLCByaWdodDogODAsIGJvdHRvbTogNTUsIGxlZnQ6IDc1IH0sXG4gICAgd2lkdGggPSAxMDAwLFxuICAgIGhlaWdodCA9IDYwMDtcblxuICBsZXQgZ3JvdXBfcXVlcnkgPSBgQU5EIFwiZ3JvdXBcIiBpbiAoJHtcbiAgICBcIidcIiArXG4gICAgRGF0YVNlbGVjdG9yX2Zvcm0udnVsbmVyYWJpbGl0eUdyb3VwX2Zvcm0udnVsbmVyYWJpbGl0eV9zZWxcbiAgICAgIC5qb2luKFwiJywgJ1wiKVxuICAgICAgLnRvTG93ZXJDYXNlKCkgK1xuICAgIFwiJ1wiXG4gIH0pYDtcblxuICBsZXQgZGF0YSA9IGF3YWl0IGRiLnF1ZXJ5KFxuICAgIGBTRUxFQ1QgXCJhZG1pbjBfbmFtZVwiLCBcImFkbWluMV9uYW1lXCIsIFwiYWRtaW4yX25hbWVcIiwgXCJncm91cFwiLCBcInZhcmlhYmxlXCIsIFwidmFsdWVcIlxuICAgICBGUk9NIFZ1bG5lcmFiaWxpdHkgXG4gICAgICR7cGxvdFF1ZXJ5Ml9hZG1pbn1cbiAgICAgQU5EIFwidmFyaWFibGVcIiAhPSAnR2VuZGVyRXF1aXR5XzE5OTUuMjAxNSdcbiAgICAgJHtncm91cF9xdWVyeX1gLFxuICApO1xuXG4gIGNvbnN0IGRhdGFfdnVsbiA9IHBpdm90RGF0YShkYXRhKTtcblxuICBkYXRhX3Z1bG4uZm9yRWFjaCgoZW50cnkpID0+IHtcbiAgICBPYmplY3Qua2V5cyhlbnRyeSkuZm9yRWFjaCgoa2V5KSA9PiB7XG4gICAgICBpZiAoa2V5LnN0YXJ0c1dpdGgoXCJwb3ZlcnR5LVwiKSkge1xuICAgICAgICBlbnRyeVtrZXldID0gMSAtIGVudHJ5W2tleV07IC8vIEludmVydCB2YWx1ZVxuICAgICAgfVxuICAgIH0pO1xuICB9KTtcblxuICBsZXQgbWVhbnMgPSBjYWxjdWxhdGVNZWFucyhkYXRhX3Z1bG4pO1xuXG4gIG1lYW5zLmNvdW50cnkgPSBcIlJlZ2lvbmFsIEF2ZXJhZ2VcIjtcblxuICBjb25zdCBkaW1lbnNpb25zID0gT2JqZWN0LmtleXMoZGF0YV92dWxuWzBdKS5maWx0ZXIoKGQpID0+IGQgIT09IFwiY291bnRyeVwiKTtcbiAgY29uc3Qgaml0dGVyID0gZDMucmFuZG9tVW5pZm9ybSgtMTUsIDE1KTtcblxuICBjb25zdCBjb2xvcl9kZXAgPSBkM1xuICAgIC5zY2FsZU9yZGluYWwoKVxuICAgIC5kb21haW4oZGF0YV92dWxuLm1hcCgoZCkgPT4gZC5jb3VudHJ5KSlcbiAgICAucmFuZ2UoZDMuc2NoZW1lQ2F0ZWdvcnkxMCk7XG5cbiAgY29uc3Qgc3ZnID0gZDNcbiAgICAuY3JlYXRlKFwic3ZnXCIpXG4gICAgLmF0dHIoXCJpZFwiLCBcIlZ1bG5lcmFibGVQYXJhbGxlbFNjYXR0ZXJcIilcbiAgICAuYXR0cihcInZpZXdCb3hcIiwgWzAsIDAsIHdpZHRoLCBoZWlnaHRdKVxuICAgIC5hdHRyKFwid2lkdGhcIiwgd2lkdGgpXG4gICAgLmF0dHIoXCJoZWlnaHRcIiwgaGVpZ2h0KTtcblxuICAvLyBEZWZpbmUgdGhlIHZhcmlhYmxlIGNhdGVnb3JpZXMgKGdlbmRlciwgcG92ZXJ0eSwgZWR1Y2F0aW9uKVxuICBjb25zdCBjYXRlZ29yaWVzID0ge1xuICAgIGdlbmRlcjoge1xuICAgICAgdmFsdWVzOiBkaW1lbnNpb25zLmZpbHRlcigoZCkgPT4gZC5zdGFydHNXaXRoKFwiZ2VuZGVyXCIpKSxcbiAgICAgIHJhbmdlOiBbMCwgMV0sXG4gICAgICB1bml0OiAxMDAsXG4gICAgICBjb2xvcjogXCJibGFja1wiLFxuICAgIH0sXG4gICAgcG92ZXJ0eToge1xuICAgICAgdmFsdWVzOiBkaW1lbnNpb25zLmZpbHRlcigoZCkgPT4gZC5zdGFydHNXaXRoKFwicG92ZXJ0eVwiKSksXG4gICAgICByYW5nZTogWzAsIDFdLFxuICAgICAgdW5pdDogXCJwZXJjZW50X05vRGVjaW1hbFwiLFxuICAgICAgY29sb3I6IFwiYmxhY2tcIixcbiAgICB9LFxuICAgIGVkdWNhdGlvbjoge1xuICAgICAgdmFsdWVzOiBkaW1lbnNpb25zLmZpbHRlcigoZCkgPT4gZC5zdGFydHNXaXRoKFwiZWR1Y2F0aW9uXCIpKSxcbiAgICAgIHJhbmdlOiBbMCwgMTNdLFxuICAgICAgdW5pdDogXCJ0b3RhbFwiLFxuICAgICAgY29sb3I6IFwiYmxhY2tcIixcbiAgICB9LFxuICB9O1xuXG4gIGNvbnN0IGNvbG9yID0gKGdyb3VwLCB2YWx1ZSkgPT4ge1xuICAgIC8vIGxldCBjb2xvcl9yYW5nZSA9IGdyb3VwID09PSAncG92ZXJ0eScgPyBbJ2dyZWVuJywgJ3JlZCddIDogWydyZWQnLCAnZ3JlZW4nXVxuICAgIGxldCBjb2xvcl9yYW5nZSA9IFtcInJlZFwiLCBcImdyZWVuXCJdO1xuICAgIHJldHVybiBkMy5zY2FsZUxpbmVhcigpLmRvbWFpbihjYXRlZ29yaWVzW2dyb3VwXS5yYW5nZSkucmFuZ2UoY29sb3JfcmFuZ2UpKFxuICAgICAgdmFsdWUsXG4gICAgKTtcbiAgfTtcblxuICAvLyBGbGF0dGVuIHRoZSBjYXRlZ29yaWVzIGludG8gYSBzaW5nbGUgYXJyYXksIGFkZGluZyBnYXBzIGJldHdlZW4gZ3JvdXBzXG4gIGNvbnN0IGdyb3VwZWREaW1lbnNpb25zID0gW1xuICAgIC4uLmNhdGVnb3JpZXMuZ2VuZGVyLnZhbHVlcy5zb3J0KCksXG4gICAgLi4uY2F0ZWdvcmllcy5wb3ZlcnR5LnZhbHVlcy5zb3J0KCksXG4gICAgLi4uY2F0ZWdvcmllcy5lZHVjYXRpb24udmFsdWVzLnNvcnQoKSxcbiAgXTtcblxuICBjb25zdCB4ID0gZDNcbiAgICAuc2NhbGVQb2ludCgpXG4gICAgLmRvbWFpbihncm91cGVkRGltZW5zaW9ucylcbiAgICAucmFuZ2UoW21hcmdpbi5sZWZ0LCB3aWR0aCAtIG1hcmdpbi5yaWdodF0pO1xuXG4gIGNvbnN0IHlfZ3JvdXAgPSB7XG4gICAgZ2VuZGVyOiBkM1xuICAgICAgLnNjYWxlTGluZWFyKClcbiAgICAgIC5kb21haW4oY2F0ZWdvcmllcy5nZW5kZXIucmFuZ2UpXG4gICAgICAucmFuZ2UoW2hlaWdodCAtIG1hcmdpbi5ib3R0b20sIG1hcmdpbi50b3BdKSxcbiAgICBwb3ZlcnR5OiBkM1xuICAgICAgLnNjYWxlTGluZWFyKClcbiAgICAgIC5kb21haW4oY2F0ZWdvcmllcy5wb3ZlcnR5LnJhbmdlKVxuICAgICAgLnJhbmdlKFtoZWlnaHQgLSBtYXJnaW4uYm90dG9tLCBtYXJnaW4udG9wXSksXG4gICAgZWR1Y2F0aW9uOiBkM1xuICAgICAgLnNjYWxlTGluZWFyKClcbiAgICAgIC5kb21haW4oY2F0ZWdvcmllcy5lZHVjYXRpb24ucmFuZ2UpXG4gICAgICAucmFuZ2UoW2hlaWdodCAtIG1hcmdpbi5ib3R0b20sIG1hcmdpbi50b3BdKSxcbiAgfTtcblxuICBjb25zdCB5ID0ge307XG4gIGdyb3VwZWREaW1lbnNpb25zXG4gICAgLmZpbHRlcigoZCkgPT4gZCAhPT0gXCJcIilcbiAgICAuZm9yRWFjaCgoZGltKSA9PiB7XG4gICAgICBsZXQgZ3JvdXAgPSBkaW0uc3BsaXQoXCItXCIpWzBdO1xuICAgICAgY29uc29sZS5sb2coZ3JvdXApO1xuICAgICAgbGV0IHlfZXh0ZW50ID0gY2F0ZWdvcmllc1tncm91cF0ucmFuZ2U7XG4gICAgICB5W2RpbV0gPSBkM1xuICAgICAgICAuc2NhbGVMaW5lYXIoKVxuICAgICAgICAuZG9tYWluKHlfZXh0ZW50KVxuICAgICAgICAucmFuZ2UoW2hlaWdodCAtIG1hcmdpbi5ib3R0b20sIG1hcmdpbi50b3BdKTtcbiAgICB9KTtcblxuICBkMy5zZWxlY3RBbGwoXCIuUGFyYWxsZWxDb29yZFRpcFwiKS5yZW1vdmUoKTtcbiAgY29uc3QgdG9vbHRpcCA9IGQzXG4gICAgLnNlbGVjdChcImJvZHlcIilcbiAgICAuYXBwZW5kKFwiZGl2XCIpXG4gICAgLmF0dHIoXCJjbGFzc1wiLCBcInBsb3RUb29sdGlwIFBhcmFsbGVsQ29vcmRUaXBcIilcbiAgICAuc3R5bGUoXCJwb3NpdGlvblwiLCBcImFic29sdXRlXCIpO1xuXG4gIC8vIENyZWF0ZSBjaXJjbGVzIGZvciBlYWNoIGRhdGEgcG9pbnRcbiAgZ3JvdXBlZERpbWVuc2lvbnNcbiAgICAuZmlsdGVyKChkKSA9PiBkICE9PSBcIlwiKVxuICAgIC5mb3JFYWNoKChkaW0pID0+IHtcbiAgICAgIGxldCBzcGxpdFZhciA9IGRpbS5zcGxpdChcIi1cIik7XG4gICAgICBsZXQgdmFybmFtZSA9IF9sYW5nKFxuICAgICAgICBuYlRleHQuVmlld0V4cGxvcmUucGFyYWxsZWxDb29yZHMuYWNWYXJzW3NwbGl0VmFyWzFdXSxcbiAgICAgICk7XG4gICAgICBsZXQgZ3JvdXAgPSBzcGxpdFZhclswXTtcbiAgICAgIHN2Z1xuICAgICAgICAuc2VsZWN0QWxsKGAuZG90LSR7ZGltfWApXG4gICAgICAgIC5kYXRhKGRhdGFfdnVsbilcbiAgICAgICAgLmpvaW4oXCJjaXJjbGVcIilcbiAgICAgICAgLmF0dHIoXG4gICAgICAgICAgXCJjbGFzc1wiLFxuICAgICAgICAgIChkKSA9PiBgZG90LSR7ZGltfSBjb3VudHJ5LSR7ZC5jb3VudHJ5LnJlcGxhY2UoL1xccysvZywgXCItXCIpfWAsXG4gICAgICAgIClcbiAgICAgICAgLmF0dHIoXCJjeFwiLCAoKSA9PiB4KGRpbSkgKyBqaXR0ZXIoKSlcbiAgICAgICAgLmF0dHIoXCJjeVwiLCAoZCkgPT4ge1xuICAgICAgICAgIHJldHVybiB5W2RpbV0oZFtkaW1dKTtcbiAgICAgICAgfSlcbiAgICAgICAgLmF0dHIoXCJyXCIsIDUpXG4gICAgICAgIC8vIC5zdHlsZShcImZpbGxcIiwgJ2xpZ2h0Z3JleScpXG4gICAgICAgIC5zdHlsZShcImZpbGxcIiwgKGQpID0+IGNvbG9yKGdyb3VwLCBkW2RpbV0pKVxuICAgICAgICAuc3R5bGUoXCJvcGFjaXR5XCIsIDAuMSlcbiAgICAgICAgLm9uKFwibW91c2VvdmVyXCIsIGZ1bmN0aW9uIChldmVudCwgZCkge1xuICAgICAgICAgIHN2Z1xuICAgICAgICAgICAgLnNlbGVjdEFsbChgLmNvdW50cnktJHtkLmNvdW50cnkucmVwbGFjZSgvXFxzKy9nLCBcIi1cIil9YClcbiAgICAgICAgICAgIC5hdHRyKFwiclwiLCA4KVxuICAgICAgICAgICAgLnN0eWxlKFwib3BhY2l0eVwiLCAxKVxuICAgICAgICAgICAgLnJhaXNlKCk7XG4gICAgICAgICAgY29uc29sZS5sb2coXCJ0dGlwXCIsIGAubGVnZW5kLSR7Z3JvdXB9YCk7XG4gICAgICAgICAgc3ZnLnNlbGVjdEFsbChgLmxlZ2VuZC0ke2dyb3VwfWApLnN0eWxlKFwib3BhY2l0eVwiLCAxKTtcbiAgICAgICAgICB0b29sdGlwXG4gICAgICAgICAgICAuc3R5bGUoXCJ0b3BcIiwgZXZlbnQucGFnZVkgLSAxICsgXCJweFwiKVxuICAgICAgICAgICAgLnN0eWxlKFwibGVmdFwiLCBldmVudC5wYWdlWCArIDEgKyBcInB4XCIpXG4gICAgICAgICAgICAuc3R5bGUoXCJvcGFjaXR5XCIsIDAuOClcbiAgICAgICAgICAgIC5zdHlsZShcImRpc3BsYXlcIiwgXCJibG9ja1wiKVxuICAgICAgICAgICAgLmh0bWwoKCkgPT4ge1xuICAgICAgICAgICAgICBsZXQgYWRtaW5fc3RyaW5nID0gZC5jb3VudHJ5O1xuICAgICAgICAgICAgICBsZXQgYWRtaW5fbmFtZXMgPSBhZG1pbl9zdHJpbmcuc3BsaXQoXCJfXCIpO1xuICAgICAgICAgICAgICBhZG1pbl9uYW1lc1swXSA9XG4gICAgICAgICAgICAgICAgX2xhbmcobmJUZXh0LmdlbmVyYWwuYWRtaW5OYW1lc1thZG1pbl9uYW1lc1swXV0pIHx8XG4gICAgICAgICAgICAgICAgYWRtaW5fbmFtZXNbMF07XG4gICAgICAgICAgICAgIC8vIGxldCBhZG1pbjBfbmFtZSA9IF9sYW5nKG5iVGV4dC5nZW5lcmFsLmFkbWluTmFtZXNbYWRtaW5fbmFtZXNbMF1dKVxuICAgICAgICAgICAgICBsZXQgYWRtaW5fam9pbiA9IGFkbWluX25hbWVzXG4gICAgICAgICAgICAgICAgLmZpbHRlcigobmFtZSkgPT4gbmFtZSAhPT0gXCJudWxsXCIpXG4gICAgICAgICAgICAgICAgLmpvaW4oXCIsIFwiKTtcbiAgICAgICAgICAgICAgbGV0IHZhclZhbHVlID0gZm9ybWF0X3ZhbChkW2RpbV0sIGNhdGVnb3JpZXNbZ3JvdXBdLnVuaXQpO1xuICAgICAgICAgICAgICByZXR1cm4gYCR7YWRtaW5fam9pbn08YnIvPiR7dmFybmFtZX06ICR7dmFyVmFsdWV9YDtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIC8vIC5odG1sKGAke2QuY291bnRyeX08YnIvPiR7ZGltfTogJHtkW2RpbV0udG9GaXhlZCgyKX1gKTtcbiAgICAgICAgfSlcbiAgICAgICAgLm9uKFwibW91c2VvdXRcIiwgZnVuY3Rpb24gKGV2ZW50LCBkKSB7XG4gICAgICAgICAgc3ZnXG4gICAgICAgICAgICAuc2VsZWN0QWxsKGAuY291bnRyeS0ke2QuY291bnRyeS5yZXBsYWNlKC9cXHMrL2csIFwiLVwiKX1gKVxuICAgICAgICAgICAgLmF0dHIoXCJyXCIsIDUpXG4gICAgICAgICAgICAuc3R5bGUoXCJvcGFjaXR5XCIsIDAuMSlcbiAgICAgICAgICAgIC5sb3dlcigpO1xuXG4gICAgICAgICAgc3ZnLnNlbGVjdEFsbChgLmxlZ2VuZC0ke2dyb3VwfWApLnN0eWxlKFwib3BhY2l0eVwiLCAwLjUpO1xuICAgICAgICAgIHRvb2x0aXAuc3R5bGUoXCJkaXNwbGF5XCIsIFwibm9uZVwiKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgLy8gQWRkIGF2ZXJhZ2UgcG9pbnRzXG4gIGxldCBhdmdfcG9pbnRzID0gc3ZnXG4gICAgLnNlbGVjdEFsbChcIi5hdmctZG90XCIpXG4gICAgLmRhdGEoZ3JvdXBlZERpbWVuc2lvbnMuZmlsdGVyKChkKSA9PiBkICE9PSBcIlwiKSlcbiAgICAuZW50ZXIoKVxuICAgIC5hcHBlbmQoXCJjaXJjbGVcIilcbiAgICAuYXR0cihcImNsYXNzXCIsIFwiYXZnLWRvdFwiKVxuICAgIC5hdHRyKFwiY3hcIiwgKGQpID0+IHgoZCkpXG4gICAgLmF0dHIoXCJjeVwiLCAoZCkgPT4geVtkXShtZWFuc1swXVtkXSkpXG4gICAgLmF0dHIoXCJyXCIsIDcpXG4gICAgLnN0eWxlKFwiZmlsbFwiLCBcImdyZXlcIilcbiAgICAvLyAuc3R5bGUoXCJmaWxsXCIsIFwiIzJFNzYzNlwiKVxuICAgIC5zdHlsZShcInN0cm9rZVwiLCBcIndoaXRlXCIpXG4gICAgLnN0eWxlKFwic3Ryb2tlLXdpZHRoXCIsIDIpO1xuXG4gIGF2Z19wb2ludHNcbiAgICAub24oXCJtb3VzZW92ZXJcIiwgZnVuY3Rpb24gKGV2ZW50LCBkKSB7XG4gICAgICBsZXQgc3BsaXRWYXIgPSBkLnNwbGl0KFwiLVwiKTtcbiAgICAgIGxldCB2YXJuYW1lID0gX2xhbmcoXG4gICAgICAgIG5iVGV4dC5WaWV3RXhwbG9yZS5wYXJhbGxlbENvb3Jkcy5hY1ZhcnNbc3BsaXRWYXJbMV1dLFxuICAgICAgKTtcbiAgICAgIGxldCBncm91cCA9IHNwbGl0VmFyWzBdO1xuICAgICAgc3ZnLnNlbGVjdEFsbChgLmF2Zy1kb3RgKS5hdHRyKFwiclwiLCA4KS5yYWlzZSgpO1xuICAgICAgc3ZnLnNlbGVjdEFsbChgLmxlZ2VuZC0ke2dyb3VwfWApLnN0eWxlKFwib3BhY2l0eVwiLCAxKTtcbiAgICAgIHRvb2x0aXBcbiAgICAgICAgLnN0eWxlKFwidG9wXCIsIGV2ZW50LnBhZ2VZIC0gMSArIFwicHhcIilcbiAgICAgICAgLnN0eWxlKFwibGVmdFwiLCBldmVudC5wYWdlWCArIDEgKyBcInB4XCIpXG4gICAgICAgIC5zdHlsZShcIm9wYWNpdHlcIiwgMC44KVxuICAgICAgICAuc3R5bGUoXCJkaXNwbGF5XCIsIFwiYmxvY2tcIilcbiAgICAgICAgLmh0bWwoKCkgPT4ge1xuICAgICAgICAgIGxldCBhZG1pbl9uYW1lID0gbWVhbnMuY291bnRyeTsgLy8gVE9ETzogTGFuZyBhZGQgaGVyZVxuICAgICAgICAgIGxldCB2YXJWYWx1ZSA9IGZvcm1hdF92YWwobWVhbnNbMF1bZF0sIGNhdGVnb3JpZXNbZ3JvdXBdLnVuaXQpO1xuICAgICAgICAgIHJldHVybiBgJHthZG1pbl9uYW1lfTxici8+JHt2YXJuYW1lfTogJHt2YXJWYWx1ZX1gO1xuICAgICAgICB9KTtcbiAgICAgIC8vIC5odG1sKGAke2QuY291bnRyeX08YnIvPiR7ZGltfTogJHtkW2RpbV0udG9GaXhlZCgyKX1gKTtcbiAgICB9KVxuICAgIC5vbihcIm1vdXNlb3V0XCIsIGZ1bmN0aW9uIChldmVudCwgZCkge1xuICAgICAgc3ZnLnNlbGVjdEFsbChgLmxlZ2VuZC0ke2Quc3BsaXQoXCItXCIpWzBdfWApLnN0eWxlKFwib3BhY2l0eVwiLCAxKTtcbiAgICAgIHN2Zy5zZWxlY3RBbGwoYC5hdmctZG90YCkuYXR0cihcInJcIiwgNyk7XG4gICAgICAvLyAubG93ZXIoKTtcbiAgICAgIHRvb2x0aXAuc3R5bGUoXCJkaXNwbGF5XCIsIFwibm9uZVwiKTtcbiAgICB9KTtcblxuICBPYmplY3Qua2V5cyhjYXRlZ29yaWVzKS5mb3JFYWNoKChjYXQpID0+IHtcbiAgICBzdmdcbiAgICAgIC5hcHBlbmQoXCJnXCIpXG4gICAgICAuYXR0cihcImNsYXNzXCIsIGBsZWdlbmQtJHtjYXR9YClcbiAgICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIGB0cmFuc2xhdGUoJHt4KGNhdGVnb3JpZXNbY2F0XS52YWx1ZXNbMF0pIC0gMjB9LDApYClcbiAgICAgIC5zdHlsZShcIm9wYWNpdHlcIiwgMC41KVxuICAgICAgLmNhbGwoXG4gICAgICAgIGQzXG4gICAgICAgICAgLmF4aXNMZWZ0KHlfZ3JvdXBbY2F0XSlcbiAgICAgICAgICAudGlja0Zvcm1hdCgodikgPT4gZm9ybWF0X3ZhbCh2LCBjYXRlZ29yaWVzW2NhdF0udW5pdCkpLFxuICAgICAgKVxuICAgICAgLmNhbGwoKGcpID0+IHtcbiAgICAgICAgZy5zZWxlY3RBbGwoXCIudGljayB0ZXh0XCIpLmF0dHIoXCJmaWxsXCIsIGNhdGVnb3JpZXNbY2F0XS5jb2xvcik7XG4gICAgICAgIGcuc2VsZWN0QWxsKFwiLnRpY2sgbGluZVwiKS5hdHRyKFwic3Ryb2tlXCIsIGNhdGVnb3JpZXNbY2F0XS5jb2xvcik7XG4gICAgICAgIGcuc2VsZWN0KFwiLmRvbWFpblwiKS5hdHRyKFwic3Ryb2tlXCIsIGNhdGVnb3JpZXNbY2F0XS5jb2xvcik7IC8vIEF4aXMgbGluZSBjb2xvclxuICAgICAgfSk7XG4gICAgLy8gLmFwcGVuZChcInRleHRcIikgIC8vIFZlcnRpY2FsIHRpdGxlXG4gICAgLy8gLmF0dHIoXCJ4XCIsIC00MClcbiAgICAvLyAuYXR0cihcInlcIiwgKGhlaWdodCAvIDIpKVxuICAgIC8vIC5hdHRyKFwidGV4dC1hbmNob3JcIiwgXCJtaWRkbGVcIilcbiAgICAvLyAuYXR0cihcInRyYW5zZm9ybVwiLCBgcm90YXRlKC05MCwgLTQwLCAke2hlaWdodCAvIDJ9KWApXG4gICAgLy8gLnN0eWxlKFwiZm9udC1zaXplXCIsIFwiMTRweFwiKVxuICAgIC8vIC5zdHlsZShcImZpbGxcIiwgY2F0ZWdvcmllc1tjYXRdLmNvbG9yKVxuICAgIC8vIC50ZXh0KGAke0xhbmcudG9TZW50ZW5jZUNhc2UoY2F0KX0gVmFyaWFibGVzYClcbiAgfSk7XG5cbiAgc3ZnXG4gICAgLnNlbGVjdEFsbChcIm15QXhpc1wiKVxuICAgIC5kYXRhKGdyb3VwZWREaW1lbnNpb25zKVxuICAgIC5lbnRlcigpXG4gICAgLmFwcGVuZChcImdcIilcbiAgICAuYXR0cihcInRyYW5zZm9ybVwiLCAoZCkgPT4gXCJ0cmFuc2xhdGUoXCIgKyB4KGQpICsgXCIpXCIpXG4gICAgLmF0dHIoXCJwb2ludGVyLWV2ZW50c1wiLCBcIm5vbmVcIilcbiAgICAuYXBwZW5kKFwidGV4dFwiKVxuICAgIC5zdHlsZShcInRleHQtYW5jaG9yXCIsIFwibWlkZGxlXCIpXG4gICAgLmF0dHIoXCJ5XCIsIChkLCBpKSA9PiB7XG4gICAgICByZXR1cm4gaSAlIDIgPT09IDAgPyBtYXJnaW4udG9wIC0gMTAgOiBoZWlnaHQgLSBtYXJnaW4uYm90dG9tICsgMjA7XG4gICAgfSlcbiAgICAudGV4dCgoZCkgPT4ge1xuICAgICAgbGV0IHNwbGl0ID0gZC5zcGxpdChcIi1cIik7XG4gICAgICBsZXQgY2xlYW5fdGV4dCA9IF9sYW5nKFxuICAgICAgICBuYlRleHQuVmlld0V4cGxvcmUucGFyYWxsZWxDb29yZHMuYWNWYXJzW3NwbGl0WzFdXSxcbiAgICAgICk7XG4gICAgICByZXR1cm4gY2xlYW5fdGV4dDtcbiAgICB9KVxuICAgIC5zdHlsZShcImZpbGxcIiwgKGQpID0+IHtcbiAgICAgIHJldHVybiBjYXRlZ29yaWVzW2Quc3BsaXQoXCItXCIpWzBdXS5jb2xvcjtcbiAgICB9KVxuICAgIC5zdHlsZShcImZvbnQtc2l6ZVwiLCBcIjEwcHhcIik7XG5cbiAgY29uc3QgZG90TGVnZW5kWCA9IDEwO1xuICBjb25zdCBkb3RMZWdlbmRZID0gNTtcblxuICBjb25zdCBsZWdlbmQgPSBzdmdcbiAgICAuYXBwZW5kKFwiZ1wiKVxuICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIGB0cmFuc2xhdGUoJHtkb3RMZWdlbmRYfSwgJHtkb3RMZWdlbmRZfSlgKTtcblxuICBsZWdlbmRcbiAgICAuYXBwZW5kKFwiY2lyY2xlXCIpXG4gICAgLmF0dHIoXCJjeFwiLCAxMClcbiAgICAuYXR0cihcImN5XCIsIDEwKVxuICAgIC5hdHRyKFwiclwiLCA4KVxuICAgIC5zdHlsZShcImZpbGxcIiwgXCJncmV5XCIpO1xuXG4gIC8vIEFwcGVuZCB0ZXh0IG5leHQgdG8gdGhlIGRvdFxuICBsZWdlbmRcbiAgICAuYXBwZW5kKFwidGV4dFwiKVxuICAgIC5hdHRyKFwieFwiLCAyMylcbiAgICAuYXR0cihcInlcIiwgMTUpXG4gICAgLnN0eWxlKFwiZm9udC1zaXplXCIsIFwiMTNweFwiKVxuICAgIC5zdHlsZShcImZpbGxcIiwgXCIjMDAwXCIpXG4gICAgLnRleHQoX2xhbmcobmJUZXh0LmdlbmVyYWwucmVnaW9uYWxBdmcpKTtcblxuICAvLyBBZGQgbGluZXMgYW5kIHRpdGxlcyBmb3IgZWFjaCBncm91cFxuICBhZGRHcm91cFRpdGxlTGluZShcImdlbmRlclwiLCBcIkdlbmRlclwiLCBjYXRlZ29yaWVzLmdlbmRlci5jb2xvcik7XG4gIGFkZEdyb3VwVGl0bGVMaW5lKFwicG92ZXJ0eVwiLCBcIlBvdmVydHlcIiwgY2F0ZWdvcmllcy5wb3ZlcnR5LmNvbG9yKTtcbiAgYWRkR3JvdXBUaXRsZUxpbmUoXCJlZHVjYXRpb25cIiwgXCJFZHVjYXRpb25cIiwgY2F0ZWdvcmllcy5lZHVjYXRpb24uY29sb3IpO1xuXG4gIC8vLy8gQWRkIGEgbGVnZW5kIGZyb20gcmVkIHRvIGdyZWVuXG4gIGNvbnN0IGdyYWRpZW50V2lkdGggPSAyNTA7XG4gIGNvbnN0IGdyYWRpZW50SGVpZ2h0ID0gMTU7XG4gIGNvbnN0IGxlZ2VuZFggPSB3aWR0aCAvIDIgLSAxMjU7XG4gIGNvbnN0IGxlZ2VuZFkgPSA1O1xuXG4gIC8vIEFwcGVuZCBhIGRlZnMgZWxlbWVudCBmb3IgdGhlIGdyYWRpZW50XG4gIGNvbnN0IGRlZnMgPSBzdmcuYXBwZW5kKFwiZGVmc1wiKTtcblxuICBjb25zdCBsaW5lYXJHcmFkaWVudCA9IGRlZnNcbiAgICAuYXBwZW5kKFwibGluZWFyR3JhZGllbnRcIilcbiAgICAuYXR0cihcImlkXCIsIFwiQUNsaW5lYXItZ3JhZGllbnRcIik7XG5cbiAgLy8gbGluZWFyR3JhZGllbnRcbiAgLy8gICAuYXBwZW5kKCdzdG9wJylcbiAgLy8gICAgIC5zZWxlY3RBbGwoXCJzdG9wXCIpXG4gIC8vICAgICAuZGF0YShbbWluVmFsdWUsIG1heFZhbHVlXSlcbiAgLy8gICAgIC5qb2luKFwic3RvcFwiKVxuICAvLyAgICAgLmF0dHIoXCJvZmZzZXRcIiwgKGQsIGksIG4pID0+IGAkeygxMDAgKiBpKSAvIChuLmxlbmd0aCAtIDEpfSVgKVxuICAvLyAgICAgLmF0dHIoXCJzdG9wLWNvbG9yXCIsIGNvbG9yKTtcblxuICBsaW5lYXJHcmFkaWVudC5hcHBlbmQoXCJzdG9wXCIpLmF0dHIoXCJvZmZzZXRcIiwgXCIwJVwiKS5hdHRyKFwic3RvcC1jb2xvclwiLCBcInJlZFwiKTtcblxuICBsaW5lYXJHcmFkaWVudFxuICAgIC5hcHBlbmQoXCJzdG9wXCIpXG4gICAgLmF0dHIoXCJvZmZzZXRcIiwgXCIxMDAlXCIpXG4gICAgLmF0dHIoXCJzdG9wLWNvbG9yXCIsIFwiZ3JlZW5cIik7XG5cbiAgLy8gRHJhdyB0aGUgcmVjdGFuZ2xlIHVzaW5nIHRoZSBncmFkaWVudFxuICBzdmdcbiAgICAuYXBwZW5kKFwicmVjdFwiKVxuICAgIC5hdHRyKFwieFwiLCBsZWdlbmRYKVxuICAgIC5hdHRyKFwieVwiLCBsZWdlbmRZKVxuICAgIC5hdHRyKFwid2lkdGhcIiwgZ3JhZGllbnRXaWR0aClcbiAgICAuYXR0cihcImhlaWdodFwiLCBncmFkaWVudEhlaWdodClcbiAgICAuc3R5bGUoXCJmaWxsXCIsIFwidXJsKCNBQ2xpbmVhci1ncmFkaWVudClcIik7XG5cbiAgLy8gQWRkIGxhYmVscyBmb3IgdGhlIGdyYWRpZW50XG4gIHN2Z1xuICAgIC5hcHBlbmQoXCJ0ZXh0XCIpXG4gICAgLmF0dHIoXCJ4XCIsIGxlZ2VuZFggLSA1KVxuICAgIC5hdHRyKFwieVwiLCBsZWdlbmRZICsgZ3JhZGllbnRIZWlnaHQgLyAyICsgNSlcbiAgICAuYXR0cihcInRleHQtYW5jaG9yXCIsIFwiZW5kXCIpXG4gICAgLnN0eWxlKFwiZm9udC1zaXplXCIsIFwiMTJweFwiKVxuICAgIC50ZXh0KFwiTG93IGFkYXB0aXZlIGNhcGFjaXR5XCIpO1xuXG4gIHN2Z1xuICAgIC5hcHBlbmQoXCJ0ZXh0XCIpXG4gICAgLmF0dHIoXCJ4XCIsIGxlZ2VuZFggKyBncmFkaWVudFdpZHRoICsgNSlcbiAgICAuYXR0cihcInlcIiwgbGVnZW5kWSArIGdyYWRpZW50SGVpZ2h0IC8gMiArIDUpXG4gICAgLmF0dHIoXCJ0ZXh0LWFuY2hvclwiLCBcInN0YXJ0XCIpXG4gICAgLnN0eWxlKFwiZm9udC1zaXplXCIsIFwiMTNweFwiKVxuICAgIC50ZXh0KFwiSGlnaCBhZGFwdGl2ZSBjYXBhY2l0eVwiKTtcblxuICByZXR1cm4gc3ZnLm5vZGUoKTtcblxuICAvLy8vLyBIZWxwZXIgRnVuY3Rpb25zIC8vLy8vL1xuXG4gIGZ1bmN0aW9uIHBpdm90RGF0YShkYXRhKSB7XG4gICAgY29uc3QgcGl2b3RlZERhdGEgPSB7fTtcblxuICAgIGRhdGEuZm9yRWFjaCgocm93KSA9PiB7XG4gICAgICAvLyBVc2UgYSBkZWZhdWx0IHZhbHVlIGZvciBhbnkgbWlzc2luZyAoTlVMTCkgYWRtaW4gZmllbGRcbiAgICAgIGNvbnN0IGFkbWluMCA9IHJvdy5hZG1pbjBfbmFtZTtcbiAgICAgIGNvbnN0IGFkbWluMSA9IHJvdy5hZG1pbjFfbmFtZTsgLy98fCBcIlwiO1xuICAgICAgY29uc3QgYWRtaW4yID0gcm93LmFkbWluMl9uYW1lOyAvL3x8IFwiXCJcblxuICAgICAgLy8gQ3JlYXRlIGEgdW5pcXVlIGtleSBmb3IgZWFjaCBjb21iaW5hdGlvbiBvZiBhZG1pbjAsIGFkbWluMSwgYWRtaW4yLCBhZG1pbjNcbiAgICAgIGNvbnN0IGNvdW50cnkgPSBgJHthZG1pbjB9XyR7YWRtaW4xfV8ke2FkbWluMn1gO1xuXG4gICAgICBpZiAoIXBpdm90ZWREYXRhW2NvdW50cnldKSB7XG4gICAgICAgIHBpdm90ZWREYXRhW2NvdW50cnldID0geyBjb3VudHJ5IH07XG4gICAgICB9XG5cbiAgICAgIGxldCBjb21iaW5lZF9uYW1lID0gcm93Lmdyb3VwICsgXCItXCIgKyByb3cudmFyaWFibGU7XG4gICAgICBwaXZvdGVkRGF0YVtjb3VudHJ5XVtjb21iaW5lZF9uYW1lXSA9IHJvdy52YWx1ZTtcbiAgICB9KTtcblxuICAgIC8vIFJldHVybiB0aGUgcGl2b3RlZCBkYXRhIGFzIGFuIGFycmF5IG9mIG9iamVjdHNcbiAgICByZXR1cm4gT2JqZWN0LnZhbHVlcyhwaXZvdGVkRGF0YSk7XG4gIH1cblxuICBmdW5jdGlvbiBjYWxjdWxhdGVNZWFucyhkYXRhKSB7XG4gICAgY29uc3QgZ3JvdXBlZERhdGEgPSB7fTtcbiAgICBkYXRhLmZvckVhY2goKHJvdykgPT4ge1xuICAgICAgLy8gTG9vcCB0aHJvdWdoIGVhY2gga2V5IGluIHRoZSBvYmplY3QgKGlnbm9yaW5nIHRoZSAnY291bnRyeScga2V5KVxuICAgICAgT2JqZWN0LmtleXMocm93KS5mb3JFYWNoKChrZXkpID0+IHtcbiAgICAgICAgaWYgKGtleSAhPT0gXCJjb3VudHJ5XCIpIHtcbiAgICAgICAgICBpZiAoIWdyb3VwZWREYXRhW2tleV0pIHtcbiAgICAgICAgICAgIGdyb3VwZWREYXRhW2tleV0gPSBbXTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZ3JvdXBlZERhdGFba2V5XS5wdXNoKHJvd1trZXldKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBjb25zdCBtZWFucyA9IHt9O1xuICAgIGZvciAoY29uc3QgW3ZhcmlhYmxlLCB2YWx1ZXNdIG9mIE9iamVjdC5lbnRyaWVzKGdyb3VwZWREYXRhKSkge1xuICAgICAgY29uc3Qgc3VtID0gdmFsdWVzLnJlZHVjZSgoYWNjLCB2YWwpID0+IGFjYyArIHZhbCwgMCk7XG4gICAgICBtZWFuc1t2YXJpYWJsZV0gPSBzdW0gLyB2YWx1ZXMubGVuZ3RoO1xuICAgIH1cblxuICAgIHJldHVybiBbbWVhbnNdO1xuICB9XG5cbiAgZnVuY3Rpb24gYWRkR3JvdXBUaXRsZUxpbmUoZ3JvdXAsIGdyb3VwTGFiZWwsIGNvbG9yKSB7XG4gICAgY29uc3QgZ3JvdXBWYWx1ZXMgPSBjYXRlZ29yaWVzW2dyb3VwXS52YWx1ZXM7XG4gICAgbGV0IGdyb3VwU3RhcnQgPSB4KGdyb3VwVmFsdWVzWzBdKSAtIDE1O1xuICAgIGxldCBncm91cEVuZCA9IHgoZ3JvdXBWYWx1ZXNbZ3JvdXBWYWx1ZXMubGVuZ3RoIC0gMV0pICsgMTU7XG5cbiAgICBpZiAoZ3JvdXBTdGFydCA9PT0gZ3JvdXBFbmQpIHtcbiAgICAgIGdyb3VwU3RhcnQgPSBncm91cFN0YXJ0IC0gMjU7XG4gICAgICBncm91cEVuZCA9IGdyb3VwU3RhcnQgKyAyNTtcbiAgICB9XG4gICAgc3ZnXG4gICAgICAuYXBwZW5kKFwibGluZVwiKVxuICAgICAgLmF0dHIoXCJ4MVwiLCBncm91cFN0YXJ0KVxuICAgICAgLmF0dHIoXCJ4MlwiLCBncm91cEVuZClcbiAgICAgIC5hdHRyKFwieTFcIiwgaGVpZ2h0IC0gMjApXG4gICAgICAuYXR0cihcInkyXCIsIGhlaWdodCAtIDIwKVxuICAgICAgLmF0dHIoXCJzdHJva2VcIiwgY29sb3IpXG4gICAgICAuYXR0cihcInN0cm9rZS13aWR0aFwiLCAyKTtcblxuICAgIC8vIEFwcGVuZCB0aGUgZ3JvdXAgbGFiZWwgY2VudGVyZWQgb24gdGhlIGxpbmVcbiAgICBzdmdcbiAgICAgIC5hcHBlbmQoXCJ0ZXh0XCIpXG4gICAgICAuYXR0cihcInhcIiwgKGdyb3VwU3RhcnQgKyBncm91cEVuZCkgLyAyKSAvLyBDZW50ZXIgdGhlIHRpdGxlIGJldHdlZW4gc3RhcnQgYW5kIGVuZFxuICAgICAgLmF0dHIoXCJ5XCIsIGhlaWdodCAtIDUpIC8vIFBvc2l0aW9uIHRoZSB0aXRsZSBhYm92ZSB0aGUgbGluZVxuICAgICAgLmF0dHIoXCJ0ZXh0LWFuY2hvclwiLCBcIm1pZGRsZVwiKVxuICAgICAgLnN0eWxlKFwiZm9udC1zaXplXCIsIFwiMTRweFwiKVxuICAgICAgLnN0eWxlKFwiZm9udC13ZWlnaHRcIiwgXCJib2xkXCIpXG4gICAgICAuc3R5bGUoXCJmaWxsXCIsIGNvbG9yKVxuICAgICAgLnRleHQoZ3JvdXBMYWJlbCk7XG4gIH1cbn07XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTEyMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IlRvb2x0aXBDU1MgPSBodG1sYDxzdHlsZT5cbi5wbG90VG9vbHRpcCB7XG4gIHBhZGRpbmc6IDEwcHggMTBweDtcbiAgY29sb3I6IGJsYWNrO1xuICBib3JkZXItcmFkaXVzOiA0cHg7XG4gIGJvcmRlcjogMXB4IHNvbGlkIHJnYmEoMCwwLDAsMSk7XG4gIHBvaW50ZXItZXZlbnRzOiBub25lO1xuICB0cmFuc2Zvcm06IHRyYW5zbGF0ZSgtNTAlLCAtMTAwJSk7XG4gIGZvbnQtZmFtaWx5OiBcIklCTSBQbGV4IFNhbnNcIiwgXCJTb3VyY2UgU2VyaWYgUHJvXCI7XG4gIGZvbnQtc2l6ZTogMTRweDtcbiAgYmFja2dyb3VuZDogcmdiYSgyNTUsMjU1LDI1NSwgMSk7XG4gIHRyYW5zaXRpb246IDAuM3Mgb3BhY2l0eSBlYXNlLW91dCwgMC4xcyBib3JkZXItY29sb3IgZWFzZS1vdXQ7XG4gIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgZGlzcGxheTogbm9uZTtcbn1cblxuLnBsb3RUb29sdGlwOjpiZWZvcmUge1xuICBjb250ZW50OiBcIlwiO1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIHRvcDogMTAwJTtcbiAgbGVmdDogNTAlO1xuICBtYXJnaW4tbGVmdDogLTVweDtcbiAgYm9yZGVyLXdpZHRoOiA1cHg7XG4gIGJvcmRlci1zdHlsZTogc29saWQ7XG4gIGJvcmRlci1jb2xvcjogYmxhY2sgdHJhbnNwYXJlbnQgdHJhbnNwYXJlbnQgdHJhbnNwYXJlbnQ7XG59XG5cbi5wbG90VG9vbHRpcDo6YWZ0ZXIge1xuICBjb250ZW50OiBcIlwiO1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIHRvcDogY2FsYygxMDAlIC0gMXB4KTtcbiAgbGVmdDogNTAlO1xuICBtYXJnaW4tbGVmdDogLTQuOXB4O1xuICBib3JkZXItd2lkdGg6IDQuOXB4O1xuICBib3JkZXItc3R5bGU6IHNvbGlkO1xuICBib3JkZXItY29sb3I6IHdoaXRlIHRyYW5zcGFyZW50IHRyYW5zcGFyZW50IHRyYW5zcGFyZW50O1xufVxuPC9zdHlsZT5gO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xMjIiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJmdW5jdGlvbiB0b2NPbmVsaW5lcih7XG4gIHNlbGVjdG9yID0gXCJoMVwiLCAvLyBzZWxlY3RvcnMgdG8gaW5jbHVkZSAoY2FuIGNvbW1hLXNlcGFyYXRlLCBsaWtlIFwiaDEsaDIsaDNcIilcbiAgaGVhZGluZyA9IFwiPGI+SW4gdGhpcyBub3RlYm9vazwvYj5cIiwgLy8gaGVhZGluZyBmb3IgVG9DXG4gIGRlbGltID0gXCImbmJzcDt8Jm5ic3A7XCIsIC8vIGRlbGltaXRlciBiZXR3ZWVuIGxpbmtzXG4gIHNraXAgPSBbXSwgLy8gdGV4dCBjb250ZW50IGZvciBoZWFkZXJzIHRvIGV4Y2x1ZGVcbn0gPSB7fSkge1xuICAvLyByZXR1cm4gYSBvbmUtbGluZXIgdGFibGUgb2YgY29udGVudHNcbiAgLy8gYWxsb3cgZm9yIHNraXBzXG4gIC8vIG1vZGlmaWVkIGZyb20gaHR0cHM6Ly9vYnNlcnZhYmxlaHEuY29tL0BtYm9zdG9jay90b2NcblxuICByZXR1cm4gR2VuZXJhdG9ycy5vYnNlcnZlKChub3RpZnkpID0+IHtcbiAgICBsZXQgaGVhZGluZ3MgPSBbXTtcblxuICAgIGZ1bmN0aW9uIG9ic2VydmVkKCkge1xuICAgICAgbGV0IGggPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3IpKTtcbiAgICAgIGggPSBoLmZpbHRlcigoZCkgPT4gIXNraXAuaW5jbHVkZXMoZC50ZXh0Q29udGVudCkpO1xuICAgICAgaWYgKGgubGVuZ3RoICE9PSBoZWFkaW5ncy5sZW5ndGggfHwgaC5zb21lKChoLCBpKSA9PiBoZWFkaW5nc1tpXSAhPT0gaCkpIHtcbiAgICAgICAgbm90aWZ5KFxuICAgICAgICAgIGh0bWxgJHtoZWFkaW5nfTxicj4ke0FycmF5LmZyb20oKGhlYWRpbmdzID0gaCksIChoLCBpKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBlbmQgPSBpID09PSBoZWFkaW5ncy5sZW5ndGggLSAxO1xuICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oXG4gICAgICAgICAgICAgIGh0bWxgPGEgaHJlZj0jJHtoLmlkfT4ke0RPTS50ZXh0KGgudGV4dENvbnRlbnQpfTwvYT4ke1xuICAgICAgICAgICAgICAgIGVuZCA/IFwiXCIgOiBkZWxpbVxuICAgICAgICAgICAgICB9YCxcbiAgICAgICAgICAgICAgeyBvbmNsaWNrOiAoZSkgPT4gKGUucHJldmVudERlZmF1bHQoKSwgaC5zY3JvbGxJbnRvVmlldygpKSB9LFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9KX1gLFxuICAgICAgICApO1xuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IG9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIob2JzZXJ2ZWQpO1xuICAgIG9ic2VydmVyLm9ic2VydmUoZG9jdW1lbnQuYm9keSwgeyBjaGlsZExpc3Q6IHRydWUsIHN1YnRyZWU6IHRydWUgfSk7XG4gICAgb2JzZXJ2ZWQoKTtcbiAgICByZXR1cm4gKCkgPT4gb2JzZXJ2ZXIuZGlzY29ubmVjdCgpO1xuICB9KTtcbn1cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTIzIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoibWRgIyMgTGFuZ3VhZ2UgYW5kIFRyYW5zbGF0aW9uIHRvb2xzYDtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTI0IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiaW1wb3J0IHsgTGFuZyB9IGZyb20gXCI3ZDQ2Njc5ZjdkMGQ5MTdlXCI7XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTEyNSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Il9sYW5nID0gTGFuZy5sZyhsYW5ndWFnZS5rZXkpO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xMjYiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJsYW5ndWFnZXMgPSBbXG4gIHsga2V5OiBcImVuXCIsIGxhYmVsOiBcIkVuZ2xpc2hcIiwgbG9jYWxlOiBcImVuLVVTXCIgfSxcbiAgeyBrZXk6IFwiZnJcIiwgbGFiZWw6IFwiRnJhbsOnYWlzXCIsIGxvY2FsZTogXCJmci1GUlwiIH0sXG5dO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xMjciLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJkZWZhdWx0TGFuZ0tleSA9IHtcbiAgY29uc3QgbmFtZSA9IFwibGFuZ1wiO1xuICBjb25zdCBsaXN0ID0gbGFuZ3VhZ2VzLm1hcCgoZCkgPT4gZC5rZXkpO1xuICBjb25zdCBkZWZhdWx0S2V5ID0gXCJlblwiO1xuXG4gIGNvbnN0IHF1ZXJ5UGFyYW0gPSBhd2FpdCBMYW5nLmdldFBhcmFtRnJvbUxpc3QoeyBuYW1lLCBsaXN0IH0pO1xuXG4gIHJldHVybiBxdWVyeVBhcmFtID8/IGRlZmF1bHRLZXk7XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTEyOCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InZpZXdvZiBsYW5ndWFnZSA9IElucHV0cy5yYWRpbyhsYW5ndWFnZXMsIHtcbiAgbGFiZWw6IFwiTWFpbiBsYW5ndWFnZSB0b2dnbGVcIixcbiAgZm9ybWF0OiAoZCkgPT4gZC5rZXksXG4gIHZhbHVlOiBsYW5ndWFnZXMuZmluZCgoeCkgPT4geC5rZXkgPT09IGRlZmF1bHRMYW5nS2V5KSxcbn0pXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTEyOSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Im5iVGV4dCA9IG5ldyBPYmplY3Qoe1xuICBuYlRpdGxlOiB7IGVuOiBcIkV4cGxvcmUgVGhlIERhdGFzZXRzXCIsIGZyOiBcIkV4cGxvcmV6IGxlcyBkb25uw6llc1wiIH0sXG4gIHRvYzoge1xuICAgIHRpdGxlOiB7IGVuOiBcIkluIHRoaXMgbm90ZWJvb2tcIiwgZnI6IFwiRGFucyBjZSBub3RlYm9va1wiIH0sXG4gIH0sXG4gIG92ZXJ2aWV3OiB7XG4gICAgdGl0bGU6IHsgZW46IFwiT3ZlcnZpZXdcIiwgZnI6IFwiVnVlIGTigJlFbnNlbWJsZVwiIH0sXG4gICAgc3ViVGl0bGU6IHtcbiAgICAgIGVuOiBgRXhwbG9yZSBhbmQgZXhwb3J0IHRoZSBkYXRhIGluIHRoZSBbQWRhcHRhdGlvbiBBdGxhc10oaHR0cHM6Ly9hZGFwdGF0aW9uYXRsYXMuY2dpYXIub3JnKWAsXG4gICAgICBmcjogYEV4cGxvcmV6IGV0IGV4cG9ydGV6IGxlcyBkb25uw6llcyBkZSBbTOKAmUFkYXB0YXRpb24gbCdBdGxhc10oaHR0cHM6Ly9hZGFwdGF0aW9uYXRsYXMuY2dpYXIub3JnKWAsXG4gICAgfSxcbiAgICB0ZXh0OiB7XG4gICAgICBlbjogXCJUaGlzIG5vdGVib29rIGVuYWJsZXMgeW91IHRvIGV4cGxvcmUgYW5kIGRvd25sb2FkIHRoZSBkYXRhIHRoYXQgdW5kZXJwaW5zIG11Y2ggb2YgdGhlIGFuYWx5c2lzIHdpdGhpbiB0aGUgQWZyaWNhbiBBZ3JpY3VsdHVyYWwgQWRhcHRhdGlvbiBBdGxhcy4gRmlsdGVyIGFuZCBleHBvcnQgdGhlIGRhdGEgaW4gbXVsdGlwbGUgZm9ybWF0cyB0byBwZXJmb3JtIGV4dGVybmFsIGFuYWx5c2lzIG9yIHVzZSB0aGUgdGFibGVzIGFuZCBwbG90cyBpbiB0aGlzIG5vdGVib29rIHRvIGdhaW4gaW5zaWdodHMgaW50byBicm9hZCBjb250aW5lbnRhbCB0cmVuZHMgb3IgcmVnaW9uLXNwZWNpZmljIHN0YXRpc3RpY3MuXCIsXG4gICAgICBmcjogXCJDZSBub3RlYm9vayB2b3VzIHBlcm1ldCBkJ2V4cGxvcmVyIGV0IGRlIHTDqWzDqWNoYXJnZXIgbGVzIGRvbm7DqWVzIHF1aSBjb25zdGl0dWVudCBsYSBiYXNlIGTigJl1bmUgZ3JhbmRlIHBhcnRpZSBkZSBsJ2FuYWx5c2UgYXUgc2VpbiBkZSBBZnJpY2FuIEFncmljdWx0dXJhbCBBZGFwdGF0aW9uIEF0bGFzLiBGaWx0cmV6IGV0IGV4cG9ydGV6IGxlcyBkb25uw6llcyBkYW5zIHBsdXNpZXVycyBmb3JtYXRzIHBvdXIgZWZmZWN0dWVyIGRlcyBhbmFseXNlcyBleHRlcm5lcyBvdSB1dGlsaXNleiBsZXMgdGFibGVhdXggZXQgZ3JhcGhpcXVlcyBkZSBjZSBub3RlYm9vayBwb3VyIG9idGVuaXIgZGVzIGFwZXLDp3VzIHN1ciBsZXMgdGVuZGFuY2VzIGNvbnRpbmVudGFsZXMgZ8OpbsOpcmFsZXMgb3UgbGVzIHN0YXRpc3RpcXVlcyBzcMOpY2lmaXF1ZXMgw6AgdW5lIHLDqWdpb24uXCIsXG4gICAgfSxcbiAgfSxcbiAgc2VsZWN0Q2F0ZWdvcnk6IHtcbiAgICB0aXRsZV9tYWluOiB7XG4gICAgICBlbjogXCJEZWZpbmUgVGhlIERhdGEgRm9jdXNcIixcbiAgICAgIGZyOiBcIkTDqWZpbmlyIGxlIGZvY3VzIGRlcyBkb25uw6llc1wiLFxuICAgIH0sXG4gICAgdGl0bGU6IHsgZW46IFwiU2VsZWN0IEEgQ2F0ZWdvcnlcIiwgZnI6IFwiU8OpbGVjdGlvbm5leiB1bmUgY2F0w6lnb3JpZVwiIH0sXG4gICAgdGV4dDoge1xuICAgICAgZW46IFwiQ2hvb3NlIGJldHdlZW4gdGhlc2UgY2F0ZWdvcmllczogSGF6YXJkLCBBZGFwdGl2ZSBDYXBhY2l0eSwgYW5kIEV4cG9zdXJlLiBUaGVzZSB0aHJlZSBjYXRlZ29yaWVzIGFyZSBlc3NlbnRpYWwgZm9yIGEgY29tcHJlaGVuc2l2ZSB1bmRlcnN0YW5kaW5nIG9mIGNsaW1hdGUgcmlzaywgZW5hYmxpbmcgZWZmZWN0aXZlIGFzc2Vzc21lbnQgYW5kIG1hbmFnZW1lbnQgc3RyYXRlZ2llcy5cIixcbiAgICAgIGZyOiBcIkNob2lzaXNzZXogcGFybWkgY2VzIGNhdMOpZ29yaWVzIDogQWzDqWEsIENhcGFjaXTDqSBkJ2FkYXB0YXRpb24gZXQgRXhwb3NpdGlvbi4gQ2VzIHRyb2lzIGNhdMOpZ29yaWVzIHNvbnQgZXNzZW50aWVsbGVzIHBvdXIgdW5lIGNvbXByw6loZW5zaW9uIGdsb2JhbGUgZHUgcmlzcXVlIGNsaW1hdGlxdWUsIHBlcm1ldHRhbnQgZGVzIHN0cmF0w6lnaWVzIGQnw6l2YWx1YXRpb24gZXQgZGUgZ2VzdGlvbiBlZmZpY2FjZXMuXCIsXG4gICAgfSxcbiAgICBzZWxlY3Rvcjoge1xuICAgICAgdGl0bGU6IHsgZW46IFwiQ2F0ZWdvcnlcIiwgZnI6IFwiQ2F0w6lnb3JpZSBcIiB9LFxuICAgICAgb3B0aW9uczoge1xuICAgICAgICBIYXphcmQ6IHtcbiAgICAgICAgICB0aXRsZTogeyBlbjogXCJIYXphcmRcIiwgZnI6IFwiQWzDqWFcIiB9LFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiB7XG4gICAgICAgICAgICBlbjogXCJDbGltYXRlIEhhemFyZHMgaW5jbHVkZSBpbmRpdmlkdWFsLCBleHRyZW1lIGNsaW1hdGUgZXZlbnRzIGFzIHdlbGwgYXMgc2hpZnRpbmcgdHJlbmRzIG92ZXIgdGltZS4gQm90aCBhY3V0ZSBldmVudHMgYW5kIGxvbmcgdGVybSBjaGFuZ2VzIGNhbiBwb3NlIGEgc2VyaW91cyB0aHJlYXQgdG8gY3JvcHMsIGxpdmVzdG9jaywgcGVvcGxlLCBhbmQgb3RoZXIgYXNzZXRzLlwiLFxuICAgICAgICAgICAgZnI6IFwiTGVzIGFsw6lhcyBjbGltYXRpcXVlcyBpbmNsdWVudCBkZXMgw6l2w6luZW1lbnRzIGNsaW1hdGlxdWVzIGV4dHLDqm1lcyBpbmRpdmlkdWVscyBhaW5zaSBxdWUgZGVzIHRlbmRhbmNlcyBjaGFuZ2VhbnRlcyBhdSBmaWwgZHUgdGVtcHMuIFRhbnQgbGVzIMOpdsOpbmVtZW50cyBhaWd1cyBxdWUgbGVzIGNoYW5nZW1lbnRzIMOgIGxvbmcgdGVybWUgcGV1dmVudCByZXByw6lzZW50ZXIgdW5lIG1lbmFjZSBzw6lyaWV1c2UgcG91ciBsZXMgY3VsdHVyZXMsIGxlIGLDqXRhaWwsIGxlcyBwZXJzb25uZXMgZXQgZCdhdXRyZXMgYWN0aWZzLlwiLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIFZ1bG5lcmFiaWxpdHk6IHtcbiAgICAgICAgICB0aXRsZTogeyBlbjogXCJBZGFwdGl2ZSBDYXBhY2l0eVwiLCBmcjogXCJDYXBhY2l0w6kgZCdhZGFwdGF0aW9uXCIgfSxcbiAgICAgICAgICBkZXNjcmlwdGlvbjoge1xuICAgICAgICAgICAgZW46IFwiQSBwb3B1bGF0aW9uJ3MgYWJpbGl0eSB0byBhZGFwdCB0byBhIGNoYW5naW5nIGNsaW1hdGUgaXMgZGlyZWN0bHkgaW5mbHVlbmNlZCBieSBkaWZmZXJlbnQgc29jaW8tZWNvbm9taWMgdmFyaWFibGVzLiBWYXJpYWJsZXMgc3VjaCBhcyBlZHVjYXRpb24sIGZlbWFsZSBlbXBvd2VybWVudCwgYW5kIHBvdmVydHkgY2FuIHByb21vdGUgb3IgaW5oaWJpdCBhIHBlcnNvbidzIGFiaWxpdHkgdG8gcmVzcG9uZCwgcmVjb3ZlciwgYW5kIGFkYXB0IHRvIGNsaW1hdGUgcmVsYXRlZCByaXNrcy5cIixcbiAgICAgICAgICAgIGZyOiBcIkxhIGNhcGFjaXTDqSBkJ3VuZSBwb3B1bGF0aW9uIMOgIHMnYWRhcHRlciDDoCB1biBjbGltYXQgY2hhbmdlYW50IGVzdCBkaXJlY3RlbWVudCBpbmZsdWVuY8OpZSBwYXIgZGlmZsOpcmVudGVzIHZhcmlhYmxlcyBzb2Npby3DqWNvbm9taXF1ZXMuIERlcyB2YXJpYWJsZXMgdGVsbGVzIHF1ZSBsJ8OpZHVjYXRpb24sIGwnYXV0b25vbWlzYXRpb24gZGVzIGZlbW1lcyBldCBsYSBwYXV2cmV0w6kgcGV1dmVudCBmYXZvcmlzZXIgb3UgZW50cmF2ZXIgbGEgY2FwYWNpdMOpIGQndW5lIHBlcnNvbm5lIMOgIHLDqXBvbmRyZSwgc2UgcsOpdGFibGlyIGV0IHMnYWRhcHRlciBhdXggcmlzcXVlcyBsacOpcyBhdSBjbGltYXQuXCIsXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgRXhwb3N1cmU6IHtcbiAgICAgICAgICB0aXRsZTogeyBlbjogXCJFeHBvc3VyZVwiLCBmcjogXCJFeHBvc2l0aW9uXCIgfSxcbiAgICAgICAgICBkZXNjcmlwdGlvbjoge1xuICAgICAgICAgICAgZW46IFwiQ3JvcCBhbmQgbGl2ZXN0b2NrIHByb2R1Y3Rpb24gc3lzdGVtcyBhcmUgdnVsbmVyYWJsZSB0byBjbGltYXRlIGhhemFyZHMgc3VjaCBhcyBoZWF0IHN0cmVzcywgdGVtcGVyYXR1cmUgZmx1Y3R1YXRpb25zLCBhbmQgY2hhbmdlcyBpbiBwcmVjaXBpdGF0aW9uIHBhdHRlcm5zLiBBZ3JpY3VsdHVyZSBpbiBTdWItU2FoYXJhbiBBZnJpY2EgaXMgcHJpbWFyaWx5IGRyaXZlbiBieSBzbWFsbC1ob2xkZXIgZmFybWVycyBhbmQgcGxheXMgYW4gaW1wb3J0YW50IHJvbGUgaW4gYm90aCBnbG9iYWwgYW5kIGxvY2FsIGZvb2Qgc2VjdXJpdHkuIEV4cG9zdXJlIGhhcHBlbnMgd2hlbiB0aGVzZSBsaXZlbGlob29kcyBhbmQgY29tbW9kaXRpZXMgYXJlIGV4cG9zZWQgdG8gaGF6YXJkb3VzIGNsaW1hdGUgY29uZGl0aW9ucy4gVG8gZnVsbHkgdW5kZXJzdGFuZCBjbGltYXRlIHJpc2ssIHRoZSBsZXZlbCBhbmQgc2NhbGUgb2YgZXhwb3N1cmUgbXVzdCBiZSB1bmRlcnN0b29kLlwiLFxuICAgICAgICAgICAgZnI6IFwiTGVzIHN5c3TDqG1lcyBkZSBwcm9kdWN0aW9uIGRlcyBjdWx0dXJlcyBldCBkdSBiw6l0YWlsIHNvbnQgdnVsbsOpcmFibGVzIGF1eCBhbMOpYXMgY2xpbWF0aXF1ZXMgdGVscyBxdWUgbGUgc3RyZXNzIHRoZXJtaXF1ZSwgbGVzIGZsdWN0dWF0aW9ucyBkZSB0ZW1ww6lyYXR1cmUgZXQgbGVzIGNoYW5nZW1lbnRzIGRhbnMgbGVzIHLDqWdpbWVzIGRlIHByw6ljaXBpdGF0aW9ucy4gTCdhZ3JpY3VsdHVyZSBlbiBBZnJpcXVlIHN1YnNhaGFyaWVubmUgZXN0IHByaW5jaXBhbGVtZW50IHBvcnTDqWUgcGFyIGRlIHBldGl0cyBleHBsb2l0YW50cyBhZ3JpY29sZXMgZXQgam91ZSB1biByw7RsZSBpbXBvcnRhbnQgZGFucyBsYSBzw6ljdXJpdMOpIGFsaW1lbnRhaXJlIHRhbnQgbW9uZGlhbGUgcXVlIGxvY2FsZS4gTCdleHBvc2l0aW9uIHNlIHByb2R1aXQgbG9yc3F1ZSBjZXMgbW95ZW5zIGRlIHN1YnNpc3RhbmNlIGV0IGNlcyBwcm9kdWl0cyBzb250IGNvbmZyb250w6lzIMOgIGRlcyBjb25kaXRpb25zIGNsaW1hdGlxdWVzIGRhbmdlcmV1c2VzLiBQb3VyIGNvbXByZW5kcmUgcGxlaW5lbWVudCBsZSByaXNxdWUgY2xpbWF0aXF1ZSwgbGUgbml2ZWF1IGV0IGwnw6ljaGVsbGUgZGUgbCdleHBvc2l0aW9uIGRvaXZlbnQgw6p0cmUgw6l2YWx1w6lzLlwiLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgIH0sXG4gIH0sXG4gIHNlbGVjdFZhcnM6IHtcbiAgICB0aXRsZToge1xuICAgICAgZW46IFwiU2VsZWN0IHRoZSB2YXJpYWJsZXMgb2YgaW50ZXJlc3RcIixcbiAgICAgIGZyOiBcIlPDqWxlY3Rpb25uZXogbGVzIHZhcmlhYmxlcyBkJ2ludMOpcsOqdFwiLFxuICAgIH0sXG4gICAgdGV4dDoge1xuICAgICAgZW46IFwiVGhlcmUgYXJlIG1hbnkgZGlmZmVyZW50IHZhcmlhYmxlcyB3aXRoaW4gdGhlIGNhdGVnb3JpZXMgb2YgaGF6YXJkLCBleHBvc3VyZSwgYW5kIHZ1bG5lcmFiaWxpdHkuIFVzZSB0aGUgc2VsZWN0b3IgYmVsb3cgdG8gY2hvb3NlIG9uZSBvciBtdWx0aXBsZSBvZiB0aGVzZSB2YXJpYWJsZXMgdG8gZXhwbG9yZSBvciBkb3dubG9hZC5cIixcbiAgICAgIGZyOiBcIklsIGV4aXN0ZSBkZSBub21icmV1c2VzIHZhcmlhYmxlcyBkaWZmw6lyZW50ZXMgZGFucyBsZXMgY2F0w6lnb3JpZXMgZCdhbMOpYSwgZCdleHBvc2l0aW9uIGV0IGRlIHZ1bG7DqXJhYmlsaXTDqS4gVXRpbGlzZXogbGUgc8OpbGVjdGV1ciBjaS1kZXNzb3VzIHBvdXIgY2hvaXNpciB1bmUgb3UgcGx1c2lldXJzIGRlIGNlcyB2YXJpYWJsZXMgw6AgZXhwbG9yZXIgb3Ugw6AgdMOpbMOpY2hhcmdlci5cIixcbiAgICB9LFxuICAgIGZvcm1zOiB7XG4gICAgICBIYXphcmQ6IHtcbiAgICAgICAgbWFpblRpdGxlOiB7XG4gICAgICAgICAgZW46IFwiSGF6YXJkIFNlbGVjdG9ycyAoT25lIG9mIGVhY2ggbXVzdCBiZSBzZWxlY3RlZClcIixcbiAgICAgICAgICBmcjogXCJTw6lsZWN0ZXVycyBkJ0Fsw6lhcyAoVW4gZGUgY2hhcXVlIGRvaXQgw6p0cmUgc8OpbGVjdGlvbm7DqSlcIixcbiAgICAgICAgfSxcbiAgICAgICAgc2VsZWN0b3JzOiB7XG4gICAgICAgICAgaGF6YXJkOiB7XG4gICAgICAgICAgICB0aXRsZTogeyBlbjogXCJIYXphcmRcIiwgZnI6IFwiQWzDqWFcIiB9LFxuICAgICAgICAgIH0sXG4gICAgICAgICAgcGVyaW9kOiB7XG4gICAgICAgICAgICB0aXRsZTogeyBlbjogXCJUaW1lIFBlcmlvZFwiLCBmcjogXCJQw6lyaW9kZSBkZSB0ZW1wc1wiIH0sXG4gICAgICAgICAgICBvcHRpb25zOiB7XG4gICAgICAgICAgICAgIGJhc2VsaW5lOiB7IGVuOiBcIkJhc2VsaW5lXCIsIGZyOiBcIlLDqWbDqXJlbmNlXCIgfSxcbiAgICAgICAgICAgICAgaGlzdG9yaWM6IHsgZW46IFwiQmFzZWxpbmVcIiwgZnI6IFwiUsOpZsOpcmVuY2VcIiB9LFxuICAgICAgICAgICAgICBcIjIwMjFfMjA0MFwiOiB7IGVuOiBcIjIwNDBcIiwgZnI6IFwiMjA0MFwiIH0sXG4gICAgICAgICAgICAgIFwiMjA0MV8yMDYwXCI6IHsgZW46IFwiMjA2MFwiLCBmcjogXCIyMDYwXCIgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICBWdWxuZXJhYmlsaXR5OiB7XG4gICAgICAgIG1haW5UaXRsZToge1xuICAgICAgICAgIGVuOiBcIkFkYXB0aXZlIENhcGFjaXR5IFNlbGVjdG9yc1wiLFxuICAgICAgICAgIGZyOiBcIlPDqWxlY3RldXJzIGRlIGNhcGFjaXTDqSBk4oCZYWRhcHRhdGlvblwiLFxuICAgICAgICB9LFxuICAgICAgICBzZWxlY3RvcnM6IHtcbiAgICAgICAgICB2YXJpYWJsZToge1xuICAgICAgICAgICAgdGl0bGU6IHsgZW46IFwiVmFyaWFibGVzXCIsIGZyOiBcIlZhcmlhYmxlc1wiIH0sXG4gICAgICAgICAgICBvcHRpb25zOiB7XG4gICAgICAgICAgICAgIEdlbmRlcjogeyBlbjogXCJHZW5kZXJcIiwgZnI6IFwiR2VucmVcIiB9LFxuICAgICAgICAgICAgICBFZHVjYXRpb246IHsgZW46IFwiRWR1Y2F0aW9uXCIsIGZyOiBcIsOJZHVjYXRpb25cIiB9LFxuICAgICAgICAgICAgICBQb3ZlcnR5OiB7IGVuOiBcIlBvdmVydHlcIiwgZnI6IFwiUGF1dnJldMOpXCIgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICBFeHBvc3VyZToge1xuICAgICAgICBtYWluVGl0bGU6IHtcbiAgICAgICAgICBlbjogXCJFeHBvc3VyZSBTZWxlY3RvcnNcIixcbiAgICAgICAgICBmcjogXCJcIixcbiAgICAgICAgfSxcbiAgICAgICAgc2VsZWN0b3JzOiB7XG4gICAgICAgICAgdmFyaWFibGU6IHtcbiAgICAgICAgICAgIHRpdGxlOiB7IGVuOiBcIlZhcmlhYmxlc1wiLCBmcjogXCJWYXJpYWJsZXNcIiB9LFxuICAgICAgICAgICAgb3B0aW9uczoge1xuICAgICAgICAgICAgICBDcm9wOiB7IGVuOiBcIkNyb3BcIiwgZnI6IFwiQ3VsdHVyZXNcIiB9LFxuICAgICAgICAgICAgICBMaXZlc3RvY2s6IHsgZW46IFwiTGl2ZXN0b2NrXCIsIGZyOiBcIkLDqXRhaWxcIiB9LFxuICAgICAgICAgICAgICBQb3B1bGF0aW9uOiB7IGVuOiBcIlBvcHVsYXRpb25cIiwgZnI6IFwiUG9wdWxhdGlvblwiIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgIH0sXG4gIH0sXG4gIHNlbGVjdEdlb2c6IHtcbiAgICB0aXRsZToge1xuICAgICAgZW46IFwiU2VsZWN0IEdlb2dyYXBoaWVzXCIsXG4gICAgICBmcjogXCJTw6lsZWN0aW9ubmV6IGxlcyBnw6lvZ3JhcGhpZXNcIixcbiAgICB9LFxuICAgIHRleHQ6IHtcbiAgICAgIGVuOiBcIlVzZSB0aGUgdG9nZ2xlcyBiZWxvdyB0byBleHBsb3JlIGRhdGEgYW5kIHNwYXRpYWwgcGF0dGVybnMgd2l0aGluIHlvdXIgcmVnaW9uIG9mIGludGVyZXN0LiBBZGp1c3QgdGhlIGFnZ3JlZ2F0aW9uIGxldmVsIHRvIHJldmVhbCBwYXR0ZXJucyBvZiBoYXphcmQsIHZ1bG5lcmFiaWxpdHksIGFuZCBleHBvc3VyZSwgYm90aCB3aXRoaW4gYW5kIGJldHdlZW4gY291bnRyaWVzLiBUaGVzZSBjcnVjaWFsIGluc2lnaHRzIG9mdGVuIGJlY29tZSBjbGVhciBvbmx5IHdoZW4gdmlld2VkIGF0IGhpZ2hlciBzcGF0aWFsIHJlc29sdXRpb25zLiBPbmNlIHlvdSd2ZSBzZWxlY3RlZCBhbiBhZ2dyZWdhdGlvbiBsZXZlbCwgeW91IGNhbiB1c2UgdGhlIGNvdW50cnksIHJlZ2lvbiwgYW5kIHN1Yi1yZWdpb24gc2VsZWN0b3JzIHRvIGZvY3VzIG9uIHNwZWNpZmljIGFyZWFzLlwiLFxuICAgICAgZnI6IFwiVXRpbGlzZXogbGVzIG9wdGlvbnMgY2ktZGVzc291cyBwb3VyIGV4cGxvcmVyIGxlcyBkb25uw6llcyBldCBsZXMgbW9kw6hsZXMgc3BhdGlhdXggZGFucyB2b3RyZSByw6lnaW9uIGQnaW50w6lyw6p0LiBBanVzdGV6IGxlIG5pdmVhdSBkJ2FncsOpZ2F0aW9uIHBvdXIgcsOpdsOpbGVyIGxlcyBzY2jDqW1hcyBkJ2Fsw6lhLCBkZSB2dWxuw6lyYWJpbGl0w6kgZXQgZCdleHBvc2l0aW9uLCDDoCBsYSBmb2lzIGF1IHNlaW4gZGVzIHBheXMgZXQgZW50cmUgZXV4LiBDZXMgaW5mb3JtYXRpb25zIGNydWNpYWxlcyBkZXZpZW5uZW50IHNvdXZlbnQgY2xhaXJlcyB1bmlxdWVtZW50IGxvcnNxdSdlbGxlcyBzb250IG9ic2VydsOpZXMgw6AgZGVzIHLDqXNvbHV0aW9ucyBzcGF0aWFsZXMgcGx1cyDDqWxldsOpZXMuIFVuZSBmb2lzIHF1ZSB2b3VzIGF2ZXogc8OpbGVjdGlvbm7DqSB1biBuaXZlYXUgZCdhZ3LDqWdhdGlvbiwgdm91cyBwb3V2ZXogdXRpbGlzZXIgbGVzIHPDqWxlY3RldXJzIGRlIHBheXMsIGRlIHLDqWdpb24gZXQgZGUgc291cy1yw6lnaW9uIHBvdXIgdm91cyBjb25jZW50cmVyIHN1ciBkZXMgem9uZXMgc3DDqWNpZmlxdWVzLlwiLFxuICAgIH0sXG4gICAgc2VsZWN0b3JzOiB7XG4gICAgICBhZ2dyZWdhdGlvbkx2bDoge1xuICAgICAgICB0aXRsZTogeyBlbjogXCJNYXAgTGV2ZWxcIiwgZnI6IFwiTml2ZWF1IGNhcnRvZ3JhcGhpcXVlXCIgfSxcbiAgICAgICAgb3B0aW9uczoge1xuICAgICAgICAgIGFkbWluMF9uYW1lOiB7IGVuOiBcIkNvdW50cnlcIiwgZnI6IFwiUGF5c1wiIH0sXG4gICAgICAgICAgYWRtaW4xX25hbWU6IHsgZW46IFwiUmVnaW9uXCIsIGZyOiBcIlLDqWdpb25cIiB9LFxuICAgICAgICAgIGFkbWluMl9uYW1lOiB7IGVuOiBcIlN1Yi1SZWdpb25cIiwgZnI6IFwiU291cy1yw6lnaW9uXCIgfSxcbiAgICAgICAgfSxcbiAgICAgICAgd2FybmluZzoge1xuICAgICAgICAgIGVuOiBcIldhcm5pbmc6IFNlbGVjdGluZyBhbGwgc3ViLXJlZ2lvbnMgaW4gU1NBIG1heSBhZmZlY3QgcGFnZSBwZXJmb3JtYW5jZVwiLFxuICAgICAgICAgIGZyOiBcIlwiLFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICAgIGFkbWluMF9uYW1lOiB7XG4gICAgICAgIHRpdGxlOiB7IGVuOiBcIkNvdW50cnlcIiwgZnI6IFwiUGF5c1wiIH0sXG4gICAgICB9LFxuICAgICAgYWRtaW4xX25hbWU6IHtcbiAgICAgICAgdGl0bGU6IHsgZW46IFwiUmVnaW9uXCIsIGZyOiBcIlLDqWdpb25cIiB9LFxuICAgICAgfSxcbiAgICAgIGFkbWluMl9uYW1lOiB7XG4gICAgICAgIHRpdGxlOiB7IGVuOiBcIlN1Yi1SZWdpb25cIiwgZnI6IFwiU291cy1yw6lnaW9uXCIgfSxcbiAgICAgIH0sXG4gICAgfSxcbiAgfSxcbiAgVmlld0V4cGxvcmU6IHtcbiAgICB0aXRsZTogeyBlbjogXCJJbnRlcmFjdCB3aXRoIHRoZSBkYXRhXCIsIGZyOiBcIkludGVyYWdpciBhdmVjIGxlcyBkb25uw6llc1wiIH0sXG4gICAgdGV4dDoge1xuICAgICAgZW46IFwiVXNlIHRoZSBtYXAgYmVsb3cgdG8gdmlldyBzcGF0aWFsIHBhdHRlcm5zIGluIHRoZSBkYXRhLCBzZWxlY3QgdGhlIHRhYmxlIHRvIHByZXZpZXcgdGhlIGRhdGEgYmVmb3JlIGRvd25sb2FkaW5nIGl0LCBvciBnYWluIHF1aWNrIGluc2lnaHRzIHVzaW5nIHRoZSBwbG90cy5cIixcbiAgICAgIGZyOiBcIlV0aWxpc2V6IGxhIGNhcnRlIGNpLWRlc3NvdXMgcG91ciB2aXN1YWxpc2VyIGxlcyBtb2TDqGxlcyBzcGF0aWF1eCBkYW5zIGxlcyBkb25uw6llcywgc8OpbGVjdGlvbm5leiBsZSB0YWJsZWF1IHBvdXIgcHLDqXZpc3VhbGlzZXIgbGVzIGRvbm7DqWVzIGF2YW50IGRlIGxlcyB0w6lsw6ljaGFyZ2VyLCBvdSBvYnRlbmV6IHJhcGlkZW1lbnQgZGVzIGluZm9ybWF0aW9ucyBlbiB1dGlsaXNhbnQgbGVzIGdyYXBoaXF1ZXMuXCIsXG4gICAgfSxcbiAgICBzZWxlY3RvcnM6IHtcbiAgICAgIHByZXZpZXc6IHtcbiAgICAgICAgdGl0bGU6IHsgZW46IFwiUHJldmlldyBUeXBlXCIsIGZyOiBcIlR5cGUgZCdBcGVyw6d1XCIgfSxcbiAgICAgICAgb3B0aW9uczoge1xuICAgICAgICAgIE1hcDogeyBlbjogXCJNYXBcIiwgZnI6IFwiQ2FydGVcIiB9LFxuICAgICAgICAgIFRhYmxlOiB7IGVuOiBcIlRhYmxlXCIsIGZyOiBcIlRhYmxlYXVcIiB9LFxuICAgICAgICAgIFBsb3Q6IHsgZW46IFwiUGxvdFwiLCBmcjogXCJHcmFwaGlxdWVcIiB9LFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICAgIHZpc3VhbGlzZVZhcnM6IHtcbiAgICAgICAgdGl0bGVNYXA6IHsgZW46IFwiVmFyaWFibGUgVG8gTWFwXCIsIGZyOiBcIlZhcmlhYmxlIMOgIGNhcnRvZ3JhcGhpZXJcIiB9LFxuICAgICAgICB0aXRsZVBsb3Q6IHsgZW46IFwiVmFyaWFibGUgVG8gUGxvdFwiLCBmcjogXCJcIiB9LFxuICAgICAgICBoYXphcmRzOiB7XG4gICAgICAgICAgLy8gaGF6YXJkIGFuZCB0aW1lcGVyaW9kIGNhbiBiZSBzdG9sZW4gZnJvbSBvdGhlciBzZWN0aW9uXG4gICAgICAgICAgc2NlbmFyaW86IHtcbiAgICAgICAgICAgIHRpdGxlOiB7IGVuOiBcIlNjZW5hcmlvXCIsIGZyOiBcIlNjw6luYXJpb1wiIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgdnVsbmVyYWJpbGl0eToge1xuICAgICAgICAgIGdlbmRlcjoge1xuICAgICAgICAgICAgdGl0bGU6IHsgZW46IFwiR2VuZGVyIFZhcmlhYmxlXCIsIGZyOiBcIlZhcmlhYmxlIGRlIEdlbnJlXCIgfSxcbiAgICAgICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICAgICAgZG9tZXN0aWNfdmlvbGVuY2U6IHtcbiAgICAgICAgICAgICAgICBlbjogXCJEb21lc3RpYyBTYWZldHlcIixcbiAgICAgICAgICAgICAgICBmcjogXCJTw6ljdXJpdMOpIGRvbWVzdGlxdWVcIixcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgZ2VuZGVyX2VxdWl0eTogeyBlbjogXCJHZW5kZXIgRXF1aXR5XCIsIGZyOiBcIsOJZ2FsaXTDqSBkZXMgc2V4ZXNcIiB9LFxuICAgICAgICAgICAgICBkZWNpc2lvbl9tYWtpbmc6IHtcbiAgICAgICAgICAgICAgICBlbjogXCJEZWNpc2lvbiBNYWtpbmcgUG93ZXJcIixcbiAgICAgICAgICAgICAgICBmcjogXCJQb3V2b2lyIGRlIGTDqWNpc2lvblwiLFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBlZHVjYXRpb246IHsgZW46IFwiV29tZW5zIEVkdWNhdGlvblwiLCBmcjogXCLDiWR1Y2F0aW9uIGRlcyBmZW1tZXNcIiB9LFxuICAgICAgICAgICAgICBmYW1pbHlfcGxhbm5pbmc6IHtcbiAgICAgICAgICAgICAgICBlbjogXCJBY2Nlc3MgdG8gRmFtaWx5IFBsYW5uaW5nXCIsXG4gICAgICAgICAgICAgICAgZnI6IFwiQWNjw6hzIMOgIGxhIHBsYW5pZmljYXRpb24gZmFtaWxpYWxlXCIsXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHJlcHJvZHVjdGl2ZV9oZWFsdGg6IHtcbiAgICAgICAgICAgICAgICBlbjogXCJSZXByb2R1Y3RpdmUgSGVhbHRoXCIsXG4gICAgICAgICAgICAgICAgZnI6IFwiU2FudMOpIHJlcHJvZHVjdGl2ZVwiLFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIHBvdmVydHk6IHtcbiAgICAgICAgICAgIHRpdGxlOiB7IGVuOiBcIlBvdmVydHkgdmFyaWFibGVcIiwgZnI6IFwiVmFyaWFibGUgZGUgUGF1dnJldMOpXCIgfSxcbiAgICAgICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICAgICAgR1NBUF9wb29yMjE1OiB7IGVuOiBcIiUgdW5kZXIgJDIuMTUgcG92ZXJ0eSBsaW5lXCIsIGZyOiBcIlwiIH0sXG4gICAgICAgICAgICAgIEdTQVBfcG9vcjM2NTogeyBlbjogXCIlIHVuZGVyICQzLjY1IHBvdmVydHkgbGluZVwiLCBmcjogXCJcIiB9LFxuICAgICAgICAgICAgICBHU0FQX3Bvb3I2ODU6IHsgZW46IFwiJSB1bmRlciAkNi44NSBwb3ZlcnR5IGxpbmVcIiwgZnI6IFwiXCIgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgZXhwb3N1cmU6IHtcbiAgICAgICAgICB0aXRsZTogeyBlbjogXCJFeHBvc3VyZSBDYXRlZ29yeVwiLCBmcjogXCJDYXTDqWdvcmllIGQnRXhwb3NpdGlvblwiIH0sXG4gICAgICAgICAgcG9wdWxhdGlvbjoge1xuICAgICAgICAgICAgdGl0bGU6IHsgZW46IFwiUG9wdWxhdGlvbiBHcm91cFwiLCBmcjogXCJHcm91cGUgZGUgUG9wdWxhdGlvblwiIH0sXG4gICAgICAgICAgICBvcHRpb25zOiB7XG4gICAgICAgICAgICAgIHRvdGFsX3BvcDogeyBlbjogXCJUb3RhbCBQb3B1bGF0aW9uXCIsIGZyOiBcIlBvcHVsYXRpb24gVG90YWxlXCIgfSxcbiAgICAgICAgICAgICAgcnVyYWxfcG9wOiB7IGVuOiBcIlJ1cmFsIFBvcHVsYXRpb25cIiwgZnI6IFwiUG9wdWxhdGlvbiBSdXJhbGVcIiB9LFxuICAgICAgICAgICAgICB1cmJhbl9wb3A6IHsgZW46IFwiVXJiYW4gUG9wdWxhdGlvblwiLCBmcjogXCJQb3B1bGF0aW9uIFVyYmFpbmVcIiB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIGNvbW1vZGl0eToge1xuICAgICAgICAgICAgdGl0bGU6IHsgZW46IFwiQ29tbW9kaXR5XCIsIGZyOiBcIlByb2R1aXRcIiB9LFxuICAgICAgICAgIH0sXG4gICAgICAgICAgZXhwb3N1cmVWYXJpYWJsZToge1xuICAgICAgICAgICAgdGl0bGU6IHsgZW46IFwiVmFyaWFibGVcIiwgZnI6IFwiVmFyaWFibGVcIiB9LFxuICAgICAgICAgICAgb3B0aW9uczoge1xuICAgICAgICAgICAgICB0b3RhbF9wb3A6IHsgZW46IFwiVG90YWwgUG9wdWxhdGlvblwiLCBmcjogXCJQb3B1bGF0aW9uIFRvdGFsZVwiIH0sXG4gICAgICAgICAgICAgIHJ1cmFsX3BvcDogeyBlbjogXCJSdXJhbCBQb3B1bGF0aW9uXCIsIGZyOiBcIlBvcHVsYXRpb24gUnVyYWxlXCIgfSxcbiAgICAgICAgICAgICAgdXJiYW5fcG9wOiB7IGVuOiBcIlVyYmFuIFBvcHVsYXRpb25cIiwgZnI6IFwiUG9wdWxhdGlvbiBVcmJhaW5lXCIgfSxcbiAgICAgICAgICAgICAgdm9wOiB7IGVuOiBcIlZhbHVlIG9mIFByb2R1Y3Rpb25cIiwgZnI6IFwiVmFsZXVyIGRlIGxhIFByb2R1Y3Rpb25cIiB9LFxuICAgICAgICAgICAgICBoYTogeyBlbjogXCJIYXJ2ZXN0ZWQgQXJlYVwiLCBmcjogXCJTdXBlcmZpY2llIFLDqWNvbHTDqWVcIiB9LFxuICAgICAgICAgICAgICBudW1iZXI6IHsgZW46IFwiTnVtYmVyIG9mIEFuaW1hbHNcIiwgZnI6IFwiTm9tYnJlIGQnQW5pbWF1eFwiIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgIH0sXG4gICAgZXhwbG9yZU1hcDoge1xuICAgICAgcmVzZXRCdG46IHsgZW46IFwiUmVzZXQgWm9vbVwiLCBmcjogXCJSw6lpbml0aWFsaXNlciBsZSB6b29tXCIgfSxcbiAgICAgIHZhbHVlOiB7IGVuOiBcIlZhbHVlXCIsIGZyOiBcIlZhbGV1clwiIH0sXG4gICAgfSxcbiAgICBoYXphcmRCYXJzOiB7XG4gICAgICBudW1BcmVhczoge1xuICAgICAgICBlbjogXCJOdW1iZXIgb2YgQXJlYXNcIixcbiAgICAgICAgZnI6IFwiTm9tYnJlIGQnVW5pdMOpcyBBZG1pbmlzdHJhdGl2ZXNcIixcbiAgICAgIH0sXG4gICAgICB5YXhpczoge1xuICAgICAgICBlbjogXCJOdW1iZXIgb2YgQWRtaW4gVW5pdHNcIixcbiAgICAgICAgZnI6IFwiTm9tYnJlIGQnVW5pdMOpcyBBZG1pbmlzdHJhdGl2ZXNcIixcbiAgICAgIH0sXG4gICAgICBsdmw6IHsgZW46IFwiTGV2ZWxcIiwgZnI6IFwiXCIgfSxcbiAgICB9LFxuICAgIGV4cG9zdXJlVHJlZW1hcDoge1xuICAgICAgY3JvcEdyb3Vwczoge1xuICAgICAgICB0b3RhbDogeyBlbjogXCJUb3RhbFwiLCBmcjogXCJUb3RhbFwiIH0sXG4gICAgICAgIGNhdHRsZTogeyBlbjogXCJDYXR0bGVcIiwgZnI6IFwiQm92aW5zXCIgfSxcbiAgICAgICAgcG91bHRyeTogeyBlbjogXCJQb3VsdHJ5XCIsIGZyOiBcIlZvbGFpbGxlc1wiIH0sXG4gICAgICAgIHBpZ3M6IHsgZW46IFwiUGlnc1wiLCBmcjogXCJQb3Jjc1wiIH0sXG4gICAgICAgIGNlcmVhbHM6IHsgZW46IFwiQ2VyZWFsc1wiLCBmcjogXCJDw6lyw6lhbGVzXCIgfSxcbiAgICAgICAgcm9vdHNUdWJlcjogeyBlbjogXCJSb290cyAmIFR1YmVyc1wiLCBmcjogXCJSYWNpbmVzIGV0IFR1YmVyY3VsZXNcIiB9LFxuICAgICAgICBsZWd1bWVzOiB7IGVuOiBcIkxlZ3VtZXNcIiwgZnI6IFwiTMOpZ3VtaW5ldXNlc1wiIH0sXG4gICAgICAgIGZydWl0VmVnOiB7IGVuOiBcIkZydWl0cyAmIFZlZ2V0YWJsZXNcIiwgZnI6IFwiRnJ1aXRzIGV0IEzDqWd1bWVzXCIgfSxcbiAgICAgICAgbm9uRWRpYmxlOiB7IGVuOiBcIk5vbi1lZGlibGUgQ3JvcHNcIiwgZnI6IFwiQ3VsdHVyZXMgbm9uIGNvbWVzdGlibGVzXCIgfSxcbiAgICAgIH0sXG4gICAgfSxcbiAgICBwYXJhbGxlbENvb3Jkczoge1xuICAgICAgYWNWYXJzOiB7XG4gICAgICAgIGRvbWVzdGljX3Zpb2xlbmNlOiB7XG4gICAgICAgICAgZW46IFwiRG9tZXN0aWMgU2FmZXR5XCIsXG4gICAgICAgICAgZnI6IFwiU8OpY3VyaXTDqSBkb21lc3RpcXVlXCIsXG4gICAgICAgIH0sXG4gICAgICAgIGdlbmRlcl9lcXVpdHk6IHtcbiAgICAgICAgICBlbjogXCJHZW5kZXIgRXF1aXR5XCIsXG4gICAgICAgICAgZnI6IFwiw4lnYWxpdMOpIGRlcyBzZXhlc1wiLFxuICAgICAgICB9LFxuICAgICAgICBkZWNpc2lvbl9tYWtpbmc6IHtcbiAgICAgICAgICBlbjogXCJEZWNpc2lvbiBNYWtpbmcgUG93ZXJcIixcbiAgICAgICAgICBmcjogXCJQb3V2b2lyIGRlIGTDqWNpc2lvblwiLFxuICAgICAgICB9LFxuICAgICAgICBlZHVjYXRpb246IHtcbiAgICAgICAgICBlbjogXCJXb21lbnMgRWR1Y2F0aW9uXCIsXG4gICAgICAgICAgZnI6IFwiw4lkdWNhdGlvbiBkZXMgZmVtbWVzXCIsXG4gICAgICAgIH0sXG4gICAgICAgIGZhbWlseV9wbGFubmluZzoge1xuICAgICAgICAgIGVuOiBcIkFjY2VzcyB0byBGYW1pbHkgUGxhbm5pbmdcIixcbiAgICAgICAgICBmcjogXCJBY2PDqHMgw6AgbGEgcGxhbmlmaWNhdGlvbiBmYW1pbGlhbGVcIixcbiAgICAgICAgfSxcbiAgICAgICAgcmVwcm9kdWN0aXZlX2hlYWx0aDoge1xuICAgICAgICAgIGVuOiBcIlJlcHJvZHVjdGl2ZSBIZWFsdGhcIixcbiAgICAgICAgICBmcjogXCJTYW50w6kgcmVwcm9kdWN0aXZlXCIsXG4gICAgICAgIH0sXG4gICAgICAgIEdTQVBfcG9vcjIxNToge1xuICAgICAgICAgIGVuOiBcIkFib3ZlICQyLjE1L2RheVwiLFxuICAgICAgICAgIGZyOiBcIkF1LWRlc3N1cyBkZSAyLDE14oCvJC9qb3VyXCIsXG4gICAgICAgIH0sXG4gICAgICAgIEdTQVBfcG9vcjM2NToge1xuICAgICAgICAgIGVuOiBcIkFib3ZlICQzLjY1L2RheVwiLFxuICAgICAgICAgIGZyOiBcIkF1LWRlc3N1cyBkZSAzLDY14oCvJC9qb3VyXCIsXG4gICAgICAgIH0sXG4gICAgICAgIEdTQVBfcG9vcjY4NToge1xuICAgICAgICAgIGVuOiBcIkFib3ZlICQ2Ljg1L2RheVwiLFxuICAgICAgICAgIGZyOiBcIkF1LWRlc3N1cyBkZSA2LDg14oCvJC9qb3VyXCIsXG4gICAgICAgIH0sXG4gICAgICAgIGVkdWNhdGlvbllyczoge1xuICAgICAgICAgIGVuOiBcIkVkdWNhdGlvbihZcnMpXCIsXG4gICAgICAgICAgZnI6IFwiw4lkdWNhdGlvbiAoYW5uw6llcylcIixcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgfSxcbiAgfSxcbiAgZG93bmxvYWQ6IHtcbiAgICB0aXRsZTogeyBlbjogXCJEb3dubG9hZCBUaGUgRGF0YVwiLCBmcjogXCJUw6lsw6ljaGFyZ2VyIGxlcyBkb25uw6llc1wiIH0sXG4gICAgc2VsZWN0b3I6IHtcbiAgICAgIHRpdGxlOiB7IGVuOiBcIkRvd25sb2FkIEZvcm1hdFwiLCBmcjogXCJGb3JtYXQgZGUgdMOpbMOpY2hhcmdlbWVudFwiIH0sXG4gICAgfSxcbiAgICBidXR0b246IHtcbiAgICAgIHByZXBhcmU6IHsgZW46IFwiUHJlcGFyZSBEb3dubG9hZFwiLCBmcjogXCJQcsOpcGFyZXIgbGUgdMOpbMOpY2hhcmdlbWVudFwiIH0sXG4gICAgICBkb3dubG9hZDogeyBlbjogXCJEb3dubG9hZFwiLCBmcjogXCJUw6lsw6ljaGFyZ2VyXCIgfSxcbiAgICB9LFxuICAgIGJvdW5kYXJpZXM6IHtcbiAgICAgIHRpdGxlOiB7XG4gICAgICAgIGVuOiBcIkRvd25sb2FkIEJvdW5kYXJ5IERhdGFcIixcbiAgICAgICAgZnI6IFwiVMOpbMOpY2hhcmdlciBsZXMgZG9ubsOpZXMgZGVzIGZyb250acOocmVzXCIsXG4gICAgICB9LFxuICAgICAgYnV0dG9uOiB7XG4gICAgICAgIGVuOiBcIkRvd25sb2FkIEFkbWluIDo6OmFkbWluTHZsOjo6IEJvdW5kYXJpZXNcIixcbiAgICAgICAgZnI6IFwiVMOpbMOpY2hhcmdlciBsZXMgZnJvbnRpw6hyZXMgYWRtaW5pc3RyYXRpdmVzIDo6OmFkbWluTHZsOjo6XCIsXG4gICAgICB9LFxuICAgIH0sXG4gIH0sXG4gIG1ldGhvZHNfc291cmNlczoge1xuICAgIHRpdGxlOiB7IGVuOiBcIk1ldGhvZHMgJiBTb3VyY2VzXCIsIGZyOiBcIk3DqXRob2RlcyAmIFNvdXJjZXNcIiB9LFxuICAgIG1ldGhvZHM6IHtcbiAgICAgIHRpdGxlOiB7IGVuOiBcIk1ldGhvZHNcIiwgZnI6IFwiTcOpdGhvZG9sb2dpZVwiIH0sXG4gICAgfSxcbiAgICBkYXRhc2V0czoge1xuICAgICAgdGl0bGU6IHsgZW46IFwiRGF0YXNldHNcIiwgZnI6IFwiSmV1eCBkZSBkb25uw6llc1wiIH0sXG4gICAgICBib3VuZGFyaWVzOiB7XG4gICAgICAgIHRpdGxlOiB7IGVuOiBcIkJvdW5kYXJpZXNcIiwgZnI6IFwiRMOpbGltaXRhdGlvbnNcIiB9LFxuICAgICAgICB0ZXh0OiB7XG4gICAgICAgICAgZW46IGBbQWRtaW5pc3RyYXRpdmUgYXJlYXNdKGh0dHBzOi8vcmFkaWFudGVhcnRoLmdpdGh1Yi5pby9zdGFjLWJyb3dzZXIvIy9leHRlcm5hbC9kaWdpdGFsLWF0bGFzLnMzLmFtYXpvbmF3cy5jb20vc3RhYy9wdWJsaWNfc3RhYy9ib3VuZGFyeV9jYXRhbG9nL2dlb0JvdW5kYXJpZXNfU1NBL2NvbGxlY3Rpb24uanNvbikgdXNlZCBpbiB0aGlzIG5vdGVib29rIGNvbWUgZnJvbSBbZ2VvQm91bmRhcmllcyA2LjAuMF0oaHR0cHM6Ly9naXRodWIuY29tL3dtZ2VvbGFiL2dlb0JvdW5kYXJpZXMpLiBUaGUgZ2JIdW1hbml0YXJpYW4gYm91bmRhcmllcyBhcmUgdXNlZCBhbmQgaWYgbm90IGF2YWlsYWJsZSB0aGVuIHRoZSBnYk9wZW4gYm91bmRhcmllcyBhcmUgc3Vic3RpdHV0ZWQuYCxcbiAgICAgICAgICBmcjogYFtMZXMgem9uZXMgYWRtaW5pc3RyYXRpdmVzXShodHRwczovL3JhZGlhbnRlYXJ0aC5naXRodWIuaW8vc3RhYy1icm93c2VyLyMvZXh0ZXJuYWwvZGlnaXRhbC1hdGxhcy5zMy5hbWF6b25hd3MuY29tL3N0YWMvcHVibGljX3N0YWMvYm91bmRhcnlfY2F0YWxvZy9nZW9Cb3VuZGFyaWVzX1NTQS9jb2xsZWN0aW9uLmpzb24/Lmxhbmd1YWdlPWZyKSB1dGlsaXPDqWVzIGRhbnMgY2Ugbm90ZWJvb2sgcHJvdmllbm5lbnQgZGUgW2dlb0JvdW5kYXJpZXMgNi4wLjBdKGh0dHBzOi8vZ2l0aHViLmNvbS93bWdlb2xhYi9nZW9Cb3VuZGFyaWVzKS4gTGVzIGZyb250acOocmVzIGdiSHVtYW5pdGFyaWFuIHNvbnQgdXRpbGlzw6llcyBldCwgc2kgZWxsZXMgbmUgc29udCBwYXMgZGlzcG9uaWJsZXMsIGxlcyBmcm9udGnDqHJlcyBnYk9wZW4gc29udCBzdWJzdGl0dcOpZXMuYCxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICBhY0RTOiB7XG4gICAgICAgIHRpdGxlOiB7XG4gICAgICAgICAgZW46IFwiQWRhcHRpdmUgQ2FwYWNpdHkgRGF0YXNldHNcIixcbiAgICAgICAgICBmcjogXCJKZXV4IGRlIGRvbm7DqWVzIHN1ciBsYSBjYXBhY2l0w6kgZOKAmWFkYXB0YXRpb25cIixcbiAgICAgICAgfSxcbiAgICAgICAgRmVtYWxlV2VsbGJlaW5nOiB7XG4gICAgICAgICAgdGl0bGU6IHtcbiAgICAgICAgICAgIGVuOiBcIkZlbWFsZSBXZWxsLWJlaW5nIGFuZCBFbXBvd2VybWVudCBkYXRhXCIsXG4gICAgICAgICAgICBmcjogXCJEb25uw6llcyBzdXIgbGUgYmllbi3DqnRyZSBldCBsJ2F1dG9ub21pc2F0aW9uIGRlcyBmZW1tZXNcIixcbiAgICAgICAgICB9LFxuICAgICAgICAgIHRleHQ6IHtcbiAgICAgICAgICAgIGVuOiBgVGhlIFtGZW1hbGUgRW1wb3dlcm1lbnQgSW5kZXhdKGh0dHBzOi8vcmFkaWFudGVhcnRoLmdpdGh1Yi5pby9zdGFjLWJyb3dzZXIvIy9leHRlcm5hbC9kaWdpdGFsLWF0bGFzLnMzLmFtYXpvbmF3cy5jb20vc3RhYy9wdWJsaWNfc3RhYy9hZGFwdGl2ZS1jYXBhY2l0eS93b21lbi1hbmQtZ2VuZGVyL2ZlbWFsZS1lbXBvd2VybWVudC9jb2xsZWN0aW9uLmpzb24pIGNvbWJpbmVzIGRhdGEgb24gZG9tZXN0aWMgdmlvbGVuY2UsIGVtcGxveW1lbnQsIHJlcHJvZHVjdGl2ZSBoZWFsdGhjYXJlLCBkZWNpc2lvbi1tYWtpbmcgcG93ZXIsIGFuZCBmYW1pbHkgcGxhbm5pbmcuIFRoZSBpbmRleCwgYW5kIHRoZSB2YXJpYWJsZXMgaXQgaXMgZGVyaXZlZCBmcm9tLCBhcmUgZnJvbSBbUmV0dGlnLCBFcmljYSAoMjAyMildKGh0dHBzOi8vZGF0YXZlcnNlLmhhcnZhcmQuZWR1L2RhdGFzZXQueGh0bWw/cGVyc2lzdGVudElkPWRvaToxMC43OTEwL0RWTi84R0pLWVcpIGFuZCBhcmUgYnVpbGQgdXNpbmcgZGF0YSBmcm9tIFtESFMgUHJvZ3JhbV0oaHR0cHM6Ly9kaHNwcm9ncmFtLmNvbSkuIFRoZSBpbmRpdmlkdWFsIHZhcmlhYmxlcyBhbmQgdGhlIEVtcG93ZXJtZW50IEluZGV4IGFyZSBiYXNlZCBvbiB0aGUgMjAxNSBjYWxjdWxhdGlvbnMuIEFsbCBvZiB0aGVzZSBoYXZlIGJlZW4gbm9ybWFsaXplZCBiZXR3ZWVuIDAgYW5kIDEsIHdoZXJlIDAgcmVwcmVzZW50cyBsb3dlc3QgZW1wb3dlcm1lbnQgYW5kIDEgcmVwcmVzZW50cyBoaWdoZXN0IGVtcG93ZXJtZW50YCxcbiAgICAgICAgICAgIGZyOiBgW0wnSW5kaWNlIGQnQXV0b25vbWlzYXRpb24gZGVzIEZlbW1lc10oaHR0cHM6Ly9yYWRpYW50ZWFydGguZ2l0aHViLmlvL3N0YWMtYnJvd3Nlci8jL2V4dGVybmFsL2RpZ2l0YWwtYXRsYXMuczMuYW1hem9uYXdzLmNvbS9zdGFjL3B1YmxpY19zdGFjL2FkYXB0aXZlLWNhcGFjaXR5L3dvbWVuLWFuZC1nZW5kZXIvZmVtYWxlLWVtcG93ZXJtZW50L2NvbGxlY3Rpb24uanNvbj8ubGFuZ3VhZ2U9ZnIpIGNvbWJpbmUgZGVzIGRvbm7DqWVzIHN1ciBsYSB2aW9sZW5jZSBkb21lc3RpcXVlLCBsJ2VtcGxvaSwgbGVzIHNvaW5zIGRlIHNhbnTDqSByZXByb2R1Y3RpdmUsIGxlIHBvdXZvaXIgZGUgZMOpY2lzaW9uIGV0IGxhIHBsYW5pZmljYXRpb24gZmFtaWxpYWxlLiBMJ2luZGljZSwgZXQgbGVzIHZhcmlhYmxlcyBkb250IGlsIGVzdCBkw6lyaXbDqSwgcHJvdmllbm5lbnQgZGUgW1JldHRpZywgRXJpY2EgKDIwMjIpXShodHRwczovL2RhdGF2ZXJzZS5oYXJ2YXJkLmVkdS9kYXRhc2V0LnhodG1sP3BlcnNpc3RlbnRJZD1kb2k6MTAuNzkxMC9EVk4vOEdKS1lXKSBldCBzb250IGNvbnN0cnVpdHMgw6AgcGFydGlyIGRlcyBkb25uw6llcyBkdSBbcHJvZ3JhbW1lIERIU10oaHR0cHM6Ly9kaHNwcm9ncmFtLmNvbSkuIExlcyB2YXJpYWJsZXMgaW5kaXZpZHVlbGxlcyBldCBsJ0luZGljZSBkJ0F1dG9ub21pc2F0aW9uIHNvbnQgYmFzw6lzIHN1ciBsZXMgY2FsY3VscyBkZSAyMDE1LiBUb3VzIGNlcyDDqWzDqW1lbnRzIG9udCDDqXTDqSBub3JtYWxpc8OpcyBlbnRyZSAwIGV0IDEsIG/DuSAwIHJlcHLDqXNlbnRlIGxlIHBsdXMgZmFpYmxlIG5pdmVhdSBkJ2F1dG9ub21pc2F0aW9uIGV0IDEgbGUgcGx1cyDDqWxldsOpLmAsXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgcG92ZXJ0eToge1xuICAgICAgICAgIHRpdGxlOiB7XG4gICAgICAgICAgICBlbjogXCJQb3ZlcnR5XCIsXG4gICAgICAgICAgICBmcjogXCJQYXV2cmV0w6lcIixcbiAgICAgICAgICB9LFxuICAgICAgICAgIHRleHQ6IHtcbiAgICAgICAgICAgIGVuOiBtZGBQb3ZlcnR5IGRhdGEgaXMgZGVyaXZlZCBmcm9tIHRoZSBbV29ybGQgQmFuayBnbG9iYWwgc3VibmF0aW9uYWwgcG92ZXJ0eSBhdGxhc10oaHR0cHM6Ly9kYXRhY2F0YWxvZy53b3JsZGJhbmsub3JnL3NlYXJjaC9kYXRhc2V0LzAwNDIwNDEvZ2xvYmFsX3N1Ym5hdGlvbmFsX3BvdmVydHlfYXRsYXNfZ3NhcCkgZGF0YXNldC5gLFxuICAgICAgICAgICAgZnI6IG1kYExlcyBkb25uw6llcyBzdXIgbGEgcGF1dnJldMOpIHNvbnQgdGlyw6llcyBkZSBbbCdlbnNlbWJsZSBkZSBkb25uw6llcyBkZSBsJ2F0bGFzIG1vbmRpYWwgZGUgbGEgcGF1dnJldMOpIGluZnJhbmF0aW9uYWxlIGRlIGxhIEJhbnF1ZSBtb25kaWFsZV0oaHR0cHM6Ly9kYXRhY2F0YWxvZy53b3JsZGJhbmsub3JnL3NlYXJjaC9kYXRhc2V0LzAwNDIwNDEvZ2xvYmFsX3N1Ym5hdGlvbmFsX3BvdmVydHlfYXRsYXNfZ3NhcCkuYCxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICBlZHVjYXRpb246IHtcbiAgICAgICAgICB0aXRsZTogeyBlbjogXCJFZHVjYXRpb25cIiwgZnI6IFwiw4lkdWNhdGlvblwiIH0sXG4gICAgICAgICAgdGV4dDoge1xuICAgICAgICAgICAgZW46IFwiWWVhcnMgb2YgZWR1Y2F0aW9uIGlzIHRoZSBtZWFuIG1hbGUgYW5kIGZlbWFsZSBlZHVjYXRpb25hbCBhdHRhaW5tZW50IGZyb20gdGhlIFsyMDA1LTIwMTUgSUhNRSBFc3RpbWF0ZXMgZm9yIGFnZXMgMTUtNDldKGh0dHBzOi8vZ2hkeC5oZWFsdGhkYXRhLm9yZy9yZWNvcmQvaWhtZS1kYXRhL2FmcmljYS1lZHVjYXRpb25hbC1hdHRhaW5tZW50LWdlb3NwYXRpYWwtZXN0aW1hdGVzLTIwMDAtMjAxNSkuXCIsXG4gICAgICAgICAgICBmcjogXCJMZXMgYW5uw6llcyBk4oCZw6lkdWNhdGlvbiBjb3JyZXNwb25kZW50IMOgIGxhIG1veWVubmUgZGUgbGEgc2NvbGFyaXTDqSBkZXMgaG9tbWVzIGV0IGRlcyBmZW1tZXMsIHNlbG9uIGxlcyBlc3RpbWF0aW9ucyBkZSBs4oCZSUhNRSBwb3VyIGxhIHDDqXJpb2RlIFsyMDA1LTIwMTUgcG91ciBsZXMgcGVyc29ubmVzIMOiZ8OpZXMgZGUgMTUgw6AgNDkgYW5zLl0oaHR0cHM6Ly9naGR4LmhlYWx0aGRhdGEub3JnL3JlY29yZC9paG1lLWRhdGEvYWZyaWNhLWVkdWNhdGlvbmFsLWF0dGFpbm1lbnQtZ2Vvc3BhdGlhbC1lc3RpbWF0ZXMtMjAwMC0yMDE1KVwiLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgZXhwb3N1cmVEUzoge1xuICAgICAgICB0aXRsZToge1xuICAgICAgICAgIGVuOiBcIkV4cG9zdXJlIERhdGFzZXRzXCIsXG4gICAgICAgICAgZnI6IFwiSmV1eCBkZSBkb25uw6llcyBzdXIgbOKAmWV4cG9zaXRpb25cIixcbiAgICAgICAgfSxcbiAgICAgICAgcG9wdWxhdGlvbjoge1xuICAgICAgICAgIHRpdGxlOiB7XG4gICAgICAgICAgICBlbjogXCJQb3B1bGF0aW9uXCIsXG4gICAgICAgICAgICBmcjogXCJQb3B1bGF0aW9uXCIsXG4gICAgICAgICAgfSxcbiAgICAgICAgICB0ZXh0OiB7XG4gICAgICAgICAgICBlbjogXCJQb3B1bGF0aW9uIGRhdGEgaXMgZnJvbSB0aGUgV29ybGRQb3AgVW5jb25zdHJhaW5lZCBHbG9iYWwgTW9zYWljIGZvciAyMDIwLiBUaGUgcG9wdWxhdGlvbiBkYXRhIGlzIG1hc2tlZCBBZnJpY2Fwb2xpcyBkYXRhIHRvIHNlcGFyYXRlIHRoZSBwb3B1bGF0aW9uIGdyb3VwcyBpbnRvIHJ1cmFsLCB1cmJhbiwgYW5kIHRvdGFsLiBUaGUgZmluYWwgcmFzdGVyIGRhdGFzZXQgdXNlZCBpcyBhdCBhIHJlc29sdXRpb24gb2YgMC4wODMgZGVncmVlcyAoNSBhcmMgbWludXRlcykuXCIsXG4gICAgICAgICAgICBmcjogXCJMZXMgZG9ubsOpZXMgZMOpbW9ncmFwaGlxdWVzIHByb3ZpZW5uZW50IGRlIGxhIG1vc2HDr3F1ZSBtb25kaWFsZSBzYW5zIGNvbnRyYWludGUgV29ybGRQb3AgcG91ciAyMDIwLiBMZXMgZG9ubsOpZXMgZMOpbW9ncmFwaGlxdWVzIHNvbnQgZGVzIGRvbm7DqWVzIEFmcmljYXBvbGlzIG1hc3F1w6llcyBwb3VyIHPDqXBhcmVyIGxlcyBncm91cGVzIGRlIHBvcHVsYXRpb24gZW4gem9uZXMgcnVyYWxlcywgdXJiYWluZXMgZXQgdG90YWxlcy4gTGUgamV1IGRlIGRvbm7DqWVzIHJhc3RlciBmaW5hbCB1dGlsaXPDqSBhIHVuZSByw6lzb2x1dGlvbiBkZSAwLDA4MyBkZWdyw6kgKDUgbWludXRlcyBkJ2FyYykuXCIsXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgdm9wSEE6IHtcbiAgICAgICAgICB0aXRsZToge1xuICAgICAgICAgICAgZW46IFwiQ3JvcCBhbmQgTGl2ZXN0b2NrIGRhdGFcIixcbiAgICAgICAgICAgIGZyOiBcIkRvbm7DqWVzIHN1ciBsZXMgY3VsdHVyZXMgZXQgbGUgYsOpdGFpbFwiLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgdGV4dDoge1xuICAgICAgICAgICAgZW46IG1kYFtDcm9wIHZhbHVlIG9mIHByb2R1Y3Rpb25dKGh0dHBzOi8vcmFkaWFudGVhcnRoLmdpdGh1Yi5pby9zdGFjLWJyb3dzZXIvIy9leHRlcm5hbC9kaWdpdGFsLWF0bGFzLnMzLmFtYXpvbmF3cy5jb20vc3RhYy9wdWJsaWNfc3RhYy9leHBvc3VyZV9jYXRhbG9nL21hcHNwYW0yMDE3L21hcHNwYW0yMDE3X3ZvcF9wYXJxdWV0L21hcHNwYW0yMDE3X3ZvcF9wYXJxdWV0Lmpzb24pIGRhdGEgY29tZXMgZnJvbSBNYXBTUEFNIDIwMTcgVjJyMyAoU3BhdGlhbCBQcm9kdWN0aW9uIEFsbG9jYXRpb24gTW9kZWwpIHdoZXJlIHByb2R1Y3Rpb24gdmFsdWVzIGFyZSBtdWx0aXBsaWVkIGJ5IGNvdW50cnkgc3BlY2lmaWMgRkFPc3RhdCBpbnRlcm5hdGlvbmFsIGNyb3AgcHJpY2VzIGluICgyMDA1IEludGVybmF0aW9uYWwgRG9sbGFycykuIEFuIFtpbnRlcm5hdGlvbmFsIGRvbGxhcl0oaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvSW50ZXJuYXRpb25hbF9kb2xsYXIpICgyMDA1KSBpcyBhIGh5cG90aGV0aWNhbCB1bml0IG9mIGN1cnJlbmN5IHRoYXQgaGFzIHRoZSBzYW1lIHB1cmNoYXNpbmcgcG93ZXIgcGFyaXR5IGFzIHRoZSBVLlMuIGRvbGxhciBoYWQgaW4gdGhlIFVuaXRlZCBTdGF0ZXMgaW4gMjAwNSwgYWxsb3dpbmcgZm9yIGNvbXBhcmlzb24gb2Ygd2hhdCBjb25zdW1lcnMgY2FuIGJ1eSBpbiBkaWZmZXJlbnQgY291bnRyaWVzIHdpdGggdGhlIHNhbWUgYW1vdW50IG9mIG1vbmV5LiBUaGlzIGRhdGFzZXQgaXMgYW4gdXBkYXRlZCB2ZXJzaW9uIG9mIE1hcFNQQU0gc3BlY2lmaWNhbGx5IHRhaWxvcmVkIGZvciB0aGlzIHByb2plY3QuIEl0IGluY2x1ZGVzIGJ1ZyBmaXhlcyBhbmQgaW5jb3Jwb3JhdGVzIGNvdW50cnktc3BlY2lmaWMgdmFsdWVzIG9mIHByb2R1Y3Rpb24gaW5zdGVhZCBvZiBnbG9iYWwgYXZlcmFnZXMuXG5cbltMaXZlc3RvY2sgdmFsdWUgb2YgcHJvZHVjdGlvbl0oaHR0cHM6Ly9yYWRpYW50ZWFydGguZ2l0aHViLmlvL3N0YWMtYnJvd3Nlci8jL2V4dGVybmFsL2RpZ2l0YWwtYXRsYXMuczMuYW1hem9uYXdzLmNvbS9zdGFjL3B1YmxpY19zdGFjL2V4cG9zdXJlX2NhdGFsb2cvR0xXM19saXZlc3RvY2svR0xXM19saXZlc3RvY2tfdm9wUFEvR0xXM19saXZlc3RvY2tfdm9wUFEuanNvbikgaW4gMjAwNSBJbnRlcm5hdGlvbmFsIERvbGxhcnMgd2VyZSBwcm92aWRlZCBieSB0aGUgYXV0aG9ycyBvZiBbSGVycmVybyBldCBhbC4gKDIwMTMpXShodHRwczovL3d3dy5wbmFzLm9yZy9kb2kvZnVsbC8xMC4xMDczL3BuYXMuMTMwODE0OTExMC8pLmAsXG4gICAgICAgICAgICBmcjogbWRgW0xlcyBkb25uw6llcyBzdXIgbGEgdmFsZXVyIGRlIGxhIHByb2R1Y3Rpb24gZGVzIGN1bHR1cmVzXShodHRwczovL3JhZGlhbnRlYXJ0aC5naXRodWIuaW8vc3RhYy1icm93c2VyLyMvZXh0ZXJuYWwvZGlnaXRhbC1hdGxhcy5zMy5hbWF6b25hd3MuY29tL3N0YWMvcHVibGljX3N0YWMvZXhwb3N1cmVfY2F0YWxvZy9tYXBzcGFtMjAxNy9tYXBzcGFtMjAxN192b3BfcGFycXVldC9tYXBzcGFtMjAxN192b3BfcGFycXVldC5qc29uKSBwcm92aWVubmVudCBkZSBNYXBTUEFNIDIwMTcgVjJyMyAoTW9kw6hsZSBkJ0FsbG9jYXRpb24gZGUgUHJvZHVjdGlvbiBTcGF0aWFsZSkgb8O5IGxlcyB2YWxldXJzIGRlIHByb2R1Y3Rpb24gc29udCBtdWx0aXBsacOpZXMgcGFyIGxlcyBwcml4IGludGVybmF0aW9uYXV4IGRlcyBjdWx0dXJlcyBkZSBsYSBGQU9zdGF0IHNww6ljaWZpcXVlcyDDoCBjaGFxdWUgcGF5cyBlbiAoZG9sbGFycyBpbnRlcm5hdGlvbmF1eCBkZSAyMDA1KS4gVW4gW2RvbGxhciBpbnRlcm5hdGlvbmFsXShodHRwczovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9JbnRlcm5hdGlvbmFsX2RvbGxhcikgKDIwMDUpIGVzdCB1bmUgdW5pdMOpIG1vbsOpdGFpcmUgaHlwb3Row6l0aXF1ZSBxdWkgYSBsYSBtw6ptZSBwYXJpdMOpIGRlIHBvdXZvaXIgZCdhY2hhdCBxdWUgbGUgZG9sbGFyIGFtw6lyaWNhaW4gYXV4IMOJdGF0cy1VbmlzIGVuIDIwMDUsIGNlIHF1aSBwZXJtZXQgZGUgY29tcGFyZXIgY2UgcXVlIGxlcyBjb25zb21tYXRldXJzIHBldXZlbnQgYWNoZXRlciBkYW5zIGRpZmbDqXJlbnRzIHBheXMgYXZlYyBsYSBtw6ptZSBzb21tZSBkJ2FyZ2VudC4gQ2V0IGVuc2VtYmxlIGRlIGRvbm7DqWVzIGVzdCB1bmUgdmVyc2lvbiBtaXNlIMOgIGpvdXIgZGUgTWFwU1BBTSBzcMOpY2lhbGVtZW50IGNvbsOndWUgcG91ciBjZSBwcm9qZXQuIElsIGNvbXByZW5kIGRlcyBjb3JyZWN0aW9ucyBkZSBib2d1ZXMgZXQgaW5jb3Jwb3JlIGRlcyB2YWxldXJzIGRlIHByb2R1Y3Rpb24gc3DDqWNpZmlxdWVzIMOgIGNoYXF1ZSBwYXlzIGF1IGxpZXUgZGUgbW95ZW5uZXMgbW9uZGlhbGVzLlxuXG5bTGEgdmFsZXVyIGRlIGxhIHByb2R1Y3Rpb24gYW5pbWFsZV0oaHR0cHM6Ly9yYWRpYW50ZWFydGguZ2l0aHViLmlvL3N0YWMtYnJvd3Nlci8jL2V4dGVybmFsL2RpZ2l0YWwtYXRsYXMuczMuYW1hem9uYXdzLmNvbS9zdGFjL3B1YmxpY19zdGFjL2V4cG9zdXJlX2NhdGFsb2cvR0xXM19saXZlc3RvY2svR0xXM19saXZlc3RvY2tfdm9wUFEvR0xXM19saXZlc3RvY2tfdm9wUFEuanNvbikgZW4gZG9sbGFycyBpbnRlcm5hdGlvbmF1eCBkZSAyMDA1IGEgw6l0w6kgZm91cm5pZSBwYXIgbGVzIGF1dGV1cnMgZGUgW0hlcnJlcm8gZXQgYWwuICgyMDEzKV0oaHR0cHM6Ly93d3cucG5hcy5vcmcvZG9pL2Z1bGwvMTAuMTA3My9wbmFzLjEzMDgxNDkxMTAvKS5cbmAsXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICBIYXphcmRzOiB7XG4gICAgICAgIHRpdGxlOiB7XG4gICAgICAgICAgZW46IFwiSGlzdG9yaWMgYW5kIGZ1dHVyZSBjbGltYXRlIGhhemFyZHNcIixcbiAgICAgICAgICBmcjogXCJSaXNxdWVzIGNsaW1hdGlxdWVzIGhpc3RvcmlxdWVzIGV0IGZ1dHVyc1wiLFxuICAgICAgICB9LFxuICAgICAgICB0ZXh0OiB7XG4gICAgICAgICAgZW46IG1kYFtDbGltYXRlIGhhemFyZHNdKGh0dHBzOi8vcmFkaWFudGVhcnRoLmdpdGh1Yi5pby9zdGFjLWJyb3dzZXIvIy9leHRlcm5hbC9kaWdpdGFsLWF0bGFzLnMzLmFtYXpvbmF3cy5jb20vc3RhYy9wdWJsaWNfc3RhYy9oYXphcmRfY2F0YWxvZy9jYXRhbG9nLmpzb24pIHdlcmUgY2FsY3VsYXRlZCB1c2luZyBmaXZlIGRhdGFzZXRzIFtDSElSUFNdKGh0dHBzOi8vd3d3LmNoYy51Y3NiLmVkdS9kYXRhL2NoaXJwcykvW0NISVJUU10oaHR0cHM6Ly93d3cuY2hjLnVjc2IuZWR1L2RhdGEvY2hpcnRzZGFpbHkpLCBbQWdFUkE1XShodHRwczovL2RvaS5vcmcvMTAuMjQzODEvY2RzLjZjNjhjOWJiKSwgW0NNSVA2IHByb2plY3Rpb25zXShodHRwczovL2dpdGh1Yi5jb20vU2FudGFuZGVyTWV0R3JvdXAvQVRMQVMpLCBhbmQgW2Nyb3AgY2FsZW5kYXJzXShodHRwczovL3plbm9kby5vcmcvcmVjb3Jkcy81MDYyNTEzKS4gVXNpbmcgdGhlIFIgd29ya2Zsb3dzIG1lbnRpb25lZCBiZWxvdyB0aGUgaGF6YXJkIHZhbHVlcyB3ZXJlIHN1bW1hcml6ZWQgZm9yIGVhY2ggMyBtb250aCB3aW5kb3cgYXMgd2VsbCBhcyB0aGUgYW5udWFsIGF2ZXJhZ2UgYW5kIGV4dHJhY3RlZCBieSBhZG1pbmlzdHJhdGl2ZSBib3VuZGFyaWVzIHRvIGdlbmVyYXRlIGEgdGFidWxhciBwYXJxdWV0IGRhdGFzZXQuYCxcbiAgICAgICAgICBmcjogbWRgW0xlcyByaXNxdWVzIGNsaW1hdGlxdWVzXShodHRwczovL3JhZGlhbnRlYXJ0aC5naXRodWIuaW8vc3RhYy1icm93c2VyLyMvZXh0ZXJuYWwvZGlnaXRhbC1hdGxhcy5zMy5hbWF6b25hd3MuY29tL3N0YWMvcHVibGljX3N0YWMvaGF6YXJkX2NhdGFsb2cvY2F0YWxvZy5qc29uKSBvbnQgw6l0w6kgY2FsY3Vsw6lzIMOgIGwnYWlkZSBkZSBjaW5xIGVuc2VtYmxlcyBkZSBkb25uw6llcyA6IFtDSElSUFNdKGh0dHBzOi8vd3d3LmNoYy51Y3NiLmVkdS9kYXRhL2NoaXJwcykvW0NISVJUU10oaHR0cHM6Ly93d3cuY2hjLnVjc2IuZWR1L2RhdGEvY2hpcnRzZGFpbHkpLCBbQWdFUkE1XShodHRwczovL2RvaS5vcmcvMTAuMjQzODEvY2RzLjZjNjhjOWJiKSwgW3Byb2plY3Rpb25zIENNSVA2XShodHRwczovL2dpdGh1Yi5jb20vU2FudGFuZGVyTWV0R3JvdXAvQVRMQVMpIGV0IFtjYWxlbmRyaWVycyBkZSBjdWx0dXJlc10oaHR0cHM6Ly96ZW5vZG8ub3JnL3JlY29yZHMvNTA2MjUxMykuIMOAIGwnYWlkZSBkZXMgZmx1eCBkZSB0cmF2YWlsIFIgbWVudGlvbm7DqXMgY2ktZGVzc291cywgbGVzIHZhbGV1cnMgZGUgcmlzcXVlIG9udCDDqXTDqSByw6lzdW3DqWVzIHBvdXIgY2hhcXVlIGZlbsOqdHJlIGRlIDMgbW9pcyBhaW5zaSBxdWUgbGEgbW95ZW5uZSBhbm51ZWxsZSBldCBleHRyYWl0ZXMgcGFyIGxpbWl0ZXMgYWRtaW5pc3RyYXRpdmVzIHBvdXIgZ8OpbsOpcmVyIHVuIGVuc2VtYmxlIGRlIGRvbm7DqWVzIGRlIHBhcnF1ZXQgdGFidWxhaXJlLmAsXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgIH0sXG4gIH0sXG4gIFNUQUM6IHtcbiAgICB0aXRsZToge1xuICAgICAgZW46IFwiTGVhcm4gYWJvdXQgdGhlIGRhdGEgaW4gdGhlIEF0bGFzIFNUQUNcIixcbiAgICAgIGZyOiBcIkVuIHNhdm9pciBwbHVzIHN1ciBsZXMgZG9ubsOpZXMgZGFucyBsJ0F0bGFzIFNUQUNcIixcbiAgICB9LFxuICAgIHRleHQ6IHtcbiAgICAgIGVuOiBgQnJvd3NlIGFuZCBhY2Nlc3MgZGF0YSB0aHJvdWdoIHRoZSBbU1RBQyAoU3BhdGlvIFRlbXBvcmFsIEFzc2V0IENhdGFsb2cpXShodHRwczovL3JhZGlhbnRlYXJ0aC5naXRodWIuaW8vc3RhYy1icm93c2VyLyMvZXh0ZXJuYWwvZGlnaXRhbC1hdGxhcy5zMy5hbWF6b25hd3MuY29tL3N0YWMvcHVibGljX3N0YWMvY2F0YWxvZy5qc29uKSBmb3IgYWxsIGRhdGFzZXRzIHJlbGF0ZWQgdG8gdGhlIEFmcmljYSBBZ3JpY3VsdHVyZSBBZGFwdGF0aW9uIEF0bGFzLiBUaGUgZGF0YSBwcm92aWRlZCBpbiB0aGlzIG5vdGVib29rIGlzIGxpbWl0ZWQgdG8gb3VyIHByb2Nlc3NlZCBhbmQgYWRtaW4gbGV2ZWwgZGF0YXNldHMuIEhvd2V2ZXIsIHJhc3RlciBkYXRhIGZvciBhbGwgb2Ygb3VyIGFuYWx5c2lzIGNhbiBiZSBmb3VuZCBhbmQgZG93bmxvYWRlZCB1c2luZyBvdXIgU1RBQyBhbmQgUzMgYnVja2V0LiBUaGUgYmVsb3cgZXhhbXBsZSB3aWxsIHdhbGsgeW91IHRocm91Z2ggaG93IHRvIGV4cGxvcmUgYW5kIGFjY2VzcyB0aGUgZGF0YSB1c2luZyB0aGUgU1RBQyBpbiBSIG9yIFB5dGhvbiwgb3IgZXhwbG9yZSB0aGUgZGF0YSB1c2luZyB0aGUgbm8tY29kZSBpbnRlcmZhY2UuYCxcbiAgICAgIGZyOiBgUGFyY291cmV6IGV0IGFjY8OpZGV6IGF1eCBkb25uw6llcyB2aWEgbGUgW1NUQUMgKENhdGFsb2d1ZSBkJ0FjdGlmcyBTcGF0aW8tVGVtcG9yZWxzKV0oaHR0cHM6Ly9yYWRpYW50ZWFydGguZ2l0aHViLmlvL3N0YWMtYnJvd3Nlci8jL2V4dGVybmFsL2RpZ2l0YWwtYXRsYXMuczMuYW1hem9uYXdzLmNvbS9zdGFjL3B1YmxpY19zdGFjL2NhdGFsb2cuanNvbikgcG91ciB0b3VzIGxlcyBlbnNlbWJsZXMgZGUgZG9ubsOpZXMgbGnDqXMgw6AgbCdBdGxhcyBBZnJpY2FpbiBkJ0FkYXB0YXRpb24gQWdyaWNvbGUuIExlcyBkb25uw6llcyBmb3VybmllcyBkYW5zIGNlIG5vdGVib29rIHNlIGxpbWl0ZW50IMOgIG5vcyBlbnNlbWJsZXMgZGUgZG9ubsOpZXMgdHJhaXTDqXMgZXQgYXUgbml2ZWF1IGFkbWluaXN0cmF0aWYuIENlcGVuZGFudCwgbGVzIGRvbm7DqWVzIHJhc3RlciBwb3VyIHRvdXRlcyBub3MgYW5hbHlzZXMgcGV1dmVudCDDqnRyZSB0cm91dsOpZXMgZXQgdMOpbMOpY2hhcmfDqWVzIGVuIHV0aWxpc2FudCBub3RyZSBTVEFDIGV0IG5vdHJlIGJ1Y2tldCBTMy4gTCdleGVtcGxlIGNpLWRlc3NvdXMgdm91cyBndWlkZXJhIHN1ciBsYSBtYW5pw6hyZSBkJ2V4cGxvcmVyIGV0IGQnYWNjw6lkZXIgYXV4IGRvbm7DqWVzIGVuIHV0aWxpc2FudCBsZSBTVEFDIGVuIFIgb3UgUHl0aG9uLCBvdSBkJ2V4cGxvcmVyIGxlcyBkb25uw6llcyBlbiB1dGlsaXNhbnQgbCdpbnRlcmZhY2Ugc2FucyBjb2RlLmAsXG4gICAgfSxcbiAgfSxcbiAgZ2VuZXJhbDoge1xuICAgIGhhemFyZHM6IHtcbiAgICAgIEhTSF9tZWFuOiB7XG4gICAgICAgIGVuOiBcIk1lYW4gSHVtYW4gSGVhdCBTdHJlc3NcIixcbiAgICAgICAgZnI6IFwiU3RyZXNzIHRoZXJtaXF1ZSBodW1haW4gbW95ZW5cIixcbiAgICAgIH0sXG4gICAgICBIU0hfbWF4OiB7XG4gICAgICAgIGVuOiBcIk1heCBIdW1hbiBIZWF0IFN0cmVzc1wiLFxuICAgICAgICBmcjogXCJTdHJlc3MgdGhlcm1pcXVlIGh1bWFpbiBtYXhpbWFsXCIsXG4gICAgICB9LFxuICAgICAgTkRXTDA6IHtcbiAgICAgICAgZW46IFwiTnVtYmVyIG9mIFdhdGVybG9nZ2luZyBEYXlzXCIsXG4gICAgICAgIGZyOiBcIk5vbWJyZSBkZSBqb3VycyBkZSBzYXR1cmF0aW9uIGVuIGVhdVwiLFxuICAgICAgfSxcbiAgICAgIE5EV1M6IHtcbiAgICAgICAgZW46IFwiTnVtYmVyIG9mIERheXMgb2YgV2F0ZXIgU3RyZXNzXCIsXG4gICAgICAgIGZyOiBcIk5vbWJyZSBkZSBqb3VycyBkZSBzdHJlc3MgaHlkcmlxdWVcIixcbiAgICAgIH0sXG4gICAgICBOVHgzNToge1xuICAgICAgICBlbjogXCJOdW1iZXIgb2YgSGVhdCBTdHJlc3MgRGF5cyBmb3IgTWFpemVcIixcbiAgICAgICAgZnI6IFwiTm9tYnJlIGRlIGpvdXJzIGRlIHN0cmVzcyB0aGVybWlxdWUgcG91ciBsZSBtYcOvc1wiLFxuICAgICAgfSxcbiAgICAgIE5UeDQwOiB7XG4gICAgICAgIGVuOiBcIk51bWJlciBvZiBIZWF0IFN0cmVzcyBEYXlzIGZvciBHZW5lcmljIENyb3BzXCIsXG4gICAgICAgIGZyOiBcIk5vbWJyZSBkZSBqb3VycyBkZSBzdHJlc3MgdGhlcm1pcXVlIHBvdXIgbGVzIGN1bHR1cmVzIGfDqW7DqXJpcXVlc1wiLFxuICAgICAgfSxcbiAgICAgIFRBSToge1xuICAgICAgICBlbjogXCJUaG9ybnRod2FpdGUncyBBcmlkaXR5IEluZGV4XCIsXG4gICAgICAgIGZyOiBcIkluZGljZSBkJ0FyaWRpdMOpIGRlIFRob3JudGh3YWl0ZVwiLFxuICAgICAgfSxcbiAgICAgIFRISV9tYXg6IHtcbiAgICAgICAgZW46IFwiTWF4IENhdHRsZSBUaGVybWFsIEh1bWlkaXR5IEluZGV4XCIsXG4gICAgICAgIGZyOiBcIkluZGljZSBkZSBUZW1ww6lyYXR1cmUtSHVtaWRpdMOpIE1heGltYWwgcG91ciBsZSBCw6l0YWlsXCIsXG4gICAgICB9LFxuICAgICAgVEhJX21lYW46IHtcbiAgICAgICAgZW46IFwiTWVhbiBDYXR0bGUgVGhlcm1hbCBIdW1pZGl0eSBJbmRleFwiLFxuICAgICAgICBmcjogXCJJbmRpY2UgZGUgVGVtcMOpcmF0dXJlLUh1bWlkaXTDqSBNb3llbiBwb3VyIGxlIELDqXRhaWwgXCIsXG4gICAgICB9LFxuICAgICAgVEFWRzogeyBlbjogXCJBdmVyYWdlIFRlbXBlcmF0dXJlXCIsIGZyOiBcIlRlbXDDqXJhdHVyZSBNb3llbm5lXCIgfSxcbiAgICAgIFBUT1Q6IHsgZW46IFwiVG90YWwgUHJlY2lwaXRhdGlvblwiLCBmcjogXCJQcsOpY2lwaXRhdGlvbiBUb3RhbGVcIiB9LFxuICAgIH0sXG4gICAgY29tbW9kaXRpZXM6IHtcbiAgICAgIHdoZWF0OiB7IGVuOiBcIldoZWF0XCIsIGZyOiBcIkJsw6lcIiB9LFxuICAgICAgcmljZTogeyBlbjogXCJSaWNlXCIsIGZyOiBcIlJpelwiIH0sXG4gICAgICBtYWl6ZTogeyBlbjogXCJNYWl6ZVwiLCBmcjogXCJNYcOvc1wiIH0sXG4gICAgICBiYXJsZXk6IHsgZW46IFwiQmFybGV5XCIsIGZyOiBcIk9yZ2VcIiB9LFxuICAgICAgXCJwZWFybCBtaWxsZXRcIjogeyBlbjogXCJQZWFybCBNaWxsZXRcIiwgZnI6IFwiTWlsbGV0IFBlcmzDqVwiIH0sXG4gICAgICBcInNtYWxsIG1pbGxldFwiOiB7IGVuOiBcIlNtYWxsIE1pbGxldFwiLCBmcjogXCJQZXRpdCBNaWxsZXRcIiB9LFxuICAgICAgc29yZ2h1bTogeyBlbjogXCJTb3JnaHVtXCIsIGZyOiBcIlNvcmdob1wiIH0sXG4gICAgICBwb3RhdG86IHsgZW46IFwiUG90YXRvXCIsIGZyOiBcIlBvbW1lIGRlIFRlcnJlXCIgfSxcbiAgICAgIFwic3dlZXQgcG90YXRvXCI6IHsgZW46IFwiU3dlZXQgUG90YXRvXCIsIGZyOiBcIlBhdGF0ZSBEb3VjZVwiIH0sXG4gICAgICB5YW1zOiB7IGVuOiBcIllhbXNcIiwgZnI6IFwiSWduYW1lXCIgfSxcbiAgICAgIGNhc3NhdmE6IHsgZW46IFwiQ2Fzc2F2YVwiLCBmcjogXCJNYW5pb2NcIiB9LFxuICAgICAgYmVhbjogeyBlbjogXCJCZWFuXCIsIGZyOiBcIkhhcmljb3RcIiB9LFxuICAgICAgY2hpY2twZWE6IHsgZW46IFwiQ2hpY2twZWFcIiwgZnI6IFwiUG9pcyBDaGljaGVcIiB9LFxuICAgICAgY293cGVhOiB7IGVuOiBcIkNvd3BlYVwiLCBmcjogXCJOacOpYsOpXCIgfSxcbiAgICAgIHBpZ2VvbnBlYTogeyBlbjogXCJQaWdlb25wZWFcIiwgZnI6IFwiUG9pcyBDYWphblwiIH0sXG4gICAgICBsZW50aWw6IHsgZW46IFwiTGVudGlsXCIsIGZyOiBcIkxlbnRpbGxlXCIgfSxcbiAgICAgIHNveWJlYW46IHsgZW46IFwiU295YmVhblwiLCBmcjogXCJTb2phXCIgfSxcbiAgICAgIGdyb3VuZG51dDogeyBlbjogXCJHcm91bmRudXRcIiwgZnI6IFwiQXJhY2hpZGVcIiB9LFxuICAgICAgY29jb251dDogeyBlbjogXCJDb2NvbnV0XCIsIGZyOiBcIk5vaXggZGUgQ29jb1wiIH0sXG4gICAgICBvaWxwYWxtOiB7IGVuOiBcIk9pbCBQYWxtXCIsIGZyOiBcIlBhbG1pZXIgw6AgSHVpbGVcIiB9LFxuICAgICAgc3VuZmxvd2VyOiB7IGVuOiBcIlN1bmZsb3dlclwiLCBmcjogXCJUb3VybmVzb2xcIiB9LFxuICAgICAgcmFwZXNlZWQ6IHsgZW46IFwiUmFwZXNlZWRcIiwgZnI6IFwiQ29semFcIiB9LFxuICAgICAgc2VzYW1lc2VlZDogeyBlbjogXCJTZXNhbWUgU2VlZFwiLCBmcjogXCJHcmFpbmVzIGRlIFPDqXNhbWVcIiB9LFxuICAgICAgc3VnYXJjYW5lOiB7IGVuOiBcIlN1Z2FyY2FuZVwiLCBmcjogXCJDYW5uZSDDoCBTdWNyZVwiIH0sXG4gICAgICBzdWdhcmJlZXQ6IHsgZW46IFwiU3VnYXJiZWV0XCIsIGZyOiBcIkJldHRlcmF2ZSDDoCBTdWNyZVwiIH0sXG4gICAgICBjb3R0b246IHsgZW46IFwiQ290dG9uXCIsIGZyOiBcIkNvdG9uXCIgfSxcbiAgICAgIFwiYXJhYmljYSBjb2ZmZWVcIjogeyBlbjogXCJBcmFiaWNhIENvZmZlZVwiLCBmcjogXCJDYWbDqSBBcmFiaWNhXCIgfSxcbiAgICAgIFwicm9idXN0YSBjb2ZmZWVcIjogeyBlbjogXCJSb2J1c3RhIENvZmZlZVwiLCBmcjogXCJDYWbDqSBSb2J1c3RhXCIgfSxcbiAgICAgIGNvY29hOiB7IGVuOiBcIkNvY29hXCIsIGZyOiBcIkNvY29hXCIgfSxcbiAgICAgIHRlYTogeyBlbjogXCJUZWFcIiwgZnI6IFwidGjDqVwiIH0sXG4gICAgICB0b2JhY2NvOiB7IGVuOiBcIlRvYmFjY29cIiwgZnI6IFwiVGFiYWNcIiB9LFxuICAgICAgYmFuYW5hOiB7IGVuOiBcIkJhbmFuYVwiLCBmcjogXCJCYW5hbmVcIiB9LFxuICAgICAgcGxhbnRhaW46IHsgZW46IFwiUGxhbnRhaW5cIiwgZnI6IFwiQmFuYW5lIFBsYW50YWluXCIgfSxcbiAgICAgIGNhdHRsZV90cm9waWNhbDogeyBlbjogXCJUcm9waWNhbCBDYXR0bGVcIiwgZnI6IFwiQm92aW5zIHRyb3BpY2F1eFwiIH0sXG4gICAgICBwb3VsdHJ5X3Ryb3BpY2FsOiB7IGVuOiBcIlRyb3BpY2FsIFBvdWx0cnlcIiwgZnI6IFwiVm9sYWlsbGUgdHJvcGljYWxlXCIgfSxcbiAgICAgIHBpZ3NfdHJvcGljYWw6IHsgZW46IFwiVHJvcGljYWwgUGlnc1wiLCBmcjogXCJQb3JjcyB0cm9waWNhdXhcIiB9LFxuICAgICAgc2hlZXBfdHJvcGljYWw6IHsgZW46IFwiVHJvcGljYWwgU2hlZXBcIiwgZnI6IFwiTW91dG9ucyB0cm9waWNhdXhcIiB9LFxuICAgICAgZ29hdHNfdHJvcGljYWw6IHsgZW46IFwiVHJvcGljYWwgR29hdHNcIiwgZnI6IFwiQ2jDqHZyZXMgdHJvcGljYWxlc1wiIH0sXG4gICAgICBjYXR0bGVfaGlnaGxhbmQ6IHtcbiAgICAgICAgZW46IFwiSGlnaGxhbmQgQ2F0dGxlXCIsXG4gICAgICAgIGZyOiBcIkJvdmlucyBkZXMgaGF1dHMgcGxhdGVhdXhcIixcbiAgICAgIH0sXG4gICAgICBwb3VsdHJ5X2hpZ2hsYW5kOiB7XG4gICAgICAgIGVuOiBcIkhpZ2hsYW5kIFBvdWx0cnlcIixcbiAgICAgICAgZnI6IFwiVm9sYWlsbGUgZGVzIGhhdXRzIHBsYXRlYXV4XCIsXG4gICAgICB9LFxuICAgICAgcGlnc19oaWdobGFuZDogeyBlbjogXCJIaWdobGFuZCBQaWdzXCIsIGZyOiBcIlBvcmNzIGRlcyBoYXV0cyBwbGF0ZWF1eFwiIH0sXG4gICAgICBzaGVlcF9oaWdobGFuZDoge1xuICAgICAgICBlbjogXCJIaWdobGFuZCBTaGVlcFwiLFxuICAgICAgICBmcjogXCJNb3V0b25zIGRlcyBoYXV0cyBwbGF0ZWF1eFwiLFxuICAgICAgfSxcbiAgICAgIGdvYXRzX2hpZ2hsYW5kOiB7XG4gICAgICAgIGVuOiBcIkhpZ2hsYW5kIEdvYXRzXCIsXG4gICAgICAgIGZyOiBcIkNow6h2cmVzIGRlcyBoYXV0cyBwbGF0ZWF1eFwiLFxuICAgICAgfSxcbiAgICB9LFxuICAgIGFkbWlubGV2ZWxzOiB7XG4gICAgICBhZG1pbjBfbmFtZTogeyBlbjogXCJDb3VudHJ5XCIsIGZyOiBcIlBheXNcIiB9LFxuICAgICAgYWRtaW4xX25hbWU6IHsgZW46IFwiUmVnaW9uXCIsIGZyOiBcIlLDqWdpb25cIiB9LFxuICAgICAgYWRtaW4yX25hbWU6IHsgZW46IFwiU3ViLVJlZ2lvblwiLCBmcjogXCJTb3VzLXLDqWdpb25cIiB9LFxuICAgIH0sXG4gICAgbGV2ZWxzOiB7XG4gICAgICBsb3c6IHsgZW46IFwiTG93XCIsIGZyOiBcIkZhaWJsZVwiIH0sXG4gICAgICBtb2RlcmF0ZTogeyBlbjogXCJNb2RlcmF0ZVwiLCBmcjogXCJNb2TDqXLDqVwiIH0sXG4gICAgICBzZXZlcmU6IHsgZW46IFwiU2V2ZXJlXCIsIGZyOiBcIlPDqXbDqHJlXCIgfSxcbiAgICAgIGV4dHJlbWU6IHsgZW46IFwiRXh0cmVtZVwiLCBmcjogXCJFeHRyw6ptZVwiIH0sXG4gICAgICBWZXh0cmVtZTogeyBlbjogXCJWZXJ5IEV4dHJlbWVcIiwgZnI6IFwiVHLDqHMgRXh0csOqbWVcIiB9LFxuICAgIH0sXG4gICAgc2VhcmNoOiB7IGVuOiBcIlNlYXJjaFwiLCBmcjogXCJSZWNoZXJjaGVyXCIgfSxcbiAgICBhY1ZhcnM6IHtcbiAgICAgIGRvbWVzdGljX3Zpb2xlbmNlOiB7XG4gICAgICAgIGVuOiBcIkRvbWVzdGljIFNhZmV0eVwiLFxuICAgICAgICBmcjogXCJTw6ljdXJpdMOpIERvbWVzdGlxdWVcIixcbiAgICAgIH0sXG4gICAgICBnZW5kZXJfZXF1aXR5OiB7XG4gICAgICAgIGVuOiBcIkdlbmRlciBFcXVpdHlcIixcbiAgICAgICAgZnI6IFwiw4lnYWxpdMOpIGRlcyBzZXhlc1wiLFxuICAgICAgfSxcbiAgICAgIGRlY2lzaW9uX21ha2luZzoge1xuICAgICAgICBlbjogXCJEZWNpc2lvbiBNYWtpbmcgUG93ZXJcIixcbiAgICAgICAgZnI6IFwiUG91dm9pciBkZSBkw6ljaXNpb25cIixcbiAgICAgIH0sXG4gICAgICBlZHVjYXRpb246IHtcbiAgICAgICAgZW46IFwiV29tZW5zIEVkdWNhdGlvblwiLFxuICAgICAgICBmcjogXCLDiWR1Y2F0aW9uIGRlcyBmZW1tZXNcIixcbiAgICAgIH0sXG4gICAgICBmYW1pbHlfcGxhbm5pbmc6IHtcbiAgICAgICAgZW46IFwiQWNjZXNzIHRvIEZhbWlseSBQbGFubmluZ1wiLFxuICAgICAgICBmcjogXCJBY2PDqHMgw6AgbGEgcGxhbmlmaWNhdGlvbiBmYW1pbGlhbGVcIixcbiAgICAgIH0sXG4gICAgICByZXByb2R1Y3RpdmVfaGVhbHRoOiB7XG4gICAgICAgIGVuOiBcIlJlcHJvZHVjdGl2ZSBIZWFsdGhcIixcbiAgICAgICAgZnI6IFwiU2FudMOpIHJlcHJvZHVjdGl2ZVwiLFxuICAgICAgfSxcbiAgICAgIEdTQVBfcG9vcjIxNToge1xuICAgICAgICBlbjogXCIlIHBvcHVsYXRpb24gdW5kZXIgJDIuMTVcIixcbiAgICAgICAgZnI6IFwiJSBkZSBsYSBwb3B1bGF0aW9uIHNvdXMgMiwxNSRcIixcbiAgICAgIH0sXG4gICAgICBHU0FQX3Bvb3IzNjU6IHtcbiAgICAgICAgZW46IFwiJSBwb3B1bGF0aW9uIHVuZGVyICQzLjY1XCIsXG4gICAgICAgIGZyOiBcIiUgZGUgbGEgcG9wdWxhdGlvbiBzb3VzIDMsNjUkXCIsXG4gICAgICB9LFxuICAgICAgR1NBUF9wb29yNjg1OiB7XG4gICAgICAgIGVuOiBcIiUgcG9wdWxhdGlvbiB1bmRlciAkNi44NVwiLFxuICAgICAgICBmcjogXCIlIGRlIGxhIHBvcHVsYXRpb24gc291cyA2LDg1JFwiLFxuICAgICAgfSxcbiAgICAgIGVkdWNhdGlvbllyczoge1xuICAgICAgICBlbjogXCJFZHVjYXRpb24oWXJzKVwiLFxuICAgICAgICBmcjogXCLDiWR1Y2F0aW9uIChhbm7DqWVzKVwiLFxuICAgICAgfSxcbiAgICB9LFxuICAgIGFkbWluTmFtZXM6IHtcbiAgICAgIFwiRnVsbCBDb3VudHJ5XCI6IHsgZW46IFwiRnVsbCBDb3VudHJ5XCIsIGZyOiBcIlBheXMgRW50aWVyXCIgfSxcbiAgICAgIFwiRnVsbCBSZWdpb25cIjogeyBlbjogXCJGdWxsIFJlZ2lvblwiLCBmcjogXCJSw6lnaW9uIGNvbXBsw6h0ZVwiIH0sXG4gICAgICBBbmdvbGE6IHtcbiAgICAgICAgZW46IFwiQW5nb2xhXCIsXG4gICAgICAgIGZyOiBcIkFuZ29sYVwiLFxuICAgICAgfSxcbiAgICAgIEJlbmluOiB7XG4gICAgICAgIGVuOiBcIkJlbmluXCIsXG4gICAgICAgIGZyOiBcIkLDqW5pblwiLFxuICAgICAgfSxcbiAgICAgIEJvdHN3YW5hOiB7XG4gICAgICAgIGVuOiBcIkJvdHN3YW5hXCIsXG4gICAgICAgIGZyOiBcIkJvdHN3YW5hXCIsXG4gICAgICB9LFxuICAgICAgXCJCdXJraW5hIEZhc29cIjoge1xuICAgICAgICBlbjogXCJCdXJraW5hIEZhc29cIixcbiAgICAgICAgZnI6IFwiQnVya2luYSBGYXNvXCIsXG4gICAgICB9LFxuICAgICAgQnVydW5kaToge1xuICAgICAgICBlbjogXCJCdXJ1bmRpXCIsXG4gICAgICAgIGZyOiBcIkJ1cnVuZGlcIixcbiAgICAgIH0sXG4gICAgICBDYW1lcm9vbjoge1xuICAgICAgICBlbjogXCJDYW1lcm9vblwiLFxuICAgICAgICBmcjogXCJDYW1lcm91blwiLFxuICAgICAgfSxcbiAgICAgIFwiQ2VudHJhbCBBZnJpY2FuIFJlcHVibGljXCI6IHtcbiAgICAgICAgZW46IFwiQ2VudHJhbCBBZnJpY2FuIFJlcHVibGljXCIsXG4gICAgICAgIGZyOiBcIlLDqXB1YmxpcXVlIENlbnRyYWZyaWNhaW5lXCIsXG4gICAgICB9LFxuICAgICAgQ2hhZDoge1xuICAgICAgICBlbjogXCJDaGFkXCIsXG4gICAgICAgIGZyOiBcIlRjaGFkXCIsXG4gICAgICB9LFxuICAgICAgXCJDb25nbyAtIEJyYXp6YXZpbGxlXCI6IHtcbiAgICAgICAgZW46IFwiQ29uZ28gLSBCcmF6emF2aWxsZVwiLFxuICAgICAgICBmcjogXCJDb25nbyAtIEJyYXp6YXZpbGxlXCIsXG4gICAgICB9LFxuICAgICAgXCJDb25nbyAtIEtpbnNoYXNhXCI6IHtcbiAgICAgICAgZW46IFwiQ29uZ28gLSBLaW5zaGFzYVwiLFxuICAgICAgICBmcjogXCJDb25nbyAtIEtpbnNoYXNhXCIsXG4gICAgICB9LFxuICAgICAgXCJDw7R0ZSBk4oCZSXZvaXJlXCI6IHtcbiAgICAgICAgZW46IFwiQ8O0dGUgZOKAmUl2b2lyZVwiLFxuICAgICAgICBmcjogXCJDw7R0ZSBk4oCZSXZvaXJlXCIsXG4gICAgICB9LFxuICAgICAgRGppYm91dGk6IHtcbiAgICAgICAgZW46IFwiRGppYm91dGlcIixcbiAgICAgICAgZnI6IFwiRGppYm91dGlcIixcbiAgICAgIH0sXG4gICAgICBcIkVxdWF0b3JpYWwgR3VpbmVhXCI6IHtcbiAgICAgICAgZW46IFwiRXF1YXRvcmlhbCBHdWluZWFcIixcbiAgICAgICAgZnI6IFwiR3VpbsOpZSDDiXF1YXRvcmlhbGVcIixcbiAgICAgIH0sXG4gICAgICBFcml0cmVhOiB7XG4gICAgICAgIGVuOiBcIkVyaXRyZWFcIixcbiAgICAgICAgZnI6IFwiw4lyeXRocsOpZVwiLFxuICAgICAgfSxcbiAgICAgIEVzd2F0aW5pOiB7XG4gICAgICAgIGVuOiBcIkVzd2F0aW5pXCIsXG4gICAgICAgIGZyOiBcIkVzd2F0aW5pXCIsXG4gICAgICB9LFxuICAgICAgRXRoaW9waWE6IHtcbiAgICAgICAgZW46IFwiRXRoaW9waWFcIixcbiAgICAgICAgZnI6IFwiw4l0aGlvcGllXCIsXG4gICAgICB9LFxuICAgICAgR2Fib246IHtcbiAgICAgICAgZW46IFwiR2Fib25cIixcbiAgICAgICAgZnI6IFwiR2Fib25cIixcbiAgICAgIH0sXG4gICAgICBHYW1iaWE6IHtcbiAgICAgICAgZW46IFwiR2FtYmlhXCIsXG4gICAgICAgIGZyOiBcIkdhbWJpZVwiLFxuICAgICAgfSxcbiAgICAgIEdoYW5hOiB7XG4gICAgICAgIGVuOiBcIkdoYW5hXCIsXG4gICAgICAgIGZyOiBcIkdoYW5hXCIsXG4gICAgICB9LFxuICAgICAgR3VpbmVhOiB7XG4gICAgICAgIGVuOiBcIkd1aW5lYVwiLFxuICAgICAgICBmcjogXCJHdWluw6llXCIsXG4gICAgICB9LFxuICAgICAgXCJHdWluZWEtQmlzc2F1XCI6IHtcbiAgICAgICAgZW46IFwiR3VpbmVhLUJpc3NhdVwiLFxuICAgICAgICBmcjogXCJHdWluw6llLUJpc3NhdVwiLFxuICAgICAgfSxcbiAgICAgIEtlbnlhOiB7XG4gICAgICAgIGVuOiBcIktlbnlhXCIsXG4gICAgICAgIGZyOiBcIktlbnlhXCIsXG4gICAgICB9LFxuICAgICAgTGVzb3Robzoge1xuICAgICAgICBlbjogXCJMZXNvdGhvXCIsXG4gICAgICAgIGZyOiBcIkxlc290aG9cIixcbiAgICAgIH0sXG4gICAgICBMaWJlcmlhOiB7XG4gICAgICAgIGVuOiBcIkxpYmVyaWFcIixcbiAgICAgICAgZnI6IFwiTGliw6lyaWFcIixcbiAgICAgIH0sXG4gICAgICBNYWRhZ2FzY2FyOiB7XG4gICAgICAgIGVuOiBcIk1hZGFnYXNjYXJcIixcbiAgICAgICAgZnI6IFwiTWFkYWdhc2NhclwiLFxuICAgICAgfSxcbiAgICAgIE1hbGF3aToge1xuICAgICAgICBlbjogXCJNYWxhd2lcIixcbiAgICAgICAgZnI6IFwiTWFsYXdpXCIsXG4gICAgICB9LFxuICAgICAgTWFsaToge1xuICAgICAgICBlbjogXCJNYWxpXCIsXG4gICAgICAgIGZyOiBcIk1hbGlcIixcbiAgICAgIH0sXG4gICAgICBNYXVyaXRhbmlhOiB7XG4gICAgICAgIGVuOiBcIk1hdXJpdGFuaWFcIixcbiAgICAgICAgZnI6IFwiTWF1cml0YW5pZVwiLFxuICAgICAgfSxcbiAgICAgIE1vemFtYmlxdWU6IHtcbiAgICAgICAgZW46IFwiTW96YW1iaXF1ZVwiLFxuICAgICAgICBmcjogXCJNb3phbWJpcXVlXCIsXG4gICAgICB9LFxuICAgICAgTmFtaWJpYToge1xuICAgICAgICBlbjogXCJOYW1pYmlhXCIsXG4gICAgICAgIGZyOiBcIk5hbWliaWVcIixcbiAgICAgIH0sXG4gICAgICBOaWdlcjoge1xuICAgICAgICBlbjogXCJOaWdlclwiLFxuICAgICAgICBmcjogXCJOaWdlclwiLFxuICAgICAgfSxcbiAgICAgIE5pZ2VyaWE6IHtcbiAgICAgICAgZW46IFwiTmlnZXJpYVwiLFxuICAgICAgICBmcjogXCJOaWfDqXJpYVwiLFxuICAgICAgfSxcbiAgICAgIFJ3YW5kYToge1xuICAgICAgICBlbjogXCJSd2FuZGFcIixcbiAgICAgICAgZnI6IFwiUndhbmRhXCIsXG4gICAgICB9LFxuICAgICAgU2VuZWdhbDoge1xuICAgICAgICBlbjogXCJTZW5lZ2FsXCIsXG4gICAgICAgIGZyOiBcIlPDqW7DqWdhbFwiLFxuICAgICAgfSxcbiAgICAgIFwiU2llcnJhIExlb25lXCI6IHtcbiAgICAgICAgZW46IFwiU2llcnJhIExlb25lXCIsXG4gICAgICAgIGZyOiBcIlNpZXJyYSBMZW9uZVwiLFxuICAgICAgfSxcbiAgICAgIFNvbWFsaWE6IHtcbiAgICAgICAgZW46IFwiU29tYWxpYVwiLFxuICAgICAgICBmcjogXCJTb21hbGllXCIsXG4gICAgICB9LFxuICAgICAgXCJTb3V0aCBBZnJpY2FcIjoge1xuICAgICAgICBlbjogXCJTb3V0aCBBZnJpY2FcIixcbiAgICAgICAgZnI6IFwiQWZyaXF1ZSBkdSBTdWRcIixcbiAgICAgIH0sXG4gICAgICBcIlNvdXRoIFN1ZGFuXCI6IHtcbiAgICAgICAgZW46IFwiU291dGggU3VkYW5cIixcbiAgICAgICAgZnI6IFwiU291ZGFuIGR1IFN1ZFwiLFxuICAgICAgfSxcbiAgICAgIFN1ZGFuOiB7XG4gICAgICAgIGVuOiBcIlN1ZGFuXCIsXG4gICAgICAgIGZyOiBcIlNvdWRhblwiLFxuICAgICAgfSxcbiAgICAgIFRhbnphbmlhOiB7XG4gICAgICAgIGVuOiBcIlRhbnphbmlhXCIsXG4gICAgICAgIGZyOiBcIlRhbnphbmllXCIsXG4gICAgICB9LFxuICAgICAgVG9nbzoge1xuICAgICAgICBlbjogXCJUb2dvXCIsXG4gICAgICAgIGZyOiBcIlRvZ29cIixcbiAgICAgIH0sXG4gICAgICBVZ2FuZGE6IHtcbiAgICAgICAgZW46IFwiVWdhbmRhXCIsXG4gICAgICAgIGZyOiBcIk91Z2FuZGFcIixcbiAgICAgIH0sXG4gICAgICBaYW1iaWE6IHtcbiAgICAgICAgZW46IFwiWmFtYmlhXCIsXG4gICAgICAgIGZyOiBcIlphbWJpZVwiLFxuICAgICAgfSxcbiAgICAgIFppbWJhYndlOiB7XG4gICAgICAgIGVuOiBcIlppbWJhYndlXCIsXG4gICAgICAgIGZyOiBcIlppbWJhYndlXCIsXG4gICAgICB9LFxuICAgICAgU1NBOiB7XG4gICAgICAgIGVuOiBcIlN1Yi1TYWhhcmFuIEFmcmljYVwiLFxuICAgICAgICBmcjogXCJBZnJpcXVlIFN1YnNhaGFyaWVubmVcIixcbiAgICAgIH0sXG4gICAgICBcIlN1Yi1TYWhhcmFuIEFmcmljYVwiOiB7XG4gICAgICAgIGVuOiBcIlN1Yi1TYWhhcmFuIEFmcmljYVwiLFxuICAgICAgICBmcjogXCJBZnJpcXVlIFN1YnNhaGFyaWVubmVcIixcbiAgICAgIH0sXG4gICAgfSxcbiAgICB1bml0czoge1xuICAgICAgaW5kZXg6IHsgZW46IFwiSW5kZXhcIiwgZnI6IFwiSW5kaWNlXCIgfSxcbiAgICAgIGRheXM6IHsgZW46IFwiRGF5c1wiLCBmcjogXCJKb3Vyc1wiIH0sXG4gICAgICB5cnM6IHsgZW46IFwiWWVhcnNcIiwgZnI6IFwiQW5uw6llc1wiIH0sXG4gICAgICBudW1fcGVvcGxlOiB7IGVuOiBcIk51bS4gUGVvcGxlXCIsIGZyOiBcIk5iLiBQZXJzb25uZXNcIiB9LFxuICAgICAgbnVtX2FuaW1hbHM6IHsgZW46IFwiTnVtLiBBbmltYWxzXCIsIGZyOiBcIk5iLiBBbmltYXV4XCIgfSxcbiAgICB9LFxuICAgIE5vQ29kZTogeyBlbjogXCJObyBDb2RlXCIsIGZyOiBcIlNhbnMgQ29kZVwiIH0sXG4gIH0sXG59KTtcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTMwIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiZGVmaW5pdGlvblRleHQgPSBuZXcgT2JqZWN0KHtcbiAgSGF6YXJkOiB7XG4gICAgdGl0bGU6IHsgZW46IFwiSGF6YXJkIERlZmluaXRpb25zXCIsIGZyOiBcIkTDqWZpbml0aW9ucyBkZXMgQWzDqWFzXCIgfSxcbiAgICB0ZXh0OiB7XG4gICAgICBlbjogYCMjIyMgTWF4IEh1bWFuIEhlYXQgU3RyZXNzIChIU0hfbWF4KTogIFxuKipUaHJlc2hvbGRzOioqXG5cbnwgSGF6YXJkIExldmVsIHwgVmFsdWUgfFxufC0tLS0tLS0tLS0tLS0tfC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18XG58IExvdyAgICAgICAgICB8IOKJpCAyNyAgICAgICAgICAgICAgICAgICAgICAgfFxufCBNb2RlcmF0ZSAgICAgfCA+IDI3IGFuZCDiiaQgMzIgICAgICAgICAgICAgIHxcbnwgSGlnaCAgICAgICAgIHwgPiAzMiBhbmQg4omkIDQxICAgICAgICAgICAgICB8XG58IEV4dHJlbWUgICAgICB8ID4gNDEgYW5kIOKJpCA1NCAgICAgICAgICAgICAgfFxufCBWZXJ5IEV4dHJlbWUgfCA+IDU0ICAgICAgICAgICAgICAgICAgICAgICB8XG5cbioqRGVmaW5pdGlvbjoqKiBIdW1hbiBoZWF0IHN0cmVzcyBpbmRleCwgbWF4aW11bSB2YWx1ZSBvZiB0aGUgZ3Jvd2luZyBzZWFzb24uICBcbioqRGVzY3JpcHRpb246KiogVGhlIGhlYXQgaW5kZXggKEhJKSBpcyBjYWxjdWxhdGVkIHVzaW5nIGRhaWx5IGRhdGEgYW5kIGVtcGlyaWNhbCBlcXVhdGlvbnMgYmFzZWQgb24gU3RlYWRtYW4gKDE5NzlhOyAxOTc5YiksIHJlbGF0aW5nIHRoZSBISSB0byBkcnktYnVsYiB0ZW1wZXJhdHVyZSAowrBDKSBhbmQgcmVsYXRpdmUgaHVtaWRpdHkgKCUpLiBUaGUgbWF4aW11bSB2YWx1ZSBmb3IgZWFjaCBtb250aCBpcyBmaXJzdCBjYWxjdWxhdGVkLCBmb2xsb3dlZCBieSB0aGUgY2xpbWF0b2xvZ2ljYWwgbWVhbiBvZiBlYWNoIG1vbnRoLCBhbmQgdGhlbiB0aGUgbWF4aW11bSwgbWVhbiwgYW5kIG1lZGlhbiBvZiB0aGUgeWVhci4gIFxuKipVbml0czoqKiBJbmRleCAoSEkpICBcblxuIyMjIyBNZWFuIEh1bWFuIEhlYXQgU3RyZXNzIChIU0hfbWVhbik6ICBcbioqVGhyZXNob2xkczoqKiBcblxufCBIYXphcmQgTGV2ZWwgfCBWYWx1ZSB8XG58LS0tLS0tLS0tLS0tLS18LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXxcbnwgTG93ICAgICAgICAgIHwg4omkIDI3ICAgICAgICAgICAgICAgICAgICAgICB8XG58IE1vZGVyYXRlICAgICB8ID4gMjcgYW5kIOKJpCAzMiAgICAgICAgICAgICAgfFxufCBIaWdoICAgICAgICAgfCA+IDMyIGFuZCDiiaQgNDEgICAgICAgICAgICAgIHxcbnwgRXh0cmVtZSAgICAgIHwgPiA0MSBhbmQg4omkIDU0ICAgICAgICAgICAgICB8XG58IFZlcnkgRXh0cmVtZSB8ID4gNTQgICAgICAgICAgICAgICAgICAgICAgIHxcblxuKipEZWZpbml0aW9uOioqIEh1bWFuIGhlYXQgc3RyZXNzIGluZGV4LCBtZWFuIG9mIHRoZSBncm93aW5nIHNlYXNvbi4gIFxuKipEZXNjcmlwdGlvbjoqKiBUaGUgaGVhdCBpbmRleCAoSEkpIGlzIGNhbGN1bGF0ZWQgdXNpbmcgZGFpbHkgZGF0YSBhbmQgZW1waXJpY2FsIGVxdWF0aW9ucyBiYXNlZCBvbiBTdGVhZG1hbiAoMTk3OWE7IDE5NzliKSwgcmVsYXRpbmcgdGhlIEhJIHRvIGRyeS1idWxiIHRlbXBlcmF0dXJlICjCsEMpIGFuZCByZWxhdGl2ZSBodW1pZGl0eSAoJSkuIFRoZSBtZWFuIHZhbHVlIGZvciBlYWNoIG1vbnRoIGlzIGZpcnN0IGNhbGN1bGF0ZWQsIGZvbGxvd2VkIGJ5IHRoZSBjbGltYXRvbG9naWNhbCBtZWFuIG9mIGVhY2ggbW9udGgsIGFuZCB0aGVuIHRoZSBtYXhpbXVtLCBtZWFuLCBhbmQgbWVkaWFuIG9mIHRoZSB5ZWFyLiAgXG4qKlVuaXRzOioqIEluZGV4IChISSkgIFxuXG4jIyMjIE51bWJlciBvZiBXYXRlcmxvZ2dpbmcgRGF5cyAoTkRXTDApOiAgXG4qKlRocmVzaG9sZHM6KiogICBcblxufCBIYXphcmQgTGV2ZWwgfCBWYWx1ZSB8XG58LS0tLS0tLS0tLS0tLS18LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXxcbnwgTG93ICAgICAgICAgIHwg4omkIDIgICAgICAgICAgICAgICAgICAgICAgICB8XG58IE1vZGVyYXRlICAgICB8ID4gMiBhbmQg4omkIDUgICAgICAgICAgICAgICAgfFxufCBIaWdoICAgICAgICAgfCA+IDIgYW5kIOKJpCA4ICAgICAgICAgICAgICAgIHxcbnwgRXh0cmVtZSAgICAgIHwgPiA4ICAgICAgICAgICAgICAgICAgICAgICAgfFxuXG4qKkRlZmluaXRpb246KiogVG90YWwgbnVtYmVyIG9mIHdhdGVybG9nZ2luZyBkYXlzIChhdCBzdGFydGluZyBzYXR1cmF0aW9uLCAwJSkgcGVyIHNlYXNvbi4gIFxuKipEZXNjcmlwdGlvbjoqKiBBIHdhdGVybG9nZ2luZyBkYXkgb2NjdXJzIHdoZW4gdGhlIHNvaWwgbW9pc3R1cmUgaXMganVzdCBhYm92ZSBmaWVsZCBjYXBhY2l0eSBhbmQgbW92aW5nIHRvd2FyZCBzYXR1cmF0aW9uLiBUaGlzIGluZGV4IGlzIGNhbGN1bGF0ZWQgdXNpbmcgYSBzaW1wbGUgd2F0ZXIgYmFsYW5jZSBtb2RlbCB0aGF0IHV0aWxpemVzIGRhaWx5IHByZWNpcGl0YXRpb24gZnJvbSBDSElSUFMsIGRhaWx5IHRlbXBlcmF0dXJlcyBmcm9tIENISVJUUywgYW5kIHNvbGFyIHJhZGlhdGlvbiBmcm9tIEFnRVJBNS4gIFxuKipVbml0czoqKiBEYXlzICBcblxuIyMjIyBOdW1iZXIgb2YgRGF5cyBvZiBXYXRlciBTdHJlc3MgKE5EV1MpOiAgXG4qKlRocmVzaG9sZHM6KiogICBcblxufCBIYXphcmQgTGV2ZWwgfCBWYWx1ZSB8XG58LS0tLS0tLS0tLS0tLS18LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXxcbnwgTG93ICAgICAgICAgIHwg4omkIDE1ICAgICAgICAgICAgICAgICAgICAgICB8XG58IE1vZGVyYXRlICAgICB8ID4gMTUgYW5kIOKJpCAyMCAgICAgICAgICAgICAgfFxufCBIaWdoICAgICAgICAgfCA+IDIwIGFuZCDiiaQgMjUgICAgICAgICAgICAgIHxcbnwgRXh0cmVtZSAgICAgIHwgPiAyNSAgICAgICAgICAgICAgICAgICAgICAgfFxuXG4qKkRlZmluaXRpb246KiogVG90YWwgbnVtYmVyIG9mIHdhdGVyIHN0cmVzcyBkYXlzIHBlciBzZWFzb24uICBcbioqRGVzY3JpcHRpb246KiogQSB3YXRlciBzdHJlc3MgZGF5IGlzIGRlZmluZWQgYXMgYSBkYXkgaW4gd2hpY2ggdGhlIHJhdGlvIG9mIGFjdHVhbCB0byBwb3RlbnRpYWwgZXZhcG90cmFuc3BpcmF0aW9uIGlzIGxlc3MgdGhhbiAwLjUuIFRoaXMgaW5kZXggaXMgY2FsY3VsYXRlZCB1c2luZyBhIHNpbXBsZSB3YXRlciBiYWxhbmNlIG1vZGVsIHRoYXQgdXRpbGl6ZXMgZGFpbHkgcHJlY2lwaXRhdGlvbiBmcm9tIENISVJQUywgZGFpbHkgdGVtcGVyYXR1cmVzIGZyb20gQ0hJUlRTLCBhbmQgc29sYXIgcmFkaWF0aW9uIGZyb20gQWdFUkE1LiAgXG4qKlVuaXRzOioqIERheXMgIFxuXG4jIyMjIE51bWJlciBvZiBIZWF0IFN0cmVzcyBEYXlzIGZvciBNYWl6ZSAoTlR4MzUpOiAgXG4qKlRocmVzaG9sZHM6KiogIFxuXG58IEhhemFyZCBMZXZlbCB8IFZhbHVlIHxcbnwtLS0tLS0tLS0tLS0tLXwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfFxufCBMb3cgICAgICAgICAgfCDiiaQgMTAgICAgICAgICAgICAgICAgICAgICAgIHxcbnwgTW9kZXJhdGUgICAgIHwgPiAxMCBhbmQg4omkIDIwICAgICAgICAgICAgICB8XG58IEhpZ2ggICAgICAgICB8ID4gMjAgYW5kIOKJpCAyNSAgICAgICAgICAgICAgfFxufCBFeHRyZW1lICAgICAgfCA+IDI1ICAgICAgICAgICAgICAgICAgICAgICB8XG5cbioqRGVmaW5pdGlvbjoqKiBUb3RhbCBudW1iZXIgb2YgaGVhdCBzdHJlc3MgZGF5cyBwZXIgc2Vhc29uIGZvciBtYWl6ZS4gIFxuKipEZXNjcmlwdGlvbjoqKiBUaGUgbnVtYmVyIG9mIGRheXMgd2l0aCBkYWlseSBtYXhpbXVtIHRlbXBlcmF0dXJlcyBhYm92ZSAzNcKwQyBkdXJpbmcgdGhlIGdyb3dpbmcgc2Vhc29uLCB1c2luZyBhIG1haXplIGNyb3AgY2FsZW5kYXIuICBcbioqVW5pdHM6KiogRGF5cyAgXG5cbiMjIyMgTnVtYmVyIG9mIEhlYXQgU3RyZXNzIERheXMgZm9yIEdlbmVyaWMgQ3JvcHMgKE5UeDQwKTogIFxuKipUaHJlc2hvbGRzOioqICBcblxufCBIYXphcmQgTGV2ZWwgfCBWYWx1ZSB8XG58LS0tLS0tLS0tLS0tLS18LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXxcbnwgTG93ICAgICAgICAgIHwg4omkIDEgICAgICAgICAgICAgICAgICAgICAgICB8XG58IE1vZGVyYXRlICAgICB8ID4gMSBhbmQg4omkIDUgICAgICAgICAgICAgICAgfFxufCBIaWdoICAgICAgICAgfCA+IDUgYW5kIOKJpCAxMCAgICAgICAgICAgICAgIHxcbnwgRXh0cmVtZSAgICAgIHwgPiAxMCAgICAgICAgICAgICAgICAgICAgICAgfFxuXG4qKkRlZmluaXRpb246KiogVG90YWwgbnVtYmVyIG9mIGhlYXQgc3RyZXNzIGRheXMgcGVyIHNlYXNvbiBmb3IgZ2VuZXJpYyBjcm9wcy4gIFxuKipEZXNjcmlwdGlvbjoqKiBUaGUgbnVtYmVyIG9mIGRheXMgd2l0aCBkYWlseSBtYXhpbXVtIHRlbXBlcmF0dXJlcyBhYm92ZSA0MMKwQyBwZXIgbW9udGgsIHdpdGhvdXQgdXNpbmcgYSBjcm9wIGNhbGVuZGFyLiAgXG4qKlVuaXRzOioqIERheXMgIFxuXG4jIyMjIFRob3JudGh3YWl0ZSdzIEFyaWRpdHkgSW5kZXggKFRBSSk6ICBcbioqVGhyZXNob2xkczoqKiAgIFxuXG58IEhhemFyZCBMZXZlbCB8IFZhbHVlIHxcbnwtLS0tLS0tLS0tLS0tLXwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfFxufCBMb3cgICAgICAgICAgfCDiiaQgNDAgICAgICAgICAgICAgICAgICAgICAgIHxcbnwgTW9kZXJhdGUgICAgIHwgPiA0MCBhbmQg4omkIDYwICAgICAgICAgICAgICB8XG58IEhpZ2ggICAgICAgICB8ID4gNjAgYW5kIOKJpCA4MCAgICAgICAgICAgICAgfFxufCBFeHRyZW1lICAgICAgfCA+IDgwICAgICAgICAgICAgICAgICAgICAgICB8XG5cbioqRGVmaW5pdGlvbjoqKiBUaG9ybnRod2FpdGUncyBBcmlkaXR5IEluZGV4LiAgXG4qKkRlc2NyaXB0aW9uOioqIFRoZSBUaG9ybnRod2FpdGUgYXJpZGl0eSBpbmRleCBpcyBjYWxjdWxhdGVkIGFzIDEwMCBYIChkIC8gbiksIHdoZXJlIGQgaXMgdGhlIHN1bSBvZiBtb250aGx5IGRpZmZlcmVuY2VzIGJldHdlZW4gcHJlY2lwaXRhdGlvbiBhbmQgUEVUIGZvciBtb250aHMgd2hlcmUgcHJlY2lwaXRhdGlvbiBpcyBsZXNzIHRoYW4gUEVULCBhbmQgbiBpcyB0aGUgc3VtIG9mIG1vbnRobHkgUEVUIGZvciB0aG9zZSBtb250aHMuICBcbioqVW5pdHM6KiogSW5kZXggIFxuXG4jIyMjIE1heCBDYXR0bGUgVGhlcm1hbCBIdW1pZGl0eSBJbmRleCAoVEhJX21heCk6ICBcbioqVGhyZXNob2xkczoqKiAgIFxuXG58IEhhemFyZCBMZXZlbCB8IFZhbHVlIHxcbnwtLS0tLS0tLS0tLS0tLXwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfFxufCBMb3cgICAgICAgICAgfCDiiaQgNzIgICAgICAgICAgICAgICAgICAgICAgIHxcbnwgTW9kZXJhdGUgICAgIHwgPiA3MiBhbmQg4omkIDc4ICAgICAgICAgICAgICB8XG58IEhpZ2ggICAgICAgICB8ID4gNzggYW5kIOKJpCA5MCAgICAgICAgICAgICAgfFxufCBFeHRyZW1lICAgICAgfCA+IDkwICAgICAgICAgICAgICAgICAgICAgICB8XG5cbioqRGVmaW5pdGlvbjoqKiBDYXR0bGUgdGhlcm1hbCBodW1pZGl0eSBpbmRleCwgbWF4aW11bSB2YWx1ZSBvZiB0aGUgc2Vhc29uLiAgXG4qKkRlc2NyaXB0aW9uOioqIFRoZSBoZWF0IGluZGV4IChISSkgZm9yIGNhdHRsZSBpcyBjYWxjdWxhdGVkIHVzaW5nIGRhaWx5IGRhdGEgYW5kIGVtcGlyaWNhbCBlcXVhdGlvbnMgYmFzZWQgb24gUmFoaW1pIGV0IGFsLiAoMjAyMCkuIFRoZSBUSEkgaXMgY2FsY3VsYXRlZCBhcyBUSEkxID0gKDEuOCDDlyBUZGIgKyAzMikgLSBbKDAuNTUgLSAwLjAwNTUgw5cgUkgpIMOXICgxLjggw5cgVGRiIC0gMjYuOCldLCB3aGVyZSBUZGIgaXMgdGhlIGRyeSBidWxiIHRlbXBlcmF0dXJlIChtYXhpbXVtIHRlbXBlcmF0dXJlLCDCsEMpLCBhbmQgUkggaXMgdGhlIHJlbGF0aXZlIGh1bWlkaXR5ICglKS4gIFxuKipVbml0czoqKiBJbmRleCAoVEhJKSAgXG5cbiMjIyMgTWVhbiBDYXR0bGUgVGhlcm1hbCBIdW1pZGl0eSBJbmRleCAoVEhJX21lYW4pOiAgXG4qKlRocmVzaG9sZHM6KiogICBcblxufCBIYXphcmQgTGV2ZWwgfCBWYWx1ZSB8XG58LS0tLS0tLS0tLS0tLS18LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXxcbnwgTG93ICAgICAgICAgIHwg4omkIDcyICAgICAgICAgICAgICAgICAgICAgICB8XG58IE1vZGVyYXRlICAgICB8ID4gNzIgYW5kIOKJpCA3OCAgICAgICAgICAgICAgfFxufCBIaWdoICAgICAgICAgfCA+IDc4IGFuZCDiiaQgOTAgICAgICAgICAgICAgIHxcbnwgRXh0cmVtZSAgICAgIHwgPiA5MCAgICAgICAgICAgICAgICAgICAgICAgfFxuXG4qKkRlZmluaXRpb246KiogQ2F0dGxlIHRoZXJtYWwgaHVtaWRpdHkgaW5kZXgsIG1lYW4gdmFsdWUgb2YgdGhlIHNlYXNvbi4gIFxuKipEZXNjcmlwdGlvbjoqKiBUaGUgaGVhdCBpbmRleCAoSEkpIGZvciBjYXR0bGUgaXMgY2FsY3VsYXRlZCB1c2luZyBkYWlseSBkYXRhIGFuZCBlbXBpcmljYWwgZXF1YXRpb25zIGJhc2VkIG9uIFJhaGltaSBldCBhbC4gKDIwMjApLiBUaGUgVEhJIGlzIGNhbGN1bGF0ZWQgYXMgVEhJMSA9ICgxLjggw5cgVGRiICsgMzIpIC0gWygwLjU1IC0gMC4wMDU1IMOXIFJIKSDDlyAoMS44IMOXIFRkYiAtIDI2LjgpXSwgd2hlcmUgVGRiIGlzIHRoZSBkcnkgYnVsYiB0ZW1wZXJhdHVyZSAobWF4aW11bSB0ZW1wZXJhdHVyZSwgwrBDKSwgYW5kIFJIIGlzIHRoZSByZWxhdGl2ZSBodW1pZGl0eSAoJSkuICBcbioqVW5pdHM6KiogSW5kZXggKFRISSkgIFxuXG4jIyMjIEF2ZXJhZ2UgVGVtcGVyYXR1cmUgKFRBVkcpOiAgXG4qKlRocmVzaG9sZHM6KiogIFxuXG58IEhhemFyZCBMZXZlbCB8IFZhbHVlIHxcbnwtLS0tLS0tLS0tLS0tLXwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfFxufCBMb3cgICAgICAgICAgfCDiiaQgMzMgICAgICAgICAgICAgICAgICAgICAgIHxcbnwgTW9kZXJhdGUgICAgIHwgPiAzMyBhbmQg4omkIDM2ICAgICAgICAgICAgICB8XG58IEhpZ2ggICAgICAgICB8ID4gMzggYW5kIOKJpCA0NyAgICAgICAgICAgICAgfFxufCBFeHRyZW1lICAgICAgfCA+IDQ3ICAgICAgICAgICAgICAgICAgICAgICB8XG5cbioqRGVmaW5pdGlvbjoqKiBNZWFuIHRlbXBlcmF0dXJlLiAgXG4qKkRlc2NyaXB0aW9uOioqIFRoZSBhdmVyYWdlIHRlbXBlcmF0dXJlIGZvciBhIGdpdmVuIHBlcmlvZCwgdHlwaWNhbGx5IGNhbGN1bGF0ZWQgYXMgdGhlIG1lYW4gb2YgZGFpbHkgdGVtcGVyYXR1cmVzLiAgXG4qKlVuaXRzOioqIMKwQyAgXG5cbiMjIyMgVG90YWwgUHJlY2lwaXRhdGlvbiAoUFRPVCk6ICBcbioqVGhyZXNob2xkczoqKiAgXG5cbnwgSGF6YXJkIExldmVsIHwgVmFsdWUgfFxufC0tLS0tLS0tLS0tLS0tfC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18XG58IExvdyAgICAgICAgICB8IOKJpCAxMjAwICAgICAgICAgICAgICAgICAgICAgfFxufCBNb2RlcmF0ZSAgICAgfCA+IDEyMDAgYW5kIOKJpCAxNjAwICAgICAgICAgIHxcbnwgSGlnaCAgICAgICAgIHwgPiAxNjAwIGFuZCDiiaQgMTgwMCAgICAgICAgICB8XG58IEV4dHJlbWUgICAgICB8ID4gMTgwMCAgICAgICAgICAgICAgICAgICAgIHxcblxuKipEZWZpbml0aW9uOioqIFRvdGFsIHByZWNpcGl0YXRpb24uICBcbioqRGVzY3JpcHRpb246KiogVGhlIHRvdGFsIGFtb3VudCBvZiBwcmVjaXBpdGF0aW9uIGFjY3VtdWxhdGVkIG92ZXIgYSBzcGVjaWZpYyBwZXJpb2QsIHR5cGljYWxseSBhIG1vbnRoIG9yIHllYXIuICBcbioqVW5pdHM6KiogbW1gLFxuICAgICAgZnI6IGAjIyMjIFN0cmVzcyB0aGVybWlxdWUgaHVtYWluIG1heGltYWwgKEhTSF9tYXgpOiAgXG4qKlNldWlsczoqKiAgXG5cbnwgTml2ZWF1IGQnQWzDqWFzIHwgVmFsZXVyIHxcbnwtLS0tLS0tLS0tLS0tLS0tfC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18XG58IEZhaWJsZSAgICAgICAgIHwg4omkIDI3ICAgICAgICAgICAgICAgICAgICAgICB8XG58IE1vZMOpcsOpICAgICAgICAgfCA+IDI3IGV0IOKJpCAzMiAgICAgICAgICAgICAgIHxcbnwgU8OpdsOocmUgICAgICAgICB8ID4gMzIgZXQg4omkIDQxICAgICAgICAgICAgICAgfFxufCBFeHRyw6ptZSAgICAgICAgfCA+IDQxIGV0IOKJpCA1NCAgICAgICAgICAgICAgIHxcbnwgVHLDqHMgRXh0csOqbWUgICB8ID4gNTQgICAgICAgICAgICAgICAgICAgICAgIHxcblxuKipEw6lmaW5pdGlvbjoqKiBJbmRpY2UgZGUgc3RyZXNzIHRoZXJtaXF1ZSBodW1haW4sIHZhbGV1ciBtYXhpbWFsZSBkZSBsYSBzYWlzb24gZGUgY3JvaXNzYW5jZS4gIFxuKipEZXNjcmlwdGlvbjoqKiBMJ2luZGljZSBkZSBjaGFsZXVyIChISSkgZXN0IGNhbGN1bMOpIGVuIHV0aWxpc2FudCBkZXMgZG9ubsOpZXMgcXVvdGlkaWVubmVzIGV0IGRlcyDDqXF1YXRpb25zIGVtcGlyaXF1ZXMgYmFzw6llcyBzdXIgU3RlYWRtYW4gKDE5NzlhOyAxOTc5YiksIHJlbGlhbnQgbGUgSEkgw6AgbGEgdGVtcMOpcmF0dXJlIGRlIGwnYWlyIHNlYyAowrBDKSBldCDDoCBsJ2h1bWlkaXTDqSByZWxhdGl2ZSAoJSkuIExhIHZhbGV1ciBtYXhpbWFsZSBwb3VyIGNoYXF1ZSBtb2lzIGVzdCBkJ2Fib3JkIGNhbGN1bMOpZSwgc3VpdmllIGRlIGxhIG1veWVubmUgY2xpbWF0b2xvZ2lxdWUgZGUgY2hhcXVlIG1vaXMsIHB1aXMgZGVzIHZhbGV1cnMgbWF4aW1hbGUsIG1veWVubmUgZXQgbcOpZGlhbmUgZGUgbCdhbm7DqWUuICBcbioqVW5pdMOpczoqKiBJbmRpY2UgKEhJKSAgXG5cbiMjIyMgU3RyZXNzIHRoZXJtaXF1ZSBodW1haW4gbW95ZW4gKEhTSF9tZWFuKTogIFxuKipTZXVpbHM6KiogIFxuXG58IE5pdmVhdSBkJ0Fsw6lhcyB8IFZhbGV1ciB8XG58LS0tLS0tLS0tLS0tLS0tLXwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfFxufCBGYWlibGUgICAgICAgICB8IOKJpCAyNyAgICAgICAgICAgICAgICAgICAgICAgfFxufCBNb2TDqXLDqSAgICAgICAgIHwgPiAyNyBldCDiiaQgMzIgICAgICAgICAgICAgICB8XG58IFPDqXbDqHJlICAgICAgICAgfCA+IDMyIGV0IOKJpCA0MSAgICAgICAgICAgICAgIHxcbnwgRXh0csOqbWUgICAgICAgIHwgPiA0MSBldCDiiaQgNTQgICAgICAgICAgICAgICB8XG58IFRyw6hzIEV4dHLDqm1lICAgfCA+IDU0ICAgICAgICAgICAgICAgICAgICAgICB8XG5cbioqRMOpZmluaXRpb246KiogSW5kaWNlIGRlIHN0cmVzcyB0aGVybWlxdWUgaHVtYWluLCBtb3llbm5lIGRlIGxhIHNhaXNvbiBkZSBjcm9pc3NhbmNlLiAgXG4qKkRlc2NyaXB0aW9uOioqIEwnaW5kaWNlIGRlIGNoYWxldXIgKEhJKSBlc3QgY2FsY3Vsw6kgZW4gdXRpbGlzYW50IGRlcyBkb25uw6llcyBxdW90aWRpZW5uZXMgZXQgZGVzIMOpcXVhdGlvbnMgZW1waXJpcXVlcyBiYXPDqWVzIHN1ciBTdGVhZG1hbiAoMTk3OWE7IDE5NzliKSwgcmVsaWFudCBsZSBISSDDoCBsYSB0ZW1ww6lyYXR1cmUgw6AgYnVsYmUgc2VjICjCsEMpIGV0IMOgIGwnaHVtaWRpdMOpIHJlbGF0aXZlICglKS4gTGEgdmFsZXVyIG1veWVubmUgcG91ciBjaGFxdWUgbW9pcyBlc3QgZCdhYm9yZCBjYWxjdWzDqWUsIHN1aXZpZSBkZSBsYSBtb3llbm5lIGNsaW1hdG9sb2dpcXVlIGRlIGNoYXF1ZSBtb2lzLCBwdWlzIGRlcyB2YWxldXJzIG1heGltYWxlLCBtb3llbm5lIGV0IG3DqWRpYW5lIGRlIGwnYW5uw6llLiAgXG4qKlVuaXTDqXM6KiogSW5kaWNlIChISSkgIFxuXG4jIyMjIE5vbWJyZSBkZSBqb3VycyBkZSBzYXR1cmF0aW9uIGVuIGVhdSAoTkRXTDApOiAgXG4qKlNldWlsczoqKiAgICBcblxufCBOaXZlYXUgZCdBbMOpYXMgfCBWYWxldXIgfFxufC0tLS0tLS0tLS0tLS0tLS18LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXxcbnwgRmFpYmxlICAgICAgICAgfCDiiaQgMiAgICAgICAgICAgICAgICAgICAgICAgIHxcbnwgTW9kw6lyw6kgICAgICAgICB8ID4gMiBldCDiiaQgNSAgICAgICAgICAgICAgICAgfFxufCBTw6l2w6hyZSAgICAgICAgIHwgPiA1IGV0IOKJpCA4ICAgICAgICAgICAgICAgICB8XG58IEV4dHLDqm1lICAgICAgICB8ID4gOCAgICAgICAgICAgICAgICAgICAgICAgIHxcblxuKipEw6lmaW5pdGlvbjoqKiBOb21icmUgdG90YWwgZGUgam91cnMgZGUgc2F0dXJhdGlvbiBlbiBlYXUgKMOgIHNhdHVyYXRpb24gaW5pdGlhbGUsIDAgJSkgcGFyIHNhaXNvbi4gIFxuKipEZXNjcmlwdGlvbjoqKiBVbiBqb3VyIGRlIHNhdHVyYXRpb24gZW4gZWF1IHNlIHByb2R1aXQgbG9yc3F1ZSBsJ2h1bWlkaXTDqSBkdSBzb2wgZXN0IGp1c3RlIGF1LWRlc3N1cyBkZSBsYSBjYXBhY2l0w6kgYXUgY2hhbXAgZXQgc2UgZGlyaWdlIHZlcnMgbGEgc2F0dXJhdGlvbi4gQ2V0IGluZGljZSBlc3QgY2FsY3Vsw6kgZW4gdXRpbGlzYW50IHVuIG1vZMOobGUgc2ltcGxlIGRlIGJpbGFuIGh5ZHJpcXVlIHF1aSB1dGlsaXNlIGxlcyBwcsOpY2lwaXRhdGlvbnMgcXVvdGlkaWVubmVzIGRlIENISVJQUywgbGVzIHRlbXDDqXJhdHVyZXMgcXVvdGlkaWVubmVzIGRlIENISVJUUyBldCBsZSByYXlvbm5lbWVudCBzb2xhaXJlIGQnQWdFUkE1LiAgXG4qKlVuaXTDqXM6KiogSm91cnMgIFxuXG4jIyMjIE5vbWJyZSBkZSBqb3VycyBkZSBzdHJlc3MgaHlkcmlxdWUgKE5EV1MpOiAgXG4qKlNldWlsczoqKiAgXG5cbnwgTml2ZWF1IGQnQWzDqWFzIHwgVmFsZXVyIHxcbnwtLS0tLS0tLS0tLS0tLS0tfC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18XG58IEZhaWJsZSAgICAgICAgIHwg4omkIDE1ICAgICAgICAgICAgICAgICAgICAgICB8XG58IE1vZMOpcsOpICAgICAgICAgfCA+IDE1IGV0IOKJpCAyMCAgICAgICAgICAgICAgIHxcbnwgU8OpdsOocmUgICAgICAgICB8ID4gMjAgZXQg4omkIDI1ICAgICAgICAgICAgICAgfFxufCBFeHRyw6ptZSAgICAgICAgfCA+IDI1ICAgICAgICAgICAgICAgICAgICAgICB8XG5cbioqRMOpZmluaXRpb246KiogTm9tYnJlIHRvdGFsIGRlIGpvdXJzIGRlIHN0cmVzcyBoeWRyaXF1ZSBwYXIgc2Fpc29uLiAgXG4qKkRlc2NyaXB0aW9uOioqIFVuIGpvdXIgZGUgc3RyZXNzIGh5ZHJpcXVlIGVzdCBkw6lmaW5pIGNvbW1lIHVuIGpvdXIgb8O5IGxlIHJhdGlvIGRlIGwnw6l2YXBvdHJhbnNwaXJhdGlvbiByw6llbGxlIMOgIGwnw6l2YXBvdHJhbnNwaXJhdGlvbiBwb3RlbnRpZWxsZSBlc3QgaW5mw6lyaWV1ciDDoCAwLDUuIENldCBpbmRpY2UgZXN0IGNhbGN1bMOpIGVuIHV0aWxpc2FudCB1biBtb2TDqGxlIHNpbXBsZSBkZSBiaWxhbiBoeWRyaXF1ZSBxdWkgdXRpbGlzZSBsZXMgcHLDqWNpcGl0YXRpb25zIHF1b3RpZGllbm5lcyBkZSBDSElSUFMsIGxlcyB0ZW1ww6lyYXR1cmVzIHF1b3RpZGllbm5lcyBkZSBDSElSVFMgZXQgbGUgcmF5b25uZW1lbnQgc29sYWlyZSBkJ0FnRVJBNS4gIFxuKipVbml0w6lzOioqIEpvdXJzICBcblxuIyMjIyBOb21icmUgZGUgam91cnMgZGUgc3RyZXNzIHRoZXJtaXF1ZSBwb3VyIGxlIG1hw69zIChOVHgzNSk6ICBcbioqU2V1aWxzOioqICAgXG5cbnwgTml2ZWF1IGQnQWzDqWFzIHwgVmFsZXVyIHxcbnwtLS0tLS0tLS0tLS0tLS0tfC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18XG58IEZhaWJsZSAgICAgICAgIHwg4omkIDEwICAgICAgICAgICAgICAgICAgICAgICB8XG58IE1vZMOpcsOpICAgICAgICAgfCA+IDEwIGV0IOKJpCAyMCAgICAgICAgICAgICAgIHxcbnwgU8OpdsOocmUgICAgICAgICB8ID4gMjAgZXQg4omkIDI1ICAgICAgICAgICAgICAgfFxufCBFeHRyw6ptZSAgICAgICAgfCA+IDI1ICAgICAgICAgICAgICAgICAgICAgICB8XG5cbioqRMOpZmluaXRpb246KiogTm9tYnJlIHRvdGFsIGRlIGpvdXJzIGRlIHN0cmVzcyB0aGVybWlxdWUgcGFyIHNhaXNvbiBwb3VyIGxlIG1hw69zLiAgXG4qKkRlc2NyaXB0aW9uOioqIExlIG5vbWJyZSBkZSBqb3VycyBhdmVjIGRlcyB0ZW1ww6lyYXR1cmVzIG1heGltYWxlcyBxdW90aWRpZW5uZXMgYXUtZGVzc3VzIGRlIDM14oCvwrBDIHBlbmRhbnQgbGEgc2Fpc29uIGRlIGNyb2lzc2FuY2UsIGVuIHV0aWxpc2FudCB1biBjYWxlbmRyaWVyIGRlIGN1bHR1cmUgZHUgbWHDr3MuICBcbioqVW5pdMOpczoqKiBKb3VycyAgXG5cbiMjIyMgTm9tYnJlIGRlIGpvdXJzIGRlIHN0cmVzcyB0aGVybWlxdWUgcG91ciBsZXMgY3VsdHVyZXMgZ8OpbsOpcmlxdWVzIChOVHg0MCk6ICBcbioqU2V1aWxzOioqICAgXG5cbnwgTml2ZWF1IGQnQWzDqWFzIHwgVmFsZXVyIHxcbnwtLS0tLS0tLS0tLS0tLS0tfC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18XG58IEZhaWJsZSAgICAgICAgIHwg4omkIDEgICAgICAgICAgICAgICAgICAgICAgICB8XG58IE1vZMOpcsOpICAgICAgICAgfCA+IDEgZXQg4omkIDUgICAgICAgICAgICAgICAgIHxcbnwgU8OpdsOocmUgICAgICAgICB8ID4gNSBldCDiiaQgMTAgICAgICAgICAgICAgICAgfFxufCBFeHRyw6ptZSAgICAgICAgfCA+IDEwICAgICAgICAgICAgICAgICAgICAgICB8XG5cbioqRMOpZmluaXRpb246KiogTm9tYnJlIHRvdGFsIGRlIGpvdXJzIGRlIHN0cmVzcyB0aGVybWlxdWUgcGFyIHNhaXNvbiBwb3VyIGxlcyBjdWx0dXJlcyBnw6luw6lyaXF1ZXMuICBcbioqRGVzY3JpcHRpb246KiogTGUgbm9tYnJlIGRlIGpvdXJzIGF2ZWMgZGVzIHRlbXDDqXJhdHVyZXMgbWF4aW1hbGVzIHF1b3RpZGllbm5lcyBhdS1kZXNzdXMgZGUgNDDigK/CsEMgcGFyIG1vaXMsIHNhbnMgdXRpbGlzZXIgZGUgY2FsZW5kcmllciBkZSBjdWx0dXJlLiAgXG4qKlVuaXTDqXM6KiogSm91cnMgIFxuXG4jIyMjIEluZGljZSBkJ0FyaWRpdMOpIGRlIFRob3JudGh3YWl0ZSAoVEFJKTogIFxuKipTZXVpbHM6KiogICBcblxufCBOaXZlYXUgZCdBbMOpYXMgfCBWYWxldXIgfFxufC0tLS0tLS0tLS0tLS0tLS18LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXxcbnwgRmFpYmxlICAgICAgICAgfCDiiaQgNDAgICAgICAgICAgICAgICAgICAgICAgIHxcbnwgTW9kw6lyw6kgICAgICAgICB8ID4gNDAgZXQg4omkIDYwICAgICAgICAgICAgICAgfFxufCBTw6l2w6hyZSAgICAgICAgIHwgPiA2MCBldCDiiaQgODAgICAgICAgICAgICAgICB8XG58IEV4dHLDqm1lICAgICAgICB8ID4gODAgICAgICAgICAgICAgICAgICAgICAgIHxcblxuKipEw6lmaW5pdGlvbjoqKiBJbmRpY2UgZCdhcmlkaXTDqSBkZSBUaG9ybnRod2FpdGUuICBcbioqRGVzY3JpcHRpb246KiogTCdpbmRpY2UgZCdhcmlkaXTDqSBkZSBUaG9ybnRod2FpdGUgZXN0IGNhbGN1bMOpIGNvbW1lIDEwMCDDlyAoZCAvIG4pLCBvw7kgZCBlc3QgbGEgc29tbWUgZGVzIGRpZmbDqXJlbmNlcyBtZW5zdWVsbGVzIGVudHJlIGxlcyBwcsOpY2lwaXRhdGlvbnMgZXQgbCdFVFAgcG91ciBsZXMgbW9pcyBvw7kgbGVzIHByw6ljaXBpdGF0aW9ucyBzb250IGluZsOpcmlldXJlcyDDoCBsJ0VUUCwgZXQgbiBlc3QgbGEgc29tbWUgbWVuc3VlbGxlIGRlIGwnRVRQIHBvdXIgY2VzIG1vaXMuICBcbioqVW5pdMOpczoqKiBJbmRpY2UgIFxuXG4jIyMjIEluZGljZSBkZSBUZW1ww6lyYXR1cmUtSHVtaWRpdMOpIE1heGltYWwgcG91ciBsZSBCw6l0YWlsIChUSElfbWF4KTogIFxuKipTZXVpbHM6KiogIFxuXG58IE5pdmVhdSBkJ0Fsw6lhcyB8IFZhbGV1ciB8XG58LS0tLS0tLS0tLS0tLS0tLXwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfFxufCBGYWlibGUgICAgICAgICB8IOKJpCA3MiAgICAgICAgICAgICAgICAgICAgICAgfFxufCBNb2TDqXLDqSAgICAgICAgIHwgPiA3MiBldCDiiaQgNzggICAgICAgICAgICAgICB8XG58IFPDqXbDqHJlICAgICAgICAgfCA+IDc4IGV0IOKJpCA5MCAgICAgICAgICAgICAgIHxcbnwgRXh0csOqbWUgICAgICAgIHwgPiA5MCAgICAgICAgICAgICAgICAgICAgICAgfFxuXG4qKkTDqWZpbml0aW9uOioqIEluZGljZSBkZSB0ZW1ww6lyYXR1cmUtaHVtaWRpdMOpIHBvdXIgbGUgYsOpdGFpbCwgdmFsZXVyIG1heGltYWxlIGRlIGxhIHNhaXNvbi4gIFxuKipEZXNjcmlwdGlvbjoqKiBMJ2luZGljZSBkZSBjaGFsZXVyIChISSkgcG91ciBsZSBiw6l0YWlsIGVzdCBjYWxjdWzDqSBlbiB1dGlsaXNhbnQgZGVzIGRvbm7DqWVzIHF1b3RpZGllbm5lcyBldCBkZXMgw6lxdWF0aW9ucyBlbXBpcmlxdWVzIGJhc8OpZXMgc3VyIFJhaGltaSBldCBhbC4gKDIwMjApLiBMZSBUSEkgZXN0IGNhbGN1bMOpIGNvbW1lIFRISTEgPSAoMSw4IMOXIFRkYiArIDMyKSAtIFsoMCw1NSAtIDAsMDA1NSDDlyBSSCkgw5cgKDEsOCDDlyBUZGIgLSAyNiw4KV0sIG/DuSBUZGIgZXN0IGxhIHRlbXDDqXJhdHVyZSDDoCBidWxiZSBzZWMgKHRlbXDDqXJhdHVyZSBtYXhpbWFsZSwgwrBDKSwgZXQgUkggZXN0IGwnaHVtaWRpdMOpIHJlbGF0aXZlICglKS4gIFxuKipVbml0w6lzOioqIEluZGljZSAoVEhJKSAgXG5cbiMjIyMgSW5kaWNlIGRlIFRlbXDDqXJhdHVyZS1IdW1pZGl0w6kgTW95ZW4gcG91ciBsZSBCw6l0YWlsIChUSElfbWVhbik6ICBcbioqU2V1aWxzOioqICBcblxufCBOaXZlYXUgZCdBbMOpYXMgfCBWYWxldXIgfFxufC0tLS0tLS0tLS0tLS0tLS18LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXxcbnwgRmFpYmxlICAgICAgICAgfCDiiaQgNzIgICAgICAgICAgICAgICAgICAgICAgIHxcbnwgTW9kw6lyw6kgICAgICAgICB8ID4gNzIgZXQg4omkIDc4ICAgICAgICAgICAgICAgfFxufCBTw6l2w6hyZSAgICAgICAgIHwgPiA3OCBldCDiiaQgOTAgICAgICAgICAgICAgICB8XG58IEV4dHLDqm1lICAgICAgICB8ID4gOTAgICAgICAgICAgICAgICAgICAgICAgIHxcblxuKipEw6lmaW5pdGlvbjoqKiBJbmRpY2UgZGUgdGVtcMOpcmF0dXJlLWh1bWlkaXTDqSBwb3VyIGxlIGLDqXRhaWwsIHZhbGV1ciBtb3llbm5lIGRlIGxhIHNhaXNvbi4gIFxuKipEZXNjcmlwdGlvbjoqKiBMJ2luZGljZSBkZSBjaGFsZXVyIChISSkgcG91ciBsZSBiw6l0YWlsIGVzdCBjYWxjdWzDqSBlbiB1dGlsaXNhbnQgZGVzIGRvbm7DqWVzIHF1b3RpZGllbm5lcyBldCBkZXMgw6lxdWF0aW9ucyBlbXBpcmlxdWVzIGJhc8OpZXMgc3VyIFJhaGltaSBldCBhbC4gKDIwMjApLiBMZSBUSEkgZXN0IGNhbGN1bMOpIGNvbW1lIFRISTEgPSAoMSw4IMOXIFRkYiArIDMyKSAtIFsoMCw1NSAtIDAsMDA1NSDDlyBSSCkgw5cgKDEsOCDDlyBUZGIgLSAyNiw4KV0sIG/DuSBUZGIgZXN0IGxhIHRlbXDDqXJhdHVyZSDDoCBidWxiZSBzZWMgKHRlbXDDqXJhdHVyZSBtYXhpbWFsZSwgwrBDKSwgZXQgUkggZXN0IGwnaHVtaWRpdMOpIHJlbGF0aXZlICglKS4gIFxuKipVbml0w6lzOioqIEluZGljZSAoVEhJKSAgXG5cbiMjIyMgVGVtcMOpcmF0dXJlIE1veWVubmUgKFRBVkcpOiAgXG4qKlNldWlsczoqKiAgXG5cbnwgTml2ZWF1IGQnQWzDqWFzIHwgVmFsZXVyIHxcbnwtLS0tLS0tLS0tLS0tLS0tfC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18XG58IEZhaWJsZSAgICAgICAgIHwg4omkIDMzICAgICAgICAgICAgICAgICAgICAgICB8XG58IE1vZMOpcsOpICAgICAgICAgfCA+IDMzIGV0IOKJpCAzNiAgICAgICAgICAgICAgIHxcbnwgU8OpdsOocmUgICAgICAgICB8ID4gMzYgZXQg4omkIDQ3ICAgICAgICAgICAgICAgfFxufCBFeHRyw6ptZSAgICAgICAgfCA+IDQ3ICAgICAgICAgICAgICAgICAgICAgICB8XG5cbioqRMOpZmluaXRpb246KiogVGVtcMOpcmF0dXJlIG1veWVubmUuICBcbioqRGVzY3JpcHRpb246KiogTGEgdGVtcMOpcmF0dXJlIG1veWVubmUgcG91ciB1bmUgcMOpcmlvZGUgZG9ubsOpZSwgZ8OpbsOpcmFsZW1lbnQgY2FsY3Vsw6llIGNvbW1lIGxhIG1veWVubmUgZGVzIHRlbXDDqXJhdHVyZXMgcXVvdGlkaWVubmVzLiAgXG4qKlVuaXTDqXM6KiogwrBDICBcblxuIyMjIyBQcsOpY2lwaXRhdGlvbiBUb3RhbGUgKFBUT1QpOiAgXG4qKlNldWlsczoqKiAgXG5cbnwgTml2ZWF1IGQnQWzDqWFzIHwgVmFsZXVyIHxcbnwtLS0tLS0tLS0tLS0tLS0tfC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18XG58IEZhaWJsZSAgICAgICAgIHwg4omkIDEyMDAgICAgICAgICAgICAgICAgICAgICB8XG58IE1vZMOpcsOpICAgICAgICAgfCA+IDEyMDAgZXQg4omkIDE2MDAgICAgICAgICAgIHxcbnwgU8OpdsOocmUgICAgICAgICB8ID4gMTYwMCBldCDiiaQgMTgwMCAgICAgICAgICAgfFxufCBFeHRyw6ptZSAgICAgICAgfCA+IDE4MDAgICAgICAgICAgICAgICAgICAgICB8XG5cbioqRMOpZmluaXRpb246KiogUHLDqWNpcGl0YXRpb24gdG90YWxlLiAgXG4qKkRlc2NyaXB0aW9uOioqIExhIHF1YW50aXTDqSB0b3RhbGUgZGUgcHLDqWNpcGl0YXRpb25zIGFjY3VtdWzDqWVzIHN1ciB1bmUgcMOpcmlvZGUgc3DDqWNpZmlxdWUsIGfDqW7DqXJhbGVtZW50IHVuIG1vaXMgb3UgdW5lIGFubsOpZS4gIFxuKipVbml0w6lzOioqIG1tYCxcbiAgICB9LFxuICB9LFxuICBFeHBvc3VyZToge1xuICAgIHRpdGxlOiB7IGVuOiBcIkV4cG9zdXJlIERlZmluaXRpb25zXCIsIGZyOiBcIkTDqWZpbml0aW9ucyBkZSBsJ0V4cG9zaXRpb25cIiB9LFxuICAgIHRleHQ6IHtcbiAgICAgIGVuOiBgIyMjIyBWYWx1ZSBPZiBQcm9kdWN0aW9uIChWT1ApOiAgXG4qKlVuaXQ6KiogSW50ZXJuYXRpb25hbCBEb2xsYXIgZm9yIDIwMDUgKEludCQyMDA1KSAgXG4qKkRlc2NyaXB0aW9uOioqIFZhbHVlIG9mIFByb2R1Y3Rpb24gKFZPUCkgcmVwcmVzZW50cyB0aGUgdG90YWwgZWNvbm9taWMgdmFsdWUgb2YgYWdyaWN1bHR1cmFsIGdvb2RzIHByb2R1Y2VkIHdpdGhpbiBhIHNwZWNpZmllZCBhcmVhLlxuXG4jIyMjIEhhcnZlc3RlZCBBcmVhIChIQSk6XG4qKlVuaXQ6KiogSGVjdGFyZSAoaGEpICBcbioqRGVzY3JpcHRpb246KiogSGFydmVzdGVkIGFyZWEgKEhBKSBpcyB0aGUgdG90YWwgbGFuZCBhcmVhLCBtZWFzdXJlZCBpbiBoZWN0YXJlcyAoaGEpLCB1c2VkIGZvciB0aGUgY3VsdGl2YXRpb24gb2YgYSBjcm9wIHdpdGhpbiBhIGdpdmVuIHJlZ2lvbi5cblxuIyMjIyBMaXZlc3RvY2sgSGVhZCAobnVtYmVyKTpcbioqVW5pdDoqKiBUb3RhbCAgXG4qKkRlc2NyaXB0aW9uOioqIExpdmVzdG9jayBoZWFkIHJlZmVycyB0byB0aGUgdG90YWwgbnVtYmVyIG9mIGFuaW1hbHMgcHJlc2VudCBpbiBhIGdpdmVuIGFyZWEuYCxcbiAgICAgIGZyOiBgIyMjIyBMYSBWYWxldXIgZGUgbGEgUHJvZHVjdGlvbiAoVk9QKVxuKipVbml0w6k6KiogRG9sbGFyIEludGVybmF0aW9uYWwgZGUgMjAwNSAoSW50JDIwMDUpICBcbioqRGVzY3JpcHRpb246KiogTGEgVmFsZXVyIGRlIGxhIFByb2R1Y3Rpb24gcmVwcsOpc2VudGUgbGEgdmFsZXVyIMOpY29ub21pcXVlIHRvdGFsZSBkZXMgYmllbnMgYWdyaWNvbGVzIHByb2R1aXRzIGRhbnMgdW5lIHpvbmUgc3DDqWNpZmnDqWUuICBcblxuIyMjIyBTdXBlcmZpY2llIFLDqWNvbHTDqWUgKEhBKTpcbioqVW5pdMOpOioqIEhlY3RhcmUgKGhhKSAgXG4qKkRlc2NyaXB0aW9uOioqIExhIHN1cGVyZmljaWUgcsOpY29sdMOpZSBlc3QgbGEgc3VwZXJmaWNpZSB0b3RhbGUgZGVzIHRlcnJlcywgbWVzdXLDqWUgZW4gaGVjdGFyZXMgKGhhKSwgdXRpbGlzw6llIHBvdXIgbGEgY3VsdHVyZSBkJ3VuZSByw6ljb2x0ZSBkYW5zIHVuZSByw6lnaW9uIGRvbm7DqWUuIFxuXG4jIyMjIEVmZmVjdGlmIGR1IELDqXRhaWwgKG5vbWJyZSk6IFxuKipVbml0w6k6KiogVG90YWwgIFxuKipEZXNjcmlwdGlvbjoqKiBMJ2VmZmVjdGlmIGR1IGLDqXRhaWwgZmFpdCByw6lmw6lyZW5jZSBhdSBub21icmUgdG90YWwgZCdhbmltYXV4IHByw6lzZW50cyBkYW5zIHVuZSB6b25lIGFkbWluaXN0cmF0aXZlIGRvbm7DqWUuYCxcbiAgICB9LFxuICB9LFxuICBWdWxuZXJhYmlsaXR5OiB7XG4gICAgdGl0bGU6IHtcbiAgICAgIGVuOiBcIkFkYXB0aXZlIENhcGFjaXR5IERlZmluaXRpb25zXCIsXG4gICAgICBmcjogXCJEw6lmaW5pdGlvbnMgZGUgbGEgQ2FwYWNpdMOpIGQnQWRhcHRhdGlvblwiLFxuICAgIH0sXG4gICAgdGV4dDoge1xuICAgICAgZW46IGAjIyMjIEVkdWNhdGlvbjogXG4qKkRlc2NyaXB0aW9uOioqIFllYXJzIG9mIGVkdWNhdGlvbiBhY3Jvc3MgdGhlIHBvcHVsYXRpb24gKGNvbWJpbmVkIG1hbGUgYW5kIGZlbWFsZSkgIFxuKipVbml0OioqIFllYXJzXG5cbiMjIyMgUG92ZXJ0eTogXG4qKkRlc2NyaXB0aW9uOioqIFBlcmNlbnQgb2YgUG9wdWxhdGlvbiB1bmRlcm5lYXRoIHRoZSBwcm92aWRlZCBwb3ZlcnR5IGxpbmUgIFxuKipVbml0OioqICUgb2YgUG9wdWxhdGlvblxuXG4jIyMjIEdlbmRlcjogXG4qKkRlc2NyaXB0aW9uOioqIEEgc2V0IG9mIGluZGV4ZXMgc2hvd2luZyBmZW1hbGUgd2VsbC1iZWluZy4gQWxsIGFyZSBub3JtYWxpemVkIGJldHdlZW4gMC0xIHdoZXJlIDAgaXMgcG9vciBhbmQgMSBpcyBnb29kLiAgXG4qKlVuaXQ6KiogSW5kZXhcbmAsXG4gICAgICBmcjogYCMjIyMgw4lkdWNhdGlvbjogXG4qKkRlc2NyaXB0aW9uOioqICBOb21icmUgZCdhbm7DqWVzIGQnw6lkdWNhdGlvbiBkYW5zIGxhIHBvcHVsYXRpb24gKGhvbW1lcyBldCBmZW1tZXMgY29tYmluw6lzKSAgXG4qKlVuaXTDqToqKiBBbm7DqWVzXG5cbiMjIyMgUGF1dnJldMOpOiBcbioqRGVzY3JpcHRpb246KiogUG91cmNlbnRhZ2UgZGUgbGEgcG9wdWxhdGlvbiBlbiBkZXNzb3VzIGR1IHNldWlsIGRlIHBhdXZyZXTDqSBmb3VybmkuICBcbioqVW5pdMOpOioqICUgZGUgbGEgcG9wdWxhdGlvblxuXG4jIyMjIEdlbnJlOiBcbioqRGVzY3JpcHRpb246KiogVW4gZW5zZW1ibGUgZCdpbmRpY2VzIG1vbnRyYW50IGxlIGJpZW4tw6p0cmUgZGVzIGZlbW1lcy4gVG91cyBzb250IG5vcm1hbGlzw6lzIGVudHJlIDAgZXQgMSwgb8O5IDAgZXN0IG1hdXZhaXMgZXQgMSBlc3QgYm9uLiAgXG4qKlVuaXTDqToqKiBJbmRpY2VcbmAsXG4gICAgfSxcbiAgfSxcbn0pO1xuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdwcmV0dHlMYW5ndWFnZVZpZXcnKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnYXRsYXNfY2F0JykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ0RhdGFTZWxlY3Rvcl9mb3JtJykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ2FkbWluX2FnZ3JlZ2F0aW9uTGV2ZWwnKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgncHJldmlld1R5cGUnKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnZGF0YV90b192aXN1YWxpc2UnKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnZG93bmxvYWRfZm9ybWF0JykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ2NvZGVMYW5ndWFnZScpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdjb3VudHJ5JykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ2FkbWluMV9zZWwnKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnYWRtaW4yX3NlbCcpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdoYXphcmRfc2VsJykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ3RpbWVfc2VsJykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ3NzcF9zZWwnKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnYWNfY2F0JykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ2FjX3N1YmNhdCcpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdleHBvc3VyZV9jYXQnKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnZXhwb3N1cmVfc3ViQ2F0JykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ2V4cG9zdXJlX3ZhcicpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdsYW5ndWFnZScpIn1dfQ==</script><script type="module">"file:"===window.location.protocol&&alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."),window._ojs.paths.runtimeToDoc="../../notebooks/explore",window._ojs.paths.runtimeToRoot="../..",window._ojs.paths.docToRoot="../..",window._ojs.selfContained=!1,window._ojs.runtime.interpretFromScriptTags()</script><script id="quarto-html-after-body" type="application/javascript">window.document.addEventListener("DOMContentLoaded",function(t){const e=t=>{for(const e of t.classList)if(e.startsWith("code-annotation-"))return!0;return!1},n=function(t){const e=t.trigger;e.blur(),e.classList.add("code-copy-button-checked");var n=e.getAttribute("title");let o;e.setAttribute("title","Copied!"),window.bootstrap&&(e.setAttribute("data-bs-toggle","tooltip"),e.setAttribute("data-bs-placement","left"),e.setAttribute("data-bs-title","Copied!"),o=new bootstrap.Tooltip(e,{trigger:"manual",customClass:"code-copy-button-tooltip",offset:[0,-8]}),o.show()),setTimeout(function(){o&&(o.hide(),e.removeAttribute("data-bs-title"),e.removeAttribute("data-bs-toggle"),e.removeAttribute("data-bs-placement")),e.setAttribute("title",n),e.classList.remove("code-copy-button-checked")},1e3),t.clearSelection()},o=function(t){const n=t.parentElement.cloneNode(!0).querySelector("code");for(const t of n.children)e(t)&&t.remove();return n.innerText};if(new window.ClipboardJS(".code-copy-button:not([data-in-quarto-modal])",{text:o}).on("success",n),window.document.getElementById("quarto-embedded-source-code-modal")){new window.ClipboardJS(".code-copy-button[data-in-quarto-modal]",{text:o,container:window.document.getElementById("quarto-embedded-source-code-modal")}).on("success",n)}for(var i=new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//),a=new RegExp(/^mailto:/),l=new RegExp("https://adaptationatlas.github.io/atlas_notebooks/"),r=t=>l.test(t)||i.test(t)||a.test(t),d=window.document.querySelectorAll("a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)"),c=0;c<d.length;c++){const t=d[c];r(t.href)||void 0!==t.dataset.originalHref&&(t.href=t.dataset.originalHref)}function s(t,e,n,o){const i={allowHTML:!0,maxWidth:500,delay:100,arrow:!1,appendTo:function(t){return t.parentElement},interactive:!0,interactiveBorder:10,theme:"quarto",placement:"bottom-start"};e&&(i.content=e),n&&(i.onTrigger=n),o&&(i.onUntrigger=o),window.tippy(t,i)}const u=window.document.querySelectorAll('a[role="doc-noteref"]');for(c=0;c<u.length;c++){const t=u[c];s(t,function(){let e=t.getAttribute("data-footnote-href")||t.getAttribute("href");try{e=new URL(e).hash}catch{}const n=e.replace(/^#\/?/,""),o=window.document.getElementById(n);return o?o.innerHTML:""})}const h=window.document.querySelectorAll("a.quarto-xref"),m=(t,e)=>{const n=t=>{if(t.classList.remove("page-full","page-columns"),t.children)for(const e of t.children)n(e)};if(n(e),null===t||t.startsWith("sec-")){const t=document.createElement("div");if(e.children&&e.children.length>2){t.appendChild(e.children[0].cloneNode(!0));for(let n=1;n<e.children.length;n++){const o=e.children[n];if("P"!==o.tagName||""!==o.innerText){t.appendChild(o.cloneNode(!0));break}}return window.Quarto?.typesetMath&&window.Quarto.typesetMath(t),t.innerHTML}return window.Quarto?.typesetMath&&window.Quarto.typesetMath(e),e.innerHTML}{const t=e.querySelector("a.anchorjs-link");return t&&t.remove(),window.Quarto?.typesetMath&&window.Quarto.typesetMath(e),e.classList.contains("callout")?e.outerHTML:e.innerHTML}};for(c=0;c<h.length;c++){const t=h[c];s(t,void 0,function(e){e.disable();let n,o=t.getAttribute("href");if(o.startsWith("#"))n=o;else try{n=new URL(o).hash}catch{}if(n){const t=n.replace(/^#\/?/,""),i=window.document.getElementById(t);if(null!==i)try{const n=m(t,i.cloneNode(!0));e.setContent(n)}finally{e.enable(),e.show()}else fetch(o.split("#")[0]).then(t=>t.text()).then(n=>{const o=(new DOMParser).parseFromString(n,"text/html").getElementById(t);if(null!==o){const n=m(t,o);e.setContent(n)}}).finally(()=>{e.enable(),e.show()})}else fetch(o).then(t=>t.text()).then(t=>{const n=(new DOMParser).parseFromString(t,"text/html").querySelector("main.content");if(null!==n){n.children.length>0&&"HEADER"===n.children[0].tagName&&n.children[0].remove();const t=m(null,n);e.setContent(t)}}).finally(()=>{e.enable(),e.show()})},function(t){})}let w;const g=t=>{window.document;const e=t.getAttribute("data-target-cell"),n=t.getAttribute("data-target-annotation");const o=window.document.querySelector('span[data-code-cell="'+e+'"][data-code-annotation="'+n+'"]').getAttribute("data-code-lines").split(",").map(t=>e+"-"+t);let i=null,a=null,l=null;if(o.length>0){const n=window.document.getElementById(o[0]);if(i=n.offsetTop,a=n.offsetHeight,l=n.parentElement.parentElement,o.length>1){const t=window.document.getElementById(o[o.length-1]);a=t.offsetTop+t.offsetHeight-i}if(null!==i&&null!==a&&null!==l){let t=window.document.getElementById("code-annotation-line-highlight");null===t&&(t=window.document.createElement("div"),t.setAttribute("id","code-annotation-line-highlight"),t.style.position="absolute",l.appendChild(t)),t.style.top=i-2+"px",t.style.height=a+4+"px",t.style.left=0;let n=window.document.getElementById("code-annotation-line-highlight-gutter");if(null===n){n=window.document.createElement("div"),n.setAttribute("id","code-annotation-line-highlight-gutter"),n.style.position="absolute";window.document.getElementById(e).querySelector(".code-annotation-gutter").appendChild(n)}n.style.top=i-2+"px",n.style.height=a+4+"px"}w=t}},p=()=>{["code-annotation-line-highlight","code-annotation-line-highlight-gutter"].forEach(t=>{const e=window.document.getElementById(t);e&&e.remove()}),w=void 0};window.addEventListener("resize",function(t,e){let n,o=!1;return(...i)=>{o?(n&&clearTimeout(n),n=setTimeout(()=>{t.apply(this,i),n=o=!1},e)):(t.apply(this,i),o=!0)}}(()=>{elRect=void 0,w&&g(w)},10));const f=window.document.querySelectorAll("dt[data-target-cell]");for(const t of f)t.addEventListener("click",t=>{const e=t.target;if(e!==w){p();const t=window.document.querySelector("dt[data-target-cell].code-annotation-active");t&&t.classList.remove("code-annotation-active"),g(e),e.classList.add("code-annotation-active")}else p(),e.classList.remove("code-annotation-active")});const b=t=>{const e=t.parentElement;if(e){const n=e.dataset.cites;return n?{el:t,cites:n.split(" ")}:b(t.parentElement)}};var y=window.document.querySelectorAll('a[role="doc-biblioref"]');for(c=0;c<y.length;c++){const t=y[c],e=b(t);e&&s(e.el,function(){var t=window.document.createElement("div");return e.cites.forEach(function(e){var n=window.document.createElement("div");n.classList.add("hanging-indent"),n.classList.add("csl-entry");var o=window.document.getElementById("ref-"+e);o&&(n.innerHTML=o.innerHTML),t.appendChild(n)}),t.innerHTML})}})</script></div></body></html>